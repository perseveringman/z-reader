var zO=Object.defineProperty;var FN=n=>{throw TypeError(n)};var FO=(n,e,t)=>e in n?zO(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var we=(n,e,t)=>FO(n,typeof e!="symbol"?e+"":e,t),jw=(n,e,t)=>e.has(n)||FN("Cannot "+t);var u=(n,e,t)=>(jw(n,e,"read from private field"),t?t.call(n):e.get(n)),D=(n,e,t)=>e.has(n)?FN("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),k=(n,e,t,i)=>(jw(n,e,"write to private field"),i?i.call(n,t):e.set(n,t),t),R=(n,e,t)=>(jw(n,e,"access private method"),t);var ni=(n,e,t,i)=>({set _(s){k(n,e,s,t)},get _(){return u(n,e,i)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();const lt=n=>typeof n=="string",Cg=()=>{let n,e;const t=new Promise((i,s)=>{n=i,e=s});return t.resolve=n,t.reject=e,t},UN=n=>n==null?"":""+n,UO=(n,e,t)=>{n.forEach(i=>{e[i]&&(t[i]=e[i])})},HO=/###/g,HN=n=>n&&n.indexOf("###")>-1?n.replace(HO,"."):n,$N=n=>!n||lt(n),gm=(n,e,t)=>{const i=lt(e)?e.split("."):e;let s=0;for(;s<i.length-1;){if($N(n))return{};const r=HN(i[s]);!n[r]&&t&&(n[r]=new t),Object.prototype.hasOwnProperty.call(n,r)?n=n[r]:n={},++s}return $N(n)?{}:{obj:n,k:HN(i[s])}},qN=(n,e,t)=>{const{obj:i,k:s}=gm(n,e,Object);if(i!==void 0||e.length===1){i[s]=t;return}let r=e[e.length-1],a=e.slice(0,e.length-1),o=gm(n,a,Object);for(;o.obj===void 0&&a.length;)r=`${a[a.length-1]}.${r}`,a=a.slice(0,a.length-1),o=gm(n,a,Object),o!=null&&o.obj&&typeof o.obj[`${o.k}.${r}`]<"u"&&(o.obj=void 0);o.obj[`${o.k}.${r}`]=t},$O=(n,e,t,i)=>{const{obj:s,k:r}=gm(n,e,Object);s[r]=s[r]||[],s[r].push(t)},ab=(n,e)=>{const{obj:t,k:i}=gm(n,e);if(t&&Object.prototype.hasOwnProperty.call(t,i))return t[i]},qO=(n,e,t)=>{const i=ab(n,t);return i!==void 0?i:ab(e,t)},qD=(n,e,t)=>{for(const i in e)i!=="__proto__"&&i!=="constructor"&&(i in n?lt(n[i])||n[i]instanceof String||lt(e[i])||e[i]instanceof String?t&&(n[i]=e[i]):qD(n[i],e[i],t):n[i]=e[i]);return n},fd=n=>n.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var VO={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const GO=n=>lt(n)?n.replace(/[&<>"'\/]/g,e=>VO[e]):n;class WO{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const t=this.regExpMap.get(e);if(t!==void 0)return t;const i=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,i),this.regExpQueue.push(e),i}}const YO=[" ",",","?","!",";"],XO=new WO(20),KO=(n,e,t)=>{e=e||"",t=t||"";const i=YO.filter(a=>e.indexOf(a)<0&&t.indexOf(a)<0);if(i.length===0)return!0;const s=XO.getRegExp(`(${i.map(a=>a==="?"?"\\?":a).join("|")})`);let r=!s.test(n);if(!r){const a=n.indexOf(t);a>0&&!s.test(n.substring(0,a))&&(r=!0)}return r},K2=(n,e,t=".")=>{if(!n)return;if(n[e])return Object.prototype.hasOwnProperty.call(n,e)?n[e]:void 0;const i=e.split(t);let s=n;for(let r=0;r<i.length;){if(!s||typeof s!="object")return;let a,o="";for(let c=r;c<i.length;++c)if(c!==r&&(o+=t),o+=i[c],a=s[o],a!==void 0){if(["string","number","boolean"].indexOf(typeof a)>-1&&c<i.length-1)continue;r+=c-r+1;break}s=a}return s},Lm=n=>n==null?void 0:n.replace("_","-"),ZO={type:"logger",log(n){this.output("log",n)},warn(n){this.output("warn",n)},error(n){this.output("error",n)},output(n,e){var t,i;(i=(t=console==null?void 0:console[n])==null?void 0:t.apply)==null||i.call(t,console,e)}};class ob{constructor(e,t={}){this.init(e,t)}init(e,t={}){this.prefix=t.prefix||"i18next:",this.logger=e||ZO,this.options=t,this.debug=t.debug}log(...e){return this.forward(e,"log","",!0)}warn(...e){return this.forward(e,"warn","",!0)}error(...e){return this.forward(e,"error","")}deprecate(...e){return this.forward(e,"warn","WARNING DEPRECATED: ",!0)}forward(e,t,i,s){return s&&!this.debug?null:(lt(e[0])&&(e[0]=`${i}${this.prefix} ${e[0]}`),this.logger[t](e))}create(e){return new ob(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return e=e||this.options,e.prefix=e.prefix||this.prefix,new ob(this.logger,e)}}var Ka=new ob;let R1=class{constructor(){this.observers={}}on(e,t){return e.split(" ").forEach(i=>{this.observers[i]||(this.observers[i]=new Map);const s=this.observers[i].get(t)||0;this.observers[i].set(t,s+1)}),this}off(e,t){if(this.observers[e]){if(!t){delete this.observers[e];return}this.observers[e].delete(t)}}emit(e,...t){this.observers[e]&&Array.from(this.observers[e].entries()).forEach(([s,r])=>{for(let a=0;a<r;a++)s(...t)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(([s,r])=>{for(let a=0;a<r;a++)s.apply(s,[e,...t])})}};class VN extends R1{constructor(e,t={ns:["translation"],defaultNS:"translation"}){super(),this.data=e||{},this.options=t,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}getResource(e,t,i,s={}){var h,d;const r=s.keySeparator!==void 0?s.keySeparator:this.options.keySeparator,a=s.ignoreJSONStructure!==void 0?s.ignoreJSONStructure:this.options.ignoreJSONStructure;let o;e.indexOf(".")>-1?o=e.split("."):(o=[e,t],i&&(Array.isArray(i)?o.push(...i):lt(i)&&r?o.push(...i.split(r)):o.push(i)));const c=ab(this.data,o);return!c&&!t&&!i&&e.indexOf(".")>-1&&(e=o[0],t=o[1],i=o.slice(2).join(".")),c||!a||!lt(i)?c:K2((d=(h=this.data)==null?void 0:h[e])==null?void 0:d[t],i,r)}addResource(e,t,i,s,r={silent:!1}){const a=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator;let o=[e,t];i&&(o=o.concat(a?i.split(a):i)),e.indexOf(".")>-1&&(o=e.split("."),s=t,t=o[1]),this.addNamespaces(t),qN(this.data,o,s),r.silent||this.emit("added",e,t,i,s)}addResources(e,t,i,s={silent:!1}){for(const r in i)(lt(i[r])||Array.isArray(i[r]))&&this.addResource(e,t,r,i[r],{silent:!0});s.silent||this.emit("added",e,t,i)}addResourceBundle(e,t,i,s,r,a={silent:!1,skipCopy:!1}){let o=[e,t];e.indexOf(".")>-1&&(o=e.split("."),s=i,i=t,t=o[1]),this.addNamespaces(t);let c=ab(this.data,o)||{};a.skipCopy||(i=JSON.parse(JSON.stringify(i))),s?qD(c,i,r):c={...c,...i},qN(this.data,o,c),a.silent||this.emit("added",e,t,i)}removeResourceBundle(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}hasResourceBundle(e,t){return this.getResource(e,t)!==void 0}getResourceBundle(e,t){return t||(t=this.options.defaultNS),this.getResource(e,t)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const t=this.getDataByLanguage(e);return!!(t&&Object.keys(t)||[]).find(s=>t[s]&&Object.keys(t[s]).length>0)}toJSON(){return this.data}}var VD={processors:{},addPostProcessor(n){this.processors[n.name]=n},handle(n,e,t,i,s){return n.forEach(r=>{var a;e=((a=this.processors[r])==null?void 0:a.process(e,t,i,s))??e}),e}};const GD=Symbol("i18next/PATH_KEY");function QO(){const n=[],e=Object.create(null);let t;return e.get=(i,s)=>{var r;return(r=t==null?void 0:t.revoke)==null||r.call(t),s===GD?n:(n.push(s),t=Proxy.revocable(i,e),t.proxy)},Proxy.revocable(Object.create(null),e).proxy}function Z2(n,e){const{[GD]:t}=n(QO());return t.join((e==null?void 0:e.keySeparator)??".")}const GN={},Rw=n=>!lt(n)&&typeof n!="boolean"&&typeof n!="number";class lb extends R1{constructor(e,t={}){super(),UO(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=t,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=Ka.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e,t={interpolation:{}}){const i={...t};if(e==null)return!1;const s=this.resolve(e,i);if((s==null?void 0:s.res)===void 0)return!1;const r=Rw(s.res);return!(i.returnObjects===!1&&r)}extractFromKey(e,t){let i=t.nsSeparator!==void 0?t.nsSeparator:this.options.nsSeparator;i===void 0&&(i=":");const s=t.keySeparator!==void 0?t.keySeparator:this.options.keySeparator;let r=t.ns||this.options.defaultNS||[];const a=i&&e.indexOf(i)>-1,o=!this.options.userDefinedKeySeparator&&!t.keySeparator&&!this.options.userDefinedNsSeparator&&!t.nsSeparator&&!KO(e,i,s);if(a&&!o){const c=e.match(this.interpolator.nestingRegexp);if(c&&c.length>0)return{key:e,namespaces:lt(r)?[r]:r};const h=e.split(i);(i!==s||i===s&&this.options.ns.indexOf(h[0])>-1)&&(r=h.shift()),e=h.join(s)}return{key:e,namespaces:lt(r)?[r]:r}}translate(e,t,i){let s=typeof t=="object"?{...t}:t;if(typeof s!="object"&&this.options.overloadTranslationOptionHandler&&(s=this.options.overloadTranslationOptionHandler(arguments)),typeof s=="object"&&(s={...s}),s||(s={}),e==null)return"";typeof e=="function"&&(e=Z2(e,{...this.options,...s})),Array.isArray(e)||(e=[String(e)]);const r=s.returnDetails!==void 0?s.returnDetails:this.options.returnDetails,a=s.keySeparator!==void 0?s.keySeparator:this.options.keySeparator,{key:o,namespaces:c}=this.extractFromKey(e[e.length-1],s),h=c[c.length-1];let d=s.nsSeparator!==void 0?s.nsSeparator:this.options.nsSeparator;d===void 0&&(d=":");const f=s.lng||this.language,p=s.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if((f==null?void 0:f.toLowerCase())==="cimode")return p?r?{res:`${h}${d}${o}`,usedKey:o,exactUsedKey:o,usedLng:f,usedNS:h,usedParams:this.getUsedParamsDetails(s)}:`${h}${d}${o}`:r?{res:o,usedKey:o,exactUsedKey:o,usedLng:f,usedNS:h,usedParams:this.getUsedParamsDetails(s)}:o;const g=this.resolve(e,s);let v=g==null?void 0:g.res;const b=(g==null?void 0:g.usedKey)||o,x=(g==null?void 0:g.exactUsedKey)||o,m=["[object Number]","[object Function]","[object RegExp]"],y=s.joinArrays!==void 0?s.joinArrays:this.options.joinArrays,w=!this.i18nFormat||this.i18nFormat.handleAsObject,E=s.count!==void 0&&!lt(s.count),S=lb.hasDefaultValue(s),_=E?this.pluralResolver.getSuffix(f,s.count,s):"",T=s.ordinal&&E?this.pluralResolver.getSuffix(f,s.count,{ordinal:!1}):"",j=E&&!s.ordinal&&s.count===0,M=j&&s[`defaultValue${this.options.pluralSeparator}zero`]||s[`defaultValue${_}`]||s[`defaultValue${T}`]||s.defaultValue;let L=v;w&&!v&&S&&(L=M);const O=Rw(L),B=Object.prototype.toString.apply(L);if(w&&L&&O&&m.indexOf(B)<0&&!(lt(y)&&Array.isArray(L))){if(!s.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const G=this.options.returnedObjectHandler?this.options.returnedObjectHandler(b,L,{...s,ns:c}):`key '${o} (${this.language})' returned an object instead of string.`;return r?(g.res=G,g.usedParams=this.getUsedParamsDetails(s),g):G}if(a){const G=Array.isArray(L),W=G?[]:{},J=G?x:b;for(const V in L)if(Object.prototype.hasOwnProperty.call(L,V)){const H=`${J}${a}${V}`;S&&!v?W[V]=this.translate(H,{...s,defaultValue:Rw(M)?M[V]:void 0,joinArrays:!1,ns:c}):W[V]=this.translate(H,{...s,joinArrays:!1,ns:c}),W[V]===H&&(W[V]=L[V])}v=W}}else if(w&&lt(y)&&Array.isArray(v))v=v.join(y),v&&(v=this.extendTranslation(v,e,s,i));else{let G=!1,W=!1;!this.isValidLookup(v)&&S&&(G=!0,v=M),this.isValidLookup(v)||(W=!0,v=o);const V=(s.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&W?void 0:v,H=S&&M!==v&&this.options.updateMissing;if(W||G||H){if(this.logger.log(H?"updateKey":"missingKey",f,h,o,H?M:v),a){const ae=this.resolve(o,{...s,keySeparator:!1});ae&&ae.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let P=[];const Y=this.languageUtils.getFallbackCodes(this.options.fallbackLng,s.lng||this.language);if(this.options.saveMissingTo==="fallback"&&Y&&Y[0])for(let ae=0;ae<Y.length;ae++)P.push(Y[ae]);else this.options.saveMissingTo==="all"?P=this.languageUtils.toResolveHierarchy(s.lng||this.language):P.push(s.lng||this.language);const ge=(ae,ee,le)=>{var Q;const ie=S&&le!==v?le:V;this.options.missingKeyHandler?this.options.missingKeyHandler(ae,h,ee,ie,H,s):(Q=this.backendConnector)!=null&&Q.saveMissing&&this.backendConnector.saveMissing(ae,h,ee,ie,H,s),this.emit("missingKey",ae,h,ee,v)};this.options.saveMissing&&(this.options.saveMissingPlurals&&E?P.forEach(ae=>{const ee=this.pluralResolver.getSuffixes(ae,s);j&&s[`defaultValue${this.options.pluralSeparator}zero`]&&ee.indexOf(`${this.options.pluralSeparator}zero`)<0&&ee.push(`${this.options.pluralSeparator}zero`),ee.forEach(le=>{ge([ae],o+le,s[`defaultValue${le}`]||M)})}):ge(P,o,M))}v=this.extendTranslation(v,e,s,g,i),W&&v===o&&this.options.appendNamespaceToMissingKey&&(v=`${h}${d}${o}`),(W||G)&&this.options.parseMissingKeyHandler&&(v=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${h}${d}${o}`:o,G?v:void 0,s))}return r?(g.res=v,g.usedParams=this.getUsedParamsDetails(s),g):v}extendTranslation(e,t,i,s,r){var c,h;if((c=this.i18nFormat)!=null&&c.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...i},i.lng||this.language||s.usedLng,s.usedNS,s.usedKey,{resolved:s});else if(!i.skipInterpolation){i.interpolation&&this.interpolator.init({...i,interpolation:{...this.options.interpolation,...i.interpolation}});const d=lt(e)&&(((h=i==null?void 0:i.interpolation)==null?void 0:h.skipOnVariables)!==void 0?i.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let f;if(d){const g=e.match(this.interpolator.nestingRegexp);f=g&&g.length}let p=i.replace&&!lt(i.replace)?i.replace:i;if(this.options.interpolation.defaultVariables&&(p={...this.options.interpolation.defaultVariables,...p}),e=this.interpolator.interpolate(e,p,i.lng||this.language||s.usedLng,i),d){const g=e.match(this.interpolator.nestingRegexp),v=g&&g.length;f<v&&(i.nest=!1)}!i.lng&&s&&s.res&&(i.lng=this.language||s.usedLng),i.nest!==!1&&(e=this.interpolator.nest(e,(...g)=>(r==null?void 0:r[0])===g[0]&&!i.context?(this.logger.warn(`It seems you are nesting recursively key: ${g[0]} in key: ${t[0]}`),null):this.translate(...g,t),i)),i.interpolation&&this.interpolator.reset()}const a=i.postProcess||this.options.postProcess,o=lt(a)?[a]:a;return e!=null&&(o!=null&&o.length)&&i.applyPostProcessor!==!1&&(e=VD.handle(o,e,t,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...s,usedParams:this.getUsedParamsDetails(i)},...i}:i,this)),e}resolve(e,t={}){let i,s,r,a,o;return lt(e)&&(e=[e]),e.forEach(c=>{if(this.isValidLookup(i))return;const h=this.extractFromKey(c,t),d=h.key;s=d;let f=h.namespaces;this.options.fallbackNS&&(f=f.concat(this.options.fallbackNS));const p=t.count!==void 0&&!lt(t.count),g=p&&!t.ordinal&&t.count===0,v=t.context!==void 0&&(lt(t.context)||typeof t.context=="number")&&t.context!=="",b=t.lngs?t.lngs:this.languageUtils.toResolveHierarchy(t.lng||this.language,t.fallbackLng);f.forEach(x=>{var m,y;this.isValidLookup(i)||(o=x,!GN[`${b[0]}-${x}`]&&((m=this.utils)!=null&&m.hasLoadedNamespace)&&!((y=this.utils)!=null&&y.hasLoadedNamespace(o))&&(GN[`${b[0]}-${x}`]=!0,this.logger.warn(`key "${s}" for languages "${b.join(", ")}" won't get resolved as namespace "${o}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),b.forEach(w=>{var _;if(this.isValidLookup(i))return;a=w;const E=[d];if((_=this.i18nFormat)!=null&&_.addLookupKeys)this.i18nFormat.addLookupKeys(E,d,w,x,t);else{let T;p&&(T=this.pluralResolver.getSuffix(w,t.count,t));const j=`${this.options.pluralSeparator}zero`,M=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(p&&(t.ordinal&&T.indexOf(M)===0&&E.push(d+T.replace(M,this.options.pluralSeparator)),E.push(d+T),g&&E.push(d+j)),v){const L=`${d}${this.options.contextSeparator||"_"}${t.context}`;E.push(L),p&&(t.ordinal&&T.indexOf(M)===0&&E.push(L+T.replace(M,this.options.pluralSeparator)),E.push(L+T),g&&E.push(L+j))}}let S;for(;S=E.pop();)this.isValidLookup(i)||(r=S,i=this.getResource(w,x,S,t))}))})}),{res:i,usedKey:s,exactUsedKey:r,usedLng:a,usedNS:o}}isValidLookup(e){return e!==void 0&&!(!this.options.returnNull&&e===null)&&!(!this.options.returnEmptyString&&e==="")}getResource(e,t,i,s={}){var r;return(r=this.i18nFormat)!=null&&r.getResource?this.i18nFormat.getResource(e,t,i,s):this.resourceStore.getResource(e,t,i,s)}getUsedParamsDetails(e={}){const t=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],i=e.replace&&!lt(e.replace);let s=i?e.replace:e;if(i&&typeof e.count<"u"&&(s.count=e.count),this.options.interpolation.defaultVariables&&(s={...this.options.interpolation.defaultVariables,...s}),!i){s={...s};for(const r of t)delete s[r]}return s}static hasDefaultValue(e){const t="defaultValue";for(const i in e)if(Object.prototype.hasOwnProperty.call(e,i)&&t===i.substring(0,t.length)&&e[i]!==void 0)return!0;return!1}}class WN{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=Ka.create("languageUtils")}getScriptPartFromCode(e){if(e=Lm(e),!e||e.indexOf("-")<0)return null;const t=e.split("-");return t.length===2||(t.pop(),t[t.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(t.join("-"))}getLanguagePartFromCode(e){if(e=Lm(e),!e||e.indexOf("-")<0)return e;const t=e.split("-");return this.formatLanguageCode(t[0])}formatLanguageCode(e){if(lt(e)&&e.indexOf("-")>-1){let t;try{t=Intl.getCanonicalLocales(e)[0]}catch{}return t&&this.options.lowerCaseLng&&(t=t.toLowerCase()),t||(this.options.lowerCaseLng?e.toLowerCase():e)}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let t;return e.forEach(i=>{if(t)return;const s=this.formatLanguageCode(i);(!this.options.supportedLngs||this.isSupportedCode(s))&&(t=s)}),!t&&this.options.supportedLngs&&e.forEach(i=>{if(t)return;const s=this.getScriptPartFromCode(i);if(this.isSupportedCode(s))return t=s;const r=this.getLanguagePartFromCode(i);if(this.isSupportedCode(r))return t=r;t=this.options.supportedLngs.find(a=>{if(a===r)return a;if(!(a.indexOf("-")<0&&r.indexOf("-")<0)&&(a.indexOf("-")>0&&r.indexOf("-")<0&&a.substring(0,a.indexOf("-"))===r||a.indexOf(r)===0&&r.length>1))return a})}),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t}getFallbackCodes(e,t){if(!e)return[];if(typeof e=="function"&&(e=e(t)),lt(e)&&(e=[e]),Array.isArray(e))return e;if(!t)return e.default||[];let i=e[t];return i||(i=e[this.getScriptPartFromCode(t)]),i||(i=e[this.formatLanguageCode(t)]),i||(i=e[this.getLanguagePartFromCode(t)]),i||(i=e.default),i||[]}toResolveHierarchy(e,t){const i=this.getFallbackCodes((t===!1?[]:t)||this.options.fallbackLng||[],e),s=[],r=a=>{a&&(this.isSupportedCode(a)?s.push(a):this.logger.warn(`rejecting language code not found in supportedLngs: ${a}`))};return lt(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&r(this.formatLanguageCode(e)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&r(this.getScriptPartFromCode(e)),this.options.load!=="currentOnly"&&r(this.getLanguagePartFromCode(e))):lt(e)&&r(this.formatLanguageCode(e)),i.forEach(a=>{s.indexOf(a)<0&&r(this.formatLanguageCode(a))}),s}}const YN={zero:0,one:1,two:2,few:3,many:4,other:5},XN={select:n=>n===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class JO{constructor(e,t={}){this.languageUtils=e,this.options=t,this.logger=Ka.create("pluralResolver"),this.pluralRulesCache={}}clearCache(){this.pluralRulesCache={}}getRule(e,t={}){const i=Lm(e==="dev"?"en":e),s=t.ordinal?"ordinal":"cardinal",r=JSON.stringify({cleanedCode:i,type:s});if(r in this.pluralRulesCache)return this.pluralRulesCache[r];let a;try{a=new Intl.PluralRules(i,{type:s})}catch{if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),XN;if(!e.match(/-|_/))return XN;const c=this.languageUtils.getLanguagePartFromCode(e);a=this.getRule(c,t)}return this.pluralRulesCache[r]=a,a}needsPlural(e,t={}){let i=this.getRule(e,t);return i||(i=this.getRule("dev",t)),(i==null?void 0:i.resolvedOptions().pluralCategories.length)>1}getPluralFormsOfKey(e,t,i={}){return this.getSuffixes(e,i).map(s=>`${t}${s}`)}getSuffixes(e,t={}){let i=this.getRule(e,t);return i||(i=this.getRule("dev",t)),i?i.resolvedOptions().pluralCategories.sort((s,r)=>YN[s]-YN[r]).map(s=>`${this.options.prepend}${t.ordinal?`ordinal${this.options.prepend}`:""}${s}`):[]}getSuffix(e,t,i={}){const s=this.getRule(e,i);return s?`${this.options.prepend}${i.ordinal?`ordinal${this.options.prepend}`:""}${s.select(t)}`:(this.logger.warn(`no plural rule found for: ${e}`),this.getSuffix("dev",t,i))}}const KN=(n,e,t,i=".",s=!0)=>{let r=qO(n,e,t);return!r&&s&&lt(t)&&(r=K2(n,t,i),r===void 0&&(r=K2(e,t,i))),r},Lw=n=>n.replace(/\$/g,"$$$$");class ZN{constructor(e={}){var t;this.logger=Ka.create("interpolator"),this.options=e,this.format=((t=e==null?void 0:e.interpolation)==null?void 0:t.format)||(i=>i),this.init(e)}init(e={}){e.interpolation||(e.interpolation={escapeValue:!0});const{escape:t,escapeValue:i,useRawValueToEscape:s,prefix:r,prefixEscaped:a,suffix:o,suffixEscaped:c,formatSeparator:h,unescapeSuffix:d,unescapePrefix:f,nestingPrefix:p,nestingPrefixEscaped:g,nestingSuffix:v,nestingSuffixEscaped:b,nestingOptionsSeparator:x,maxReplaces:m,alwaysFormat:y}=e.interpolation;this.escape=t!==void 0?t:GO,this.escapeValue=i!==void 0?i:!0,this.useRawValueToEscape=s!==void 0?s:!1,this.prefix=r?fd(r):a||"{{",this.suffix=o?fd(o):c||"}}",this.formatSeparator=h||",",this.unescapePrefix=d?"":f||"-",this.unescapeSuffix=this.unescapePrefix?"":d||"",this.nestingPrefix=p?fd(p):g||fd("$t("),this.nestingSuffix=v?fd(v):b||fd(")"),this.nestingOptionsSeparator=x||",",this.maxReplaces=m||1e3,this.alwaysFormat=y!==void 0?y:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(t,i)=>(t==null?void 0:t.source)===i?(t.lastIndex=0,t):new RegExp(i,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}((?:[^()"']+|"[^"]*"|'[^']*'|\\((?:[^()]|"[^"]*"|'[^']*')*\\))*?)${this.nestingSuffix}`)}interpolate(e,t,i,s){var g;let r,a,o;const c=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},h=v=>{if(v.indexOf(this.formatSeparator)<0){const y=KN(t,c,v,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(y,void 0,i,{...s,...t,interpolationkey:v}):y}const b=v.split(this.formatSeparator),x=b.shift().trim(),m=b.join(this.formatSeparator).trim();return this.format(KN(t,c,x,this.options.keySeparator,this.options.ignoreJSONStructure),m,i,{...s,...t,interpolationkey:x})};this.resetRegExp();const d=(s==null?void 0:s.missingInterpolationHandler)||this.options.missingInterpolationHandler,f=((g=s==null?void 0:s.interpolation)==null?void 0:g.skipOnVariables)!==void 0?s.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:v=>Lw(v)},{regex:this.regexp,safeValue:v=>this.escapeValue?Lw(this.escape(v)):Lw(v)}].forEach(v=>{for(o=0;r=v.regex.exec(e);){const b=r[1].trim();if(a=h(b),a===void 0)if(typeof d=="function"){const m=d(e,r,s);a=lt(m)?m:""}else if(s&&Object.prototype.hasOwnProperty.call(s,b))a="";else if(f){a=r[0];continue}else this.logger.warn(`missed to pass in variable ${b} for interpolating ${e}`),a="";else!lt(a)&&!this.useRawValueToEscape&&(a=UN(a));const x=v.safeValue(a);if(e=e.replace(r[0],x),f?(v.regex.lastIndex+=a.length,v.regex.lastIndex-=r[0].length):v.regex.lastIndex=0,o++,o>=this.maxReplaces)break}}),e}nest(e,t,i={}){let s,r,a;const o=(c,h)=>{const d=this.nestingOptionsSeparator;if(c.indexOf(d)<0)return c;const f=c.split(new RegExp(`${d}[ ]*{`));let p=`{${f[1]}`;c=f[0],p=this.interpolate(p,a);const g=p.match(/'/g),v=p.match(/"/g);(((g==null?void 0:g.length)??0)%2===0&&!v||v.length%2!==0)&&(p=p.replace(/'/g,'"'));try{a=JSON.parse(p),h&&(a={...h,...a})}catch(b){return this.logger.warn(`failed parsing options string in nesting for key ${c}`,b),`${c}${d}${p}`}return a.defaultValue&&a.defaultValue.indexOf(this.prefix)>-1&&delete a.defaultValue,c};for(;s=this.nestingRegexp.exec(e);){let c=[];a={...i},a=a.replace&&!lt(a.replace)?a.replace:a,a.applyPostProcessor=!1,delete a.defaultValue;const h=/{.*}/.test(s[1])?s[1].lastIndexOf("}")+1:s[1].indexOf(this.formatSeparator);if(h!==-1&&(c=s[1].slice(h).split(this.formatSeparator).map(d=>d.trim()).filter(Boolean),s[1]=s[1].slice(0,h)),r=t(o.call(this,s[1].trim(),a),a),r&&s[0]===e&&!lt(r))return r;lt(r)||(r=UN(r)),r||(this.logger.warn(`missed to resolve ${s[1]} for nesting ${e}`),r=""),c.length&&(r=c.reduce((d,f)=>this.format(d,f,i.lng,{...i,interpolationkey:s[1].trim()}),r.trim())),e=e.replace(s[0],r),this.regexp.lastIndex=0}return e}}const eP=n=>{let e=n.toLowerCase().trim();const t={};if(n.indexOf("(")>-1){const i=n.split("(");e=i[0].toLowerCase().trim();const s=i[1].substring(0,i[1].length-1);e==="currency"&&s.indexOf(":")<0?t.currency||(t.currency=s.trim()):e==="relativetime"&&s.indexOf(":")<0?t.range||(t.range=s.trim()):s.split(";").forEach(a=>{if(a){const[o,...c]=a.split(":"),h=c.join(":").trim().replace(/^'+|'+$/g,""),d=o.trim();t[d]||(t[d]=h),h==="false"&&(t[d]=!1),h==="true"&&(t[d]=!0),isNaN(h)||(t[d]=parseInt(h,10))}})}return{formatName:e,formatOptions:t}},QN=n=>{const e={};return(t,i,s)=>{let r=s;s&&s.interpolationkey&&s.formatParams&&s.formatParams[s.interpolationkey]&&s[s.interpolationkey]&&(r={...r,[s.interpolationkey]:void 0});const a=i+JSON.stringify(r);let o=e[a];return o||(o=n(Lm(i),s),e[a]=o),o(t)}},tP=n=>(e,t,i)=>n(Lm(t),i)(e);class nP{constructor(e={}){this.logger=Ka.create("formatter"),this.options=e,this.init(e)}init(e,t={interpolation:{}}){this.formatSeparator=t.interpolation.formatSeparator||",";const i=t.cacheInBuiltFormats?QN:tP;this.formats={number:i((s,r)=>{const a=new Intl.NumberFormat(s,{...r});return o=>a.format(o)}),currency:i((s,r)=>{const a=new Intl.NumberFormat(s,{...r,style:"currency"});return o=>a.format(o)}),datetime:i((s,r)=>{const a=new Intl.DateTimeFormat(s,{...r});return o=>a.format(o)}),relativetime:i((s,r)=>{const a=new Intl.RelativeTimeFormat(s,{...r});return o=>a.format(o,r.range||"day")}),list:i((s,r)=>{const a=new Intl.ListFormat(s,{...r});return o=>a.format(o)})}}add(e,t){this.formats[e.toLowerCase().trim()]=t}addCached(e,t){this.formats[e.toLowerCase().trim()]=QN(t)}format(e,t,i,s={}){const r=t.split(this.formatSeparator);if(r.length>1&&r[0].indexOf("(")>1&&r[0].indexOf(")")<0&&r.find(o=>o.indexOf(")")>-1)){const o=r.findIndex(c=>c.indexOf(")")>-1);r[0]=[r[0],...r.splice(1,o)].join(this.formatSeparator)}return r.reduce((o,c)=>{var f;const{formatName:h,formatOptions:d}=eP(c);if(this.formats[h]){let p=o;try{const g=((f=s==null?void 0:s.formatParams)==null?void 0:f[s.interpolationkey])||{},v=g.locale||g.lng||s.locale||s.lng||i;p=this.formats[h](o,v,{...d,...s,...g})}catch(g){this.logger.warn(g)}return p}else this.logger.warn(`there was no format function for ${h}`);return o},e)}}const iP=(n,e)=>{n.pending[e]!==void 0&&(delete n.pending[e],n.pendingCount--)};class sP extends R1{constructor(e,t,i,s={}){var r,a;super(),this.backend=e,this.store=t,this.services=i,this.languageUtils=i.languageUtils,this.options=s,this.logger=Ka.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=s.maxParallelReads||10,this.readingCalls=0,this.maxRetries=s.maxRetries>=0?s.maxRetries:5,this.retryTimeout=s.retryTimeout>=1?s.retryTimeout:350,this.state={},this.queue=[],(a=(r=this.backend)==null?void 0:r.init)==null||a.call(r,i,s.backend,s)}queueLoad(e,t,i,s){const r={},a={},o={},c={};return e.forEach(h=>{let d=!0;t.forEach(f=>{const p=`${h}|${f}`;!i.reload&&this.store.hasResourceBundle(h,f)?this.state[p]=2:this.state[p]<0||(this.state[p]===1?a[p]===void 0&&(a[p]=!0):(this.state[p]=1,d=!1,a[p]===void 0&&(a[p]=!0),r[p]===void 0&&(r[p]=!0),c[f]===void 0&&(c[f]=!0)))}),d||(o[h]=!0)}),(Object.keys(r).length||Object.keys(a).length)&&this.queue.push({pending:a,pendingCount:Object.keys(a).length,loaded:{},errors:[],callback:s}),{toLoad:Object.keys(r),pending:Object.keys(a),toLoadLanguages:Object.keys(o),toLoadNamespaces:Object.keys(c)}}loaded(e,t,i){const s=e.split("|"),r=s[0],a=s[1];t&&this.emit("failedLoading",r,a,t),!t&&i&&this.store.addResourceBundle(r,a,i,void 0,void 0,{skipCopy:!0}),this.state[e]=t?-1:2,t&&i&&(this.state[e]=0);const o={};this.queue.forEach(c=>{$O(c.loaded,[r],a),iP(c,e),t&&c.errors.push(t),c.pendingCount===0&&!c.done&&(Object.keys(c.loaded).forEach(h=>{o[h]||(o[h]={});const d=c.loaded[h];d.length&&d.forEach(f=>{o[h][f]===void 0&&(o[h][f]=!0)})}),c.done=!0,c.errors.length?c.callback(c.errors):c.callback())}),this.emit("loaded",o),this.queue=this.queue.filter(c=>!c.done)}read(e,t,i,s=0,r=this.retryTimeout,a){if(!e.length)return a(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:e,ns:t,fcName:i,tried:s,wait:r,callback:a});return}this.readingCalls++;const o=(h,d)=>{if(this.readingCalls--,this.waitingReads.length>0){const f=this.waitingReads.shift();this.read(f.lng,f.ns,f.fcName,f.tried,f.wait,f.callback)}if(h&&d&&s<this.maxRetries){setTimeout(()=>{this.read.call(this,e,t,i,s+1,r*2,a)},r);return}a(h,d)},c=this.backend[i].bind(this.backend);if(c.length===2){try{const h=c(e,t);h&&typeof h.then=="function"?h.then(d=>o(null,d)).catch(o):o(null,h)}catch(h){o(h)}return}return c(e,t,o)}prepareLoading(e,t,i={},s){if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),s&&s();lt(e)&&(e=this.languageUtils.toResolveHierarchy(e)),lt(t)&&(t=[t]);const r=this.queueLoad(e,t,i,s);if(!r.toLoad.length)return r.pending.length||s(),null;r.toLoad.forEach(a=>{this.loadOne(a)})}load(e,t,i){this.prepareLoading(e,t,{},i)}reload(e,t,i){this.prepareLoading(e,t,{reload:!0},i)}loadOne(e,t=""){const i=e.split("|"),s=i[0],r=i[1];this.read(s,r,"read",void 0,void 0,(a,o)=>{a&&this.logger.warn(`${t}loading namespace ${r} for language ${s} failed`,a),!a&&o&&this.logger.log(`${t}loaded namespace ${r} for language ${s}`,o),this.loaded(e,a,o)})}saveMissing(e,t,i,s,r,a={},o=()=>{}){var c,h,d,f,p;if((h=(c=this.services)==null?void 0:c.utils)!=null&&h.hasLoadedNamespace&&!((f=(d=this.services)==null?void 0:d.utils)!=null&&f.hasLoadedNamespace(t))){this.logger.warn(`did not save key "${i}" as the namespace "${t}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(i==null||i==="")){if((p=this.backend)!=null&&p.create){const g={...a,isUpdate:r},v=this.backend.create.bind(this.backend);if(v.length<6)try{let b;v.length===5?b=v(e,t,i,s,g):b=v(e,t,i,s),b&&typeof b.then=="function"?b.then(x=>o(null,x)).catch(o):o(null,b)}catch(b){o(b)}else v(e,t,i,s,o,g)}!e||!e[0]||this.store.addResource(e[0],t,i,s)}}}const Mw=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:n=>{let e={};if(typeof n[1]=="object"&&(e=n[1]),lt(n[1])&&(e.defaultValue=n[1]),lt(n[2])&&(e.tDescription=n[2]),typeof n[2]=="object"||typeof n[3]=="object"){const t=n[3]||n[2];Object.keys(t).forEach(i=>{e[i]=t[i]})}return e},interpolation:{escapeValue:!0,format:n=>n,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0},cacheInBuiltFormats:!0}),JN=n=>{var e,t;return lt(n.ns)&&(n.ns=[n.ns]),lt(n.fallbackLng)&&(n.fallbackLng=[n.fallbackLng]),lt(n.fallbackNS)&&(n.fallbackNS=[n.fallbackNS]),((t=(e=n.supportedLngs)==null?void 0:e.indexOf)==null?void 0:t.call(e,"cimode"))<0&&(n.supportedLngs=n.supportedLngs.concat(["cimode"])),typeof n.initImmediate=="boolean"&&(n.initAsync=n.initImmediate),n},ky=()=>{},rP=n=>{Object.getOwnPropertyNames(Object.getPrototypeOf(n)).forEach(t=>{typeof n[t]=="function"&&(n[t]=n[t].bind(n))})};let e_=!1;const aP=n=>{var e,t,i,s,r,a,o,c,h;return!!(((i=(t=(e=n==null?void 0:n.modules)==null?void 0:e.backend)==null?void 0:t.name)==null?void 0:i.indexOf("Locize"))>0||((o=(a=(r=(s=n==null?void 0:n.modules)==null?void 0:s.backend)==null?void 0:r.constructor)==null?void 0:a.name)==null?void 0:o.indexOf("Locize"))>0||(h=(c=n==null?void 0:n.options)==null?void 0:c.backend)!=null&&h.backends&&n.options.backend.backends.some(d=>{var f,p,g;return((f=d==null?void 0:d.name)==null?void 0:f.indexOf("Locize"))>0||((g=(p=d==null?void 0:d.constructor)==null?void 0:p.name)==null?void 0:g.indexOf("Locize"))>0}))};class mm extends R1{constructor(e={},t){if(super(),this.options=JN(e),this.services={},this.logger=Ka,this.modules={external:[]},rP(this),t&&!this.isInitialized&&!e.isClone){if(!this.options.initAsync)return this.init(e,t),this;setTimeout(()=>{this.init(e,t)},0)}}init(e={},t){this.isInitializing=!0,typeof e=="function"&&(t=e,e={}),e.defaultNS==null&&e.ns&&(lt(e.ns)?e.defaultNS=e.ns:e.ns.indexOf("translation")<0&&(e.defaultNS=e.ns[0]));const i=Mw();this.options={...i,...this.options,...JN(e)},this.options.interpolation={...i.interpolation,...this.options.interpolation},e.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=e.keySeparator),e.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=e.nsSeparator),typeof this.options.overloadTranslationOptionHandler!="function"&&(this.options.overloadTranslationOptionHandler=i.overloadTranslationOptionHandler),this.options.showSupportNotice!==!1&&!aP(this)&&!e_&&(typeof console<"u"&&typeof console.info<"u"&&console.info("ðŸŒ i18next is maintained with support from Locize â€” consider powering your project with managed localization (AI, CDN, integrations): https://locize.com ðŸ’™"),e_=!0);const s=h=>h?typeof h=="function"?new h:h:null;if(!this.options.isClone){this.modules.logger?Ka.init(s(this.modules.logger),this.options):Ka.init(null,this.options);let h;this.modules.formatter?h=this.modules.formatter:h=nP;const d=new WN(this.options);this.store=new VN(this.options.resources,this.options);const f=this.services;f.logger=Ka,f.resourceStore=this.store,f.languageUtils=d,f.pluralResolver=new JO(d,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),this.options.interpolation.format&&this.options.interpolation.format!==i.interpolation.format&&this.logger.deprecate("init: you are still using the legacy format function, please use the new approach: https://www.i18next.com/translation-function/formatting"),h&&(!this.options.interpolation.format||this.options.interpolation.format===i.interpolation.format)&&(f.formatter=s(h),f.formatter.init&&f.formatter.init(f,this.options),this.options.interpolation.format=f.formatter.format.bind(f.formatter)),f.interpolator=new ZN(this.options),f.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},f.backendConnector=new sP(s(this.modules.backend),f.resourceStore,f,this.options),f.backendConnector.on("*",(g,...v)=>{this.emit(g,...v)}),this.modules.languageDetector&&(f.languageDetector=s(this.modules.languageDetector),f.languageDetector.init&&f.languageDetector.init(f,this.options.detection,this.options)),this.modules.i18nFormat&&(f.i18nFormat=s(this.modules.i18nFormat),f.i18nFormat.init&&f.i18nFormat.init(this)),this.translator=new lb(this.services,this.options),this.translator.on("*",(g,...v)=>{this.emit(g,...v)}),this.modules.external.forEach(g=>{g.init&&g.init(this)})}if(this.format=this.options.interpolation.format,t||(t=ky),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const h=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);h.length>0&&h[0]!=="dev"&&(this.options.lng=h[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(h=>{this[h]=(...d)=>this.store[h](...d)}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(h=>{this[h]=(...d)=>(this.store[h](...d),this)});const o=Cg(),c=()=>{const h=(d,f)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),o.resolve(f),t(d,f)};if(this.languages&&!this.isInitialized)return h(null,this.t.bind(this));this.changeLanguage(this.options.lng,h)};return this.options.resources||!this.options.initAsync?c():setTimeout(c,0),o}loadResources(e,t=ky){var r,a;let i=t;const s=lt(e)?e:this.language;if(typeof e=="function"&&(i=e),!this.options.resources||this.options.partialBundledLanguages){if((s==null?void 0:s.toLowerCase())==="cimode"&&(!this.options.preload||this.options.preload.length===0))return i();const o=[],c=h=>{if(!h||h==="cimode")return;this.services.languageUtils.toResolveHierarchy(h).forEach(f=>{f!=="cimode"&&o.indexOf(f)<0&&o.push(f)})};s?c(s):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(d=>c(d)),(a=(r=this.options.preload)==null?void 0:r.forEach)==null||a.call(r,h=>c(h)),this.services.backendConnector.load(o,this.options.ns,h=>{!h&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),i(h)})}else i(null)}reloadResources(e,t,i){const s=Cg();return typeof e=="function"&&(i=e,e=void 0),typeof t=="function"&&(i=t,t=void 0),e||(e=this.languages),t||(t=this.options.ns),i||(i=ky),this.services.backendConnector.reload(e,t,r=>{s.resolve(),i(r)}),s}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return e.type==="backend"&&(this.modules.backend=e),(e.type==="logger"||e.log&&e.warn&&e.error)&&(this.modules.logger=e),e.type==="languageDetector"&&(this.modules.languageDetector=e),e.type==="i18nFormat"&&(this.modules.i18nFormat=e),e.type==="postProcessor"&&VD.addPostProcessor(e),e.type==="formatter"&&(this.modules.formatter=e),e.type==="3rdParty"&&this.modules.external.push(e),this}setResolvedLanguage(e){if(!(!e||!this.languages)&&!(["cimode","dev"].indexOf(e)>-1)){for(let t=0;t<this.languages.length;t++){const i=this.languages[t];if(!(["cimode","dev"].indexOf(i)>-1)&&this.store.hasLanguageSomeTranslations(i)){this.resolvedLanguage=i;break}}!this.resolvedLanguage&&this.languages.indexOf(e)<0&&this.store.hasLanguageSomeTranslations(e)&&(this.resolvedLanguage=e,this.languages.unshift(e))}}changeLanguage(e,t){this.isLanguageChangingTo=e;const i=Cg();this.emit("languageChanging",e);const s=o=>{this.language=o,this.languages=this.services.languageUtils.toResolveHierarchy(o),this.resolvedLanguage=void 0,this.setResolvedLanguage(o)},r=(o,c)=>{c?this.isLanguageChangingTo===e&&(s(c),this.translator.changeLanguage(c),this.isLanguageChangingTo=void 0,this.emit("languageChanged",c),this.logger.log("languageChanged",c)):this.isLanguageChangingTo=void 0,i.resolve((...h)=>this.t(...h)),t&&t(o,(...h)=>this.t(...h))},a=o=>{var d,f;!e&&!o&&this.services.languageDetector&&(o=[]);const c=lt(o)?o:o&&o[0],h=this.store.hasLanguageSomeTranslations(c)?c:this.services.languageUtils.getBestMatchFromCodes(lt(o)?[o]:o);h&&(this.language||s(h),this.translator.language||this.translator.changeLanguage(h),(f=(d=this.services.languageDetector)==null?void 0:d.cacheUserLanguage)==null||f.call(d,h)),this.loadResources(h,p=>{r(p,h)})};return!e&&this.services.languageDetector&&!this.services.languageDetector.async?a(this.services.languageDetector.detect()):!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(a):this.services.languageDetector.detect(a):a(e),i}getFixedT(e,t,i){const s=(r,a,...o)=>{let c;typeof a!="object"?c=this.options.overloadTranslationOptionHandler([r,a].concat(o)):c={...a},c.lng=c.lng||s.lng,c.lngs=c.lngs||s.lngs,c.ns=c.ns||s.ns,c.keyPrefix!==""&&(c.keyPrefix=c.keyPrefix||i||s.keyPrefix);const h=this.options.keySeparator||".";let d;return c.keyPrefix&&Array.isArray(r)?d=r.map(f=>(typeof f=="function"&&(f=Z2(f,{...this.options,...a})),`${c.keyPrefix}${h}${f}`)):(typeof r=="function"&&(r=Z2(r,{...this.options,...a})),d=c.keyPrefix?`${c.keyPrefix}${h}${r}`:r),this.t(d,c)};return lt(e)?s.lng=e:s.lngs=e,s.ns=t,s.keyPrefix=i,s}t(...e){var t;return(t=this.translator)==null?void 0:t.translate(...e)}exists(...e){var t;return(t=this.translator)==null?void 0:t.exists(...e)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e,t={}){if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const i=t.lng||this.resolvedLanguage||this.languages[0],s=this.options?this.options.fallbackLng:!1,r=this.languages[this.languages.length-1];if(i.toLowerCase()==="cimode")return!0;const a=(o,c)=>{const h=this.services.backendConnector.state[`${o}|${c}`];return h===-1||h===0||h===2};if(t.precheck){const o=t.precheck(this,a);if(o!==void 0)return o}return!!(this.hasResourceBundle(i,e)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||a(i,e)&&(!s||a(r,e)))}loadNamespaces(e,t){const i=Cg();return this.options.ns?(lt(e)&&(e=[e]),e.forEach(s=>{this.options.ns.indexOf(s)<0&&this.options.ns.push(s)}),this.loadResources(s=>{i.resolve(),t&&t(s)}),i):(t&&t(),Promise.resolve())}loadLanguages(e,t){const i=Cg();lt(e)&&(e=[e]);const s=this.options.preload||[],r=e.filter(a=>s.indexOf(a)<0&&this.services.languageUtils.isSupportedCode(a));return r.length?(this.options.preload=s.concat(r),this.loadResources(a=>{i.resolve(),t&&t(a)}),i):(t&&t(),Promise.resolve())}dir(e){var s,r;if(e||(e=this.resolvedLanguage||(((s=this.languages)==null?void 0:s.length)>0?this.languages[0]:this.language)),!e)return"rtl";try{const a=new Intl.Locale(e);if(a&&a.getTextInfo){const o=a.getTextInfo();if(o&&o.direction)return o.direction}}catch{}const t=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],i=((r=this.services)==null?void 0:r.languageUtils)||new WN(Mw());return e.toLowerCase().indexOf("-latn")>1?"ltr":t.indexOf(i.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(e={},t){const i=new mm(e,t);return i.createInstance=mm.createInstance,i}cloneInstance(e={},t=ky){const i=e.forkResourceStore;i&&delete e.forkResourceStore;const s={...this.options,...e,isClone:!0},r=new mm(s);if((e.debug!==void 0||e.prefix!==void 0)&&(r.logger=r.logger.clone(e)),["store","services","language"].forEach(o=>{r[o]=this[o]}),r.services={...this.services},r.services.utils={hasLoadedNamespace:r.hasLoadedNamespace.bind(r)},i){const o=Object.keys(this.store.data).reduce((c,h)=>(c[h]={...this.store.data[h]},c[h]=Object.keys(c[h]).reduce((d,f)=>(d[f]={...c[h][f]},d),c[h]),c),{});r.store=new VN(o,s),r.services.resourceStore=r.store}if(e.interpolation){const c={...Mw().interpolation,...this.options.interpolation,...e.interpolation},h={...s,interpolation:c};r.services.interpolator=new ZN(h)}return r.translator=new lb(r.services,s),r.translator.on("*",(o,...c)=>{r.emit(o,...c)}),r.init(s,t),r.translator.options=s,r.translator.backendConnector.services.utils={hasLoadedNamespace:r.hasLoadedNamespace.bind(r)},r}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const Yi=mm.createInstance();Yi.createInstance;Yi.dir;Yi.init;Yi.loadResources;Yi.reloadResources;Yi.use;Yi.changeLanguage;Yi.getFixedT;Yi.t;Yi.exists;Yi.setDefaultNamespace;Yi.hasLoadedNamespace;Yi.loadNamespaces;Yi.loadLanguages;var zr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ed(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var WD={exports:{}},mt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qE=Symbol.for("react.transitional.element"),oP=Symbol.for("react.portal"),lP=Symbol.for("react.fragment"),cP=Symbol.for("react.strict_mode"),uP=Symbol.for("react.profiler"),hP=Symbol.for("react.consumer"),dP=Symbol.for("react.context"),fP=Symbol.for("react.forward_ref"),pP=Symbol.for("react.suspense"),gP=Symbol.for("react.memo"),YD=Symbol.for("react.lazy"),mP=Symbol.for("react.activity"),t_=Symbol.iterator;function xP(n){return n===null||typeof n!="object"?null:(n=t_&&n[t_]||n["@@iterator"],typeof n=="function"?n:null)}var XD={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},KD=Object.assign,ZD={};function ug(n,e,t){this.props=n,this.context=e,this.refs=ZD,this.updater=t||XD}ug.prototype.isReactComponent={};ug.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};ug.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function QD(){}QD.prototype=ug.prototype;function VE(n,e,t){this.props=n,this.context=e,this.refs=ZD,this.updater=t||XD}var GE=VE.prototype=new QD;GE.constructor=VE;KD(GE,ug.prototype);GE.isPureReactComponent=!0;var n_=Array.isArray;function Q2(){}var xn={H:null,A:null,T:null,S:null},JD=Object.prototype.hasOwnProperty;function WE(n,e,t){var i=t.ref;return{$$typeof:qE,type:n,key:e,ref:i!==void 0?i:null,props:t}}function yP(n,e){return WE(n.type,e,n.props)}function YE(n){return typeof n=="object"&&n!==null&&n.$$typeof===qE}function vP(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var i_=/\/+/g;function Ow(n,e){return typeof n=="object"&&n!==null&&n.key!=null?vP(""+n.key):e.toString(36)}function bP(n){switch(n.status){case"fulfilled":return n.value;case"rejected":throw n.reason;default:switch(typeof n.status=="string"?n.then(Q2,Q2):(n.status="pending",n.then(function(e){n.status==="pending"&&(n.status="fulfilled",n.value=e)},function(e){n.status==="pending"&&(n.status="rejected",n.reason=e)})),n.status){case"fulfilled":return n.value;case"rejected":throw n.reason}}throw n}function Nd(n,e,t,i,s){var r=typeof n;(r==="undefined"||r==="boolean")&&(n=null);var a=!1;if(n===null)a=!0;else switch(r){case"bigint":case"string":case"number":a=!0;break;case"object":switch(n.$$typeof){case qE:case oP:a=!0;break;case YD:return a=n._init,Nd(a(n._payload),e,t,i,s)}}if(a)return s=s(n),a=i===""?"."+Ow(n,0):i,n_(s)?(t="",a!=null&&(t=a.replace(i_,"$&/")+"/"),Nd(s,e,t,"",function(h){return h})):s!=null&&(YE(s)&&(s=yP(s,t+(s.key==null||n&&n.key===s.key?"":(""+s.key).replace(i_,"$&/")+"/")+a)),e.push(s)),1;a=0;var o=i===""?".":i+":";if(n_(n))for(var c=0;c<n.length;c++)i=n[c],r=o+Ow(i,c),a+=Nd(i,e,t,r,s);else if(c=xP(n),typeof c=="function")for(n=c.call(n),c=0;!(i=n.next()).done;)i=i.value,r=o+Ow(i,c++),a+=Nd(i,e,t,r,s);else if(r==="object"){if(typeof n.then=="function")return Nd(bP(n),e,t,i,s);throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.")}return a}function Ty(n,e,t){if(n==null)return n;var i=[],s=0;return Nd(n,i,"","",function(r){return e.call(t,r,s++)}),i}function wP(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var s_=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var e=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(e))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},SP={map:Ty,forEach:function(n,e,t){Ty(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return Ty(n,function(){e++}),e},toArray:function(n){return Ty(n,function(e){return e})||[]},only:function(n){if(!YE(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};mt.Activity=mP;mt.Children=SP;mt.Component=ug;mt.Fragment=lP;mt.Profiler=uP;mt.PureComponent=VE;mt.StrictMode=cP;mt.Suspense=pP;mt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=xn;mt.__COMPILER_RUNTIME={__proto__:null,c:function(n){return xn.H.useMemoCache(n)}};mt.cache=function(n){return function(){return n.apply(null,arguments)}};mt.cacheSignal=function(){return null};mt.cloneElement=function(n,e,t){if(n==null)throw Error("The argument must be a React element, but you passed "+n+".");var i=KD({},n.props),s=n.key;if(e!=null)for(r in e.key!==void 0&&(s=""+e.key),e)!JD.call(e,r)||r==="key"||r==="__self"||r==="__source"||r==="ref"&&e.ref===void 0||(i[r]=e[r]);var r=arguments.length-2;if(r===1)i.children=t;else if(1<r){for(var a=Array(r),o=0;o<r;o++)a[o]=arguments[o+2];i.children=a}return WE(n.type,s,i)};mt.createContext=function(n){return n={$$typeof:dP,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null},n.Provider=n,n.Consumer={$$typeof:hP,_context:n},n};mt.createElement=function(n,e,t){var i,s={},r=null;if(e!=null)for(i in e.key!==void 0&&(r=""+e.key),e)JD.call(e,i)&&i!=="key"&&i!=="__self"&&i!=="__source"&&(s[i]=e[i]);var a=arguments.length-2;if(a===1)s.children=t;else if(1<a){for(var o=Array(a),c=0;c<a;c++)o[c]=arguments[c+2];s.children=o}if(n&&n.defaultProps)for(i in a=n.defaultProps,a)s[i]===void 0&&(s[i]=a[i]);return WE(n,r,s)};mt.createRef=function(){return{current:null}};mt.forwardRef=function(n){return{$$typeof:fP,render:n}};mt.isValidElement=YE;mt.lazy=function(n){return{$$typeof:YD,_payload:{_status:-1,_result:n},_init:wP}};mt.memo=function(n,e){return{$$typeof:gP,type:n,compare:e===void 0?null:e}};mt.startTransition=function(n){var e=xn.T,t={};xn.T=t;try{var i=n(),s=xn.S;s!==null&&s(t,i),typeof i=="object"&&i!==null&&typeof i.then=="function"&&i.then(Q2,s_)}catch(r){s_(r)}finally{e!==null&&t.types!==null&&(e.types=t.types),xn.T=e}};mt.unstable_useCacheRefresh=function(){return xn.H.useCacheRefresh()};mt.use=function(n){return xn.H.use(n)};mt.useActionState=function(n,e,t){return xn.H.useActionState(n,e,t)};mt.useCallback=function(n,e){return xn.H.useCallback(n,e)};mt.useContext=function(n){return xn.H.useContext(n)};mt.useDebugValue=function(){};mt.useDeferredValue=function(n,e){return xn.H.useDeferredValue(n,e)};mt.useEffect=function(n,e){return xn.H.useEffect(n,e)};mt.useEffectEvent=function(n){return xn.H.useEffectEvent(n)};mt.useId=function(){return xn.H.useId()};mt.useImperativeHandle=function(n,e,t){return xn.H.useImperativeHandle(n,e,t)};mt.useInsertionEffect=function(n,e){return xn.H.useInsertionEffect(n,e)};mt.useLayoutEffect=function(n,e){return xn.H.useLayoutEffect(n,e)};mt.useMemo=function(n,e){return xn.H.useMemo(n,e)};mt.useOptimistic=function(n,e){return xn.H.useOptimistic(n,e)};mt.useReducer=function(n,e,t){return xn.H.useReducer(n,e,t)};mt.useRef=function(n){return xn.H.useRef(n)};mt.useState=function(n){return xn.H.useState(n)};mt.useSyncExternalStore=function(n,e,t){return xn.H.useSyncExternalStore(n,e,t)};mt.useTransition=function(){return xn.H.useTransition()};mt.version="19.2.4";WD.exports=mt;var A=WD.exports;const AP=ed(A),EP=(n,e,t,i)=>{var r,a,o,c;const s=[t,{code:e,...i||{}}];if((a=(r=n==null?void 0:n.services)==null?void 0:r.logger)!=null&&a.forward)return n.services.logger.forward(s,"warn","react-i18next::",!0);$h(s[0])&&(s[0]=`react-i18next:: ${s[0]}`),(c=(o=n==null?void 0:n.services)==null?void 0:o.logger)!=null&&c.warn?n.services.logger.warn(...s):console!=null&&console.warn&&console.warn(...s)},r_={},ej=(n,e,t,i)=>{$h(t)&&r_[t]||($h(t)&&(r_[t]=new Date),EP(n,e,t,i))},tj=(n,e)=>()=>{if(n.isInitialized)e();else{const t=()=>{setTimeout(()=>{n.off("initialized",t)},0),e()};n.on("initialized",t)}},J2=(n,e,t)=>{n.loadNamespaces(e,tj(n,t))},a_=(n,e,t,i)=>{if($h(t)&&(t=[t]),n.options.preload&&n.options.preload.indexOf(e)>-1)return J2(n,t,i);t.forEach(s=>{n.options.ns.indexOf(s)<0&&n.options.ns.push(s)}),n.loadLanguages(e,tj(n,i))},CP=(n,e,t={})=>!e.languages||!e.languages.length?(ej(e,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:e.languages}),!0):e.hasLoadedNamespace(n,{lng:t.lng,precheck:(i,s)=>{if(t.bindI18n&&t.bindI18n.indexOf("languageChanging")>-1&&i.services.backendConnector.backend&&i.isLanguageChangingTo&&!s(i.isLanguageChangingTo,n))return!1}}),$h=n=>typeof n=="string",NP=n=>typeof n=="object"&&n!==null,_P=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,kP={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"Â©","&#169;":"Â©","&reg;":"Â®","&#174;":"Â®","&hellip;":"â€¦","&#8230;":"â€¦","&#x2F;":"/","&#47;":"/"},TP=n=>kP[n],DP=n=>n.replace(_P,TP);let eS={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:DP,transDefaultProps:void 0};const jP=(n={})=>{eS={...eS,...n}},RP=()=>eS;let nj;const LP=n=>{nj=n},MP=()=>nj,OP={type:"3rdParty",init(n){jP(n.options.react),LP(n)}},PP=A.createContext();class IP{constructor(){this.usedNamespaces={}}addUsedNamespaces(e){e.forEach(t=>{this.usedNamespaces[t]||(this.usedNamespaces[t]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}var ij={exports:{}},sj={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $p=A;function BP(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var zP=typeof Object.is=="function"?Object.is:BP,FP=$p.useState,UP=$p.useEffect,HP=$p.useLayoutEffect,$P=$p.useDebugValue;function qP(n,e){var t=e(),i=FP({inst:{value:t,getSnapshot:e}}),s=i[0].inst,r=i[1];return HP(function(){s.value=t,s.getSnapshot=e,Pw(s)&&r({inst:s})},[n,t,e]),UP(function(){return Pw(s)&&r({inst:s}),n(function(){Pw(s)&&r({inst:s})})},[n]),$P(t),t}function Pw(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!zP(n,t)}catch{return!0}}function VP(n,e){return e()}var GP=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?VP:qP;sj.useSyncExternalStore=$p.useSyncExternalStore!==void 0?$p.useSyncExternalStore:GP;ij.exports=sj;var WP=ij.exports;const YP=(n,e)=>$h(e)?e:NP(e)&&$h(e.defaultValue)?e.defaultValue:Array.isArray(n)?n[n.length-1]:n,XP={t:YP,ready:!1},KP=()=>()=>{},Bi=(n,e={})=>{var M,L,O;const{i18n:t}=e,{i18n:i,defaultNS:s}=A.useContext(PP)||{},r=t||i||MP();r&&!r.reportNamespaces&&(r.reportNamespaces=new IP),r||ej(r,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const a=A.useMemo(()=>{var B;return{...RP(),...(B=r==null?void 0:r.options)==null?void 0:B.react,...e}},[r,e]),{useSuspense:o,keyPrefix:c}=a,h=s||((M=r==null?void 0:r.options)==null?void 0:M.defaultNS),d=$h(h)?[h]:h||["translation"],f=A.useMemo(()=>d,d);(O=(L=r==null?void 0:r.reportNamespaces)==null?void 0:L.addUsedNamespaces)==null||O.call(L,f);const p=A.useRef(0),g=A.useCallback(B=>{if(!r)return KP;const{bindI18n:G,bindI18nStore:W}=a,J=()=>{p.current+=1,B()};return G&&r.on(G,J),W&&r.store.on(W,J),()=>{G&&G.split(" ").forEach(V=>r.off(V,J)),W&&W.split(" ").forEach(V=>r.store.off(V,J))}},[r,a]),v=A.useRef(),b=A.useCallback(()=>{if(!r)return XP;const B=!!(r.isInitialized||r.initializedStoreOnce)&&f.every(P=>CP(P,r,a)),G=e.lng||r.language,W=p.current,J=v.current;if(J&&J.ready===B&&J.lng===G&&J.keyPrefix===c&&J.revision===W)return J;const H={t:r.getFixedT(G,a.nsMode==="fallback"?f:f[0],c),ready:B,lng:G,keyPrefix:c,revision:W};return v.current=H,H},[r,f,c,a,e.lng]),[x,m]=A.useState(0),{t:y,ready:w}=WP.useSyncExternalStore(g,b,b);A.useEffect(()=>{if(r&&!w&&!o){const B=()=>m(G=>G+1);e.lng?a_(r,e.lng,f,B):J2(r,f,B)}},[r,e.lng,f,w,o,x]);const E=r||{},S=A.useRef(null),_=A.useRef(),T=B=>{const G=Object.getOwnPropertyDescriptors(B);G.__original&&delete G.__original;const W=Object.create(Object.getPrototypeOf(B),G);if(!Object.prototype.hasOwnProperty.call(W,"__original"))try{Object.defineProperty(W,"__original",{value:B,writable:!1,enumerable:!1,configurable:!1})}catch{}return W},j=A.useMemo(()=>{const B=E,G=B==null?void 0:B.language;let W=B;B&&(S.current&&S.current.__original===B?_.current!==G?(W=T(B),S.current=W,_.current=G):W=S.current:(W=T(B),S.current=W,_.current=G));const J=[y,W,w];return J.t=y,J.i18n=W,J.ready=w,J},[y,E,w,E.resolvedLanguage,E.language,E.languages]);if(r&&o&&!w)throw new Promise(B=>{const G=()=>B();e.lng?a_(r,e.lng,f,G):J2(r,f,G)});return j},{slice:ZP,forEach:QP}=[];function JP(n){return QP.call(ZP.call(arguments,1),e=>{if(e)for(const t in e)n[t]===void 0&&(n[t]=e[t])}),n}function e6(n){return typeof n!="string"?!1:[/<\s*script.*?>/i,/<\s*\/\s*script\s*>/i,/<\s*img.*?on\w+\s*=/i,/<\s*\w+\s*on\w+\s*=.*?>/i,/javascript\s*:/i,/vbscript\s*:/i,/expression\s*\(/i,/eval\s*\(/i,/alert\s*\(/i,/document\.cookie/i,/document\.write\s*\(/i,/window\.location/i,/innerHTML/i].some(t=>t.test(n))}const o_=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,t6=function(n,e){const i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{path:"/"},s=encodeURIComponent(e);let r=`${n}=${s}`;if(i.maxAge>0){const a=i.maxAge-0;if(Number.isNaN(a))throw new Error("maxAge should be a Number");r+=`; Max-Age=${Math.floor(a)}`}if(i.domain){if(!o_.test(i.domain))throw new TypeError("option domain is invalid");r+=`; Domain=${i.domain}`}if(i.path){if(!o_.test(i.path))throw new TypeError("option path is invalid");r+=`; Path=${i.path}`}if(i.expires){if(typeof i.expires.toUTCString!="function")throw new TypeError("option expires is invalid");r+=`; Expires=${i.expires.toUTCString()}`}if(i.httpOnly&&(r+="; HttpOnly"),i.secure&&(r+="; Secure"),i.sameSite)switch(typeof i.sameSite=="string"?i.sameSite.toLowerCase():i.sameSite){case!0:r+="; SameSite=Strict";break;case"lax":r+="; SameSite=Lax";break;case"strict":r+="; SameSite=Strict";break;case"none":r+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return i.partitioned&&(r+="; Partitioned"),r},l_={create(n,e,t,i){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/",sameSite:"strict"};t&&(s.expires=new Date,s.expires.setTime(s.expires.getTime()+t*60*1e3)),i&&(s.domain=i),document.cookie=t6(n,e,s)},read(n){const e=`${n}=`,t=document.cookie.split(";");for(let i=0;i<t.length;i++){let s=t[i];for(;s.charAt(0)===" ";)s=s.substring(1,s.length);if(s.indexOf(e)===0)return s.substring(e.length,s.length)}return null},remove(n,e){this.create(n,"",-1,e)}};var n6={name:"cookie",lookup(n){let{lookupCookie:e}=n;if(e&&typeof document<"u")return l_.read(e)||void 0},cacheUserLanguage(n,e){let{lookupCookie:t,cookieMinutes:i,cookieDomain:s,cookieOptions:r}=e;t&&typeof document<"u"&&l_.create(t,n,i,s,r)}},i6={name:"querystring",lookup(n){var i;let{lookupQuerystring:e}=n,t;if(typeof window<"u"){let{search:s}=window.location;!window.location.search&&((i=window.location.hash)==null?void 0:i.indexOf("?"))>-1&&(s=window.location.hash.substring(window.location.hash.indexOf("?")));const a=s.substring(1).split("&");for(let o=0;o<a.length;o++){const c=a[o].indexOf("=");c>0&&a[o].substring(0,c)===e&&(t=a[o].substring(c+1))}}return t}},s6={name:"hash",lookup(n){var s;let{lookupHash:e,lookupFromHashIndex:t}=n,i;if(typeof window<"u"){const{hash:r}=window.location;if(r&&r.length>2){const a=r.substring(1);if(e){const o=a.split("&");for(let c=0;c<o.length;c++){const h=o[c].indexOf("=");h>0&&o[c].substring(0,h)===e&&(i=o[c].substring(h+1))}}if(i)return i;if(!i&&t>-1){const o=r.match(/\/([a-zA-Z-]*)/g);return Array.isArray(o)?(s=o[typeof t=="number"?t:0])==null?void 0:s.replace("/",""):void 0}}}return i}};let pd=null;const c_=()=>{if(pd!==null)return pd;try{if(pd=typeof window<"u"&&window.localStorage!==null,!pd)return!1;const n="i18next.translate.boo";window.localStorage.setItem(n,"foo"),window.localStorage.removeItem(n)}catch{pd=!1}return pd};var r6={name:"localStorage",lookup(n){let{lookupLocalStorage:e}=n;if(e&&c_())return window.localStorage.getItem(e)||void 0},cacheUserLanguage(n,e){let{lookupLocalStorage:t}=e;t&&c_()&&window.localStorage.setItem(t,n)}};let gd=null;const u_=()=>{if(gd!==null)return gd;try{if(gd=typeof window<"u"&&window.sessionStorage!==null,!gd)return!1;const n="i18next.translate.boo";window.sessionStorage.setItem(n,"foo"),window.sessionStorage.removeItem(n)}catch{gd=!1}return gd};var a6={name:"sessionStorage",lookup(n){let{lookupSessionStorage:e}=n;if(e&&u_())return window.sessionStorage.getItem(e)||void 0},cacheUserLanguage(n,e){let{lookupSessionStorage:t}=e;t&&u_()&&window.sessionStorage.setItem(t,n)}},o6={name:"navigator",lookup(n){const e=[];if(typeof navigator<"u"){const{languages:t,userLanguage:i,language:s}=navigator;if(t)for(let r=0;r<t.length;r++)e.push(t[r]);i&&e.push(i),s&&e.push(s)}return e.length>0?e:void 0}},l6={name:"htmlTag",lookup(n){let{htmlTag:e}=n,t;const i=e||(typeof document<"u"?document.documentElement:null);return i&&typeof i.getAttribute=="function"&&(t=i.getAttribute("lang")),t}},c6={name:"path",lookup(n){var s;let{lookupFromPathIndex:e}=n;if(typeof window>"u")return;const t=window.location.pathname.match(/\/([a-zA-Z-]*)/g);return Array.isArray(t)?(s=t[typeof e=="number"?e:0])==null?void 0:s.replace("/",""):void 0}},u6={name:"subdomain",lookup(n){var s,r;let{lookupFromSubdomainIndex:e}=n;const t=typeof e=="number"?e+1:1,i=typeof window<"u"&&((r=(s=window.location)==null?void 0:s.hostname)==null?void 0:r.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i));if(i)return i[t]}};let rj=!1;try{document.cookie,rj=!0}catch{}const aj=["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"];rj||aj.splice(1,1);const h6=()=>({order:aj,lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],convertDetectedLanguage:n=>n});class oj{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.type="languageDetector",this.detectors={},this.init(e,t)}init(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{languageUtils:{}},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=e,this.options=JP(t,this.options||{},h6()),typeof this.options.convertDetectedLanguage=="string"&&this.options.convertDetectedLanguage.indexOf("15897")>-1&&(this.options.convertDetectedLanguage=s=>s.replace("-","_")),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=i,this.addDetector(n6),this.addDetector(i6),this.addDetector(r6),this.addDetector(a6),this.addDetector(o6),this.addDetector(l6),this.addDetector(c6),this.addDetector(u6),this.addDetector(s6)}addDetector(e){return this.detectors[e.name]=e,this}detect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.order,t=[];return e.forEach(i=>{if(this.detectors[i]){let s=this.detectors[i].lookup(this.options);s&&typeof s=="string"&&(s=[s]),s&&(t=t.concat(s))}}),t=t.filter(i=>i!=null&&!e6(i)).map(i=>this.options.convertDetectedLanguage(i)),this.services&&this.services.languageUtils&&this.services.languageUtils.getBestMatchFromCodes?t:t.length>0?t[0]:null}cacheUserLanguage(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.options.caches;t&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(e)>-1||t.forEach(i=>{this.detectors[i]&&this.detectors[i].cacheUserLanguage(e,this.options)}))}}oj.type="languageDetector";const d6={name:"Z-Reader"},f6={library:"Library",articles:"Articles",books:"Books",emails:"Emails",pdfs:"PDFs",tweets:"Tweets",videos:"Videos",podcasts:"Podcasts",tags:"Tags",feed:"Feed",discover:"Discover",allFeeds:"All Feeds",manageFeeds:"Manage Feeds",pinned:"Pinned",shortlist:"Shortlist",trash:"Trash",search:"Search",shortcuts:"Shortcuts",downloads:"Downloads",preferences:"Preferences",profile:"Profile",saveUrl:"Save URL to Library",addFeed:"Add RSS Feed",collapse:"Collapse sidebar",expand:"Expand sidebar"},p6={inbox:"Inbox",later:"Read Later",archive:"Archive",unseen:"Unseen",seen:"Seen",shortRead:"Short",longRead:"Long",all:"All",noArticles:"No articles",loading:"Loading...",markAsRead:"Mark as read",markAsUnread:"Mark as unread",addToShortlist:"Add to shortlist",removeFromShortlist:"Remove from shortlist",archiveArticle:"Archive article",deleteArticle:"Delete",openInReader:"Open in reader",emptyFeed:"This feed has no content",emptyLibrary:"Your library is empty",emptyTag:"No articles with this tag",emptySearch:"No matching articles found",emptyShortlist:"Shortlist is empty",emptyTrash:"Trash is empty"},g6={noSelection:"Select an article to view details",publishedAt:"Published",savedAt:"Saved",author:"Author",domain:"Domain",readingTime:"Reading time",minutes:"min",words:"words",highlights:"Highlights",noHighlights:"No highlights yet",addHighlight:"Add highlight",tags:"Tags",noTags:"No tags",copyUrl:"Copy URL",openOriginal:"Open original",share:"Share",editTags:"Edit tags",editNote:"Edit note",deleteHighlight:"Delete highlight",note:"Note",noNote:"No note",addNote:"Add note"},m6={title:"Preferences",podcastSettings:"Podcast Settings",podcastIndexApiKey:"Podcast Index API Key",podcastIndexApiSecret:"Podcast Index API Secret",podcastIndexHelp:"Get free API keys at podcastindex.org to enable Podcast Index search.",rsshubSettings:"RSSHub Settings",rsshubUrl:"RSSHub Instance URL",rsshubHelp:"Configure a self-hosted RSSHub instance to enable category browsing and route search in Discover.",downloadSettings:"Download Settings",downloadDirectory:"Download Directory",downloadCapacity:"Storage Capacity Limit (MB)",downloadCapacityHelp:"Automatically delete oldest downloaded files when limit is exceeded. Default 5120 MB (5 GB).",languageSettings:"Language",selectLanguage:"Select Language",languageChangeHelp:"Some UI will update immediately after changing language.",save:"Save Settings",saving:"Saving...",settingsSaved:"Settings saved",saveFailed:"Save failed"},x6={addFeed:{title:"Add RSS Feed",url:"Feed URL",urlPlaceholder:"https://example.com/feed.xml",category:"Category (optional)",categoryPlaceholder:"e.g., Tech",add:"Add",cancel:"Cancel",adding:"Adding...",invalidUrl:"Please enter a valid feed URL",duplicateFeed:"This feed already exists",addSuccess:"Feed added successfully",addFailed:"Failed to add feed"},addUrl:{title:"Save URL to Library",url:"URL",urlPlaceholder:"https://example.com/article",titleField:"Title (optional)",titlePlaceholder:"Article title",save:"Save",cancel:"Cancel",saving:"Saving...",invalidUrl:"Please enter a valid URL",saveSuccess:"URL saved successfully",saveFailed:"Failed to save URL"},feedManage:{title:"Manage Feed",feedUrl:"Feed URL",feedTitle:"Title",category:"Category",fetchInterval:"Fetch Interval (minutes)",lastFetched:"Last Fetched",never:"Never",errorCount:"Error Count",save:"Save",delete:"Delete",fetch:"Fetch Now",cancel:"Cancel",confirmDelete:"Are you sure you want to delete this feed?",saveSuccess:"Feed updated successfully",saveFailed:"Failed to update feed",deleteSuccess:"Feed deleted",deleteFailed:"Failed to delete feed",fetchSuccess:"Fetch complete",fetchFailed:"Fetch failed"},commandPalette:{title:"Command Palette",placeholder:"Type a command or search...",noResults:"No results",goToInbox:"Go to Inbox",goToLater:"Go to Read Later",goToArchive:"Go to Archive",doSearch:"Search",addFeed:"Add Feed",saveUrl:"Save URL",openReader:"Open Reader",markRead:"Mark Read",markUnread:"Mark Unread",archive:"Archive",delete:"Delete",later:"Read Later"}},y6={title:"Discover",search:"Search feeds, podcasts, or routes...",categories:"Categories",popularSites:"Popular Sites",preview:"Preview",subscribe:"Subscribe",alreadySubscribed:"Already subscribed",noResults:"No results found",searching:"Searching...",routes:"Routes",parameters:"Parameters",example:"Example",routeDescription:"Description",noCategories:"No categories",noRoutes:"No routes"},v6={title:"Feed Manager",noFeeds:"No feeds yet",addFirst:"Add your first feed to get started",search:"Search feeds...",sortBy:"Sort by",sortByTitle:"By title",sortByUrl:"By URL",sortByRecentlyAdded:"Recently added",sortByRecentlyUpdated:"Recently updated",articles:"Articles",unread:"Unread",errors:"Errors"},b6={title:"Feed Details",noFeed:"Please select a feed",info:"Info",statistics:"Statistics",totalArticles:"Total Articles",unreadArticles:"Unread Articles",lastFetched:"Last Fetched",never:"Never",nextFetch:"Next Fetch",actions:"Actions",fetchNow:"Fetch Now",editFeed:"Edit Feed",deleteFeed:"Delete Feed",openArticle:"Open Article"},w6={title:"Books",upload:"Upload Book",noBooks:"No books yet",uploadFirst:"Upload your first book to get started",author:"Author",progress:"Progress",readStatus:"Status",inbox:"Inbox",later:"Read Later",archive:"Archived",delete:"Delete",open:"Open",import:"Import",importSuccess:"Book imported successfully",importFailed:"Failed to import book",deleteConfirm:"Are you sure you want to delete this book?",deleteSuccess:"Book deleted",fileSize:"File Size",format:"Format",locations:"Locations"},S6={loading:"Loading...",error:"Failed to load",retry:"Retry",openOriginal:"Open original",copyContent:"Copy content",highlight:"Highlight",addNote:"Add note",share:"Share",settings:"Reader Settings",fontSize:"Font Size",fontFamily:"Font",theme:"Theme",lineHeight:"Line Height",width:"Width",fullWidth:"Full Width",narrow:"Narrow",medium:"Medium",wide:"Wide",close:"Close",previousPage:"Previous Page",nextPage:"Next Page",page:"Page",location:"Location"},A6={title:"Video",loading:"Loading video...",play:"Play",pause:"Pause",mute:"Mute",unmute:"Unmute",fullscreen:"Fullscreen",exitFullscreen:"Exit Fullscreen",speed:"Speed",quality:"Quality",auto:"Auto"},E6={title:"Podcast",loading:"Loading podcast...",play:"Play",pause:"Pause",download:"Download",downloading:"Downloading...",downloaded:"Downloaded",duration:"Duration",episode:"Episode",season:"Season",subscribe:"Subscribe",unsubscribe:"Unsubscribe",search:"Search podcasts...",noResults:"No podcasts found"},C6={title:"PDF",loading:"Loading PDF...",page:"Page",of:"of",zoom:"Zoom",fitWidth:"Fit Width",fitPage:"Fit Page",download:"Download"},N6={title:"Search",placeholder:"Search articles...",noResults:"No articles found",results:"results",searching:"Searching...",filters:"Filters",dateRange:"Date Range",source:"Source",clearFilters:"Clear Filters"},_6={title:"Downloads",noDownloads:"No downloads",status:{queued:"Queued",downloading:"Downloading",ready:"Ready",failed:"Failed"},cancel:"Cancel",clear:"Clear",clearCompleted:"Clear Completed",clearFailed:"Clear Failed",retry:"Retry",openFile:"Open File",openFolder:"Open Folder",size:"Size",addedAt:"Added At",lastAccessed:"Last Accessed"},k6={title:"Keyboard Shortcuts",general:"General",navigation:"Navigation",article:"Article Actions",openReader:"Open article in reader",markRead:"Mark as read",markUnread:"Mark as unread",archive:"Archive article",delete:"Delete article",later:"Add to read later",shortlist:"Toggle shortlist",toggleSidebar:"Toggle sidebar",toggleDetailPanel:"Toggle detail panel",search:"Search",commandPalette:"Command palette",saveUrl:"Save URL to library",addFeed:"Add feed",shortcutsHelp:"Shortcuts Help"},T6={title:"Share Card",theme:"Theme",cardType:"Card Type",single:"Single Highlight",multi:"Multiple Highlights",summary:"Summary",quoteStyle:"Quote Style",borderLeft:"Left Border",quotationMarks:"Quotation Marks",highlightBg:"Highlight Background",minimal:"Minimal",export:"Export",copyImage:"Copy Image",downloadImage:"Download Image",copySuccess:"Copied to clipboard",downloadSuccess:"Image saved",exportFailed:"Export failed"},D6={title:"Tags",create:"Create Tag",edit:"Edit Tag",delete:"Delete Tag",name:"Tag Name",parent:"Parent Tag",noParent:"None (top-level)",confirmDelete:"Are you sure you want to delete this tag?",createSuccess:"Tag created successfully",editSuccess:"Tag updated successfully",deleteSuccess:"Tag deleted",search:"Search tags...",noTags:"No tags yet"},j6={title:"Transcript",loading:"Loading transcript...",noTranscript:"No transcript available",fetch:"Fetch Transcript",fetching:"Fetching...",fetchFailed:"Failed to fetch transcript",language:"Language",copy:"Copy",copySuccess:"Copied"},R6={loading:"Loading...",error:"Error",success:"Success",cancel:"Cancel",confirm:"Confirm",delete:"Delete",save:"Save",edit:"Edit",close:"Close",refresh:"Refresh",retry:"Retry",back:"Back",next:"Next",previous:"Previous",yes:"Yes",no:"No",ok:"OK",apply:"Apply",reset:"Reset",select:"Select",selected:"Selected",none:"None",all:"All",search:"Search",filter:"Filter",sort:"Sort",export:"Export",import:"Import",upload:"Upload",download:"Download",copy:"Copy",paste:"Paste",cut:"Cut",selectAll:"Select All",deselectAll:"Deselect All",showMore:"Show More",showLess:"Show Less",expand:"Expand",collapse:"Collapse",more:"More",less:"Less",required:"Required",optional:"Optional",enabled:"Enabled",disabled:"Disabled",active:"Active",inactive:"Inactive",public:"Public",private:"Private",shared:"Shared"},L6={justNow:"Just now",minutesAgo:"{n} minutes ago",hoursAgo:"{n} hours ago",daysAgo:"{n} days ago",weeksAgo:"{n} weeks ago",monthsAgo:"{n} months ago",yearsAgo:"{n} years ago",inMinutes:"in {n} minutes",inHours:"in {n} hours",inDays:"in {n} days",inWeeks:"in {n} weeks",inMonths:"in {n} months",inYears:"in {n} years",today:"Today",yesterday:"Yesterday",tomorrow:"Tomorrow"},M6={title:"Chat",placeholder:"Type a message...",send:"Send",newSession:"New Chat",thinking:"Thinking...",toolCalling:"Executing: {{name}}",empty:"Start chatting with AI",sessionList:"Chat History",analysisHint:"or ask your own question",analysis:{valueClarification:"Value Clarification",valueClarificationDesc:"Identify core values and conflicts",sixThinkingHats:"Six Thinking Hats",sixThinkingHatsDesc:"Analyze from six perspectives",firstPrinciples:"First Principles",firstPrinciplesDesc:"Derive from fundamental truths",socraticMethod:"Socratic Method",socraticMethodDesc:"Challenge assumptions with questions",feynmanTechnique:"Feynman Technique",feynmanTechniqueDesc:"Explain in simplest terms"},error:"An error occurred, please try again"},O6={settings:"AI Settings",provider:"AI Provider",apiKey:"API Key",apiKeyPlaceholder:"Enter your API Key",modelFast:"Fast Model",modelSmart:"Smart Model",modelCheap:"Economy Model",save:"Save",saved:"Saved",testConnection:"Test Connection",connectionOk:"Connection Successful",connectionFailed:"Connection Failed",notConfigured:"Not Configured",summarize:"AI Summary",translate:"AI Translate",autoTag:"AI Tags",generating:"Generating...",translateTo:"Translate to",taskLogs:"AI Call Logs",tokenUsage:"Token Usage",noLogs:"No call logs yet",chatComingSoon:"AI Chat coming in Phase 2",configureApiKey:"Please configure AI API Key in Preferences first",chinese:"Chinese",english:"English",japanese:"Japanese",suggestedTags:"Suggested Tags",applyTag:"Apply",errorOccurred:"Request failed, please try again later",aiActions:"AI Actions",extractTopics:"Extract Topics",topics:"Topics",mindmap:"MindMap",generateMindmap:"Generate MindMap",debugPanel:"AI Debug Panel",callHistory:"Call History",traceDetails:"Execution Trace",costSummary:"Cost Summary",totalTokens:"Total Tokens",totalCost:"Total Cost",totalCalls:"Total Calls",duration:"Duration",input:"Input",output:"Output",steps:"Steps",noTraces:"No trace data",filterAll:"All",viewDetails:"View Details",collapse:"Collapse",copyJson:"Copy JSON",copied:"Copied",error:"Error"},P6={title:"iCloud Sync",icloudAvailable:"iCloud Drive available",icloudUnavailable:"iCloud Drive unavailable, please sign in to iCloud",lastSync:"Last synced",neverSynced:"Never synced",contentTitle:"Sync Content",books:"Book files (EPUB/PDF)",podcasts:"Podcast audio files",syncNow:"Sync Now",syncing:"Syncing..."},I6={networkError:"Network error",serverError:"Server error",notFound:"Not found",unauthorized:"Unauthorized",forbidden:"Forbidden",badRequest:"Bad request",unknown:"Unknown error",retry:"Retry",report:"Report issue"},B6={app:d6,sidebar:f6,contentList:p6,detailPanel:g6,preferences:m6,dialog:x6,discover:y6,feedManager:v6,feedDetail:b6,books:w6,reader:S6,video:A6,podcast:E6,pdf:C6,search:N6,downloads:_6,shortcuts:k6,shareCard:T6,tags:D6,transcript:j6,common:R6,time:L6,chat:M6,ai:O6,sync:P6,errors:I6},z6={name:"Z-Reader"},F6={library:"æ–‡åº“",articles:"æ–‡ç« ",books:"å›¾ä¹¦",emails:"é‚®ä»¶",pdfs:"PDF",tweets:"æŽ¨æ–‡",videos:"è§†é¢‘",podcasts:"æ’­å®¢",tags:"æ ‡ç­¾",feed:"è®¢é˜…æº",discover:"å‘çŽ°",allFeeds:"å…¨éƒ¨è®¢é˜…",manageFeeds:"ç®¡ç†è®¢é˜…",pinned:"å›ºå®š",shortlist:"æ”¶è—å¤¹",trash:"å›žæ”¶ç«™",search:"æœç´¢",shortcuts:"å¿«æ·é”®",downloads:"ä¸‹è½½ç®¡ç†",preferences:"åå¥½è®¾ç½®",profile:"ä¸ªäººä¸­å¿ƒ",saveUrl:"ä¿å­˜é“¾æŽ¥åˆ°æ–‡åº“",addFeed:"æ·»åŠ è®¢é˜…",collapse:"æ”¶èµ·ä¾§è¾¹æ ",expand:"å±•å¼€ä¾§è¾¹æ "},U6={inbox:"æ”¶ä»¶ç®±",later:"ç¨åŽé˜…è¯»",archive:"å½’æ¡£",unseen:"æœªè¯»",seen:"å·²è¯»",shortRead:"çŸ­é˜…è¯»",longRead:"é•¿é˜…è¯»",all:"å…¨éƒ¨",noArticles:"æš‚æ— æ–‡ç« ",loading:"åŠ è½½ä¸­...",markAsRead:"æ ‡è®°ä¸ºå·²è¯»",markAsUnread:"æ ‡è®°ä¸ºæœªè¯»",addToShortlist:"æ·»åŠ åˆ°æ”¶è—å¤¹",removeFromShortlist:"ä»Žæ”¶è—å¤¹ç§»é™¤",archiveArticle:"å½’æ¡£æ–‡ç« ",deleteArticle:"åˆ é™¤",openInReader:"åœ¨é˜…è¯»å™¨ä¸­æ‰“å¼€",emptyFeed:"æ­¤è®¢é˜…æš‚æ— å†…å®¹",emptyLibrary:"æ‚¨çš„æ–‡åº“ä¸ºç©º",emptyTag:"æ­¤æ ‡ç­¾æš‚æ— æ–‡ç« ",emptySearch:"æœªæ‰¾åˆ°åŒ¹é…çš„æ–‡ç« ",emptyShortlist:"æ”¶è—å¤¹ä¸ºç©º",emptyTrash:"å›žæ”¶ç«™ä¸ºç©º"},H6={noSelection:"é€‰æ‹©ä¸€ç¯‡æ–‡ç« æŸ¥çœ‹è¯¦æƒ…",publishedAt:"å‘å¸ƒæ—¶é—´",savedAt:"ä¿å­˜æ—¶é—´",author:"ä½œè€…",domain:"æ¥æº",readingTime:"é˜…è¯»æ—¶é•¿",minutes:"åˆ†é’Ÿ",words:"å­—",highlights:"é«˜äº®",noHighlights:"æš‚æ— é«˜äº®",addHighlight:"æ·»åŠ é«˜äº®",tags:"æ ‡ç­¾",noTags:"æš‚æ— æ ‡ç­¾",copyUrl:"å¤åˆ¶é“¾æŽ¥",openOriginal:"æ‰“å¼€åŽŸæ–‡",share:"åˆ†äº«",editTags:"ç¼–è¾‘æ ‡ç­¾",editNote:"ç¼–è¾‘ç¬”è®°",deleteHighlight:"åˆ é™¤é«˜äº®",note:"ç¬”è®°",noNote:"æš‚æ— ç¬”è®°",addNote:"æ·»åŠ ç¬”è®°"},$6={title:"åå¥½è®¾ç½®",podcastSettings:"æ’­å®¢è®¾ç½®",podcastIndexApiKey:"Podcast Index API Key",podcastIndexApiSecret:"Podcast Index API Secret",podcastIndexHelp:"åœ¨ podcastindex.org å…è´¹æ³¨å†ŒèŽ·å– API å¯†é’¥ï¼Œå¯ç”¨ Podcast Index ä½œä¸ºè¡¥å……æœç´¢æºã€‚",rsshubSettings:"RSSHub è®¾ç½®",rsshubUrl:"RSSHub å®žä¾‹åœ°å€",rsshubHelp:"é…ç½®è‡ªå»º RSSHub å®žä¾‹åœ°å€ï¼Œå¯ç”¨å‘çŽ°é¡µé¢çš„åˆ†ç±»æµè§ˆå’Œè·¯ç”±æœç´¢åŠŸèƒ½ã€‚",downloadSettings:"ä¸‹è½½è®¾ç½®",downloadDirectory:"ä¸‹è½½ç›®å½•",downloadCapacity:"å­˜å‚¨å®¹é‡é™åˆ¶ (MB)",downloadCapacityHelp:"è¶…è¿‡é™åˆ¶æ—¶è‡ªåŠ¨æ¸…ç†æœ€æ—©çš„å·²ä¸‹è½½æ–‡ä»¶ã€‚é»˜è®¤ 5120 MB (5 GB)ã€‚",languageSettings:"è¯­è¨€",selectLanguage:"é€‰æ‹©è¯­è¨€",languageChangeHelp:"æ›´æ”¹è¯­è¨€åŽï¼Œéƒ¨åˆ†ç•Œé¢å°†ç«‹å³æ›´æ–°ã€‚",save:"ä¿å­˜è®¾ç½®",saving:"ä¿å­˜ä¸­...",settingsSaved:"è®¾ç½®å·²ä¿å­˜",saveFailed:"ä¿å­˜å¤±è´¥"},q6={addFeed:{title:"æ·»åŠ è®¢é˜…",url:"è®¢é˜…åœ°å€",urlPlaceholder:"https://example.com/feed.xml",category:"åˆ†ç±»ï¼ˆå¯é€‰ï¼‰",categoryPlaceholder:"ä¾‹å¦‚ï¼šç§‘æŠ€",add:"æ·»åŠ ",cancel:"å–æ¶ˆ",adding:"æ·»åŠ ä¸­...",invalidUrl:"è¯·è¾“å…¥æœ‰æ•ˆçš„è®¢é˜…åœ°å€",duplicateFeed:"æ­¤è®¢é˜…å·²å­˜åœ¨",addSuccess:"è®¢é˜…æ·»åŠ æˆåŠŸ",addFailed:"æ·»åŠ è®¢é˜…å¤±è´¥"},addUrl:{title:"ä¿å­˜é“¾æŽ¥åˆ°æ–‡åº“",url:"é“¾æŽ¥åœ°å€",urlPlaceholder:"https://example.com/article",titleField:"æ ‡é¢˜ï¼ˆå¯é€‰ï¼‰",titlePlaceholder:"æ–‡ç« æ ‡é¢˜",save:"ä¿å­˜",cancel:"å–æ¶ˆ",saving:"ä¿å­˜ä¸­...",invalidUrl:"è¯·è¾“å…¥æœ‰æ•ˆçš„é“¾æŽ¥åœ°å€",saveSuccess:"é“¾æŽ¥ä¿å­˜æˆåŠŸ",saveFailed:"ä¿å­˜é“¾æŽ¥å¤±è´¥"},feedManage:{title:"ç®¡ç†è®¢é˜…",feedUrl:"è®¢é˜…åœ°å€",feedTitle:"æ ‡é¢˜",category:"åˆ†ç±»",fetchInterval:"æŠ“å–é—´éš”ï¼ˆåˆ†é’Ÿï¼‰",lastFetched:"ä¸Šæ¬¡æŠ“å–",never:"ä»Žæœª",errorCount:"é”™è¯¯æ¬¡æ•°",save:"ä¿å­˜",delete:"åˆ é™¤",fetch:"ç«‹å³æŠ“å–",cancel:"å–æ¶ˆ",confirmDelete:"ç¡®å®šè¦åˆ é™¤æ­¤è®¢é˜…å—ï¼Ÿ",saveSuccess:"è®¢é˜…æ›´æ–°æˆåŠŸ",saveFailed:"æ›´æ–°è®¢é˜…å¤±è´¥",deleteSuccess:"è®¢é˜…å·²åˆ é™¤",deleteFailed:"åˆ é™¤è®¢é˜…å¤±è´¥",fetchSuccess:"æŠ“å–å®Œæˆ",fetchFailed:"æŠ“å–å¤±è´¥"},commandPalette:{title:"å‘½ä»¤é¢æ¿",placeholder:"è¾“å…¥å‘½ä»¤æˆ–æœç´¢...",noResults:"æ— ç»“æžœ",goToInbox:"å‰å¾€æ”¶ä»¶ç®±",goToLater:"å‰å¾€ç¨åŽé˜…è¯»",goToArchive:"å‰å¾€å½’æ¡£",doSearch:"æœç´¢",addFeed:"æ·»åŠ è®¢é˜…",saveUrl:"ä¿å­˜é“¾æŽ¥",openReader:"æ‰“å¼€é˜…è¯»å™¨",markRead:"æ ‡è®°å·²è¯»",markUnread:"æ ‡è®°æœªè¯»",archive:"å½’æ¡£",delete:"åˆ é™¤",later:"ç¨åŽé˜…è¯»"}},V6={title:"å‘çŽ°",search:"æœç´¢è®¢é˜…ã€æ’­å®¢æˆ–è·¯ç”±...",categories:"åˆ†ç±»",popularSites:"çƒ­é—¨ç«™ç‚¹",preview:"é¢„è§ˆ",subscribe:"è®¢é˜…",alreadySubscribed:"å·²è®¢é˜…",noResults:"æœªæ‰¾åˆ°ç»“æžœ",searching:"æœç´¢ä¸­...",routes:"è·¯ç”±",parameters:"å‚æ•°",example:"ç¤ºä¾‹",routeDescription:"æè¿°",noCategories:"æš‚æ— åˆ†ç±»",noRoutes:"æš‚æ— è·¯ç”±"},G6={title:"è®¢é˜…ç®¡ç†",noFeeds:"æš‚æ— è®¢é˜…",addFirst:"æ·»åŠ æ‚¨çš„ç¬¬ä¸€ä¸ªè®¢é˜…å¼€å§‹ä½¿ç”¨",search:"æœç´¢è®¢é˜…...",sortBy:"æŽ’åº",sortByTitle:"æŒ‰æ ‡é¢˜",sortByUrl:"æŒ‰åœ°å€",sortByRecentlyAdded:"æœ€è¿‘æ·»åŠ ",sortByRecentlyUpdated:"æœ€è¿‘æ›´æ–°",articles:"æ–‡ç« ",unread:"æœªè¯»",errors:"é”™è¯¯"},W6={title:"è®¢é˜…è¯¦æƒ…",noFeed:"è¯·é€‰æ‹©ä¸€ä¸ªè®¢é˜…",info:"ä¿¡æ¯",statistics:"ç»Ÿè®¡",totalArticles:"æ–‡ç« æ€»æ•°",unreadArticles:"æœªè¯»æ–‡ç« ",lastFetched:"ä¸Šæ¬¡æŠ“å–",never:"ä»Žæœª",nextFetch:"ä¸‹æ¬¡æŠ“å–",actions:"æ“ä½œ",fetchNow:"ç«‹å³æŠ“å–",editFeed:"ç¼–è¾‘è®¢é˜…",deleteFeed:"åˆ é™¤è®¢é˜…",openArticle:"æ‰“å¼€æ–‡ç« "},Y6={title:"å›¾ä¹¦",upload:"ä¸Šä¼ å›¾ä¹¦",noBooks:"æš‚æ— å›¾ä¹¦",uploadFirst:"ä¸Šä¼ æ‚¨çš„ç¬¬ä¸€æœ¬å›¾ä¹¦å¼€å§‹ä½¿ç”¨",author:"ä½œè€…",progress:"è¿›åº¦",readStatus:"çŠ¶æ€",inbox:"æ”¶ä»¶ç®±",later:"ç¨åŽé˜…è¯»",archive:"å·²å½’æ¡£",delete:"åˆ é™¤",open:"æ‰“å¼€",import:"å¯¼å…¥",importSuccess:"å›¾ä¹¦å¯¼å…¥æˆåŠŸ",importFailed:"å›¾ä¹¦å¯¼å…¥å¤±è´¥",deleteConfirm:"ç¡®å®šè¦åˆ é™¤è¿™æœ¬ä¹¦å—ï¼Ÿ",deleteSuccess:"å›¾ä¹¦å·²åˆ é™¤",fileSize:"æ–‡ä»¶å¤§å°",format:"æ ¼å¼",locations:"ä½ç½®"},X6={loading:"åŠ è½½ä¸­...",error:"åŠ è½½å¤±è´¥",retry:"é‡è¯•",openOriginal:"æ‰“å¼€åŽŸæ–‡",copyContent:"å¤åˆ¶å†…å®¹",highlight:"é«˜äº®",addNote:"æ·»åŠ ç¬”è®°",share:"åˆ†äº«",settings:"é˜…è¯»è®¾ç½®",fontSize:"å­—ä½“å¤§å°",fontFamily:"å­—ä½“",theme:"ä¸»é¢˜",lineHeight:"è¡Œé«˜",width:"å®½åº¦",fullWidth:"å…¨å®½",narrow:"çª„",medium:"ä¸­",wide:"å®½",close:"å…³é—­",previousPage:"ä¸Šä¸€é¡µ",nextPage:"ä¸‹ä¸€é¡µ",page:"é¡µç ",location:"ä½ç½®"},K6={title:"è§†é¢‘",loading:"åŠ è½½è§†é¢‘ä¸­...",play:"æ’­æ”¾",pause:"æš‚åœ",mute:"é™éŸ³",unmute:"å–æ¶ˆé™éŸ³",fullscreen:"å…¨å±",exitFullscreen:"é€€å‡ºå…¨å±",speed:"é€Ÿåº¦",quality:"è´¨é‡",auto:"è‡ªåŠ¨"},Z6={title:"æ’­å®¢",loading:"åŠ è½½æ’­å®¢ä¸­...",play:"æ’­æ”¾",pause:"æš‚åœ",download:"ä¸‹è½½",downloading:"ä¸‹è½½ä¸­...",downloaded:"å·²ä¸‹è½½",duration:"æ—¶é•¿",episode:"é›†",season:"å­£",subscribe:"è®¢é˜…",unsubscribe:"å–æ¶ˆè®¢é˜…",search:"æœç´¢æ’­å®¢...",noResults:"æœªæ‰¾åˆ°æ’­å®¢"},Q6={title:"PDF",loading:"åŠ è½½ PDF ä¸­...",page:"é¡µ",of:"/",zoom:"ç¼©æ”¾",fitWidth:"é€‚åº”å®½åº¦",fitPage:"é€‚åº”é¡µé¢",download:"ä¸‹è½½"},J6={title:"æœç´¢",placeholder:"æœç´¢æ–‡ç« ...",noResults:"æœªæ‰¾åˆ°æ–‡ç« ",results:"æ¡ç»“æžœ",searching:"æœç´¢ä¸­...",filters:"ç­›é€‰",dateRange:"æ—¥æœŸèŒƒå›´",source:"æ¥æº",clearFilters:"æ¸…é™¤ç­›é€‰"},eI={title:"ä¸‹è½½ç®¡ç†",noDownloads:"æš‚æ— ä¸‹è½½",status:{queued:"æŽ’é˜Ÿä¸­",downloading:"ä¸‹è½½ä¸­",ready:"å·²å®Œæˆ",failed:"å¤±è´¥"},cancel:"å–æ¶ˆ",clear:"æ¸…é™¤",clearCompleted:"æ¸…é™¤å·²å®Œæˆ",clearFailed:"æ¸…é™¤å¤±è´¥",retry:"é‡è¯•",openFile:"æ‰“å¼€æ–‡ä»¶",openFolder:"æ‰“å¼€æ–‡ä»¶å¤¹",size:"å¤§å°",addedAt:"æ·»åŠ æ—¶é—´",lastAccessed:"æœ€åŽè®¿é—®"},tI={title:"é”®ç›˜å¿«æ·é”®",general:"é€šç”¨",navigation:"å¯¼èˆª",article:"æ–‡ç« æ“ä½œ",openReader:"åœ¨é˜…è¯»å™¨ä¸­æ‰“å¼€æ–‡ç« ",markRead:"æ ‡è®°ä¸ºå·²è¯»",markUnread:"æ ‡è®°ä¸ºæœªè¯»",archive:"å½’æ¡£æ–‡ç« ",delete:"åˆ é™¤æ–‡ç« ",later:"æ·»åŠ åˆ°ç¨åŽé˜…è¯»",shortlist:"åˆ‡æ¢æ”¶è—",toggleSidebar:"åˆ‡æ¢ä¾§è¾¹æ ",toggleDetailPanel:"åˆ‡æ¢è¯¦æƒ…é¢æ¿",search:"æœç´¢",commandPalette:"å‘½ä»¤é¢æ¿",saveUrl:"ä¿å­˜é“¾æŽ¥åˆ°æ–‡åº“",addFeed:"æ·»åŠ è®¢é˜…",shortcutsHelp:"å¿«æ·é”®å¸®åŠ©"},nI={title:"åˆ†äº«å¡ç‰‡",theme:"ä¸»é¢˜",cardType:"å¡ç‰‡ç±»åž‹",single:"å•æ¡é«˜äº®",multi:"å¤šæ¡é«˜äº®",summary:"æ‘˜è¦",quoteStyle:"å¼•ç”¨æ ·å¼",borderLeft:"å·¦è¾¹æ¡†",quotationMarks:"å¼•å·",highlightBg:"é«˜äº®èƒŒæ™¯",minimal:"ç®€çº¦",export:"å¯¼å‡º",copyImage:"å¤åˆ¶å›¾ç‰‡",downloadImage:"ä¸‹è½½å›¾ç‰‡",copySuccess:"å·²å¤åˆ¶åˆ°å‰ªè´´æ¿",downloadSuccess:"å›¾ç‰‡å·²ä¿å­˜",exportFailed:"å¯¼å‡ºå¤±è´¥"},iI={title:"æ ‡ç­¾",create:"åˆ›å»ºæ ‡ç­¾",edit:"ç¼–è¾‘æ ‡ç­¾",delete:"åˆ é™¤æ ‡ç­¾",name:"æ ‡ç­¾åç§°",parent:"çˆ¶æ ‡ç­¾",noParent:"æ— ï¼ˆé¡¶çº§æ ‡ç­¾ï¼‰",confirmDelete:"ç¡®å®šè¦åˆ é™¤è¿™ä¸ªæ ‡ç­¾å—ï¼Ÿ",createSuccess:"æ ‡ç­¾åˆ›å»ºæˆåŠŸ",editSuccess:"æ ‡ç­¾æ›´æ–°æˆåŠŸ",deleteSuccess:"æ ‡ç­¾å·²åˆ é™¤",search:"æœç´¢æ ‡ç­¾...",noTags:"æš‚æ— æ ‡ç­¾"},sI={title:"æ–‡å­—ç¨¿",loading:"åŠ è½½æ–‡å­—ç¨¿ä¸­...",noTranscript:"æš‚æ— æ–‡å­—ç¨¿",fetch:"èŽ·å–æ–‡å­—ç¨¿",fetching:"èŽ·å–ä¸­...",fetchFailed:"èŽ·å–æ–‡å­—ç¨¿å¤±è´¥",language:"è¯­è¨€",copy:"å¤åˆ¶",copySuccess:"å·²å¤åˆ¶"},rI={loading:"åŠ è½½ä¸­...",error:"é”™è¯¯",success:"æˆåŠŸ",cancel:"å–æ¶ˆ",confirm:"ç¡®è®¤",delete:"åˆ é™¤",save:"ä¿å­˜",edit:"ç¼–è¾‘",close:"å…³é—­",refresh:"åˆ·æ–°",retry:"é‡è¯•",back:"è¿”å›ž",next:"ä¸‹ä¸€æ­¥",previous:"ä¸Šä¸€æ­¥",yes:"æ˜¯",no:"å¦",ok:"ç¡®å®š",apply:"åº”ç”¨",reset:"é‡ç½®",select:"é€‰æ‹©",selected:"å·²é€‰æ‹©",none:"æ— ",all:"å…¨éƒ¨",search:"æœç´¢",filter:"ç­›é€‰",sort:"æŽ’åº",export:"å¯¼å‡º",import:"å¯¼å…¥",upload:"ä¸Šä¼ ",download:"ä¸‹è½½",copy:"å¤åˆ¶",paste:"ç²˜è´´",cut:"å‰ªåˆ‡",selectAll:"å…¨é€‰",deselectAll:"å–æ¶ˆå…¨é€‰",showMore:"æ˜¾ç¤ºæ›´å¤š",showLess:"æ˜¾ç¤ºæ›´å°‘",expand:"å±•å¼€",collapse:"æ”¶èµ·",more:"æ›´å¤š",less:"æ›´å°‘",required:"å¿…å¡«",optional:"å¯é€‰",enabled:"å¯ç”¨",disabled:"ç¦ç”¨",active:"æ´»è·ƒ",inactive:"æœªæ´»è·ƒ",public:"å…¬å¼€",private:"ç§æœ‰",shared:"å…±äº«"},aI={justNow:"åˆšåˆš",minutesAgo:"{n} åˆ†é’Ÿå‰",hoursAgo:"{n} å°æ—¶å‰",daysAgo:"{n} å¤©å‰",weeksAgo:"{n} å‘¨å‰",monthsAgo:"{n} æœˆå‰",yearsAgo:"{n} å¹´å‰",inMinutes:"{n} åˆ†é’ŸåŽ",inHours:"{n} å°æ—¶åŽ",inDays:"{n} å¤©åŽ",inWeeks:"{n} å‘¨åŽ",inMonths:"{n} æœˆåŽ",inYears:"{n} å¹´åŽ",today:"ä»Šå¤©",yesterday:"æ˜¨å¤©",tomorrow:"æ˜Žå¤©"},oI={title:"å¯¹è¯",placeholder:"è¾“å…¥æ¶ˆæ¯...",send:"å‘é€",newSession:"æ–°å¯¹è¯",thinking:"æ€è€ƒä¸­...",toolCalling:"æ­£åœ¨æ‰§è¡Œ: {{name}}",empty:"å¼€å§‹å’Œ AI èŠå¤©å§",sessionList:"å¯¹è¯åŽ†å²",analysisHint:"æˆ–ç›´æŽ¥è¾“å…¥ä½ çš„é—®é¢˜",analysis:{valueClarification:"ä»·å€¼æ¾„æ¸…",valueClarificationDesc:"è¯†åˆ«æ ¸å¿ƒä»·å€¼è§‚ä¸Žæ½œåœ¨å†²çª",sixThinkingHats:"å…­é¡¶æ€è€ƒå¸½",sixThinkingHatsDesc:"ä»Žå…­ä¸ªè§’åº¦å…¨é¢åˆ†æž",firstPrinciples:"ç¬¬ä¸€æ€§åŽŸç†",firstPrinciplesDesc:"å›žå½’åŸºæœ¬äº‹å®žé‡æ–°æŽ¨å¯¼",socraticMethod:"è‹æ ¼æ‹‰åº•æé—®",socraticMethodDesc:"å±‚å±‚è¿½é—®æŒ‘æˆ˜å‡è®¾ä¸Žé€»è¾‘",feynmanTechnique:"è´¹æ›¼æ•™å­¦æ³•",feynmanTechniqueDesc:"ç”¨æœ€ç®€å•çš„è¯­è¨€é‡æ–°è§£é‡Š"},error:"å‘ç”Ÿé”™è¯¯ï¼Œè¯·é‡è¯•"},lI={settings:"AI è®¾ç½®",provider:"AI æœåŠ¡å•†",apiKey:"API Key",apiKeyPlaceholder:"è¾“å…¥ä½ çš„ API Key",modelFast:"å¿«é€Ÿæ¨¡åž‹",modelSmart:"æ™ºèƒ½æ¨¡åž‹",modelCheap:"ç»æµŽæ¨¡åž‹",save:"ä¿å­˜",saved:"å·²ä¿å­˜",testConnection:"æµ‹è¯•è¿žæŽ¥",connectionOk:"è¿žæŽ¥æˆåŠŸ",connectionFailed:"è¿žæŽ¥å¤±è´¥",notConfigured:"æœªé…ç½®",summarize:"AI æ‘˜è¦",translate:"AI ç¿»è¯‘",autoTag:"AI æ ‡ç­¾",generating:"ç”Ÿæˆä¸­...",translateTo:"ç¿»è¯‘ä¸º",taskLogs:"AI è°ƒç”¨è®°å½•",tokenUsage:"Token ç”¨é‡",noLogs:"æš‚æ— è°ƒç”¨è®°å½•",chatComingSoon:"AI å¯¹è¯åŠŸèƒ½å°†åœ¨ Phase 2 ä¸­ä¸Šçº¿",configureApiKey:"è¯·å…ˆåœ¨åå¥½è®¾ç½®ä¸­é…ç½® AI API Key",chinese:"ä¸­æ–‡",english:"è‹±æ–‡",japanese:"æ—¥æ–‡",suggestedTags:"æŽ¨èæ ‡ç­¾",applyTag:"åº”ç”¨",errorOccurred:"è°ƒç”¨å¤±è´¥ï¼Œè¯·ç¨åŽé‡è¯•",aiActions:"AI æ“ä½œ",extractTopics:"æå–ä¸»é¢˜",topics:"ä¸»é¢˜å…³é”®è¯",mindmap:"æ€ç»´å¯¼å›¾",generateMindmap:"ç”Ÿæˆæ€ç»´å¯¼å›¾",debugPanel:"AI è°ƒè¯•é¢æ¿",callHistory:"è°ƒç”¨åŽ†å²",traceDetails:"æ‰§è¡Œè¿½è¸ª",costSummary:"æˆæœ¬ç»Ÿè®¡",totalTokens:"æ€» Token",totalCost:"æ€»æˆæœ¬",totalCalls:"æ€»è°ƒç”¨æ¬¡æ•°",duration:"è€—æ—¶",input:"è¾“å…¥",output:"è¾“å‡º",steps:"æ­¥éª¤",noTraces:"æ— è¿½è¸ªæ•°æ®",filterAll:"å…¨éƒ¨",viewDetails:"æŸ¥çœ‹è¯¦æƒ…",collapse:"æ”¶èµ·",copyJson:"å¤åˆ¶ JSON",copied:"å·²å¤åˆ¶",error:"é”™è¯¯"},cI={title:"iCloud åŒæ­¥",icloudAvailable:"iCloud Drive å¯ç”¨",icloudUnavailable:"iCloud Drive ä¸å¯ç”¨ï¼Œè¯·ç™»å½• iCloud",lastSync:"æœ€è¿‘åŒæ­¥",neverSynced:"å°šæœªåŒæ­¥",contentTitle:"åŒæ­¥å†…å®¹",books:"ç”µå­ä¹¦æ–‡ä»¶ (EPUB/PDF)",podcasts:"æ’­å®¢éŸ³é¢‘æ–‡ä»¶",syncNow:"ç«‹å³åŒæ­¥",syncing:"åŒæ­¥ä¸­..."},uI={networkError:"ç½‘ç»œé”™è¯¯",serverError:"æœåŠ¡å™¨é”™è¯¯",notFound:"æœªæ‰¾åˆ°",unauthorized:"æœªæŽˆæƒ",forbidden:"ç¦æ­¢è®¿é—®",badRequest:"è¯·æ±‚é”™è¯¯",unknown:"æœªçŸ¥é”™è¯¯",retry:"é‡è¯•",report:"æŠ¥å‘Šé—®é¢˜"},hI={app:z6,sidebar:F6,contentList:U6,detailPanel:H6,preferences:$6,dialog:q6,discover:V6,feedManager:G6,feedDetail:W6,books:Y6,reader:X6,video:K6,podcast:Z6,pdf:Q6,search:J6,downloads:eI,shortcuts:tI,shareCard:nI,tags:iI,transcript:sI,common:rI,time:aI,chat:oI,ai:lI,sync:cI,errors:uI},dI={en:{translation:B6},zh:{translation:hI}},fI=[{code:"en",name:"English",nativeName:"English"},{code:"zh",name:"Chinese",nativeName:"ä¸­æ–‡"}];Yi.use(oj).use(OP).init({resources:dI,fallbackLng:"en",supportedLngs:["en","zh"],interpolation:{escapeValue:!1},detection:{order:["localStorage","navigator"],caches:["localStorage"],lookupLocalStorage:"z-reader-language"}});const lj=n=>{Yi.changeLanguage(n),localStorage.setItem("z-reader-language",n)};var cj={exports:{}},L1={},uj={exports:{}},hj={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(V,H){var P=V.length;V.push(H);e:for(;0<P;){var Y=P-1>>>1,ge=V[Y];if(0<s(ge,H))V[Y]=H,V[P]=ge,P=Y;else break e}}function t(V){return V.length===0?null:V[0]}function i(V){if(V.length===0)return null;var H=V[0],P=V.pop();if(P!==H){V[0]=P;e:for(var Y=0,ge=V.length,ae=ge>>>1;Y<ae;){var ee=2*(Y+1)-1,le=V[ee],ie=ee+1,Q=V[ie];if(0>s(le,P))ie<ge&&0>s(Q,le)?(V[Y]=Q,V[ie]=P,Y=ie):(V[Y]=le,V[ee]=P,Y=ee);else if(ie<ge&&0>s(Q,P))V[Y]=Q,V[ie]=P,Y=ie;else break e}}return H}function s(V,H){var P=V.sortIndex-H.sortIndex;return P!==0?P:V.id-H.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var r=performance;n.unstable_now=function(){return r.now()}}else{var a=Date,o=a.now();n.unstable_now=function(){return a.now()-o}}var c=[],h=[],d=1,f=null,p=3,g=!1,v=!1,b=!1,x=!1,m=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;function E(V){for(var H=t(h);H!==null;){if(H.callback===null)i(h);else if(H.startTime<=V)i(h),H.sortIndex=H.expirationTime,e(c,H);else break;H=t(h)}}function S(V){if(b=!1,E(V),!v)if(t(c)!==null)v=!0,_||(_=!0,B());else{var H=t(h);H!==null&&J(S,H.startTime-V)}}var _=!1,T=-1,j=5,M=-1;function L(){return x?!0:!(n.unstable_now()-M<j)}function O(){if(x=!1,_){var V=n.unstable_now();M=V;var H=!0;try{e:{v=!1,b&&(b=!1,y(T),T=-1),g=!0;var P=p;try{t:{for(E(V),f=t(c);f!==null&&!(f.expirationTime>V&&L());){var Y=f.callback;if(typeof Y=="function"){f.callback=null,p=f.priorityLevel;var ge=Y(f.expirationTime<=V);if(V=n.unstable_now(),typeof ge=="function"){f.callback=ge,E(V),H=!0;break t}f===t(c)&&i(c),E(V)}else i(c);f=t(c)}if(f!==null)H=!0;else{var ae=t(h);ae!==null&&J(S,ae.startTime-V),H=!1}}break e}finally{f=null,p=P,g=!1}H=void 0}}finally{H?B():_=!1}}}var B;if(typeof w=="function")B=function(){w(O)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,W=G.port2;G.port1.onmessage=O,B=function(){W.postMessage(null)}}else B=function(){m(O,0)};function J(V,H){T=m(function(){V(n.unstable_now())},H)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(V){V.callback=null},n.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<V?Math.floor(1e3/V):5},n.unstable_getCurrentPriorityLevel=function(){return p},n.unstable_next=function(V){switch(p){case 1:case 2:case 3:var H=3;break;default:H=p}var P=p;p=H;try{return V()}finally{p=P}},n.unstable_requestPaint=function(){x=!0},n.unstable_runWithPriority=function(V,H){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var P=p;p=V;try{return H()}finally{p=P}},n.unstable_scheduleCallback=function(V,H,P){var Y=n.unstable_now();switch(typeof P=="object"&&P!==null?(P=P.delay,P=typeof P=="number"&&0<P?Y+P:Y):P=Y,V){case 1:var ge=-1;break;case 2:ge=250;break;case 5:ge=1073741823;break;case 4:ge=1e4;break;default:ge=5e3}return ge=P+ge,V={id:d++,callback:H,priorityLevel:V,startTime:P,expirationTime:ge,sortIndex:-1},P>Y?(V.sortIndex=P,e(h,V),t(c)===null&&V===t(h)&&(b?(y(T),T=-1):b=!0,J(S,P-Y))):(V.sortIndex=ge,e(c,V),v||g||(v=!0,_||(_=!0,B()))),V},n.unstable_shouldYield=L,n.unstable_wrapCallback=function(V){var H=p;return function(){var P=p;p=H;try{return V.apply(this,arguments)}finally{p=P}}}})(hj);uj.exports=hj;var pI=uj.exports,dj={exports:{}},as={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gI=A;function fj(n){var e="https://react.dev/errors/"+n;if(1<arguments.length){e+="?args[]="+encodeURIComponent(arguments[1]);for(var t=2;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t])}return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function Ll(){}var is={d:{f:Ll,r:function(){throw Error(fj(522))},D:Ll,C:Ll,L:Ll,m:Ll,X:Ll,S:Ll,M:Ll},p:0,findDOMNode:null},mI=Symbol.for("react.portal");function xI(n,e,t){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:mI,key:i==null?null:""+i,children:n,containerInfo:e,implementation:t}}var xm=gI.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function M1(n,e){if(n==="font")return"";if(typeof e=="string")return e==="use-credentials"?e:""}as.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=is;as.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)throw Error(fj(299));return xI(n,e,null,t)};as.flushSync=function(n){var e=xm.T,t=is.p;try{if(xm.T=null,is.p=2,n)return n()}finally{xm.T=e,is.p=t,is.d.f()}};as.preconnect=function(n,e){typeof n=="string"&&(e?(e=e.crossOrigin,e=typeof e=="string"?e==="use-credentials"?e:"":void 0):e=null,is.d.C(n,e))};as.prefetchDNS=function(n){typeof n=="string"&&is.d.D(n)};as.preinit=function(n,e){if(typeof n=="string"&&e&&typeof e.as=="string"){var t=e.as,i=M1(t,e.crossOrigin),s=typeof e.integrity=="string"?e.integrity:void 0,r=typeof e.fetchPriority=="string"?e.fetchPriority:void 0;t==="style"?is.d.S(n,typeof e.precedence=="string"?e.precedence:void 0,{crossOrigin:i,integrity:s,fetchPriority:r}):t==="script"&&is.d.X(n,{crossOrigin:i,integrity:s,fetchPriority:r,nonce:typeof e.nonce=="string"?e.nonce:void 0})}};as.preinitModule=function(n,e){if(typeof n=="string")if(typeof e=="object"&&e!==null){if(e.as==null||e.as==="script"){var t=M1(e.as,e.crossOrigin);is.d.M(n,{crossOrigin:t,integrity:typeof e.integrity=="string"?e.integrity:void 0,nonce:typeof e.nonce=="string"?e.nonce:void 0})}}else e==null&&is.d.M(n)};as.preload=function(n,e){if(typeof n=="string"&&typeof e=="object"&&e!==null&&typeof e.as=="string"){var t=e.as,i=M1(t,e.crossOrigin);is.d.L(n,t,{crossOrigin:i,integrity:typeof e.integrity=="string"?e.integrity:void 0,nonce:typeof e.nonce=="string"?e.nonce:void 0,type:typeof e.type=="string"?e.type:void 0,fetchPriority:typeof e.fetchPriority=="string"?e.fetchPriority:void 0,referrerPolicy:typeof e.referrerPolicy=="string"?e.referrerPolicy:void 0,imageSrcSet:typeof e.imageSrcSet=="string"?e.imageSrcSet:void 0,imageSizes:typeof e.imageSizes=="string"?e.imageSizes:void 0,media:typeof e.media=="string"?e.media:void 0})}};as.preloadModule=function(n,e){if(typeof n=="string")if(e){var t=M1(e.as,e.crossOrigin);is.d.m(n,{as:typeof e.as=="string"&&e.as!=="script"?e.as:void 0,crossOrigin:t,integrity:typeof e.integrity=="string"?e.integrity:void 0})}else is.d.m(n)};as.requestFormReset=function(n){is.d.r(n)};as.unstable_batchedUpdates=function(n,e){return n(e)};as.useFormState=function(n,e,t){return xm.H.useFormState(n,e,t)};as.useFormStatus=function(){return xm.H.useHostTransitionStatus()};as.version="19.2.4";function pj(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(pj)}catch(n){console.error(n)}}pj(),dj.exports=as;var yI=dj.exports;/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ci=pI,gj=A,vI=yI;function Ce(n){var e="https://react.dev/errors/"+n;if(1<arguments.length){e+="?args[]="+encodeURIComponent(arguments[1]);for(var t=2;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t])}return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function mj(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function ey(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function xj(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function yj(n){if(n.tag===31){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function h_(n){if(ey(n)!==n)throw Error(Ce(188))}function bI(n){var e=n.alternate;if(!e){if(e=ey(n),e===null)throw Error(Ce(188));return e!==n?null:n}for(var t=n,i=e;;){var s=t.return;if(s===null)break;var r=s.alternate;if(r===null){if(i=s.return,i!==null){t=i;continue}break}if(s.child===r.child){for(r=s.child;r;){if(r===t)return h_(s),n;if(r===i)return h_(s),e;r=r.sibling}throw Error(Ce(188))}if(t.return!==i.return)t=s,i=r;else{for(var a=!1,o=s.child;o;){if(o===t){a=!0,t=s,i=r;break}if(o===i){a=!0,i=s,t=r;break}o=o.sibling}if(!a){for(o=r.child;o;){if(o===t){a=!0,t=r,i=s;break}if(o===i){a=!0,i=r,t=s;break}o=o.sibling}if(!a)throw Error(Ce(189))}}if(t.alternate!==i)throw Error(Ce(190))}if(t.tag!==3)throw Error(Ce(188));return t.stateNode.current===t?n:e}function vj(n){var e=n.tag;if(e===5||e===26||e===27||e===6)return n;for(n=n.child;n!==null;){if(e=vj(n),e!==null)return e;n=n.sibling}return null}var yn=Object.assign,wI=Symbol.for("react.element"),Dy=Symbol.for("react.transitional.element"),$g=Symbol.for("react.portal"),Hd=Symbol.for("react.fragment"),bj=Symbol.for("react.strict_mode"),tS=Symbol.for("react.profiler"),wj=Symbol.for("react.consumer"),ol=Symbol.for("react.context"),XE=Symbol.for("react.forward_ref"),nS=Symbol.for("react.suspense"),iS=Symbol.for("react.suspense_list"),KE=Symbol.for("react.memo"),Pl=Symbol.for("react.lazy"),sS=Symbol.for("react.activity"),SI=Symbol.for("react.memo_cache_sentinel"),d_=Symbol.iterator;function Ng(n){return n===null||typeof n!="object"?null:(n=d_&&n[d_]||n["@@iterator"],typeof n=="function"?n:null)}var AI=Symbol.for("react.client.reference");function rS(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===AI?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Hd:return"Fragment";case tS:return"Profiler";case bj:return"StrictMode";case nS:return"Suspense";case iS:return"SuspenseList";case sS:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case $g:return"Portal";case ol:return n.displayName||"Context";case wj:return(n._context.displayName||"Context")+".Consumer";case XE:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case KE:return e=n.displayName||null,e!==null?e:rS(n.type)||"Memo";case Pl:e=n._payload,n=n._init;try{return rS(n(e))}catch{}}return null}var qg=Array.isArray,ot=gj.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ft=vI.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Bh={pending:!1,data:null,method:null,action:null},aS=[],$d=-1;function lo(n){return{current:n}}function bi(n){0>$d||(n.current=aS[$d],aS[$d]=null,$d--)}function fn(n,e){$d++,aS[$d]=n.current,n.current=e}var eo=lo(null),Mm=lo(null),qc=lo(null),cb=lo(null);function ub(n,e){switch(fn(qc,e),fn(Mm,n),fn(eo,null),e.nodeType){case 9:case 11:n=(n=e.documentElement)&&(n=n.namespaceURI)?yk(n):0;break;default:if(n=e.tagName,e=e.namespaceURI)e=yk(e),n=U5(e,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}bi(eo),fn(eo,n)}function qp(){bi(eo),bi(Mm),bi(qc)}function oS(n){n.memoizedState!==null&&fn(cb,n);var e=eo.current,t=U5(e,n.type);e!==t&&(fn(Mm,n),fn(eo,t))}function hb(n){Mm.current===n&&(bi(eo),bi(Mm)),cb.current===n&&(bi(cb),Vm._currentValue=Bh)}var Iw,f_;function gu(n){if(Iw===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);Iw=e&&e[1]||"",f_=-1<t.stack.indexOf(`
    at`)?" (<anonymous>)":-1<t.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Iw+n+f_}var Bw=!1;function zw(n,e){if(!n||Bw)return"";Bw=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var i={DetermineComponentFrameRoot:function(){try{if(e){var f=function(){throw Error()};if(Object.defineProperty(f.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(f,[])}catch(g){var p=g}Reflect.construct(n,[],f)}else{try{f.call()}catch(g){p=g}n.call(f.prototype)}}else{try{throw Error()}catch(g){p=g}(f=n())&&typeof f.catch=="function"&&f.catch(function(){})}}catch(g){if(g&&p&&typeof g.stack=="string")return[g.stack,p.stack]}return[null,null]}};i.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var s=Object.getOwnPropertyDescriptor(i.DetermineComponentFrameRoot,"name");s&&s.configurable&&Object.defineProperty(i.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var r=i.DetermineComponentFrameRoot(),a=r[0],o=r[1];if(a&&o){var c=a.split(`
`),h=o.split(`
`);for(s=i=0;i<c.length&&!c[i].includes("DetermineComponentFrameRoot");)i++;for(;s<h.length&&!h[s].includes("DetermineComponentFrameRoot");)s++;if(i===c.length||s===h.length)for(i=c.length-1,s=h.length-1;1<=i&&0<=s&&c[i]!==h[s];)s--;for(;1<=i&&0<=s;i--,s--)if(c[i]!==h[s]){if(i!==1||s!==1)do if(i--,s--,0>s||c[i]!==h[s]){var d=`
`+c[i].replace(" at new "," at ");return n.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",n.displayName)),d}while(1<=i&&0<=s);break}}}finally{Bw=!1,Error.prepareStackTrace=t}return(t=n?n.displayName||n.name:"")?gu(t):""}function EI(n,e){switch(n.tag){case 26:case 27:case 5:return gu(n.type);case 16:return gu("Lazy");case 13:return n.child!==e&&e!==null?gu("Suspense Fallback"):gu("Suspense");case 19:return gu("SuspenseList");case 0:case 15:return zw(n.type,!1);case 11:return zw(n.type.render,!1);case 1:return zw(n.type,!0);case 31:return gu("Activity");default:return""}}function p_(n){try{var e="",t=null;do e+=EI(n,t),t=n,n=n.return;while(n);return e}catch(i){return`
Error generating stack: `+i.message+`
`+i.stack}}var lS=Object.prototype.hasOwnProperty,ZE=ci.unstable_scheduleCallback,Fw=ci.unstable_cancelCallback,CI=ci.unstable_shouldYield,NI=ci.unstable_requestPaint,rr=ci.unstable_now,_I=ci.unstable_getCurrentPriorityLevel,Sj=ci.unstable_ImmediatePriority,Aj=ci.unstable_UserBlockingPriority,db=ci.unstable_NormalPriority,kI=ci.unstable_LowPriority,Ej=ci.unstable_IdlePriority,TI=ci.log,DI=ci.unstable_setDisableYieldValue,ty=null,ar=null;function Ic(n){if(typeof TI=="function"&&DI(n),ar&&typeof ar.setStrictMode=="function")try{ar.setStrictMode(ty,n)}catch{}}var or=Math.clz32?Math.clz32:LI,jI=Math.log,RI=Math.LN2;function LI(n){return n>>>=0,n===0?32:31-(jI(n)/RI|0)|0}var jy=256,Ry=262144,Ly=4194304;function mu(n){var e=n&42;if(e!==0)return e;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function O1(n,e,t){var i=n.pendingLanes;if(i===0)return 0;var s=0,r=n.suspendedLanes,a=n.pingedLanes;n=n.warmLanes;var o=i&134217727;return o!==0?(i=o&~r,i!==0?s=mu(i):(a&=o,a!==0?s=mu(a):t||(t=o&~n,t!==0&&(s=mu(t))))):(o=i&~r,o!==0?s=mu(o):a!==0?s=mu(a):t||(t=i&~n,t!==0&&(s=mu(t)))),s===0?0:e!==0&&e!==s&&!(e&r)&&(r=s&-s,t=e&-e,r>=t||r===32&&(t&4194048)!==0)?e:s}function ny(n,e){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&e)===0}function MI(n,e){switch(n){case 1:case 2:case 4:case 8:case 64:return e+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Cj(){var n=Ly;return Ly<<=1,!(Ly&62914560)&&(Ly=4194304),n}function Uw(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function iy(n,e){n.pendingLanes|=e,e!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function OI(n,e,t,i,s,r){var a=n.pendingLanes;n.pendingLanes=t,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=t,n.entangledLanes&=t,n.errorRecoveryDisabledLanes&=t,n.shellSuspendCounter=0;var o=n.entanglements,c=n.expirationTimes,h=n.hiddenUpdates;for(t=a&~t;0<t;){var d=31-or(t),f=1<<d;o[d]=0,c[d]=-1;var p=h[d];if(p!==null)for(h[d]=null,d=0;d<p.length;d++){var g=p[d];g!==null&&(g.lane&=-536870913)}t&=~f}i!==0&&Nj(n,i,0),r!==0&&s===0&&n.tag!==0&&(n.suspendedLanes|=r&~(a&~e))}function Nj(n,e,t){n.pendingLanes|=e,n.suspendedLanes&=~e;var i=31-or(e);n.entangledLanes|=e,n.entanglements[i]=n.entanglements[i]|1073741824|t&261930}function _j(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var i=31-or(t),s=1<<i;s&e|n[i]&e&&(n[i]|=e),t&=~s}}function kj(n,e){var t=e&-e;return t=t&42?1:QE(t),t&(n.suspendedLanes|e)?0:t}function QE(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function JE(n){return n&=-n,2<n?8<n?n&134217727?32:268435456:8:2}function Tj(){var n=Ft.p;return n!==0?n:(n=window.event,n===void 0?32:Q5(n.type))}function g_(n,e){var t=Ft.p;try{return Ft.p=n,e()}finally{Ft.p=t}}var cu=Math.random().toString(36).slice(2),Ri="__reactFiber$"+cu,Ns="__reactProps$"+cu,hg="__reactContainer$"+cu,cS="__reactEvents$"+cu,PI="__reactListeners$"+cu,II="__reactHandles$"+cu,m_="__reactResources$"+cu,sy="__reactMarker$"+cu;function eC(n){delete n[Ri],delete n[Ns],delete n[cS],delete n[PI],delete n[II]}function qd(n){var e=n[Ri];if(e)return e;for(var t=n.parentNode;t;){if(e=t[hg]||t[Ri]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=Ak(n);n!==null;){if(t=n[Ri])return t;n=Ak(n)}return e}n=t,t=n.parentNode}return null}function dg(n){if(n=n[Ri]||n[hg]){var e=n.tag;if(e===5||e===6||e===13||e===31||e===26||e===27||e===3)return n}return null}function Vg(n){var e=n.tag;if(e===5||e===26||e===27||e===6)return n.stateNode;throw Error(Ce(33))}function lf(n){var e=n[m_];return e||(e=n[m_]={hoistableStyles:new Map,hoistableScripts:new Map}),e}function vi(n){n[sy]=!0}var Dj=new Set,jj={};function td(n,e){Vp(n,e),Vp(n+"Capture",e)}function Vp(n,e){for(jj[n]=e,n=0;n<e.length;n++)Dj.add(e[n])}var BI=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),x_={},y_={};function zI(n){return lS.call(y_,n)?!0:lS.call(x_,n)?!1:BI.test(n)?y_[n]=!0:(x_[n]=!0,!1)}function av(n,e,t){if(zI(e))if(t===null)n.removeAttribute(e);else{switch(typeof t){case"undefined":case"function":case"symbol":n.removeAttribute(e);return;case"boolean":var i=e.toLowerCase().slice(0,5);if(i!=="data-"&&i!=="aria-"){n.removeAttribute(e);return}}n.setAttribute(e,""+t)}}function My(n,e,t){if(t===null)n.removeAttribute(e);else{switch(typeof t){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(e);return}n.setAttribute(e,""+t)}}function ho(n,e,t,i){if(i===null)n.removeAttribute(t);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(t);return}n.setAttributeNS(e,t,""+i)}}function Rr(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Rj(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function FI(n,e,t){var i=Object.getOwnPropertyDescriptor(n.constructor.prototype,e);if(!n.hasOwnProperty(e)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var s=i.get,r=i.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return s.call(this)},set:function(a){t=""+a,r.call(this,a)}}),Object.defineProperty(n,e,{enumerable:i.enumerable}),{getValue:function(){return t},setValue:function(a){t=""+a},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function uS(n){if(!n._valueTracker){var e=Rj(n)?"checked":"value";n._valueTracker=FI(n,e,""+n[e])}}function Lj(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),i="";return n&&(i=Rj(n)?n.checked?"true":"false":n.value),n=i,n!==t?(e.setValue(n),!0):!1}function fb(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var UI=/[\n"\\]/g;function Or(n){return n.replace(UI,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function hS(n,e,t,i,s,r,a,o){n.name="",a!=null&&typeof a!="function"&&typeof a!="symbol"&&typeof a!="boolean"?n.type=a:n.removeAttribute("type"),e!=null?a==="number"?(e===0&&n.value===""||n.value!=e)&&(n.value=""+Rr(e)):n.value!==""+Rr(e)&&(n.value=""+Rr(e)):a!=="submit"&&a!=="reset"||n.removeAttribute("value"),e!=null?dS(n,a,Rr(e)):t!=null?dS(n,a,Rr(t)):i!=null&&n.removeAttribute("value"),s==null&&r!=null&&(n.defaultChecked=!!r),s!=null&&(n.checked=s&&typeof s!="function"&&typeof s!="symbol"),o!=null&&typeof o!="function"&&typeof o!="symbol"&&typeof o!="boolean"?n.name=""+Rr(o):n.removeAttribute("name")}function Mj(n,e,t,i,s,r,a,o){if(r!=null&&typeof r!="function"&&typeof r!="symbol"&&typeof r!="boolean"&&(n.type=r),e!=null||t!=null){if(!(r!=="submit"&&r!=="reset"||e!=null)){uS(n);return}t=t!=null?""+Rr(t):"",e=e!=null?""+Rr(e):t,o||e===n.value||(n.value=e),n.defaultValue=e}i=i??s,i=typeof i!="function"&&typeof i!="symbol"&&!!i,n.checked=o?n.checked:!!i,n.defaultChecked=!!i,a!=null&&typeof a!="function"&&typeof a!="symbol"&&typeof a!="boolean"&&(n.name=a),uS(n)}function dS(n,e,t){e==="number"&&fb(n.ownerDocument)===n||n.defaultValue===""+t||(n.defaultValue=""+t)}function cf(n,e,t,i){if(n=n.options,e){e={};for(var s=0;s<t.length;s++)e["$"+t[s]]=!0;for(t=0;t<n.length;t++)s=e.hasOwnProperty("$"+n[t].value),n[t].selected!==s&&(n[t].selected=s),s&&i&&(n[t].defaultSelected=!0)}else{for(t=""+Rr(t),e=null,s=0;s<n.length;s++){if(n[s].value===t){n[s].selected=!0,i&&(n[s].defaultSelected=!0);return}e!==null||n[s].disabled||(e=n[s])}e!==null&&(e.selected=!0)}}function Oj(n,e,t){if(e!=null&&(e=""+Rr(e),e!==n.value&&(n.value=e),t==null)){n.defaultValue!==e&&(n.defaultValue=e);return}n.defaultValue=t!=null?""+Rr(t):""}function Pj(n,e,t,i){if(e==null){if(i!=null){if(t!=null)throw Error(Ce(92));if(qg(i)){if(1<i.length)throw Error(Ce(93));i=i[0]}t=i}t==null&&(t=""),e=t}t=Rr(e),n.defaultValue=t,i=n.textContent,i===t&&i!==""&&i!==null&&(n.value=i),uS(n)}function Gp(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var HI=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function v_(n,e,t){var i=e.indexOf("--")===0;t==null||typeof t=="boolean"||t===""?i?n.setProperty(e,""):e==="float"?n.cssFloat="":n[e]="":i?n.setProperty(e,t):typeof t!="number"||t===0||HI.has(e)?e==="float"?n.cssFloat=t:n[e]=(""+t).trim():n[e]=t+"px"}function Ij(n,e,t){if(e!=null&&typeof e!="object")throw Error(Ce(62));if(n=n.style,t!=null){for(var i in t)!t.hasOwnProperty(i)||e!=null&&e.hasOwnProperty(i)||(i.indexOf("--")===0?n.setProperty(i,""):i==="float"?n.cssFloat="":n[i]="");for(var s in e)i=e[s],e.hasOwnProperty(s)&&t[s]!==i&&v_(n,s,i)}else for(var r in e)e.hasOwnProperty(r)&&v_(n,r,e[r])}function tC(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var $I=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),qI=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ov(n){return qI.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function ll(){}var fS=null;function nC(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Vd=null,uf=null;function b_(n){var e=dg(n);if(e&&(n=e.stateNode)){var t=n[Ns]||null;e:switch(n=e.stateNode,e.type){case"input":if(hS(n,t.value,t.defaultValue,t.defaultValue,t.checked,t.defaultChecked,t.type,t.name),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll('input[name="'+Or(""+e)+'"][type="radio"]'),e=0;e<t.length;e++){var i=t[e];if(i!==n&&i.form===n.form){var s=i[Ns]||null;if(!s)throw Error(Ce(90));hS(i,s.value,s.defaultValue,s.defaultValue,s.checked,s.defaultChecked,s.type,s.name)}}for(e=0;e<t.length;e++)i=t[e],i.form===n.form&&Lj(i)}break e;case"textarea":Oj(n,t.value,t.defaultValue);break e;case"select":e=t.value,e!=null&&cf(n,!!t.multiple,e,!1)}}}var Hw=!1;function Bj(n,e,t){if(Hw)return n(e,t);Hw=!0;try{var i=n(e);return i}finally{if(Hw=!1,(Vd!==null||uf!==null)&&(W1(),Vd&&(e=Vd,n=uf,uf=Vd=null,b_(e),n)))for(e=0;e<n.length;e++)b_(n[e])}}function Om(n,e){var t=n.stateNode;if(t===null)return null;var i=t[Ns]||null;if(i===null)return null;t=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(n=n.type,i=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!i;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(Ce(231,e,typeof t));return t}var vl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),pS=!1;if(vl)try{var _g={};Object.defineProperty(_g,"passive",{get:function(){pS=!0}}),window.addEventListener("test",_g,_g),window.removeEventListener("test",_g,_g)}catch{pS=!1}var Bc=null,iC=null,lv=null;function zj(){if(lv)return lv;var n,e=iC,t=e.length,i,s="value"in Bc?Bc.value:Bc.textContent,r=s.length;for(n=0;n<t&&e[n]===s[n];n++);var a=t-n;for(i=1;i<=a&&e[t-i]===s[r-i];i++);return lv=s.slice(n,1<i?1-i:void 0)}function cv(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function Oy(){return!0}function w_(){return!1}function _s(n){function e(t,i,s,r,a){this._reactName=t,this._targetInst=s,this.type=i,this.nativeEvent=r,this.target=a,this.currentTarget=null;for(var o in n)n.hasOwnProperty(o)&&(t=n[o],this[o]=t?t(r):r[o]);return this.isDefaultPrevented=(r.defaultPrevented!=null?r.defaultPrevented:r.returnValue===!1)?Oy:w_,this.isPropagationStopped=w_,this}return yn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Oy)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Oy)},persist:function(){},isPersistent:Oy}),e}var nd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},P1=_s(nd),ry=yn({},nd,{view:0,detail:0}),VI=_s(ry),$w,qw,kg,I1=yn({},ry,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:sC,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==kg&&(kg&&n.type==="mousemove"?($w=n.screenX-kg.screenX,qw=n.screenY-kg.screenY):qw=$w=0,kg=n),$w)},movementY:function(n){return"movementY"in n?n.movementY:qw}}),S_=_s(I1),GI=yn({},I1,{dataTransfer:0}),WI=_s(GI),YI=yn({},ry,{relatedTarget:0}),Vw=_s(YI),XI=yn({},nd,{animationName:0,elapsedTime:0,pseudoElement:0}),KI=_s(XI),ZI=yn({},nd,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),QI=_s(ZI),JI=yn({},nd,{data:0}),A_=_s(JI),eB={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},tB={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},nB={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function iB(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=nB[n])?!!e[n]:!1}function sC(){return iB}var sB=yn({},ry,{key:function(n){if(n.key){var e=eB[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=cv(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?tB[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:sC,charCode:function(n){return n.type==="keypress"?cv(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?cv(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),rB=_s(sB),aB=yn({},I1,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),E_=_s(aB),oB=yn({},ry,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:sC}),lB=_s(oB),cB=yn({},nd,{propertyName:0,elapsedTime:0,pseudoElement:0}),uB=_s(cB),hB=yn({},I1,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),dB=_s(hB),fB=yn({},nd,{newState:0,oldState:0}),pB=_s(fB),gB=[9,13,27,32],rC=vl&&"CompositionEvent"in window,ym=null;vl&&"documentMode"in document&&(ym=document.documentMode);var mB=vl&&"TextEvent"in window&&!ym,Fj=vl&&(!rC||ym&&8<ym&&11>=ym),C_=" ",N_=!1;function Uj(n,e){switch(n){case"keyup":return gB.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Hj(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Gd=!1;function xB(n,e){switch(n){case"compositionend":return Hj(e);case"keypress":return e.which!==32?null:(N_=!0,C_);case"textInput":return n=e.data,n===C_&&N_?null:n;default:return null}}function yB(n,e){if(Gd)return n==="compositionend"||!rC&&Uj(n,e)?(n=zj(),lv=iC=Bc=null,Gd=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Fj&&e.locale!=="ko"?null:e.data;default:return null}}var vB={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function __(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!vB[n.type]:e==="textarea"}function $j(n,e,t,i){Vd?uf?uf.push(i):uf=[i]:Vd=i,e=jb(e,"onChange"),0<e.length&&(t=new P1("onChange","change",null,t,i),n.push({event:t,listeners:e}))}var vm=null,Pm=null;function bB(n){B5(n,0)}function B1(n){var e=Vg(n);if(Lj(e))return n}function k_(n,e){if(n==="change")return e}var qj=!1;if(vl){var Gw;if(vl){var Ww="oninput"in document;if(!Ww){var T_=document.createElement("div");T_.setAttribute("oninput","return;"),Ww=typeof T_.oninput=="function"}Gw=Ww}else Gw=!1;qj=Gw&&(!document.documentMode||9<document.documentMode)}function D_(){vm&&(vm.detachEvent("onpropertychange",Vj),Pm=vm=null)}function Vj(n){if(n.propertyName==="value"&&B1(Pm)){var e=[];$j(e,Pm,n,nC(n)),Bj(bB,e)}}function wB(n,e,t){n==="focusin"?(D_(),vm=e,Pm=t,vm.attachEvent("onpropertychange",Vj)):n==="focusout"&&D_()}function SB(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return B1(Pm)}function AB(n,e){if(n==="click")return B1(e)}function EB(n,e){if(n==="input"||n==="change")return B1(e)}function CB(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var ur=typeof Object.is=="function"?Object.is:CB;function Im(n,e){if(ur(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),i=Object.keys(e);if(t.length!==i.length)return!1;for(i=0;i<t.length;i++){var s=t[i];if(!lS.call(e,s)||!ur(n[s],e[s]))return!1}return!0}function j_(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function R_(n,e){var t=j_(n);n=0;for(var i;t;){if(t.nodeType===3){if(i=n+t.textContent.length,n<=e&&i>=e)return{node:t,offset:e-n};n=i}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=j_(t)}}function Gj(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?Gj(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function Wj(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var e=fb(n.document);e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=fb(n.document)}return e}function aC(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}var NB=vl&&"documentMode"in document&&11>=document.documentMode,Wd=null,gS=null,bm=null,mS=!1;function L_(n,e,t){var i=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;mS||Wd==null||Wd!==fb(i)||(i=Wd,"selectionStart"in i&&aC(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),bm&&Im(bm,i)||(bm=i,i=jb(gS,"onSelect"),0<i.length&&(e=new P1("onSelect","select",null,e,t),n.push({event:e,listeners:i}),e.target=Wd)))}function pu(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var Yd={animationend:pu("Animation","AnimationEnd"),animationiteration:pu("Animation","AnimationIteration"),animationstart:pu("Animation","AnimationStart"),transitionrun:pu("Transition","TransitionRun"),transitionstart:pu("Transition","TransitionStart"),transitioncancel:pu("Transition","TransitionCancel"),transitionend:pu("Transition","TransitionEnd")},Yw={},Yj={};vl&&(Yj=document.createElement("div").style,"AnimationEvent"in window||(delete Yd.animationend.animation,delete Yd.animationiteration.animation,delete Yd.animationstart.animation),"TransitionEvent"in window||delete Yd.transitionend.transition);function id(n){if(Yw[n])return Yw[n];if(!Yd[n])return n;var e=Yd[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in Yj)return Yw[n]=e[t];return n}var Xj=id("animationend"),Kj=id("animationiteration"),Zj=id("animationstart"),_B=id("transitionrun"),kB=id("transitionstart"),TB=id("transitioncancel"),Qj=id("transitionend"),Jj=new Map,xS="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");xS.push("scrollEnd");function wa(n,e){Jj.set(n,e),td(e,[n])}var pb=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var e=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(e))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},jr=[],Xd=0,oC=0;function z1(){for(var n=Xd,e=oC=Xd=0;e<n;){var t=jr[e];jr[e++]=null;var i=jr[e];jr[e++]=null;var s=jr[e];jr[e++]=null;var r=jr[e];if(jr[e++]=null,i!==null&&s!==null){var a=i.pending;a===null?s.next=s:(s.next=a.next,a.next=s),i.pending=s}r!==0&&e3(t,s,r)}}function F1(n,e,t,i){jr[Xd++]=n,jr[Xd++]=e,jr[Xd++]=t,jr[Xd++]=i,oC|=i,n.lanes|=i,n=n.alternate,n!==null&&(n.lanes|=i)}function lC(n,e,t,i){return F1(n,e,t,i),gb(n)}function sd(n,e){return F1(n,null,null,e),gb(n)}function e3(n,e,t){n.lanes|=t;var i=n.alternate;i!==null&&(i.lanes|=t);for(var s=!1,r=n.return;r!==null;)r.childLanes|=t,i=r.alternate,i!==null&&(i.childLanes|=t),r.tag===22&&(n=r.stateNode,n===null||n._visibility&1||(s=!0)),n=r,r=r.return;return n.tag===3?(r=n.stateNode,s&&e!==null&&(s=31-or(t),n=r.hiddenUpdates,i=n[s],i===null?n[s]=[e]:i.push(e),e.lane=t|536870912),r):null}function gb(n){if(50<Tm)throw Tm=0,BS=null,Error(Ce(185));for(var e=n.return;e!==null;)n=e,e=n.return;return n.tag===3?n.stateNode:null}var Kd={};function DB(n,e,t,i){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function nr(n,e,t,i){return new DB(n,e,t,i)}function cC(n){return n=n.prototype,!(!n||!n.isReactComponent)}function dl(n,e){var t=n.alternate;return t===null?(t=nr(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&65011712,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t.refCleanup=n.refCleanup,t}function t3(n,e){n.flags&=65011714;var t=n.alternate;return t===null?(n.childLanes=0,n.lanes=e,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,n.type=t.type,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n}function uv(n,e,t,i,s,r){var a=0;if(i=n,typeof n=="function")cC(n)&&(a=1);else if(typeof n=="string")a=Oz(n,t,eo.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case sS:return n=nr(31,t,e,s),n.elementType=sS,n.lanes=r,n;case Hd:return zh(t.children,s,r,e);case bj:a=8,s|=24;break;case tS:return n=nr(12,t,e,s|2),n.elementType=tS,n.lanes=r,n;case nS:return n=nr(13,t,e,s),n.elementType=nS,n.lanes=r,n;case iS:return n=nr(19,t,e,s),n.elementType=iS,n.lanes=r,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case ol:a=10;break e;case wj:a=9;break e;case XE:a=11;break e;case KE:a=14;break e;case Pl:a=16,i=null;break e}a=29,t=Error(Ce(130,n===null?"null":typeof n,"")),i=null}return e=nr(a,t,e,s),e.elementType=n,e.type=i,e.lanes=r,e}function zh(n,e,t,i){return n=nr(7,n,i,e),n.lanes=t,n}function Xw(n,e,t){return n=nr(6,n,null,e),n.lanes=t,n}function n3(n){var e=nr(18,null,null,0);return e.stateNode=n,e}function Kw(n,e,t){return e=nr(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}var M_=new WeakMap;function Pr(n,e){if(typeof n=="object"&&n!==null){var t=M_.get(n);return t!==void 0?t:(e={value:n,source:e,stack:p_(e)},M_.set(n,e),e)}return{value:n,source:e,stack:p_(e)}}var Zd=[],Qd=0,mb=null,Bm=0,Lr=[],Mr=0,tu=null,Za=1,Qa="";function So(n,e){Zd[Qd++]=Bm,Zd[Qd++]=mb,mb=n,Bm=e}function i3(n,e,t){Lr[Mr++]=Za,Lr[Mr++]=Qa,Lr[Mr++]=tu,tu=n;var i=Za;n=Qa;var s=32-or(i)-1;i&=~(1<<s),t+=1;var r=32-or(e)+s;if(30<r){var a=s-s%5;r=(i&(1<<a)-1).toString(32),i>>=a,s-=a,Za=1<<32-or(e)+s|t<<s|i,Qa=r+n}else Za=1<<r|t<<s|i,Qa=n}function uC(n){n.return!==null&&(So(n,1),i3(n,1,0))}function hC(n){for(;n===mb;)mb=Zd[--Qd],Zd[Qd]=null,Bm=Zd[--Qd],Zd[Qd]=null;for(;n===tu;)tu=Lr[--Mr],Lr[Mr]=null,Qa=Lr[--Mr],Lr[Mr]=null,Za=Lr[--Mr],Lr[Mr]=null}function s3(n,e){Lr[Mr++]=Za,Lr[Mr++]=Qa,Lr[Mr++]=tu,Za=e.id,Qa=e.overflow,tu=n}var Li=null,mn=null,Rt=!1,Vc=null,Ir=!1,yS=Error(Ce(519));function nu(n){var e=Error(Ce(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw zm(Pr(e,n)),yS}function O_(n){var e=n.stateNode,t=n.type,i=n.memoizedProps;switch(e[Ri]=n,e[Ns]=i,t){case"dialog":Et("cancel",e),Et("close",e);break;case"iframe":case"object":case"embed":Et("load",e);break;case"video":case"audio":for(t=0;t<$m.length;t++)Et($m[t],e);break;case"source":Et("error",e);break;case"img":case"image":case"link":Et("error",e),Et("load",e);break;case"details":Et("toggle",e);break;case"input":Et("invalid",e),Mj(e,i.value,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name,!0);break;case"select":Et("invalid",e);break;case"textarea":Et("invalid",e),Pj(e,i.value,i.defaultValue,i.children)}t=i.children,typeof t!="string"&&typeof t!="number"&&typeof t!="bigint"||e.textContent===""+t||i.suppressHydrationWarning===!0||F5(e.textContent,t)?(i.popover!=null&&(Et("beforetoggle",e),Et("toggle",e)),i.onScroll!=null&&Et("scroll",e),i.onScrollEnd!=null&&Et("scrollend",e),i.onClick!=null&&(e.onclick=ll),e=!0):e=!1,e||nu(n,!0)}function P_(n){for(Li=n.return;Li;)switch(Li.tag){case 5:case 31:case 13:Ir=!1;return;case 27:case 3:Ir=!0;return;default:Li=Li.return}}function md(n){if(n!==Li)return!1;if(!Rt)return P_(n),Rt=!0,!1;var e=n.tag,t;if((t=e!==3&&e!==27)&&((t=e===5)&&(t=n.type,t=!(t!=="form"&&t!=="button")||$S(n.type,n.memoizedProps)),t=!t),t&&mn&&nu(n),P_(n),e===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(Ce(317));mn=Sk(n)}else if(e===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(Ce(317));mn=Sk(n)}else e===27?(e=mn,uu(n.type)?(n=WS,WS=null,mn=n):mn=e):mn=Li?Ur(n.stateNode.nextSibling):null;return!0}function qh(){mn=Li=null,Rt=!1}function Zw(){var n=Vc;return n!==null&&(ws===null?ws=n:ws.push.apply(ws,n),Vc=null),n}function zm(n){Vc===null?Vc=[n]:Vc.push(n)}var vS=lo(null),rd=null,cl=null;function Bl(n,e,t){fn(vS,e._currentValue),e._currentValue=t}function fl(n){n._currentValue=vS.current,bi(vS)}function bS(n,e,t){for(;n!==null;){var i=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),n===t)break;n=n.return}}function wS(n,e,t,i){var s=n.child;for(s!==null&&(s.return=n);s!==null;){var r=s.dependencies;if(r!==null){var a=s.child;r=r.firstContext;e:for(;r!==null;){var o=r;r=s;for(var c=0;c<e.length;c++)if(o.context===e[c]){r.lanes|=t,o=r.alternate,o!==null&&(o.lanes|=t),bS(r.return,t,n),i||(a=null);break e}r=o.next}}else if(s.tag===18){if(a=s.return,a===null)throw Error(Ce(341));a.lanes|=t,r=a.alternate,r!==null&&(r.lanes|=t),bS(a,t,n),a=null}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===n){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}}function fg(n,e,t,i){n=null;for(var s=e,r=!1;s!==null;){if(!r){if(s.flags&524288)r=!0;else if(s.flags&262144)break}if(s.tag===10){var a=s.alternate;if(a===null)throw Error(Ce(387));if(a=a.memoizedProps,a!==null){var o=s.type;ur(s.pendingProps.value,a.value)||(n!==null?n.push(o):n=[o])}}else if(s===cb.current){if(a=s.alternate,a===null)throw Error(Ce(387));a.memoizedState.memoizedState!==s.memoizedState.memoizedState&&(n!==null?n.push(Vm):n=[Vm])}s=s.return}n!==null&&wS(e,n,t,i),e.flags|=262144}function xb(n){for(n=n.firstContext;n!==null;){if(!ur(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function Vh(n){rd=n,cl=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function Oi(n){return r3(rd,n)}function Py(n,e){return rd===null&&Vh(n),r3(n,e)}function r3(n,e){var t=e._currentValue;if(e={context:e,memoizedValue:t,next:null},cl===null){if(n===null)throw Error(Ce(308));cl=e,n.dependencies={lanes:0,firstContext:e},n.flags|=524288}else cl=cl.next=e;return t}var jB=typeof AbortController<"u"?AbortController:function(){var n=[],e=this.signal={aborted:!1,addEventListener:function(t,i){n.push(i)}};this.abort=function(){e.aborted=!0,n.forEach(function(t){return t()})}},RB=ci.unstable_scheduleCallback,LB=ci.unstable_NormalPriority,Qn={$$typeof:ol,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function dC(){return{controller:new jB,data:new Map,refCount:0}}function ay(n){n.refCount--,n.refCount===0&&RB(LB,function(){n.controller.abort()})}var wm=null,SS=0,Wp=0,hf=null;function MB(n,e){if(wm===null){var t=wm=[];SS=0,Wp=IC(),hf={status:"pending",value:void 0,then:function(i){t.push(i)}}}return SS++,e.then(I_,I_),e}function I_(){if(--SS===0&&wm!==null){hf!==null&&(hf.status="fulfilled");var n=wm;wm=null,Wp=0,hf=null;for(var e=0;e<n.length;e++)(0,n[e])()}}function OB(n,e){var t=[],i={status:"pending",value:null,reason:null,then:function(s){t.push(s)}};return n.then(function(){i.status="fulfilled",i.value=e;for(var s=0;s<t.length;s++)(0,t[s])(e)},function(s){for(i.status="rejected",i.reason=s,s=0;s<t.length;s++)(0,t[s])(void 0)}),i}var B_=ot.S;ot.S=function(n,e){v5=rr(),typeof e=="object"&&e!==null&&typeof e.then=="function"&&MB(n,e),B_!==null&&B_(n,e)};var Fh=lo(null);function fC(){var n=Fh.current;return n!==null?n:cn.pooledCache}function hv(n,e){e===null?fn(Fh,Fh.current):fn(Fh,e.pool)}function a3(){var n=fC();return n===null?null:{parent:Qn._currentValue,pool:n}}var pg=Error(Ce(460)),pC=Error(Ce(474)),U1=Error(Ce(542)),yb={then:function(){}};function z_(n){return n=n.status,n==="fulfilled"||n==="rejected"}function o3(n,e,t){switch(t=n[t],t===void 0?n.push(e):t!==e&&(e.then(ll,ll),e=t),e.status){case"fulfilled":return e.value;case"rejected":throw n=e.reason,U_(n),n;default:if(typeof e.status=="string")e.then(ll,ll);else{if(n=cn,n!==null&&100<n.shellSuspendCounter)throw Error(Ce(482));n=e,n.status="pending",n.then(function(i){if(e.status==="pending"){var s=e;s.status="fulfilled",s.value=i}},function(i){if(e.status==="pending"){var s=e;s.status="rejected",s.reason=i}})}switch(e.status){case"fulfilled":return e.value;case"rejected":throw n=e.reason,U_(n),n}throw Uh=e,pg}}function xu(n){try{var e=n._init;return e(n._payload)}catch(t){throw t!==null&&typeof t=="object"&&typeof t.then=="function"?(Uh=t,pg):t}}var Uh=null;function F_(){if(Uh===null)throw Error(Ce(459));var n=Uh;return Uh=null,n}function U_(n){if(n===pg||n===U1)throw Error(Ce(483))}var df=null,Fm=0;function Iy(n){var e=Fm;return Fm+=1,df===null&&(df=[]),o3(df,n,e)}function Tg(n,e){e=e.props.ref,n.ref=e!==void 0?e:null}function By(n,e){throw e.$$typeof===wI?Error(Ce(525)):(n=Object.prototype.toString.call(e),Error(Ce(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n)))}function l3(n){function e(m,y){if(n){var w=m.deletions;w===null?(m.deletions=[y],m.flags|=16):w.push(y)}}function t(m,y){if(!n)return null;for(;y!==null;)e(m,y),y=y.sibling;return null}function i(m){for(var y=new Map;m!==null;)m.key!==null?y.set(m.key,m):y.set(m.index,m),m=m.sibling;return y}function s(m,y){return m=dl(m,y),m.index=0,m.sibling=null,m}function r(m,y,w){return m.index=w,n?(w=m.alternate,w!==null?(w=w.index,w<y?(m.flags|=67108866,y):w):(m.flags|=67108866,y)):(m.flags|=1048576,y)}function a(m){return n&&m.alternate===null&&(m.flags|=67108866),m}function o(m,y,w,E){return y===null||y.tag!==6?(y=Xw(w,m.mode,E),y.return=m,y):(y=s(y,w),y.return=m,y)}function c(m,y,w,E){var S=w.type;return S===Hd?d(m,y,w.props.children,E,w.key):y!==null&&(y.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Pl&&xu(S)===y.type)?(y=s(y,w.props),Tg(y,w),y.return=m,y):(y=uv(w.type,w.key,w.props,null,m.mode,E),Tg(y,w),y.return=m,y)}function h(m,y,w,E){return y===null||y.tag!==4||y.stateNode.containerInfo!==w.containerInfo||y.stateNode.implementation!==w.implementation?(y=Kw(w,m.mode,E),y.return=m,y):(y=s(y,w.children||[]),y.return=m,y)}function d(m,y,w,E,S){return y===null||y.tag!==7?(y=zh(w,m.mode,E,S),y.return=m,y):(y=s(y,w),y.return=m,y)}function f(m,y,w){if(typeof y=="string"&&y!==""||typeof y=="number"||typeof y=="bigint")return y=Xw(""+y,m.mode,w),y.return=m,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Dy:return w=uv(y.type,y.key,y.props,null,m.mode,w),Tg(w,y),w.return=m,w;case $g:return y=Kw(y,m.mode,w),y.return=m,y;case Pl:return y=xu(y),f(m,y,w)}if(qg(y)||Ng(y))return y=zh(y,m.mode,w,null),y.return=m,y;if(typeof y.then=="function")return f(m,Iy(y),w);if(y.$$typeof===ol)return f(m,Py(m,y),w);By(m,y)}return null}function p(m,y,w,E){var S=y!==null?y.key:null;if(typeof w=="string"&&w!==""||typeof w=="number"||typeof w=="bigint")return S!==null?null:o(m,y,""+w,E);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Dy:return w.key===S?c(m,y,w,E):null;case $g:return w.key===S?h(m,y,w,E):null;case Pl:return w=xu(w),p(m,y,w,E)}if(qg(w)||Ng(w))return S!==null?null:d(m,y,w,E,null);if(typeof w.then=="function")return p(m,y,Iy(w),E);if(w.$$typeof===ol)return p(m,y,Py(m,w),E);By(m,w)}return null}function g(m,y,w,E,S){if(typeof E=="string"&&E!==""||typeof E=="number"||typeof E=="bigint")return m=m.get(w)||null,o(y,m,""+E,S);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Dy:return m=m.get(E.key===null?w:E.key)||null,c(y,m,E,S);case $g:return m=m.get(E.key===null?w:E.key)||null,h(y,m,E,S);case Pl:return E=xu(E),g(m,y,w,E,S)}if(qg(E)||Ng(E))return m=m.get(w)||null,d(y,m,E,S,null);if(typeof E.then=="function")return g(m,y,w,Iy(E),S);if(E.$$typeof===ol)return g(m,y,w,Py(y,E),S);By(y,E)}return null}function v(m,y,w,E){for(var S=null,_=null,T=y,j=y=0,M=null;T!==null&&j<w.length;j++){T.index>j?(M=T,T=null):M=T.sibling;var L=p(m,T,w[j],E);if(L===null){T===null&&(T=M);break}n&&T&&L.alternate===null&&e(m,T),y=r(L,y,j),_===null?S=L:_.sibling=L,_=L,T=M}if(j===w.length)return t(m,T),Rt&&So(m,j),S;if(T===null){for(;j<w.length;j++)T=f(m,w[j],E),T!==null&&(y=r(T,y,j),_===null?S=T:_.sibling=T,_=T);return Rt&&So(m,j),S}for(T=i(T);j<w.length;j++)M=g(T,m,j,w[j],E),M!==null&&(n&&M.alternate!==null&&T.delete(M.key===null?j:M.key),y=r(M,y,j),_===null?S=M:_.sibling=M,_=M);return n&&T.forEach(function(O){return e(m,O)}),Rt&&So(m,j),S}function b(m,y,w,E){if(w==null)throw Error(Ce(151));for(var S=null,_=null,T=y,j=y=0,M=null,L=w.next();T!==null&&!L.done;j++,L=w.next()){T.index>j?(M=T,T=null):M=T.sibling;var O=p(m,T,L.value,E);if(O===null){T===null&&(T=M);break}n&&T&&O.alternate===null&&e(m,T),y=r(O,y,j),_===null?S=O:_.sibling=O,_=O,T=M}if(L.done)return t(m,T),Rt&&So(m,j),S;if(T===null){for(;!L.done;j++,L=w.next())L=f(m,L.value,E),L!==null&&(y=r(L,y,j),_===null?S=L:_.sibling=L,_=L);return Rt&&So(m,j),S}for(T=i(T);!L.done;j++,L=w.next())L=g(T,m,j,L.value,E),L!==null&&(n&&L.alternate!==null&&T.delete(L.key===null?j:L.key),y=r(L,y,j),_===null?S=L:_.sibling=L,_=L);return n&&T.forEach(function(B){return e(m,B)}),Rt&&So(m,j),S}function x(m,y,w,E){if(typeof w=="object"&&w!==null&&w.type===Hd&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Dy:e:{for(var S=w.key;y!==null;){if(y.key===S){if(S=w.type,S===Hd){if(y.tag===7){t(m,y.sibling),E=s(y,w.props.children),E.return=m,m=E;break e}}else if(y.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Pl&&xu(S)===y.type){t(m,y.sibling),E=s(y,w.props),Tg(E,w),E.return=m,m=E;break e}t(m,y);break}else e(m,y);y=y.sibling}w.type===Hd?(E=zh(w.props.children,m.mode,E,w.key),E.return=m,m=E):(E=uv(w.type,w.key,w.props,null,m.mode,E),Tg(E,w),E.return=m,m=E)}return a(m);case $g:e:{for(S=w.key;y!==null;){if(y.key===S)if(y.tag===4&&y.stateNode.containerInfo===w.containerInfo&&y.stateNode.implementation===w.implementation){t(m,y.sibling),E=s(y,w.children||[]),E.return=m,m=E;break e}else{t(m,y);break}else e(m,y);y=y.sibling}E=Kw(w,m.mode,E),E.return=m,m=E}return a(m);case Pl:return w=xu(w),x(m,y,w,E)}if(qg(w))return v(m,y,w,E);if(Ng(w)){if(S=Ng(w),typeof S!="function")throw Error(Ce(150));return w=S.call(w),b(m,y,w,E)}if(typeof w.then=="function")return x(m,y,Iy(w),E);if(w.$$typeof===ol)return x(m,y,Py(m,w),E);By(m,w)}return typeof w=="string"&&w!==""||typeof w=="number"||typeof w=="bigint"?(w=""+w,y!==null&&y.tag===6?(t(m,y.sibling),E=s(y,w),E.return=m,m=E):(t(m,y),E=Xw(w,m.mode,E),E.return=m,m=E),a(m)):t(m,y)}return function(m,y,w,E){try{Fm=0;var S=x(m,y,w,E);return df=null,S}catch(T){if(T===pg||T===U1)throw T;var _=nr(29,T,null,m.mode);return _.lanes=E,_.return=m,_}finally{}}}var Gh=l3(!0),c3=l3(!1),Il=!1;function gC(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function AS(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function Gc(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function Wc(n,e,t){var i=n.updateQueue;if(i===null)return null;if(i=i.shared,Bt&2){var s=i.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),i.pending=e,e=gb(n),e3(n,null,t),e}return F1(n,i,e,t),gb(n)}function Sm(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194048)!==0)){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,_j(n,t)}}function Qw(n,e){var t=n.updateQueue,i=n.alternate;if(i!==null&&(i=i.updateQueue,t===i)){var s=null,r=null;if(t=t.firstBaseUpdate,t!==null){do{var a={lane:t.lane,tag:t.tag,payload:t.payload,callback:null,next:null};r===null?s=r=a:r=r.next=a,t=t.next}while(t!==null);r===null?s=r=e:r=r.next=e}else s=r=e;t={baseState:i.baseState,firstBaseUpdate:s,lastBaseUpdate:r,shared:i.shared,callbacks:i.callbacks},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}var ES=!1;function Am(){if(ES){var n=hf;if(n!==null)throw n}}function Em(n,e,t,i){ES=!1;var s=n.updateQueue;Il=!1;var r=s.firstBaseUpdate,a=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var c=o,h=c.next;c.next=null,a===null?r=h:a.next=h,a=c;var d=n.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==a&&(o===null?d.firstBaseUpdate=h:o.next=h,d.lastBaseUpdate=c))}if(r!==null){var f=s.baseState;a=0,d=h=c=null,o=r;do{var p=o.lane&-536870913,g=p!==o.lane;if(g?(_t&p)===p:(i&p)===p){p!==0&&p===Wp&&(ES=!0),d!==null&&(d=d.next={lane:0,tag:o.tag,payload:o.payload,callback:null,next:null});e:{var v=n,b=o;p=e;var x=t;switch(b.tag){case 1:if(v=b.payload,typeof v=="function"){f=v.call(x,f,p);break e}f=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=b.payload,p=typeof v=="function"?v.call(x,f,p):v,p==null)break e;f=yn({},f,p);break e;case 2:Il=!0}}p=o.callback,p!==null&&(n.flags|=64,g&&(n.flags|=8192),g=s.callbacks,g===null?s.callbacks=[p]:g.push(p))}else g={lane:p,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(h=d=g,c=f):d=d.next=g,a|=p;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;g=o,o=g.next,g.next=null,s.lastBaseUpdate=g,s.shared.pending=null}}while(!0);d===null&&(c=f),s.baseState=c,s.firstBaseUpdate=h,s.lastBaseUpdate=d,r===null&&(s.shared.lanes=0),su|=a,n.lanes=a,n.memoizedState=f}}function u3(n,e){if(typeof n!="function")throw Error(Ce(191,n));n.call(e)}function h3(n,e){var t=n.callbacks;if(t!==null)for(n.callbacks=null,n=0;n<t.length;n++)u3(t[n],e)}var Yp=lo(null),vb=lo(0);function H_(n,e){n=Al,fn(vb,n),fn(Yp,e),Al=n|e.baseLanes}function CS(){fn(vb,Al),fn(Yp,Yp.current)}function mC(){Al=vb.current,bi(Yp),bi(vb)}var hr=lo(null),Fr=null;function zl(n){var e=n.alternate;fn($n,$n.current&1),fn(hr,n),Fr===null&&(e===null||Yp.current!==null||e.memoizedState!==null)&&(Fr=n)}function NS(n){fn($n,$n.current),fn(hr,n),Fr===null&&(Fr=n)}function d3(n){n.tag===22?(fn($n,$n.current),fn(hr,n),Fr===null&&(Fr=n)):Fl()}function Fl(){fn($n,$n.current),fn(hr,hr.current)}function er(n){bi(hr),Fr===n&&(Fr=null),bi($n)}var $n=lo(0);function bb(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||VS(t)||GS(t)))return e}else if(e.tag===19&&(e.memoizedProps.revealOrder==="forwards"||e.memoizedProps.revealOrder==="backwards"||e.memoizedProps.revealOrder==="unstable_legacy-backwards"||e.memoizedProps.revealOrder==="together")){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var bl=0,yt=null,sn=null,Kn=null,wb=!1,ff=!1,Wh=!1,Sb=0,Um=0,pf=null,PB=0;function Tn(){throw Error(Ce(321))}function xC(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!ur(n[t],e[t]))return!1;return!0}function yC(n,e,t,i,s,r){return bl=r,yt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ot.H=n===null||n.memoizedState===null?$3:TC,Wh=!1,r=t(i,s),Wh=!1,ff&&(r=p3(e,t,i,s)),f3(n),r}function f3(n){ot.H=Hm;var e=sn!==null&&sn.next!==null;if(bl=0,Kn=sn=yt=null,wb=!1,Um=0,pf=null,e)throw Error(Ce(300));n===null||Jn||(n=n.dependencies,n!==null&&xb(n)&&(Jn=!0))}function p3(n,e,t,i){yt=n;var s=0;do{if(ff&&(pf=null),Um=0,ff=!1,25<=s)throw Error(Ce(301));if(s+=1,Kn=sn=null,n.updateQueue!=null){var r=n.updateQueue;r.lastEffect=null,r.events=null,r.stores=null,r.memoCache!=null&&(r.memoCache.index=0)}ot.H=q3,r=e(t,i)}while(ff);return r}function IB(){var n=ot.H,e=n.useState()[0];return e=typeof e.then=="function"?oy(e):e,n=n.useState()[0],(sn!==null?sn.memoizedState:null)!==n&&(yt.flags|=1024),e}function vC(){var n=Sb!==0;return Sb=0,n}function bC(n,e,t){e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~t}function wC(n){if(wb){for(n=n.memoizedState;n!==null;){var e=n.queue;e!==null&&(e.pending=null),n=n.next}wb=!1}bl=0,Kn=sn=yt=null,ff=!1,Um=Sb=0,pf=null}function ts(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Kn===null?yt.memoizedState=Kn=n:Kn=Kn.next=n,Kn}function qn(){if(sn===null){var n=yt.alternate;n=n!==null?n.memoizedState:null}else n=sn.next;var e=Kn===null?yt.memoizedState:Kn.next;if(e!==null)Kn=e,sn=n;else{if(n===null)throw yt.alternate===null?Error(Ce(467)):Error(Ce(310));sn=n,n={memoizedState:sn.memoizedState,baseState:sn.baseState,baseQueue:sn.baseQueue,queue:sn.queue,next:null},Kn===null?yt.memoizedState=Kn=n:Kn=Kn.next=n}return Kn}function H1(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function oy(n){var e=Um;return Um+=1,pf===null&&(pf=[]),n=o3(pf,n,e),e=yt,(Kn===null?e.memoizedState:Kn.next)===null&&(e=e.alternate,ot.H=e===null||e.memoizedState===null?$3:TC),n}function $1(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return oy(n);if(n.$$typeof===ol)return Oi(n)}throw Error(Ce(438,String(n)))}function SC(n){var e=null,t=yt.updateQueue;if(t!==null&&(e=t.memoCache),e==null){var i=yt.alternate;i!==null&&(i=i.updateQueue,i!==null&&(i=i.memoCache,i!=null&&(e={data:i.data.map(function(s){return s.slice()}),index:0})))}if(e==null&&(e={data:[],index:0}),t===null&&(t=H1(),yt.updateQueue=t),t.memoCache=e,t=e.data[e.index],t===void 0)for(t=e.data[e.index]=Array(n),i=0;i<n;i++)t[i]=SI;return e.index++,t}function wl(n,e){return typeof e=="function"?e(n):e}function dv(n){var e=qn();return AC(e,sn,n)}function AC(n,e,t){var i=n.queue;if(i===null)throw Error(Ce(311));i.lastRenderedReducer=t;var s=n.baseQueue,r=i.pending;if(r!==null){if(s!==null){var a=s.next;s.next=r.next,r.next=a}e.baseQueue=s=r,i.pending=null}if(r=n.baseState,s===null)n.memoizedState=r;else{e=s.next;var o=a=null,c=null,h=e,d=!1;do{var f=h.lane&-536870913;if(f!==h.lane?(_t&f)===f:(bl&f)===f){var p=h.revertLane;if(p===0)c!==null&&(c=c.next={lane:0,revertLane:0,gesture:null,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),f===Wp&&(d=!0);else if((bl&p)===p){h=h.next,p===Wp&&(d=!0);continue}else f={lane:0,revertLane:h.revertLane,gesture:null,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null},c===null?(o=c=f,a=r):c=c.next=f,yt.lanes|=p,su|=p;f=h.action,Wh&&t(r,f),r=h.hasEagerState?h.eagerState:t(r,f)}else p={lane:f,revertLane:h.revertLane,gesture:h.gesture,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null},c===null?(o=c=p,a=r):c=c.next=p,yt.lanes|=f,su|=f;h=h.next}while(h!==null&&h!==e);if(c===null?a=r:c.next=o,!ur(r,n.memoizedState)&&(Jn=!0,d&&(t=hf,t!==null)))throw t;n.memoizedState=r,n.baseState=a,n.baseQueue=c,i.lastRenderedState=r}return s===null&&(i.lanes=0),[n.memoizedState,i.dispatch]}function Jw(n){var e=qn(),t=e.queue;if(t===null)throw Error(Ce(311));t.lastRenderedReducer=n;var i=t.dispatch,s=t.pending,r=e.memoizedState;if(s!==null){t.pending=null;var a=s=s.next;do r=n(r,a.action),a=a.next;while(a!==s);ur(r,e.memoizedState)||(Jn=!0),e.memoizedState=r,e.baseQueue===null&&(e.baseState=r),t.lastRenderedState=r}return[r,i]}function g3(n,e,t){var i=yt,s=qn(),r=Rt;if(r){if(t===void 0)throw Error(Ce(407));t=t()}else t=e();var a=!ur((sn||s).memoizedState,t);if(a&&(s.memoizedState=t,Jn=!0),s=s.queue,EC(y3.bind(null,i,s,n),[n]),s.getSnapshot!==e||a||Kn!==null&&Kn.memoizedState.tag&1){if(i.flags|=2048,Xp(9,{destroy:void 0},x3.bind(null,i,s,t,e),null),cn===null)throw Error(Ce(349));r||bl&127||m3(i,e,t)}return t}function m3(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=yt.updateQueue,e===null?(e=H1(),yt.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function x3(n,e,t,i){e.value=t,e.getSnapshot=i,v3(e)&&b3(n)}function y3(n,e,t){return t(function(){v3(e)&&b3(n)})}function v3(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!ur(n,t)}catch{return!0}}function b3(n){var e=sd(n,2);e!==null&&Es(e,n,2)}function _S(n){var e=ts();if(typeof n=="function"){var t=n;if(n=t(),Wh){Ic(!0);try{t()}finally{Ic(!1)}}}return e.memoizedState=e.baseState=n,e.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:wl,lastRenderedState:n},e}function w3(n,e,t,i){return n.baseState=t,AC(n,sn,typeof i=="function"?i:wl)}function BB(n,e,t,i,s){if(V1(n))throw Error(Ce(485));if(n=e.action,n!==null){var r={payload:s,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(a){r.listeners.push(a)}};ot.T!==null?t(!0):r.isTransition=!1,i(r),t=e.pending,t===null?(r.next=e.pending=r,S3(e,r)):(r.next=t.next,e.pending=t.next=r)}}function S3(n,e){var t=e.action,i=e.payload,s=n.state;if(e.isTransition){var r=ot.T,a={};ot.T=a;try{var o=t(s,i),c=ot.S;c!==null&&c(a,o),$_(n,e,o)}catch(h){kS(n,e,h)}finally{r!==null&&a.types!==null&&(r.types=a.types),ot.T=r}}else try{r=t(s,i),$_(n,e,r)}catch(h){kS(n,e,h)}}function $_(n,e,t){t!==null&&typeof t=="object"&&typeof t.then=="function"?t.then(function(i){q_(n,e,i)},function(i){return kS(n,e,i)}):q_(n,e,t)}function q_(n,e,t){e.status="fulfilled",e.value=t,A3(e),n.state=t,e=n.pending,e!==null&&(t=e.next,t===e?n.pending=null:(t=t.next,e.next=t,S3(n,t)))}function kS(n,e,t){var i=n.pending;if(n.pending=null,i!==null){i=i.next;do e.status="rejected",e.reason=t,A3(e),e=e.next;while(e!==i)}n.action=null}function A3(n){n=n.listeners;for(var e=0;e<n.length;e++)(0,n[e])()}function E3(n,e){return e}function V_(n,e){if(Rt){var t=cn.formState;if(t!==null){e:{var i=yt;if(Rt){if(mn){t:{for(var s=mn,r=Ir;s.nodeType!==8;){if(!r){s=null;break t}if(s=Ur(s.nextSibling),s===null){s=null;break t}}r=s.data,s=r==="F!"||r==="F"?s:null}if(s){mn=Ur(s.nextSibling),i=s.data==="F!";break e}}nu(i)}i=!1}i&&(e=t[0])}}return t=ts(),t.memoizedState=t.baseState=e,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:E3,lastRenderedState:e},t.queue=i,t=F3.bind(null,yt,i),i.dispatch=t,i=_S(!1),r=kC.bind(null,yt,!1,i.queue),i=ts(),s={state:e,dispatch:null,action:n,pending:null},i.queue=s,t=BB.bind(null,yt,s,r,t),s.dispatch=t,i.memoizedState=n,[e,t,!1]}function G_(n){var e=qn();return C3(e,sn,n)}function C3(n,e,t){if(e=AC(n,e,E3)[0],n=dv(wl)[0],typeof e=="object"&&e!==null&&typeof e.then=="function")try{var i=oy(e)}catch(a){throw a===pg?U1:a}else i=e;e=qn();var s=e.queue,r=s.dispatch;return t!==e.memoizedState&&(yt.flags|=2048,Xp(9,{destroy:void 0},zB.bind(null,s,t),null)),[i,r,n]}function zB(n,e){n.action=e}function W_(n){var e=qn(),t=sn;if(t!==null)return C3(e,t,n);qn(),e=e.memoizedState,t=qn();var i=t.queue.dispatch;return t.memoizedState=n,[e,i,!1]}function Xp(n,e,t,i){return n={tag:n,create:t,deps:i,inst:e,next:null},e=yt.updateQueue,e===null&&(e=H1(),yt.updateQueue=e),t=e.lastEffect,t===null?e.lastEffect=n.next=n:(i=t.next,t.next=n,n.next=i,e.lastEffect=n),n}function N3(){return qn().memoizedState}function fv(n,e,t,i){var s=ts();yt.flags|=n,s.memoizedState=Xp(1|e,{destroy:void 0},t,i===void 0?null:i)}function q1(n,e,t,i){var s=qn();i=i===void 0?null:i;var r=s.memoizedState.inst;sn!==null&&i!==null&&xC(i,sn.memoizedState.deps)?s.memoizedState=Xp(e,r,t,i):(yt.flags|=n,s.memoizedState=Xp(1|e,r,t,i))}function Y_(n,e){fv(8390656,8,n,e)}function EC(n,e){q1(2048,8,n,e)}function FB(n){yt.flags|=4;var e=yt.updateQueue;if(e===null)e=H1(),yt.updateQueue=e,e.events=[n];else{var t=e.events;t===null?e.events=[n]:t.push(n)}}function _3(n){var e=qn().memoizedState;return FB({ref:e,nextImpl:n}),function(){if(Bt&2)throw Error(Ce(440));return e.impl.apply(void 0,arguments)}}function k3(n,e){return q1(4,2,n,e)}function T3(n,e){return q1(4,4,n,e)}function D3(n,e){if(typeof e=="function"){n=n();var t=e(n);return function(){typeof t=="function"?t():e(null)}}if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function j3(n,e,t){t=t!=null?t.concat([n]):null,q1(4,4,D3.bind(null,e,n),t)}function CC(){}function R3(n,e){var t=qn();e=e===void 0?null:e;var i=t.memoizedState;return e!==null&&xC(e,i[1])?i[0]:(t.memoizedState=[n,e],n)}function L3(n,e){var t=qn();e=e===void 0?null:e;var i=t.memoizedState;if(e!==null&&xC(e,i[1]))return i[0];if(i=n(),Wh){Ic(!0);try{n()}finally{Ic(!1)}}return t.memoizedState=[i,e],i}function NC(n,e,t){return t===void 0||bl&1073741824&&!(_t&261930)?n.memoizedState=e:(n.memoizedState=t,n=w5(),yt.lanes|=n,su|=n,t)}function M3(n,e,t,i){return ur(t,e)?t:Yp.current!==null?(n=NC(n,t,i),ur(n,e)||(Jn=!0),n):!(bl&42)||bl&1073741824&&!(_t&261930)?(Jn=!0,n.memoizedState=t):(n=w5(),yt.lanes|=n,su|=n,e)}function O3(n,e,t,i,s){var r=Ft.p;Ft.p=r!==0&&8>r?r:8;var a=ot.T,o={};ot.T=o,kC(n,!1,e,t);try{var c=s(),h=ot.S;if(h!==null&&h(o,c),c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=OB(c,i);Cm(n,e,d,lr(n))}else Cm(n,e,i,lr(n))}catch(f){Cm(n,e,{then:function(){},status:"rejected",reason:f},lr())}finally{Ft.p=r,a!==null&&o.types!==null&&(a.types=o.types),ot.T=a}}function UB(){}function TS(n,e,t,i){if(n.tag!==5)throw Error(Ce(476));var s=P3(n).queue;O3(n,s,e,Bh,t===null?UB:function(){return I3(n),t(i)})}function P3(n){var e=n.memoizedState;if(e!==null)return e;e={memoizedState:Bh,baseState:Bh,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:wl,lastRenderedState:Bh},next:null};var t={};return e.next={memoizedState:t,baseState:t,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:wl,lastRenderedState:t},next:null},n.memoizedState=e,n=n.alternate,n!==null&&(n.memoizedState=e),e}function I3(n){var e=P3(n);e.next===null&&(e=n.alternate.memoizedState),Cm(n,e.next.queue,{},lr())}function _C(){return Oi(Vm)}function B3(){return qn().memoizedState}function z3(){return qn().memoizedState}function HB(n){for(var e=n.return;e!==null;){switch(e.tag){case 24:case 3:var t=lr();n=Gc(t);var i=Wc(e,n,t);i!==null&&(Es(i,e,t),Sm(i,e,t)),e={cache:dC()},n.payload=e;return}e=e.return}}function $B(n,e,t){var i=lr();t={lane:i,revertLane:0,gesture:null,action:t,hasEagerState:!1,eagerState:null,next:null},V1(n)?U3(e,t):(t=lC(n,e,t,i),t!==null&&(Es(t,n,i),H3(t,e,i)))}function F3(n,e,t){var i=lr();Cm(n,e,t,i)}function Cm(n,e,t,i){var s={lane:i,revertLane:0,gesture:null,action:t,hasEagerState:!1,eagerState:null,next:null};if(V1(n))U3(e,s);else{var r=n.alternate;if(n.lanes===0&&(r===null||r.lanes===0)&&(r=e.lastRenderedReducer,r!==null))try{var a=e.lastRenderedState,o=r(a,t);if(s.hasEagerState=!0,s.eagerState=o,ur(o,a))return F1(n,e,s,0),cn===null&&z1(),!1}catch{}finally{}if(t=lC(n,e,s,i),t!==null)return Es(t,n,i),H3(t,e,i),!0}return!1}function kC(n,e,t,i){if(i={lane:2,revertLane:IC(),gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null},V1(n)){if(e)throw Error(Ce(479))}else e=lC(n,t,i,2),e!==null&&Es(e,n,2)}function V1(n){var e=n.alternate;return n===yt||e!==null&&e===yt}function U3(n,e){ff=wb=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function H3(n,e,t){if(t&4194048){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,_j(n,t)}}var Hm={readContext:Oi,use:$1,useCallback:Tn,useContext:Tn,useEffect:Tn,useImperativeHandle:Tn,useLayoutEffect:Tn,useInsertionEffect:Tn,useMemo:Tn,useReducer:Tn,useRef:Tn,useState:Tn,useDebugValue:Tn,useDeferredValue:Tn,useTransition:Tn,useSyncExternalStore:Tn,useId:Tn,useHostTransitionStatus:Tn,useFormState:Tn,useActionState:Tn,useOptimistic:Tn,useMemoCache:Tn,useCacheRefresh:Tn};Hm.useEffectEvent=Tn;var $3={readContext:Oi,use:$1,useCallback:function(n,e){return ts().memoizedState=[n,e===void 0?null:e],n},useContext:Oi,useEffect:Y_,useImperativeHandle:function(n,e,t){t=t!=null?t.concat([n]):null,fv(4194308,4,D3.bind(null,e,n),t)},useLayoutEffect:function(n,e){return fv(4194308,4,n,e)},useInsertionEffect:function(n,e){fv(4,2,n,e)},useMemo:function(n,e){var t=ts();e=e===void 0?null:e;var i=n();if(Wh){Ic(!0);try{n()}finally{Ic(!1)}}return t.memoizedState=[i,e],i},useReducer:function(n,e,t){var i=ts();if(t!==void 0){var s=t(e);if(Wh){Ic(!0);try{t(e)}finally{Ic(!1)}}}else s=e;return i.memoizedState=i.baseState=s,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:s},i.queue=n,n=n.dispatch=$B.bind(null,yt,n),[i.memoizedState,n]},useRef:function(n){var e=ts();return n={current:n},e.memoizedState=n},useState:function(n){n=_S(n);var e=n.queue,t=F3.bind(null,yt,e);return e.dispatch=t,[n.memoizedState,t]},useDebugValue:CC,useDeferredValue:function(n,e){var t=ts();return NC(t,n,e)},useTransition:function(){var n=_S(!1);return n=O3.bind(null,yt,n.queue,!0,!1),ts().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,e,t){var i=yt,s=ts();if(Rt){if(t===void 0)throw Error(Ce(407));t=t()}else{if(t=e(),cn===null)throw Error(Ce(349));_t&127||m3(i,e,t)}s.memoizedState=t;var r={value:t,getSnapshot:e};return s.queue=r,Y_(y3.bind(null,i,r,n),[n]),i.flags|=2048,Xp(9,{destroy:void 0},x3.bind(null,i,r,t,e),null),t},useId:function(){var n=ts(),e=cn.identifierPrefix;if(Rt){var t=Qa,i=Za;t=(i&~(1<<32-or(i)-1)).toString(32)+t,e="_"+e+"R_"+t,t=Sb++,0<t&&(e+="H"+t.toString(32)),e+="_"}else t=PB++,e="_"+e+"r_"+t.toString(32)+"_";return n.memoizedState=e},useHostTransitionStatus:_C,useFormState:V_,useActionState:V_,useOptimistic:function(n){var e=ts();e.memoizedState=e.baseState=n;var t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return e.queue=t,e=kC.bind(null,yt,!0,t),t.dispatch=e,[n,e]},useMemoCache:SC,useCacheRefresh:function(){return ts().memoizedState=HB.bind(null,yt)},useEffectEvent:function(n){var e=ts(),t={impl:n};return e.memoizedState=t,function(){if(Bt&2)throw Error(Ce(440));return t.impl.apply(void 0,arguments)}}},TC={readContext:Oi,use:$1,useCallback:R3,useContext:Oi,useEffect:EC,useImperativeHandle:j3,useInsertionEffect:k3,useLayoutEffect:T3,useMemo:L3,useReducer:dv,useRef:N3,useState:function(){return dv(wl)},useDebugValue:CC,useDeferredValue:function(n,e){var t=qn();return M3(t,sn.memoizedState,n,e)},useTransition:function(){var n=dv(wl)[0],e=qn().memoizedState;return[typeof n=="boolean"?n:oy(n),e]},useSyncExternalStore:g3,useId:B3,useHostTransitionStatus:_C,useFormState:G_,useActionState:G_,useOptimistic:function(n,e){var t=qn();return w3(t,sn,n,e)},useMemoCache:SC,useCacheRefresh:z3};TC.useEffectEvent=_3;var q3={readContext:Oi,use:$1,useCallback:R3,useContext:Oi,useEffect:EC,useImperativeHandle:j3,useInsertionEffect:k3,useLayoutEffect:T3,useMemo:L3,useReducer:Jw,useRef:N3,useState:function(){return Jw(wl)},useDebugValue:CC,useDeferredValue:function(n,e){var t=qn();return sn===null?NC(t,n,e):M3(t,sn.memoizedState,n,e)},useTransition:function(){var n=Jw(wl)[0],e=qn().memoizedState;return[typeof n=="boolean"?n:oy(n),e]},useSyncExternalStore:g3,useId:B3,useHostTransitionStatus:_C,useFormState:W_,useActionState:W_,useOptimistic:function(n,e){var t=qn();return sn!==null?w3(t,sn,n,e):(t.baseState=n,[n,t.queue.dispatch])},useMemoCache:SC,useCacheRefresh:z3};q3.useEffectEvent=_3;function e2(n,e,t,i){e=n.memoizedState,t=t(i,e),t=t==null?e:yn({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var DS={enqueueSetState:function(n,e,t){n=n._reactInternals;var i=lr(),s=Gc(i);s.payload=e,t!=null&&(s.callback=t),e=Wc(n,s,i),e!==null&&(Es(e,n,i),Sm(e,n,i))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var i=lr(),s=Gc(i);s.tag=1,s.payload=e,t!=null&&(s.callback=t),e=Wc(n,s,i),e!==null&&(Es(e,n,i),Sm(e,n,i))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=lr(),i=Gc(t);i.tag=2,e!=null&&(i.callback=e),e=Wc(n,i,t),e!==null&&(Es(e,n,t),Sm(e,n,t))}};function X_(n,e,t,i,s,r,a){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(i,r,a):e.prototype&&e.prototype.isPureReactComponent?!Im(t,i)||!Im(s,r):!0}function K_(n,e,t,i){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,i),e.state!==n&&DS.enqueueReplaceState(e,e.state,null)}function Yh(n,e){var t=e;if("ref"in e){t={};for(var i in e)i!=="ref"&&(t[i]=e[i])}if(n=n.defaultProps){t===e&&(t=yn({},t));for(var s in n)t[s]===void 0&&(t[s]=n[s])}return t}function V3(n){pb(n)}function G3(n){console.error(n)}function W3(n){pb(n)}function Ab(n,e){try{var t=n.onUncaughtError;t(e.value,{componentStack:e.stack})}catch(i){setTimeout(function(){throw i})}}function Z_(n,e,t){try{var i=n.onCaughtError;i(t.value,{componentStack:t.stack,errorBoundary:e.tag===1?e.stateNode:null})}catch(s){setTimeout(function(){throw s})}}function jS(n,e,t){return t=Gc(t),t.tag=3,t.payload={element:null},t.callback=function(){Ab(n,e)},t}function Y3(n){return n=Gc(n),n.tag=3,n}function X3(n,e,t,i){var s=t.type.getDerivedStateFromError;if(typeof s=="function"){var r=i.value;n.payload=function(){return s(r)},n.callback=function(){Z_(e,t,i)}}var a=t.stateNode;a!==null&&typeof a.componentDidCatch=="function"&&(n.callback=function(){Z_(e,t,i),typeof s!="function"&&(Yc===null?Yc=new Set([this]):Yc.add(this));var o=i.stack;this.componentDidCatch(i.value,{componentStack:o!==null?o:""})})}function qB(n,e,t,i,s){if(t.flags|=32768,i!==null&&typeof i=="object"&&typeof i.then=="function"){if(e=t.alternate,e!==null&&fg(e,t,s,!0),t=hr.current,t!==null){switch(t.tag){case 31:case 13:return Fr===null?kb():t.alternate===null&&Pn===0&&(Pn=3),t.flags&=-257,t.flags|=65536,t.lanes=s,i===yb?t.flags|=16384:(e=t.updateQueue,e===null?t.updateQueue=new Set([i]):e.add(i),h2(n,i,s)),!1;case 22:return t.flags|=65536,i===yb?t.flags|=16384:(e=t.updateQueue,e===null?(e={transitions:null,markerInstances:null,retryQueue:new Set([i])},t.updateQueue=e):(t=e.retryQueue,t===null?e.retryQueue=new Set([i]):t.add(i)),h2(n,i,s)),!1}throw Error(Ce(435,t.tag))}return h2(n,i,s),kb(),!1}if(Rt)return e=hr.current,e!==null?(!(e.flags&65536)&&(e.flags|=256),e.flags|=65536,e.lanes=s,i!==yS&&(n=Error(Ce(422),{cause:i}),zm(Pr(n,t)))):(i!==yS&&(e=Error(Ce(423),{cause:i}),zm(Pr(e,t))),n=n.current.alternate,n.flags|=65536,s&=-s,n.lanes|=s,i=Pr(i,t),s=jS(n.stateNode,i,s),Qw(n,s),Pn!==4&&(Pn=2)),!1;var r=Error(Ce(520),{cause:i});if(r=Pr(r,t),km===null?km=[r]:km.push(r),Pn!==4&&(Pn=2),e===null)return!0;i=Pr(i,t),t=e;do{switch(t.tag){case 3:return t.flags|=65536,n=s&-s,t.lanes|=n,n=jS(t.stateNode,i,n),Qw(t,n),!1;case 1:if(e=t.type,r=t.stateNode,(t.flags&128)===0&&(typeof e.getDerivedStateFromError=="function"||r!==null&&typeof r.componentDidCatch=="function"&&(Yc===null||!Yc.has(r))))return t.flags|=65536,s&=-s,t.lanes|=s,s=Y3(s),X3(s,n,t,i),Qw(t,s),!1}t=t.return}while(t!==null);return!1}var DC=Error(Ce(461)),Jn=!1;function ki(n,e,t,i){e.child=n===null?c3(e,null,t,i):Gh(e,n.child,t,i)}function Q_(n,e,t,i,s){t=t.render;var r=e.ref;if("ref"in i){var a={};for(var o in i)o!=="ref"&&(a[o]=i[o])}else a=i;return Vh(e),i=yC(n,e,t,a,r,s),o=vC(),n!==null&&!Jn?(bC(n,e,s),Sl(n,e,s)):(Rt&&o&&uC(e),e.flags|=1,ki(n,e,i,s),e.child)}function J_(n,e,t,i,s){if(n===null){var r=t.type;return typeof r=="function"&&!cC(r)&&r.defaultProps===void 0&&t.compare===null?(e.tag=15,e.type=r,K3(n,e,r,i,s)):(n=uv(t.type,null,i,e,e.mode,s),n.ref=e.ref,n.return=e,e.child=n)}if(r=n.child,!jC(n,s)){var a=r.memoizedProps;if(t=t.compare,t=t!==null?t:Im,t(a,i)&&n.ref===e.ref)return Sl(n,e,s)}return e.flags|=1,n=dl(r,i),n.ref=e.ref,n.return=e,e.child=n}function K3(n,e,t,i,s){if(n!==null){var r=n.memoizedProps;if(Im(r,i)&&n.ref===e.ref)if(Jn=!1,e.pendingProps=i=r,jC(n,s))n.flags&131072&&(Jn=!0);else return e.lanes=n.lanes,Sl(n,e,s)}return RS(n,e,t,i,s)}function Z3(n,e,t,i){var s=i.children,r=n!==null?n.memoizedState:null;if(n===null&&e.stateNode===null&&(e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.mode==="hidden"){if(e.flags&128){if(r=r!==null?r.baseLanes|t:t,n!==null){for(i=e.child=n.child,s=0;i!==null;)s=s|i.lanes|i.childLanes,i=i.sibling;i=s&~r}else i=0,e.child=null;return ek(n,e,r,t,i)}if(t&536870912)e.memoizedState={baseLanes:0,cachePool:null},n!==null&&hv(e,r!==null?r.cachePool:null),r!==null?H_(e,r):CS(),d3(e);else return i=e.lanes=536870912,ek(n,e,r!==null?r.baseLanes|t:t,t,i)}else r!==null?(hv(e,r.cachePool),H_(e,r),Fl(),e.memoizedState=null):(n!==null&&hv(e,null),CS(),Fl());return ki(n,e,s,t),e.child}function Gg(n,e){return n!==null&&n.tag===22||e.stateNode!==null||(e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),e.sibling}function ek(n,e,t,i,s){var r=fC();return r=r===null?null:{parent:Qn._currentValue,pool:r},e.memoizedState={baseLanes:t,cachePool:r},n!==null&&hv(e,null),CS(),d3(e),n!==null&&fg(n,e,i,!0),e.childLanes=s,null}function pv(n,e){return e=Eb({mode:e.mode,children:e.children},n.mode),e.ref=n.ref,n.child=e,e.return=n,e}function tk(n,e,t){return Gh(e,n.child,null,t),n=pv(e,e.pendingProps),n.flags|=2,er(e),e.memoizedState=null,n}function VB(n,e,t){var i=e.pendingProps,s=(e.flags&128)!==0;if(e.flags&=-129,n===null){if(Rt){if(i.mode==="hidden")return n=pv(e,i),e.lanes=536870912,Gg(null,n);if(NS(e),(n=mn)?(n=$5(n,Ir),n=n!==null&&n.data==="&"?n:null,n!==null&&(e.memoizedState={dehydrated:n,treeContext:tu!==null?{id:Za,overflow:Qa}:null,retryLane:536870912,hydrationErrors:null},t=n3(n),t.return=e,e.child=t,Li=e,mn=null)):n=null,n===null)throw nu(e);return e.lanes=536870912,null}return pv(e,i)}var r=n.memoizedState;if(r!==null){var a=r.dehydrated;if(NS(e),s)if(e.flags&256)e.flags&=-257,e=tk(n,e,t);else if(e.memoizedState!==null)e.child=n.child,e.flags|=128,e=null;else throw Error(Ce(558));else if(Jn||fg(n,e,t,!1),s=(t&n.childLanes)!==0,Jn||s){if(i=cn,i!==null&&(a=kj(i,t),a!==0&&a!==r.retryLane))throw r.retryLane=a,sd(n,a),Es(i,n,a),DC;kb(),e=tk(n,e,t)}else n=r.treeContext,mn=Ur(a.nextSibling),Li=e,Rt=!0,Vc=null,Ir=!1,n!==null&&s3(e,n),e=pv(e,i),e.flags|=4096;return e}return n=dl(n.child,{mode:i.mode,children:i.children}),n.ref=e.ref,e.child=n,n.return=e,n}function gv(n,e){var t=e.ref;if(t===null)n!==null&&n.ref!==null&&(e.flags|=4194816);else{if(typeof t!="function"&&typeof t!="object")throw Error(Ce(284));(n===null||n.ref!==t)&&(e.flags|=4194816)}}function RS(n,e,t,i,s){return Vh(e),t=yC(n,e,t,i,void 0,s),i=vC(),n!==null&&!Jn?(bC(n,e,s),Sl(n,e,s)):(Rt&&i&&uC(e),e.flags|=1,ki(n,e,t,s),e.child)}function nk(n,e,t,i,s,r){return Vh(e),e.updateQueue=null,t=p3(e,i,t,s),f3(n),i=vC(),n!==null&&!Jn?(bC(n,e,r),Sl(n,e,r)):(Rt&&i&&uC(e),e.flags|=1,ki(n,e,t,r),e.child)}function ik(n,e,t,i,s){if(Vh(e),e.stateNode===null){var r=Kd,a=t.contextType;typeof a=="object"&&a!==null&&(r=Oi(a)),r=new t(i,r),e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,r.updater=DS,e.stateNode=r,r._reactInternals=e,r=e.stateNode,r.props=i,r.state=e.memoizedState,r.refs={},gC(e),a=t.contextType,r.context=typeof a=="object"&&a!==null?Oi(a):Kd,r.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(e2(e,t,a,i),r.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(a=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),a!==r.state&&DS.enqueueReplaceState(r,r.state,null),Em(e,i,r,s),Am(),r.state=e.memoizedState),typeof r.componentDidMount=="function"&&(e.flags|=4194308),i=!0}else if(n===null){r=e.stateNode;var o=e.memoizedProps,c=Yh(t,o);r.props=c;var h=r.context,d=t.contextType;a=Kd,typeof d=="object"&&d!==null&&(a=Oi(d));var f=t.getDerivedStateFromProps;d=typeof f=="function"||typeof r.getSnapshotBeforeUpdate=="function",o=e.pendingProps!==o,d||typeof r.UNSAFE_componentWillReceiveProps!="function"&&typeof r.componentWillReceiveProps!="function"||(o||h!==a)&&K_(e,r,i,a),Il=!1;var p=e.memoizedState;r.state=p,Em(e,i,r,s),Am(),h=e.memoizedState,o||p!==h||Il?(typeof f=="function"&&(e2(e,t,f,i),h=e.memoizedState),(c=Il||X_(e,t,c,i,p,h,a))?(d||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount()),typeof r.componentDidMount=="function"&&(e.flags|=4194308)):(typeof r.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=h),r.props=i,r.state=h,r.context=a,i=c):(typeof r.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{r=e.stateNode,AS(n,e),a=e.memoizedProps,d=Yh(t,a),r.props=d,f=e.pendingProps,p=r.context,h=t.contextType,c=Kd,typeof h=="object"&&h!==null&&(c=Oi(h)),o=t.getDerivedStateFromProps,(h=typeof o=="function"||typeof r.getSnapshotBeforeUpdate=="function")||typeof r.UNSAFE_componentWillReceiveProps!="function"&&typeof r.componentWillReceiveProps!="function"||(a!==f||p!==c)&&K_(e,r,i,c),Il=!1,p=e.memoizedState,r.state=p,Em(e,i,r,s),Am();var g=e.memoizedState;a!==f||p!==g||Il||n!==null&&n.dependencies!==null&&xb(n.dependencies)?(typeof o=="function"&&(e2(e,t,o,i),g=e.memoizedState),(d=Il||X_(e,t,d,i,p,g,c)||n!==null&&n.dependencies!==null&&xb(n.dependencies))?(h||typeof r.UNSAFE_componentWillUpdate!="function"&&typeof r.componentWillUpdate!="function"||(typeof r.componentWillUpdate=="function"&&r.componentWillUpdate(i,g,c),typeof r.UNSAFE_componentWillUpdate=="function"&&r.UNSAFE_componentWillUpdate(i,g,c)),typeof r.componentDidUpdate=="function"&&(e.flags|=4),typeof r.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof r.componentDidUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=4),typeof r.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=g),r.props=i,r.state=g,r.context=c,i=d):(typeof r.componentDidUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=4),typeof r.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=1024),i=!1)}return r=i,gv(n,e),i=(e.flags&128)!==0,r||i?(r=e.stateNode,t=i&&typeof t.getDerivedStateFromError!="function"?null:r.render(),e.flags|=1,n!==null&&i?(e.child=Gh(e,n.child,null,s),e.child=Gh(e,null,t,s)):ki(n,e,t,s),e.memoizedState=r.state,n=e.child):n=Sl(n,e,s),n}function sk(n,e,t,i){return qh(),e.flags|=256,ki(n,e,t,i),e.child}var t2={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function n2(n){return{baseLanes:n,cachePool:a3()}}function i2(n,e,t){return n=n!==null?n.childLanes&~t:0,e&&(n|=ir),n}function Q3(n,e,t){var i=e.pendingProps,s=!1,r=(e.flags&128)!==0,a;if((a=r)||(a=n!==null&&n.memoizedState===null?!1:($n.current&2)!==0),a&&(s=!0,e.flags&=-129),a=(e.flags&32)!==0,e.flags&=-33,n===null){if(Rt){if(s?zl(e):Fl(),(n=mn)?(n=$5(n,Ir),n=n!==null&&n.data!=="&"?n:null,n!==null&&(e.memoizedState={dehydrated:n,treeContext:tu!==null?{id:Za,overflow:Qa}:null,retryLane:536870912,hydrationErrors:null},t=n3(n),t.return=e,e.child=t,Li=e,mn=null)):n=null,n===null)throw nu(e);return GS(n)?e.lanes=32:e.lanes=536870912,null}var o=i.children;return i=i.fallback,s?(Fl(),s=e.mode,o=Eb({mode:"hidden",children:o},s),i=zh(i,s,t,null),o.return=e,i.return=e,o.sibling=i,e.child=o,i=e.child,i.memoizedState=n2(t),i.childLanes=i2(n,a,t),e.memoizedState=t2,Gg(null,i)):(zl(e),LS(e,o))}var c=n.memoizedState;if(c!==null&&(o=c.dehydrated,o!==null)){if(r)e.flags&256?(zl(e),e.flags&=-257,e=s2(n,e,t)):e.memoizedState!==null?(Fl(),e.child=n.child,e.flags|=128,e=null):(Fl(),o=i.fallback,s=e.mode,i=Eb({mode:"visible",children:i.children},s),o=zh(o,s,t,null),o.flags|=2,i.return=e,o.return=e,i.sibling=o,e.child=i,Gh(e,n.child,null,t),i=e.child,i.memoizedState=n2(t),i.childLanes=i2(n,a,t),e.memoizedState=t2,e=Gg(null,i));else if(zl(e),GS(o)){if(a=o.nextSibling&&o.nextSibling.dataset,a)var h=a.dgst;a=h,i=Error(Ce(419)),i.stack="",i.digest=a,zm({value:i,source:null,stack:null}),e=s2(n,e,t)}else if(Jn||fg(n,e,t,!1),a=(t&n.childLanes)!==0,Jn||a){if(a=cn,a!==null&&(i=kj(a,t),i!==0&&i!==c.retryLane))throw c.retryLane=i,sd(n,i),Es(a,n,i),DC;VS(o)||kb(),e=s2(n,e,t)}else VS(o)?(e.flags|=192,e.child=n.child,e=null):(n=c.treeContext,mn=Ur(o.nextSibling),Li=e,Rt=!0,Vc=null,Ir=!1,n!==null&&s3(e,n),e=LS(e,i.children),e.flags|=4096);return e}return s?(Fl(),o=i.fallback,s=e.mode,c=n.child,h=c.sibling,i=dl(c,{mode:"hidden",children:i.children}),i.subtreeFlags=c.subtreeFlags&65011712,h!==null?o=dl(h,o):(o=zh(o,s,t,null),o.flags|=2),o.return=e,i.return=e,i.sibling=o,e.child=i,Gg(null,i),i=e.child,o=n.child.memoizedState,o===null?o=n2(t):(s=o.cachePool,s!==null?(c=Qn._currentValue,s=s.parent!==c?{parent:c,pool:c}:s):s=a3(),o={baseLanes:o.baseLanes|t,cachePool:s}),i.memoizedState=o,i.childLanes=i2(n,a,t),e.memoizedState=t2,Gg(n.child,i)):(zl(e),t=n.child,n=t.sibling,t=dl(t,{mode:"visible",children:i.children}),t.return=e,t.sibling=null,n!==null&&(a=e.deletions,a===null?(e.deletions=[n],e.flags|=16):a.push(n)),e.child=t,e.memoizedState=null,t)}function LS(n,e){return e=Eb({mode:"visible",children:e},n.mode),e.return=n,n.child=e}function Eb(n,e){return n=nr(22,n,null,e),n.lanes=0,n}function s2(n,e,t){return Gh(e,n.child,null,t),n=LS(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function rk(n,e,t){n.lanes|=e;var i=n.alternate;i!==null&&(i.lanes|=e),bS(n.return,e,t)}function r2(n,e,t,i,s,r){var a=n.memoizedState;a===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:t,tailMode:s,treeForkCount:r}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=i,a.tail=t,a.tailMode=s,a.treeForkCount=r)}function J3(n,e,t){var i=e.pendingProps,s=i.revealOrder,r=i.tail;i=i.children;var a=$n.current,o=(a&2)!==0;if(o?(a=a&1|2,e.flags|=128):a&=1,fn($n,a),ki(n,e,i,t),i=Rt?Bm:0,!o&&n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&rk(n,t,e);else if(n.tag===19)rk(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(s){case"forwards":for(t=e.child,s=null;t!==null;)n=t.alternate,n!==null&&bb(n)===null&&(s=t),t=t.sibling;t=s,t===null?(s=e.child,e.child=null):(s=t.sibling,t.sibling=null),r2(e,!1,s,t,r,i);break;case"backwards":case"unstable_legacy-backwards":for(t=null,s=e.child,e.child=null;s!==null;){if(n=s.alternate,n!==null&&bb(n)===null){e.child=s;break}n=s.sibling,s.sibling=t,t=s,s=n}r2(e,!0,t,null,r,i);break;case"together":r2(e,!1,null,null,void 0,i);break;default:e.memoizedState=null}return e.child}function Sl(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),su|=e.lanes,!(t&e.childLanes))if(n!==null){if(fg(n,e,t,!1),(t&e.childLanes)===0)return null}else return null;if(n!==null&&e.child!==n.child)throw Error(Ce(153));if(e.child!==null){for(n=e.child,t=dl(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=dl(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function jC(n,e){return n.lanes&e?!0:(n=n.dependencies,!!(n!==null&&xb(n)))}function GB(n,e,t){switch(e.tag){case 3:ub(e,e.stateNode.containerInfo),Bl(e,Qn,n.memoizedState.cache),qh();break;case 27:case 5:oS(e);break;case 4:ub(e,e.stateNode.containerInfo);break;case 10:Bl(e,e.type,e.memoizedProps.value);break;case 31:if(e.memoizedState!==null)return e.flags|=128,NS(e),null;break;case 13:var i=e.memoizedState;if(i!==null)return i.dehydrated!==null?(zl(e),e.flags|=128,null):t&e.child.childLanes?Q3(n,e,t):(zl(e),n=Sl(n,e,t),n!==null?n.sibling:null);zl(e);break;case 19:var s=(n.flags&128)!==0;if(i=(t&e.childLanes)!==0,i||(fg(n,e,t,!1),i=(t&e.childLanes)!==0),s){if(i)return J3(n,e,t);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),fn($n,$n.current),i)break;return null;case 22:return e.lanes=0,Z3(n,e,t,e.pendingProps);case 24:Bl(e,Qn,n.memoizedState.cache)}return Sl(n,e,t)}function e5(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps)Jn=!0;else{if(!jC(n,t)&&!(e.flags&128))return Jn=!1,GB(n,e,t);Jn=!!(n.flags&131072)}else Jn=!1,Rt&&e.flags&1048576&&i3(e,Bm,e.index);switch(e.lanes=0,e.tag){case 16:e:{var i=e.pendingProps;if(n=xu(e.elementType),e.type=n,typeof n=="function")cC(n)?(i=Yh(n,i),e.tag=1,e=ik(null,e,n,i,t)):(e.tag=0,e=RS(null,e,n,i,t));else{if(n!=null){var s=n.$$typeof;if(s===XE){e.tag=11,e=Q_(null,e,n,i,t);break e}else if(s===KE){e.tag=14,e=J_(null,e,n,i,t);break e}}throw e=rS(n)||n,Error(Ce(306,e,""))}}return e;case 0:return RS(n,e,e.type,e.pendingProps,t);case 1:return i=e.type,s=Yh(i,e.pendingProps),ik(n,e,i,s,t);case 3:e:{if(ub(e,e.stateNode.containerInfo),n===null)throw Error(Ce(387));i=e.pendingProps;var r=e.memoizedState;s=r.element,AS(n,e),Em(e,i,null,t);var a=e.memoizedState;if(i=a.cache,Bl(e,Qn,i),i!==r.cache&&wS(e,[Qn],t,!0),Am(),i=a.element,r.isDehydrated)if(r={element:i,isDehydrated:!1,cache:a.cache},e.updateQueue.baseState=r,e.memoizedState=r,e.flags&256){e=sk(n,e,i,t);break e}else if(i!==s){s=Pr(Error(Ce(424)),e),zm(s),e=sk(n,e,i,t);break e}else{switch(n=e.stateNode.containerInfo,n.nodeType){case 9:n=n.body;break;default:n=n.nodeName==="HTML"?n.ownerDocument.body:n}for(mn=Ur(n.firstChild),Li=e,Rt=!0,Vc=null,Ir=!0,t=c3(e,null,i,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling}else{if(qh(),i===s){e=Sl(n,e,t);break e}ki(n,e,i,t)}e=e.child}return e;case 26:return gv(n,e),n===null?(t=Ck(e.type,null,e.pendingProps,null))?e.memoizedState=t:Rt||(t=e.type,n=e.pendingProps,i=Rb(qc.current).createElement(t),i[Ri]=e,i[Ns]=n,Pi(i,t,n),vi(i),e.stateNode=i):e.memoizedState=Ck(e.type,n.memoizedProps,e.pendingProps,n.memoizedState),null;case 27:return oS(e),n===null&&Rt&&(i=e.stateNode=q5(e.type,e.pendingProps,qc.current),Li=e,Ir=!0,s=mn,uu(e.type)?(WS=s,mn=Ur(i.firstChild)):mn=s),ki(n,e,e.pendingProps.children,t),gv(n,e),n===null&&(e.flags|=4194304),e.child;case 5:return n===null&&Rt&&((s=i=mn)&&(i=Sz(i,e.type,e.pendingProps,Ir),i!==null?(e.stateNode=i,Li=e,mn=Ur(i.firstChild),Ir=!1,s=!0):s=!1),s||nu(e)),oS(e),s=e.type,r=e.pendingProps,a=n!==null?n.memoizedProps:null,i=r.children,$S(s,r)?i=null:a!==null&&$S(s,a)&&(e.flags|=32),e.memoizedState!==null&&(s=yC(n,e,IB,null,null,t),Vm._currentValue=s),gv(n,e),ki(n,e,i,t),e.child;case 6:return n===null&&Rt&&((n=t=mn)&&(t=Az(t,e.pendingProps,Ir),t!==null?(e.stateNode=t,Li=e,mn=null,n=!0):n=!1),n||nu(e)),null;case 13:return Q3(n,e,t);case 4:return ub(e,e.stateNode.containerInfo),i=e.pendingProps,n===null?e.child=Gh(e,null,i,t):ki(n,e,i,t),e.child;case 11:return Q_(n,e,e.type,e.pendingProps,t);case 7:return ki(n,e,e.pendingProps,t),e.child;case 8:return ki(n,e,e.pendingProps.children,t),e.child;case 12:return ki(n,e,e.pendingProps.children,t),e.child;case 10:return i=e.pendingProps,Bl(e,e.type,i.value),ki(n,e,i.children,t),e.child;case 9:return s=e.type._context,i=e.pendingProps.children,Vh(e),s=Oi(s),i=i(s),e.flags|=1,ki(n,e,i,t),e.child;case 14:return J_(n,e,e.type,e.pendingProps,t);case 15:return K3(n,e,e.type,e.pendingProps,t);case 19:return J3(n,e,t);case 31:return VB(n,e,t);case 22:return Z3(n,e,t,e.pendingProps);case 24:return Vh(e),i=Oi(Qn),n===null?(s=fC(),s===null&&(s=cn,r=dC(),s.pooledCache=r,r.refCount++,r!==null&&(s.pooledCacheLanes|=t),s=r),e.memoizedState={parent:i,cache:s},gC(e),Bl(e,Qn,s)):(n.lanes&t&&(AS(n,e),Em(e,null,null,t),Am()),s=n.memoizedState,r=e.memoizedState,s.parent!==i?(s={parent:i,cache:i},e.memoizedState=s,e.lanes===0&&(e.memoizedState=e.updateQueue.baseState=s),Bl(e,Qn,i)):(i=r.cache,Bl(e,Qn,i),i!==s.cache&&wS(e,[Qn],t,!0))),ki(n,e,e.pendingProps.children,t),e.child;case 29:throw e.pendingProps}throw Error(Ce(156,e.tag))}function fo(n){n.flags|=4}function a2(n,e,t,i,s){if((e=(n.mode&32)!==0)&&(e=!1),e){if(n.flags|=16777216,(s&335544128)===s)if(n.stateNode.complete)n.flags|=8192;else if(E5())n.flags|=8192;else throw Uh=yb,pC}else n.flags&=-16777217}function ak(n,e){if(e.type!=="stylesheet"||e.state.loading&4)n.flags&=-16777217;else if(n.flags|=16777216,!W5(e))if(E5())n.flags|=8192;else throw Uh=yb,pC}function zy(n,e){e!==null&&(n.flags|=4),n.flags&16384&&(e=n.tag!==22?Cj():536870912,n.lanes|=e,Kp|=e)}function Dg(n,e){if(!Rt)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var i=null;t!==null;)t.alternate!==null&&(i=t),t=t.sibling;i===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:i.sibling=null}}function pn(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,i=0;if(e)for(var s=n.child;s!==null;)t|=s.lanes|s.childLanes,i|=s.subtreeFlags&65011712,i|=s.flags&65011712,s.return=n,s=s.sibling;else for(s=n.child;s!==null;)t|=s.lanes|s.childLanes,i|=s.subtreeFlags,i|=s.flags,s.return=n,s=s.sibling;return n.subtreeFlags|=i,n.childLanes=t,e}function WB(n,e,t){var i=e.pendingProps;switch(hC(e),e.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return pn(e),null;case 1:return pn(e),null;case 3:return t=e.stateNode,i=null,n!==null&&(i=n.memoizedState.cache),e.memoizedState.cache!==i&&(e.flags|=2048),fl(Qn),qp(),t.pendingContext&&(t.context=t.pendingContext,t.pendingContext=null),(n===null||n.child===null)&&(md(e)?fo(e):n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Zw())),pn(e),null;case 26:var s=e.type,r=e.memoizedState;return n===null?(fo(e),r!==null?(pn(e),ak(e,r)):(pn(e),a2(e,s,null,i,t))):r?r!==n.memoizedState?(fo(e),pn(e),ak(e,r)):(pn(e),e.flags&=-16777217):(n=n.memoizedProps,n!==i&&fo(e),pn(e),a2(e,s,n,i,t)),null;case 27:if(hb(e),t=qc.current,s=e.type,n!==null&&e.stateNode!=null)n.memoizedProps!==i&&fo(e);else{if(!i){if(e.stateNode===null)throw Error(Ce(166));return pn(e),null}n=eo.current,md(e)?O_(e):(n=q5(s,i,t),e.stateNode=n,fo(e))}return pn(e),null;case 5:if(hb(e),s=e.type,n!==null&&e.stateNode!=null)n.memoizedProps!==i&&fo(e);else{if(!i){if(e.stateNode===null)throw Error(Ce(166));return pn(e),null}if(r=eo.current,md(e))O_(e);else{var a=Rb(qc.current);switch(r){case 1:r=a.createElementNS("http://www.w3.org/2000/svg",s);break;case 2:r=a.createElementNS("http://www.w3.org/1998/Math/MathML",s);break;default:switch(s){case"svg":r=a.createElementNS("http://www.w3.org/2000/svg",s);break;case"math":r=a.createElementNS("http://www.w3.org/1998/Math/MathML",s);break;case"script":r=a.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild);break;case"select":r=typeof i.is=="string"?a.createElement("select",{is:i.is}):a.createElement("select"),i.multiple?r.multiple=!0:i.size&&(r.size=i.size);break;default:r=typeof i.is=="string"?a.createElement(s,{is:i.is}):a.createElement(s)}}r[Ri]=e,r[Ns]=i;e:for(a=e.child;a!==null;){if(a.tag===5||a.tag===6)r.appendChild(a.stateNode);else if(a.tag!==4&&a.tag!==27&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===e)break e;for(;a.sibling===null;){if(a.return===null||a.return===e)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}e.stateNode=r;e:switch(Pi(r,s,i),s){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&fo(e)}}return pn(e),a2(e,e.type,n===null?null:n.memoizedProps,e.pendingProps,t),null;case 6:if(n&&e.stateNode!=null)n.memoizedProps!==i&&fo(e);else{if(typeof i!="string"&&e.stateNode===null)throw Error(Ce(166));if(n=qc.current,md(e)){if(n=e.stateNode,t=e.memoizedProps,i=null,s=Li,s!==null)switch(s.tag){case 27:case 5:i=s.memoizedProps}n[Ri]=e,n=!!(n.nodeValue===t||i!==null&&i.suppressHydrationWarning===!0||F5(n.nodeValue,t)),n||nu(e,!0)}else n=Rb(n).createTextNode(i),n[Ri]=e,e.stateNode=n}return pn(e),null;case 31:if(t=e.memoizedState,n===null||n.memoizedState!==null){if(i=md(e),t!==null){if(n===null){if(!i)throw Error(Ce(318));if(n=e.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(Ce(557));n[Ri]=e}else qh(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;pn(e),n=!1}else t=Zw(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=t),n=!0;if(!n)return e.flags&256?(er(e),e):(er(e),null);if(e.flags&128)throw Error(Ce(558))}return pn(e),null;case 13:if(i=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(s=md(e),i!==null&&i.dehydrated!==null){if(n===null){if(!s)throw Error(Ce(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Ce(317));s[Ri]=e}else qh(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;pn(e),s=!1}else s=Zw(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=s),s=!0;if(!s)return e.flags&256?(er(e),e):(er(e),null)}return er(e),e.flags&128?(e.lanes=t,e):(t=i!==null,n=n!==null&&n.memoizedState!==null,t&&(i=e.child,s=null,i.alternate!==null&&i.alternate.memoizedState!==null&&i.alternate.memoizedState.cachePool!==null&&(s=i.alternate.memoizedState.cachePool.pool),r=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(r=i.memoizedState.cachePool.pool),r!==s&&(i.flags|=2048)),t!==n&&t&&(e.child.flags|=8192),zy(e,e.updateQueue),pn(e),null);case 4:return qp(),n===null&&BC(e.stateNode.containerInfo),pn(e),null;case 10:return fl(e.type),pn(e),null;case 19:if(bi($n),i=e.memoizedState,i===null)return pn(e),null;if(s=(e.flags&128)!==0,r=i.rendering,r===null)if(s)Dg(i,!1);else{if(Pn!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(r=bb(n),r!==null){for(e.flags|=128,Dg(i,!1),n=r.updateQueue,e.updateQueue=n,zy(e,n),e.subtreeFlags=0,n=t,t=e.child;t!==null;)t3(t,n),t=t.sibling;return fn($n,$n.current&1|2),Rt&&So(e,i.treeForkCount),e.child}n=n.sibling}i.tail!==null&&rr()>Nb&&(e.flags|=128,s=!0,Dg(i,!1),e.lanes=4194304)}else{if(!s)if(n=bb(r),n!==null){if(e.flags|=128,s=!0,n=n.updateQueue,e.updateQueue=n,zy(e,n),Dg(i,!0),i.tail===null&&i.tailMode==="hidden"&&!r.alternate&&!Rt)return pn(e),null}else 2*rr()-i.renderingStartTime>Nb&&t!==536870912&&(e.flags|=128,s=!0,Dg(i,!1),e.lanes=4194304);i.isBackwards?(r.sibling=e.child,e.child=r):(n=i.last,n!==null?n.sibling=r:e.child=r,i.last=r)}return i.tail!==null?(n=i.tail,i.rendering=n,i.tail=n.sibling,i.renderingStartTime=rr(),n.sibling=null,t=$n.current,fn($n,s?t&1|2:t&1),Rt&&So(e,i.treeForkCount),n):(pn(e),null);case 22:case 23:return er(e),mC(),i=e.memoizedState!==null,n!==null?n.memoizedState!==null!==i&&(e.flags|=8192):i&&(e.flags|=8192),i?t&536870912&&!(e.flags&128)&&(pn(e),e.subtreeFlags&6&&(e.flags|=8192)):pn(e),t=e.updateQueue,t!==null&&zy(e,t.retryQueue),t=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(t=n.memoizedState.cachePool.pool),i=null,e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(i=e.memoizedState.cachePool.pool),i!==t&&(e.flags|=2048),n!==null&&bi(Fh),null;case 24:return t=null,n!==null&&(t=n.memoizedState.cache),e.memoizedState.cache!==t&&(e.flags|=2048),fl(Qn),pn(e),null;case 25:return null;case 30:return null}throw Error(Ce(156,e.tag))}function YB(n,e){switch(hC(e),e.tag){case 1:return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return fl(Qn),qp(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 26:case 27:case 5:return hb(e),null;case 31:if(e.memoizedState!==null){if(er(e),e.alternate===null)throw Error(Ce(340));qh()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 13:if(er(e),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(Ce(340));qh()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return bi($n),null;case 4:return qp(),null;case 10:return fl(e.type),null;case 22:case 23:return er(e),mC(),n!==null&&bi(Fh),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 24:return fl(Qn),null;case 25:return null;default:return null}}function t5(n,e){switch(hC(e),e.tag){case 3:fl(Qn),qp();break;case 26:case 27:case 5:hb(e);break;case 4:qp();break;case 31:e.memoizedState!==null&&er(e);break;case 13:er(e);break;case 19:bi($n);break;case 10:fl(e.type);break;case 22:case 23:er(e),mC(),n!==null&&bi(Fh);break;case 24:fl(Qn)}}function ly(n,e){try{var t=e.updateQueue,i=t!==null?t.lastEffect:null;if(i!==null){var s=i.next;t=s;do{if((t.tag&n)===n){i=void 0;var r=t.create,a=t.inst;i=r(),a.destroy=i}t=t.next}while(t!==s)}}catch(o){Yt(e,e.return,o)}}function iu(n,e,t){try{var i=e.updateQueue,s=i!==null?i.lastEffect:null;if(s!==null){var r=s.next;i=r;do{if((i.tag&n)===n){var a=i.inst,o=a.destroy;if(o!==void 0){a.destroy=void 0,s=e;var c=t,h=o;try{h()}catch(d){Yt(s,c,d)}}}i=i.next}while(i!==r)}}catch(d){Yt(e,e.return,d)}}function n5(n){var e=n.updateQueue;if(e!==null){var t=n.stateNode;try{h3(e,t)}catch(i){Yt(n,n.return,i)}}}function i5(n,e,t){t.props=Yh(n.type,n.memoizedProps),t.state=n.memoizedState;try{t.componentWillUnmount()}catch(i){Yt(n,e,i)}}function Nm(n,e){try{var t=n.ref;if(t!==null){switch(n.tag){case 26:case 27:case 5:var i=n.stateNode;break;case 30:i=n.stateNode;break;default:i=n.stateNode}typeof t=="function"?n.refCleanup=t(i):t.current=i}}catch(s){Yt(n,e,s)}}function Ja(n,e){var t=n.ref,i=n.refCleanup;if(t!==null)if(typeof i=="function")try{i()}catch(s){Yt(n,e,s)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof t=="function")try{t(null)}catch(s){Yt(n,e,s)}else t.current=null}function s5(n){var e=n.type,t=n.memoizedProps,i=n.stateNode;try{e:switch(e){case"button":case"input":case"select":case"textarea":t.autoFocus&&i.focus();break e;case"img":t.src?i.src=t.src:t.srcSet&&(i.srcset=t.srcSet)}}catch(s){Yt(n,n.return,s)}}function o2(n,e,t){try{var i=n.stateNode;mz(i,n.type,t,e),i[Ns]=e}catch(s){Yt(n,n.return,s)}}function r5(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&uu(n.type)||n.tag===4}function l2(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||r5(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&uu(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function MS(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t).insertBefore(n,e):(e=t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,e.appendChild(n),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=ll));else if(i!==4&&(i===27&&uu(n.type)&&(t=n.stateNode,e=null),n=n.child,n!==null))for(MS(n,e,t),n=n.sibling;n!==null;)MS(n,e,t),n=n.sibling}function Cb(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(i!==4&&(i===27&&uu(n.type)&&(t=n.stateNode),n=n.child,n!==null))for(Cb(n,e,t),n=n.sibling;n!==null;)Cb(n,e,t),n=n.sibling}function a5(n){var e=n.stateNode,t=n.memoizedProps;try{for(var i=n.type,s=e.attributes;s.length;)e.removeAttributeNode(s[0]);Pi(e,i,t),e[Ri]=n,e[Ns]=t}catch(r){Yt(n,n.return,r)}}var rl=!1,Zn=!1,c2=!1,ok=typeof WeakSet=="function"?WeakSet:Set,yi=null;function XB(n,e){if(n=n.containerInfo,US=Pb,n=Wj(n),aC(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var i=t.getSelection&&t.getSelection();if(i&&i.rangeCount!==0){t=i.anchorNode;var s=i.anchorOffset,r=i.focusNode;i=i.focusOffset;try{t.nodeType,r.nodeType}catch{t=null;break e}var a=0,o=-1,c=-1,h=0,d=0,f=n,p=null;t:for(;;){for(var g;f!==t||s!==0&&f.nodeType!==3||(o=a+s),f!==r||i!==0&&f.nodeType!==3||(c=a+i),f.nodeType===3&&(a+=f.nodeValue.length),(g=f.firstChild)!==null;)p=f,f=g;for(;;){if(f===n)break t;if(p===t&&++h===s&&(o=a),p===r&&++d===i&&(c=a),(g=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=g}t=o===-1||c===-1?null:{start:o,end:c}}else t=null}t=t||{start:0,end:0}}else t=null;for(HS={focusedElem:n,selectionRange:t},Pb=!1,yi=e;yi!==null;)if(e=yi,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,yi=n;else for(;yi!==null;){switch(e=yi,r=e.alternate,n=e.flags,e.tag){case 0:if(n&4&&(n=e.updateQueue,n=n!==null?n.events:null,n!==null))for(t=0;t<n.length;t++)s=n[t],s.ref.impl=s.nextImpl;break;case 11:case 15:break;case 1:if(n&1024&&r!==null){n=void 0,t=e,s=r.memoizedProps,r=r.memoizedState,i=t.stateNode;try{var v=Yh(t.type,s);n=i.getSnapshotBeforeUpdate(v,r),i.__reactInternalSnapshotBeforeUpdate=n}catch(b){Yt(t,t.return,b)}}break;case 3:if(n&1024){if(n=e.stateNode.containerInfo,t=n.nodeType,t===9)qS(n);else if(t===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":qS(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(n&1024)throw Error(Ce(163))}if(n=e.sibling,n!==null){n.return=e.return,yi=n;break}yi=e.return}}function o5(n,e,t){var i=t.flags;switch(t.tag){case 0:case 11:case 15:go(n,t),i&4&&ly(5,t);break;case 1:if(go(n,t),i&4)if(n=t.stateNode,e===null)try{n.componentDidMount()}catch(a){Yt(t,t.return,a)}else{var s=Yh(t.type,e.memoizedProps);e=e.memoizedState;try{n.componentDidUpdate(s,e,n.__reactInternalSnapshotBeforeUpdate)}catch(a){Yt(t,t.return,a)}}i&64&&n5(t),i&512&&Nm(t,t.return);break;case 3:if(go(n,t),i&64&&(n=t.updateQueue,n!==null)){if(e=null,t.child!==null)switch(t.child.tag){case 27:case 5:e=t.child.stateNode;break;case 1:e=t.child.stateNode}try{h3(n,e)}catch(a){Yt(t,t.return,a)}}break;case 27:e===null&&i&4&&a5(t);case 26:case 5:go(n,t),e===null&&i&4&&s5(t),i&512&&Nm(t,t.return);break;case 12:go(n,t);break;case 31:go(n,t),i&4&&u5(n,t);break;case 13:go(n,t),i&4&&h5(n,t),i&64&&(n=t.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(t=sz.bind(null,t),Ez(n,t))));break;case 22:if(i=t.memoizedState!==null||rl,!i){e=e!==null&&e.memoizedState!==null||Zn,s=rl;var r=Zn;rl=i,(Zn=e)&&!r?mo(n,t,(t.subtreeFlags&8772)!==0):go(n,t),rl=s,Zn=r}break;case 30:break;default:go(n,t)}}function l5(n){var e=n.alternate;e!==null&&(n.alternate=null,l5(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&eC(e)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var An=null,bs=!1;function po(n,e,t){for(t=t.child;t!==null;)c5(n,e,t),t=t.sibling}function c5(n,e,t){if(ar&&typeof ar.onCommitFiberUnmount=="function")try{ar.onCommitFiberUnmount(ty,t)}catch{}switch(t.tag){case 26:Zn||Ja(t,e),po(n,e,t),t.memoizedState?t.memoizedState.count--:t.stateNode&&(t=t.stateNode,t.parentNode.removeChild(t));break;case 27:Zn||Ja(t,e);var i=An,s=bs;uu(t.type)&&(An=t.stateNode,bs=!1),po(n,e,t),Dm(t.stateNode),An=i,bs=s;break;case 5:Zn||Ja(t,e);case 6:if(i=An,s=bs,An=null,po(n,e,t),An=i,bs=s,An!==null)if(bs)try{(An.nodeType===9?An.body:An.nodeName==="HTML"?An.ownerDocument.body:An).removeChild(t.stateNode)}catch(r){Yt(t,e,r)}else try{An.removeChild(t.stateNode)}catch(r){Yt(t,e,r)}break;case 18:An!==null&&(bs?(n=An,bk(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,t.stateNode),eg(n)):bk(An,t.stateNode));break;case 4:i=An,s=bs,An=t.stateNode.containerInfo,bs=!0,po(n,e,t),An=i,bs=s;break;case 0:case 11:case 14:case 15:iu(2,t,e),Zn||iu(4,t,e),po(n,e,t);break;case 1:Zn||(Ja(t,e),i=t.stateNode,typeof i.componentWillUnmount=="function"&&i5(t,e,i)),po(n,e,t);break;case 21:po(n,e,t);break;case 22:Zn=(i=Zn)||t.memoizedState!==null,po(n,e,t),Zn=i;break;default:po(n,e,t)}}function u5(n,e){if(e.memoizedState===null&&(n=e.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{eg(n)}catch(t){Yt(e,e.return,t)}}}function h5(n,e){if(e.memoizedState===null&&(n=e.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{eg(n)}catch(t){Yt(e,e.return,t)}}function KB(n){switch(n.tag){case 31:case 13:case 19:var e=n.stateNode;return e===null&&(e=n.stateNode=new ok),e;case 22:return n=n.stateNode,e=n._retryCache,e===null&&(e=n._retryCache=new ok),e;default:throw Error(Ce(435,n.tag))}}function Fy(n,e){var t=KB(n);e.forEach(function(i){if(!t.has(i)){t.add(i);var s=rz.bind(null,n,i);i.then(s,s)}})}function ls(n,e){var t=e.deletions;if(t!==null)for(var i=0;i<t.length;i++){var s=t[i],r=n,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 27:if(uu(o.type)){An=o.stateNode,bs=!1;break e}break;case 5:An=o.stateNode,bs=!1;break e;case 3:case 4:An=o.stateNode.containerInfo,bs=!0;break e}o=o.return}if(An===null)throw Error(Ce(160));c5(r,a,s),An=null,bs=!1,r=s.alternate,r!==null&&(r.return=null),s.return=null}if(e.subtreeFlags&13886)for(e=e.child;e!==null;)d5(e,n),e=e.sibling}var ha=null;function d5(n,e){var t=n.alternate,i=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:ls(e,n),cs(n),i&4&&(iu(3,n,n.return),ly(3,n),iu(5,n,n.return));break;case 1:ls(e,n),cs(n),i&512&&(Zn||t===null||Ja(t,t.return)),i&64&&rl&&(n=n.updateQueue,n!==null&&(i=n.callbacks,i!==null&&(t=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=t===null?i:t.concat(i))));break;case 26:var s=ha;if(ls(e,n),cs(n),i&512&&(Zn||t===null||Ja(t,t.return)),i&4){var r=t!==null?t.memoizedState:null;if(i=n.memoizedState,t===null)if(i===null)if(n.stateNode===null){e:{i=n.type,t=n.memoizedProps,s=s.ownerDocument||s;t:switch(i){case"title":r=s.getElementsByTagName("title")[0],(!r||r[sy]||r[Ri]||r.namespaceURI==="http://www.w3.org/2000/svg"||r.hasAttribute("itemprop"))&&(r=s.createElement(i),s.head.insertBefore(r,s.querySelector("head > title"))),Pi(r,i,t),r[Ri]=n,vi(r),i=r;break e;case"link":var a=_k("link","href",s).get(i+(t.href||""));if(a){for(var o=0;o<a.length;o++)if(r=a[o],r.getAttribute("href")===(t.href==null||t.href===""?null:t.href)&&r.getAttribute("rel")===(t.rel==null?null:t.rel)&&r.getAttribute("title")===(t.title==null?null:t.title)&&r.getAttribute("crossorigin")===(t.crossOrigin==null?null:t.crossOrigin)){a.splice(o,1);break t}}r=s.createElement(i),Pi(r,i,t),s.head.appendChild(r);break;case"meta":if(a=_k("meta","content",s).get(i+(t.content||""))){for(o=0;o<a.length;o++)if(r=a[o],r.getAttribute("content")===(t.content==null?null:""+t.content)&&r.getAttribute("name")===(t.name==null?null:t.name)&&r.getAttribute("property")===(t.property==null?null:t.property)&&r.getAttribute("http-equiv")===(t.httpEquiv==null?null:t.httpEquiv)&&r.getAttribute("charset")===(t.charSet==null?null:t.charSet)){a.splice(o,1);break t}}r=s.createElement(i),Pi(r,i,t),s.head.appendChild(r);break;default:throw Error(Ce(468,i))}r[Ri]=n,vi(r),i=r}n.stateNode=i}else kk(s,n.type,n.stateNode);else n.stateNode=Nk(s,i,n.memoizedProps);else r!==i?(r===null?t.stateNode!==null&&(t=t.stateNode,t.parentNode.removeChild(t)):r.count--,i===null?kk(s,n.type,n.stateNode):Nk(s,i,n.memoizedProps)):i===null&&n.stateNode!==null&&o2(n,n.memoizedProps,t.memoizedProps)}break;case 27:ls(e,n),cs(n),i&512&&(Zn||t===null||Ja(t,t.return)),t!==null&&i&4&&o2(n,n.memoizedProps,t.memoizedProps);break;case 5:if(ls(e,n),cs(n),i&512&&(Zn||t===null||Ja(t,t.return)),n.flags&32){s=n.stateNode;try{Gp(s,"")}catch(v){Yt(n,n.return,v)}}i&4&&n.stateNode!=null&&(s=n.memoizedProps,o2(n,s,t!==null?t.memoizedProps:s)),i&1024&&(c2=!0);break;case 6:if(ls(e,n),cs(n),i&4){if(n.stateNode===null)throw Error(Ce(162));i=n.memoizedProps,t=n.stateNode;try{t.nodeValue=i}catch(v){Yt(n,n.return,v)}}break;case 3:if(yv=null,s=ha,ha=Lb(e.containerInfo),ls(e,n),ha=s,cs(n),i&4&&t!==null&&t.memoizedState.isDehydrated)try{eg(e.containerInfo)}catch(v){Yt(n,n.return,v)}c2&&(c2=!1,f5(n));break;case 4:i=ha,ha=Lb(n.stateNode.containerInfo),ls(e,n),cs(n),ha=i;break;case 12:ls(e,n),cs(n);break;case 31:ls(e,n),cs(n),i&4&&(i=n.updateQueue,i!==null&&(n.updateQueue=null,Fy(n,i)));break;case 13:ls(e,n),cs(n),n.child.flags&8192&&n.memoizedState!==null!=(t!==null&&t.memoizedState!==null)&&(G1=rr()),i&4&&(i=n.updateQueue,i!==null&&(n.updateQueue=null,Fy(n,i)));break;case 22:s=n.memoizedState!==null;var c=t!==null&&t.memoizedState!==null,h=rl,d=Zn;if(rl=h||s,Zn=d||c,ls(e,n),Zn=d,rl=h,cs(n),i&8192)e:for(e=n.stateNode,e._visibility=s?e._visibility&-2:e._visibility|1,s&&(t===null||c||rl||Zn||yu(n)),t=null,e=n;;){if(e.tag===5||e.tag===26){if(t===null){c=t=e;try{if(r=c.stateNode,s)a=r.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none";else{o=c.stateNode;var f=c.memoizedProps.style,p=f!=null&&f.hasOwnProperty("display")?f.display:null;o.style.display=p==null||typeof p=="boolean"?"":(""+p).trim()}}catch(v){Yt(c,c.return,v)}}}else if(e.tag===6){if(t===null){c=e;try{c.stateNode.nodeValue=s?"":c.memoizedProps}catch(v){Yt(c,c.return,v)}}}else if(e.tag===18){if(t===null){c=e;try{var g=c.stateNode;s?wk(g,!0):wk(c.stateNode,!1)}catch(v){Yt(c,c.return,v)}}}else if((e.tag!==22&&e.tag!==23||e.memoizedState===null||e===n)&&e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break e;for(;e.sibling===null;){if(e.return===null||e.return===n)break e;t===e&&(t=null),e=e.return}t===e&&(t=null),e.sibling.return=e.return,e=e.sibling}i&4&&(i=n.updateQueue,i!==null&&(t=i.retryQueue,t!==null&&(i.retryQueue=null,Fy(n,t))));break;case 19:ls(e,n),cs(n),i&4&&(i=n.updateQueue,i!==null&&(n.updateQueue=null,Fy(n,i)));break;case 30:break;case 21:break;default:ls(e,n),cs(n)}}function cs(n){var e=n.flags;if(e&2){try{for(var t,i=n.return;i!==null;){if(r5(i)){t=i;break}i=i.return}if(t==null)throw Error(Ce(160));switch(t.tag){case 27:var s=t.stateNode,r=l2(n);Cb(n,r,s);break;case 5:var a=t.stateNode;t.flags&32&&(Gp(a,""),t.flags&=-33);var o=l2(n);Cb(n,o,a);break;case 3:case 4:var c=t.stateNode.containerInfo,h=l2(n);MS(n,h,c);break;default:throw Error(Ce(161))}}catch(d){Yt(n,n.return,d)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function f5(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var e=n;f5(e),e.tag===5&&e.flags&1024&&e.stateNode.reset(),n=n.sibling}}function go(n,e){if(e.subtreeFlags&8772)for(e=e.child;e!==null;)o5(n,e.alternate,e),e=e.sibling}function yu(n){for(n=n.child;n!==null;){var e=n;switch(e.tag){case 0:case 11:case 14:case 15:iu(4,e,e.return),yu(e);break;case 1:Ja(e,e.return);var t=e.stateNode;typeof t.componentWillUnmount=="function"&&i5(e,e.return,t),yu(e);break;case 27:Dm(e.stateNode);case 26:case 5:Ja(e,e.return),yu(e);break;case 22:e.memoizedState===null&&yu(e);break;case 30:yu(e);break;default:yu(e)}n=n.sibling}}function mo(n,e,t){for(t=t&&(e.subtreeFlags&8772)!==0,e=e.child;e!==null;){var i=e.alternate,s=n,r=e,a=r.flags;switch(r.tag){case 0:case 11:case 15:mo(s,r,t),ly(4,r);break;case 1:if(mo(s,r,t),i=r,s=i.stateNode,typeof s.componentDidMount=="function")try{s.componentDidMount()}catch(h){Yt(i,i.return,h)}if(i=r,s=i.updateQueue,s!==null){var o=i.stateNode;try{var c=s.shared.hiddenCallbacks;if(c!==null)for(s.shared.hiddenCallbacks=null,s=0;s<c.length;s++)u3(c[s],o)}catch(h){Yt(i,i.return,h)}}t&&a&64&&n5(r),Nm(r,r.return);break;case 27:a5(r);case 26:case 5:mo(s,r,t),t&&i===null&&a&4&&s5(r),Nm(r,r.return);break;case 12:mo(s,r,t);break;case 31:mo(s,r,t),t&&a&4&&u5(s,r);break;case 13:mo(s,r,t),t&&a&4&&h5(s,r);break;case 22:r.memoizedState===null&&mo(s,r,t),Nm(r,r.return);break;case 30:break;default:mo(s,r,t)}e=e.sibling}}function RC(n,e){var t=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(t=n.memoizedState.cachePool.pool),n=null,e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),n!==t&&(n!=null&&n.refCount++,t!=null&&ay(t))}function LC(n,e){n=null,e.alternate!==null&&(n=e.alternate.memoizedState.cache),e=e.memoizedState.cache,e!==n&&(e.refCount++,n!=null&&ay(n))}function Yr(n,e,t,i){if(e.subtreeFlags&10256)for(e=e.child;e!==null;)p5(n,e,t,i),e=e.sibling}function p5(n,e,t,i){var s=e.flags;switch(e.tag){case 0:case 11:case 15:Yr(n,e,t,i),s&2048&&ly(9,e);break;case 1:Yr(n,e,t,i);break;case 3:Yr(n,e,t,i),s&2048&&(n=null,e.alternate!==null&&(n=e.alternate.memoizedState.cache),e=e.memoizedState.cache,e!==n&&(e.refCount++,n!=null&&ay(n)));break;case 12:if(s&2048){Yr(n,e,t,i),n=e.stateNode;try{var r=e.memoizedProps,a=r.id,o=r.onPostCommit;typeof o=="function"&&o(a,e.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(c){Yt(e,e.return,c)}}else Yr(n,e,t,i);break;case 31:Yr(n,e,t,i);break;case 13:Yr(n,e,t,i);break;case 23:break;case 22:r=e.stateNode,a=e.alternate,e.memoizedState!==null?r._visibility&2?Yr(n,e,t,i):_m(n,e):r._visibility&2?Yr(n,e,t,i):(r._visibility|=2,_d(n,e,t,i,(e.subtreeFlags&10256)!==0||!1)),s&2048&&RC(a,e);break;case 24:Yr(n,e,t,i),s&2048&&LC(e.alternate,e);break;default:Yr(n,e,t,i)}}function _d(n,e,t,i,s){for(s=s&&((e.subtreeFlags&10256)!==0||!1),e=e.child;e!==null;){var r=n,a=e,o=t,c=i,h=a.flags;switch(a.tag){case 0:case 11:case 15:_d(r,a,o,c,s),ly(8,a);break;case 23:break;case 22:var d=a.stateNode;a.memoizedState!==null?d._visibility&2?_d(r,a,o,c,s):_m(r,a):(d._visibility|=2,_d(r,a,o,c,s)),s&&h&2048&&RC(a.alternate,a);break;case 24:_d(r,a,o,c,s),s&&h&2048&&LC(a.alternate,a);break;default:_d(r,a,o,c,s)}e=e.sibling}}function _m(n,e){if(e.subtreeFlags&10256)for(e=e.child;e!==null;){var t=n,i=e,s=i.flags;switch(i.tag){case 22:_m(t,i),s&2048&&RC(i.alternate,i);break;case 24:_m(t,i),s&2048&&LC(i.alternate,i);break;default:_m(t,i)}e=e.sibling}}var Wg=8192;function xd(n,e,t){if(n.subtreeFlags&Wg)for(n=n.child;n!==null;)g5(n,e,t),n=n.sibling}function g5(n,e,t){switch(n.tag){case 26:xd(n,e,t),n.flags&Wg&&n.memoizedState!==null&&Pz(t,ha,n.memoizedState,n.memoizedProps);break;case 5:xd(n,e,t);break;case 3:case 4:var i=ha;ha=Lb(n.stateNode.containerInfo),xd(n,e,t),ha=i;break;case 22:n.memoizedState===null&&(i=n.alternate,i!==null&&i.memoizedState!==null?(i=Wg,Wg=16777216,xd(n,e,t),Wg=i):xd(n,e,t));break;default:xd(n,e,t)}}function m5(n){var e=n.alternate;if(e!==null&&(n=e.child,n!==null)){e.child=null;do e=n.sibling,n.sibling=null,n=e;while(n!==null)}}function jg(n){var e=n.deletions;if(n.flags&16){if(e!==null)for(var t=0;t<e.length;t++){var i=e[t];yi=i,y5(i,n)}m5(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)x5(n),n=n.sibling}function x5(n){switch(n.tag){case 0:case 11:case 15:jg(n),n.flags&2048&&iu(9,n,n.return);break;case 3:jg(n);break;case 12:jg(n);break;case 22:var e=n.stateNode;n.memoizedState!==null&&e._visibility&2&&(n.return===null||n.return.tag!==13)?(e._visibility&=-3,mv(n)):jg(n);break;default:jg(n)}}function mv(n){var e=n.deletions;if(n.flags&16){if(e!==null)for(var t=0;t<e.length;t++){var i=e[t];yi=i,y5(i,n)}m5(n)}for(n=n.child;n!==null;){switch(e=n,e.tag){case 0:case 11:case 15:iu(8,e,e.return),mv(e);break;case 22:t=e.stateNode,t._visibility&2&&(t._visibility&=-3,mv(e));break;default:mv(e)}n=n.sibling}}function y5(n,e){for(;yi!==null;){var t=yi;switch(t.tag){case 0:case 11:case 15:iu(8,t,e);break;case 23:case 22:if(t.memoizedState!==null&&t.memoizedState.cachePool!==null){var i=t.memoizedState.cachePool.pool;i!=null&&i.refCount++}break;case 24:ay(t.memoizedState.cache)}if(i=t.child,i!==null)i.return=t,yi=i;else e:for(t=n;yi!==null;){i=yi;var s=i.sibling,r=i.return;if(l5(i),i===t){yi=null;break e}if(s!==null){s.return=r,yi=s;break e}yi=r}}}var ZB={getCacheForType:function(n){var e=Oi(Qn),t=e.data.get(n);return t===void 0&&(t=n(),e.data.set(n,t)),t},cacheSignal:function(){return Oi(Qn).controller.signal}},QB=typeof WeakMap=="function"?WeakMap:Map,Bt=0,cn=null,Ct=null,_t=0,Wt=0,Qs=null,zc=!1,gg=!1,MC=!1,Al=0,Pn=0,su=0,Hh=0,OC=0,ir=0,Kp=0,km=null,ws=null,OS=!1,G1=0,v5=0,Nb=1/0,_b=null,Yc=null,ai=0,Xc=null,Zp=null,pl=0,PS=0,IS=null,b5=null,Tm=0,BS=null;function lr(){return Bt&2&&_t!==0?_t&-_t:ot.T!==null?IC():Tj()}function w5(){if(ir===0)if(!(_t&536870912)||Rt){var n=Ry;Ry<<=1,!(Ry&3932160)&&(Ry=262144),ir=n}else ir=536870912;return n=hr.current,n!==null&&(n.flags|=32),ir}function Es(n,e,t){(n===cn&&(Wt===2||Wt===9)||n.cancelPendingCommit!==null)&&(Qp(n,0),Fc(n,_t,ir,!1)),iy(n,t),(!(Bt&2)||n!==cn)&&(n===cn&&(!(Bt&2)&&(Hh|=t),Pn===4&&Fc(n,_t,ir,!1)),co(n))}function S5(n,e,t){if(Bt&6)throw Error(Ce(327));var i=!t&&(e&127)===0&&(e&n.expiredLanes)===0||ny(n,e),s=i?tz(n,e):u2(n,e,!0),r=i;do{if(s===0){gg&&!i&&Fc(n,e,0,!1);break}else{if(t=n.current.alternate,r&&!JB(t)){s=u2(n,e,!1),r=!1;continue}if(s===2){if(r=e,n.errorRecoveryDisabledLanes&r)var a=0;else a=n.pendingLanes&-536870913,a=a!==0?a:a&536870912?536870912:0;if(a!==0){e=a;e:{var o=n;s=km;var c=o.current.memoizedState.isDehydrated;if(c&&(Qp(o,a).flags|=256),a=u2(o,a,!1),a!==2){if(MC&&!c){o.errorRecoveryDisabledLanes|=r,Hh|=r,s=4;break e}r=ws,ws=s,r!==null&&(ws===null?ws=r:ws.push.apply(ws,r))}s=a}if(r=!1,s!==2)continue}}if(s===1){Qp(n,0),Fc(n,e,0,!0);break}e:{switch(i=n,r=s,r){case 0:case 1:throw Error(Ce(345));case 4:if((e&4194048)!==e)break;case 6:Fc(i,e,ir,!zc);break e;case 2:ws=null;break;case 3:case 5:break;default:throw Error(Ce(329))}if((e&62914560)===e&&(s=G1+300-rr(),10<s)){if(Fc(i,e,ir,!zc),O1(i,0,!0)!==0)break e;pl=e,i.timeoutHandle=H5(lk.bind(null,i,t,ws,_b,OS,e,ir,Hh,Kp,zc,r,"Throttled",-0,0),s);break e}lk(i,t,ws,_b,OS,e,ir,Hh,Kp,zc,r,null,-0,0)}}break}while(!0);co(n)}function lk(n,e,t,i,s,r,a,o,c,h,d,f,p,g){if(n.timeoutHandle=-1,f=e.subtreeFlags,f&8192||(f&16785408)===16785408){f={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ll},g5(e,r,f);var v=(r&62914560)===r?G1-rr():(r&4194048)===r?v5-rr():0;if(v=Iz(f,v),v!==null){pl=r,n.cancelPendingCommit=v(uk.bind(null,n,e,r,t,i,s,a,o,c,d,f,null,p,g)),Fc(n,r,a,!h);return}}uk(n,e,r,t,i,s,a,o,c)}function JB(n){for(var e=n;;){var t=e.tag;if((t===0||t===11||t===15)&&e.flags&16384&&(t=e.updateQueue,t!==null&&(t=t.stores,t!==null)))for(var i=0;i<t.length;i++){var s=t[i],r=s.getSnapshot;s=s.value;try{if(!ur(r(),s))return!1}catch{return!1}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Fc(n,e,t,i){e&=~OC,e&=~Hh,n.suspendedLanes|=e,n.pingedLanes&=~e,i&&(n.warmLanes|=e),i=n.expirationTimes;for(var s=e;0<s;){var r=31-or(s),a=1<<r;i[r]=-1,s&=~a}t!==0&&Nj(n,t,e)}function W1(){return Bt&6?!0:(cy(0),!1)}function PC(){if(Ct!==null){if(Wt===0)var n=Ct.return;else n=Ct,cl=rd=null,wC(n),df=null,Fm=0,n=Ct;for(;n!==null;)t5(n.alternate,n),n=n.return;Ct=null}}function Qp(n,e){var t=n.timeoutHandle;t!==-1&&(n.timeoutHandle=-1,vz(t)),t=n.cancelPendingCommit,t!==null&&(n.cancelPendingCommit=null,t()),pl=0,PC(),cn=n,Ct=t=dl(n.current,null),_t=e,Wt=0,Qs=null,zc=!1,gg=ny(n,e),MC=!1,Kp=ir=OC=Hh=su=Pn=0,ws=km=null,OS=!1,e&8&&(e|=e&32);var i=n.entangledLanes;if(i!==0)for(n=n.entanglements,i&=e;0<i;){var s=31-or(i),r=1<<s;e|=n[s],i&=~r}return Al=e,z1(),t}function A5(n,e){yt=null,ot.H=Hm,e===pg||e===U1?(e=F_(),Wt=3):e===pC?(e=F_(),Wt=4):Wt=e===DC?8:e!==null&&typeof e=="object"&&typeof e.then=="function"?6:1,Qs=e,Ct===null&&(Pn=1,Ab(n,Pr(e,n.current)))}function E5(){var n=hr.current;return n===null?!0:(_t&4194048)===_t?Fr===null:(_t&62914560)===_t||_t&536870912?n===Fr:!1}function C5(){var n=ot.H;return ot.H=Hm,n===null?Hm:n}function N5(){var n=ot.A;return ot.A=ZB,n}function kb(){Pn=4,zc||(_t&4194048)!==_t&&hr.current!==null||(gg=!0),!(su&134217727)&&!(Hh&134217727)||cn===null||Fc(cn,_t,ir,!1)}function u2(n,e,t){var i=Bt;Bt|=2;var s=C5(),r=N5();(cn!==n||_t!==e)&&(_b=null,Qp(n,e)),e=!1;var a=Pn;e:do try{if(Wt!==0&&Ct!==null){var o=Ct,c=Qs;switch(Wt){case 8:PC(),a=6;break e;case 3:case 2:case 9:case 6:hr.current===null&&(e=!0);var h=Wt;if(Wt=0,Qs=null,Jd(n,o,c,h),t&&gg){a=0;break e}break;default:h=Wt,Wt=0,Qs=null,Jd(n,o,c,h)}}ez(),a=Pn;break}catch(d){A5(n,d)}while(!0);return e&&n.shellSuspendCounter++,cl=rd=null,Bt=i,ot.H=s,ot.A=r,Ct===null&&(cn=null,_t=0,z1()),a}function ez(){for(;Ct!==null;)_5(Ct)}function tz(n,e){var t=Bt;Bt|=2;var i=C5(),s=N5();cn!==n||_t!==e?(_b=null,Nb=rr()+500,Qp(n,e)):gg=ny(n,e);e:do try{if(Wt!==0&&Ct!==null){e=Ct;var r=Qs;t:switch(Wt){case 1:Wt=0,Qs=null,Jd(n,e,r,1);break;case 2:case 9:if(z_(r)){Wt=0,Qs=null,ck(e);break}e=function(){Wt!==2&&Wt!==9||cn!==n||(Wt=7),co(n)},r.then(e,e);break e;case 3:Wt=7;break e;case 4:Wt=5;break e;case 7:z_(r)?(Wt=0,Qs=null,ck(e)):(Wt=0,Qs=null,Jd(n,e,r,7));break;case 5:var a=null;switch(Ct.tag){case 26:a=Ct.memoizedState;case 5:case 27:var o=Ct;if(a?W5(a):o.stateNode.complete){Wt=0,Qs=null;var c=o.sibling;if(c!==null)Ct=c;else{var h=o.return;h!==null?(Ct=h,Y1(h)):Ct=null}break t}}Wt=0,Qs=null,Jd(n,e,r,5);break;case 6:Wt=0,Qs=null,Jd(n,e,r,6);break;case 8:PC(),Pn=6;break e;default:throw Error(Ce(462))}}nz();break}catch(d){A5(n,d)}while(!0);return cl=rd=null,ot.H=i,ot.A=s,Bt=t,Ct!==null?0:(cn=null,_t=0,z1(),Pn)}function nz(){for(;Ct!==null&&!CI();)_5(Ct)}function _5(n){var e=e5(n.alternate,n,Al);n.memoizedProps=n.pendingProps,e===null?Y1(n):Ct=e}function ck(n){var e=n,t=e.alternate;switch(e.tag){case 15:case 0:e=nk(t,e,e.pendingProps,e.type,void 0,_t);break;case 11:e=nk(t,e,e.pendingProps,e.type.render,e.ref,_t);break;case 5:wC(e);default:t5(t,e),e=Ct=t3(e,Al),e=e5(t,e,Al)}n.memoizedProps=n.pendingProps,e===null?Y1(n):Ct=e}function Jd(n,e,t,i){cl=rd=null,wC(e),df=null,Fm=0;var s=e.return;try{if(qB(n,s,e,t,_t)){Pn=1,Ab(n,Pr(t,n.current)),Ct=null;return}}catch(r){if(s!==null)throw Ct=s,r;Pn=1,Ab(n,Pr(t,n.current)),Ct=null;return}e.flags&32768?(Rt||i===1?n=!0:gg||_t&536870912?n=!1:(zc=n=!0,(i===2||i===9||i===3||i===6)&&(i=hr.current,i!==null&&i.tag===13&&(i.flags|=16384))),k5(e,n)):Y1(e)}function Y1(n){var e=n;do{if(e.flags&32768){k5(e,zc);return}n=e.return;var t=WB(e.alternate,e,Al);if(t!==null){Ct=t;return}if(e=e.sibling,e!==null){Ct=e;return}Ct=e=n}while(e!==null);Pn===0&&(Pn=5)}function k5(n,e){do{var t=YB(n.alternate,n);if(t!==null){t.flags&=32767,Ct=t;return}if(t=n.return,t!==null&&(t.flags|=32768,t.subtreeFlags=0,t.deletions=null),!e&&(n=n.sibling,n!==null)){Ct=n;return}Ct=n=t}while(n!==null);Pn=6,Ct=null}function uk(n,e,t,i,s,r,a,o,c){n.cancelPendingCommit=null;do X1();while(ai!==0);if(Bt&6)throw Error(Ce(327));if(e!==null){if(e===n.current)throw Error(Ce(177));if(r=e.lanes|e.childLanes,r|=oC,OI(n,t,r,a,o,c),n===cn&&(Ct=cn=null,_t=0),Zp=e,Xc=n,pl=t,PS=r,IS=s,b5=i,e.subtreeFlags&10256||e.flags&10256?(n.callbackNode=null,n.callbackPriority=0,az(db,function(){return L5(),null})):(n.callbackNode=null,n.callbackPriority=0),i=(e.flags&13878)!==0,e.subtreeFlags&13878||i){i=ot.T,ot.T=null,s=Ft.p,Ft.p=2,a=Bt,Bt|=4;try{XB(n,e,t)}finally{Bt=a,Ft.p=s,ot.T=i}}ai=1,T5(),D5(),j5()}}function T5(){if(ai===1){ai=0;var n=Xc,e=Zp,t=(e.flags&13878)!==0;if(e.subtreeFlags&13878||t){t=ot.T,ot.T=null;var i=Ft.p;Ft.p=2;var s=Bt;Bt|=4;try{d5(e,n);var r=HS,a=Wj(n.containerInfo),o=r.focusedElem,c=r.selectionRange;if(a!==o&&o&&o.ownerDocument&&Gj(o.ownerDocument.documentElement,o)){if(c!==null&&aC(o)){var h=c.start,d=c.end;if(d===void 0&&(d=h),"selectionStart"in o)o.selectionStart=h,o.selectionEnd=Math.min(d,o.value.length);else{var f=o.ownerDocument||document,p=f&&f.defaultView||window;if(p.getSelection){var g=p.getSelection(),v=o.textContent.length,b=Math.min(c.start,v),x=c.end===void 0?b:Math.min(c.end,v);!g.extend&&b>x&&(a=x,x=b,b=a);var m=R_(o,b),y=R_(o,x);if(m&&y&&(g.rangeCount!==1||g.anchorNode!==m.node||g.anchorOffset!==m.offset||g.focusNode!==y.node||g.focusOffset!==y.offset)){var w=f.createRange();w.setStart(m.node,m.offset),g.removeAllRanges(),b>x?(g.addRange(w),g.extend(y.node,y.offset)):(w.setEnd(y.node,y.offset),g.addRange(w))}}}}for(f=[],g=o;g=g.parentNode;)g.nodeType===1&&f.push({element:g,left:g.scrollLeft,top:g.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<f.length;o++){var E=f[o];E.element.scrollLeft=E.left,E.element.scrollTop=E.top}}Pb=!!US,HS=US=null}finally{Bt=s,Ft.p=i,ot.T=t}}n.current=e,ai=2}}function D5(){if(ai===2){ai=0;var n=Xc,e=Zp,t=(e.flags&8772)!==0;if(e.subtreeFlags&8772||t){t=ot.T,ot.T=null;var i=Ft.p;Ft.p=2;var s=Bt;Bt|=4;try{o5(n,e.alternate,e)}finally{Bt=s,Ft.p=i,ot.T=t}}ai=3}}function j5(){if(ai===4||ai===3){ai=0,NI();var n=Xc,e=Zp,t=pl,i=b5;e.subtreeFlags&10256||e.flags&10256?ai=5:(ai=0,Zp=Xc=null,R5(n,n.pendingLanes));var s=n.pendingLanes;if(s===0&&(Yc=null),JE(t),e=e.stateNode,ar&&typeof ar.onCommitFiberRoot=="function")try{ar.onCommitFiberRoot(ty,e,void 0,(e.current.flags&128)===128)}catch{}if(i!==null){e=ot.T,s=Ft.p,Ft.p=2,ot.T=null;try{for(var r=n.onRecoverableError,a=0;a<i.length;a++){var o=i[a];r(o.value,{componentStack:o.stack})}}finally{ot.T=e,Ft.p=s}}pl&3&&X1(),co(n),s=n.pendingLanes,t&261930&&s&42?n===BS?Tm++:(Tm=0,BS=n):Tm=0,cy(0)}}function R5(n,e){(n.pooledCacheLanes&=e)===0&&(e=n.pooledCache,e!=null&&(n.pooledCache=null,ay(e)))}function X1(){return T5(),D5(),j5(),L5()}function L5(){if(ai!==5)return!1;var n=Xc,e=PS;PS=0;var t=JE(pl),i=ot.T,s=Ft.p;try{Ft.p=32>t?32:t,ot.T=null,t=IS,IS=null;var r=Xc,a=pl;if(ai=0,Zp=Xc=null,pl=0,Bt&6)throw Error(Ce(331));var o=Bt;if(Bt|=4,x5(r.current),p5(r,r.current,a,t),Bt=o,cy(0,!1),ar&&typeof ar.onPostCommitFiberRoot=="function")try{ar.onPostCommitFiberRoot(ty,r)}catch{}return!0}finally{Ft.p=s,ot.T=i,R5(n,e)}}function hk(n,e,t){e=Pr(t,e),e=jS(n.stateNode,e,2),n=Wc(n,e,2),n!==null&&(iy(n,2),co(n))}function Yt(n,e,t){if(n.tag===3)hk(n,n,t);else for(;e!==null;){if(e.tag===3){hk(e,n,t);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(Yc===null||!Yc.has(i))){n=Pr(t,n),t=Y3(2),i=Wc(e,t,2),i!==null&&(X3(t,i,e,n),iy(i,2),co(i));break}}e=e.return}}function h2(n,e,t){var i=n.pingCache;if(i===null){i=n.pingCache=new QB;var s=new Set;i.set(e,s)}else s=i.get(e),s===void 0&&(s=new Set,i.set(e,s));s.has(t)||(MC=!0,s.add(t),n=iz.bind(null,n,e,t),e.then(n,n))}function iz(n,e,t){var i=n.pingCache;i!==null&&i.delete(e),n.pingedLanes|=n.suspendedLanes&t,n.warmLanes&=~t,cn===n&&(_t&t)===t&&(Pn===4||Pn===3&&(_t&62914560)===_t&&300>rr()-G1?!(Bt&2)&&Qp(n,0):OC|=t,Kp===_t&&(Kp=0)),co(n)}function M5(n,e){e===0&&(e=Cj()),n=sd(n,e),n!==null&&(iy(n,e),co(n))}function sz(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),M5(n,t)}function rz(n,e){var t=0;switch(n.tag){case 31:case 13:var i=n.stateNode,s=n.memoizedState;s!==null&&(t=s.retryLane);break;case 19:i=n.stateNode;break;case 22:i=n.stateNode._retryCache;break;default:throw Error(Ce(314))}i!==null&&i.delete(e),M5(n,t)}function az(n,e){return ZE(n,e)}var Tb=null,kd=null,zS=!1,Db=!1,d2=!1,Uc=0;function co(n){n!==kd&&n.next===null&&(kd===null?Tb=kd=n:kd=kd.next=n),Db=!0,zS||(zS=!0,lz())}function cy(n,e){if(!d2&&Db){d2=!0;do for(var t=!1,i=Tb;i!==null;){if(n!==0){var s=i.pendingLanes;if(s===0)var r=0;else{var a=i.suspendedLanes,o=i.pingedLanes;r=(1<<31-or(42|n)+1)-1,r&=s&~(a&~o),r=r&201326741?r&201326741|1:r?r|2:0}r!==0&&(t=!0,dk(i,r))}else r=_t,r=O1(i,i===cn?r:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),!(r&3)||ny(i,r)||(t=!0,dk(i,r));i=i.next}while(t);d2=!1}}function oz(){O5()}function O5(){Db=zS=!1;var n=0;Uc!==0&&yz()&&(n=Uc);for(var e=rr(),t=null,i=Tb;i!==null;){var s=i.next,r=P5(i,e);r===0?(i.next=null,t===null?Tb=s:t.next=s,s===null&&(kd=t)):(t=i,(n!==0||r&3)&&(Db=!0)),i=s}ai!==0&&ai!==5||cy(n),Uc!==0&&(Uc=0)}function P5(n,e){for(var t=n.suspendedLanes,i=n.pingedLanes,s=n.expirationTimes,r=n.pendingLanes&-62914561;0<r;){var a=31-or(r),o=1<<a,c=s[a];c===-1?(!(o&t)||o&i)&&(s[a]=MI(o,e)):c<=e&&(n.expiredLanes|=o),r&=~o}if(e=cn,t=_t,t=O1(n,n===e?t:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),i=n.callbackNode,t===0||n===e&&(Wt===2||Wt===9)||n.cancelPendingCommit!==null)return i!==null&&i!==null&&Fw(i),n.callbackNode=null,n.callbackPriority=0;if(!(t&3)||ny(n,t)){if(e=t&-t,e===n.callbackPriority)return e;switch(i!==null&&Fw(i),JE(t)){case 2:case 8:t=Aj;break;case 32:t=db;break;case 268435456:t=Ej;break;default:t=db}return i=I5.bind(null,n),t=ZE(t,i),n.callbackPriority=e,n.callbackNode=t,e}return i!==null&&i!==null&&Fw(i),n.callbackPriority=2,n.callbackNode=null,2}function I5(n,e){if(ai!==0&&ai!==5)return n.callbackNode=null,n.callbackPriority=0,null;var t=n.callbackNode;if(X1()&&n.callbackNode!==t)return null;var i=_t;return i=O1(n,n===cn?i:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),i===0?null:(S5(n,i,e),P5(n,rr()),n.callbackNode!=null&&n.callbackNode===t?I5.bind(null,n):null)}function dk(n,e){if(X1())return null;S5(n,e,!0)}function lz(){bz(function(){Bt&6?ZE(Sj,oz):O5()})}function IC(){if(Uc===0){var n=Wp;n===0&&(n=jy,jy<<=1,!(jy&261888)&&(jy=256)),Uc=n}return Uc}function fk(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:ov(""+n)}function pk(n,e){var t=e.ownerDocument.createElement("input");return t.name=e.name,t.value=e.value,n.id&&t.setAttribute("form",n.id),e.parentNode.insertBefore(t,e),n=new FormData(n),t.parentNode.removeChild(t),n}function cz(n,e,t,i,s){if(e==="submit"&&t&&t.stateNode===s){var r=fk((s[Ns]||null).action),a=i.submitter;a&&(e=(e=a[Ns]||null)?fk(e.formAction):a.getAttribute("formAction"),e!==null&&(r=e,a=null));var o=new P1("action","action",null,i,s);n.push({event:o,listeners:[{instance:null,listener:function(){if(i.defaultPrevented){if(Uc!==0){var c=a?pk(s,a):new FormData(s);TS(t,{pending:!0,data:c,method:s.method,action:r},null,c)}}else typeof r=="function"&&(o.preventDefault(),c=a?pk(s,a):new FormData(s),TS(t,{pending:!0,data:c,method:s.method,action:r},r,c))},currentTarget:s}]})}}for(var f2=0;f2<xS.length;f2++){var p2=xS[f2],uz=p2.toLowerCase(),hz=p2[0].toUpperCase()+p2.slice(1);wa(uz,"on"+hz)}wa(Xj,"onAnimationEnd");wa(Kj,"onAnimationIteration");wa(Zj,"onAnimationStart");wa("dblclick","onDoubleClick");wa("focusin","onFocus");wa("focusout","onBlur");wa(_B,"onTransitionRun");wa(kB,"onTransitionStart");wa(TB,"onTransitionCancel");wa(Qj,"onTransitionEnd");Vp("onMouseEnter",["mouseout","mouseover"]);Vp("onMouseLeave",["mouseout","mouseover"]);Vp("onPointerEnter",["pointerout","pointerover"]);Vp("onPointerLeave",["pointerout","pointerover"]);td("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));td("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));td("onBeforeInput",["compositionend","keypress","textInput","paste"]);td("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));td("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));td("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var $m="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),dz=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat($m));function B5(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var i=n[t],s=i.event;i=i.listeners;e:{var r=void 0;if(e)for(var a=i.length-1;0<=a;a--){var o=i[a],c=o.instance,h=o.currentTarget;if(o=o.listener,c!==r&&s.isPropagationStopped())break e;r=o,s.currentTarget=h;try{r(s)}catch(d){pb(d)}s.currentTarget=null,r=c}else for(a=0;a<i.length;a++){if(o=i[a],c=o.instance,h=o.currentTarget,o=o.listener,c!==r&&s.isPropagationStopped())break e;r=o,s.currentTarget=h;try{r(s)}catch(d){pb(d)}s.currentTarget=null,r=c}}}}function Et(n,e){var t=e[cS];t===void 0&&(t=e[cS]=new Set);var i=n+"__bubble";t.has(i)||(z5(e,n,2,!1),t.add(i))}function g2(n,e,t){var i=0;e&&(i|=4),z5(t,n,i,e)}var Uy="_reactListening"+Math.random().toString(36).slice(2);function BC(n){if(!n[Uy]){n[Uy]=!0,Dj.forEach(function(t){t!=="selectionchange"&&(dz.has(t)||g2(t,!1,n),g2(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[Uy]||(e[Uy]=!0,g2("selectionchange",!1,e))}}function z5(n,e,t,i){switch(Q5(e)){case 2:var s=Fz;break;case 8:s=Uz;break;default:s=HC}t=s.bind(null,e,t,n),s=void 0,!pS||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),i?s!==void 0?n.addEventListener(e,t,{capture:!0,passive:s}):n.addEventListener(e,t,!0):s!==void 0?n.addEventListener(e,t,{passive:s}):n.addEventListener(e,t,!1)}function m2(n,e,t,i,s){var r=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var a=i.tag;if(a===3||a===4){var o=i.stateNode.containerInfo;if(o===s)break;if(a===4)for(a=i.return;a!==null;){var c=a.tag;if((c===3||c===4)&&a.stateNode.containerInfo===s)return;a=a.return}for(;o!==null;){if(a=qd(o),a===null)return;if(c=a.tag,c===5||c===6||c===26||c===27){i=r=a;continue e}o=o.parentNode}}i=i.return}Bj(function(){var h=r,d=nC(t),f=[];e:{var p=Jj.get(n);if(p!==void 0){var g=P1,v=n;switch(n){case"keypress":if(cv(t)===0)break e;case"keydown":case"keyup":g=rB;break;case"focusin":v="focus",g=Vw;break;case"focusout":v="blur",g=Vw;break;case"beforeblur":case"afterblur":g=Vw;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=S_;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=WI;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=lB;break;case Xj:case Kj:case Zj:g=KI;break;case Qj:g=uB;break;case"scroll":case"scrollend":g=VI;break;case"wheel":g=dB;break;case"copy":case"cut":case"paste":g=QI;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=E_;break;case"toggle":case"beforetoggle":g=pB}var b=(e&4)!==0,x=!b&&(n==="scroll"||n==="scrollend"),m=b?p!==null?p+"Capture":null:p;b=[];for(var y=h,w;y!==null;){var E=y;if(w=E.stateNode,E=E.tag,E!==5&&E!==26&&E!==27||w===null||m===null||(E=Om(y,m),E!=null&&b.push(qm(y,E,w))),x)break;y=y.return}0<b.length&&(p=new g(p,v,null,t,d),f.push({event:p,listeners:b}))}}if(!(e&7)){e:{if(p=n==="mouseover"||n==="pointerover",g=n==="mouseout"||n==="pointerout",p&&t!==fS&&(v=t.relatedTarget||t.fromElement)&&(qd(v)||v[hg]))break e;if((g||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,g?(v=t.relatedTarget||t.toElement,g=h,v=v?qd(v):null,v!==null&&(x=ey(v),b=v.tag,v!==x||b!==5&&b!==27&&b!==6)&&(v=null)):(g=null,v=h),g!==v)){if(b=S_,E="onMouseLeave",m="onMouseEnter",y="mouse",(n==="pointerout"||n==="pointerover")&&(b=E_,E="onPointerLeave",m="onPointerEnter",y="pointer"),x=g==null?p:Vg(g),w=v==null?p:Vg(v),p=new b(E,y+"leave",g,t,d),p.target=x,p.relatedTarget=w,E=null,qd(d)===h&&(b=new b(m,y+"enter",v,t,d),b.target=w,b.relatedTarget=x,E=b),x=E,g&&v)t:{for(b=fz,m=g,y=v,w=0,E=m;E;E=b(E))w++;E=0;for(var S=y;S;S=b(S))E++;for(;0<w-E;)m=b(m),w--;for(;0<E-w;)y=b(y),E--;for(;w--;){if(m===y||y!==null&&m===y.alternate){b=m;break t}m=b(m),y=b(y)}b=null}else b=null;g!==null&&gk(f,p,g,b,!1),v!==null&&x!==null&&gk(f,x,v,b,!0)}}e:{if(p=h?Vg(h):window,g=p.nodeName&&p.nodeName.toLowerCase(),g==="select"||g==="input"&&p.type==="file")var _=k_;else if(__(p))if(qj)_=EB;else{_=SB;var T=wB}else g=p.nodeName,!g||g.toLowerCase()!=="input"||p.type!=="checkbox"&&p.type!=="radio"?h&&tC(h.elementType)&&(_=k_):_=AB;if(_&&(_=_(n,h))){$j(f,_,t,d);break e}T&&T(n,p,h),n==="focusout"&&h&&p.type==="number"&&h.memoizedProps.value!=null&&dS(p,"number",p.value)}switch(T=h?Vg(h):window,n){case"focusin":(__(T)||T.contentEditable==="true")&&(Wd=T,gS=h,bm=null);break;case"focusout":bm=gS=Wd=null;break;case"mousedown":mS=!0;break;case"contextmenu":case"mouseup":case"dragend":mS=!1,L_(f,t,d);break;case"selectionchange":if(NB)break;case"keydown":case"keyup":L_(f,t,d)}var j;if(rC)e:{switch(n){case"compositionstart":var M="onCompositionStart";break e;case"compositionend":M="onCompositionEnd";break e;case"compositionupdate":M="onCompositionUpdate";break e}M=void 0}else Gd?Uj(n,t)&&(M="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(M="onCompositionStart");M&&(Fj&&t.locale!=="ko"&&(Gd||M!=="onCompositionStart"?M==="onCompositionEnd"&&Gd&&(j=zj()):(Bc=d,iC="value"in Bc?Bc.value:Bc.textContent,Gd=!0)),T=jb(h,M),0<T.length&&(M=new A_(M,n,null,t,d),f.push({event:M,listeners:T}),j?M.data=j:(j=Hj(t),j!==null&&(M.data=j)))),(j=mB?xB(n,t):yB(n,t))&&(M=jb(h,"onBeforeInput"),0<M.length&&(T=new A_("onBeforeInput","beforeinput",null,t,d),f.push({event:T,listeners:M}),T.data=j)),cz(f,n,h,t,d)}B5(f,e)})}function qm(n,e,t){return{instance:n,listener:e,currentTarget:t}}function jb(n,e){for(var t=e+"Capture",i=[];n!==null;){var s=n,r=s.stateNode;if(s=s.tag,s!==5&&s!==26&&s!==27||r===null||(s=Om(n,t),s!=null&&i.unshift(qm(n,s,r)),s=Om(n,e),s!=null&&i.push(qm(n,s,r))),n.tag===3)return i;n=n.return}return[]}function fz(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function gk(n,e,t,i,s){for(var r=e._reactName,a=[];t!==null&&t!==i;){var o=t,c=o.alternate,h=o.stateNode;if(o=o.tag,c!==null&&c===i)break;o!==5&&o!==26&&o!==27||h===null||(c=h,s?(h=Om(t,r),h!=null&&a.unshift(qm(t,h,c))):s||(h=Om(t,r),h!=null&&a.push(qm(t,h,c)))),t=t.return}a.length!==0&&n.push({event:e,listeners:a})}var pz=/\r\n?/g,gz=/\u0000|\uFFFD/g;function mk(n){return(typeof n=="string"?n:""+n).replace(pz,`
`).replace(gz,"")}function F5(n,e){return e=mk(e),mk(n)===e}function nn(n,e,t,i,s,r){switch(t){case"children":typeof i=="string"?e==="body"||e==="textarea"&&i===""||Gp(n,i):(typeof i=="number"||typeof i=="bigint")&&e!=="body"&&Gp(n,""+i);break;case"className":My(n,"class",i);break;case"tabIndex":My(n,"tabindex",i);break;case"dir":case"role":case"viewBox":case"width":case"height":My(n,t,i);break;case"style":Ij(n,i,r);break;case"data":if(e!=="object"){My(n,"data",i);break}case"src":case"href":if(i===""&&(e!=="a"||t!=="href")){n.removeAttribute(t);break}if(i==null||typeof i=="function"||typeof i=="symbol"||typeof i=="boolean"){n.removeAttribute(t);break}i=ov(""+i),n.setAttribute(t,i);break;case"action":case"formAction":if(typeof i=="function"){n.setAttribute(t,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof r=="function"&&(t==="formAction"?(e!=="input"&&nn(n,e,"name",s.name,s,null),nn(n,e,"formEncType",s.formEncType,s,null),nn(n,e,"formMethod",s.formMethod,s,null),nn(n,e,"formTarget",s.formTarget,s,null)):(nn(n,e,"encType",s.encType,s,null),nn(n,e,"method",s.method,s,null),nn(n,e,"target",s.target,s,null)));if(i==null||typeof i=="symbol"||typeof i=="boolean"){n.removeAttribute(t);break}i=ov(""+i),n.setAttribute(t,i);break;case"onClick":i!=null&&(n.onclick=ll);break;case"onScroll":i!=null&&Et("scroll",n);break;case"onScrollEnd":i!=null&&Et("scrollend",n);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(Ce(61));if(t=i.__html,t!=null){if(s.children!=null)throw Error(Ce(60));n.innerHTML=t}}break;case"multiple":n.multiple=i&&typeof i!="function"&&typeof i!="symbol";break;case"muted":n.muted=i&&typeof i!="function"&&typeof i!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(i==null||typeof i=="function"||typeof i=="boolean"||typeof i=="symbol"){n.removeAttribute("xlink:href");break}t=ov(""+i),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",t);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":i!=null&&typeof i!="function"&&typeof i!="symbol"?n.setAttribute(t,""+i):n.removeAttribute(t);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":i&&typeof i!="function"&&typeof i!="symbol"?n.setAttribute(t,""):n.removeAttribute(t);break;case"capture":case"download":i===!0?n.setAttribute(t,""):i!==!1&&i!=null&&typeof i!="function"&&typeof i!="symbol"?n.setAttribute(t,i):n.removeAttribute(t);break;case"cols":case"rows":case"size":case"span":i!=null&&typeof i!="function"&&typeof i!="symbol"&&!isNaN(i)&&1<=i?n.setAttribute(t,i):n.removeAttribute(t);break;case"rowSpan":case"start":i==null||typeof i=="function"||typeof i=="symbol"||isNaN(i)?n.removeAttribute(t):n.setAttribute(t,i);break;case"popover":Et("beforetoggle",n),Et("toggle",n),av(n,"popover",i);break;case"xlinkActuate":ho(n,"http://www.w3.org/1999/xlink","xlink:actuate",i);break;case"xlinkArcrole":ho(n,"http://www.w3.org/1999/xlink","xlink:arcrole",i);break;case"xlinkRole":ho(n,"http://www.w3.org/1999/xlink","xlink:role",i);break;case"xlinkShow":ho(n,"http://www.w3.org/1999/xlink","xlink:show",i);break;case"xlinkTitle":ho(n,"http://www.w3.org/1999/xlink","xlink:title",i);break;case"xlinkType":ho(n,"http://www.w3.org/1999/xlink","xlink:type",i);break;case"xmlBase":ho(n,"http://www.w3.org/XML/1998/namespace","xml:base",i);break;case"xmlLang":ho(n,"http://www.w3.org/XML/1998/namespace","xml:lang",i);break;case"xmlSpace":ho(n,"http://www.w3.org/XML/1998/namespace","xml:space",i);break;case"is":av(n,"is",i);break;case"innerText":case"textContent":break;default:(!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(t=$I.get(t)||t,av(n,t,i))}}function FS(n,e,t,i,s,r){switch(t){case"style":Ij(n,i,r);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(Ce(61));if(t=i.__html,t!=null){if(s.children!=null)throw Error(Ce(60));n.innerHTML=t}}break;case"children":typeof i=="string"?Gp(n,i):(typeof i=="number"||typeof i=="bigint")&&Gp(n,""+i);break;case"onScroll":i!=null&&Et("scroll",n);break;case"onScrollEnd":i!=null&&Et("scrollend",n);break;case"onClick":i!=null&&(n.onclick=ll);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!jj.hasOwnProperty(t))e:{if(t[0]==="o"&&t[1]==="n"&&(s=t.endsWith("Capture"),e=t.slice(2,s?t.length-7:void 0),r=n[Ns]||null,r=r!=null?r[t]:null,typeof r=="function"&&n.removeEventListener(e,r,s),typeof i=="function")){typeof r!="function"&&r!==null&&(t in n?n[t]=null:n.hasAttribute(t)&&n.removeAttribute(t)),n.addEventListener(e,i,s);break e}t in n?n[t]=i:i===!0?n.setAttribute(t,""):av(n,t,i)}}}function Pi(n,e,t){switch(e){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Et("error",n),Et("load",n);var i=!1,s=!1,r;for(r in t)if(t.hasOwnProperty(r)){var a=t[r];if(a!=null)switch(r){case"src":i=!0;break;case"srcSet":s=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(Ce(137,e));default:nn(n,e,r,a,t,null)}}s&&nn(n,e,"srcSet",t.srcSet,t,null),i&&nn(n,e,"src",t.src,t,null);return;case"input":Et("invalid",n);var o=r=a=s=null,c=null,h=null;for(i in t)if(t.hasOwnProperty(i)){var d=t[i];if(d!=null)switch(i){case"name":s=d;break;case"type":a=d;break;case"checked":c=d;break;case"defaultChecked":h=d;break;case"value":r=d;break;case"defaultValue":o=d;break;case"children":case"dangerouslySetInnerHTML":if(d!=null)throw Error(Ce(137,e));break;default:nn(n,e,i,d,t,null)}}Mj(n,r,o,c,h,a,s,!1);return;case"select":Et("invalid",n),i=a=r=null;for(s in t)if(t.hasOwnProperty(s)&&(o=t[s],o!=null))switch(s){case"value":r=o;break;case"defaultValue":a=o;break;case"multiple":i=o;default:nn(n,e,s,o,t,null)}e=r,t=a,n.multiple=!!i,e!=null?cf(n,!!i,e,!1):t!=null&&cf(n,!!i,t,!0);return;case"textarea":Et("invalid",n),r=s=i=null;for(a in t)if(t.hasOwnProperty(a)&&(o=t[a],o!=null))switch(a){case"value":i=o;break;case"defaultValue":s=o;break;case"children":r=o;break;case"dangerouslySetInnerHTML":if(o!=null)throw Error(Ce(91));break;default:nn(n,e,a,o,t,null)}Pj(n,i,s,r);return;case"option":for(c in t)if(t.hasOwnProperty(c)&&(i=t[c],i!=null))switch(c){case"selected":n.selected=i&&typeof i!="function"&&typeof i!="symbol";break;default:nn(n,e,c,i,t,null)}return;case"dialog":Et("beforetoggle",n),Et("toggle",n),Et("cancel",n),Et("close",n);break;case"iframe":case"object":Et("load",n);break;case"video":case"audio":for(i=0;i<$m.length;i++)Et($m[i],n);break;case"image":Et("error",n),Et("load",n);break;case"details":Et("toggle",n);break;case"embed":case"source":case"link":Et("error",n),Et("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(h in t)if(t.hasOwnProperty(h)&&(i=t[h],i!=null))switch(h){case"children":case"dangerouslySetInnerHTML":throw Error(Ce(137,e));default:nn(n,e,h,i,t,null)}return;default:if(tC(e)){for(d in t)t.hasOwnProperty(d)&&(i=t[d],i!==void 0&&FS(n,e,d,i,t,void 0));return}}for(o in t)t.hasOwnProperty(o)&&(i=t[o],i!=null&&nn(n,e,o,i,t,null))}function mz(n,e,t,i){switch(e){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var s=null,r=null,a=null,o=null,c=null,h=null,d=null;for(g in t){var f=t[g];if(t.hasOwnProperty(g)&&f!=null)switch(g){case"checked":break;case"value":break;case"defaultValue":c=f;default:i.hasOwnProperty(g)||nn(n,e,g,null,i,f)}}for(var p in i){var g=i[p];if(f=t[p],i.hasOwnProperty(p)&&(g!=null||f!=null))switch(p){case"type":r=g;break;case"name":s=g;break;case"checked":h=g;break;case"defaultChecked":d=g;break;case"value":a=g;break;case"defaultValue":o=g;break;case"children":case"dangerouslySetInnerHTML":if(g!=null)throw Error(Ce(137,e));break;default:g!==f&&nn(n,e,p,g,i,f)}}hS(n,a,o,c,h,d,r,s);return;case"select":g=a=o=p=null;for(r in t)if(c=t[r],t.hasOwnProperty(r)&&c!=null)switch(r){case"value":break;case"multiple":g=c;default:i.hasOwnProperty(r)||nn(n,e,r,null,i,c)}for(s in i)if(r=i[s],c=t[s],i.hasOwnProperty(s)&&(r!=null||c!=null))switch(s){case"value":p=r;break;case"defaultValue":o=r;break;case"multiple":a=r;default:r!==c&&nn(n,e,s,r,i,c)}e=o,t=a,i=g,p!=null?cf(n,!!t,p,!1):!!i!=!!t&&(e!=null?cf(n,!!t,e,!0):cf(n,!!t,t?[]:"",!1));return;case"textarea":g=p=null;for(o in t)if(s=t[o],t.hasOwnProperty(o)&&s!=null&&!i.hasOwnProperty(o))switch(o){case"value":break;case"children":break;default:nn(n,e,o,null,i,s)}for(a in i)if(s=i[a],r=t[a],i.hasOwnProperty(a)&&(s!=null||r!=null))switch(a){case"value":p=s;break;case"defaultValue":g=s;break;case"children":break;case"dangerouslySetInnerHTML":if(s!=null)throw Error(Ce(91));break;default:s!==r&&nn(n,e,a,s,i,r)}Oj(n,p,g);return;case"option":for(var v in t)if(p=t[v],t.hasOwnProperty(v)&&p!=null&&!i.hasOwnProperty(v))switch(v){case"selected":n.selected=!1;break;default:nn(n,e,v,null,i,p)}for(c in i)if(p=i[c],g=t[c],i.hasOwnProperty(c)&&p!==g&&(p!=null||g!=null))switch(c){case"selected":n.selected=p&&typeof p!="function"&&typeof p!="symbol";break;default:nn(n,e,c,p,i,g)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var b in t)p=t[b],t.hasOwnProperty(b)&&p!=null&&!i.hasOwnProperty(b)&&nn(n,e,b,null,i,p);for(h in i)if(p=i[h],g=t[h],i.hasOwnProperty(h)&&p!==g&&(p!=null||g!=null))switch(h){case"children":case"dangerouslySetInnerHTML":if(p!=null)throw Error(Ce(137,e));break;default:nn(n,e,h,p,i,g)}return;default:if(tC(e)){for(var x in t)p=t[x],t.hasOwnProperty(x)&&p!==void 0&&!i.hasOwnProperty(x)&&FS(n,e,x,void 0,i,p);for(d in i)p=i[d],g=t[d],!i.hasOwnProperty(d)||p===g||p===void 0&&g===void 0||FS(n,e,d,p,i,g);return}}for(var m in t)p=t[m],t.hasOwnProperty(m)&&p!=null&&!i.hasOwnProperty(m)&&nn(n,e,m,null,i,p);for(f in i)p=i[f],g=t[f],!i.hasOwnProperty(f)||p===g||p==null&&g==null||nn(n,e,f,p,i,g)}function xk(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function xz(){if(typeof performance.getEntriesByType=="function"){for(var n=0,e=0,t=performance.getEntriesByType("resource"),i=0;i<t.length;i++){var s=t[i],r=s.transferSize,a=s.initiatorType,o=s.duration;if(r&&o&&xk(a)){for(a=0,o=s.responseEnd,i+=1;i<t.length;i++){var c=t[i],h=c.startTime;if(h>o)break;var d=c.transferSize,f=c.initiatorType;d&&xk(f)&&(c=c.responseEnd,a+=d*(c<o?1:(o-h)/(c-h)))}if(--i,e+=8*(r+a)/(s.duration/1e3),n++,10<n)break}}if(0<n)return e/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var US=null,HS=null;function Rb(n){return n.nodeType===9?n:n.ownerDocument}function yk(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function U5(n,e){if(n===0)switch(e){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&e==="foreignObject"?0:n}function $S(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.children=="bigint"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var x2=null;function yz(){var n=window.event;return n&&n.type==="popstate"?n===x2?!1:(x2=n,!0):(x2=null,!1)}var H5=typeof setTimeout=="function"?setTimeout:void 0,vz=typeof clearTimeout=="function"?clearTimeout:void 0,vk=typeof Promise=="function"?Promise:void 0,bz=typeof queueMicrotask=="function"?queueMicrotask:typeof vk<"u"?function(n){return vk.resolve(null).then(n).catch(wz)}:H5;function wz(n){setTimeout(function(){throw n})}function uu(n){return n==="head"}function bk(n,e){var t=e,i=0;do{var s=t.nextSibling;if(n.removeChild(t),s&&s.nodeType===8)if(t=s.data,t==="/$"||t==="/&"){if(i===0){n.removeChild(s),eg(e);return}i--}else if(t==="$"||t==="$?"||t==="$~"||t==="$!"||t==="&")i++;else if(t==="html")Dm(n.ownerDocument.documentElement);else if(t==="head"){t=n.ownerDocument.head,Dm(t);for(var r=t.firstChild;r;){var a=r.nextSibling,o=r.nodeName;r[sy]||o==="SCRIPT"||o==="STYLE"||o==="LINK"&&r.rel.toLowerCase()==="stylesheet"||t.removeChild(r),r=a}}else t==="body"&&Dm(n.ownerDocument.body);t=s}while(t);eg(e)}function wk(n,e){var t=n;n=0;do{var i=t.nextSibling;if(t.nodeType===1?e?(t._stashedDisplay=t.style.display,t.style.display="none"):(t.style.display=t._stashedDisplay||"",t.getAttribute("style")===""&&t.removeAttribute("style")):t.nodeType===3&&(e?(t._stashedText=t.nodeValue,t.nodeValue=""):t.nodeValue=t._stashedText||""),i&&i.nodeType===8)if(t=i.data,t==="/$"){if(n===0)break;n--}else t!=="$"&&t!=="$?"&&t!=="$~"&&t!=="$!"||n++;t=i}while(t)}function qS(n){var e=n.firstChild;for(e&&e.nodeType===10&&(e=e.nextSibling);e;){var t=e;switch(e=e.nextSibling,t.nodeName){case"HTML":case"HEAD":case"BODY":qS(t),eC(t);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(t.rel.toLowerCase()==="stylesheet")continue}n.removeChild(t)}}function Sz(n,e,t,i){for(;n.nodeType===1;){var s=t;if(n.nodeName.toLowerCase()!==e.toLowerCase()){if(!i&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(i){if(!n[sy])switch(e){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(r=n.getAttribute("rel"),r==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(r!==s.rel||n.getAttribute("href")!==(s.href==null||s.href===""?null:s.href)||n.getAttribute("crossorigin")!==(s.crossOrigin==null?null:s.crossOrigin)||n.getAttribute("title")!==(s.title==null?null:s.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(r=n.getAttribute("src"),(r!==(s.src==null?null:s.src)||n.getAttribute("type")!==(s.type==null?null:s.type)||n.getAttribute("crossorigin")!==(s.crossOrigin==null?null:s.crossOrigin))&&r&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(e==="input"&&n.type==="hidden"){var r=s.name==null?null:""+s.name;if(s.type==="hidden"&&n.getAttribute("name")===r)return n}else return n;if(n=Ur(n.nextSibling),n===null)break}return null}function Az(n,e,t){if(e==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!t||(n=Ur(n.nextSibling),n===null))return null;return n}function $5(n,e){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!e||(n=Ur(n.nextSibling),n===null))return null;return n}function VS(n){return n.data==="$?"||n.data==="$~"}function GS(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function Ez(n,e){var t=n.ownerDocument;if(n.data==="$~")n._reactRetry=e;else if(n.data!=="$?"||t.readyState!=="loading")e();else{var i=function(){e(),t.removeEventListener("DOMContentLoaded",i)};t.addEventListener("DOMContentLoaded",i),n._reactRetry=i}}function Ur(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?"||e==="$~"||e==="&"||e==="F!"||e==="F")break;if(e==="/$"||e==="/&")return null}}return n}var WS=null;function Sk(n){n=n.nextSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"||t==="/&"){if(e===0)return Ur(n.nextSibling);e--}else t!=="$"&&t!=="$!"&&t!=="$?"&&t!=="$~"&&t!=="&"||e++}n=n.nextSibling}return null}function Ak(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"){if(e===0)return n;e--}else t!=="/$"&&t!=="/&"||e++}n=n.previousSibling}return null}function q5(n,e,t){switch(e=Rb(t),n){case"html":if(n=e.documentElement,!n)throw Error(Ce(452));return n;case"head":if(n=e.head,!n)throw Error(Ce(453));return n;case"body":if(n=e.body,!n)throw Error(Ce(454));return n;default:throw Error(Ce(451))}}function Dm(n){for(var e=n.attributes;e.length;)n.removeAttributeNode(e[0]);eC(n)}var $r=new Map,Ek=new Set;function Lb(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var Rl=Ft.d;Ft.d={f:Cz,r:Nz,D:_z,C:kz,L:Tz,m:Dz,X:Rz,S:jz,M:Lz};function Cz(){var n=Rl.f(),e=W1();return n||e}function Nz(n){var e=dg(n);e!==null&&e.tag===5&&e.type==="form"?I3(e):Rl.r(n)}var mg=typeof document>"u"?null:document;function V5(n,e,t){var i=mg;if(i&&typeof e=="string"&&e){var s=Or(e);s='link[rel="'+n+'"][href="'+s+'"]',typeof t=="string"&&(s+='[crossorigin="'+t+'"]'),Ek.has(s)||(Ek.add(s),n={rel:n,crossOrigin:t,href:e},i.querySelector(s)===null&&(e=i.createElement("link"),Pi(e,"link",n),vi(e),i.head.appendChild(e)))}}function _z(n){Rl.D(n),V5("dns-prefetch",n,null)}function kz(n,e){Rl.C(n,e),V5("preconnect",n,e)}function Tz(n,e,t){Rl.L(n,e,t);var i=mg;if(i&&n&&e){var s='link[rel="preload"][as="'+Or(e)+'"]';e==="image"&&t&&t.imageSrcSet?(s+='[imagesrcset="'+Or(t.imageSrcSet)+'"]',typeof t.imageSizes=="string"&&(s+='[imagesizes="'+Or(t.imageSizes)+'"]')):s+='[href="'+Or(n)+'"]';var r=s;switch(e){case"style":r=Jp(n);break;case"script":r=xg(n)}$r.has(r)||(n=yn({rel:"preload",href:e==="image"&&t&&t.imageSrcSet?void 0:n,as:e},t),$r.set(r,n),i.querySelector(s)!==null||e==="style"&&i.querySelector(uy(r))||e==="script"&&i.querySelector(hy(r))||(e=i.createElement("link"),Pi(e,"link",n),vi(e),i.head.appendChild(e)))}}function Dz(n,e){Rl.m(n,e);var t=mg;if(t&&n){var i=e&&typeof e.as=="string"?e.as:"script",s='link[rel="modulepreload"][as="'+Or(i)+'"][href="'+Or(n)+'"]',r=s;switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":r=xg(n)}if(!$r.has(r)&&(n=yn({rel:"modulepreload",href:n},e),$r.set(r,n),t.querySelector(s)===null)){switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(t.querySelector(hy(r)))return}i=t.createElement("link"),Pi(i,"link",n),vi(i),t.head.appendChild(i)}}}function jz(n,e,t){Rl.S(n,e,t);var i=mg;if(i&&n){var s=lf(i).hoistableStyles,r=Jp(n);e=e||"default";var a=s.get(r);if(!a){var o={loading:0,preload:null};if(a=i.querySelector(uy(r)))o.loading=5;else{n=yn({rel:"stylesheet",href:n,"data-precedence":e},t),(t=$r.get(r))&&zC(n,t);var c=a=i.createElement("link");vi(c),Pi(c,"link",n),c._p=new Promise(function(h,d){c.onload=h,c.onerror=d}),c.addEventListener("load",function(){o.loading|=1}),c.addEventListener("error",function(){o.loading|=2}),o.loading|=4,xv(a,e,i)}a={type:"stylesheet",instance:a,count:1,state:o},s.set(r,a)}}}function Rz(n,e){Rl.X(n,e);var t=mg;if(t&&n){var i=lf(t).hoistableScripts,s=xg(n),r=i.get(s);r||(r=t.querySelector(hy(s)),r||(n=yn({src:n,async:!0},e),(e=$r.get(s))&&FC(n,e),r=t.createElement("script"),vi(r),Pi(r,"link",n),t.head.appendChild(r)),r={type:"script",instance:r,count:1,state:null},i.set(s,r))}}function Lz(n,e){Rl.M(n,e);var t=mg;if(t&&n){var i=lf(t).hoistableScripts,s=xg(n),r=i.get(s);r||(r=t.querySelector(hy(s)),r||(n=yn({src:n,async:!0,type:"module"},e),(e=$r.get(s))&&FC(n,e),r=t.createElement("script"),vi(r),Pi(r,"link",n),t.head.appendChild(r)),r={type:"script",instance:r,count:1,state:null},i.set(s,r))}}function Ck(n,e,t,i){var s=(s=qc.current)?Lb(s):null;if(!s)throw Error(Ce(446));switch(n){case"meta":case"title":return null;case"style":return typeof t.precedence=="string"&&typeof t.href=="string"?(e=Jp(t.href),t=lf(s).hoistableStyles,i=t.get(e),i||(i={type:"style",instance:null,count:0,state:null},t.set(e,i)),i):{type:"void",instance:null,count:0,state:null};case"link":if(t.rel==="stylesheet"&&typeof t.href=="string"&&typeof t.precedence=="string"){n=Jp(t.href);var r=lf(s).hoistableStyles,a=r.get(n);if(a||(s=s.ownerDocument||s,a={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},r.set(n,a),(r=s.querySelector(uy(n)))&&!r._p&&(a.instance=r,a.state.loading=5),$r.has(n)||(t={rel:"preload",as:"style",href:t.href,crossOrigin:t.crossOrigin,integrity:t.integrity,media:t.media,hrefLang:t.hrefLang,referrerPolicy:t.referrerPolicy},$r.set(n,t),r||Mz(s,n,t,a.state))),e&&i===null)throw Error(Ce(528,""));return a}if(e&&i!==null)throw Error(Ce(529,""));return null;case"script":return e=t.async,t=t.src,typeof t=="string"&&e&&typeof e!="function"&&typeof e!="symbol"?(e=xg(t),t=lf(s).hoistableScripts,i=t.get(e),i||(i={type:"script",instance:null,count:0,state:null},t.set(e,i)),i):{type:"void",instance:null,count:0,state:null};default:throw Error(Ce(444,n))}}function Jp(n){return'href="'+Or(n)+'"'}function uy(n){return'link[rel="stylesheet"]['+n+"]"}function G5(n){return yn({},n,{"data-precedence":n.precedence,precedence:null})}function Mz(n,e,t,i){n.querySelector('link[rel="preload"][as="style"]['+e+"]")?i.loading=1:(e=n.createElement("link"),i.preload=e,e.addEventListener("load",function(){return i.loading|=1}),e.addEventListener("error",function(){return i.loading|=2}),Pi(e,"link",t),vi(e),n.head.appendChild(e))}function xg(n){return'[src="'+Or(n)+'"]'}function hy(n){return"script[async]"+n}function Nk(n,e,t){if(e.count++,e.instance===null)switch(e.type){case"style":var i=n.querySelector('style[data-href~="'+Or(t.href)+'"]');if(i)return e.instance=i,vi(i),i;var s=yn({},t,{"data-href":t.href,"data-precedence":t.precedence,href:null,precedence:null});return i=(n.ownerDocument||n).createElement("style"),vi(i),Pi(i,"style",s),xv(i,t.precedence,n),e.instance=i;case"stylesheet":s=Jp(t.href);var r=n.querySelector(uy(s));if(r)return e.state.loading|=4,e.instance=r,vi(r),r;i=G5(t),(s=$r.get(s))&&zC(i,s),r=(n.ownerDocument||n).createElement("link"),vi(r);var a=r;return a._p=new Promise(function(o,c){a.onload=o,a.onerror=c}),Pi(r,"link",i),e.state.loading|=4,xv(r,t.precedence,n),e.instance=r;case"script":return r=xg(t.src),(s=n.querySelector(hy(r)))?(e.instance=s,vi(s),s):(i=t,(s=$r.get(r))&&(i=yn({},t),FC(i,s)),n=n.ownerDocument||n,s=n.createElement("script"),vi(s),Pi(s,"link",i),n.head.appendChild(s),e.instance=s);case"void":return null;default:throw Error(Ce(443,e.type))}else e.type==="stylesheet"&&!(e.state.loading&4)&&(i=e.instance,e.state.loading|=4,xv(i,t.precedence,n));return e.instance}function xv(n,e,t){for(var i=t.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),s=i.length?i[i.length-1]:null,r=s,a=0;a<i.length;a++){var o=i[a];if(o.dataset.precedence===e)r=o;else if(r!==s)break}r?r.parentNode.insertBefore(n,r.nextSibling):(e=t.nodeType===9?t.head:t,e.insertBefore(n,e.firstChild))}function zC(n,e){n.crossOrigin==null&&(n.crossOrigin=e.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=e.referrerPolicy),n.title==null&&(n.title=e.title)}function FC(n,e){n.crossOrigin==null&&(n.crossOrigin=e.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=e.referrerPolicy),n.integrity==null&&(n.integrity=e.integrity)}var yv=null;function _k(n,e,t){if(yv===null){var i=new Map,s=yv=new Map;s.set(t,i)}else s=yv,i=s.get(t),i||(i=new Map,s.set(t,i));if(i.has(n))return i;for(i.set(n,null),t=t.getElementsByTagName(n),s=0;s<t.length;s++){var r=t[s];if(!(r[sy]||r[Ri]||n==="link"&&r.getAttribute("rel")==="stylesheet")&&r.namespaceURI!=="http://www.w3.org/2000/svg"){var a=r.getAttribute(e)||"";a=n+a;var o=i.get(a);o?o.push(r):i.set(a,[r])}}return i}function kk(n,e,t){n=n.ownerDocument||n,n.head.insertBefore(t,e==="title"?n.querySelector("head > title"):null)}function Oz(n,e,t){if(t===1||e.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof e.precedence!="string"||typeof e.href!="string"||e.href==="")break;return!0;case"link":if(typeof e.rel!="string"||typeof e.href!="string"||e.href===""||e.onLoad||e.onError)break;switch(e.rel){case"stylesheet":return n=e.disabled,typeof e.precedence=="string"&&n==null;default:return!0}case"script":if(e.async&&typeof e.async!="function"&&typeof e.async!="symbol"&&!e.onLoad&&!e.onError&&e.src&&typeof e.src=="string")return!0}return!1}function W5(n){return!(n.type==="stylesheet"&&!(n.state.loading&3))}function Pz(n,e,t,i){if(t.type==="stylesheet"&&(typeof i.media!="string"||matchMedia(i.media).matches!==!1)&&!(t.state.loading&4)){if(t.instance===null){var s=Jp(i.href),r=e.querySelector(uy(s));if(r){e=r._p,e!==null&&typeof e=="object"&&typeof e.then=="function"&&(n.count++,n=Mb.bind(n),e.then(n,n)),t.state.loading|=4,t.instance=r,vi(r);return}r=e.ownerDocument||e,i=G5(i),(s=$r.get(s))&&zC(i,s),r=r.createElement("link"),vi(r);var a=r;a._p=new Promise(function(o,c){a.onload=o,a.onerror=c}),Pi(r,"link",i),t.instance=r}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(t,e),(e=t.state.preload)&&!(t.state.loading&3)&&(n.count++,t=Mb.bind(n),e.addEventListener("load",t),e.addEventListener("error",t))}}var y2=0;function Iz(n,e){return n.stylesheets&&n.count===0&&vv(n,n.stylesheets),0<n.count||0<n.imgCount?function(t){var i=setTimeout(function(){if(n.stylesheets&&vv(n,n.stylesheets),n.unsuspend){var r=n.unsuspend;n.unsuspend=null,r()}},6e4+e);0<n.imgBytes&&y2===0&&(y2=62500*xz());var s=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&vv(n,n.stylesheets),n.unsuspend)){var r=n.unsuspend;n.unsuspend=null,r()}},(n.imgBytes>y2?50:800)+e);return n.unsuspend=t,function(){n.unsuspend=null,clearTimeout(i),clearTimeout(s)}}:null}function Mb(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)vv(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var Ob=null;function vv(n,e){n.stylesheets=null,n.unsuspend!==null&&(n.count++,Ob=new Map,e.forEach(Bz,n),Ob=null,Mb.call(n))}function Bz(n,e){if(!(e.state.loading&4)){var t=Ob.get(n);if(t)var i=t.get(null);else{t=new Map,Ob.set(n,t);for(var s=n.querySelectorAll("link[data-precedence],style[data-precedence]"),r=0;r<s.length;r++){var a=s[r];(a.nodeName==="LINK"||a.getAttribute("media")!=="not all")&&(t.set(a.dataset.precedence,a),i=a)}i&&t.set(null,i)}s=e.instance,a=s.getAttribute("data-precedence"),r=t.get(a)||i,r===i&&t.set(null,s),t.set(a,s),this.count++,i=Mb.bind(this),s.addEventListener("load",i),s.addEventListener("error",i),r?r.parentNode.insertBefore(s,r.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(s,n.firstChild)),e.state.loading|=4}}var Vm={$$typeof:ol,Provider:null,Consumer:null,_currentValue:Bh,_currentValue2:Bh,_threadCount:0};function zz(n,e,t,i,s,r,a,o,c){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Uw(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Uw(0),this.hiddenUpdates=Uw(null),this.identifierPrefix=i,this.onUncaughtError=s,this.onCaughtError=r,this.onRecoverableError=a,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=c,this.incompleteTransitions=new Map}function Y5(n,e,t,i,s,r,a,o,c,h,d,f){return n=new zz(n,e,t,a,c,h,d,f,o),e=1,r===!0&&(e|=24),r=nr(3,null,null,e),n.current=r,r.stateNode=n,e=dC(),e.refCount++,n.pooledCache=e,e.refCount++,r.memoizedState={element:i,isDehydrated:t,cache:e},gC(r),n}function X5(n){return n?(n=Kd,n):Kd}function K5(n,e,t,i,s,r){s=X5(s),i.context===null?i.context=s:i.pendingContext=s,i=Gc(e),i.payload={element:t},r=r===void 0?null:r,r!==null&&(i.callback=r),t=Wc(n,i,e),t!==null&&(Es(t,n,e),Sm(t,n,e))}function Tk(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function UC(n,e){Tk(n,e),(n=n.alternate)&&Tk(n,e)}function Z5(n){if(n.tag===13||n.tag===31){var e=sd(n,67108864);e!==null&&Es(e,n,67108864),UC(n,67108864)}}function Dk(n){if(n.tag===13||n.tag===31){var e=lr();e=QE(e);var t=sd(n,e);t!==null&&Es(t,n,e),UC(n,e)}}var Pb=!0;function Fz(n,e,t,i){var s=ot.T;ot.T=null;var r=Ft.p;try{Ft.p=2,HC(n,e,t,i)}finally{Ft.p=r,ot.T=s}}function Uz(n,e,t,i){var s=ot.T;ot.T=null;var r=Ft.p;try{Ft.p=8,HC(n,e,t,i)}finally{Ft.p=r,ot.T=s}}function HC(n,e,t,i){if(Pb){var s=YS(i);if(s===null)m2(n,e,i,Ib,t),jk(n,i);else if($z(s,n,e,t,i))i.stopPropagation();else if(jk(n,i),e&4&&-1<Hz.indexOf(n)){for(;s!==null;){var r=dg(s);if(r!==null)switch(r.tag){case 3:if(r=r.stateNode,r.current.memoizedState.isDehydrated){var a=mu(r.pendingLanes);if(a!==0){var o=r;for(o.pendingLanes|=2,o.entangledLanes|=2;a;){var c=1<<31-or(a);o.entanglements[1]|=c,a&=~c}co(r),!(Bt&6)&&(Nb=rr()+500,cy(0))}}break;case 31:case 13:o=sd(r,2),o!==null&&Es(o,r,2),W1(),UC(r,2)}if(r=YS(i),r===null&&m2(n,e,i,Ib,t),r===s)break;s=r}s!==null&&i.stopPropagation()}else m2(n,e,i,null,t)}}function YS(n){return n=nC(n),$C(n)}var Ib=null;function $C(n){if(Ib=null,n=qd(n),n!==null){var e=ey(n);if(e===null)n=null;else{var t=e.tag;if(t===13){if(n=xj(e),n!==null)return n;n=null}else if(t===31){if(n=yj(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null)}}return Ib=n,null}function Q5(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(_I()){case Sj:return 2;case Aj:return 8;case db:case kI:return 32;case Ej:return 268435456;default:return 32}default:return 32}}var XS=!1,Kc=null,Zc=null,Qc=null,Gm=new Map,Wm=new Map,Ul=[],Hz="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function jk(n,e){switch(n){case"focusin":case"focusout":Kc=null;break;case"dragenter":case"dragleave":Zc=null;break;case"mouseover":case"mouseout":Qc=null;break;case"pointerover":case"pointerout":Gm.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Wm.delete(e.pointerId)}}function Rg(n,e,t,i,s,r){return n===null||n.nativeEvent!==r?(n={blockedOn:e,domEventName:t,eventSystemFlags:i,nativeEvent:r,targetContainers:[s]},e!==null&&(e=dg(e),e!==null&&Z5(e)),n):(n.eventSystemFlags|=i,e=n.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),n)}function $z(n,e,t,i,s){switch(e){case"focusin":return Kc=Rg(Kc,n,e,t,i,s),!0;case"dragenter":return Zc=Rg(Zc,n,e,t,i,s),!0;case"mouseover":return Qc=Rg(Qc,n,e,t,i,s),!0;case"pointerover":var r=s.pointerId;return Gm.set(r,Rg(Gm.get(r)||null,n,e,t,i,s)),!0;case"gotpointercapture":return r=s.pointerId,Wm.set(r,Rg(Wm.get(r)||null,n,e,t,i,s)),!0}return!1}function J5(n){var e=qd(n.target);if(e!==null){var t=ey(e);if(t!==null){if(e=t.tag,e===13){if(e=xj(t),e!==null){n.blockedOn=e,g_(n.priority,function(){Dk(t)});return}}else if(e===31){if(e=yj(t),e!==null){n.blockedOn=e,g_(n.priority,function(){Dk(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function bv(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=YS(n.nativeEvent);if(t===null){t=n.nativeEvent;var i=new t.constructor(t.type,t);fS=i,t.target.dispatchEvent(i),fS=null}else return e=dg(t),e!==null&&Z5(e),n.blockedOn=t,!1;e.shift()}return!0}function Rk(n,e,t){bv(n)&&t.delete(e)}function qz(){XS=!1,Kc!==null&&bv(Kc)&&(Kc=null),Zc!==null&&bv(Zc)&&(Zc=null),Qc!==null&&bv(Qc)&&(Qc=null),Gm.forEach(Rk),Wm.forEach(Rk)}function Hy(n,e){n.blockedOn===e&&(n.blockedOn=null,XS||(XS=!0,ci.unstable_scheduleCallback(ci.unstable_NormalPriority,qz)))}var $y=null;function Lk(n){$y!==n&&($y=n,ci.unstable_scheduleCallback(ci.unstable_NormalPriority,function(){$y===n&&($y=null);for(var e=0;e<n.length;e+=3){var t=n[e],i=n[e+1],s=n[e+2];if(typeof i!="function"){if($C(i||t)===null)continue;break}var r=dg(t);r!==null&&(n.splice(e,3),e-=3,TS(r,{pending:!0,data:s,method:t.method,action:i},i,s))}}))}function eg(n){function e(c){return Hy(c,n)}Kc!==null&&Hy(Kc,n),Zc!==null&&Hy(Zc,n),Qc!==null&&Hy(Qc,n),Gm.forEach(e),Wm.forEach(e);for(var t=0;t<Ul.length;t++){var i=Ul[t];i.blockedOn===n&&(i.blockedOn=null)}for(;0<Ul.length&&(t=Ul[0],t.blockedOn===null);)J5(t),t.blockedOn===null&&Ul.shift();if(t=(n.ownerDocument||n).$$reactFormReplay,t!=null)for(i=0;i<t.length;i+=3){var s=t[i],r=t[i+1],a=s[Ns]||null;if(typeof r=="function")a||Lk(t);else if(a){var o=null;if(r&&r.hasAttribute("formAction")){if(s=r,a=r[Ns]||null)o=a.formAction;else if($C(s)!==null)continue}else o=a.action;typeof o=="function"?t[i+1]=o:(t.splice(i,3),i-=3),Lk(t)}}}function eR(){function n(r){r.canIntercept&&r.info==="react-transition"&&r.intercept({handler:function(){return new Promise(function(a){return s=a})},focusReset:"manual",scroll:"manual"})}function e(){s!==null&&(s(),s=null),i||setTimeout(t,20)}function t(){if(!i&&!navigation.transition){var r=navigation.currentEntry;r&&r.url!=null&&navigation.navigate(r.url,{state:r.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var i=!1,s=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",e),navigation.addEventListener("navigateerror",e),setTimeout(t,100),function(){i=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",e),navigation.removeEventListener("navigateerror",e),s!==null&&(s(),s=null)}}}function qC(n){this._internalRoot=n}K1.prototype.render=qC.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(Ce(409));var t=e.current,i=lr();K5(t,i,n,e,null,null)};K1.prototype.unmount=qC.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;K5(n.current,2,null,n,null,null),W1(),e[hg]=null}};function K1(n){this._internalRoot=n}K1.prototype.unstable_scheduleHydration=function(n){if(n){var e=Tj();n={blockedOn:null,target:n,priority:e};for(var t=0;t<Ul.length&&e!==0&&e<Ul[t].priority;t++);Ul.splice(t,0,n),t===0&&J5(n)}};var Mk=gj.version;if(Mk!=="19.2.4")throw Error(Ce(527,Mk,"19.2.4"));Ft.findDOMNode=function(n){var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(Ce(188)):(n=Object.keys(n).join(","),Error(Ce(268,n)));return n=bI(e),n=n!==null?vj(n):null,n=n===null?null:n.stateNode,n};var Vz={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:ot,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var qy=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!qy.isDisabled&&qy.supportsFiber)try{ty=qy.inject(Vz),ar=qy}catch{}}L1.createRoot=function(n,e){if(!mj(n))throw Error(Ce(299));var t=!1,i="",s=V3,r=G3,a=W3;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onUncaughtError!==void 0&&(s=e.onUncaughtError),e.onCaughtError!==void 0&&(r=e.onCaughtError),e.onRecoverableError!==void 0&&(a=e.onRecoverableError)),e=Y5(n,1,!1,null,null,t,i,null,s,r,a,eR),n[hg]=e.current,BC(n),new qC(e)};L1.hydrateRoot=function(n,e,t){if(!mj(n))throw Error(Ce(299));var i=!1,s="",r=V3,a=G3,o=W3,c=null;return t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onUncaughtError!==void 0&&(r=t.onUncaughtError),t.onCaughtError!==void 0&&(a=t.onCaughtError),t.onRecoverableError!==void 0&&(o=t.onRecoverableError),t.formState!==void 0&&(c=t.formState)),e=Y5(n,1,!0,e,t??null,i,s,c,r,a,o,eR),e.context=X5(null),t=e.current,i=lr(),i=QE(i),s=Gc(i),s.callback=null,Wc(t,s,i),t=i,e.current.lanes=t,iy(e,t),co(e),n[hg]=e.current,BC(n),new K1(e)};L1.version="19.2.4";function tR(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(tR)}catch(n){console.error(n)}}tR(),cj.exports=L1;var Gz=cj.exports,nR={exports:{}},Z1={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wz=Symbol.for("react.transitional.element"),Yz=Symbol.for("react.fragment");function iR(n,e,t){var i=null;if(t!==void 0&&(i=""+t),e.key!==void 0&&(i=""+e.key),"key"in e){t={};for(var s in e)s!=="key"&&(t[s]=e[s])}else t=e;return e=t.ref,{$$typeof:Wz,type:n,key:i,ref:e!==void 0?e:null,props:t}}Z1.Fragment=Yz;Z1.jsx=iR;Z1.jsxs=iR;nR.exports=Z1;var l=nR.exports;/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sR=(...n)=>n.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xz=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kz=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase());/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ok=n=>{const e=Kz(n);return e.charAt(0).toUpperCase()+e.slice(1)};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Zz={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qz=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0;return!1};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jz=A.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:s="",children:r,iconNode:a,...o},c)=>A.createElement("svg",{ref:c,...Zz,width:e,height:e,stroke:n,strokeWidth:i?Number(t)*24/Number(e):t,className:sR("lucide",s),...!r&&!Qz(o)&&{"aria-hidden":"true"},...o},[...a.map(([h,d])=>A.createElement(h,d)),...Array.isArray(r)?r:[r]]));/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=(n,e)=>{const t=A.forwardRef(({className:i,...s},r)=>A.createElement(Jz,{ref:r,iconNode:e,className:sR(`lucide-${Xz(Ok(n))}`,`lucide-${n}`,i),...s}));return t.displayName=Ok(n),t};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eF=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],tF=Ae("activity",eF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nF=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],tg=Ae("archive",nF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iF=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],sF=Ae("arrow-down",iF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rF=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],ng=Ae("arrow-left",rF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aF=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],oF=Ae("arrow-right",aF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lF=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],v2=Ae("arrow-up-down",lF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cF=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],uF=Ae("arrow-up",cF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hF=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["path",{d:"M20.2 20.2c2.04-2.03.02-7.36-4.5-11.9-4.54-4.52-9.87-6.54-11.9-4.5-2.04 2.03-.02 7.36 4.5 11.9 4.54 4.52 9.87 6.54 11.9 4.5Z",key:"1l2ple"}],["path",{d:"M15.7 15.7c4.52-4.54 6.54-9.87 4.5-11.9-2.03-2.04-7.36-.02-11.9 4.5-4.52 4.54-6.54 9.87-4.5 11.9 2.03 2.04 7.36.02 11.9-4.5Z",key:"1wam0m"}]],dF=Ae("atom",hF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fF=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],KS=Ae("bell",fF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pF=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],qr=Ae("book-open",pF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gF=[["path",{d:"M12 7v6",key:"lw1j43"}],["path",{d:"M15 10H9",key:"o6yqo3"}],["path",{d:"M17 3a2 2 0 0 1 2 2v15a1 1 0 0 1-1.496.868l-4.512-2.578a2 2 0 0 0-1.984 0l-4.512 2.578A1 1 0 0 1 5 20V5a2 2 0 0 1 2-2z",key:"oz39mx"}]],rR=Ae("bookmark-plus",gF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mF=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],VC=Ae("brain",mF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xF=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],yF=Ae("briefcase",xF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vF=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],aR=Ae("building-2",vF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bF=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Ym=Ae("calendar",bF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wF=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],SF=Ae("camera",wF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AF=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],EF=Ae("chart-column",AF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CF=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],yg=Ae("check",CF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NF=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],dy=Ae("chevron-down",NF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _F=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],kF=Ae("chevron-left",_F);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TF=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Q1=Ae("chevron-right",TF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DF=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],vg=Ae("circle-alert",DF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jF=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],RF=Ae("circle-check-big",jF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LF=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Xh=Ae("circle-check",LF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MF=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"10",x2:"10",y1:"15",y2:"9",key:"c1nkhi"}],["line",{x1:"14",x2:"14",y1:"15",y2:"9",key:"h65svq"}]],OF=Ae("circle-pause",MF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PF=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],IF=Ae("circle-question-mark",PF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BF=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],ru=Ae("circle-x",BF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zF=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],ma=Ae("clock",zF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FF=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],jm=Ae("cloud",FF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UF=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],HF=Ae("code",UF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $F=[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],GC=Ae("compass",$F);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qF=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],bg=Ae("copy",qF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VF=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],GF=Ae("dollar-sign",VF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WF=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],xa=Ae("download",WF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YF=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],oR=Ae("ellipsis",YF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XF=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],fy=Ae("external-link",XF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KF=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],ZF=Ae("eye-off",KF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QF=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],lR=Ae("eye",QF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JF=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],El=Ae("file-text",JF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e8=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]],t8=Ae("file-up",e8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n8=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]],Pk=Ae("flame",n8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i8=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],cR=Ae("folder-open",i8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s8=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}],["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"m9 13 3-3 3 3",key:"1pxg3c"}]],r8=Ae("folder-up",s8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a8=[["line",{x1:"6",x2:"10",y1:"11",y2:"11",key:"1gktln"}],["line",{x1:"8",x2:"8",y1:"9",y2:"13",key:"qnk9ow"}],["line",{x1:"15",x2:"15.01",y1:"12",y2:"12",key:"krot7o"}],["line",{x1:"18",x2:"18.01",y1:"10",y2:"10",key:"1lcuu1"}],["path",{d:"M17.32 5H6.68a4 4 0 0 0-3.978 3.59c-.006.052-.01.101-.017.152C2.604 9.416 2 14.456 2 16a3 3 0 0 0 3 3c1 0 1.5-.5 2-1l1.414-1.414A2 2 0 0 1 9.828 16h4.344a2 2 0 0 1 1.414.586L17 18c.5.5 1 1 2 1a3 3 0 0 0 3-3c0-1.545-.604-6.584-.685-7.258-.007-.05-.011-.1-.017-.151A4 4 0 0 0 17.32 5z",key:"mfqc10"}]],Ik=Ae("gamepad-2",a8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o8=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],ad=Ae("globe",o8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l8=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],uR=Ae("graduation-cap",l8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c8=[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]],hR=Ae("hard-drive",c8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u8=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],dR=Ae("hash",u8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h8=[["path",{d:"m9 11-6 6v3h9l3-3",key:"1a3l36"}],["path",{d:"m22 12-4.6 4.6a2 2 0 0 1-2.8 0l-5.2-5.2a2 2 0 0 1 0-2.8L14 4",key:"14a9rk"}]],py=Ae("highlighter",h8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d8=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],fR=Ae("image",d8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f8=[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]],ZS=Ae("inbox",f8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p8=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],pR=Ae("info",p8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g8=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],gR=Ae("key",g8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m8=[["path",{d:"M10 8h.01",key:"1r9ogq"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M14 8h.01",key:"1primd"}],["path",{d:"M16 12h.01",key:"1l6xoz"}],["path",{d:"M18 8h.01",key:"emo2bl"}],["path",{d:"M6 8h.01",key:"x9i8wu"}],["path",{d:"M7 16h10",key:"wp8him"}],["path",{d:"M8 12h.01",key:"czm47f"}],["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}]],x8=Ae("keyboard",m8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y8=[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]],v8=Ae("languages",y8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b8=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],w8=Ae("layers",b8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S8=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],A8=Ae("layout-grid",S8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E8=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],C8=Ae("lightbulb",E8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N8=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],mR=Ae("link",N8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _8=[["path",{d:"M16 5H3",key:"m91uny"}],["path",{d:"M11 12H3",key:"51ecnj"}],["path",{d:"M16 19H3",key:"zzsher"}],["path",{d:"M18 9v6",key:"1twb98"}],["path",{d:"M21 12h-6",key:"bt1uis"}]],k8=Ae("list-plus",_8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T8=[["path",{d:"M13 5h8",key:"a7qcls"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 19h8",key:"c3s6r1"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["rect",{x:"3",y:"4",width:"6",height:"6",rx:"1",key:"cif1o7"}]],b2=Ae("list-todo",T8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D8=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],j8=Ae("list",D8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R8=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],nt=Ae("loader-circle",R8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L8=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],Bk=Ae("mail",L8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M8=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],O8=Ae("message-circle",M8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P8=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}],["path",{d:"M7 11h10",key:"1twpyw"}],["path",{d:"M7 15h6",key:"d9of3u"}],["path",{d:"M7 7h8",key:"af5zfr"}]],xR=Ae("message-square-text",P8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I8=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],so=Ae("message-square",I8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B8=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]],ul=Ae("mic",B8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z8=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],F8=Ae("music",z8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U8=[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]],H8=Ae("network",U8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $8=[["path",{d:"M15 18h-5",key:"95g1m2"}],["path",{d:"M18 14h-8",key:"sponae"}],["path",{d:"M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-4 0v-9a2 2 0 0 1 2-2h2",key:"39pd36"}],["rect",{width:"8",height:"4",x:"10",y:"6",rx:"1",key:"aywv1n"}]],zk=Ae("newspaper",$8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q8=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"m16 15-3-3 3-3",key:"14y99z"}]],J1=Ae("panel-left-close",q8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V8=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"m14 9 3 3-3 3",key:"8010ee"}]],WC=Ae("panel-left-open",V8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G8=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}]],W8=Ae("panel-left",G8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y8=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}],["path",{d:"m8 9 3 3-3 3",key:"12hl5m"}]],ew=Ae("panel-right-close",Y8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X8=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}],["path",{d:"m10 15-3-3 3-3",key:"1pgupc"}]],tw=Ae("panel-right-open",X8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K8=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],Z8=Ae("pause",K8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q8=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],YC=Ae("pencil",Q8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J8=[["path",{d:"M12 17v5",key:"bb1du9"}],["path",{d:"M15 9.34V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H7.89",key:"znwnzq"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M9 9v1.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h11",key:"c9qhm2"}]],eU=Ae("pin-off",J8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tU=[["path",{d:"M12 17v5",key:"bb1du9"}],["path",{d:"M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H8a2 2 0 0 0 0 4 1 1 0 0 1 1 1z",key:"1nkz8b"}]],nU=Ae("pin",tU);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iU=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],sU=Ae("play",iU);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rU=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],ya=Ae("plus",rU);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aU=[["path",{d:"M13 17a1 1 0 1 0-2 0l.5 4.5a0.5 0.5 0 0 0 1 0z",fill:"currentColor",key:"x1mxqr"}],["path",{d:"M16.85 18.58a9 9 0 1 0-9.7 0",key:"d71mpg"}],["path",{d:"M8 14a5 5 0 1 1 8 0",key:"fc81rn"}],["circle",{cx:"12",cy:"11",r:"1",fill:"currentColor",key:"vqiwd"}]],nw=Ae("podcast",aU);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oU=[["path",{d:"M16.247 7.761a6 6 0 0 1 0 8.478",key:"1fwjs5"}],["path",{d:"M19.075 4.933a10 10 0 0 1 0 14.134",key:"ehdyv1"}],["path",{d:"M4.925 19.067a10 10 0 0 1 0-14.134",key:"1q22gi"}],["path",{d:"M7.753 16.239a6 6 0 0 1 0-8.478",key:"r2q7qm"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],lU=Ae("radio",oU);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cU=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],va=Ae("refresh-cw",cU);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uU=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],XC=Ae("rotate-ccw",uU);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hU=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],dU=Ae("rotate-cw",hU);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fU=[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]],pU=Ae("route",fU);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gU=[["path",{d:"M4 11a9 9 0 0 1 9 9",key:"pv89mb"}],["path",{d:"M4 4a16 16 0 0 1 16 16",key:"k0647b"}],["circle",{cx:"5",cy:"19",r:"1",key:"bfqh0e"}]],hu=Ae("rss",gU);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mU=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Fk=Ae("save",mU);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xU=[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"m19 8 3 8a5 5 0 0 1-6 0zV7",key:"zcdpyk"}],["path",{d:"M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1",key:"1yorad"}],["path",{d:"m5 8 3 8a5 5 0 0 1-6 0zV7",key:"eua70x"}],["path",{d:"M7 21h10",key:"1b0cd5"}]],yU=Ae("scale",xU);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vU=[["path",{d:"M15 12h-5",key:"r7krc0"}],["path",{d:"M15 8h-5",key:"1khuty"}],["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",key:"1ph1d7"}]],bU=Ae("scroll-text",vU);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wU=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],wg=Ae("search",wU);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SU=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],AU=Ae("send",SU);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EU=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],Bb=Ae("settings-2",EU);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CU=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],iw=Ae("settings",CU);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NU=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],yR=Ae("share-2",NU);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _U=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],kU=Ae("shopping-cart",_U);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TU=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Jc=Ae("sparkles",TU);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DU=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],jU=Ae("square-check-big",DU);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RU=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],KC=Ae("star",RU);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LU=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],sw=Ae("tag",LU);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MU=[["path",{d:"M13.172 2a2 2 0 0 1 1.414.586l6.71 6.71a2.4 2.4 0 0 1 0 3.408l-4.592 4.592a2.4 2.4 0 0 1-3.408 0l-6.71-6.71A2 2 0 0 1 6 9.172V3a1 1 0 0 1 1-1z",key:"16rjxf"}],["path",{d:"M2 7v6.172a2 2 0 0 0 .586 1.414l6.71 6.71a2.4 2.4 0 0 0 3.191.193",key:"178nd4"}],["circle",{cx:"10.5",cy:"6.5",r:".5",fill:"currentColor",key:"12ikhr"}]],OU=Ae("tags",MU);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PU=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],IU=Ae("target",PU);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BU=[["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}],["path",{d:"M7 10v12",key:"1qc93n"}]],Uk=Ae("thumbs-up",BU);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zU=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Wi=Ae("trash-2",zU);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FU=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],w2=Ae("trending-up",FU);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UU=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],HU=Ae("triangle-alert",UU);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $U=[["path",{d:"m17 2-5 5-5-5",key:"16satq"}],["rect",{width:"20",height:"15",x:"2",y:"7",rx:"2",key:"1e6viu"}]],Hk=Ae("tv",$U);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qU=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],vR=Ae("upload",qU);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VU=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],rw=Ae("user",VU);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GU=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],$k=Ae("users",GU);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WU=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],YU=Ae("video",WU);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XU=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],KU=Ae("volume-2",XU);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZU=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]],QU=Ae("volume-x",ZU);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JU=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Vn=Ae("x",JU);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e9=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],t9=Ae("zap",e9);function Aa({icon:n,label:e,active:t,collapsed:i,count:s,onClick:r}){return l.jsxs("button",{onClick:r,className:`
        relative flex items-center gap-2.5 w-full px-3 py-1.5 rounded-md text-[13px]
        transition-colors duration-150 cursor-pointer outline-none
        ${t?"text-white bg-white/[0.08]":"text-gray-400 hover:bg-white/5 hover:text-gray-200"}
      `,title:i?e:void 0,children:[t&&l.jsx("span",{className:"absolute left-0 top-1/2 -translate-y-1/2 w-[3px] h-4 rounded-r-full bg-blue-500"}),l.jsx("span",{className:"shrink-0",children:n}),!i&&l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"flex-1 text-left truncate font-medium",children:e}),s!==void 0&&l.jsx("span",{className:"text-xs text-gray-500",children:s})]})]})}function qk({label:n,collapsed:e,expanded:t,onToggle:i}){return e?l.jsx("div",{className:"my-2 border-t border-white/5"}):l.jsxs("button",{onClick:i,className:"flex items-center gap-1.5 w-full px-3 mt-4 mb-1 text-[11px] font-bold uppercase tracking-wider text-gray-500 hover:text-gray-400 transition-colors cursor-pointer outline-none",children:[t?l.jsx(dy,{size:12}):l.jsx(Q1,{size:12}),l.jsx("span",{children:n})]})}function n9({collapsed:n,onToggleCollapse:e,activeView:t,onViewChange:i,onAddFeed:s,onAddUrl:r,onSearch:a,onShortcutsHelp:o,onDownloads:c,onPreferences:h,onTasks:d,onNotifications:f,selectedFeedId:p,onFeedSelect:g,selectedTagId:v,onTagSelect:b,refreshTrigger:x}){const{t:m}=Bi(),y=16,[w,E]=A.useState({library:!0,feed:!0}),[S,_]=A.useState({}),[T,j]=A.useState([]),[M,L]=A.useState(!1);A.useEffect(()=>{(async()=>{try{const G=await window.electronAPI.feedList(),W={};G.forEach(J=>{const V=J.category||"uncategorized";W[V]||(W[V]=[]),W[V].push(J)}),_(W)}catch(G){console.error("Failed to load feeds:",G)}})()},[x]),A.useEffect(()=>{(async()=>{try{const G=await window.electronAPI.tagList();j(G)}catch(G){console.error("Failed to load tags:",G)}})()},[t]);const O=B=>{E(G=>({...G,[B]:!G[B]}))};return l.jsx("aside",{className:`
        flex flex-col h-full border-r border-white/5 bg-[#111111]
        transition-[width] duration-200 shrink-0 overflow-hidden
        ${n?"w-0 border-r-0":"w-[220px]"}
      `,children:l.jsxs("div",{className:`flex flex-col h-full min-w-[220px] ${n?"opacity-0":"opacity-100"}`,children:[l.jsxs("div",{className:"flex items-center justify-between px-3 py-1.5 shrink-0",children:[!n&&l.jsx("span",{className:"text-xs font-medium text-gray-500 tracking-tight",children:m("app.name")}),l.jsxs("div",{className:"flex items-center gap-1 ml-auto",children:[l.jsx("button",{onClick:r,className:"p-1 rounded hover:bg-white/10 text-gray-400 hover:text-white transition-colors cursor-pointer",title:m("sidebar.saveUrl"),children:l.jsx(mR,{size:16})}),l.jsx("button",{onClick:s,className:"p-1 rounded hover:bg-white/10 text-gray-400 hover:text-white transition-colors cursor-pointer",title:m("sidebar.addFeed"),children:l.jsx(ya,{size:16})}),l.jsx("button",{onClick:a,className:"p-1 rounded hover:bg-white/10 text-gray-400 hover:text-white transition-colors cursor-pointer",title:m("sidebar.search"),children:l.jsx(wg,{size:16})}),l.jsx("button",{onClick:e,className:"p-1 rounded hover:bg-white/10 text-gray-400 hover:text-white transition-colors cursor-pointer",children:n?l.jsx(W8,{size:16}):l.jsx(J1,{size:16})})]})]}),l.jsxs("nav",{className:"flex-1 overflow-y-auto px-2 mt-1",children:[l.jsx(qk,{label:m("sidebar.library"),collapsed:n,expanded:w.library,onToggle:()=>O("library")}),(n||w.library)&&l.jsxs(l.Fragment,{children:[l.jsx(Aa,{icon:l.jsx(El,{size:y}),label:m("sidebar.articles"),active:t==="library-articles",collapsed:n,onClick:()=>i("library-articles")}),l.jsx(Aa,{icon:l.jsx(qr,{size:y}),label:m("sidebar.books"),active:t==="books",collapsed:n,onClick:()=>i("books")}),l.jsx(Aa,{icon:l.jsx(YU,{size:y}),label:m("sidebar.videos"),active:t==="library-videos",collapsed:n,onClick:()=>i("library-videos")}),l.jsx(Aa,{icon:l.jsx(nw,{size:y}),label:m("sidebar.podcasts"),active:t==="library-podcasts",collapsed:n,onClick:()=>i("library-podcasts")}),l.jsx(Aa,{icon:l.jsx(KC,{size:y}),label:m("sidebar.shortlist"),active:t==="shortlist",collapsed:n,onClick:()=>i("shortlist")}),l.jsx(Aa,{icon:l.jsx(sw,{size:y}),label:m("sidebar.tags"),active:t==="tags"&&!v,collapsed:n,onClick:()=>{L(!M),i("tags"),b==null||b(null)}}),!n&&M&&T.map(B=>l.jsxs("button",{onClick:()=>{b==null||b(B.id),i("tags")},className:`
                  relative flex items-center gap-2.5 w-full pl-9 pr-3 py-1.5 rounded-md text-[13px]
                  transition-colors duration-150 cursor-pointer outline-none
                  ${v===B.id?"text-white bg-white/[0.08]":"text-gray-400 hover:bg-white/5 hover:text-gray-200"}
                `,children:[v===B.id&&l.jsx("span",{className:"absolute left-0 top-1/2 -translate-y-1/2 w-[3px] h-4 rounded-r-full bg-blue-500"}),l.jsx("span",{className:"flex-1 text-left truncate",children:B.name}),B.articleCount!==void 0&&l.jsx("span",{className:"text-[10px] text-gray-600",children:B.articleCount})]},B.id))]}),l.jsx(qk,{label:m("sidebar.feed"),collapsed:n,expanded:w.feed,onToggle:()=>O("feed")}),(n||w.feed)&&l.jsxs(l.Fragment,{children:[l.jsx(Aa,{icon:l.jsx(GC,{size:y}),label:m("sidebar.discover"),active:t==="discover",collapsed:n,onClick:()=>i("discover")}),l.jsx(Aa,{icon:l.jsx(hu,{size:y}),label:m("sidebar.allFeeds"),active:t==="feeds"&&p===null,collapsed:n,onClick:()=>{i("feeds"),g(null)}}),l.jsx(Aa,{icon:l.jsx(so,{size:y,className:"text-green-500"}),label:"å¾®ä¿¡å…¬ä¼—å·",active:t==="wechat",collapsed:n,onClick:()=>{i("wechat"),g(null)}}),!n&&Object.values(S).flat().filter(B=>B.pinned).map(B=>{var J;const W=!!B.wechatBiz?l.jsx(so,{size:14,className:"text-green-500"}):B.favicon?l.jsx("img",{src:B.favicon,alt:"",className:"w-4 h-4 rounded"}):l.jsx("div",{className:"w-4 h-4 rounded bg-gray-700 flex items-center justify-center text-[10px] text-gray-400",children:((J=B.title)==null?void 0:J.charAt(0).toUpperCase())||"F"});return l.jsxs("button",{onClick:()=>{g(B.id),i("feeds")},className:`
                    group relative flex items-center gap-2.5 w-full pl-9 pr-3 py-1.5 rounded-md text-[13px]
                    transition-colors duration-150 cursor-pointer outline-none
                    ${p===B.id?"text-white bg-white/[0.08]":"text-gray-400 hover:bg-white/5 hover:text-gray-200"}
                  `,title:B.title||B.url,children:[p===B.id&&l.jsx("span",{className:"absolute left-0 top-1/2 -translate-y-1/2 w-[3px] h-4 rounded-r-full bg-blue-500"}),l.jsx("span",{className:"shrink-0",children:W}),l.jsx("span",{className:"flex-1 text-left truncate",children:B.title||B.url})]},`pin-${B.id}`)}),l.jsx(Aa,{icon:l.jsx(oF,{size:y}),label:m("sidebar.manageFeeds"),active:t==="manage-feeds",collapsed:n,onClick:()=>{i("manage-feeds")}})]})]}),l.jsx("div",{className:"px-2 py-2 border-t border-white/5",children:l.jsx("div",{className:"grid grid-cols-2 gap-0.5",children:[{icon:l.jsx(Wi,{size:y}),label:m("sidebar.trash"),onClick:()=>i("trash"),active:t==="trash"},{icon:l.jsx(x8,{size:y}),label:m("sidebar.shortcuts"),onClick:o},{icon:l.jsx(xa,{size:y}),label:m("sidebar.downloads"),onClick:c},{icon:l.jsx(jU,{size:y}),label:"ä»»åŠ¡",onClick:d},{icon:l.jsx(KS,{size:y}),label:"é€šçŸ¥",onClick:f},{icon:l.jsx(iw,{size:y}),label:m("sidebar.preferences"),onClick:h}].map(B=>l.jsxs("button",{onClick:B.onClick,className:`
                flex items-center gap-2.5 px-2 py-1.5 rounded-md text-[13px]
                transition-colors duration-150 cursor-pointer outline-none
                ${B.active?"text-white bg-white/[0.08]":"text-gray-400 hover:bg-white/5 hover:text-gray-200"}
              `,title:B.label,children:[l.jsx("span",{className:"shrink-0",children:B.icon}),!n&&l.jsx("span",{className:"truncate",children:B.label})]},B.label))})})]})})}function i9(n){if(!n)return"";const t=Date.now()-new Date(n).getTime();if(t<0)return"just now";const i=Math.floor(t/1e3);if(i<60)return"just now";const s=Math.floor(i/60);if(s<60)return`${s}m`;const r=Math.floor(s/60);if(r<24)return`${r}h`;const a=Math.floor(r/24);if(a<30)return`${a}d`;const o=Math.floor(a/30);return o<12?`${o}mo`:`${Math.floor(o/12)}y`}function s9(n){return n?n.replace(/^www\./,"").charAt(0).toUpperCase():"?"}function Vk(n){if(!n)return null;const e=Math.floor(n/3600),t=Math.floor(n%3600/60),i=n%60;return e>0?`${e}:${String(t).padStart(2,"0")}:${String(i).padStart(2,"0")}`:`${t}:${String(i).padStart(2,"0")}`}function r9({article:n,isSelected:e,onHover:t,onClick:i,onStatusChange:s,onToggleShortlist:r,trashMode:a,onRestore:o,onPermanentDelete:c,compact:h,multiSelect:d,isChecked:f,onToggleCheck:p,onContextMenu:g,source:v,onSaveToLibrary:b}){const[x,m]=A.useState(!1),y=v==="feed"||n.source==="feed",w=v==="library"||n.source==="library",E=(W,J)=>{W.stopPropagation(),s(n.id,J)},S=W=>{W.stopPropagation(),r==null||r(n.id,n.isShortlisted===1)},_=W=>{W.stopPropagation(),b==null||b(n.id)},T=n.feedTitle||n.domain,j=s9(T),M=i9(n.savedAt||n.publishedAt),L=n.readProgress>=.9||n.readStatus==="archive"||n.readStatus==="seen",O=[];T&&O.push(T.replace(/^www\./,"")),n.author&&O.push(n.author);const B=n.mediaType==="video"||n.mediaType==="podcast",G=n.audioDuration||n.duration;if(B&&G){const W=Vk(G);W&&O.push(W)}else n.readingTime!=null&&n.readingTime>0&&O.push(`${n.readingTime} min`);return l.jsxs("div",{onClick:W=>{d||W.metaKey||W.ctrlKey||W.shiftKey?p==null||p(n.id,W):i(n.id)},onContextMenu:W=>{W.preventDefault(),g==null||g(n.id,W.clientX,W.clientY)},onMouseEnter:()=>{m(!0),t(n.id)},onMouseLeave:()=>m(!1),className:`
        relative flex gap-3 px-4 ${h?"py-2":"py-3"} cursor-pointer transition-colors
        ${e?"border-l-2 border-blue-500 bg-white/[0.04]":"border-l-2 border-transparent hover:bg-white/[0.03]"}
        ${L?"opacity-70":""}
      `,children:[d&&l.jsx("div",{className:"shrink-0 flex items-center",children:l.jsx("div",{className:`w-4 h-4 rounded border flex items-center justify-center transition-colors ${f?"bg-blue-500 border-blue-500":"border-white/20 hover:border-white/40"}`,children:f&&l.jsx(yg,{size:12,className:"text-white"})})}),!h&&l.jsx("div",{className:"shrink-0 relative",children:n.thumbnail?l.jsxs(l.Fragment,{children:[l.jsx("img",{src:n.thumbnail,alt:"",className:`w-14 h-14 rounded-md object-cover ${L?"opacity-60":""}`}),B&&G&&l.jsx("span",{className:"absolute bottom-1 right-1 px-1 py-0.5 bg-black/80 text-white text-[10px] font-medium rounded",children:Vk(G)})]}):l.jsx("div",{className:`w-14 h-14 rounded-md bg-white/[0.06] flex items-center justify-center text-base font-semibold ${L?"text-gray-600":"text-gray-500"}`,children:j})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex items-start justify-between gap-2",children:[l.jsx("h3",{className:`text-[14px] font-medium truncate leading-snug ${L?"text-gray-500":"text-gray-100"}`,children:n.title||"Untitled"}),!x&&M&&l.jsx("span",{className:"shrink-0 text-[11px] text-gray-500 pt-0.5",children:M})]}),!h&&n.summary&&l.jsx("p",{className:`mt-0.5 text-[13px] leading-snug line-clamp-2 ${L?"text-gray-600":"text-gray-500"}`,children:n.summary}),O.length>0&&l.jsxs("div",{className:"mt-1.5 flex items-center gap-1.5 text-[11px] text-gray-500",children:[l.jsx("span",{className:"shrink-0 w-4 h-4 rounded bg-white/[0.08] flex items-center justify-center text-[10px] font-medium text-gray-400",children:j}),O.map((W,J)=>l.jsxs("span",{className:"flex items-center gap-1.5",children:[J>0&&l.jsx("span",{className:"text-gray-600",children:"Â·"}),l.jsx("span",{className:"truncate max-w-[120px]",children:W})]},J))]})]}),x&&l.jsx("div",{className:"absolute right-3 top-2.5 flex items-center gap-0.5 bg-[#1e1e1e] border border-white/10 rounded-md px-0.5 py-0.5 shadow-lg",children:a?l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:W=>{W.stopPropagation(),o==null||o(n.id)},className:"p-1 rounded hover:bg-white/10 text-gray-400 hover:text-green-400 transition-colors",title:"Restore",children:l.jsx(XC,{size:14})}),l.jsx("button",{onClick:W=>{W.stopPropagation(),c==null||c(n.id)},className:"p-1 rounded hover:bg-white/10 text-gray-400 hover:text-red-400 transition-colors",title:"Permanently Delete",children:l.jsx(Wi,{size:14})})]}):l.jsxs(l.Fragment,{children:[y&&b&&l.jsx("button",{onClick:_,className:"p-1 rounded hover:bg-white/10 text-gray-400 hover:text-blue-400 transition-colors",title:"Save to Library",children:l.jsx(rR,{size:14})}),l.jsx("button",{onClick:S,className:`p-1 rounded hover:bg-white/10 transition-colors ${n.isShortlisted===1?"text-yellow-400":"text-gray-400 hover:text-white"}`,title:n.isShortlisted===1?"Remove from Shortlist":"Add to Shortlist",children:l.jsx(KC,{size:14,fill:n.isShortlisted===1?"currentColor":"none"})}),w&&l.jsxs(l.Fragment,{children:[n.readStatus!=="archive"&&l.jsx("button",{onClick:W=>E(W,"archive"),className:"p-1 rounded hover:bg-white/10 text-gray-400 hover:text-white transition-colors",title:"Archive",children:l.jsx(tg,{size:14})}),n.readStatus!=="later"&&l.jsx("button",{onClick:W=>E(W,"later"),className:"p-1 rounded hover:bg-white/10 text-gray-400 hover:text-white transition-colors",title:"Read Later",children:l.jsx(ma,{size:14})})]}),l.jsx("button",{className:"p-1 rounded hover:bg-white/10 text-gray-400 hover:text-white transition-colors",title:"More",children:l.jsx(oR,{size:14})})]})}),n.readProgress>0&&l.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-[2px] bg-white/5",children:l.jsx("div",{className:"h-full bg-violet-500 transition-all",style:{width:`${Math.min(n.readProgress*100,100)}%`}})})]})}const a9=()=>{},bR=A.createContext({showToast:a9}),Sa=()=>A.useContext(bR);function o9({toast:n,onRemove:e}){return A.useEffect(()=>{const t=setTimeout(()=>e(n.id),n.duration);return()=>clearTimeout(t)},[n.id,n.duration,e]),l.jsx("div",{className:"bg-[#1e1e1e] border border-white/10 rounded-lg px-4 py-2.5 shadow-lg transition-all duration-300 ease-out",style:{opacity:n.visible?1:0,transform:n.visible?"translateY(0)":"translateY(8px)"},children:l.jsx("span",{className:"text-sm text-gray-200",children:n.message})})}function l9({children:n}){const[e,t]=A.useState([]),i=A.useCallback(r=>{t(a=>a.map(o=>o.id===r?{...o,visible:!1}:o)),setTimeout(()=>{t(a=>a.filter(o=>o.id!==r))},300)},[]),s=A.useCallback((r,a="info")=>{const o=crypto.randomUUID();t(c=>[...c,{id:o,message:r,type:a,duration:3e3,visible:!1}].slice(-3)),requestAnimationFrame(()=>{t(c=>c.map(h=>h.id===o?{...h,visible:!0}:h))})},[]);return l.jsxs(bR.Provider,{value:{showToast:s},children:[n,e.length>0&&l.jsx("div",{className:"fixed bottom-6 left-1/2 -translate-x-1/2 z-50 flex flex-col-reverse items-center gap-2",children:e.map(r=>l.jsx(o9,{toast:r,onRemove:i},r.id))})]})}function wR(){const[n,e]=A.useState([]),t=A.useCallback(a=>{e(o=>[...o.slice(-19),a])},[]),i=A.useCallback(async()=>{const a=n[n.length-1];a&&(e(o=>o.slice(0,-1)),await a.undo())},[n]),s=n.length>0,r=n.length>0?n[n.length-1]:null;return{push:t,undo:i,canUndo:s,lastAction:r}}function c9({x:n,y:e,items:t,onClose:i}){const s=A.useRef(null);return A.useEffect(()=>{const r=o=>{s.current&&!s.current.contains(o.target)&&i()},a=o=>{o.key==="Escape"&&(o.stopImmediatePropagation(),i())};return document.addEventListener("mousedown",r),document.addEventListener("keydown",a),()=>{document.removeEventListener("mousedown",r),document.removeEventListener("keydown",a)}},[i]),A.useEffect(()=>{if(!s.current)return;const r=s.current.getBoundingClientRect(),a=window.innerWidth,o=window.innerHeight;r.right>a&&(s.current.style.left=`${n-r.width}px`),r.bottom>o&&(s.current.style.top=`${e-r.height}px`)},[n,e]),l.jsx("div",{ref:s,className:"fixed z-50 min-w-[180px] bg-[#1e1e1e] border border-white/10 rounded-lg shadow-xl py-1 backdrop-blur-sm",style:{left:n,top:e},children:t.map((r,a)=>{if(r.separator)return l.jsx("div",{className:"my-1 border-t border-white/10"},a);const o=r.icon;return l.jsxs("button",{onClick:()=>{r.onClick(),i()},className:`
              w-full flex items-center gap-2 px-3 py-1.5 text-[13px] text-left transition-colors cursor-pointer
              ${r.danger?"text-red-400 hover:bg-red-500/10":"text-gray-300 hover:bg-white/10 hover:text-white"}
            `,children:[o&&l.jsx(o,{size:14}),l.jsx("span",{children:r.label})]},a)})})}const S2=100,u9=[{key:"saved_at",label:"Date saved"},{key:"published_at",label:"Date published"}];function h9({selectedArticleId:n,onSelectArticle:e,onOpenReader:t,refreshTrigger:i,feedId:s,isShortlisted:r,activeView:a,tagId:o,expanded:c,source:h,initialTab:d,mediaType:f,feedType:p}){var K;const{t:g}=Bi(),[v,b]=A.useState(()=>{if(d)return d;const C=h==="feed"?"z-reader-tab-feed":"z-reader-tab-library";return localStorage.getItem(C)||"inbox"}),[x,m]=A.useState("saved_at"),[y,w]=A.useState("desc"),[E,S]=A.useState(()=>localStorage.getItem("z-reader-view-mode")||"default"),[_,T]=A.useState([]),[j,M]=A.useState(!1),[L,O]=A.useState(!1),[B,G]=A.useState(!0),[W,J]=A.useState(new Set),[V,H]=A.useState(null),[P,Y]=A.useState(null),[ge,ae]=A.useState(10),{showToast:ee}=Sa(),le=wR(),ie=a==="trash",Q=h==="feed",Z=h==="library";A.useEffect(()=>{window.electronAPI.settingsGet().then(C=>{C.readingThreshold&&C.readingThreshold>0&&ae(C.readingThreshold)}).catch(()=>{})},[]);const re=[{key:"inbox",label:g("contentList.inbox").toUpperCase()},{key:"later",label:g("contentList.later").toUpperCase()},{key:"archive",label:g("contentList.archive").toUpperCase()}],se=[{key:"unseen",label:g("contentList.unseen").toUpperCase()},{key:"seen",label:g("contentList.seen").toUpperCase()},{key:"shortRead",label:g("contentList.shortRead").toUpperCase()},{key:"longRead",label:g("contentList.longRead").toUpperCase()},{key:"all",label:g("contentList.all").toUpperCase()}],be=Q?se:re,pe=!r&&!ie&&!o&&(Q||Z);A.useEffect(()=>{if(d){b(d);return}const C=Q?"z-reader-tab-feed":"z-reader-tab-library",$=localStorage.getItem(C);b($||(Q?"unseen":"inbox"))},[d,Q]),A.useEffect(()=>{const C=Q?"z-reader-tab-feed":"z-reader-tab-library";localStorage.setItem(C,v)},[v,Q]);const me=A.useCallback((C=0)=>{const $={sortBy:x,sortOrder:y,limit:S2,offset:C};return h&&!r&&($.source=h),f&&($.mediaType=f),r||v!=="all"&&v!=="shortRead"&&v!=="longRead"&&(Q||Z)&&($.readStatus=v),s&&($.feedId=s,$.source="feed"),r&&($.isShortlisted=!0),p&&($.feedType=p),$},[x,y,h,r,f,v,Q,Z,s,p]),Ne=A.useCallback(C=>v==="shortRead"?C.filter($=>$.readingTime!=null&&$.readingTime<=ge):v==="longRead"?C.filter($=>$.readingTime!=null&&$.readingTime>ge):C,[v,ge]),ve=A.useCallback(async()=>{M(!0),G(!0);try{if(ie){const C=await window.electronAPI.articleListDeleted();T(C),G(!1)}else if(a==="tags"){if(o){const C=await window.electronAPI.articleListByTag(o);T(C)}else T([]);G(!1)}else{const C=await window.electronAPI.articleList(me(0));T(Ne(C)),G(C.length>=S2)}}catch(C){console.error("Failed to fetch articles:",C)}finally{M(!1)}},[ie,a,o,me,Ne]),_e=A.useCallback(async()=>{if(!(L||!B||ie||a==="tags")){O(!0);try{const C=await window.electronAPI.articleList(me(_.length)),$=Ne(C);T(fe=>[...fe,...$]),G(C.length>=S2)}catch(C){console.error("Failed to load more articles:",C)}finally{O(!1)}}},[L,B,ie,a,me,Ne,_.length]);A.useEffect(()=>{ve()},[ve,i]);const We={archive:g("contentList.archiveArticle"),later:g("contentList.addToShortlist"),inbox:g("contentList.markAsRead"),seen:g("detailPanel.seen")||"Marked as seen",unseen:g("detailPanel.unseen")||"Marked as unseen"},Ie=async(C,$)=>{try{const fe=_.find(oe=>oe.id===C),N=(fe==null?void 0:fe.readStatus)??"inbox";await window.electronAPI.articleUpdate({id:C,readStatus:$}),await ve(),ee(We[$]??`Moved to ${$}`,"success"),le.push({description:`Revert to ${N}`,undo:async()=>{await window.electronAPI.articleUpdate({id:C,readStatus:N}),await ve(),ee("Undone","info")}})}catch(fe){console.error("Failed to update article status:",fe)}},Re=async C=>{try{const $=_.find(N=>N.id===C),fe=($==null?void 0:$.isShortlisted)===1;await window.electronAPI.articleUpdate({id:C,isShortlisted:!fe}),await ve(),ee(fe?"Removed from Shortlist":"Added to Shortlist","success")}catch($){console.error("Failed to toggle shortlist:",$)}},Ze=async C=>{try{await window.electronAPI.articleSaveToLibrary(C),await ve(),ee("Saved to Library","success")}catch($){console.error("Failed to save to library:",$)}},it=async C=>{try{const $=_.findIndex(oe=>oe.id===C),fe=_.filter(oe=>oe.id!==C),N=fe.length>0?fe[Math.min($,fe.length-1)].id:null;await window.electronAPI.articleDelete(C),await ve(),N&&e(N),ee("Moved to Trash","success"),le.push({description:"Undo delete",undo:async()=>{await window.electronAPI.articleRestore(C),await ve(),ee("Restored","info")}})}catch($){console.error("Failed to delete article:",$)}},tt=async C=>{try{await window.electronAPI.articleRestore(C),await ve(),ee("Restored","success")}catch($){console.error("Failed to restore article:",$)}},rt=async C=>{try{await window.electronAPI.articlePermanentDelete(C),await ve(),ee("Permanently deleted","success")}catch($){console.error("Failed to permanently delete article:",$)}},at=A.useCallback(C=>{e(C)},[e]),ze=A.useCallback(async C=>{if(!Q)return;const $=_.find(fe=>fe.id===C);if($&&$.readStatus==="unseen"){T(fe=>fe.map(N=>N.id===C?{...N,readStatus:"seen"}:N));try{await window.electronAPI.articleUpdate({id:C,readStatus:"seen"})}catch(fe){console.error("Failed to mark as seen:",fe)}}},[Q,_]),ft=()=>{w(C=>C==="desc"?"asc":"desc")},Kt=()=>{S(C=>{const $=C==="default"?"compact":"default";return localStorage.setItem("z-reader-view-mode",$),$})},he=W.size>0,X=(C,$)=>{J(fe=>{const N=new Set(fe);if($.shiftKey&&V){const oe=_.map(te=>te.id),xe=oe.indexOf(V),I=oe.indexOf(C);if(xe!==-1&&I!==-1){const[te,ye]=xe<I?[xe,I]:[I,xe];for(let Ke=te;Ke<=ye;Ke++)N.add(oe[Ke])}}else $.metaKey||$.ctrlKey,N.has(C)?N.delete(C):N.add(C);return N}),H(C)},je=()=>{J(new Set(_.map(C=>C.id)))},qe=()=>{J(new Set)},ke=async()=>{if(W.size!==0)try{await window.electronAPI.articleBatchUpdate(Array.from(W),{readStatus:"archive"}),J(new Set),await ve(),ee(`Archived ${W.size} articles`,"success")}catch(C){console.error("Batch archive failed:",C)}},Xe=async()=>{if(W.size!==0)try{await window.electronAPI.articleBatchUpdate(Array.from(W),{readStatus:"later"}),J(new Set),await ve(),ee(`Saved ${W.size} for later`,"success")}catch(C){console.error("Batch later failed:",C)}},ct=async()=>{if(W.size!==0)try{const C=Array.from(W);await window.electronAPI.articleBatchDelete(C),J(new Set),await ve(),ee(`Deleted ${C.length} articles`,"success"),le.push({description:`Undo batch delete ${C.length}`,undo:async()=>{for(const $ of C)await window.electronAPI.articleRestore($);await ve(),ee("Restored","info")}})}catch(C){console.error("Batch delete failed:",C)}},Pe=A.useCallback(C=>{ze(C),t(C)},[ze,t]),Qe=(C,$,fe)=>{e(C),Y({articleId:C,x:$,y:fe})},dt=()=>{if(!P)return[];const C=_.find(N=>N.id===P.articleId);if(!C)return[];if(ie)return[{label:"Restore",icon:ZS,onClick:()=>tt(C.id)},{separator:!0},{label:"Delete permanently",icon:Wi,onClick:()=>rt(C.id),danger:!0}];const $=[{label:"Open in Reader",icon:qr,onClick:()=>t(C.id)},{separator:!0}];(Q||C.source==="feed")&&($.push({label:"Save to Library",icon:rR,onClick:()=>Ze(C.id)}),$.push({separator:!0})),(Z||C.source==="library")&&(C.readStatus!=="inbox"&&$.push({label:"Move to Inbox",icon:ZS,onClick:()=>Ie(C.id,"inbox")}),C.readStatus!=="later"&&$.push({label:"Read later",icon:ma,onClick:()=>Ie(C.id,"later")}),C.readStatus!=="archive"&&$.push({label:"Archive",icon:tg,onClick:()=>Ie(C.id,"archive")}));const fe=C.isShortlisted===1;if($.push({label:fe?"Remove from Shortlist":"Add to Shortlist",icon:KC,onClick:()=>Re(C.id)}),$.push({separator:!0}),$.push({label:"Delete",icon:Wi,onClick:()=>it(C.id),danger:!0}),C.url){const N=C.url;$.push({separator:!0}),$.push({label:"Open in browser",icon:fy,onClick:()=>void window.electronAPI.externalOpenUrl(N)})}return $},z=()=>{m(C=>C==="saved_at"?"published_at":"saved_at")},Se=((K=u9.find(C=>C.key===x))==null?void 0:K.label)??"",Te=A.useRef(null);A.useEffect(()=>{const C=Te.current;if(!C)return;const $=()=>{C.scrollTop+C.clientHeight>=C.scrollHeight-200&&_e()};return C.addEventListener("scroll",$),()=>C.removeEventListener("scroll",$)},[_e]);const Fe=()=>ie?"Trash":r?"Shortlist":o?"Tag":Z?"Library":Q?"Feed":"Articles",F=()=>g(ie?"contentList.emptyTrash":r?"contentList.emptyShortlist":Q?"contentList.noArticles":a==="tags"&&!o||a==="tags"&&o?"contentList.emptyTag":Z?"contentList.emptyLibrary":"contentList.noArticles");return A.useEffect(()=>{const C=$=>{const fe=$.target.tagName;if(!(fe==="INPUT"||fe==="TEXTAREA"))switch($.key){case"Escape":{if(W.size>0){$.preventDefault(),J(new Set);break}break}case"r":case"R":{if($.shiftKey&&n){$.preventDefault();const N=_.find(oe=>oe.id===n);N&&N.readProgress&&N.readProgress>0&&(window.electronAPI.articleUpdate({id:n,readProgress:0}),T(oe=>oe.map(xe=>xe.id===n?{...xe,readProgress:0}:xe)))}break}case"j":case"ArrowDown":{$.preventDefault();const N=_.findIndex(xe=>xe.id===n),oe=N<_.length-1?N+1:N;_[oe]&&e(_[oe].id);break}case"k":case"ArrowUp":{$.preventDefault();const N=_.findIndex(xe=>xe.id===n),oe=N>0?N-1:0;_[oe]&&e(_[oe].id);break}case"Enter":{n&&($.preventDefault(),ze(n),t(n));break}case"1":{$.preventDefault(),b(Q?"unseen":"inbox");break}case"2":{$.preventDefault(),b(Q?"seen":"later");break}case"3":{$.preventDefault(),Q||b("archive");break}case"e":case"E":{$.preventDefault(),n&&Z&&Ie(n,"archive");break}case"l":case"L":{$.preventDefault(),n&&Z&&Ie(n,"later");break}case"b":{$.preventDefault(),n&&Q&&Ze(n);break}case"B":{$.shiftKey&&n&&W.size===0?($.preventDefault(),J(new Set([n]))):$.shiftKey||($.preventDefault(),n&&Q&&Ze(n));break}case"d":case"D":{$.preventDefault(),n&&it(n);break}case"z":case"Z":{$.preventDefault(),le.canUndo&&le.undo();break}case"s":case"S":{$.preventDefault(),n&&Re(n);break}case"f":{$.shiftKey||($.preventDefault(),n&&Re(n));break}case"o":case"O":{if($.preventDefault(),n){const N=_.find(oe=>oe.id===n);N!=null&&N.url&&window.electronAPI.externalOpenUrl(N.url)}break}case"C":{if($.shiftKey&&n){$.preventDefault();const N=_.find(oe=>oe.id===n);N!=null&&N.url&&(navigator.clipboard.writeText(N.url),ee(g("detailPanel.copyUrl"),"success"))}break}}};return document.addEventListener("keydown",C),()=>document.removeEventListener("keydown",C)},[_,n,t,ve,le,W,Q,Z,ze]),A.useEffect(()=>{if(!n||!Te.current)return;const C=Te.current.querySelector(`[data-article-id="${n}"]`);C==null||C.scrollIntoView({block:"nearest"})},[n]),l.jsxs("div",{className:"flex flex-col min-w-[300px] border-r border-[#262626] bg-[#141414] h-full flex-1",children:[l.jsxs("div",{className:"shrink-0",children:[l.jsxs("div",{className:"px-4 pt-4 pb-2 flex items-center justify-between",children:[l.jsx("h2",{className:"text-[13px] font-semibold text-white tracking-wide",children:Fe()}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("button",{onClick:z,className:"flex items-center gap-1 px-1.5 py-0.5 rounded text-[11px] text-[#666] hover:text-[#999] hover:bg-white/5 transition-colors cursor-pointer",title:`Sort by: ${Se}`,children:l.jsx("span",{children:Se})}),l.jsx("button",{onClick:ft,className:"p-1 rounded text-[#666] hover:text-[#999] hover:bg-white/5 transition-colors cursor-pointer",title:y==="desc"?"Newest first":"Oldest first",children:y==="desc"?l.jsx(sF,{size:12}):l.jsx(uF,{size:12})}),l.jsx("button",{onClick:Kt,className:"p-1 rounded text-[#666] hover:text-[#999] hover:bg-white/5 transition-colors cursor-pointer",title:E==="default"?"Compact view":"Default view",children:E==="default"?l.jsx(j8,{size:12}):l.jsx(A8,{size:12})})]})]}),pe&&l.jsx("div",{className:"flex px-4 gap-4 border-b border-[#262626]",children:be.map(C=>l.jsx("button",{onClick:()=>b(C.key),className:`
                  pb-2 text-[11px] font-medium tracking-[0.08em] transition-colors cursor-pointer
                  ${v===C.key?"text-white border-b-2 border-blue-500":"text-[#555] hover:text-[#888] border-b-2 border-transparent"}
                `,children:C.label},C.key))}),!pe&&l.jsx("div",{className:"border-b border-[#262626]"})]}),l.jsxs("div",{ref:Te,className:"flex-1 overflow-y-auto",children:[he&&l.jsxs("div",{className:"sticky top-0 z-10 flex items-center justify-between gap-2 px-4 py-2 bg-blue-500/10 border-b border-blue-500/20",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("span",{className:"text-[12px] text-blue-400 font-medium",children:[W.size," selected"]}),l.jsx("button",{onClick:je,className:"text-[11px] text-blue-400/70 hover:text-blue-400 transition-colors cursor-pointer",children:"Select all"})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[Z&&l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:ke,className:"p-1.5 rounded hover:bg-white/10 text-gray-400 hover:text-white transition-colors cursor-pointer",title:"Archive",children:l.jsx(tg,{size:14})}),l.jsx("button",{onClick:Xe,className:"p-1.5 rounded hover:bg-white/10 text-gray-400 hover:text-white transition-colors cursor-pointer",title:"Read later",children:l.jsx(ma,{size:14})})]}),l.jsx("button",{onClick:ct,className:"p-1.5 rounded hover:bg-white/10 text-gray-400 hover:text-red-400 transition-colors cursor-pointer",title:"Delete",children:l.jsx(Wi,{size:14})}),l.jsx("button",{onClick:qe,className:"p-1.5 rounded hover:bg-white/10 text-gray-400 hover:text-white transition-colors cursor-pointer",title:"Clear selection",children:l.jsx(Vn,{size:14})})]})]}),j&&_.length===0?l.jsx("div",{className:"flex items-center justify-center h-full",children:l.jsx("span",{className:"text-[13px] text-[#555]",children:"Loading..."})}):_.length===0?l.jsx("div",{className:"flex items-center justify-center h-full",children:l.jsx("span",{className:"text-[13px] text-[#555]",children:F()})}):l.jsx("div",{children:_.map(C=>l.jsx("div",{"data-article-id":C.id,className:"border-b border-[#262626]",children:l.jsx(r9,{article:C,isSelected:C.id===n,onHover:at,onClick:Pe,onStatusChange:Ie,onToggleShortlist:$=>Re($),trashMode:ie,onRestore:tt,onPermanentDelete:rt,compact:E==="compact",multiSelect:he,isChecked:W.has(C.id),onToggleCheck:X,onContextMenu:Qe,source:h,onSaveToLibrary:Q?Ze:void 0})},C.id))}),L&&l.jsx("div",{className:"flex items-center justify-center py-3",children:l.jsx("span",{className:"text-[12px] text-[#555]",children:"åŠ è½½æ›´å¤š..."})})]}),l.jsxs("div",{className:"shrink-0 px-4 py-1.5 border-t border-[#262626] text-[11px] text-[#555]",children:[_.length," ",_.length===1?f==="video"?"video":f==="podcast"?"podcast":"article":f==="video"?"videos":f==="podcast"?"podcasts":"articles"]}),P&&l.jsx(c9,{x:P.x,y:P.y,items:dt(),onClose:()=>Y(null)})]})}function d9({articleId:n,onTagsChange:e}){const[t,i]=A.useState([]),[s,r]=A.useState([]),[a,o]=A.useState(""),[c,h]=A.useState(!1),d=A.useRef(null),f=A.useRef(null),p=async()=>{const[y,w]=await Promise.all([window.electronAPI.tagList(),window.electronAPI.articleTagsForArticle(n)]);i(y),r(w)};A.useEffect(()=>{p()},[n]),A.useEffect(()=>{if(!c)return;const y=w=>{f.current&&!f.current.contains(w.target)&&h(!1)};return document.addEventListener("mousedown",y),()=>document.removeEventListener("mousedown",y)},[c]);const g=t.filter(y=>!s.some(w=>w.id===y.id)&&y.name.toLowerCase().includes(a.toLowerCase())),v=async y=>{await window.electronAPI.articleTagAdd(n,y),await p(),o(""),e==null||e()},b=async y=>{await window.electronAPI.articleTagRemove(n,y),await p(),e==null||e()},x=async()=>{const y=a.trim();if(!y)return;const w=await window.electronAPI.tagCreate(y);await window.electronAPI.articleTagAdd(n,w.id),await p(),o(""),e==null||e()},m=y=>{y.key==="Enter"&&(y.preventDefault(),g.length>0?v(g[0].id):a.trim()&&x()),y.key==="Escape"&&h(!1)};return l.jsxs("div",{ref:f,className:"relative",children:[l.jsxs("div",{className:"flex flex-wrap gap-1.5 mb-1.5",children:[s.map(y=>l.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-[11px] bg-blue-500/15 text-blue-400 border border-blue-500/20",children:[y.name,l.jsx("button",{onClick:()=>b(y.id),className:"hover:text-white transition-colors",children:l.jsx(Vn,{size:10})})]},y.id)),l.jsxs("button",{onClick:()=>{h(!0),setTimeout(()=>{var y;return(y=d.current)==null?void 0:y.focus()},50)},className:"inline-flex items-center gap-0.5 px-1.5 py-0.5 rounded-full text-[11px] text-gray-500 hover:text-gray-300 hover:bg-white/5 transition-colors",children:[l.jsx(ya,{size:10}),l.jsx("span",{children:"Add tag"})]})]}),c&&l.jsxs("div",{className:"absolute z-50 left-0 top-full mt-1 w-[200px] bg-[#1e1e1e] border border-white/10 rounded-lg shadow-xl",children:[l.jsx("input",{ref:d,value:a,onChange:y=>o(y.target.value),onKeyDown:m,placeholder:"Search or create tag...",className:"w-full px-3 py-2 bg-transparent text-[12px] text-white placeholder-gray-500 border-b border-white/10 outline-none"}),l.jsxs("div",{className:"max-h-[160px] overflow-y-auto py-1",children:[g.map(y=>l.jsxs("button",{onClick:()=>v(y.id),className:"w-full flex items-center justify-between px-3 py-1.5 text-[12px] text-gray-300 hover:bg-white/5 transition-colors text-left",children:[l.jsx("span",{children:y.name}),y.articleCount!==void 0&&l.jsx("span",{className:"text-[10px] text-gray-600",children:y.articleCount})]},y.id)),g.length===0&&a.trim()&&l.jsxs("button",{onClick:x,className:"w-full flex items-center gap-1.5 px-3 py-1.5 text-[12px] text-blue-400 hover:bg-white/5 transition-colors text-left",children:[l.jsx(ya,{size:12}),l.jsxs("span",{children:['Create "',a.trim(),'"']})]}),g.length===0&&!a.trim()&&l.jsx("p",{className:"px-3 py-2 text-[11px] text-gray-600",children:"No tags available"})]})]})]})}function SR(n){let e=n;e=e.replace(/```(\w*)\n?([\s\S]*?)```/g,(a,o,c)=>`<pre class="my-2 p-2 rounded bg-white/5 text-[12px] leading-[1.5] overflow-x-auto"><code>${AR(c.trimEnd())}</code></pre>`);const t=e.split(`
`),i=[];let s=!1,r=!1;for(const a of t){if(a.includes("<pre class=")&&(r=!0),r){s&&(i.push("</ul>"),s=!1),i.push(a),a.includes("</pre>")&&(r=!1);continue}const o=a.match(/^[\s]*[-*]\s+(.+)/);if(o){s||(i.push('<ul class="list-disc list-inside my-1 space-y-0.5">'),s=!0),i.push(`<li>${Gk(o[1])}</li>`);continue}if(s&&(i.push("</ul>"),s=!1),a.trim()===""){i.push("<br/>");continue}i.push(`<p class="my-0.5">${Gk(a)}</p>`)}return s&&i.push("</ul>"),i.join("")}function Gk(n){let e=AR(n);return e=e.replace(/\*\*(.+?)\*\*/g,'<strong class="font-semibold text-white">$1</strong>'),e=e.replace(/`([^`]+)`/g,'<code class="px-1 py-0.5 rounded bg-white/10 text-[12px] text-blue-300">$1</code>'),e}function AR(n){return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function ER({iconKey:n,className:e}){return n==="compass"?l.jsx(GC,{className:e}):n==="lightbulb"?l.jsx(C8,{className:e}):n==="atom"?l.jsx(dF,{className:e}):n==="help-circle"?l.jsx(IF,{className:e}):n==="graduation-cap"?l.jsx(uR,{className:e}):n==="brain"?l.jsx(VC,{className:e}):n==="target"?l.jsx(IU,{className:e}):n==="scale"?l.jsx(yU,{className:e}):n==="book-open"?l.jsx(qr,{className:e}):n==="briefcase"?l.jsx(yF,{className:e}):n==="sparkles"?l.jsx(Jc,{className:e}):l.jsx(so,{className:e})}function f9({onSelectPreset:n,presets:e,loading:t}){const{t:i}=Bi();return l.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center px-2",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[l.jsx(so,{className:"w-5 h-5 text-gray-600 opacity-30"}),l.jsx("p",{className:"text-sm text-gray-500",children:i("chat.empty")})]}),t?l.jsx("div",{className:"flex items-center justify-center py-6",children:l.jsx(nt,{className:"w-4 h-4 animate-spin text-gray-500"})}):e.length>0?l.jsx("div",{className:"grid grid-cols-2 gap-2 w-full",children:e.map(s=>l.jsxs("button",{onClick:()=>n(s.prompt),className:"flex flex-col items-start gap-1.5 p-2.5 rounded-lg bg-[#1a1a1a] border border-white/5 hover:border-white/15 transition-colors cursor-pointer text-left group",children:[l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsx(ER,{iconKey:s.iconKey,className:"w-4 h-4 text-blue-400"}),l.jsx("span",{className:"text-[12px] font-medium text-gray-300 group-hover:text-white transition-colors",children:s.title})]}),l.jsx("span",{className:"text-[11px] text-gray-600 leading-tight line-clamp-2",children:s.prompt})]},s.id))}):null,l.jsx("p",{className:"text-[11px] text-gray-600 mt-3",children:i("chat.analysisHint")})]})}function p9({presets:n,onSelectPreset:e,disabled:t}){return l.jsx("div",{className:"flex gap-1.5 overflow-x-auto pb-1",style:{scrollbarWidth:"none"},children:n.map(i=>l.jsxs("button",{onClick:()=>e(i.prompt),disabled:t,className:"shrink-0 flex items-center gap-1 px-2 py-1 rounded-full border text-[11px] transition-colors cursor-pointer disabled:opacity-40 disabled:cursor-not-allowed bg-blue-500/10 text-blue-300 border-blue-500/20 hover:bg-blue-500/20",children:[l.jsx(ER,{iconKey:i.iconKey,className:"w-3 h-3"}),i.title]},i.id))})}function g9(){const{t:n}=Bi();return l.jsx("div",{className:"flex-1 flex items-center justify-center",children:l.jsxs("div",{className:"text-center text-gray-500 px-6",children:[l.jsx(iw,{className:"w-8 h-8 mx-auto mb-2 opacity-30"}),l.jsx("p",{className:"text-sm",children:n("ai.configureApiKey")})]})})}function m9({message:n}){const{t:e}=Bi(),[t,i]=A.useState(!1),s=n.role==="user";return l.jsx("div",{className:`flex ${s?"justify-end":"justify-start"}`,children:l.jsxs("div",{className:`
          max-w-[85%] rounded-lg px-3 py-2 text-[13px] leading-[1.6]
          ${s?"bg-blue-600 text-white":"bg-[#1a1a1a] border border-white/5 text-gray-300"}
        `,children:[s?l.jsx("p",{className:"whitespace-pre-wrap break-words",children:n.content}):l.jsx("div",{className:"prose-chat break-words",dangerouslySetInnerHTML:{__html:SR(n.content)}}),n.toolCalls&&n.toolCalls.length>0&&l.jsxs("div",{className:"mt-2 border-t border-white/10 pt-1.5",children:[l.jsxs("button",{onClick:()=>i(!t),className:"flex items-center gap-1 text-[11px] text-gray-500 hover:text-gray-300 transition-colors cursor-pointer",children:[t?l.jsx(dy,{className:"w-3 h-3"}):l.jsx(Q1,{className:"w-3 h-3"}),l.jsx("span",{children:e("chat.toolCalling",{name:`${n.toolCalls.length} tools`})})]}),t&&l.jsx("div",{className:"mt-1.5 space-y-1",children:n.toolCalls.map((r,a)=>l.jsxs("div",{className:"text-[11px] rounded bg-white/5 px-2 py-1.5",children:[l.jsx("span",{className:"text-purple-400 font-medium",children:r.name}),l.jsx("pre",{className:"mt-1 text-gray-500 overflow-x-auto text-[10px] leading-[1.4]",children:JSON.stringify(r.args,null,2)}),r.result&&l.jsx("pre",{className:"mt-1 text-gray-400 overflow-x-auto text-[10px] leading-[1.4] border-t border-white/5 pt-1",children:r.result.length>200?r.result.slice(0,200)+"...":r.result})]},a))})]})]})})}function x9({text:n,toolCalls:e}){const{t}=Bi(),[i,s]=A.useState(!0);return l.jsx("div",{className:"flex justify-start",children:l.jsxs("div",{className:"max-w-[85%] rounded-lg px-3 py-2 bg-[#1a1a1a] border border-white/5 text-[13px] leading-[1.6] text-gray-300",children:[e.length>0&&l.jsxs("div",{className:"mb-2 pb-1.5 border-b border-white/10",children:[l.jsxs("button",{onClick:()=>s(!i),className:"flex items-center gap-1 text-[11px] text-gray-500 hover:text-gray-300 transition-colors cursor-pointer",children:[i?l.jsx(dy,{className:"w-3 h-3"}):l.jsx(Q1,{className:"w-3 h-3"}),l.jsx("span",{children:t("chat.toolCalling",{name:e[e.length-1].name})})]}),i&&l.jsx("div",{className:"mt-1.5 space-y-1",children:e.map((r,a)=>l.jsxs("div",{className:"text-[11px] rounded bg-white/5 px-2 py-1.5",children:[l.jsx("span",{className:"text-purple-400 font-medium",children:r.name}),l.jsx("pre",{className:"mt-1 text-gray-500 overflow-x-auto text-[10px] leading-[1.4]",children:JSON.stringify(r.args,null,2)})]},a))})]}),n?l.jsxs("div",{className:"break-words",children:[l.jsx("div",{dangerouslySetInnerHTML:{__html:SR(n)}}),l.jsx("span",{className:"inline-block w-1.5 h-4 bg-blue-400 animate-pulse ml-0.5 align-text-bottom"})]}):l.jsxs("div",{className:"flex items-center gap-2 text-gray-500",children:[l.jsx(nt,{className:"w-3.5 h-3.5 animate-spin"}),l.jsx("span",{className:"text-[12px]",children:t("chat.thinking")})]})]})})}function y9({sessions:n,currentSessionId:e,onSelect:t,onNew:i,onDelete:s,onClose:r}){const{t:a}=Bi(),o=A.useRef(null);return A.useEffect(()=>{const c=h=>{o.current&&!o.current.contains(h.target)&&r()};return document.addEventListener("mousedown",c),()=>document.removeEventListener("mousedown",c)},[r]),l.jsxs("div",{ref:o,className:"absolute top-full left-0 right-0 mt-1 bg-[#1a1a1a] border border-white/10 rounded-lg shadow-xl z-50 max-h-[300px] overflow-y-auto",children:[l.jsxs("button",{onClick:()=>{i(),r()},className:"w-full flex items-center gap-2 px-3 py-2 text-[12px] text-gray-400 hover:bg-white/5 hover:text-white transition-colors cursor-pointer border-b border-white/5",children:[l.jsx(ya,{className:"w-3.5 h-3.5"}),l.jsx("span",{children:a("chat.newSession")})]}),n.length===0?l.jsx("div",{className:"px-3 py-4 text-[12px] text-gray-600 text-center",children:a("chat.sessionList")}):n.map(c=>l.jsxs("div",{className:`
              group flex items-center justify-between px-3 py-2 cursor-pointer transition-colors
              ${c.id===e?"bg-white/5 text-white":"text-gray-400 hover:bg-white/5 hover:text-white"}
            `,onClick:()=>t(c.id),children:[l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("p",{className:"text-[12px] truncate",children:c.title||a("chat.newSession")}),l.jsx("p",{className:"text-[10px] text-gray-600 mt-0.5",children:new Date(c.updatedAt).toLocaleDateString("zh-CN")})]}),l.jsx("button",{onMouseDown:h=>h.stopPropagation(),onClick:h=>{h.stopPropagation(),s(c.id)},className:"p-1 rounded opacity-0 group-hover:opacity-100 hover:bg-white/10 transition-all text-gray-500 hover:text-red-400 cursor-pointer",children:l.jsx(Wi,{className:"w-3 h-3"})})]},c.id))]})}function CR({articleId:n}){const{t:e}=Bi(),[t,i]=A.useState([]),[s,r]=A.useState(""),[a,o]=A.useState(!1),[c,h]=A.useState(null),[d,f]=A.useState(""),[p,g]=A.useState([]),[v,b]=A.useState([]),[x,m]=A.useState(!1),[y,w]=A.useState(null),[E,S]=A.useState(null),[_,T]=A.useState([]),[j,M]=A.useState(!1),L=A.useRef(null),O=A.useRef(null),B=A.useRef(p);B.current=p;const G=A.useRef(c);G.current=c;const W=A.useCallback(()=>{var ie;(ie=L.current)==null||ie.scrollIntoView({behavior:"smooth"})},[]);A.useEffect(()=>{W()},[t,d,W]);const J=A.useCallback(async()=>{M(!0);try{const ie=await window.electronAPI.aiPromptPresetList({target:"chat",enabledOnly:!0});T(ie)}catch{T([])}finally{M(!1)}},[]);A.useEffect(()=>{window.electronAPI.aiSettingsGet().then(ie=>{w(!!(ie.apiKey&&ie.apiKey.trim().length>0))}).catch(()=>{w(!1)})},[]),A.useEffect(()=>{if(y===!1||y===null)return;(async()=>{try{const Q=await window.electronAPI.aiChatSessionList();b(Q),await J(),h(null),i([])}catch{S(e("chat.error"))}})()},[n,y,e,J]),A.useEffect(()=>window.electronAPI.aiChatOnStream(Q=>{if(Q.type==="text-delta")f(Z=>Z+(Q.textDelta??""));else if(Q.type==="tool-call")Q.toolCall&&g(Z=>[...Z,Q.toolCall]);else if(Q.type!=="tool-result"){if(Q.type==="done"){const Z=B.current;i(re=>[...re,{role:"assistant",content:Q.fullText??"",timestamp:new Date().toISOString(),toolCalls:Z.length>0?Z.map(se=>({...se})):void 0}]),f(""),g([]),o(!1)}else if(Q.type==="error")S(Q.error??e("chat.error")),f(""),g([]),o(!1);else if(Q.type==="title-generated"&&Q.title){const Z=G.current;b(re=>re.map(se=>se.id===Z?{...se,title:Q.title}:se))}}}),[e]);const V=A.useCallback(async()=>{if(c)return c;try{const ie=await window.electronAPI.aiChatSessionCreate(n??void 0);h(ie.id);const Q=await window.electronAPI.aiChatSessionList();return b(Q),ie.id}catch{return S(e("chat.error")),null}},[c,n,e]),H=A.useCallback(async()=>{if(!s.trim()||a)return;const ie={role:"user",content:s.trim(),timestamp:new Date().toISOString()};i(Z=>[...Z,ie]),S(null),r(""),o(!0);const Q=await V();if(!Q){o(!1);return}window.electronAPI.aiChatSend({sessionId:Q,message:ie.content,articleId:n??void 0})},[s,a,n,V]),P=A.useCallback(async ie=>{if(a)return;const Q={role:"user",content:ie,timestamp:new Date().toISOString()};i(re=>[...re,Q]),S(null),o(!0);const Z=await V();if(!Z){o(!1);return}window.electronAPI.aiChatSend({sessionId:Z,message:ie,articleId:n??void 0})},[a,n,V]),Y=A.useCallback(ie=>{ie.key==="Enter"&&!ie.shiftKey&&(ie.preventDefault(),H())},[H]),ge=A.useCallback(()=>{h(null),i([]),S(null),f(""),g([]),o(!1)},[]),ae=A.useCallback(()=>{m(!1)},[]),ee=A.useCallback(async ie=>{try{const Q=await window.electronAPI.aiChatSessionGet(ie);Q&&(h(Q.id),i(Q.messages)),m(!1)}catch{S(e("chat.error"))}},[e]),le=A.useCallback(async ie=>{b(Q=>Q.filter(Z=>Z.id!==ie)),ie===c&&ge();try{await window.electronAPI.aiChatSessionDelete(ie);const Q=await window.electronAPI.aiChatSessionList();b(Q)}catch{const Q=await window.electronAPI.aiChatSessionList();b(Q),S(e("chat.error"))}},[c,ge,e]);return y===null?l.jsx("div",{className:"flex flex-col h-full items-center justify-center",children:l.jsx(nt,{className:"w-5 h-5 animate-spin text-gray-500"})}):y===!1?l.jsx("div",{className:"flex flex-col h-full",children:l.jsx(g9,{})}):l.jsxs("div",{className:"flex flex-col h-full",children:[l.jsxs("div",{className:"shrink-0 relative",children:[l.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b border-white/5",children:[l.jsxs("button",{onClick:()=>m(!x),className:"flex items-center gap-1.5 text-[12px] text-gray-400 hover:text-white transition-colors cursor-pointer",children:[l.jsx(so,{className:"w-3.5 h-3.5"}),l.jsx("span",{children:e("chat.sessionList")}),l.jsx(dy,{className:"w-3 h-3"})]}),l.jsx("button",{onClick:()=>{ge(),m(!1)},className:"p-1 rounded hover:bg-white/10 text-gray-500 hover:text-white transition-colors cursor-pointer",title:e("chat.newSession"),children:l.jsx(ya,{className:"w-3.5 h-3.5"})})]}),x&&l.jsx(y9,{sessions:v,currentSessionId:c,onSelect:ee,onNew:ge,onDelete:le,onClose:ae})]}),l.jsxs("div",{className:"flex-1 overflow-y-auto p-3 space-y-3",children:[t.length===0&&!a&&l.jsx(f9,{onSelectPreset:P,presets:_,loading:j}),t.map((ie,Q)=>l.jsx(m9,{message:ie},Q)),a&&l.jsx(x9,{text:d,toolCalls:p}),E&&!a&&l.jsx("div",{className:"flex justify-center",children:l.jsx("p",{className:"text-[12px] text-red-400 bg-red-500/10 border border-red-500/20 rounded-lg px-3 py-1.5",children:E})}),l.jsx("div",{ref:L})]}),l.jsxs("div",{className:"shrink-0 border-t border-white/5 p-3",children:[t.length>0&&_.length>0&&l.jsx("div",{className:"mb-2",children:l.jsx(p9,{presets:_,onSelectPreset:P,disabled:a})}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("input",{ref:O,type:"text",value:s,onChange:ie=>r(ie.target.value),onKeyDown:Y,placeholder:e("chat.placeholder"),disabled:a,className:"flex-1 bg-[#1a1a1a] border border-white/10 rounded-lg px-3 py-2 text-[13px] text-white placeholder-gray-600 outline-none focus:border-blue-500/50 transition-colors disabled:opacity-50"}),l.jsxs("button",{onClick:H,disabled:a||!s.trim(),className:"shrink-0 px-3 py-2 rounded-lg bg-blue-600 text-white text-[13px] font-medium hover:bg-blue-500 transition-colors cursor-pointer disabled:opacity-40 disabled:cursor-not-allowed flex items-center gap-1.5",children:[a?l.jsx(nt,{className:"w-3.5 h-3.5 animate-spin"}):l.jsx(AU,{className:"w-3.5 h-3.5"}),l.jsx("span",{children:e("chat.send")})]})]})]})]})}let Vy=null;function Gy(n){return import(n)}async function v9(){return Vy||(Vy=(async()=>{try{const[n,e]=await Promise.all([Gy("markmap-lib"),Gy("markmap-view")]);if(n.Transformer&&e.Markmap)return{Transformer:n.Transformer,Markmap:e.Markmap};throw new Error("Invalid local markmap modules")}catch{const[n,e]=await Promise.all([Gy("https://esm.sh/markmap-lib@0.18.10"),Gy("https://esm.sh/markmap-view@0.18.10")]);return{Transformer:n.Transformer,Markmap:e.Markmap}}})(),Vy)}function b9(n){return n==="transcript"?"è½¬å†™":n==="summary"?"æ‘˜è¦":"æ­£æ–‡"}function NR({articleId:n,generateSignal:e}){const[t,i]=A.useState(null),[s,r]=A.useState(!0),[a,o]=A.useState(!1),[c,h]=A.useState(null),[d,f]=A.useState(null),[p,g]=A.useState(!1),v=A.useRef(null),b=A.useRef(null),x=A.useRef(e),m=A.useRef(null),y=A.useCallback(async()=>{r(!0),h(null);try{const _=await window.electronAPI.aiMindmapGet(n);i(_)}catch(_){h(_ instanceof Error?_.message:String(_))}finally{r(!1)}},[n]),w=A.useCallback(async()=>{o(!0),h(null);try{const _=await window.electronAPI.aiMindmapGenerate({articleId:n});i(_)}catch(_){h(_ instanceof Error?_.message:String(_))}finally{o(!1)}},[n]),E=A.useCallback(async()=>{if(t!=null&&t.mindmapMarkdown)try{await navigator.clipboard.writeText(t.mindmapMarkdown),g(!0),m.current&&clearTimeout(m.current),m.current=setTimeout(()=>g(!1),1200)}catch{}},[t==null?void 0:t.mindmapMarkdown]),S=A.useCallback(async _=>{var j;const T=v.current;if(T)try{f(null);const M=await v9(),O=new M.Transformer().transform(_);(j=b.current)!=null&&j.destroy&&b.current.destroy(),T.innerHTML="";const B=M.Markmap.create(T,{autoFit:!0,duration:300,maxWidth:260,pan:!0,zoom:!0},O.root);b.current=B,B.fit&&B.fit()}catch(M){f(M instanceof Error?M.message:String(M))}},[]);return A.useEffect(()=>{y()},[y]),A.useEffect(()=>{t!=null&&t.mindmapMarkdown&&S(t.mindmapMarkdown)},[t==null?void 0:t.mindmapMarkdown,S]),A.useEffect(()=>{e==null||x.current===e||(x.current=e,w())},[e,w]),A.useEffect(()=>()=>{var _;(_=b.current)!=null&&_.destroy&&b.current.destroy(),m.current&&clearTimeout(m.current)},[]),s?l.jsxs("div",{className:"flex-1 min-h-0 flex items-center justify-center text-sm text-gray-500",children:[l.jsx(nt,{className:"w-4 h-4 animate-spin mr-2"}),"åŠ è½½æ€ç»´å¯¼å›¾..."]}):l.jsxs("div",{className:"flex-1 min-h-0 flex flex-col",children:[l.jsxs("div",{className:"shrink-0 flex items-center justify-between px-4 py-3 border-b border-white/5",children:[l.jsxs("div",{className:"flex items-center gap-2 text-[12px] text-gray-400",children:[t&&l.jsxs("span",{className:"px-2 py-0.5 rounded bg-white/5 text-gray-300 border border-white/10",children:["æ¥æº: ",b9(t.sourceType)]}),t&&l.jsxs("span",{className:"text-gray-500",children:["æ›´æ–°äºŽ ",new Date(t.updatedAt).toLocaleString()]})]}),l.jsxs("div",{className:"flex items-center gap-1.5",children:[t&&l.jsxs("button",{onClick:E,className:"inline-flex items-center gap-1 px-2.5 py-1.5 text-[12px] rounded-md bg-white/5 hover:bg-white/10 text-gray-300 transition-colors cursor-pointer",children:[l.jsx(bg,{className:"w-3.5 h-3.5"}),p?"å·²å¤åˆ¶":"å¤åˆ¶ Markdown"]}),l.jsxs("button",{onClick:w,disabled:a,className:"inline-flex items-center gap-1 px-2.5 py-1.5 text-[12px] rounded-md bg-blue-600 hover:bg-blue-500 disabled:opacity-60 disabled:cursor-not-allowed text-white transition-colors cursor-pointer",children:[a?l.jsx(nt,{className:"w-3.5 h-3.5 animate-spin"}):l.jsx(va,{className:"w-3.5 h-3.5"}),t?"é‡æ–°ç”Ÿæˆ":"ç”Ÿæˆæ€ç»´å¯¼å›¾"]})]})]}),c&&l.jsxs("div",{className:"mx-4 mt-4 px-3 py-2 rounded-md bg-red-500/10 border border-red-500/30 text-xs text-red-300 flex items-start gap-2",children:[l.jsx(vg,{className:"w-3.5 h-3.5 mt-0.5 shrink-0"}),l.jsx("span",{children:c})]}),t?d?l.jsxs("div",{className:"flex-1 min-h-0 overflow-auto p-4",children:[l.jsxs("div",{className:"text-xs text-red-300 mb-2",children:["å¯¼å›¾æ¸²æŸ“å¤±è´¥: ",d]}),l.jsx("pre",{className:"text-[12px] leading-[1.5] text-gray-300 bg-[#111] border border-white/10 rounded-md p-3 overflow-x-auto whitespace-pre-wrap",children:t.mindmapMarkdown})]}):l.jsx("div",{className:"mindmap-dark flex-1 min-h-0 bg-[#101010]",children:l.jsx("svg",{ref:v,className:"w-full h-full"})}):l.jsx("div",{className:"flex-1 min-h-0 flex items-center justify-center px-8",children:l.jsxs("div",{className:"text-center text-gray-500",children:[l.jsx(Jc,{className:"w-8 h-8 mx-auto mb-3 opacity-40"}),l.jsx("p",{className:"text-sm text-gray-400",children:"ç‚¹å‡»å³ä¸Šè§’æŒ‰é’®ç”Ÿæˆæ€ç»´å¯¼å›¾"}),l.jsx("p",{className:"mt-1 text-xs text-gray-600",children:"æ”¯æŒæ–‡ç« æ­£æ–‡ã€è§†é¢‘è½¬å†™ã€æ’­å®¢è½¬å†™å†…å®¹"})]})})]})}function Sg({defaultWidth:n,minWidth:e=220,maxWidth:t=600,storageKey:i}){const[s,r]=A.useState(()=>{if(i){const d=localStorage.getItem(i);if(d){const f=parseInt(d,10);if(!isNaN(f)&&f>=e&&f<=t)return f}}return n}),a=A.useRef(!1),o=A.useRef(0),c=A.useRef(0),h=A.useCallback(d=>{d.preventDefault(),a.current=!0,o.current=d.clientX,c.current=s,document.body.style.cursor="col-resize",document.body.style.userSelect="none"},[s]);return A.useEffect(()=>{const d=p=>{if(!a.current)return;const g=o.current-p.clientX,v=Math.min(t,Math.max(e,c.current+g));r(v)},f=()=>{a.current&&(a.current=!1,document.body.style.cursor="",document.body.style.userSelect="")};return document.addEventListener("mousemove",d),document.addEventListener("mouseup",f),()=>{document.removeEventListener("mousemove",d),document.removeEventListener("mouseup",f)}},[e,t]),A.useEffect(()=>{i&&localStorage.setItem(i,String(s))},[s,i]),{width:s,handleMouseDown:h}}function w9({articleId:n}){const[e,t]=A.useState(null),[i,s]=A.useState([]),[r,a]=A.useState(!1),[o,c]=A.useState(!1);A.useEffect(()=>{h()},[n]);const h=async()=>{a(!0);try{const[f,p]=await Promise.all([window.electronAPI.wechatGetStats(n),window.electronAPI.wechatGetComments(n)]);t(f),s(p)}catch{}finally{a(!1)}};if(!e&&!r)return null;const d=f=>f==null?"-":f>=1e5?`${(f/1e4).toFixed(1)}ä¸‡`:f>=1e4?`${(f/1e4).toFixed(1)}ä¸‡`:f.toLocaleString();return l.jsxs("div",{className:"px-5 py-4 border-t border-[#1e1e1e]",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("h3",{className:"text-[11px] font-medium text-gray-500 uppercase tracking-wider",children:"å¾®ä¿¡æ•°æ®"}),l.jsx("button",{onClick:h,disabled:r,className:"p-1 rounded hover:bg-white/5 text-gray-500 hover:text-gray-300 transition-colors cursor-pointer",title:"åˆ·æ–°æ•°æ®",children:r?l.jsx(nt,{size:12,className:"animate-spin"}):l.jsx(va,{size:12})})]}),e&&l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[l.jsxs("div",{className:"flex items-center gap-2 p-2 bg-white/[0.02] rounded-md",children:[l.jsx(lR,{size:13,className:"text-blue-400 shrink-0"}),l.jsxs("div",{children:[l.jsx("div",{className:"text-[13px] font-medium text-white",children:d(e.readCount)}),l.jsx("div",{className:"text-[10px] text-gray-500",children:"é˜…è¯»"})]})]}),l.jsxs("div",{className:"flex items-center gap-2 p-2 bg-white/[0.02] rounded-md",children:[l.jsx(Uk,{size:13,className:"text-red-400 shrink-0"}),l.jsxs("div",{children:[l.jsx("div",{className:"text-[13px] font-medium text-white",children:d(e.likeCount)}),l.jsx("div",{className:"text-[10px] text-gray-500",children:"ç‚¹èµž"})]})]}),l.jsxs("div",{className:"flex items-center gap-2 p-2 bg-white/[0.02] rounded-md",children:[l.jsx(yR,{size:13,className:"text-green-400 shrink-0"}),l.jsxs("div",{children:[l.jsx("div",{className:"text-[13px] font-medium text-white",children:d(e.shareCount)}),l.jsx("div",{className:"text-[10px] text-gray-500",children:"è½¬å‘"})]})]}),l.jsxs("div",{className:"flex items-center gap-2 p-2 bg-white/[0.02] rounded-md",children:[l.jsx(Jc,{size:13,className:"text-yellow-400 shrink-0"}),l.jsxs("div",{children:[l.jsx("div",{className:"text-[13px] font-medium text-white",children:d(e.wowCount)}),l.jsx("div",{className:"text-[10px] text-gray-500",children:"åœ¨çœ‹"})]})]})]}),e.fetchedAt&&l.jsxs("div",{className:"text-[10px] text-gray-600 text-right",children:["æ•°æ®èŽ·å–äºŽ ",new Date(e.fetchedAt).toLocaleString("zh-CN")]})]}),i.length>0&&l.jsxs("div",{className:"mt-3",children:[l.jsxs("button",{onClick:()=>c(!o),className:"flex items-center gap-1.5 text-[12px] text-gray-400 hover:text-gray-200 transition-colors cursor-pointer",children:[l.jsx(O8,{size:12}),l.jsxs("span",{children:["è¯„è®º (",i.length,")"]})]}),o&&l.jsx("div",{className:"mt-2 space-y-2 max-h-48 overflow-y-auto",children:i.map(f=>l.jsxs("div",{className:"p-2 bg-white/[0.02] rounded-md",children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsx("span",{className:"text-[11px] text-gray-400",children:f.nickname||"åŒ¿å"}),f.likeCount!==null&&f.likeCount>0&&l.jsxs("span",{className:"flex items-center gap-1 text-[10px] text-gray-500",children:[l.jsx(Uk,{size:9}),f.likeCount]})]}),l.jsx("p",{className:"text-[12px] text-gray-300 leading-relaxed",children:f.content})]},f.id))})]})]})}function QS(n){if(!n)return null;try{return new Date(n).toLocaleDateString("zh-CN",{year:"numeric",month:"short",day:"numeric"})}catch{return n}}const Wk={yellow:"#fbbf24",blue:"#3b82f6",green:"#22c55e",red:"#ef4444"};function S9(n,e){const t=Date.now()-new Date(n).getTime(),i=Math.floor(t/6e4);if(i<1)return e("time.justNow");if(i<60)return e("time.minutesAgo",{n:i});const s=Math.floor(i/60);if(s<24)return e("time.hoursAgo",{n:s});const r=Math.floor(s/24);return r<30?e("time.daysAgo",{n:r}):QS(n)??n}function A9(n){if(!n)return null;const e=Math.floor(n/3600),t=Math.floor(n%3600/60),i=n%60;return e>0?`${e}:${String(t).padStart(2,"0")}:${String(i).padStart(2,"0")}`:`${t}:${String(i).padStart(2,"0")}`}function ZC({articleId:n,collapsed:e,externalHighlights:t,onExternalDeleteHighlight:i,onHighlightClick:s}){var qe;const{t:r}=Bi(),{width:a,handleMouseDown:o}=Sg({defaultWidth:360,minWidth:280,maxWidth:600,storageKey:"detailPanelWidth"}),[c,h]=A.useState("info"),d=[{key:"info",label:r("feedDetail.info")},{key:"notebook",label:r("detailPanel.highlights")},{key:"mindmap",label:r("ai.mindmap")},{key:"chat",label:r("chat.title")}],[f,p]=A.useState(null),[g,v]=A.useState(!1),[b,x]=A.useState([]),[m,y]=A.useState(null),[w,E]=A.useState(""),[S,_]=A.useState(!1),[T,j]=A.useState(null),[M,L]=A.useState(null),[O,B]=A.useState(!1),[G,W]=A.useState(null),[J,V]=A.useState(null),[H,P]=A.useState(!1),[Y,ge]=A.useState(!1),[ae,ee]=A.useState(null),[le,ie]=A.useState(null),[Q,Z]=A.useState(!1),[re,se]=A.useState(null),[be,pe]=A.useState(null),[me,Ne]=A.useState(0),ve=t!=null,_e=ve?t:b;A.useEffect(()=>{if(j(null),L(null),_(!1),W(null),V(null),B(!1),P(!1),ee(null),ie(null),ge(!1),se(null),pe(null),Z(!1),!n){p(null),x([]);return}let ke=!1;return v(!0),window.electronAPI.articleGet(n).then(Xe=>{ke||(p(Xe),v(!1))}).catch(()=>{ke||(p(null),v(!1))}),ve||window.electronAPI.highlightList(n).then(Xe=>{ke||x(Xe)}),()=>{ke=!0}},[n,ve]);const We=A.useCallback(async ke=>{ve&&i?i(ke):(await window.electronAPI.highlightDelete(ke),x(Xe=>Xe.filter(ct=>ct.id!==ke)))},[ve,i]),Ie=A.useCallback(async(ke,Xe)=>{const ct=await window.electronAPI.highlightUpdate({id:ke,note:Xe});ve||x(Pe=>Pe.map(Qe=>Qe.id===ke?ct:Qe)),y(null)},[ve]),Re=A.useCallback(async ke=>{n&&await window.electronAPI.highlightExport(n,ke)},[n]),Ze=A.useCallback(async()=>{try{const ke=await window.electronAPI.aiSettingsGet();return!!(ke.apiKey&&ke.apiKey.trim().length>0)}catch{return!1}},[]),it=A.useCallback(async()=>{if(!n)return;if(!await Ze()){L(r("ai.configureApiKey"));return}_(!0),j(null),L(null);try{const Xe=await window.electronAPI.aiSummarize({articleId:n});j(Xe.summary)}catch{L(r("ai.errorOccurred"))}finally{_(!1)}},[n,Ze,r]),tt=A.useCallback(async ke=>{if(!n)return;if(!await Ze()){V(r("ai.configureApiKey"));return}B(!0),W(null),V(null),P(!1);try{const ct=await window.electronAPI.aiTranslate({articleId:n,targetLanguage:ke});W({title:ct.translatedTitle,content:ct.translatedContent})}catch{V(r("ai.errorOccurred"))}finally{B(!1)}},[n,Ze,r]),rt=A.useCallback(async()=>{if(!n)return;if(!await Ze()){ie(r("ai.configureApiKey"));return}ge(!0),ee(null),ie(null);try{const Xe=await window.electronAPI.aiAutoTag({articleId:n});ee(Xe.tags)}catch{ie(r("ai.errorOccurred"))}finally{ge(!1)}},[n,Ze,r]),at=A.useCallback(async()=>{if(!n)return;if(!await Ze()){pe(r("ai.configureApiKey"));return}Z(!0),se(null),pe(null);try{const Xe=await window.electronAPI.aiExtractTopics({articleId:n});se(Xe)}catch{pe(r("ai.errorOccurred"))}finally{Z(!1)}},[n,Ze,r]),ze=(f==null?void 0:f.mediaType)==="video",ft=(f==null?void 0:f.mediaType)==="podcast",Kt=(f==null?void 0:f.audioDuration)||(f==null?void 0:f.duration),he=(ze||ft)&&Kt?A9(Kt):f!=null&&f.readingTime?`${f.readingTime} min`:null,X=f?[{label:"Published",value:QS(f.publishedAt),icon:l.jsx(Ym,{className:"w-3.5 h-3.5"})},...ze?[]:[{label:"Author",value:f.author,icon:l.jsx(rw,{className:"w-3.5 h-3.5"})}],{label:"Domain",value:f.domain,icon:l.jsx(ad,{className:"w-3.5 h-3.5"})},{label:ze||ft?"Duration":"Reading Time",value:he,icon:l.jsx(ma,{className:"w-3.5 h-3.5"})},...ze?[{label:"Progress",value:`${Math.round(f.readProgress*100)}%`,icon:l.jsx(El,{className:"w-3.5 h-3.5"})}]:[],...!ze&&!ft?[{label:"Word Count",value:((qe=f.wordCount)==null?void 0:qe.toLocaleString())??null,icon:l.jsx(El,{className:"w-3.5 h-3.5"})}]:[],{label:"Saved",value:QS(f.savedAt),icon:l.jsx(Ym,{className:"w-3.5 h-3.5"})}]:[],je={inbox:r("contentList.inbox"),later:r("contentList.later"),archive:r("contentList.archive")};return l.jsxs("div",{className:`
        flex flex-col bg-[#0f0f0f] border-l border-[#262626] shrink-0
        overflow-hidden relative
        ${e?"w-0 border-l-0":""}
      `,style:e?void 0:{width:a},children:[!e&&l.jsx("div",{onMouseDown:o,className:"absolute left-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500/30 active:bg-blue-500/50 z-10 transition-colors"}),l.jsxs("div",{className:"flex flex-col h-full",style:{minWidth:a},children:[l.jsx("div",{className:"shrink-0 flex gap-1.5 px-3 pt-3 pb-1 border-b border-[#262626]",children:d.map(ke=>l.jsxs("button",{onClick:()=>h(ke.key),className:`
              px-3 py-1.5 text-[13px] font-medium rounded-t-md transition-colors cursor-pointer flex items-center gap-1.5 relative
              ${c===ke.key?"text-white":"text-gray-500 hover:text-gray-300"}
            `,children:[ke.label,ke.key==="notebook"&&l.jsx("span",{className:"ml-1 min-w-[1em] text-center text-[11px] text-gray-500 tabular-nums inline-block",children:_e.length}),c===ke.key&&l.jsx("span",{className:"absolute bottom-[-1px] left-0 right-0 h-0.5 bg-blue-500 rounded-full"})]},ke.key))}),l.jsx("div",{className:`flex-1 flex flex-col min-h-0 ${c==="chat"||c==="mindmap"?"":"overflow-y-auto p-4"}`,children:n?g?l.jsx("div",{className:"flex items-center justify-center h-full text-sm text-gray-500",children:r("common.loading")}):f?l.jsxs(l.Fragment,{children:[c==="info"&&l.jsxs("div",{className:"flex-1 flex flex-col gap-5",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"text-[11px] font-bold uppercase tracking-wider text-gray-500 mb-2",children:"Summary"}),l.jsx("p",{className:"text-[13px] leading-[1.6] text-gray-400",children:f.summary||r("detailPanel.noHighlights")}),l.jsx("div",{className:"mt-6",children:X.map(ke=>l.jsxs("div",{className:"flex items-center py-2.5 border-b border-white/5 last:border-b-0",children:[l.jsxs("span",{className:"flex items-center gap-2 text-[11px] text-gray-500 w-[110px] shrink-0 font-medium",children:[l.jsx("span",{className:"text-gray-600",children:ke.icon}),ke.label]}),l.jsx("span",{className:"text-[13px] text-gray-300 truncate",children:ke.value||"â€”"})]},ke.label))}),l.jsxs("div",{className:"mt-6",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx(sw,{className:"w-3.5 h-3.5 text-gray-500"}),l.jsx("span",{className:"text-[11px] font-bold uppercase tracking-wider text-gray-500",children:"Tags"})]}),l.jsx(d9,{articleId:f.id})]}),f.url&&f.url.includes("mp.weixin.qq.com")&&l.jsx("div",{className:"mt-6",children:l.jsx(w9,{articleId:f.id})}),l.jsxs("div",{className:"mt-6",children:[l.jsxs("div",{className:"flex items-center gap-1.5 mb-3",children:[l.jsx(Jc,{className:"w-3.5 h-3.5 text-gray-500"}),l.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-wider text-gray-500",children:r("ai.aiActions")})]}),l.jsxs("div",{className:"flex flex-col gap-2",children:[l.jsxs("div",{className:"rounded-lg bg-[#1a1a1a] border border-white/5 p-3",children:[l.jsxs("button",{onClick:it,disabled:S,className:"flex items-center gap-2 text-[13px] text-gray-300 hover:text-white transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed w-full",children:[S?l.jsx(nt,{className:"w-4 h-4 animate-spin text-blue-400"}):l.jsx(Jc,{className:"w-4 h-4 text-blue-400"}),l.jsx("span",{children:r(S?"ai.generating":"ai.summarize")})]}),T&&l.jsx("p",{className:"mt-2 text-[13px] text-gray-300 leading-[1.6] border-t border-white/5 pt-2",children:T}),M&&l.jsx("p",{className:"mt-2 text-[12px] text-red-400 border-t border-white/5 pt-2",children:M})]}),l.jsxs("div",{className:"rounded-lg bg-[#1a1a1a] border border-white/5 p-3",children:[l.jsxs("button",{onClick:()=>{O||P(!H)},disabled:O,className:"flex items-center gap-2 text-[13px] text-gray-300 hover:text-white transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed w-full",children:[O?l.jsx(nt,{className:"w-4 h-4 animate-spin text-green-400"}):l.jsx(v8,{className:"w-4 h-4 text-green-400"}),l.jsx("span",{children:r(O?"ai.generating":"ai.translate")})]}),H&&l.jsx("div",{className:"mt-2 flex gap-2 border-t border-white/5 pt-2",children:[{key:"zh",label:r("ai.chinese")},{key:"en",label:r("ai.english")},{key:"ja",label:r("ai.japanese")}].map(ke=>l.jsx("button",{onClick:()=>tt(ke.key),className:"px-2.5 py-1 text-[12px] rounded-md bg-white/5 text-gray-400 hover:bg-white/10 hover:text-white transition-colors cursor-pointer",children:ke.label},ke.key))}),G&&l.jsxs("div",{className:"mt-2 border-t border-white/5 pt-2",children:[l.jsx("p",{className:"text-[13px] text-white font-medium",children:G.title}),l.jsx("p",{className:"mt-1 text-[13px] text-gray-300 leading-[1.6] line-clamp-6",children:G.content})]}),J&&l.jsx("p",{className:"mt-2 text-[12px] text-red-400 border-t border-white/5 pt-2",children:J})]}),l.jsxs("div",{className:"rounded-lg bg-[#1a1a1a] border border-white/5 p-3",children:[l.jsxs("button",{onClick:rt,disabled:Y,className:"flex items-center gap-2 text-[13px] text-gray-300 hover:text-white transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed w-full",children:[Y?l.jsx(nt,{className:"w-4 h-4 animate-spin text-purple-400"}):l.jsx(OU,{className:"w-4 h-4 text-purple-400"}),l.jsx("span",{children:r(Y?"ai.generating":"ai.autoTag")})]}),ae&&l.jsxs("div",{className:"mt-2 border-t border-white/5 pt-2",children:[l.jsx("p",{className:"text-[11px] text-gray-500 mb-1.5",children:r("ai.suggestedTags")}),l.jsx("div",{className:"flex flex-wrap gap-1.5",children:ae.map(ke=>l.jsx("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 text-[12px] rounded-md bg-purple-500/10 text-purple-300 border border-purple-500/20",children:ke},ke))})]}),le&&l.jsx("p",{className:"mt-2 text-[12px] text-red-400 border-t border-white/5 pt-2",children:le})]}),l.jsxs("div",{className:"rounded-lg bg-[#1a1a1a] border border-white/5 p-3",children:[l.jsxs("button",{onClick:at,disabled:Q,className:"flex items-center gap-2 text-[13px] text-gray-300 hover:text-white transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed w-full",children:[Q?l.jsx(nt,{className:"w-4 h-4 animate-spin text-emerald-400"}):l.jsx(dR,{className:"w-4 h-4 text-emerald-400"}),l.jsx("span",{children:r(Q?"ai.generating":"ai.extractTopics")})]}),re&&l.jsxs("div",{className:"mt-2 border-t border-white/5 pt-2",children:[l.jsx("p",{className:"text-[11px] text-gray-500 mb-1.5",children:r("ai.topics")}),l.jsx("div",{className:"flex flex-wrap gap-1.5",children:re.topics.map((ke,Xe)=>l.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/10 text-emerald-400 text-xs",children:ke},Xe))})]}),be&&l.jsx("p",{className:"mt-2 text-[12px] text-red-400 border-t border-white/5 pt-2",children:be})]}),l.jsx("div",{className:"rounded-lg bg-[#1a1a1a] border border-white/5 p-3",children:l.jsxs("button",{onClick:()=>{h("mindmap"),Ne(ke=>ke+1)},className:"flex items-center gap-2 text-[13px] text-gray-300 hover:text-white transition-colors cursor-pointer w-full",children:[l.jsx(H8,{className:"w-4 h-4 text-cyan-400"}),l.jsx("span",{children:r("ai.generateMindmap")})]})})]})]})]}),l.jsxs("div",{className:"mt-6 rounded-lg bg-[#1a1a1a] border border-white/5 p-3",children:[l.jsxs("div",{className:"flex items-center justify-between text-[12px]",children:[l.jsx("span",{className:"text-gray-500",children:r("books.readStatus")}),l.jsx("span",{className:"text-white font-medium",children:je[f.readStatus]??f.readStatus})]}),l.jsxs("div",{className:"mt-2",children:[l.jsxs("div",{className:"flex items-center justify-between text-[12px] mb-1",children:[l.jsx("span",{className:"text-gray-500",children:r("books.progress")}),l.jsxs("span",{className:"text-white font-medium",children:[Math.round(f.readProgress*100),"%"]})]}),l.jsx("div",{className:"w-full h-1 rounded-full bg-white/10",children:l.jsx("div",{className:"h-1 rounded-full bg-blue-500 transition-all",style:{width:`${Math.round(f.readProgress*100)}%`}})})]})]})]}),c==="notebook"&&l.jsx("div",{className:"flex-1 flex flex-col",children:_e.length===0?l.jsx("div",{className:"flex items-center justify-center h-full",children:l.jsxs("div",{className:"text-center text-gray-500",children:[l.jsx(py,{className:"w-8 h-8 mx-auto mb-2 opacity-40"}),l.jsx("p",{className:"text-sm",children:r("detailPanel.noHighlights")})]})}):l.jsxs("div",{className:"flex flex-col gap-2",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("span",{className:"text-[11px] font-semibold uppercase tracking-wider text-gray-500",children:[_e.length," ",r("detailPanel.highlights").toLowerCase()]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("button",{onClick:()=>Re("clipboard"),className:"p-1 rounded hover:bg-white/10 text-gray-500 hover:text-white transition-colors cursor-pointer",title:r("common.copy"),children:l.jsx(bg,{className:"w-3.5 h-3.5"})}),l.jsx("button",{onClick:()=>Re("file"),className:"p-1 rounded hover:bg-white/10 text-gray-500 hover:text-white transition-colors cursor-pointer",title:r("common.export"),children:l.jsx(xa,{className:"w-3.5 h-3.5"})})]})]}),_e.map(ke=>l.jsxs("div",{className:`group relative flex rounded-lg bg-[#1a1a1a] border border-white/5 overflow-hidden ${s?"cursor-pointer hover:border-white/10":""}`,onClick:()=>s==null?void 0:s(ke.id),children:[l.jsx("div",{className:"w-[3px] shrink-0",style:{backgroundColor:Wk[ke.color]??Wk.yellow}}),l.jsxs("div",{className:"flex-1 p-3 min-w-0",children:[l.jsxs("p",{className:"text-[13px] leading-[1.6] text-gray-300 italic",children:["â€œ",ke.text,"â€"]}),m===ke.id?l.jsx("textarea",{autoFocus:!0,value:w,onChange:Xe=>E(Xe.target.value),onBlur:()=>Ie(ke.id,w),onKeyDown:Xe=>{Xe.key==="Enter"&&!Xe.shiftKey&&(Xe.preventDefault(),Ie(ke.id,w)),Xe.key==="Escape"&&y(null)},className:"mt-1.5 w-full text-[12px] text-gray-300 bg-white/5 border border-white/10 rounded px-2 py-1.5 resize-none outline-none focus:border-blue-500/50",rows:2,placeholder:r("detailPanel.addNote")}):l.jsx("button",{onClick:()=>{y(ke.id),E(ke.note||"")},className:"mt-1.5 block text-left text-[12px] text-gray-400 hover:text-gray-300 transition-colors w-full",children:ke.note||r("detailPanel.addNote")}),l.jsx("span",{className:"mt-2 block text-[11px] text-gray-600",children:S9(ke.createdAt,r)})]}),l.jsx("button",{onClick:()=>We(ke.id),className:"absolute top-2 right-2 p-1 rounded opacity-0 group-hover:opacity-100 hover:bg-white/10 transition-all cursor-pointer text-gray-500 hover:text-red-400",children:l.jsx(Wi,{className:"w-3.5 h-3.5"})})]},ke.id))]})}),c==="chat"&&l.jsx("div",{className:"flex-1 flex flex-col min-h-0",children:l.jsx(CR,{articleId:n})}),c==="mindmap"&&l.jsx(NR,{articleId:f.id,generateSignal:me})]}):l.jsx("div",{className:"flex items-center justify-center h-full text-sm text-gray-500",children:r("errors.notFound")}):l.jsx("div",{className:"flex items-center justify-center h-full text-sm text-gray-500",children:r("detailPanel.noSelection")})})]})]})}function E9(n,e){if(n.match(/^[a-z]+:\/\//i))return n;if(n.match(/^\/\//))return window.location.protocol+n;if(n.match(/^[a-z]+:/i))return n;const t=document.implementation.createHTMLDocument(),i=t.createElement("base"),s=t.createElement("a");return t.head.appendChild(i),t.body.appendChild(s),e&&(i.href=e),s.href=n,s.href}const C9=(()=>{let n=0;const e=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(n+=1,`u${e()}${n}`)})();function eu(n){const e=[];for(let t=0,i=n.length;t<i;t++)e.push(n[t]);return e}let yd=null;function _R(n={}){return yd||(n.includeStyleProperties?(yd=n.includeStyleProperties,yd):(yd=eu(window.getComputedStyle(document.documentElement)),yd))}function zb(n,e){const i=(n.ownerDocument.defaultView||window).getComputedStyle(n).getPropertyValue(e);return i?parseFloat(i.replace("px","")):0}function N9(n){const e=zb(n,"border-left-width"),t=zb(n,"border-right-width");return n.clientWidth+e+t}function _9(n){const e=zb(n,"border-top-width"),t=zb(n,"border-bottom-width");return n.clientHeight+e+t}function kR(n,e={}){const t=e.width||N9(n),i=e.height||_9(n);return{width:t,height:i}}function k9(){let n,e;try{e=process}catch{}const t=e&&e.env?e.env.devicePixelRatio:null;return t&&(n=parseInt(t,10),Number.isNaN(n)&&(n=1)),n||window.devicePixelRatio||1}const Ds=16384;function T9(n){(n.width>Ds||n.height>Ds)&&(n.width>Ds&&n.height>Ds?n.width>n.height?(n.height*=Ds/n.width,n.width=Ds):(n.width*=Ds/n.height,n.height=Ds):n.width>Ds?(n.height*=Ds/n.width,n.width=Ds):(n.width*=Ds/n.height,n.height=Ds))}function Fb(n){return new Promise((e,t)=>{const i=new Image;i.onload=()=>{i.decode().then(()=>{requestAnimationFrame(()=>e(i))})},i.onerror=t,i.crossOrigin="anonymous",i.decoding="async",i.src=n})}async function D9(n){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(n)).then(encodeURIComponent).then(e=>`data:image/svg+xml;charset=utf-8,${e}`)}async function j9(n,e,t){const i="http://www.w3.org/2000/svg",s=document.createElementNS(i,"svg"),r=document.createElementNS(i,"foreignObject");return s.setAttribute("width",`${e}`),s.setAttribute("height",`${t}`),s.setAttribute("viewBox",`0 0 ${e} ${t}`),r.setAttribute("width","100%"),r.setAttribute("height","100%"),r.setAttribute("x","0"),r.setAttribute("y","0"),r.setAttribute("externalResourcesRequired","true"),s.appendChild(r),r.appendChild(n),D9(s)}const Cs=(n,e)=>{if(n instanceof e)return!0;const t=Object.getPrototypeOf(n);return t===null?!1:t.constructor.name===e.name||Cs(t,e)};function R9(n){const e=n.getPropertyValue("content");return`${n.cssText} content: '${e.replace(/'|"/g,"")}';`}function L9(n,e){return _R(e).map(t=>{const i=n.getPropertyValue(t),s=n.getPropertyPriority(t);return`${t}: ${i}${s?" !important":""};`}).join(" ")}function M9(n,e,t,i){const s=`.${n}:${e}`,r=t.cssText?R9(t):L9(t,i);return document.createTextNode(`${s}{${r}}`)}function Yk(n,e,t,i){const s=window.getComputedStyle(n,t),r=s.getPropertyValue("content");if(r===""||r==="none")return;const a=C9();try{e.className=`${e.className} ${a}`}catch{return}const o=document.createElement("style");o.appendChild(M9(a,t,s,i)),e.appendChild(o)}function O9(n,e,t){Yk(n,e,":before",t),Yk(n,e,":after",t)}const Xk="application/font-woff",Kk="image/jpeg",P9={woff:Xk,woff2:Xk,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:Kk,jpeg:Kk,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function I9(n){const e=/\.([^./]*?)$/g.exec(n);return e?e[1]:""}function QC(n){const e=I9(n).toLowerCase();return P9[e]||""}function B9(n){return n.split(/,/)[1]}function JS(n){return n.search(/^(data:)/)!==-1}function z9(n,e){return`data:${e};base64,${n}`}async function TR(n,e,t){const i=await fetch(n,e);if(i.status===404)throw new Error(`Resource "${i.url}" not found`);const s=await i.blob();return new Promise((r,a)=>{const o=new FileReader;o.onerror=a,o.onloadend=()=>{try{r(t({res:i,result:o.result}))}catch(c){a(c)}},o.readAsDataURL(s)})}const A2={};function F9(n,e,t){let i=n.replace(/\?.*/,"");return t&&(i=n),/ttf|otf|eot|woff2?/i.test(i)&&(i=i.replace(/.*\//,"")),e?`[${e}]${i}`:i}async function JC(n,e,t){const i=F9(n,e,t.includeQueryParams);if(A2[i]!=null)return A2[i];t.cacheBust&&(n+=(/\?/.test(n)?"&":"?")+new Date().getTime());let s;try{const r=await TR(n,t.fetchRequestInit,({res:a,result:o})=>(e||(e=a.headers.get("Content-Type")||""),B9(o)));s=z9(r,e)}catch(r){s=t.imagePlaceholder||"";let a=`Failed to fetch resource: ${n}`;r&&(a=typeof r=="string"?r:r.message),a&&console.warn(a)}return A2[i]=s,s}async function U9(n){const e=n.toDataURL();return e==="data:,"?n.cloneNode(!1):Fb(e)}async function H9(n,e){if(n.currentSrc){const r=document.createElement("canvas"),a=r.getContext("2d");r.width=n.clientWidth,r.height=n.clientHeight,a==null||a.drawImage(n,0,0,r.width,r.height);const o=r.toDataURL();return Fb(o)}const t=n.poster,i=QC(t),s=await JC(t,i,e);return Fb(s)}async function $9(n,e){var t;try{if(!((t=n==null?void 0:n.contentDocument)===null||t===void 0)&&t.body)return await aw(n.contentDocument.body,e,!0)}catch{}return n.cloneNode(!1)}async function q9(n,e){return Cs(n,HTMLCanvasElement)?U9(n):Cs(n,HTMLVideoElement)?H9(n,e):Cs(n,HTMLIFrameElement)?$9(n,e):n.cloneNode(DR(n))}const V9=n=>n.tagName!=null&&n.tagName.toUpperCase()==="SLOT",DR=n=>n.tagName!=null&&n.tagName.toUpperCase()==="SVG";async function G9(n,e,t){var i,s;if(DR(e))return e;let r=[];return V9(n)&&n.assignedNodes?r=eu(n.assignedNodes()):Cs(n,HTMLIFrameElement)&&(!((i=n.contentDocument)===null||i===void 0)&&i.body)?r=eu(n.contentDocument.body.childNodes):r=eu(((s=n.shadowRoot)!==null&&s!==void 0?s:n).childNodes),r.length===0||Cs(n,HTMLVideoElement)||await r.reduce((a,o)=>a.then(()=>aw(o,t)).then(c=>{c&&e.appendChild(c)}),Promise.resolve()),e}function W9(n,e,t){const i=e.style;if(!i)return;const s=window.getComputedStyle(n);s.cssText?(i.cssText=s.cssText,i.transformOrigin=s.transformOrigin):_R(t).forEach(r=>{let a=s.getPropertyValue(r);r==="font-size"&&a.endsWith("px")&&(a=`${Math.floor(parseFloat(a.substring(0,a.length-2)))-.1}px`),Cs(n,HTMLIFrameElement)&&r==="display"&&a==="inline"&&(a="block"),r==="d"&&e.getAttribute("d")&&(a=`path(${e.getAttribute("d")})`),i.setProperty(r,a,s.getPropertyPriority(r))})}function Y9(n,e){Cs(n,HTMLTextAreaElement)&&(e.innerHTML=n.value),Cs(n,HTMLInputElement)&&e.setAttribute("value",n.value)}function X9(n,e){if(Cs(n,HTMLSelectElement)){const t=e,i=Array.from(t.children).find(s=>n.value===s.getAttribute("value"));i&&i.setAttribute("selected","")}}function K9(n,e,t){return Cs(e,Element)&&(W9(n,e,t),O9(n,e,t),Y9(n,e),X9(n,e)),e}async function Z9(n,e){const t=n.querySelectorAll?n.querySelectorAll("use"):[];if(t.length===0)return n;const i={};for(let r=0;r<t.length;r++){const o=t[r].getAttribute("xlink:href");if(o){const c=n.querySelector(o),h=document.querySelector(o);!c&&h&&!i[o]&&(i[o]=await aw(h,e,!0))}}const s=Object.values(i);if(s.length){const r="http://www.w3.org/1999/xhtml",a=document.createElementNS(r,"svg");a.setAttribute("xmlns",r),a.style.position="absolute",a.style.width="0",a.style.height="0",a.style.overflow="hidden",a.style.display="none";const o=document.createElementNS(r,"defs");a.appendChild(o);for(let c=0;c<s.length;c++)o.appendChild(s[c]);n.appendChild(a)}return n}async function aw(n,e,t){return!t&&e.filter&&!e.filter(n)?null:Promise.resolve(n).then(i=>q9(i,e)).then(i=>G9(n,i,e)).then(i=>K9(n,i,e)).then(i=>Z9(i,e))}const jR=/url\((['"]?)([^'"]+?)\1\)/g,Q9=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,J9=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function e7(n){const e=n.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${e})(['"]?\\))`,"g")}function t7(n){const e=[];return n.replace(jR,(t,i,s)=>(e.push(s),t)),e.filter(t=>!JS(t))}async function n7(n,e,t,i,s){try{const r=t?E9(e,t):e,a=QC(e);let o;return s||(o=await JC(r,a,i)),n.replace(e7(e),`$1${o}$3`)}catch{}return n}function i7(n,{preferredFontFormat:e}){return e?n.replace(J9,t=>{for(;;){const[i,,s]=Q9.exec(t)||[];if(!s)return"";if(s===e)return`src: ${i};`}}):n}function RR(n){return n.search(jR)!==-1}async function LR(n,e,t){if(!RR(n))return n;const i=i7(n,t);return t7(i).reduce((r,a)=>r.then(o=>n7(o,a,e,t)),Promise.resolve(i))}async function vd(n,e,t){var i;const s=(i=e.style)===null||i===void 0?void 0:i.getPropertyValue(n);if(s){const r=await LR(s,null,t);return e.style.setProperty(n,r,e.style.getPropertyPriority(n)),!0}return!1}async function s7(n,e){await vd("background",n,e)||await vd("background-image",n,e),await vd("mask",n,e)||await vd("-webkit-mask",n,e)||await vd("mask-image",n,e)||await vd("-webkit-mask-image",n,e)}async function r7(n,e){const t=Cs(n,HTMLImageElement);if(!(t&&!JS(n.src))&&!(Cs(n,SVGImageElement)&&!JS(n.href.baseVal)))return;const i=t?n.src:n.href.baseVal,s=await JC(i,QC(i),e);await new Promise((r,a)=>{n.onload=r,n.onerror=e.onImageErrorHandler?(...c)=>{try{r(e.onImageErrorHandler(...c))}catch(h){a(h)}}:a;const o=n;o.decode&&(o.decode=r),o.loading==="lazy"&&(o.loading="eager"),t?(n.srcset="",n.src=s):n.href.baseVal=s})}async function a7(n,e){const i=eu(n.childNodes).map(s=>MR(s,e));await Promise.all(i).then(()=>n)}async function MR(n,e){Cs(n,Element)&&(await s7(n,e),await r7(n,e),await a7(n,e))}function o7(n,e){const{style:t}=n;e.backgroundColor&&(t.backgroundColor=e.backgroundColor),e.width&&(t.width=`${e.width}px`),e.height&&(t.height=`${e.height}px`);const i=e.style;return i!=null&&Object.keys(i).forEach(s=>{t[s]=i[s]}),n}const Zk={};async function Qk(n){let e=Zk[n];if(e!=null)return e;const i=await(await fetch(n)).text();return e={url:n,cssText:i},Zk[n]=e,e}async function Jk(n,e){let t=n.cssText;const i=/url\(["']?([^"')]+)["']?\)/g,r=(t.match(/url\([^)]+\)/g)||[]).map(async a=>{let o=a.replace(i,"$1");return o.startsWith("https://")||(o=new URL(o,n.url).href),TR(o,e.fetchRequestInit,({result:c})=>(t=t.replace(a,`url(${c})`),[a,c]))});return Promise.all(r).then(()=>t)}function eT(n){if(n==null)return[];const e=[],t=/(\/\*[\s\S]*?\*\/)/gi;let i=n.replace(t,"");const s=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const c=s.exec(i);if(c===null)break;e.push(c[0])}i=i.replace(s,"");const r=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,a="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",o=new RegExp(a,"gi");for(;;){let c=r.exec(i);if(c===null){if(c=o.exec(i),c===null)break;r.lastIndex=o.lastIndex}else o.lastIndex=r.lastIndex;e.push(c[0])}return e}async function l7(n,e){const t=[],i=[];return n.forEach(s=>{if("cssRules"in s)try{eu(s.cssRules||[]).forEach((r,a)=>{if(r.type===CSSRule.IMPORT_RULE){let o=a+1;const c=r.href,h=Qk(c).then(d=>Jk(d,e)).then(d=>eT(d).forEach(f=>{try{s.insertRule(f,f.startsWith("@import")?o+=1:s.cssRules.length)}catch(p){console.error("Error inserting rule from remote css",{rule:f,error:p})}})).catch(d=>{console.error("Error loading remote css",d.toString())});i.push(h)}})}catch(r){const a=n.find(o=>o.href==null)||document.styleSheets[0];s.href!=null&&i.push(Qk(s.href).then(o=>Jk(o,e)).then(o=>eT(o).forEach(c=>{a.insertRule(c,a.cssRules.length)})).catch(o=>{console.error("Error loading remote stylesheet",o)})),console.error("Error inlining remote css file",r)}}),Promise.all(i).then(()=>(n.forEach(s=>{if("cssRules"in s)try{eu(s.cssRules||[]).forEach(r=>{t.push(r)})}catch(r){console.error(`Error while reading CSS rules from ${s.href}`,r)}}),t))}function c7(n){return n.filter(e=>e.type===CSSRule.FONT_FACE_RULE).filter(e=>RR(e.style.getPropertyValue("src")))}async function u7(n,e){if(n.ownerDocument==null)throw new Error("Provided element is not within a Document");const t=eu(n.ownerDocument.styleSheets),i=await l7(t,e);return c7(i)}function OR(n){return n.trim().replace(/["']/g,"")}function h7(n){const e=new Set;function t(i){(i.style.fontFamily||getComputedStyle(i).fontFamily).split(",").forEach(r=>{e.add(OR(r))}),Array.from(i.children).forEach(r=>{r instanceof HTMLElement&&t(r)})}return t(n),e}async function d7(n,e){const t=await u7(n,e),i=h7(n);return(await Promise.all(t.filter(r=>i.has(OR(r.style.fontFamily))).map(r=>{const a=r.parentStyleSheet?r.parentStyleSheet.href:null;return LR(r.cssText,a,e)}))).join(`
`)}async function f7(n,e){const t=e.fontEmbedCSS!=null?e.fontEmbedCSS:e.skipFonts?null:await d7(n,e);if(t){const i=document.createElement("style"),s=document.createTextNode(t);i.appendChild(s),n.firstChild?n.insertBefore(i,n.firstChild):n.appendChild(i)}}async function p7(n,e={}){const{width:t,height:i}=kR(n,e),s=await aw(n,e,!0);return await f7(s,e),await MR(s,e),o7(s,e),await j9(s,t,i)}async function g7(n,e={}){const{width:t,height:i}=kR(n,e),s=await p7(n,e),r=await Fb(s),a=document.createElement("canvas"),o=a.getContext("2d"),c=e.pixelRatio||k9(),h=e.canvasWidth||t,d=e.canvasHeight||i;return a.width=h*c,a.height=d*c,e.skipAutoScale||T9(a),a.style.width=`${h}`,a.style.height=`${d}`,e.backgroundColor&&(o.fillStyle=e.backgroundColor,o.fillRect(0,0,a.width,a.height)),o.drawImage(r,0,0,a.width,a.height),a}async function m7(n,e={}){return(await g7(n,e)).toDataURL()}function x7(n,e){return n?n.length>e?n.slice(0,e)+"...":n:""}function y7(n){if(!n)return"";try{const e=new Date(n),t=e.getFullYear(),i=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return`${t}-${i}-${s}`}catch{return""}}const v7=({highlight:n,article:e,theme:t})=>{const i=`quote-${t.styles.quoteStyle}`,s=y7(new Date().toISOString());return l.jsx("div",{className:`share-card ${t.cssClass}`,style:{"--accent-color":t.styles.accentColor,borderRadius:t.styles.cardRadius,padding:t.styles.padding,fontFamily:t.styles.fontFamily},children:l.jsxs("div",{className:"card-content",children:[l.jsx("div",{className:"card-title",style:{fontSize:"1.125rem",marginBottom:"6px"},children:e.title??"æ— æ ‡é¢˜"}),l.jsxs("div",{className:"card-meta",style:{marginBottom:"16px"},children:[e.author&&l.jsx("span",{children:e.author}),e.author&&e.domain&&l.jsx("span",{children:" Â· "}),e.domain&&l.jsx("span",{className:"card-source",children:e.domain})]}),l.jsx("div",{className:i,style:{marginBottom:"14px"},children:l.jsx("span",{className:"quote-text",children:x7(n.text,300)})}),n.note&&n.note.trim()!==""&&l.jsx("div",{className:"card-note",style:{fontSize:"0.85rem",opacity:.75,marginBottom:"14px",paddingLeft:"8px"},children:n.note}),l.jsx("div",{className:"card-divider"}),l.jsxs("div",{className:"card-branding",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"4px"},children:[l.jsx("span",{children:"Z-Reader"}),l.jsx("span",{children:s})]})]})})},tT=10,b7=150;function w7(n,e){return n?n.length>e?n.slice(0,e)+"...":n:""}function S7(n){if(!n)return"";try{const e=new Date(n),t=e.getFullYear(),i=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return`${t}-${i}-${s}`}catch{return""}}const A7=({highlights:n,article:e,theme:t})=>{const i=S7(new Date().toISOString()),s=n.length,r=n.slice(0,tT),a=s-tT;return l.jsx("div",{className:`share-card ${t.cssClass}`,style:{"--accent-color":t.styles.accentColor,borderRadius:t.styles.cardRadius,padding:t.styles.padding,fontFamily:t.styles.fontFamily},children:l.jsxs("div",{className:"card-content",children:[l.jsx("div",{className:"card-title",style:{fontSize:"1.125rem",marginBottom:"6px"},children:e.title??"æ— æ ‡é¢˜"}),l.jsxs("div",{className:"card-meta",style:{marginBottom:"16px"},children:[e.author&&l.jsx("span",{children:e.author}),e.author&&e.domain&&l.jsx("span",{children:" Â· "}),e.domain&&l.jsx("span",{className:"card-source",children:e.domain})]}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px",marginBottom:"14px"},children:[r.map(o=>l.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"flex-start"},children:[l.jsx("span",{style:{color:"var(--accent-color)",flexShrink:0,lineHeight:"1.6",fontSize:"0.75rem"},children:"â—"}),l.jsxs("div",{style:{flex:1},children:[l.jsxs("span",{className:"quote-text",style:{lineHeight:"1.6"},children:["ã€Œ",w7(o.text,b7),"ã€"]}),o.note&&o.note.trim()!==""&&l.jsx("div",{className:"card-note",style:{fontSize:"0.8rem",opacity:.7,marginTop:"4px"},children:o.note})]})]},o.id)),a>0&&l.jsxs("div",{style:{fontSize:"0.8rem",opacity:.55,textAlign:"center",paddingTop:"4px"},children:["è¿˜æœ‰ ",a," æ¡é«˜äº®"]})]}),l.jsx("div",{className:"card-divider"}),l.jsxs("div",{className:"card-branding",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"4px"},children:[l.jsx("span",{children:"Z-Reader"}),l.jsxs("span",{children:["å…± ",s," æ¡é«˜äº®"]}),l.jsx("span",{children:i})]})]})})},nT=10,E7=150;function C7(n,e){return n?n.length>e?n.slice(0,e)+"...":n:""}function N7(n){if(!n)return"";try{const e=new Date(n),t=e.getFullYear(),i=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return`${t}-${i}-${s}`}catch{return""}}const _7=({highlights:n,article:e,theme:t})=>{const i=n.length,s=n.slice(0,nT),r=i-nT;return l.jsx("div",{className:`share-card ${t.cssClass}`,style:{"--accent-color":t.styles.accentColor,borderRadius:t.styles.cardRadius,padding:t.styles.padding,fontFamily:t.styles.fontFamily},children:l.jsxs("div",{className:"card-content",children:[l.jsx("div",{className:"card-title",style:{fontSize:"1.5rem",marginBottom:"8px"},children:e.title??"æ— æ ‡é¢˜"}),l.jsxs("div",{className:"card-meta",style:{marginBottom:"16px"},children:[e.author&&l.jsx("span",{children:e.author}),e.author&&e.domain&&l.jsx("span",{children:" Â· "}),e.domain&&l.jsx("span",{className:"card-source",children:e.domain}),(e.author||e.domain)&&e.publishedAt&&l.jsx("span",{children:" Â· "}),e.publishedAt&&l.jsx("span",{children:N7(e.publishedAt)})]}),l.jsx("div",{className:"card-divider"}),l.jsx("div",{style:{fontSize:"0.85rem",fontWeight:600,opacity:.65,marginBottom:"12px",letterSpacing:"0.05em"},children:"ç²¾é€‰ç¬”è®°"}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"10px",marginBottom:"14px"},children:[s.map(a=>l.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"flex-start"},children:[l.jsx("span",{style:{color:"var(--accent-color)",flexShrink:0,lineHeight:"1.6",fontSize:"0.75rem"},children:"â—"}),l.jsxs("div",{style:{flex:1},children:[l.jsxs("span",{className:"quote-text",style:{lineHeight:"1.6"},children:["ã€Œ",C7(a.text,E7),"ã€"]}),a.note&&a.note.trim()!==""&&l.jsx("div",{className:"card-note",style:{fontSize:"0.8rem",opacity:.7,marginTop:"4px"},children:a.note})]})]},a.id)),r>0&&l.jsxs("div",{style:{fontSize:"0.8rem",opacity:.55,textAlign:"center",paddingTop:"4px"},children:["è¿˜æœ‰ ",r," æ¡é«˜äº®"]})]}),l.jsx("div",{className:"card-divider"}),l.jsxs("div",{className:"card-branding",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"4px"},children:[l.jsx("span",{children:"Z-Reader"}),l.jsxs("span",{children:["å…± ",i," æ¡é«˜äº®"]})]})]})})},PR=AP.forwardRef(({cardType:n,theme:e,highlights:t,article:i},s)=>{const r=()=>{if(t.length===0)return l.jsx("div",{style:{padding:"40px 20px",textAlign:"center",opacity:.5},children:"è¯·è‡³å°‘é€‰æ‹©ä¸€æ¡é«˜äº®"});switch(n){case"single":return l.jsx(v7,{highlight:t[0],article:i,theme:e});case"multi":return l.jsx(A7,{highlights:t,article:i,theme:e});case"summary":return l.jsx(_7,{highlights:t,article:i,theme:e});default:return null}};return l.jsx("div",{ref:s,className:e.cssClass,style:{width:420,background:e.styles.background,color:e.styles.textColor,fontFamily:e.styles.fontFamily,borderRadius:e.styles.cardRadius,padding:e.styles.padding},children:r()})});PR.displayName="CardRenderer";const k7=({rendererRef:n,cardType:e,theme:t,highlights:i,article:s})=>l.jsx("div",{className:"card-preview-canvas",style:{height:560,overflowY:"auto",background:"#1a1a1a",backgroundImage:"radial-gradient(circle, rgba(255,255,255,0.08) 1px, transparent 1px)",backgroundSize:"16px 16px",borderRadius:8,display:"flex",justifyContent:"center",alignItems:"flex-start",padding:"32px 16px"},children:l.jsx(PR,{ref:n,cardType:e,theme:t,highlights:i,article:s})}),T7={id:"swiss-design",name:"Swiss Design",category:"classic",styles:{background:"#ffffff",textColor:"#1a1a1a",accentColor:"#e63333",fontFamily:'"Helvetica Neue", Helvetica, "PingFang SC", "Noto Sans SC", Arial, sans-serif',quoteStyle:"border-left",cardRadius:"0px",padding:"40px"},cssClass:"theme-swiss-design"},D7={id:"minimalism",name:"Minimalism",category:"classic",styles:{background:"#fafafa",textColor:"#333333",accentColor:"#999999",fontFamily:'"SF Pro Text", -apple-system, "PingFang SC", "Noto Sans SC", sans-serif',quoteStyle:"minimal",cardRadius:"4px",padding:"48px"},cssClass:"theme-minimalism"},j7={id:"ink-wash",name:"æ°´å¢¨",category:"artistic",styles:{background:"#f5f0e8",textColor:"#2c2416",accentColor:"#5a4a3a",fontFamily:'"Noto Serif SC", "Source Han Serif SC", "Songti SC", "SimSun", serif',quoteStyle:"border-left",cardRadius:"8px",padding:"44px"},cssClass:"theme-ink-wash"},R7={id:"cyberpunk",name:"Cyberpunk",category:"digital",styles:{background:"#0a0a0f",textColor:"#e0e0e8",accentColor:"#00ffcc",fontFamily:'"JetBrains Mono", "Fira Code", "SF Mono", "Noto Sans SC", monospace',quoteStyle:"highlight-bg",cardRadius:"0px",padding:"36px"},cssClass:"theme-cyberpunk"},L7={id:"risograph",name:"Risograph",category:"retro",styles:{background:"#fef5f0",textColor:"#1a2744",accentColor:"#e8614d",fontFamily:'"Georgia", "Noto Serif SC", "Times New Roman", serif',quoteStyle:"quotation-marks",cardRadius:"4px",padding:"40px"},cssClass:"theme-risograph"},eA=[T7,D7,j7,R7,L7],M7=n=>eA.find(e=>e.id===n)??eA[0],O7=({selectedThemeId:n,onSelectTheme:e})=>l.jsx("div",{className:"grid grid-cols-3 gap-2",children:eA.map(t=>{const i=t.id===n;return l.jsxs("button",{type:"button",onClick:()=>e(t.id),className:`
              flex flex-col items-center gap-1.5 p-2 rounded-lg cursor-pointer
              transition-all duration-150
              border-2
              ${i?"border-blue-500 ring-2 ring-blue-500/30 bg-[#2a2a30]":"border-transparent hover:border-[#444] bg-[#1e1e24]"}
            `,children:[l.jsxs("div",{className:"w-full h-10 rounded overflow-hidden relative",style:{background:t.styles.background},children:[l.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1.5",style:{background:t.styles.accentColor}}),l.jsxs("div",{className:"absolute top-2 left-2 right-4 space-y-1",children:[l.jsx("div",{className:"h-[3px] rounded-full opacity-30",style:{background:t.styles.textColor,width:"70%"}}),l.jsx("div",{className:"h-[3px] rounded-full opacity-20",style:{background:t.styles.textColor,width:"50%"}})]})]}),l.jsx("span",{className:"text-[11px] text-[#aaa] truncate w-full text-center",children:t.name})]},t.id)})}),iT={yellow:"#fbbf24",blue:"#3b82f6",green:"#22c55e",red:"#ef4444"},P7=({highlights:n,selectedIds:e,onToggle:t,onSelectAll:i,onDeselectAll:s})=>{const r=n.length>0&&e.size===n.length;return l.jsxs("div",{className:"flex flex-col gap-2",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("span",{className:"text-xs text-[#888]",children:["å·²é€‰ ",e.size,"/",n.length]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{type:"button",onClick:i,disabled:r,className:"text-xs text-blue-400 hover:text-blue-300 disabled:text-[#555] disabled:cursor-not-allowed transition-colors",children:"å…¨é€‰"}),l.jsx("button",{type:"button",onClick:s,disabled:e.size===0,className:"text-xs text-blue-400 hover:text-blue-300 disabled:text-[#555] disabled:cursor-not-allowed transition-colors",children:"å–æ¶ˆå…¨é€‰"})]})]}),l.jsx("div",{className:"flex flex-col gap-1 max-h-48 overflow-y-auto pr-1",children:n.length===0?l.jsx("p",{className:"text-xs text-[#666] text-center py-4",children:"æš‚æ— é«˜äº®"}):n.map(a=>{const o=e.has(a.id),c=iT[a.color]??iT.yellow,h=a.text?a.text.length>50?a.text.slice(0,50)+"...":a.text:"(ç©ºé«˜äº®)";return l.jsxs("label",{className:`
                  flex items-start gap-2 p-2 rounded-md cursor-pointer
                  transition-colors duration-100
                  ${o?"bg-[#2a2a35]":"hover:bg-[#1e1e28]"}
                `,children:[l.jsx("input",{type:"checkbox",checked:o,onChange:()=>t(a.id),className:"mt-0.5 h-3.5 w-3.5 rounded border-[#555] bg-transparent accent-blue-500 shrink-0"}),l.jsx("div",{className:"w-1 h-full min-h-[16px] rounded-full shrink-0",style:{background:c}}),l.jsx("span",{className:"text-xs text-[#ccc] leading-relaxed break-all",children:h})]},a.id)})})]})},I7=[{value:"single",label:"å•æ¡"},{value:"multi",label:"åˆé›†"},{value:"summary",label:"æ‘˜è¦"}],Wy=({title:n})=>l.jsx("h3",{className:"text-xs font-medium text-[#888] uppercase tracking-wider mb-2",children:n}),B7=({cardType:n,onCardTypeChange:e,selectedThemeId:t,onSelectTheme:i,highlights:s,selectedHighlightIds:r,onToggleHighlight:a,onSelectAllHighlights:o,onDeselectAllHighlights:c,onExport:h,isExporting:d})=>l.jsxs("div",{className:"flex flex-col gap-5 p-4",children:[l.jsxs("div",{children:[l.jsx(Wy,{title:"å¡ç‰‡ç±»åž‹"}),l.jsx("div",{className:"flex bg-[#1a1a20] rounded-lg p-1 gap-0.5",children:I7.map(f=>{const p=n===f.value;return l.jsx("button",{type:"button",onClick:()=>e(f.value),className:`
                  flex-1 text-xs py-1.5 rounded-md font-medium transition-all duration-150
                  ${p?"bg-[#333340] text-white shadow-sm":"text-[#888] hover:text-[#bbb]"}
                `,children:f.label},f.value)})})]}),l.jsxs("div",{children:[l.jsx(Wy,{title:"ä¸»é¢˜é£Žæ ¼"}),l.jsx(O7,{selectedThemeId:t,onSelectTheme:i})]}),(n==="multi"||n==="summary")&&l.jsxs("div",{children:[l.jsx(Wy,{title:"é€‰æ‹©é«˜äº®"}),l.jsx(P7,{highlights:s,selectedIds:r,onToggle:a,onSelectAll:o,onDeselectAll:c})]}),l.jsxs("div",{children:[l.jsx(Wy,{title:"å¯¼å‡º"}),l.jsxs("div",{className:"flex gap-2",children:[l.jsxs("button",{type:"button",onClick:()=>h("file"),disabled:d,className:`
              flex-1 flex items-center justify-center gap-1.5
              text-xs font-medium py-2 rounded-lg
              transition-all duration-150
              ${d?"bg-[#2a2a30] text-[#555] cursor-not-allowed":"bg-blue-600 hover:bg-blue-500 text-white active:scale-[0.98]"}
            `,children:[d?l.jsx(nt,{className:"w-3.5 h-3.5 animate-spin"}):l.jsx(xa,{className:"w-3.5 h-3.5"}),"ä¿å­˜å›¾ç‰‡"]}),l.jsxs("button",{type:"button",onClick:()=>h("clipboard"),disabled:d,className:`
              flex-1 flex items-center justify-center gap-1.5
              text-xs font-medium py-2 rounded-lg
              transition-all duration-150
              ${d?"bg-[#2a2a30] text-[#555] cursor-not-allowed":"bg-[#2a2a35] hover:bg-[#35353e] text-[#ccc] border border-[#444] active:scale-[0.98]"}
            `,children:[d?l.jsx(nt,{className:"w-3.5 h-3.5 animate-spin"}):l.jsx(bg,{className:"w-3.5 h-3.5"}),"å¤åˆ¶å‰ªè´´æ¿"]})]})]})]}),IR=({open:n,onClose:e,highlights:t,article:i,initialCardType:s})=>{const[r,a]=A.useState(s??(t.length===1?"single":"multi")),[o,c]=A.useState("swiss-design"),[h,d]=A.useState(()=>new Set(t.map(S=>S.id))),[f,p]=A.useState(!1),g=A.useRef(null);A.useEffect(()=>{if(!n)return;const S=_=>{_.key==="Escape"&&e()};return window.addEventListener("keydown",S),()=>window.removeEventListener("keydown",S)},[n,e]),A.useEffect(()=>{d(new Set(t.map(S=>S.id)))},[t]);const v=A.useMemo(()=>{const S=t.filter(_=>h.has(_.id));return r==="single"?S.length>0?[S[0]]:[]:S},[t,h,r]),b=A.useCallback(S=>{d(_=>{const T=new Set(_);return T.has(S)?T.delete(S):T.add(S),T})},[]),x=A.useCallback(()=>{d(new Set(t.map(S=>S.id)))},[t]),m=A.useCallback(()=>{d(new Set)},[]),y=A.useCallback(async S=>{const _=g.current;if(_){p(!0);try{const T=await m7(_,{pixelRatio:2});if(S==="file"){const j=`z-reader-${(i.title||"card").slice(0,30)}-${Date.now()}.png`;await window.electronAPI.shareCardExportImage(T,j)}else await window.electronAPI.shareCardCopyClipboard(T)}catch(T){console.error("å¯¼å‡ºå¤±è´¥:",T)}finally{p(!1)}}},[i.title]),w=A.useCallback(S=>{S.target===S.currentTarget&&e()},[e]),E=A.useMemo(()=>M7(o),[o]);return n?l.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",onClick:w,children:[l.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm"}),l.jsxs("div",{className:"relative z-10 flex flex-col bg-[#1e1e24] rounded-xl shadow-2xl border border-[#333]",style:{width:"80vw",maxWidth:960,maxHeight:"90vh"},children:[l.jsxs("div",{className:"flex items-center justify-between px-5 py-3 border-b border-[#333]",children:[l.jsx("h2",{className:"text-sm font-medium text-[#ddd]",children:"åˆ†äº«å¡ç‰‡"}),l.jsx("button",{type:"button",onClick:e,className:"p-1 rounded-md text-[#888] hover:text-white hover:bg-[#333] transition-colors",children:l.jsx(Vn,{className:"w-4 h-4"})})]}),l.jsxs("div",{className:"flex flex-1 min-h-0 overflow-hidden",children:[l.jsx("div",{className:"flex-[3] p-5 overflow-auto",children:l.jsx(k7,{rendererRef:g,cardType:r,theme:E,highlights:v,article:i})}),l.jsx("div",{className:"flex-[2] border-l border-[#333] overflow-auto",children:l.jsx(B7,{cardType:r,onCardTypeChange:a,selectedThemeId:o,onSelectTheme:c,highlights:t,selectedHighlightIds:h,onToggleHighlight:b,onSelectAllHighlights:x,onDeselectAllHighlights:m,onExport:y,isExporting:f})})]})]})]}):null};function tA(n){if(!n)return null;try{return new Date(n).toLocaleDateString("zh-CN",{year:"numeric",month:"short",day:"numeric"})}catch{return n}}const sT={yellow:"#fbbf24",blue:"#3b82f6",green:"#22c55e",red:"#ef4444"};function z7(n){const e=Date.now()-new Date(n).getTime(),t=Math.floor(e/6e4);if(t<1)return"åˆšåˆš";if(t<60)return`${t} åˆ†é’Ÿå‰`;const i=Math.floor(t/60);if(i<24)return`${i} å°æ—¶å‰`;const s=Math.floor(i/24);return s<30?`${s} å¤©å‰`:tA(n)??n}function F7({articleId:n,highlights:e,onHighlightsChange:t,onDeleteHighlight:i,onHighlightClick:s,forceTab:r,readProgress:a=0}){const{width:o,handleMouseDown:c}=Sg({defaultWidth:500,minWidth:240,maxWidth:500,storageKey:"readerDetailPanelWidth"}),[h,d]=A.useState("info"),[f,p]=A.useState(null),[g,v]=A.useState(!1),[b,x]=A.useState(null),[m,y]=A.useState("");A.useEffect(()=>{r&&d(r.tab)},[r]),A.useEffect(()=>{let P=!1;return v(!0),window.electronAPI.articleGet(n).then(Y=>{P||(p(Y),v(!1))}).catch(()=>{P||(p(null),v(!1))}),()=>{P=!0}},[n]);const w=A.useCallback(async P=>{i(P)},[i]),E=A.useCallback(async(P,Y)=>{const ge=await window.electronAPI.highlightUpdate({id:P,note:Y});t(e.map(ae=>ae.id===P?ge:ae)),x(null)},[e,t]),S=A.useCallback(async P=>{await window.electronAPI.highlightExport(n,P)},[n]),[_,T]=A.useState(!1),[j,M]=A.useState([]),[L,O]=A.useState(),B=A.useCallback((P,Y)=>{M(P),O(Y),T(!0)},[]),G=(f==null?void 0:f.mediaType)==="video",W=(f==null?void 0:f.mediaType)==="podcast",J=(f==null?void 0:f.audioDuration)||(f==null?void 0:f.duration),V=(G||W)&&J?J>=3600?`${Math.floor(J/3600)}h ${Math.floor(J%3600/60)}m`:`${Math.floor(J/60)} min`:f!=null&&f.readingTime?`${f.readingTime} min`:null,H=f?[{label:"Type",value:f.mediaType.charAt(0).toUpperCase()+f.mediaType.slice(1),icon:l.jsx(El,{className:"w-3.5 h-3.5"})},{label:"Domain",value:f.domain,icon:l.jsx(ad,{className:"w-3.5 h-3.5"})},{label:"Published",value:tA(f.publishedAt),icon:l.jsx(Ym,{className:"w-3.5 h-3.5"})},{label:G||W?"Duration":"Length",value:V,icon:l.jsx(ma,{className:"w-3.5 h-3.5"})},{label:"Progress",value:`${Math.round(a*100)}%`,icon:l.jsx(El,{className:"w-3.5 h-3.5"})},{label:"Saved",value:tA(f.savedAt),icon:l.jsx(Ym,{className:"w-3.5 h-3.5"})},{label:"Author",value:f.author,icon:l.jsx(rw,{className:"w-3.5 h-3.5"})}]:[];return l.jsxs("div",{className:"shrink-0 flex flex-col h-full min-h-0 border-l border-[#262626] bg-[#141414] relative",style:{width:o},children:[l.jsx("div",{onMouseDown:c,className:"absolute left-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500/30 active:bg-blue-500/50 z-10 transition-colors"}),l.jsx("div",{className:"shrink-0 flex gap-1.5 px-3 pt-3 pb-1 border-b border-[#262626]",children:[{key:"info",label:"Info"},{key:"notebook",label:"Notebook",count:e.length},{key:"mindmap",label:"MindMap"},{key:"chat",label:"Chat"}].map(P=>l.jsxs("button",{onClick:()=>d(P.key),className:`
              px-3 py-1.5 text-[13px] font-medium rounded-t-md transition-colors cursor-pointer flex items-center gap-1.5 relative
              ${h===P.key?"text-white":"text-gray-500 hover:text-gray-300"}
            `,children:[P.label,P.count!=null&&P.count>0&&l.jsx("span",{className:"text-[11px] text-gray-500",children:P.count}),h===P.key&&l.jsx("span",{className:"absolute bottom-[-1px] left-0 right-0 h-0.5 bg-blue-500 rounded-full"})]},P.key))}),l.jsx("div",{className:`flex-1 min-h-0 flex flex-col ${h==="chat"||h==="mindmap"?"":"overflow-y-auto p-4"}`,children:g?l.jsx("div",{className:"flex items-center justify-center h-full text-sm text-gray-500",children:"åŠ è½½ä¸­â€¦"}):f?l.jsxs(l.Fragment,{children:[h==="info"&&l.jsxs("div",{className:"flex flex-col gap-5",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-[11px] font-bold uppercase tracking-wider text-gray-500 mb-2",children:"Summary"}),l.jsx("p",{className:"text-[13px] leading-[1.6] text-gray-400",children:f.summary||"æš‚æ— æ‘˜è¦"})]}),l.jsx("div",{children:H.map(P=>l.jsxs("div",{className:"flex items-center py-2.5 border-b border-white/5 last:border-b-0",children:[l.jsxs("span",{className:"flex items-center gap-2 text-[11px] text-gray-500 w-[100px] shrink-0 font-medium",children:[l.jsx("span",{className:"text-gray-600",children:P.icon}),P.label]}),l.jsx("span",{className:"text-[13px] text-gray-300 truncate",children:P.value||"â€”"})]},P.label))})]}),h==="notebook"&&l.jsx("div",{className:"flex flex-col",children:e.length===0?l.jsx("div",{className:"flex items-center justify-center h-[300px]",children:l.jsxs("div",{className:"text-center text-gray-500",children:[l.jsx(py,{className:"w-8 h-8 mx-auto mb-2 opacity-40"}),l.jsxs("p",{className:"text-sm",children:[e.length," highlights"]})]})}):l.jsxs("div",{className:"flex flex-col gap-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("span",{className:"text-[11px] font-bold uppercase tracking-wider text-gray-500",children:[e.length," ",e.length===1?"highlight":"highlights"]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("button",{onClick:()=>S("clipboard"),className:"p-1.5 rounded hover:bg-white/10 text-gray-500 hover:text-white transition-colors cursor-pointer",title:"å¤åˆ¶åˆ°å‰ªè´´æ¿",children:l.jsx(bg,{className:"w-3.5 h-3.5"})}),l.jsx("button",{onClick:()=>S("file"),className:"p-1.5 rounded hover:bg-white/10 text-gray-500 hover:text-white transition-colors cursor-pointer",title:"ä¿å­˜ä¸ºæ–‡ä»¶",children:l.jsx(xa,{className:"w-3.5 h-3.5"})}),l.jsx("button",{onClick:()=>B(e),className:"p-1.5 rounded hover:bg-white/10 text-gray-500 hover:text-white transition-colors cursor-pointer",title:"ç”Ÿæˆåˆ†äº«å¡ç‰‡",children:l.jsx(fR,{className:"w-3.5 h-3.5"})})]})]}),[...e].sort((P,Y)=>new Date(Y.createdAt).getTime()-new Date(P.createdAt).getTime()).map(P=>l.jsxs("div",{className:"group relative flex rounded-lg bg-[#1a1a1a] border border-white/5 overflow-hidden cursor-pointer hover:border-white/15 transition-colors",onClick:()=>s==null?void 0:s(P.id),children:[l.jsx("div",{className:"w-[3px] shrink-0",style:{backgroundColor:sT[P.color]??sT.yellow}}),l.jsxs("div",{className:"flex-1 p-3 min-w-0",children:[l.jsxs("p",{className:"text-[13px] leading-[1.5] text-gray-300 italic",children:["â€œ",P.text,"â€"]}),b===P.id?l.jsx("textarea",{autoFocus:!0,value:m,onChange:Y=>y(Y.target.value),onBlur:()=>E(P.id,m),onKeyDown:Y=>{Y.key==="Enter"&&!Y.shiftKey&&(Y.preventDefault(),E(P.id,m)),Y.key==="Escape"&&x(null)},className:"mt-2 w-full text-[12px] text-gray-300 bg-white/5 border border-white/10 rounded-md px-2.5 py-1.5 resize-none outline-none focus:border-blue-500/50",rows:2,placeholder:"æ·»åŠ ç¬”è®°â€¦"}):l.jsx("button",{onClick:()=>{x(P.id),y(P.note||"")},className:"mt-1.5 block text-left text-[12px] text-gray-500 hover:text-gray-400 transition-colors w-full",children:P.note||"æ·»åŠ ç¬”è®°â€¦"}),l.jsx("span",{className:"mt-2 block text-[10px] text-gray-600",children:z7(P.createdAt)})]}),l.jsxs("div",{className:"absolute top-2 right-2 flex items-center gap-0.5 opacity-0 group-hover:opacity-100 transition-all",children:[l.jsx("button",{onClick:Y=>{Y.stopPropagation(),B([P],"single")},className:"p-1.5 rounded hover:bg-white/10 cursor-pointer text-gray-500 hover:text-blue-400",title:"ç”Ÿæˆåˆ†äº«å¡ç‰‡",children:l.jsx(yR,{className:"w-3.5 h-3.5"})}),l.jsx("button",{onClick:Y=>{Y.stopPropagation(),w(P.id)},className:"p-1.5 rounded hover:bg-white/10 cursor-pointer text-gray-500 hover:text-red-400",children:l.jsx(Wi,{className:"w-3.5 h-3.5"})})]})]},P.id))]})}),h==="chat"&&l.jsx("div",{className:"flex-1 flex flex-col min-h-0",children:l.jsx(CR,{articleId:n})}),h==="mindmap"&&l.jsx(NR,{articleId:n})]}):l.jsx("div",{className:"flex items-center justify-center h-full text-sm text-gray-500",children:"æ–‡ç« ä¸å­˜åœ¨"})}),f&&l.jsx(IR,{open:_,onClose:()=>T(!1),highlights:j,article:f,initialCardType:L})]})}const BR="z-reader-settings",zR=[{key:"system",label:"System"},{key:"serif",label:"Serif"},{key:"sans-serif",label:"Sans-serif"},{key:"monospace",label:"Monospace"}],vu=[1.5,1.75,2],U7=[{key:"dark",label:"Dark",preview:"bg-[#0f0f0f] border-gray-700"},{key:"light",label:"Light",preview:"bg-white border-gray-300"},{key:"sepia",label:"Sepia",preview:"bg-[#f4ecd8] border-amber-300"}],rT={font:"system",fontSize:16,lineHeight:1.75,theme:"dark"};function H7(){try{const n=localStorage.getItem(BR);if(n)return{...rT,...JSON.parse(n)}}catch{}return rT}function Td(n){localStorage.setItem(BR,JSON.stringify(n))}const $7={system:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',serif:'Georgia, "Times New Roman", serif',"sans-serif":'"Helvetica Neue", Arial, sans-serif',monospace:'"SF Mono", "Fira Code", "Cascadia Code", monospace'};function q7({open:n,onClose:e,settings:t,onSettingsChange:i}){const s=A.useRef(null);if(A.useEffect(()=>{if(!n)return;const a=o=>{s.current&&!s.current.contains(o.target)&&e()};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[n,e]),!n)return null;const r=a=>{const o={...t,...a};i(o),Td(o)};return l.jsxs("div",{ref:s,className:"absolute right-4 top-12 w-[280px] bg-[#1e1e1e] border border-white/10 rounded-lg shadow-2xl z-50 p-4 space-y-5",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("h3",{className:"text-[13px] font-semibold text-white",children:"Reading Settings"}),l.jsx("button",{onClick:e,className:"p-1 rounded hover:bg-white/10 text-gray-400 hover:text-white transition-colors",children:l.jsx(Vn,{size:14})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-[11px] text-gray-500 mb-1.5",children:"Font"}),l.jsx("div",{className:"grid grid-cols-2 gap-1.5",children:zR.map(a=>l.jsx("button",{onClick:()=>r({font:a.key}),className:`px-2 py-1.5 rounded text-[12px] transition-colors ${t.font===a.key?"bg-blue-500/20 text-blue-400 border border-blue-500/30":"bg-white/5 text-gray-400 hover:bg-white/10 border border-transparent"}`,children:a.label},a.key))})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[l.jsx("label",{className:"text-[11px] text-gray-500",children:"Font Size"}),l.jsxs("span",{className:"text-[11px] text-gray-400",children:[t.fontSize,"px"]})]}),l.jsx("input",{type:"range",min:14,max:22,step:1,value:t.fontSize,onChange:a=>r({fontSize:Number(a.target.value)}),className:"w-full accent-blue-500"}),l.jsxs("div",{className:"flex justify-between text-[10px] text-gray-600 mt-0.5",children:[l.jsx("span",{children:"14"}),l.jsx("span",{children:"22"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-[11px] text-gray-500 mb-1.5",children:"Line Height"}),l.jsx("div",{className:"flex gap-1.5",children:vu.map(a=>l.jsx("button",{onClick:()=>r({lineHeight:a}),className:`flex-1 px-2 py-1.5 rounded text-[12px] transition-colors ${t.lineHeight===a?"bg-blue-500/20 text-blue-400 border border-blue-500/30":"bg-white/5 text-gray-400 hover:bg-white/10 border border-transparent"}`,children:a},a))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-[11px] text-gray-500 mb-1.5",children:"Theme"}),l.jsx("div",{className:"flex gap-2",children:U7.map(a=>l.jsxs("button",{onClick:()=>r({theme:a.key}),className:`flex-1 flex flex-col items-center gap-1 p-2 rounded transition-colors ${t.theme===a.key?"ring-2 ring-blue-500":""}`,children:[l.jsx("div",{className:`w-8 h-8 rounded border ${a.preview}`}),l.jsx("span",{className:"text-[10px] text-gray-400",children:a.label})]},a.key))})]})]})}function V7({highlightId:n,currentTags:e,onTagAdd:t,onTagRemove:i,onTagCreate:s,onClose:r}){const[a,o]=A.useState([]),[c,h]=A.useState(""),d=A.useRef(null),f=A.useRef(null);A.useEffect(()=>{window.electronAPI.tagList().then(o)},[]),A.useEffect(()=>{setTimeout(()=>{var x;return(x=d.current)==null?void 0:x.focus()},50)},[]),A.useEffect(()=>{const x=m=>{f.current&&!f.current.contains(m.target)&&r()};return document.addEventListener("mousedown",x),()=>document.removeEventListener("mousedown",x)},[r]);const p=a.filter(x=>!e.some(m=>m.id===x.id)&&x.name.toLowerCase().includes(c.toLowerCase())),g=x=>{t(n,x),h("")},v=()=>{const x=c.trim();x&&(s(n,x),h(""))},b=x=>{x.key==="Enter"&&(x.preventDefault(),p.length>0?g(p[0].id):c.trim()&&v()),x.key==="Escape"&&(x.preventDefault(),r())};return l.jsxs("div",{ref:f,className:"annotation-tag-picker",onMouseDown:x=>x.stopPropagation(),children:[e.length>0&&l.jsx("div",{className:"annotation-tag-picker-current",children:e.map(x=>l.jsxs("span",{className:"annotation-tag-pill",children:[x.name,l.jsx("button",{onClick:()=>i(n,x.id),className:"annotation-tag-remove",children:l.jsx(Vn,{size:9})})]},x.id))}),l.jsx("input",{ref:d,value:c,onChange:x=>h(x.target.value),onKeyDown:b,placeholder:"æœç´¢æˆ–åˆ›å»ºæ ‡ç­¾â€¦",className:"annotation-tag-picker-input"}),l.jsxs("div",{className:"annotation-tag-picker-list",children:[p.map(x=>l.jsx("button",{onClick:()=>g(x.id),className:"annotation-tag-picker-option",children:x.name},x.id)),p.length===0&&c.trim()&&l.jsxs("button",{onClick:v,className:"annotation-tag-picker-create",children:[l.jsx(ya,{size:12}),l.jsxs("span",{children:['åˆ›å»º "',c.trim(),'"']})]}),p.length===0&&!c.trim()&&l.jsx("p",{className:"annotation-tag-picker-empty",children:"æš‚æ— å¯ç”¨æ ‡ç­¾"})]})]})}function FR(n,e){const t=n.querySelector(`mark[data-highlight-id="${e}"]`);if(!t)return null;const i=t;let s=0,r=i;for(;r&&r!==n;)s+=r.offsetTop,r=r.offsetParent;return s}function G7(n,e,t){if(!t)return[];const i=[];for(const r of n){const a=r.note&&r.note.trim().length>0,o=(e[r.id]||[]).length>0;if(!a&&!o)continue;const c=FR(t,r.id);c!==null&&i.push({highlightId:r.id,top:c,note:r.note,tags:e[r.id]||[]})}i.sort((r,a)=>r.top-a.top);const s=40;for(let r=1;r<i.length;r++)i[r].top-i[r-1].top<s&&(i[r].top=i[r-1].top+s);return i}function W7({initialValue:n,onSave:e,onCancel:t}){const[i,s]=A.useState(n),r=A.useRef(null);A.useEffect(()=>{setTimeout(()=>{var o;return(o=r.current)==null?void 0:o.focus()},50)},[]);const a=o=>{o.key==="Enter"&&(o.metaKey||o.ctrlKey)&&(o.preventDefault(),e(i.trim())),o.key==="Escape"&&(o.preventDefault(),t())};return l.jsxs("div",{className:"annotation-editor",onMouseDown:o=>o.stopPropagation(),children:[l.jsx("textarea",{ref:r,value:i,onChange:o=>s(o.target.value),onKeyDown:a,placeholder:"æ·»åŠ ç¬”è®°â€¦",className:"annotation-editor-textarea",rows:3}),l.jsxs("div",{className:"annotation-editor-actions",children:[l.jsx("button",{onClick:t,className:"annotation-editor-btn annotation-editor-btn-cancel",children:"å–æ¶ˆ"}),l.jsx("button",{onClick:()=>e(i.trim()),className:"annotation-editor-btn annotation-editor-btn-save",children:"ä¿å­˜"})]})]})}function Y7({text:n,onClick:e}){return l.jsx("div",{className:"annotation-note-display",onClick:e,title:"ç‚¹å‡»ç¼–è¾‘ç¬”è®°",children:n})}function X7({tags:n,onRemove:e,onClick:t}){return n.length===0?null:l.jsx("div",{className:"annotation-tags-display",onClick:t,children:n.map(i=>l.jsxs("span",{className:"annotation-tag-pill",children:[i.name,l.jsx("button",{className:"annotation-tag-remove",onClick:s=>{s.stopPropagation(),e(i.id)},children:"Ã—"})]},i.id))})}function K7({highlights:n,highlightTagsMap:e,editingAnnotation:t,contentRef:i,onSaveNote:s,onCancelEdit:r,onTagAdd:a,onTagRemove:o,onTagCreate:c,onStartEditNote:h,onStartEditTag:d}){const[f,p]=A.useState([]),g=A.useRef(null),v=A.useCallback(()=>{p(G7(n,e,i.current))},[n,e,i]);A.useEffect(()=>{v()},[v]),A.useEffect(()=>{if(!i.current)return;const m=new MutationObserver(()=>{v()});return m.observe(i.current,{childList:!0,subtree:!0}),()=>m.disconnect()},[i,v]);const b=!t||!i.current?null:FR(i.current,t.highlightId),x=t?n.find(m=>m.id===t.highlightId):null;return l.jsxs("div",{ref:g,className:"annotation-layer",children:[f.map(m=>(t==null?void 0:t.highlightId)===m.highlightId?null:l.jsxs("div",{className:"annotation-item",style:{top:m.top},children:[m.note&&l.jsx(Y7,{text:m.note,onClick:()=>h(m.highlightId)}),m.tags.length>0&&l.jsx(X7,{tags:m.tags,onRemove:w=>o(m.highlightId,w),onClick:()=>d(m.highlightId)})]},m.highlightId)),t&&b!==null&&l.jsxs("div",{className:"annotation-item annotation-item-editing",style:{top:b},children:[t.type==="note"&&l.jsx(W7,{initialValue:(x==null?void 0:x.note)??"",onSave:m=>s(t.highlightId,m),onCancel:r}),t.type==="tag"&&l.jsx(V7,{highlightId:t.highlightId,currentTags:e[t.highlightId]||[],onTagAdd:a,onTagRemove:o,onTagCreate:c,onClose:r})]})]})}const Dd="p, li, blockquote",aT={yellow:"rgba(251, 191, 36, 0.25)",blue:"rgba(59, 130, 246, 0.25)",green:"rgba(34, 197, 94, 0.25)",red:"rgba(239, 68, 68, 0.25)"},oT="rgba(251, 191, 36, 0.45)";function UR(n){const e=document.createTreeWalker(n,NodeFilter.SHOW_TEXT),t=[];let i;for(;i=e.nextNode();)t.push(i);return t}function Yy(n,e,t){const i=UR(n);let s=0;const r=document.createRange();let a=!1;for(const o of i){const c=o.data.length,h=s+c;if(!a&&e>=s&&e<=h&&(r.setStart(o,e-s),a=!0),a&&t>=s&&t<=h)return r.setEnd(o,t-s),r;s=h}return null}function lT(n,e,t,i){const s=[],r=document.createTreeWalker(n,NodeFilter.SHOW_TEXT);let a;for(;a=r.nextNode();){const h=a;e.intersectsNode(h)&&s.push(h)}if(s.length===0)return;const o=aT[i]??aT.yellow,c=[];for(const h of s){const d=h===e.startContainer?e.startOffset:0,f=h===e.endContainer?e.endOffset:h.data.length;f<=d||c.push({node:h,start:d,end:f})}for(let h=c.length-1;h>=0;h--){const{node:d,start:f,end:p}=c[h];let g=d;p<g.data.length&&g.splitText(p),f>0&&(g=d.splitText(f));const v=document.createElement("mark");v.dataset.highlightId=t,v.style.backgroundColor=o,v.style.borderTop=`1px solid ${oT}`,v.style.borderBottom=`1px solid ${oT}`,v.style.borderRadius="2px",v.style.padding="2px 0",v.style.color="inherit",v.style.cursor="pointer",g.parentNode.insertBefore(v,g),v.appendChild(g)}}function Z7(n,e){n.querySelectorAll(`mark[data-highlight-id="${e}"]`).forEach(t=>{const i=t.parentNode;if(i){for(;t.firstChild;)i.insertBefore(t.firstChild,t);i.removeChild(t),i.normalize()}})}function cT(n,e){let t=n;for(;t&&t!==e;){if(t instanceof HTMLElement&&t.matches(Dd))return t;t=t.parentNode}return null}function Q7(n,e){const t=[];let i=n;for(;i&&i!==e;){const s=i.parentElement;if(!s)break;const r=i.tagName.toLowerCase(),o=Array.from(s.children).filter(c=>c.tagName.toLowerCase()===r).indexOf(i)+1;if(t.unshift(`${r}:nth-of-type(${o})`),s===e)break;i=s}return t.join(" > ")}function J7(n,e){try{return n.querySelector(e)}catch{return null}}function uT(n,e){const i=(n.textContent??"").indexOf(e);return i===-1?null:{startOffset:i,endOffset:i+e.length}}function eH(n,e){const t=UR(n);if(t.length===0)return null;let i=-1,s=-1,r=0;for(let a=0;a<t.length;a++){const o=t[a],c=o.data.length;if(i<0&&(o===e.startContainer?i=r+e.startOffset:e.startContainer===o.parentNode&&e.startOffset===Array.from(o.parentNode.childNodes).indexOf(o)?i=r:e.startContainer.contains(o)&&a===0&&e.startOffset===0&&(i=0)),o===e.endContainer)s=r+e.endOffset;else if(e.endContainer===o.parentNode){const h=Array.from(o.parentNode.childNodes).indexOf(o);e.endOffset===h+1&&(s=r+c)}else e.endContainer.contains(o)&&a===t.length-1&&(s=r+c);r+=c}return i<0||s<0||i>=s?null:{startOffset:i,endOffset:s}}function tH(n){if(!n)return null;try{return new Date(n).toLocaleDateString("zh-CN",{year:"numeric",month:"short",day:"numeric"})}catch{return n}}function nH({articleId:n,onClose:e}){const[t,i]=A.useState(null),[s,r]=A.useState(null),[a,o]=A.useState(!0),[c,h]=A.useState(!1),[d,f]=A.useState(-1),[p,g]=A.useState([]),[v,b]=A.useState(null),[x,m]=A.useState(H7),[y,w]=A.useState(!1),[E,S]=A.useState([]),[_,T]=A.useState(()=>localStorage.getItem("reader-toc-collapsed")==="true"),[j,M]=A.useState(()=>localStorage.getItem("reader-detail-collapsed")==="true"),[L,O]=A.useState(0),[B,G]=A.useState(),[W,J]=A.useState(null),[V,H]=A.useState("info"),[P,Y]=A.useState({}),[ge,ae]=A.useState(!1),[ee,le]=A.useState([]);A.useEffect(()=>{B&&H(B.tab)},[B]);const ie=A.useRef(null),Q=A.useRef(null),Z=A.useRef(null),re=A.useRef(null),se=A.useRef([]),be=A.useRef(null),pe=A.useRef(0),me=A.useRef(null);se.current=p,A.useEffect(()=>{let he=!1;async function X(){o(!0);try{const je=await window.electronAPI.articleGet(n);if(he)return;if(i(je),je&&(O(je.readProgress??0),pe.current=je.readProgress??0),je!=null&&je.feedId){const ke=(await window.electronAPI.feedList()).find(Xe=>Xe.id===je.feedId);!he&&ke&&r(ke.title)}if(je&&!je.content&&je.url){h(!0);const qe=await window.electronAPI.articleParseContent(n);he||(i(qe),h(!1))}}catch{}finally{he||o(!1)}}return X(),()=>{he=!0}},[n]),A.useEffect(()=>{let he=!1;return window.electronAPI.highlightList(n).then(X=>{he||g(X)}),()=>{he=!0}},[n]);const Ne=A.useCallback(async he=>{if(he.length===0)return;const X=await window.electronAPI.highlightTagsBatch(he);Y(je=>({...je,...X}))},[]);A.useEffect(()=>{p.length>0&&Ne(p.map(he=>he.id))},[p,Ne]);const ve=A.useCallback(()=>{window.electronAPI.articleUpdate({id:n,readProgress:pe.current})},[n]);A.useEffect(()=>{const he=Q.current;if(!he)return;const X=()=>{const{scrollTop:je,scrollHeight:qe,clientHeight:ke}=he,Xe=qe-ke;if(Xe<=0)return;const ct=Math.min(je/Xe,1);pe.current=ct,O(ct),me.current&&clearTimeout(me.current),me.current=setTimeout(()=>{ve()},1e3)};return he.addEventListener("scroll",X,{passive:!0}),()=>{he.removeEventListener("scroll",X),me.current&&clearTimeout(me.current),ve()}},[ve]);const _e=A.useCallback(()=>{if(ie.current)for(const he of se.current){if(!ie.current)break;let X=null;if(he.anchorPath&&he.startOffset!=null&&he.endOffset!=null){const je=J7(ie.current,he.anchorPath);if(je&&(X=Yy(je,he.startOffset,he.endOffset),X&&he.text&&X.toString()!==he.text&&(X=null),!X&&he.text)){const qe=uT(je,he.text);qe&&(X=Yy(je,qe.startOffset,qe.endOffset))}}if(!X&&!he.anchorPath&&he.startOffset!=null&&he.endOffset!=null&&(X=Yy(ie.current,he.startOffset,he.endOffset),X&&he.text&&X.toString()!==he.text&&(X=null)),!X&&he.text){const je=uT(ie.current,he.text);je&&(X=Yy(ie.current,je.startOffset,je.endOffset))}X&&lT(ie.current,X,he.id,he.color)}},[]);A.useEffect(()=>{a||!(t!=null&&t.content)||!ie.current||(ie.current.innerHTML=t.content,setTimeout(()=>{if(!ie.current)return;const he=ie.current.querySelectorAll("h1, h2, h3, h4, h5, h6"),X=Array.from(he).map((je,qe)=>{var Xe;const ke=`heading-${qe}`;return je.id=ke,{id:ke,text:((Xe=je.textContent)==null?void 0:Xe.trim())??"",level:parseInt(je.tagName.charAt(1))}});S(X)},0))},[a,t==null?void 0:t.content]),A.useEffect(()=>{a||!(t!=null&&t.content)||!ie.current||se.current.length!==0&&(ie.current.querySelectorAll("mark[data-highlight-id]").forEach(he=>{const X=he.parentNode;if(X){for(;he.firstChild;)X.insertBefore(he.firstChild,he);X.removeChild(he),X.normalize()}}),_e())},[p,a,t==null?void 0:t.content,_e]);const We=A.useCallback(he=>{if(!ie.current)return;const X=ie.current.querySelector(`mark[data-highlight-id="${he}"]`);if(!X)return;X.scrollIntoView({behavior:"smooth",block:"center"});const je=X;je.style.transition="outline 0.2s",je.style.outline="2px solid rgba(251,191,36,0.8)",je.style.outlineOffset="2px",setTimeout(()=>{je.style.outline="none",je.style.outlineOffset="0"},1500)},[]);A.useEffect(()=>{if(!ie.current)return;const he=ie.current.querySelectorAll(Dd);he.forEach((X,je)=>{X.setAttribute("data-focused",String(je===d))}),d>=0&&he[d]&&he[d].scrollIntoView({block:"nearest"})},[d]);const Ie=A.useCallback(he=>{setTimeout(()=>{const X=window.getSelection();if(!ie.current)return;if(X&&!X.isCollapsed){if(!X.toString().trim()||!ie.current.contains(X.anchorNode))return;const ct=X.getRangeAt(0);be.current=ct.cloneRange();const Pe=ct.getBoundingClientRect();b({mode:"selection",x:Pe.left+Pe.width/2,y:Pe.top-10});return}const je=he.target,qe=je.closest("mark[data-highlight-id]");if(qe){const Xe=qe.dataset.highlightId;if(Xe){const ct=qe.getBoundingClientRect();b({mode:"highlight",highlightId:Xe,x:ct.left+ct.width/2,y:ct.top-10})}return}const ke=cT(je,ie.current);if(ke){const Xe=ie.current.querySelectorAll(Dd),ct=Array.from(Xe).indexOf(ke);ct!==-1&&f(Pe=>Pe===ct?-1:ct)}b(null)},10)},[]),Re=A.useCallback(async he=>{if(!t||!ie.current)return;const X=he.toString().trim();if(!X)return;const je=cT(he.startContainer,ie.current);let qe,ke,Xe;if(je){qe=Q7(je,ie.current);const z=eH(je,he);z&&(ke=z.startOffset,Xe=z.endOffset)}if(se.current.some(z=>!!(qe&&z.anchorPath===qe&&ke!=null&&z.startOffset===ke&&Xe!=null&&z.endOffset===Xe||z.text===X&&z.anchorPath===qe)))return;const Pe=`pending-${Date.now()}`;lT(ie.current,he,Pe,"yellow");const Qe=await window.electronAPI.highlightCreate({articleId:t.id,text:X,color:"yellow",anchorPath:qe,startOffset:ke,endOffset:Xe});g(z=>[...z,Qe]),G({tab:"notebook",ts:Date.now()}),ie.current.querySelectorAll(`mark[data-highlight-id="${Pe}"]`).forEach(z=>{z.dataset.highlightId=Qe.id});const dt=ie.current.querySelectorAll(`mark[data-highlight-id="${Qe.id}"]`);if(dt.length>0){const z=dt[0].getBoundingClientRect();b({mode:"highlight",highlightId:Qe.id,x:z.left+z.width/2,y:z.top-10})}},[t]),Ze=A.useCallback(async()=>{var X;const he=be.current;he&&(be.current=null,b(null),await Re(he),(X=window.getSelection())==null||X.removeAllRanges())},[Re]),it=A.useCallback(async he=>{await window.electronAPI.highlightDelete(he),g(X=>X.filter(je=>je.id!==he)),b(null),J(X=>(X==null?void 0:X.highlightId)===he?null:X),Y(X=>{const je={...X};return delete je[he],je}),ie.current&&Z7(ie.current,he)},[]);A.useEffect(()=>{const he=X=>{var qe,ke;if((qe=Z.current)!=null&&qe.contains(X.target)||(ke=re.current)!=null&&ke.contains(X.target))return;const je=X.target;je.closest("mark[data-highlight-id]")||je.closest(".annotation-editor, .annotation-tag-picker")||(b(null),J(null),be.current=null)};return document.addEventListener("mousedown",he),()=>document.removeEventListener("mousedown",he)},[]);const tt=A.useCallback(async(he,X)=>{const je=await window.electronAPI.highlightUpdate({id:he,note:X||void 0});g(qe=>qe.map(ke=>ke.id===he?je:ke)),J(null)},[]),rt=A.useCallback(async(he,X)=>{await window.electronAPI.highlightTagAdd(he,X);const je=await window.electronAPI.highlightTagsForHighlight(he);Y(qe=>({...qe,[he]:je}))},[]),at=A.useCallback(async(he,X)=>{await window.electronAPI.highlightTagRemove(he,X);const je=await window.electronAPI.highlightTagsForHighlight(he);Y(qe=>({...qe,[he]:je}))},[]),ze=A.useCallback(async(he,X)=>{const je=await window.electronAPI.tagCreate(X);await window.electronAPI.highlightTagAdd(he,je.id);const qe=await window.electronAPI.highlightTagsForHighlight(he);Y(ke=>({...ke,[he]:qe}))},[]);A.useEffect(()=>{const he=X=>{var ct;const je=X.target.tagName,qe=je==="INPUT"||je==="TEXTAREA";if(X.key==="Escape"){if(W){J(null);return}if(v){b(null),be.current=null,(ct=window.getSelection())==null||ct.removeAllRanges();return}if(qe){X.target.blur();return}e();return}if(X.key==="["){X.preventDefault(),T(Pe=>{const Qe=!Pe;return localStorage.setItem("reader-toc-collapsed",String(Qe)),Qe});return}if(X.key==="]"){X.preventDefault(),M(Pe=>{const Qe=!Pe;return localStorage.setItem("reader-detail-collapsed",String(Qe)),Qe});return}if(X.shiftKey&&(X.key==="r"||X.key==="R")){X.preventDefault(),t&&t.readProgress&&t.readProgress>0&&(window.electronAPI.articleUpdate({id:t.id,readProgress:0}),pe.current=0,O(0));return}if(qe)return;if(X.key==="n"&&!X.shiftKey&&!X.ctrlKey&&!X.metaKey&&d>=0&&ie.current){const Qe=ie.current.querySelectorAll(Dd)[d];if(Qe){const dt=Qe.querySelector("mark[data-highlight-id]");if(dt!=null&&dt.dataset.highlightId){X.preventDefault(),J({highlightId:dt.dataset.highlightId,type:"note"});return}}}if(X.key==="t"&&!X.shiftKey&&!X.ctrlKey&&!X.metaKey&&d>=0&&ie.current){const Qe=ie.current.querySelectorAll(Dd)[d];if(Qe){const dt=Qe.querySelector("mark[data-highlight-id]");if(dt!=null&&dt.dataset.highlightId){X.preventDefault(),J({highlightId:dt.dataset.highlightId,type:"tag"});return}}}if(X.shiftKey&&X.key==="T"&&!X.ctrlKey&&!X.metaKey){X.preventDefault(),M(!1),localStorage.setItem("reader-detail-collapsed","false"),G({tab:"info",ts:Date.now()});return}if(X.shiftKey&&X.key==="N"&&!X.ctrlKey&&!X.metaKey){X.preventDefault(),M(!1),localStorage.setItem("reader-detail-collapsed","false"),G({tab:"notebook",ts:Date.now()});return}if(X.shiftKey&&X.key==="C"&&!X.ctrlKey&&!X.metaKey){X.preventDefault(),t!=null&&t.url&&navigator.clipboard.writeText(t.url);return}if(X.ctrlKey&&X.shiftKey&&(X.key==="F"||X.key==="f")){X.preventDefault();const Pe=zR.map(Se=>Se.key),Qe=Pe.indexOf(x.font),dt=Pe[(Qe+1)%Pe.length],z={...x,font:dt};m(z),Td(z);return}if(X.key==="_"){X.preventDefault();const Pe=Math.max(14,x.fontSize-1),Qe={...x,fontSize:Pe};m(Qe),Td(Qe);return}if(X.key==="+"){X.preventDefault();const Pe=Math.min(22,x.fontSize+1),Qe={...x,fontSize:Pe};m(Qe),Td(Qe);return}if(X.key===":"){X.preventDefault();const Pe=vu.indexOf(x.lineHeight),Qe=Pe<=0?vu.length-1:Pe-1,dt={...x,lineHeight:vu[Qe]};m(dt),Td(dt);return}if(X.key==='"'){X.preventDefault();const Qe=(vu.indexOf(x.lineHeight)+1)%vu.length,dt={...x,lineHeight:vu[Qe]};m(dt),Td(dt);return}if(X.key==="o"&&!X.shiftKey&&!X.ctrlKey&&!X.metaKey){X.preventDefault(),t!=null&&t.url&&window.electronAPI.externalOpenUrl(t.url);return}if(X.key==="`"&&!X.shiftKey&&!X.ctrlKey&&!X.metaKey){X.preventDefault();const Pe=["info","notebook","chat"],Qe=Pe.indexOf(V),dt=Pe[(Qe+1)%Pe.length];H(dt),M(!1),localStorage.setItem("reader-detail-collapsed","false"),G({tab:dt,ts:Date.now()});return}if(X.key==="~"){X.preventDefault();const Pe=["info","notebook","chat"],Qe=Pe.indexOf(V),dt=Pe[(Qe-1+Pe.length)%Pe.length];H(dt),M(!1),localStorage.setItem("reader-detail-collapsed","false"),G({tab:dt,ts:Date.now()});return}if(!ie.current)return;const ke=ie.current.querySelectorAll(Dd),Xe=ke.length;if(Xe!==0){if(X.key==="j"||X.key==="ArrowDown")X.preventDefault(),f(Pe=>Math.min(Pe+1,Xe-1));else if(X.key==="k"||X.key==="ArrowUp")X.preventDefault(),f(Pe=>Math.max(Pe-1,0));else if(X.key==="h"||X.key==="H"){X.preventDefault();const Pe=window.getSelection();if(Pe&&!Pe.isCollapsed&&ie.current.contains(Pe.anchorNode)){const Qe=Pe.getRangeAt(0).cloneRange();Pe.removeAllRanges(),b(null),Re(Qe);return}if(d>=0){const Qe=ke[d];if(Qe){const dt=Qe.querySelector("mark[data-highlight-id]");if(dt){const Se=dt.dataset.highlightId;if(Se){it(Se);return}}const z=document.createRange();z.selectNodeContents(Qe),Re(z)}}}}};return document.addEventListener("keydown",he),()=>document.removeEventListener("keydown",he)},[e,v,W,d,t,Re,it,x,V]);const ft=a||c,Kt=x.theme==="light"?"reader-theme-light":x.theme==="sepia"?"reader-theme-sepia":"reader-theme-dark";return l.jsxs("div",{className:`flex flex-1 h-full overflow-hidden ${Kt}`,children:[l.jsxs("div",{className:`shrink-0 flex flex-col border-r border-[#262626] bg-[#141414] transition-all duration-200 overflow-hidden ${_?"w-0 border-r-0":"w-[220px]"}`,children:[l.jsxs("div",{className:"shrink-0 flex items-center justify-between px-4 h-12 border-b border-[#262626]",children:[l.jsx("button",{onClick:e,className:"p-1.5 rounded hover:bg-white/10 transition-colors cursor-pointer text-gray-400 hover:text-white",title:"è¿”å›žåˆ—è¡¨",children:l.jsx(ng,{className:"w-4 h-4"})}),l.jsx("h2",{className:"text-[13px] font-semibold text-white tracking-wide",children:"Contents"}),l.jsx("div",{className:"w-6"})]}),l.jsx("div",{className:"flex-1 overflow-y-auto p-2",children:E.length>0?l.jsx("ul",{className:"space-y-0.5",children:E.map(he=>l.jsx("li",{children:l.jsx("button",{onClick:()=>{var X;(X=document.getElementById(he.id))==null||X.scrollIntoView({behavior:"smooth",block:"start"})},className:"text-[13px] text-gray-400 hover:text-white hover:bg-white/5 rounded-md px-3 py-1.5 text-left truncate w-full transition-colors cursor-pointer",style:{paddingLeft:`${12+(he.level-1)*12}px`},children:he.text})},he.id))}):l.jsx("p",{className:"px-3 py-4 text-[13px] text-gray-500",children:ft?"åŠ è½½ä¸­â€¦":"æ­¤æ–‡ç« æ²¡æœ‰ç« èŠ‚æ ‡é¢˜"})})]}),l.jsxs("div",{className:"relative flex-1 flex flex-col overflow-hidden",children:[l.jsxs("div",{className:"shrink-0 flex items-center justify-between px-6 h-12 border-b border-[#262626]",children:[l.jsxs("div",{className:"flex items-center gap-1.5 text-[12px] min-w-0 truncate",children:[_&&l.jsx("button",{onClick:e,className:"p-1 rounded hover:bg-white/10 transition-colors cursor-pointer text-gray-400 hover:text-white shrink-0",title:"è¿”å›žåˆ—è¡¨",children:l.jsx(ng,{className:"w-4 h-4"})}),l.jsx("button",{onClick:()=>T(he=>{const X=!he;return localStorage.setItem("reader-toc-collapsed",String(X)),X}),className:"p-1 rounded hover:bg-white/10 transition-colors cursor-pointer text-gray-400 hover:text-white shrink-0",title:_?"å±•å¼€ç›®å½•":"æ”¶èµ·ç›®å½•",children:_?l.jsx(WC,{className:"w-4 h-4"}):l.jsx(J1,{className:"w-4 h-4"})}),s&&l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"text-gray-500 truncate",children:s}),l.jsx("span",{className:"text-gray-600",children:">"})]}),l.jsx("span",{className:"text-gray-400 truncate",children:(t==null?void 0:t.title)??"åŠ è½½ä¸­â€¦"})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("button",{onClick:()=>w(!y),className:"p-1.5 rounded hover:bg-white/10 transition-colors cursor-pointer text-gray-400 hover:text-white",title:"æŽ’ç‰ˆè®¾ç½®",children:l.jsx(Bb,{className:"w-4 h-4"})}),l.jsx("button",{onClick:()=>M(he=>{const X=!he;return localStorage.setItem("reader-detail-collapsed",String(X)),X}),className:"p-1.5 rounded hover:bg-white/10 transition-colors cursor-pointer text-gray-400 hover:text-white",title:j?"å±•å¼€è¯¦æƒ…":"æ”¶èµ·è¯¦æƒ…",children:j?l.jsx(tw,{className:"w-4 h-4"}):l.jsx(ew,{className:"w-4 h-4"})})]})]}),l.jsx(q7,{open:y,onClose:()=>w(!1),settings:x,onSettingsChange:m}),l.jsx("div",{className:"shrink-0 h-[2px] bg-white/5",children:l.jsx("div",{className:"h-full bg-blue-500 transition-[width] duration-300",style:{width:`${Math.round(L*100)}%`}})}),l.jsx("div",{ref:Q,className:"flex-1 overflow-y-auto",children:ft?l.jsxs("div",{className:"flex flex-col items-center justify-center h-full gap-3",children:[l.jsx(nt,{className:"w-6 h-6 text-gray-500 animate-spin"}),l.jsx("span",{className:"text-sm text-gray-500",children:c?"æ­£åœ¨è§£æžæ–‡ç« å†…å®¹â€¦":"åŠ è½½ä¸­â€¦"})]}):t?l.jsxs("div",{className:"relative",children:[l.jsxs("div",{className:"mx-auto max-w-[680px] px-8 py-10",children:[l.jsx("h1",{className:"text-[28px] font-bold leading-tight text-white",children:t.title}),l.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-x-3 gap-y-1 text-[13px] text-gray-500",children:[t.author&&l.jsx("span",{children:t.author}),t.domain&&l.jsx("span",{children:t.domain}),t.publishedAt&&l.jsx("span",{children:tH(t.publishedAt)}),t.readingTime&&l.jsxs("span",{children:[t.readingTime," min read"]})]}),t.content?l.jsx("div",{ref:ie,className:"article-content mt-8",style:{fontFamily:$7[x.font],fontSize:`${x.fontSize}px`,lineHeight:x.lineHeight},onMouseUp:Ie}):l.jsx("p",{className:"mt-8 text-gray-500 text-sm",children:"æš‚æ— æ­£æ–‡å†…å®¹"})]}),l.jsx("div",{ref:re,children:l.jsx(K7,{highlights:p,highlightTagsMap:P,editingAnnotation:W,contentRef:ie,onSaveNote:tt,onCancelEdit:()=>J(null),onTagAdd:rt,onTagRemove:at,onTagCreate:ze,onStartEditNote:he=>J({highlightId:he,type:"note"}),onStartEditTag:he=>J({highlightId:he,type:"tag"})})})]}):l.jsx("div",{className:"flex items-center justify-center h-full text-sm text-gray-500",children:"æ–‡ç« ä¸å­˜åœ¨"})})]}),v&&l.jsx("div",{ref:Z,className:"fixed z-[9999] flex items-center gap-0.5 px-1.5 py-1 bg-[#2a2a2a] rounded-full shadow-xl border border-white/10",style:{left:v.x,top:v.y,transform:"translate(-50%, -100%)"},children:v.mode==="selection"?l.jsx("button",{onClick:Ze,className:"w-7 h-7 flex items-center justify-center rounded-full bg-amber-500/20 hover:bg-amber-500/30 transition-colors cursor-pointer",title:"é«˜äº®",children:l.jsx(py,{className:"w-3.5 h-3.5 text-amber-400"})}):l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:()=>v.highlightId&&it(v.highlightId),className:"w-7 h-7 flex items-center justify-center rounded-full bg-[#4a3a1a] hover:bg-[#5a4520] transition-colors cursor-pointer",title:"åˆ é™¤é«˜äº®",children:l.jsx(Vn,{className:"w-3.5 h-3.5 text-amber-400"})}),l.jsx("button",{onClick:()=>{v.highlightId&&(J({highlightId:v.highlightId,type:"note"}),b(null))},className:"w-7 h-7 flex items-center justify-center rounded-full hover:bg-white/10 transition-colors cursor-pointer text-gray-400 hover:text-white",title:"æ·»åŠ ç¬”è®°",children:l.jsx(xR,{className:"w-3.5 h-3.5"})}),l.jsx("button",{onClick:()=>{v.highlightId&&(J({highlightId:v.highlightId,type:"tag"}),b(null))},className:"w-7 h-7 flex items-center justify-center rounded-full hover:bg-white/10 transition-colors cursor-pointer text-gray-400 hover:text-white",title:"æ·»åŠ æ ‡ç­¾",children:l.jsx(sw,{className:"w-3.5 h-3.5"})}),l.jsx("button",{onClick:()=>{if(v.highlightId){const he=p.find(X=>X.id===v.highlightId);he&&(le([he]),ae(!0)),b(null)}},className:"w-7 h-7 flex items-center justify-center rounded-full hover:bg-white/10 transition-colors cursor-pointer text-gray-400 hover:text-white",title:"ç”Ÿæˆåˆ†äº«å¡ç‰‡",children:l.jsx(fR,{className:"w-3.5 h-3.5"})}),l.jsx("button",{className:"w-7 h-7 flex items-center justify-center rounded-full hover:bg-white/10 transition-colors cursor-pointer text-gray-400 hover:text-white",title:"æ›´å¤š",children:l.jsx(oR,{className:"w-3.5 h-3.5"})})]})}),l.jsx("div",{className:`shrink-0 h-full overflow-hidden ${j?"w-0":""}`,children:l.jsx(F7,{articleId:n,highlights:p,onHighlightsChange:g,onDeleteHighlight:it,onHighlightClick:We,forceTab:B,readProgress:L})}),t&&l.jsx(IR,{open:ge,onClose:()=>ae(!1),highlights:ee,article:t,initialCardType:"single"})]})}const iH=[{id:"inbox",label:"Go to Inbox",shortcut:"1",icon:ZS},{id:"later",label:"Go to Later",shortcut:"2",icon:ma},{id:"archive",label:"Go to Archive",shortcut:"3",icon:tg},{id:"archive-article",label:"Archive Article",shortcut:"E",icon:tg},{id:"later-article",label:"Read Later",shortcut:"L",icon:ma},{id:"delete-article",label:"Delete Article",shortcut:"D",icon:Wi},{id:"open-reader",label:"Open in Reader",shortcut:"Enter",icon:qr},{id:"search",label:"Search",shortcut:"/",icon:wg}];function sH({open:n,onClose:e,onExecute:t}){const[i,s]=A.useState(""),[r,a]=A.useState(0),o=A.useRef(null),c=iH.filter(f=>f.label.toLowerCase().includes(i.toLowerCase()));A.useEffect(()=>{n&&(s(""),a(0),requestAnimationFrame(()=>{var f;return(f=o.current)==null?void 0:f.focus()}))},[n]),A.useEffect(()=>{a(0)},[i]);const h=A.useCallback(f=>{e(),t(f)},[e,t]),d=A.useCallback(f=>{switch(f.key){case"ArrowDown":f.preventDefault(),a(p=>p<c.length-1?p+1:0);break;case"ArrowUp":f.preventDefault(),a(p=>p>0?p-1:c.length-1);break;case"Enter":f.preventDefault(),c[r]&&h(c[r].id);break;case"Escape":f.preventDefault(),e();break}},[c,r,h,e]);return n?l.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-start justify-center pt-[20%]",onClick:e,children:l.jsxs("div",{className:"w-[520px] bg-[#1a1a1a] rounded-xl border border-white/10 shadow-2xl",onClick:f=>f.stopPropagation(),onKeyDown:d,children:[l.jsx("input",{ref:o,type:"text",value:i,onChange:f=>s(f.target.value),placeholder:"Type a command...",className:"w-full bg-transparent border-b border-white/5 px-4 py-3 text-white text-sm placeholder:text-gray-500 outline-none"}),l.jsxs("div",{className:"max-h-[320px] overflow-y-auto py-1",children:[c.map((f,p)=>{const g=f.icon;return l.jsxs("button",{onClick:()=>h(f.id),className:`w-full px-4 py-2.5 flex items-center justify-between cursor-pointer transition-colors ${p===r?"bg-white/[0.06]":"hover:bg-white/5"}`,children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(g,{size:16,className:"text-gray-400"}),l.jsx("span",{className:"text-sm text-gray-200",children:f.label})]}),l.jsx("span",{className:"text-[11px] text-gray-500 bg-white/5 rounded px-1.5 py-0.5",children:f.shortcut})]},f.id)}),c.length===0&&l.jsx("div",{className:"px-4 py-6 text-center text-sm text-gray-500",children:"No matching commands"})]})]})}):null}function rH({onSubscribed:n}){const[e,t]=A.useState(""),[i,s]=A.useState("show"),[r,a]=A.useState([]),[o,c]=A.useState(!1),[h,d]=A.useState(null),[f,p]=A.useState(new Set),[g,v]=A.useState(!1),b=A.useRef(null),{showToast:x}=Sa();A.useEffect(()=>{setTimeout(()=>{var S;return(S=b.current)==null?void 0:S.focus()},100)},[]),A.useEffect(()=>{window.electronAPI.feedList().then(S=>{const _=new Set(S.map(T=>T.url));p(_)}).catch(()=>{})},[]);const m=/^https?:\/\//i.test(e.trim()),y=A.useCallback(async()=>{const S=e.trim();if(S){if(/^https?:\/\//i.test(S)){v(!0),a([]);try{const _=await window.electronAPI.podcastResolveUrl(S);_!=null&&_.feedUrl?a([{title:_.title??"Podcast",author:_.author??null,image:_.image??null,feedUrl:_.feedUrl,website:S,source:"itunes",id:_.feedUrl}]):x("æ— æ³•è§£æžè¯¥ URLï¼Œè¯·å°è¯•ç›´æŽ¥ç²˜è´´ RSS åœ°å€")}catch{x("URL è§£æžå¤±è´¥")}finally{v(!1)}return}c(!0),a([]);try{const _=await window.electronAPI.podcastSearch({query:S,type:i,limit:20});a(_)}catch{x("æœç´¢å¤±è´¥ï¼Œè¯·ç¨åŽé‡è¯•")}finally{c(!1)}}},[e,i,x]),w=A.useCallback(S=>{S.key==="Enter"&&(S.preventDefault(),y())},[y]),E=A.useCallback(async S=>{if(!S.feedUrl){x("è¯¥æ’­å®¢æ—  RSS åœ°å€");return}if(f.has(S.feedUrl)){x("å·²è®¢é˜…è¯¥æ’­å®¢");return}d(S.id);try{await window.electronAPI.feedAdd({url:S.feedUrl,title:S.title||void 0}),p(_=>new Set(_).add(S.feedUrl)),x(`å·²è®¢é˜…ã€Œ${S.title}ã€`),n==null||n()}catch(_){const T=_ instanceof Error?_.message:"è®¢é˜…å¤±è´¥";x(T)}finally{d(null)}},[f,x,n]);return l.jsxs("div",{className:"flex flex-col gap-4",children:[l.jsxs("div",{className:"flex gap-2",children:[l.jsxs("div",{className:"relative flex-1",children:[l.jsx(wg,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500"}),l.jsx("input",{ref:b,type:"text",value:e,onChange:S=>t(S.target.value),onKeyDown:w,placeholder:"æœç´¢æ’­å®¢åç§°æˆ–ç²˜è´´ URL...",className:"w-full pl-9 pr-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),!m&&l.jsxs("div",{className:"flex rounded-md overflow-hidden border border-white/10 shrink-0",children:[l.jsx("button",{onClick:()=>s("show"),className:`px-3 py-2 text-xs font-medium transition-colors cursor-pointer ${i==="show"?"bg-blue-600 text-white":"bg-[#111] text-gray-400 hover:text-white"}`,children:"èŠ‚ç›®"}),l.jsx("button",{onClick:()=>s("episode"),className:`px-3 py-2 text-xs font-medium transition-colors cursor-pointer ${i==="episode"?"bg-blue-600 text-white":"bg-[#111] text-gray-400 hover:text-white"}`,children:"å•é›†"})]}),l.jsx("button",{onClick:y,disabled:!e.trim()||o||g,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-700 disabled:cursor-not-allowed text-white text-sm font-medium rounded-md transition-colors cursor-pointer shrink-0",children:o||g?l.jsx(nt,{size:16,className:"animate-spin"}):"æœç´¢"})]}),(o||g)&&r.length===0&&l.jsxs("div",{className:"flex items-center justify-center py-8",children:[l.jsx(nt,{size:20,className:"animate-spin text-gray-500"}),l.jsx("span",{className:"ml-2 text-sm text-gray-500",children:g?"æ­£åœ¨è§£æž URL...":"æœç´¢ä¸­..."})]}),!o&&!g&&r.length===0&&e.trim()&&l.jsx("div",{className:"text-center py-8 text-sm text-gray-500",children:"æœªæ‰¾åˆ°ç»“æžœã€‚è¯•è¯•å…¶ä»–å…³é”®è¯æˆ–ç²˜è´´ RSS åœ°å€ã€‚"}),r.length>0&&l.jsx("div",{className:"flex flex-col gap-1 max-h-[400px] overflow-y-auto",children:r.map(S=>{const _=S.feedUrl?f.has(S.feedUrl):!1,T=h===S.id;return l.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-md hover:bg-white/5 transition-colors group",children:[S.image?l.jsx("img",{src:S.image,alt:"",className:"w-12 h-12 rounded-md object-cover shrink-0"}):l.jsx("div",{className:"w-12 h-12 rounded-md bg-gray-800 flex items-center justify-center shrink-0",children:l.jsx(hu,{size:18,className:"text-gray-600"})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("div",{className:"text-sm font-medium text-gray-200 truncate",children:S.title}),S.author&&l.jsx("div",{className:"text-xs text-gray-500 truncate",children:S.author}),S.feedUrl&&l.jsx("div",{className:"text-[10px] text-gray-600 truncate mt-0.5",children:S.feedUrl})]}),l.jsx("button",{onClick:()=>E(S),disabled:_||T||!S.feedUrl,className:`shrink-0 flex items-center gap-1.5 px-3 py-1.5 rounded-md text-xs font-medium transition-colors cursor-pointer ${_?"bg-green-900/30 text-green-400 cursor-default":S.feedUrl?"bg-blue-600 hover:bg-blue-700 text-white":"bg-gray-800 text-gray-600 cursor-not-allowed"}`,children:T?l.jsx(nt,{size:14,className:"animate-spin"}):_?l.jsxs(l.Fragment,{children:[l.jsx(yg,{size:14}),l.jsx("span",{children:"å·²è®¢é˜…"})]}):l.jsxs(l.Fragment,{children:[l.jsx(ya,{size:14}),l.jsx("span",{children:"è®¢é˜…"})]})})]},`${S.source}-${S.id}`)})}),l.jsx("p",{className:"text-xs text-gray-600 px-1",children:"æ”¯æŒæœç´¢æ’­å®¢åç§°ï¼Œæˆ–ç²˜è´´ Apple Podcasts / Spotify / å°å®‡å®™ / RSS é“¾æŽ¥"})]})}function aH({open:n,onClose:e,onFeedAdded:t}){const{t:i}=Bi(),[s,r]=A.useState("rss"),[a,o]=A.useState(""),[c,h]=A.useState(""),[d,f]=A.useState(""),[p,g]=A.useState(!1),v=A.useRef(null),b=A.useRef(null),{showToast:x}=Sa(),[m,y]=A.useState(""),[w,E]=A.useState(null),[S,_]=A.useState(""),T=A.useRef(null),[j,M]=A.useState(""),[L,O]=A.useState(""),[B,G]=A.useState(null),[W,J]=A.useState(!1);A.useEffect(()=>{n&&(o(""),h(""),f(""),M(""),O(""),G(null),J(!1),y(""),E(null),_(""),s==="rss"?setTimeout(()=>{var le;return(le=v.current)==null?void 0:le.focus()},100):s==="newsletter"?setTimeout(()=>{var le;return(le=b.current)==null?void 0:le.focus()},100):s==="wechat"&&setTimeout(()=>{var le;return(le=T.current)==null?void 0:le.focus()},100))},[n,s]),A.useEffect(()=>{if(!n)return;const le=ie=>{ie.key==="Escape"&&(ie.stopImmediatePropagation(),e())};return document.addEventListener("keydown",le),()=>document.removeEventListener("keydown",le)},[n,e]);const V=async le=>{if(le.preventDefault(),!!a.trim()){g(!0);try{await window.electronAPI.feedAdd({url:a.trim(),title:c.trim()||void 0,category:d.trim()||void 0}),x(i("dialog.addFeed.addSuccess")),e(),t==null||t()}catch(ie){console.error("æ·»åŠ è®¢é˜…å¤±è´¥:",ie),x(i("dialog.addFeed.addFailed"))}finally{g(!1)}}},H=async()=>{g(!0);try{const le=await window.electronAPI.feedImportOpml();le.length>0?(x(i("dialog.addFeed.addSuccess")+`: ${le.length} feeds`),e(),t==null||t()):x("No feeds imported")}catch(le){console.error("å¯¼å…¥ OPML å¤±è´¥:",le),x("Failed to import OPML")}finally{g(!1)}},P=()=>{t==null||t()},Y=async le=>{if(le.preventDefault(),!!j.trim()){g(!0);try{const ie=await window.electronAPI.newsletterCreate({name:j.trim(),category:L.trim()||void 0});G({email:ie.email,feedUrl:ie.feedUrl}),x("Newsletter created"),t==null||t()}catch(ie){console.error("åˆ›å»º Newsletter å¤±è´¥:",ie),x("Failed to create newsletter")}finally{g(!1)}}},ge=async()=>{if(m.trim()){g(!0),E(null);try{const le=await window.electronAPI.wechatParseArticleUrl(m.trim());if(!le){x("æ— æ³•è¯†åˆ«å¾®ä¿¡å…¬ä¼—å·ä¿¡æ¯ï¼Œè¯·æ£€æŸ¥ URL");return}E(le)}catch(le){console.error("è§£æžå¾®ä¿¡æ–‡ç«  URL å¤±è´¥:",le),x("æ— æ³•è¯†åˆ«å¾®ä¿¡å…¬ä¼—å·ä¿¡æ¯ï¼Œè¯·æ£€æŸ¥ URL")}finally{g(!1)}}},ae=async()=>{if(w){g(!0);try{await window.electronAPI.feedAdd({url:w.homeUrl,title:w.nickname,category:S.trim()||"å¾®ä¿¡å…¬ä¼—å·",feedType:"wechat",wechatBiz:w.biz}),x(`å·²æ·»åŠ å…¬ä¼—å·ã€Œ${w.nickname}ã€`),e(),t==null||t()}catch(le){console.error("æ·»åŠ å¾®ä¿¡å…¬ä¼—å·å¤±è´¥:",le),x("æ·»åŠ å¤±è´¥ï¼Œè¯·é‡è¯•")}finally{g(!1)}}},ee=async()=>{if(B)try{await navigator.clipboard.writeText(B.email),J(!0),x(i("common.copy")+" success"),setTimeout(()=>J(!1),2e3)}catch{x(i("common.copy")+" failed")}};return n?l.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[l.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:e}),l.jsxs("div",{className:"relative w-full max-w-lg bg-[#1a1a1a] border border-white/10 rounded-lg shadow-2xl",children:[l.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-white/10",children:[l.jsx("h2",{className:"text-lg font-semibold text-white",children:i("dialog.addFeed.title")}),l.jsx("button",{onClick:e,className:"p-1 rounded hover:bg-white/10 text-gray-400 hover:text-white transition-colors",disabled:p,children:l.jsx(Vn,{size:20})})]}),l.jsxs("div",{className:"flex border-b border-white/10 px-6",children:[l.jsxs("button",{onClick:()=>r("rss"),className:`flex items-center gap-2 px-4 py-2.5 text-sm font-medium border-b-2 transition-colors cursor-pointer ${s==="rss"?"border-blue-500 text-white":"border-transparent text-gray-400 hover:text-gray-200"}`,children:[l.jsx(hu,{size:16}),"RSS / YouTube"]}),l.jsxs("button",{onClick:()=>r("podcast"),className:`flex items-center gap-2 px-4 py-2.5 text-sm font-medium border-b-2 transition-colors cursor-pointer ${s==="podcast"?"border-blue-500 text-white":"border-transparent text-gray-400 hover:text-gray-200"}`,children:[l.jsx(nw,{size:16}),"æ’­å®¢"]}),l.jsxs("button",{onClick:()=>r("wechat"),className:`flex items-center gap-2 px-4 py-2.5 text-sm font-medium border-b-2 transition-colors cursor-pointer ${s==="wechat"?"border-blue-500 text-white":"border-transparent text-gray-400 hover:text-gray-200"}`,children:[l.jsx(so,{size:16}),"å¾®ä¿¡"]}),l.jsxs("button",{onClick:()=>r("newsletter"),className:`flex items-center gap-2 px-4 py-2.5 text-sm font-medium border-b-2 transition-colors cursor-pointer ${s==="newsletter"?"border-blue-500 text-white":"border-transparent text-gray-400 hover:text-gray-200"}`,children:[l.jsx(Bk,{size:16}),"Newsletter"]})]}),s==="rss"?l.jsxs(l.Fragment,{children:[l.jsxs("form",{onSubmit:V,className:"p-6 space-y-4",children:[l.jsxs("div",{children:[l.jsxs("label",{htmlFor:"feed-url",className:"block text-sm font-medium text-gray-300 mb-1.5",children:["RSS URL ",l.jsx("span",{className:"text-red-400",children:"*"})]}),l.jsx("input",{ref:v,id:"feed-url",type:"text",value:a,onChange:le=>o(le.target.value),placeholder:"https://example.com/feed.xml æˆ– YouTube é¢‘é“ URL",className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:p})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"feed-title",className:"block text-sm font-medium text-gray-300 mb-1.5",children:"è®¢é˜…åç§° (å¯é€‰)"}),l.jsx("input",{id:"feed-title",type:"text",value:c,onChange:le=>h(le.target.value),placeholder:"è‡ªåŠ¨ä»Ž RSS èŽ·å–",className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:p})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"feed-category",className:"block text-sm font-medium text-gray-300 mb-1.5",children:"åˆ†ç±» (å¯é€‰)"}),l.jsx("input",{id:"feed-category",type:"text",value:d,onChange:le=>f(le.target.value),placeholder:"ä¾‹å¦‚: æŠ€æœ¯ã€æ–°é—»ã€åšå®¢",className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:p})]}),l.jsxs("div",{className:"flex gap-3 pt-2",children:[l.jsx("button",{type:"submit",disabled:p||!a.trim(),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-700 disabled:cursor-not-allowed text-white text-sm font-medium rounded-md transition-colors",children:p?l.jsxs(l.Fragment,{children:[l.jsx(nt,{size:16,className:"animate-spin"}),l.jsx("span",{children:"æ·»åŠ ä¸­..."})]}):l.jsxs(l.Fragment,{children:[l.jsx(ya,{size:16}),l.jsx("span",{children:"æ·»åŠ è®¢é˜…"})]})}),l.jsxs("button",{type:"button",onClick:H,disabled:p,className:"flex items-center justify-center gap-2 px-4 py-2 bg-gray-700 hover:bg-gray-600 disabled:bg-gray-800 disabled:cursor-not-allowed text-white text-sm font-medium rounded-md transition-colors",title:"å¯¼å…¥ OPML æ–‡ä»¶",children:[l.jsx(t8,{size:16}),l.jsx("span",{children:"å¯¼å…¥ OPML"})]})]})]}),l.jsx("div",{className:"px-6 pb-6 pt-0",children:l.jsx("p",{className:"text-xs text-gray-500",children:"æç¤º: å¯ä»¥ç›´æŽ¥è¾“å…¥ RSS URLã€ç½‘ç«™é¦–é¡µæˆ– YouTube é¢‘é“é“¾æŽ¥"})})]}):s==="podcast"?l.jsx("div",{className:"p-6",children:l.jsx(rH,{onSubscribed:P})}):s==="wechat"?l.jsxs("div",{className:"p-6 space-y-4",children:[l.jsxs("div",{children:[l.jsxs("label",{htmlFor:"wechat-url",className:"block text-sm font-medium text-gray-300 mb-1.5",children:["å¾®ä¿¡æ–‡ç« é“¾æŽ¥ ",l.jsx("span",{className:"text-red-400",children:"*"})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("input",{ref:T,id:"wechat-url",type:"text",value:m,onChange:le=>y(le.target.value),onKeyDown:le=>{le.key==="Enter"&&(le.preventDefault(),ge())},placeholder:"ç²˜è´´ä»»æ„å¾®ä¿¡å…¬ä¼—å·æ–‡ç« é“¾æŽ¥",className:"flex-1 px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:p}),l.jsx("button",{type:"button",onClick:ge,disabled:p||!m.trim(),className:"shrink-0 px-4 py-2 bg-green-600 hover:bg-green-700 disabled:bg-gray-700 disabled:cursor-not-allowed text-white text-sm font-medium rounded-md transition-colors cursor-pointer",children:p&&!w?"è§£æžä¸­...":"è§£æž"})]}),l.jsx("p",{className:"mt-1.5 text-xs text-gray-500",children:"æç¤º: ç²˜è´´ä»»æ„è¯¥å…¬ä¼—å·çš„æ–‡ç« é“¾æŽ¥ï¼Œä¼šè‡ªåŠ¨è¯†åˆ«å…¬ä¼—å·åç§°"})]}),w&&l.jsxs("div",{className:"p-4 bg-green-500/10 border border-green-500/20 rounded-lg space-y-3",children:[l.jsx("p",{className:"text-sm text-green-400 font-medium",children:"è¯†åˆ«æˆåŠŸ"}),l.jsxs("div",{className:"space-y-1.5 text-sm",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"text-gray-500 w-20 shrink-0",children:"å…¬ä¼—å·:"}),l.jsx("span",{className:"text-white font-medium",children:w.nickname})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"text-gray-500 w-20 shrink-0",children:"æ–‡ç« æ ‡é¢˜:"}),l.jsx("span",{className:"text-gray-300 truncate",children:w.articleTitle})]})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"wechat-category",className:"block text-xs text-gray-400 mb-1",children:"åˆ†ç±» (å¯é€‰)"}),l.jsx("input",{id:"wechat-category",type:"text",value:S,onChange:le=>_(le.target.value),placeholder:"é»˜è®¤: å¾®ä¿¡å…¬ä¼—å·",className:"w-full px-3 py-1.5 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:p})]}),l.jsx("button",{type:"button",onClick:ae,disabled:p,className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-700 disabled:bg-gray-700 disabled:cursor-not-allowed text-white text-sm font-medium rounded-md transition-colors cursor-pointer",children:p?l.jsxs(l.Fragment,{children:[l.jsx(nt,{size:16,className:"animate-spin"}),l.jsx("span",{children:"æ·»åŠ ä¸­..."})]}):l.jsxs(l.Fragment,{children:[l.jsx(ya,{size:16}),l.jsxs("span",{children:["æ·»åŠ å…¬ä¼—å·ã€Œ",w.nickname,"ã€"]})]})})]})]}):l.jsx(l.Fragment,{children:B?l.jsxs("div",{className:"p-6 space-y-4",children:[l.jsxs("div",{className:"p-4 bg-green-500/10 border border-green-500/20 rounded-lg space-y-3",children:[l.jsx("p",{className:"text-sm text-green-400 font-medium",children:"Newsletter è®¢é˜…åˆ›å»ºæˆåŠŸ"}),l.jsx("p",{className:"text-xs text-gray-400",children:"è¯·ç”¨ä»¥ä¸‹é‚®ç®±åœ°å€åŽ»è®¢é˜…ä½ çš„ newsletterï¼š"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("code",{className:"flex-1 px-3 py-2 bg-black/30 border border-white/10 rounded text-sm text-white font-mono select-all break-all",children:B.email}),l.jsx("button",{onClick:ee,className:"shrink-0 p-2 rounded hover:bg-white/10 text-gray-400 hover:text-white transition-colors",title:"å¤åˆ¶é‚®ç®±åœ°å€",children:W?l.jsx(yg,{size:16,className:"text-green-400"}):l.jsx(bg,{size:16})})]})]}),l.jsxs("div",{className:"space-y-2 text-xs text-gray-500",children:[l.jsx("p",{children:"æŽ¥ä¸‹æ¥ï¼š"}),l.jsxs("ol",{className:"list-decimal list-inside space-y-1",children:[l.jsx("li",{children:"å¤åˆ¶ä¸Šé¢çš„é‚®ç®±åœ°å€"}),l.jsx("li",{children:"åŽ» newsletter çš„ç½‘ç«™ç”¨æ­¤åœ°å€è®¢é˜…"}),l.jsx("li",{children:"æ”¶åˆ°çš„ newsletter ä¼šè‡ªåŠ¨å‡ºçŽ°åœ¨ Feed ä¸­"})]})]}),l.jsx("button",{onClick:e,className:"w-full px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white text-sm font-medium rounded-md transition-colors",children:"å®Œæˆ"})]}):l.jsxs("form",{onSubmit:Y,className:"p-6 space-y-4",children:[l.jsxs("div",{children:[l.jsxs("label",{htmlFor:"newsletter-name",className:"block text-sm font-medium text-gray-300 mb-1.5",children:["Newsletter åç§° ",l.jsx("span",{className:"text-red-400",children:"*"})]}),l.jsx("input",{ref:b,id:"newsletter-name",type:"text",value:j,onChange:le=>M(le.target.value),placeholder:"ä¾‹å¦‚: Morning Brew, The Hustle",className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:p})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"newsletter-category",className:"block text-sm font-medium text-gray-300 mb-1.5",children:"åˆ†ç±» (å¯é€‰)"}),l.jsx("input",{id:"newsletter-category",type:"text",value:L,onChange:le=>O(le.target.value),placeholder:"ä¾‹å¦‚: æŠ€æœ¯ã€æ–°é—»ã€å•†ä¸š",className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:p})]}),l.jsx("div",{className:"pt-2",children:l.jsx("button",{type:"submit",disabled:p||!j.trim(),className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-700 disabled:cursor-not-allowed text-white text-sm font-medium rounded-md transition-colors",children:p?l.jsxs(l.Fragment,{children:[l.jsx(nt,{size:16,className:"animate-spin"}),l.jsx("span",{children:"åˆ›å»ºä¸­..."})]}):l.jsxs(l.Fragment,{children:[l.jsx(Bk,{size:16}),l.jsx("span",{children:"åˆ›å»º Newsletter è®¢é˜…"})]})})}),l.jsx("div",{className:"pt-0",children:l.jsx("p",{className:"text-xs text-gray-500",children:"å°†é€šè¿‡ kill-the-newsletter.com ç”Ÿæˆä¸€ä¸ªä¸“ç”¨é‚®ç®±åœ°å€ï¼Œç”¨è¯¥åœ°å€è®¢é˜… newsletter åŽï¼Œå†…å®¹ä¼šè‡ªåŠ¨å‡ºçŽ°åœ¨ä½ çš„ Feed ä¸­ã€‚"})})]})})]})]}):null}function oH(n){return`Imported ${n} media file${n>1?"s":""}`}function lH({open:n,onClose:e,onArticleSaved:t}){const[i,s]=A.useState("url"),[r,a]=A.useState(""),[o,c]=A.useState(""),[h,d]=A.useState(!1),f=A.useRef(null),{showToast:p}=Sa();A.useEffect(()=>{n&&(s("url"),a(""),c(""),setTimeout(()=>{var b;return(b=f.current)==null?void 0:b.focus()},100))},[n]),A.useEffect(()=>{if(!n)return;const b=x=>{x.key==="Escape"&&(x.stopImmediatePropagation(),e())};return document.addEventListener("keydown",b),()=>document.removeEventListener("keydown",b)},[n,e]);const g=async b=>{if(b.preventDefault(),!!r.trim()){d(!0);try{const x=await window.electronAPI.articleSaveUrl({url:r.trim(),title:o.trim()||void 0}),m=typeof x=="object"&&x!==null&&"fileType"in x;p(m?"Saved to Books":"Saved to Library"),e(),t==null||t(x)}catch(x){console.error("Failed to save URL:",x),p("Failed to save URL. Please check the URL and try again.")}finally{d(!1)}}},v=async()=>{d(!0);try{const b=await window.electronAPI.articleImportLocalMedia();if(b.length===0){p("No media files were imported");return}p(oH(b.length),"success"),e(),t==null||t()}catch(b){console.error("Failed to import local media:",b),p("Failed to import local media files","error")}finally{d(!1)}};return n?l.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[l.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:e}),l.jsxs("div",{className:"relative w-full max-w-md bg-[#1a1a1a] border border-white/10 rounded-lg shadow-2xl",children:[l.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-white/10",children:[l.jsx("h2",{className:"text-lg font-semibold text-white",children:"Add to Library"}),l.jsx("button",{onClick:e,className:"p-1 rounded hover:bg-white/10 text-gray-400 hover:text-white transition-colors",disabled:h,children:l.jsx(Vn,{size:20})})]}),l.jsx("div",{className:"px-6 pt-4",children:l.jsxs("div",{className:"inline-flex rounded-md bg-[#111] border border-white/10 p-0.5",children:[l.jsx("button",{type:"button",onClick:()=>s("url"),className:`px-3 py-1.5 text-xs rounded transition-colors cursor-pointer ${i==="url"?"bg-blue-600 text-white":"text-gray-400 hover:text-gray-200"}`,children:"URL"}),l.jsx("button",{type:"button",onClick:()=>s("local"),className:`px-3 py-1.5 text-xs rounded transition-colors cursor-pointer ${i==="local"?"bg-blue-600 text-white":"text-gray-400 hover:text-gray-200"}`,children:"Local File"})]})}),i==="url"?l.jsxs("form",{onSubmit:g,className:"p-6 space-y-4",children:[l.jsxs("div",{children:[l.jsxs("label",{htmlFor:"save-url",className:"block text-sm font-medium text-gray-300 mb-1.5",children:["URL ",l.jsx("span",{className:"text-red-400",children:"*"})]}),l.jsx("input",{ref:f,id:"save-url",type:"url",value:r,onChange:b=>a(b.target.value),placeholder:"https://example.com/article",className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:h,required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"save-title",className:"block text-sm font-medium text-gray-300 mb-1.5",children:"Title (optional)"}),l.jsx("input",{id:"save-title",type:"text",value:o,onChange:b=>c(b.target.value),placeholder:"Auto-detected from page",className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:h})]}),l.jsx("div",{className:"flex gap-3 pt-2",children:l.jsx("button",{type:"submit",disabled:h||!r.trim(),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-700 disabled:cursor-not-allowed text-white text-sm font-medium rounded-md transition-colors",children:h?l.jsxs(l.Fragment,{children:[l.jsx(nt,{size:16,className:"animate-spin"}),l.jsx("span",{children:"Saving..."})]}):l.jsxs(l.Fragment,{children:[l.jsx(mR,{size:16}),l.jsx("span",{children:"Save to Library"})]})})})]}):l.jsxs("div",{className:"p-6 space-y-4",children:[l.jsx("p",{className:"text-sm text-gray-400",children:"Import local audio or video files. Audio files will appear in Podcasts, and video files will appear in Videos."}),l.jsx("button",{type:"button",onClick:v,disabled:h,className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-700 disabled:cursor-not-allowed text-white text-sm font-medium rounded-md transition-colors",children:h?l.jsxs(l.Fragment,{children:[l.jsx(nt,{size:16,className:"animate-spin"}),l.jsx("span",{children:"Importing..."})]}):l.jsxs(l.Fragment,{children:[l.jsx(r8,{size:16}),l.jsx("span",{children:"Select Local Media Files"})]})}),l.jsx("p",{className:"text-xs text-gray-500",children:"Supported audio: mp3, m4a, wav, flac, aac, ogg. Supported video: mp4, mov, webm, mkv."})]}),l.jsx("div",{className:"px-6 pb-6 pt-0",children:i==="url"?l.jsxs("p",{className:"text-xs text-gray-500",children:["Article URLs are parsed automatically. PDF URLs (for example arXiv /pdf links) are imported into Books. You can also use ",l.jsx("kbd",{className:"px-1 py-0.5 bg-white/10 rounded text-gray-400",children:"Cmd+Shift+S"})," to open this dialog."]}):l.jsx("p",{className:"text-xs text-gray-500",children:"Imported files are copied into the app storage so moving original files won't break playback."})})]})]}):null}function cH({open:n,onClose:e,onSelectArticle:t}){const{t:i}=Bi(),[s,r]=A.useState(""),[a,o]=A.useState([]),[c,h]=A.useState(0),[d,f]=A.useState(!1),p=A.useRef(null),g=A.useRef(void 0),v=A.useCallback(async w=>{const E=w.trim();if(!E){o([]);return}f(!0);try{const S=await window.electronAPI.articleSearch({query:E,limit:20});o(S),h(0)}catch(S){console.error("Search failed:",S),o([])}finally{f(!1)}},[]);A.useEffect(()=>(g.current&&clearTimeout(g.current),g.current=setTimeout(()=>{v(s)},300),()=>{g.current&&clearTimeout(g.current)}),[s,v]),A.useEffect(()=>{n&&(r(""),o([]),h(0),requestAnimationFrame(()=>{var w;return(w=p.current)==null?void 0:w.focus()}))},[n]);const b=A.useCallback(w=>{e(),t(w)},[e,t]),x=A.useCallback(w=>{switch(w.key){case"ArrowDown":w.preventDefault(),h(E=>E<a.length-1?E+1:0);break;case"ArrowUp":w.preventDefault(),h(E=>E>0?E-1:a.length-1);break;case"Enter":w.preventDefault(),a[c]&&b(a[c].id);break;case"Escape":w.preventDefault(),e();break}},[a,c,b,e]),m=(w,E)=>{if(!w||!E)return w||"";const S=new RegExp(`(${E.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");return w.split(S).map((T,j)=>S.test(T)?l.jsx("span",{className:"bg-yellow-500/30 text-yellow-200 font-medium",children:T},j):l.jsx("span",{children:T},j))},y=(w,E)=>{const S=w.contentText||w.summary||"",_=120;if(S.length<=_)return S;const j=S.toLowerCase().indexOf(E.toLowerCase());if(j===-1)return S.substring(0,_)+"...";const M=Math.max(0,j-40),L=Math.min(S.length,M+_),O=M>0?"...":"",B=L<S.length?"...":"";return O+S.substring(M,L)+B};return n?l.jsx("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-start justify-center pt-[15%]",onClick:e,children:l.jsxs("div",{className:"w-[680px] bg-[#1a1a1a] rounded-xl border border-white/10 shadow-2xl overflow-hidden",onClick:w=>w.stopPropagation(),onKeyDown:x,children:[l.jsxs("div",{className:"flex items-center gap-3 px-4 py-3.5 border-b border-white/5",children:[l.jsx(wg,{size:18,className:"text-gray-500 shrink-0"}),l.jsx("input",{ref:p,type:"text",value:s,onChange:w=>r(w.target.value),placeholder:i("search.placeholder"),className:"flex-1 bg-transparent text-white text-[14px] placeholder:text-gray-500 outline-none"})]}),l.jsxs("div",{className:"max-h-[420px] overflow-y-auto",children:[d&&l.jsx("div",{className:"px-4 py-8 text-center text-sm text-gray-500",children:i("search.searching")}),!d&&s&&a.length===0&&l.jsx("div",{className:"px-4 py-8 text-center text-sm text-gray-500",children:i("search.noResults")}),!d&&!s&&l.jsx("div",{className:"px-4 py-8 text-center text-sm text-gray-500",children:i("search.placeholder")}),!d&&a.length>0&&l.jsx("div",{className:"py-1",children:a.map((w,E)=>l.jsxs("button",{onClick:()=>b(w.id),className:`w-full px-4 py-3 flex flex-col gap-1.5 cursor-pointer transition-colors text-left ${E===c?"bg-white/[0.08]":"hover:bg-white/5"}`,children:[l.jsx("div",{className:"text-[14px] text-gray-100 font-medium line-clamp-1",children:m(w.title,s)}),l.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-gray-500",children:[w.author&&l.jsxs(l.Fragment,{children:[l.jsx("span",{children:m(w.author,s)}),l.jsx("span",{children:"â€¢"})]}),w.domain&&l.jsxs(l.Fragment,{children:[l.jsx("span",{children:w.domain}),l.jsx("span",{children:"â€¢"})]}),w.publishedAt&&l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx(ma,{size:10}),l.jsx("span",{children:new Date(w.publishedAt).toLocaleDateString("zh-CN")})]})]}),w.contentText&&l.jsx("div",{className:"text-[12px] text-gray-500 line-clamp-2",children:m(y(w,s),s)})]},w.id))})]}),l.jsxs("div",{className:"px-4 py-2 border-t border-white/5 flex items-center justify-between text-[11px] text-gray-600",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("span",{children:["â†‘â†“ ",i("common.navigation")||"Navigate"]}),l.jsxs("span",{children:["Enter ",i("common.select")||"Select"]}),l.jsxs("span",{children:["Esc ",i("common.close")]})]}),a.length>0&&l.jsxs("span",{children:[a.length," ",i("search.results")]})]})]})}):null}const uH=[{title:"å¯¼èˆª",items:[{keys:["j","â†“"],description:"ä¸‹ä¸€ç¯‡æ–‡ç«  / ä¸‹ä¸€æ®µè½"},{keys:["k","â†‘"],description:"ä¸Šä¸€ç¯‡æ–‡ç«  / ä¸Šä¸€æ®µè½"},{keys:["Enter"],description:"æ‰“å¼€é˜…è¯»è§†å›¾"},{keys:["Esc"],description:"è¿”å›ž / å…³é—­"},{keys:["O"],description:"åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€åŽŸæ–‡"}]},{title:"æ–‡ç« æ“ä½œ",items:[{keys:["E"],description:"å½’æ¡£"},{keys:["L"],description:"ç¨åŽé˜…è¯»"},{keys:["D"],description:"åˆ é™¤"},{keys:["S","F"],description:"æ”¶è— / å–æ¶ˆæ”¶è—"},{keys:["B"],description:"ä¿å­˜åˆ° Library (Feed è§†å›¾)"},{keys:["Z"],description:"æ’¤é”€"},{keys:["â‡§B"],description:"è¿›å…¥æ‰¹é‡é€‰æ‹©æ¨¡å¼"},{keys:["â‡§C"],description:"å¤åˆ¶åŽŸæ–‡é“¾æŽ¥"}]},{title:"é˜…è¯»è§†å›¾",items:[{keys:["H"],description:"é«˜äº®å½“å‰æ®µè½"},{keys:["N"],description:"ä¸ºå½“å‰é«˜äº®æ·»åŠ ç¬”è®°"},{keys:["T"],description:"ä¸ºå½“å‰é«˜äº®æ·»åŠ æ ‡ç­¾"},{keys:["â‡§N"],description:"æ‰“å¼€ Notebook é¢æ¿"},{keys:["â‡§T"],description:"ä¸ºæ–‡æ¡£æ·»åŠ æ ‡ç­¾"},{keys:["â‡§R"],description:"é‡ç½®é˜…è¯»è¿›åº¦"},{keys:["`"],description:"å‘å‰åˆ‡æ¢ä¾§è¾¹æ æ ‡ç­¾"},{keys:["â‡§`"],description:"å‘åŽåˆ‡æ¢ä¾§è¾¹æ æ ‡ç­¾"}]},{title:"æŽ’ç‰ˆè®¾ç½® (é˜…è¯»è§†å›¾)",items:[{keys:["âŒƒâ‡§F"],description:"åˆ‡æ¢å­—ä½“"},{keys:["â‡§+"],description:"å¢žå¤§å­—å·"},{keys:["â‡§-"],description:"å‡å°å­—å·"},{keys:['â‡§"'],description:"å¢žå¤§è¡Œè·"},{keys:["â‡§:"],description:"å‡å°è¡Œè·"}]},{title:"è§†å›¾åˆ‡æ¢",items:[{keys:["1"],description:"Inbox / Unseen"},{keys:["2"],description:"Later / Seen"},{keys:["3"],description:"Archive"}]},{title:"é¢æ¿",items:[{keys:["["],description:"æ”¶æŠ˜/å±•å¼€å·¦ä¾§æ "},{keys:["]"],description:"æ”¶æŠ˜/å±•å¼€å³ä¾§è¯¦æƒ…é¢æ¿"}]},{title:"å…¨å±€",items:[{keys:["âŒ˜K"],description:"å‘½ä»¤é¢æ¿"},{keys:["/"],description:"æœç´¢"},{keys:["?"],description:"å¿«æ·é”®å¸®åŠ©"},{keys:["â‡§A"],description:"æ·»åŠ  RSS è®¢é˜…"},{keys:["â‡§F"],description:"æœç´¢/è¿‡æ»¤æ–‡æ¡£"},{keys:["âŒ˜â‡§S"],description:"ä¿å­˜ URL åˆ° Library"}]}];function hH({open:n,onClose:e}){const t=A.useRef(null);return A.useEffect(()=>{if(!n)return;const i=s=>{s.key==="Escape"&&(s.stopImmediatePropagation(),e())};return document.addEventListener("keydown",i),()=>document.removeEventListener("keydown",i)},[n,e]),A.useEffect(()=>{if(!n)return;const i=s=>{t.current&&!t.current.contains(s.target)&&e()};return document.addEventListener("mousedown",i),()=>document.removeEventListener("mousedown",i)},[n,e]),n?l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:l.jsxs("div",{ref:t,className:"w-[480px] max-h-[70vh] bg-[#1a1a1a] border border-white/10 rounded-xl shadow-2xl flex flex-col overflow-hidden",children:[l.jsxs("div",{className:"flex items-center justify-between px-5 py-3.5 border-b border-white/10",children:[l.jsx("h2",{className:"text-[14px] font-semibold text-white",children:"Keyboard Shortcuts"}),l.jsx("button",{onClick:e,className:"p-1 rounded hover:bg-white/10 text-gray-400 hover:text-white transition-colors",children:l.jsx(Vn,{size:16})})]}),l.jsx("div",{className:"overflow-y-auto min-h-0 flex-1 p-5 space-y-6",children:uH.map(i=>l.jsxs("div",{children:[l.jsx("h3",{className:"text-[11px] font-semibold uppercase tracking-wider text-gray-500 mb-2",children:i.title}),l.jsx("div",{className:"space-y-1",children:i.items.map(s=>l.jsxs("div",{className:"flex items-center justify-between py-1.5",children:[l.jsx("span",{className:"text-[13px] text-gray-300",children:s.description}),l.jsx("div",{className:"flex items-center gap-1",children:s.keys.map((r,a)=>l.jsxs("span",{className:"flex items-center gap-1",children:[a>0&&l.jsx("span",{className:"text-[10px] text-gray-600",children:"/"}),l.jsx("kbd",{className:"px-1.5 py-0.5 text-[11px] font-mono text-gray-300 bg-white/5 border border-white/10 rounded",children:r})]},a))})]},s.description))})]},i.title))})]})}):null}function dH(n){return n?new Date(n).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"ä»Žæœª"}function fH({feed:n,onClose:e,onSave:t,onDelete:i,onFetch:s}){const[r,a]=A.useState(n.title||""),[o,c]=A.useState(n.category||""),[h,d]=A.useState(n.fetchInterval),[f,p]=A.useState(!1);A.useEffect(()=>{const m=y=>{y.key==="Escape"&&(y.stopImmediatePropagation(),e())};return document.addEventListener("keydown",m),()=>document.removeEventListener("keydown",m)},[e]);const g=()=>{t({...n,title:r||null,category:o||null,fetchInterval:h}),e()},v=async()=>{p(!0);try{await s(n.id)}finally{p(!1)}},b=()=>{confirm("ç¡®å®šå–æ¶ˆè®¢é˜…æ­¤ Feedï¼Ÿæ‰€æœ‰å…³è”æ–‡ç« ä¸ä¼šè¢«åˆ é™¤ã€‚")&&(i(n.id),e())},x=n.errorCount===0;return l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",onClick:m=>{m.target===m.currentTarget&&e()},children:l.jsxs("div",{className:"w-[440px] bg-[#1a1a1a] rounded-xl border border-white/10 shadow-2xl",children:[l.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b border-white/10",children:[l.jsx("h2",{className:"text-[15px] font-semibold text-white",children:"Feed ç®¡ç†"}),l.jsx("button",{onClick:e,className:"p-1 rounded hover:bg-white/10 text-gray-400 hover:text-white transition-colors cursor-pointer",children:l.jsx(Vn,{size:16})})]}),l.jsxs("div",{className:"px-5 py-4 space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-[12px] text-gray-400 mb-1",children:"æ ‡é¢˜"}),l.jsx("input",{type:"text",value:r,onChange:m=>a(m.target.value),className:"w-full px-3 py-2 rounded-md bg-white/5 border border-white/10 text-[13px] text-white placeholder-gray-500 outline-none focus:border-blue-500/50 transition-colors",placeholder:"Feed æ ‡é¢˜"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-[12px] text-gray-400 mb-1",children:"URL"}),l.jsx("div",{className:"px-3 py-2 rounded-md bg-white/5 border border-white/10 text-[13px] text-gray-400 truncate",children:n.url})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-[12px] text-gray-400 mb-1",children:"åˆ†ç±»"}),l.jsx("input",{type:"text",value:o,onChange:m=>c(m.target.value),className:"w-full px-3 py-2 rounded-md bg-white/5 border border-white/10 text-[13px] text-white placeholder-gray-500 outline-none focus:border-blue-500/50 transition-colors",placeholder:"æœªåˆ†ç±»"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-[12px] text-gray-400 mb-1",children:"æŠ“å–é—´éš”ï¼ˆåˆ†é’Ÿï¼‰"}),l.jsx("input",{type:"number",value:h,onChange:m=>d(Math.max(1,parseInt(m.target.value)||30)),min:1,className:"w-full px-3 py-2 rounded-md bg-white/5 border border-white/10 text-[13px] text-white placeholder-gray-500 outline-none focus:border-blue-500/50 transition-colors"})]}),l.jsxs("div",{className:"px-3 py-2.5 rounded-md bg-white/5 border border-white/10 space-y-1.5",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[x?l.jsx(RF,{size:14,className:"text-green-400"}):l.jsx(vg,{size:14,className:"text-yellow-400"}),l.jsx("span",{className:`text-[12px] font-medium ${x?"text-green-400":"text-yellow-400"}`,children:x?"è¿è¡Œæ­£å¸¸":`è¿žç»­é”™è¯¯ ${n.errorCount} æ¬¡`})]}),l.jsxs("div",{className:"text-[11px] text-gray-500",children:["ä¸Šæ¬¡æŠ“å–: ",dH(n.lastFetchedAt)]})]})]}),l.jsxs("div",{className:"flex items-center justify-between px-5 py-3 border-t border-white/10",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("button",{onClick:v,disabled:f,className:"flex items-center gap-1.5 px-3 py-1.5 rounded-md text-[12px] text-gray-300 bg-white/5 hover:bg-white/10 border border-white/10 transition-colors cursor-pointer disabled:opacity-50",children:[l.jsx(va,{size:12,className:f?"animate-spin":""}),f?"æŠ“å–ä¸­...":"æ‰‹åŠ¨æŠ“å–"]}),l.jsxs("button",{onClick:b,className:"flex items-center gap-1.5 px-3 py-1.5 rounded-md text-[12px] text-red-400 bg-white/5 hover:bg-red-500/10 border border-white/10 transition-colors cursor-pointer",children:[l.jsx(Wi,{size:12}),"å–æ¶ˆè®¢é˜…"]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:e,className:"px-3 py-1.5 rounded-md text-[12px] text-gray-400 hover:text-white transition-colors cursor-pointer",children:"å–æ¶ˆ"}),l.jsx("button",{onClick:g,className:"px-4 py-1.5 rounded-md text-[12px] font-medium text-white bg-blue-600 hover:bg-blue-500 transition-colors cursor-pointer",children:"ä¿å­˜"})]})]})]})})}function pH({onSelectFeed:n,selectedFeedId:e,onEditFeed:t,onAddFeed:i,refreshTrigger:s,onDeleteFeed:r}){const[a,o]=A.useState([]),[c,h]=A.useState({}),[d,f]=A.useState(""),[p,g]=A.useState("lastUpdated"),[v,b]=A.useState("desc"),[x,m]=A.useState(!0),[y,w]=A.useState(null),E=A.useRef(!1),S=A.useCallback(async()=>{try{m(!0);const[O,B]=await Promise.all([window.electronAPI.feedList(),window.electronAPI.feedArticleCount()]);o(O);const G={};B.forEach(W=>{G[W.feedId]=W}),h(G),e===null&&O.length>0&&!E.current&&(n(O[0].id),E.current=!0)}catch(O){console.error("Failed to load feeds:",O)}finally{m(!1)}},[e,n]);A.useEffect(()=>{S()},[S,s]);const _=A.useCallback(async(O,B)=>{B.stopPropagation();try{await window.electronAPI.feedTogglePin(O),await S()}catch(G){console.error("Failed to toggle pin:",G)}},[S]),T=A.useCallback(async(O,B,G)=>{if(G.stopPropagation(),!!confirm(`ç¡®å®šå–æ¶ˆè®¢é˜…ã€Œ${B}ã€ï¼Ÿå…³è”æ–‡ç« ä¸ä¼šè¢«åˆ é™¤ã€‚`)){w(O);try{await r(O),e===O&&n(null),await S()}catch(W){console.error("Failed to delete feed:",W)}finally{w(null)}}},[r,e,n,S]),j=O=>{p===O?b(B=>B==="asc"?"desc":"asc"):(g(O),b("desc"))},M=A.useMemo(()=>{let O=a;if(d.trim()){const B=d.toLowerCase();O=O.filter(G=>(G.title||"").toLowerCase().includes(B)||G.url.toLowerCase().includes(B))}return O=[...O].sort((B,G)=>{var J,V;let W=0;return p==="name"?W=(B.title||B.url).localeCompare(G.title||G.url):p==="documents"?W=(((J=c[B.id])==null?void 0:J.total)||0)-(((V=c[G.id])==null?void 0:V.total)||0):p==="lastUpdated"&&(W=(B.lastFetchedAt||"").localeCompare(G.lastFetchedAt||"")),v==="asc"?W:-W}),O},[a,d,p,v,c]),L=O=>{if(!O)return"-";const B=new Date(O),W=new Date().getTime()-B.getTime(),J=Math.floor(W/6e4);if(J<60)return`${J}m ago`;const V=Math.floor(J/60);if(V<24)return`${V}h ago`;const H=Math.floor(V/24);return H<30?`${H}d ago`:B.toLocaleDateString("zh-CN",{month:"short",day:"numeric"})};return l.jsxs("div",{className:"flex flex-col h-full bg-[#141414] min-w-[400px] flex-1",children:[l.jsx("div",{className:"shrink-0 border-b border-[#262626]",children:l.jsxs("div",{className:"flex items-center justify-between px-5 pt-4 pb-3",children:[l.jsxs("div",{className:"flex items-center gap-6",children:[l.jsx("span",{className:"text-[14px] font-semibold text-white border-b-2 border-white pb-1",children:"Subscribed"}),l.jsx("span",{className:"text-[14px] text-gray-500 pb-1 cursor-not-allowed",children:"Suggested"})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("div",{className:"relative",children:[l.jsx(wg,{size:14,className:"absolute left-2.5 top-1/2 -translate-y-1/2 text-gray-500"}),l.jsx("input",{type:"text",placeholder:"Find...",value:d,onChange:O=>f(O.target.value),className:"w-[180px] pl-8 pr-3 py-1.5 bg-[#1a1a1a] border border-[#333] rounded-md text-[12px] text-gray-300 placeholder-gray-600 focus:outline-none focus:border-[#555] transition-colors"})]}),l.jsxs("button",{onClick:i,className:"flex items-center gap-1.5 px-3 py-1.5 bg-blue-600 hover:bg-blue-500 rounded-md text-[12px] text-white font-medium transition-colors cursor-pointer",children:[l.jsx(ya,{size:14}),"Add feed"]})]})]})}),l.jsxs("div",{className:"flex-1 overflow-y-auto",children:[l.jsx("div",{className:"sticky top-0 bg-[#141414] border-b border-[#262626] z-10",children:l.jsxs("div",{className:"grid grid-cols-[1fr_1fr_100px_120px_130px] gap-2 px-5 py-2 text-[11px] font-medium text-gray-500 uppercase tracking-wider",children:[l.jsxs("button",{onClick:()=>j("name"),className:"flex items-center gap-1 text-left hover:text-gray-300 transition-colors cursor-pointer",children:["Name",p==="name"&&l.jsx(v2,{size:10})]}),l.jsx("span",{children:"Description"}),l.jsxs("button",{onClick:()=>j("documents"),className:"flex items-center gap-1 hover:text-gray-300 transition-colors cursor-pointer",children:["Documents",p==="documents"&&l.jsx(v2,{size:10})]}),l.jsx("span",{children:"Category"}),l.jsxs("button",{onClick:()=>j("lastUpdated"),className:"flex items-center gap-1 hover:text-gray-300 transition-colors cursor-pointer",children:["Last Updated",p==="lastUpdated"&&l.jsx(v2,{size:10})]})]})}),x?l.jsx("div",{className:"flex items-center justify-center py-20 text-gray-500 text-[13px]",children:"Loading..."}):M.length===0?l.jsx("div",{className:"flex flex-col items-center justify-center py-20 text-gray-500 text-[13px]",children:d?"No feeds found":"No subscriptions yet"}):M.map(O=>{var B;return l.jsxs("div",{onClick:()=>n(O.id),className:`
                group grid grid-cols-[1fr_1fr_100px_120px_130px] gap-2 px-5 h-10 items-center
                border-b border-[#1e1e1e] cursor-pointer transition-colors
                ${e===O.id?"bg-white/[0.06]":"hover:bg-white/[0.03]"}
              `,children:[l.jsxs("div",{className:"flex items-center gap-2.5 min-w-0",children:[O.favicon?l.jsx("img",{src:O.favicon,alt:"",className:"w-5 h-5 rounded shrink-0"}):l.jsx("div",{className:"w-5 h-5 rounded bg-[#333] flex items-center justify-center shrink-0",children:l.jsx(hu,{size:10,className:"text-gray-500"})}),l.jsx("span",{className:"text-[13px] text-gray-200 truncate",children:O.title||O.url})]}),l.jsx("span",{className:"text-[12px] text-gray-500 truncate",children:O.description||"-"}),l.jsx("span",{className:"text-[12px] text-gray-400 tabular-nums",children:((B=c[O.id])==null?void 0:B.total)||0}),l.jsx("span",{className:"text-[12px] text-gray-500 truncate",children:O.category||"-"}),l.jsxs("div",{className:"flex items-center justify-between min-w-0",children:[l.jsx("span",{className:"text-[12px] text-gray-500 group-hover:hidden",children:L(O.lastFetchedAt)}),l.jsxs("div",{className:"hidden group-hover:flex items-center gap-0.5",children:[l.jsx("button",{onClick:G=>{G.stopPropagation(),t(O)},className:"p-1.5 rounded hover:bg-white/10 text-gray-500 hover:text-gray-200 transition-colors cursor-pointer",title:"Edit feed",children:l.jsx(YC,{size:14})}),l.jsx("button",{onClick:G=>_(O.id,G),className:`p-1.5 rounded hover:bg-white/10 transition-colors cursor-pointer ${O.pinned?"text-blue-400 hover:text-blue-300":"text-gray-500 hover:text-gray-200"}`,title:O.pinned?"Unpin from sidebar":"Pin to sidebar",children:O.pinned?l.jsx(eU,{size:14}):l.jsx(nU,{size:14})}),l.jsx("button",{onClick:G=>T(O.id,O.title||O.url,G),disabled:y===O.id,className:"p-1.5 rounded hover:bg-red-500/10 text-gray-500 hover:text-red-400 transition-colors cursor-pointer disabled:opacity-50",title:"Unsubscribe",children:l.jsx(Wi,{size:14})})]})]})]},O.id)})]}),l.jsx("div",{className:"shrink-0 border-t border-[#262626] px-5 py-2 flex items-center justify-end",children:l.jsxs("span",{className:"text-[11px] text-gray-500",children:["Count: ",M.length]})})]})}function gH({open:n,onClose:e,feedId:t,feedTitle:i,onTokenSet:s}){const[r,a]=A.useState(""),[o,c]=A.useState(!1),[h,d]=A.useState(!1),f=A.useRef(null),{showToast:p}=Sa();A.useEffect(()=>{n&&(a(""),setTimeout(()=>{var v;return(v=f.current)==null?void 0:v.focus()},100))},[n]),A.useEffect(()=>{if(!n)return;const v=b=>{b.key==="Escape"&&(b.stopImmediatePropagation(),e())};return document.addEventListener("keydown",v),()=>document.removeEventListener("keydown",v)},[n,e]);const g=async v=>{if(v.preventDefault(),!!r.trim()){c(!0);try{(await window.electronAPI.wechatSetToken(t,r.trim())).hasToken&&(p("Token è®¾ç½®æˆåŠŸ"),e(),s==null||s())}catch(b){const x=b instanceof Error?b.message:"Token è®¾ç½®å¤±è´¥";p(x)}finally{c(!1)}}};return n?l.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[l.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:e}),l.jsxs("div",{className:"relative w-full max-w-lg bg-[#1a1a1a] border border-white/10 rounded-lg shadow-2xl",children:[l.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-white/10",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(gR,{size:18,className:"text-green-400"}),l.jsx("h2",{className:"text-lg font-semibold text-white",children:"è®¾ç½® Token"})]}),l.jsx("button",{onClick:e,className:"p-1 rounded hover:bg-white/10 text-gray-400 hover:text-white transition-colors",children:l.jsx(Vn,{size:20})})]}),l.jsxs("form",{onSubmit:g,className:"p-6 space-y-4",children:[l.jsx("div",{children:l.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-1.5",children:["å…¬ä¼—å·: ",l.jsx("span",{className:"text-white",children:i})]})}),l.jsxs("div",{children:[l.jsxs("label",{htmlFor:"token-url",className:"block text-sm font-medium text-gray-300 mb-1.5",children:["Token URL ",l.jsx("span",{className:"text-red-400",children:"*"})]}),l.jsx("textarea",{ref:f,id:"token-url",value:r,onChange:v=>a(v.target.value),placeholder:"ä»Ž Fiddler/Charles ä¸­å¤åˆ¶çš„åŒ…å« __biz, uin, key, pass_ticket å‚æ•°çš„å®Œæ•´ URL",rows:4,className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent font-mono resize-none",disabled:o})]}),l.jsx("div",{className:"flex gap-3 pt-2",children:l.jsx("button",{type:"submit",disabled:o||!r.trim(),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-700 disabled:bg-gray-700 disabled:cursor-not-allowed text-white text-sm font-medium rounded-md transition-colors",children:o?l.jsxs(l.Fragment,{children:[l.jsx(nt,{size:16,className:"animate-spin"}),l.jsx("span",{children:"éªŒè¯ä¸­..."})]}):l.jsxs(l.Fragment,{children:[l.jsx(Xh,{size:16}),l.jsx("span",{children:"è®¾ç½® Token"})]})})})]}),l.jsxs("div",{className:"px-6 pb-6",children:[l.jsxs("button",{onClick:()=>d(!h),className:"flex items-center gap-1.5 text-xs text-gray-500 hover:text-gray-300 transition-colors",children:[l.jsx(pR,{size:12}),l.jsx("span",{children:h?"æ”¶èµ·":"å¦‚ä½•èŽ·å– Tokenï¼Ÿ"})]}),h&&l.jsxs("div",{className:"mt-3 p-3 bg-[#111] border border-white/5 rounded-md space-y-2 text-xs text-gray-400",children:[l.jsx("p",{className:"font-medium text-gray-300",children:"èŽ·å– Token æ­¥éª¤ï¼š"}),l.jsxs("ol",{className:"list-decimal list-inside space-y-1.5",children:[l.jsx("li",{children:"æ‰“å¼€ Fiddler Classic å¹¶å¼€å§‹æŠ“åŒ…"}),l.jsx("li",{children:"åœ¨å¾®ä¿¡ PC å®¢æˆ·ç«¯ä¸­ï¼Œæ‰“å¼€è¯¥å…¬ä¼—å·çš„ä¸»é¡µ"}),l.jsxs("li",{children:["åœ¨ Fiddler ä¸­æ‰¾åˆ°ä¸»æœºä¸º ",l.jsx("code",{className:"px-1 py-0.5 bg-white/5 rounded",children:"mp.weixin.qq.com"})," çš„è¯·æ±‚"]}),l.jsxs("li",{children:["é€‰ä¸­è¯¥è¯·æ±‚ï¼ŒæŒ‰ ",l.jsx("code",{className:"px-1 py-0.5 bg-white/5 rounded",children:"Ctrl+U"})," å¤åˆ¶å®Œæ•´ URL"]}),l.jsx("li",{children:"ç²˜è´´åˆ°ä¸Šæ–¹è¾“å…¥æ¡†ä¸­"})]}),l.jsxs("div",{className:"mt-2 flex items-start gap-1.5 p-2 bg-yellow-500/5 border border-yellow-500/10 rounded",children:[l.jsx(vg,{size:12,className:"text-yellow-500 mt-0.5 shrink-0"}),l.jsx("p",{className:"text-yellow-400/80",children:"Token æœ‰æ•ˆæœŸçº¦ 2-6 å°æ—¶ï¼Œè¿‡æœŸåŽéœ€é‡æ–°èŽ·å–ã€‚æ‰‹åŠ¨èŽ·å– Token æ˜¯æœ€å®‰å…¨çš„æ–¹å¼ï¼Œä¸ä¼šè§¦å‘å¾®ä¿¡çš„é£ŽæŽ§ç³»ç»Ÿã€‚"})]})]})]})]})]}):null}function mH({feedId:n,feedTitle:e,onRefresh:t}){const[i,s]=A.useState(null),[r,a]=A.useState(!1),[o,c]=A.useState(null),[h,d]=A.useState(1),[f,p]=A.useState(5),{showToast:g}=Sa(),v=A.useCallback(async()=>{try{const E=await window.electronAPI.wechatGetTokenStatus(n);s(E)}catch{s(null)}},[n]);A.useEffect(()=>{v()},[v]),A.useEffect(()=>window.electronAPI.wechatOnProgress(S=>{S.feedId===n&&(c(S),S.status==="completed"&&(t==null||t(),setTimeout(()=>c(null),3e3)),S.status==="error"&&g(S.error||"æ“ä½œå¤±è´¥"))}),[n,t,g]);const b=(o==null?void 0:o.status)==="running",x=async()=>{if(!b)try{await window.electronAPI.wechatFetchArticleList({feedId:n,pagesStart:h,pagesEnd:f})}catch(E){g(E instanceof Error?E.message:"æ‹‰å–å¤±è´¥")}},m=async()=>{if(!b)try{await window.electronAPI.wechatDownloadContent({feedId:n})}catch(E){g(E instanceof Error?E.message:"ä¸‹è½½å¤±è´¥")}},y=async()=>{if(!b)try{await window.electronAPI.wechatFetchStats({feedId:n})}catch(E){g(E instanceof Error?E.message:"èŽ·å–å¤±è´¥")}},w=async()=>{try{await window.electronAPI.wechatCancelTask(n),c(E=>E?{...E,status:"cancelled"}:null)}catch{}};return l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"flex items-center gap-2 text-[12px]",children:[l.jsx(gR,{size:13,className:"text-gray-500 shrink-0"}),l.jsx("span",{className:"text-gray-500",children:"Token"}),l.jsx("span",{className:"ml-auto flex items-center gap-1",children:i!=null&&i.hasToken?l.jsxs(l.Fragment,{children:[l.jsx(Xh,{size:12,className:"text-green-500"}),l.jsx("span",{className:"text-green-400",children:"å·²é…ç½®"})]}):l.jsxs(l.Fragment,{children:[l.jsx(ru,{size:12,className:"text-yellow-500"}),l.jsx("span",{className:"text-yellow-400",children:"æœªé…ç½®"})]})}),l.jsx("button",{onClick:()=>a(!0),className:"px-2 py-0.5 rounded text-[11px] bg-white/5 hover:bg-white/10 text-gray-400 hover:text-white border border-white/10 transition-colors cursor-pointer",children:i!=null&&i.hasToken?"æ›´æ–°":"è®¾ç½®"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("button",{onClick:x,disabled:b||!(i!=null&&i.hasToken),className:"flex items-center gap-1.5 px-3 py-1.5 rounded-md text-[12px] bg-blue-500/10 hover:bg-blue-500/20 text-blue-400 border border-blue-500/20 transition-colors cursor-pointer disabled:opacity-40 disabled:cursor-not-allowed",children:[l.jsx(k8,{size:12}),"æ‹‰å–æ–‡ç« åˆ—è¡¨"]}),l.jsxs("div",{className:"flex items-center gap-1 text-[11px] text-gray-500",children:[l.jsx("span",{children:"é¡µ:"}),l.jsx("input",{type:"number",value:h,onChange:E=>d(Number(E.target.value)||1),min:1,className:"w-10 px-1 py-0.5 bg-[#111] border border-white/10 rounded text-center text-white text-[11px]"}),l.jsx("span",{children:"-"}),l.jsx("input",{type:"number",value:f,onChange:E=>p(Number(E.target.value)||5),min:h,className:"w-10 px-1 py-0.5 bg-[#111] border border-white/10 rounded text-center text-white text-[11px]"})]})]}),l.jsxs("button",{onClick:m,disabled:b,className:"flex items-center gap-1.5 px-3 py-1.5 rounded-md text-[12px] bg-green-500/10 hover:bg-green-500/20 text-green-400 border border-green-500/20 transition-colors cursor-pointer disabled:opacity-40 disabled:cursor-not-allowed w-full",children:[l.jsx(xa,{size:12}),"ä¸‹è½½æ–‡ç« å†…å®¹ï¼ˆç¦»çº¿ä¿å­˜ï¼‰"]}),l.jsxs("button",{onClick:y,disabled:b||!(i!=null&&i.hasToken),className:"flex items-center gap-1.5 px-3 py-1.5 rounded-md text-[12px] bg-purple-500/10 hover:bg-purple-500/20 text-purple-400 border border-purple-500/20 transition-colors cursor-pointer disabled:opacity-40 disabled:cursor-not-allowed w-full",children:[l.jsx(EF,{size:12}),"èŽ·å–è¡Œä¸ºæ•°æ®ï¼ˆé˜…è¯»é‡/ç‚¹èµž/è¯„è®ºï¼‰"]})]}),o&&o.status!=="completed"&&l.jsxs("div",{className:"p-3 bg-[#111] border border-white/5 rounded-md space-y-2",children:[l.jsxs("div",{className:"flex items-center justify-between text-[11px]",children:[l.jsxs("span",{className:"text-gray-400",children:[o.taskType==="fetch-list"&&"æ‹‰å–æ–‡ç« åˆ—è¡¨",o.taskType==="download-content"&&"ä¸‹è½½æ–‡ç« å†…å®¹",o.taskType==="fetch-stats"&&"èŽ·å–è¡Œä¸ºæ•°æ®"]}),b&&l.jsx("button",{onClick:w,className:"text-red-400 hover:text-red-300 transition-colors cursor-pointer",children:"å–æ¶ˆ"})]}),o.total>0&&l.jsx("div",{className:"w-full bg-white/5 rounded-full h-1.5",children:l.jsx("div",{className:"bg-blue-500 h-1.5 rounded-full transition-all",style:{width:`${o.current/o.total*100}%`}})}),l.jsxs("div",{className:"flex items-center gap-2 text-[11px]",children:[b&&l.jsx(nt,{size:10,className:"animate-spin text-blue-400"}),o.status==="error"&&l.jsx(ru,{size:10,className:"text-red-400"}),o.status==="cancelled"&&l.jsx(OF,{size:10,className:"text-yellow-400"}),l.jsxs("span",{className:"text-gray-500 truncate",children:[o.total>0&&`${o.current}/${o.total} `,o.currentTitle]})]}),o.error&&l.jsx("p",{className:"text-[11px] text-red-400",children:o.error})]}),(o==null?void 0:o.status)==="completed"&&l.jsxs("div",{className:"flex items-center gap-2 p-2 bg-green-500/5 border border-green-500/10 rounded-md",children:[l.jsx(Xh,{size:12,className:"text-green-400"}),l.jsx("span",{className:"text-[11px] text-green-400",children:o.currentTitle})]}),l.jsx(gH,{open:r,onClose:()=>a(!1),feedId:n,feedTitle:e,onTokenSet:()=>v()})]})}function xH({feedId:n,onEditFeed:e,onDeleteFeed:t,onFetchFeed:i,onOpenArticle:s,refreshTrigger:r,collapsed:a}){const[o,c]=A.useState(null),[h,d]=A.useState(null),[f,p]=A.useState([]),[g,v]=A.useState(!1),{width:b,handleMouseDown:x}=Sg({defaultWidth:360,minWidth:280,maxWidth:600,storageKey:"feedDetailPanelWidth"}),m=A.useCallback(async()=>{if(n)try{const[S,_,T]=await Promise.all([window.electronAPI.feedList(),window.electronAPI.feedArticleCount(),window.electronAPI.articleList({feedId:n,sortBy:"saved_at",sortOrder:"desc",limit:5})]),j=S.find(M=>M.id===n);c(j||null),d(_.find(M=>M.feedId===n)||null),p(T)}catch(S){console.error("Failed to load feed details:",S)}},[n]);A.useEffect(()=>{m()},[m,r]);const y=A.useCallback(async()=>{if(n){v(!0);try{await i(n),await m()}finally{v(!1)}}},[n,i,m]),w=A.useCallback(async()=>{o&&confirm(`ç¡®å®šå–æ¶ˆè®¢é˜…ã€Œ${o.title||o.url}ã€ï¼Ÿå…³è”æ–‡ç« ä¸ä¼šè¢«åˆ é™¤ã€‚`)&&await t(o.id)},[o,t]),E=S=>S?new Date(S).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"-";return n?o?l.jsxs("div",{className:`
        flex flex-col bg-[#0f0f0f] border-l border-[#262626] shrink-0
        overflow-hidden relative
        ${a?"w-0 border-l-0":""}
      `,style:a?void 0:{width:b},children:[!a&&l.jsx("div",{onMouseDown:x,className:"absolute left-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500/30 active:bg-blue-500/50 z-10 transition-colors"}),l.jsxs("div",{className:"flex flex-col h-full overflow-y-auto",style:{minWidth:b},children:[l.jsxs("div",{className:"px-5 pt-5 pb-4 border-b border-[#1e1e1e]",children:[l.jsxs("div",{className:"flex items-start gap-3",children:[o.favicon?l.jsx("img",{src:o.favicon,alt:"",className:"w-10 h-10 rounded-lg shrink-0 mt-0.5"}):l.jsx("div",{className:"w-10 h-10 rounded-lg bg-[#222] flex items-center justify-center shrink-0 mt-0.5",children:l.jsx(hu,{size:18,className:"text-gray-500"})}),l.jsxs("div",{className:"min-w-0 flex-1",children:[l.jsx("h2",{className:"text-[15px] font-semibold text-white leading-tight truncate",children:o.title||o.url}),l.jsxs("a",{href:o.url,className:"flex items-center gap-1 text-[11px] text-gray-500 hover:text-blue-400 mt-1 truncate transition-colors",title:o.url,children:[l.jsx(fy,{size:10,className:"shrink-0"}),l.jsx("span",{className:"truncate",children:o.url})]})]})]}),o.description&&l.jsx("p",{className:"mt-3 text-[12px] text-gray-400 leading-relaxed",children:o.description})]}),l.jsxs("div",{className:"px-5 py-4 space-y-3 border-b border-[#1e1e1e]",children:[l.jsxs("div",{className:"flex items-center gap-2.5 text-[12px]",children:[l.jsx(cR,{size:13,className:"text-gray-500 shrink-0"}),l.jsx("span",{className:"text-gray-500",children:"Category"}),l.jsx("span",{className:"ml-auto text-gray-300",children:o.category||"Uncategorized"})]}),l.jsxs("div",{className:"flex items-center gap-2.5 text-[12px]",children:[l.jsx(ma,{size:13,className:"text-gray-500 shrink-0"}),l.jsx("span",{className:"text-gray-500",children:"Fetch Interval"}),l.jsxs("span",{className:"ml-auto text-gray-300",children:[o.fetchInterval," min"]})]}),l.jsxs("div",{className:"flex items-center gap-2.5 text-[12px]",children:[l.jsx(El,{size:13,className:"text-gray-500 shrink-0"}),l.jsx("span",{className:"text-gray-500",children:"Articles"}),l.jsxs("span",{className:"ml-auto text-gray-300",children:[(h==null?void 0:h.total)||0," total / ",(h==null?void 0:h.unseen)||0," unseen"]})]}),l.jsxs("div",{className:"flex items-center gap-2.5 text-[12px]",children:[l.jsx(tF,{size:13,className:"text-gray-500 shrink-0"}),l.jsx("span",{className:"text-gray-500",children:"Health"}),l.jsx("span",{className:"ml-auto flex items-center gap-1",children:o.errorCount===0?l.jsxs(l.Fragment,{children:[l.jsx(Xh,{size:12,className:"text-green-500"}),l.jsx("span",{className:"text-green-400",children:"Healthy"})]}):l.jsxs(l.Fragment,{children:[l.jsx(vg,{size:12,className:"text-red-500"}),l.jsxs("span",{className:"text-red-400",children:[o.errorCount," errors"]})]})})]}),l.jsxs("div",{className:"flex items-center gap-2.5 text-[12px]",children:[l.jsx(va,{size:13,className:"text-gray-500 shrink-0"}),l.jsx("span",{className:"text-gray-500",children:"Last Fetched"}),l.jsx("span",{className:"ml-auto text-gray-300",children:E(o.lastFetchedAt)})]}),l.jsxs("div",{className:"flex items-center gap-2.5 text-[12px]",children:[l.jsx(Ym,{size:13,className:"text-gray-500 shrink-0"}),l.jsx("span",{className:"text-gray-500",children:"Created"}),l.jsx("span",{className:"ml-auto text-gray-300",children:E(o.createdAt)})]})]}),l.jsxs("div",{className:"px-5 py-3 flex items-center gap-2 border-b border-[#1e1e1e]",children:[l.jsxs("button",{onClick:y,disabled:g,className:"flex items-center gap-1.5 px-3 py-1.5 rounded-md text-[12px] bg-white/5 hover:bg-white/10 text-gray-300 border border-white/10 transition-colors cursor-pointer disabled:opacity-50",children:[l.jsx(va,{size:12,className:g?"animate-spin":""}),g?"Fetching...":"Fetch now"]}),l.jsxs("button",{onClick:()=>e(o),className:"flex items-center gap-1.5 px-3 py-1.5 rounded-md text-[12px] bg-white/5 hover:bg-white/10 text-gray-300 border border-white/10 transition-colors cursor-pointer",children:[l.jsx(YC,{size:12}),"Edit"]}),l.jsxs("button",{onClick:w,className:"flex items-center gap-1.5 px-3 py-1.5 rounded-md text-[12px] text-red-400 bg-white/5 hover:bg-red-500/10 border border-white/10 transition-colors cursor-pointer",children:[l.jsx(Wi,{size:12}),"Unsubscribe"]})]}),o.wechatBiz&&l.jsx("div",{className:"px-5 py-4 border-b border-[#1e1e1e]",children:l.jsx(mH,{feedId:o.id,feedTitle:o.title||o.url,onRefresh:m})}),l.jsxs("div",{className:"px-5 py-4",children:[l.jsx("h3",{className:"text-[11px] font-medium text-gray-500 uppercase tracking-wider mb-3",children:"Recent Articles"}),f.length===0?l.jsx("p",{className:"text-[12px] text-gray-600",children:"No articles yet"}):l.jsx("div",{className:"space-y-2",children:f.map(S=>l.jsxs("button",{onClick:()=>s==null?void 0:s(S.id),className:"w-full text-left px-3 py-2 rounded-md hover:bg-white/5 transition-colors cursor-pointer",children:[l.jsx("p",{className:"text-[12px] text-gray-300 truncate",children:S.title||"Untitled"}),l.jsx("p",{className:"text-[10px] text-gray-600 mt-0.5",children:E(S.savedAt)})]},S.id))})]})]})]}):l.jsxs("div",{className:`
          flex flex-col bg-[#0f0f0f] border-l border-[#262626] shrink-0
          overflow-hidden relative
          ${a?"w-0 border-l-0":""}
        `,style:a?void 0:{width:b},children:[!a&&l.jsx("div",{onMouseDown:x,className:"absolute left-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500/30 active:bg-blue-500/50 z-10 transition-colors"}),l.jsx("div",{className:"flex items-center justify-center h-full text-gray-500 text-[13px]",style:{minWidth:b},children:"Loading..."})]}):l.jsxs("div",{className:`
          flex flex-col bg-[#0f0f0f] border-l border-[#262626] shrink-0
          overflow-hidden relative
          ${a?"w-0 border-l-0":""}
        `,style:a?void 0:{width:b},children:[!a&&l.jsx("div",{onMouseDown:x,className:"absolute left-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500/30 active:bg-blue-500/50 z-10 transition-colors"}),l.jsx("div",{className:"flex items-center justify-center h-full text-gray-600 text-[13px]",style:{minWidth:b},children:"é€‰æ‹©ä¸€ä¸ªè®¢é˜…æºæŸ¥çœ‹è¯¦æƒ…"})]})}const yH=[{key:"inbox",label:"INBOX"},{key:"later",label:"LATER"},{key:"archive",label:"ARCHIVE"}],vH={inbox:"Newly saved books will appear in Inbox until triaged",later:"Books saved for later will appear here",archive:"Archived books will appear here"};function bH({selectedBookId:n,onSelectBook:e,onOpenReader:t,refreshTrigger:i,expanded:s}){const[r,a]=A.useState(()=>localStorage.getItem("z-reader-tab-book")||"inbox"),[o,c]=A.useState([]),[h,d]=A.useState(!1),[f,p]=A.useState(!1),{showToast:g}=Sa(),v=wR(),b=A.useRef(null);A.useEffect(()=>{localStorage.setItem("z-reader-tab-book",r)},[r]);const x=A.useCallback(async()=>{d(!0);try{const E={readStatus:r,limit:100},S=await window.electronAPI.bookList(E);c(S)}catch(E){console.error("Failed to fetch books:",E)}finally{d(!1)}},[r]),m=A.useCallback(async()=>{p(!0);try{const E=await window.electronAPI.bookImport();if(E.length===0)return;a("inbox");const S=await window.electronAPI.bookList({readStatus:"inbox",limit:100});c(S),e(E[0].id)}catch(E){console.error("Failed to import books:",E)}finally{p(!1)}},[e]),y=A.useCallback(async(E,S)=>{try{const _=o.find(j=>j.id===E),T=(_==null?void 0:_.readStatus)??"inbox";await window.electronAPI.bookUpdate({id:E,readStatus:S}),await x(),e(E),g(S==="archive"?"Archived":S==="later"?"Saved for later":"Moved to Inbox","success"),v.push({description:`Revert to ${T}`,undo:async()=>{await window.electronAPI.bookUpdate({id:E,readStatus:T}),await x(),e(E),g("Undone","info")}})}catch(_){console.error("Failed to update book status:",_)}},[o,x,e,g,v]),w=A.useCallback(async E=>{try{await window.electronAPI.bookDelete(E),await x(),g("Moved to Trash","success"),v.push({description:"Undo delete",undo:async()=>{await window.electronAPI.bookRestore(E),await x(),e(E),g("Restored","info")}})}catch(S){console.error("Failed to delete book:",S)}},[x,e,g,v]);return A.useEffect(()=>{x()},[x,i]),A.useEffect(()=>{if(!n||!b.current)return;const E=b.current.querySelector(`[data-book-id="${n}"]`);E==null||E.scrollIntoView({block:"nearest"})},[n]),A.useEffect(()=>{const E=S=>{const _=S.target.tagName;if(!(_==="INPUT"||_==="TEXTAREA"))switch(S.key){case"j":case"ArrowDown":{S.preventDefault();const T=o.findIndex(M=>M.id===n),j=T<o.length-1?T+1:T;o[j]&&e(o[j].id);break}case"k":case"ArrowUp":{S.preventDefault();const T=o.findIndex(M=>M.id===n),j=T>0?T-1:0;o[j]&&e(o[j].id);break}case"Enter":{n&&(S.preventDefault(),t(n));break}case"1":{S.preventDefault(),a("inbox");break}case"2":{S.preventDefault(),a("later");break}case"3":{S.preventDefault(),a("archive");break}case"e":case"E":{S.preventDefault(),n&&y(n,"archive");break}case"l":case"L":{S.preventDefault(),n&&y(n,"later");break}case"d":case"D":{S.preventDefault(),n&&w(n);break}case"z":case"Z":{S.preventDefault(),v.canUndo&&v.undo();break}}};return document.addEventListener("keydown",E),()=>document.removeEventListener("keydown",E)},[o,n,e,t,y,w,v]),l.jsxs("div",{className:`flex flex-col border-r border-[#262626] bg-[#141414] h-full flex-1 ${s?"min-w-[360px]":"min-w-[300px]"}`,children:[l.jsxs("div",{className:"shrink-0",children:[l.jsxs("div",{className:"px-4 pt-4 pb-2 flex items-center justify-between",children:[l.jsx("h2",{className:"text-[13px] font-semibold text-white tracking-wide",children:"Books"}),l.jsxs("button",{onClick:m,disabled:f,className:"h-8 px-2.5 rounded-md border border-white/10 bg-white/5 hover:bg-white/10 disabled:opacity-60 disabled:cursor-not-allowed text-xs text-gray-300 hover:text-white transition-colors cursor-pointer flex items-center gap-1.5",title:"å¯¼å…¥ä¹¦ç±",children:[f?l.jsx(nt,{className:"w-3.5 h-3.5 animate-spin"}):l.jsx(vR,{className:"w-3.5 h-3.5"}),l.jsx("span",{children:"å¯¼å…¥"})]})]}),l.jsx("div",{className:"flex px-4 gap-4 border-b border-[#262626]",children:yH.map(E=>l.jsx("button",{onClick:()=>a(E.key),className:`
                pb-2 text-[11px] font-medium tracking-[0.08em] transition-colors cursor-pointer
                ${r===E.key?"text-white border-b-2 border-blue-500":"text-[#555] hover:text-[#888] border-b-2 border-transparent"}
              `,children:E.label},E.key))})]}),l.jsx("div",{ref:b,className:"flex-1 overflow-y-auto",children:h&&o.length===0?l.jsx("div",{className:"flex items-center justify-center h-full",children:l.jsx("span",{className:"text-[13px] text-[#555]",children:"Loading..."})}):o.length===0?l.jsx("div",{className:"flex items-center justify-center h-full px-8",children:l.jsx("span",{className:"text-[13px] text-[#555] text-center",children:vH[r]})}):l.jsx("div",{children:o.map(E=>l.jsx("div",{"data-book-id":E.id,className:"border-b border-[#262626]",children:l.jsx(wH,{book:E,isSelected:E.id===n,onSelect:e,onOpen:t})},E.id))})}),l.jsxs("div",{className:"shrink-0 px-4 py-1.5 border-t border-[#262626] text-[11px] text-[#555]",children:[o.length," ",o.length===1?"book":"books"]})]})}function wH({book:n,isSelected:e,onSelect:t,onOpen:i}){const[s,r]=A.useState(!1),a=Math.round(n.readProgress*100);return l.jsxs("div",{onClick:()=>{t(n.id),i(n.id)},onMouseEnter:()=>{r(!0),t(n.id)},onMouseLeave:()=>r(!1),className:`
        relative flex gap-3 px-4 py-3 cursor-pointer transition-colors
        ${e?"border-l-2 border-blue-500 bg-white/[0.04]":"border-l-2 border-transparent hover:bg-white/[0.03]"}
      `,children:[l.jsx("div",{className:"shrink-0",children:n.cover?l.jsx("img",{src:n.cover,alt:"",className:"w-10 h-14 rounded object-cover"}):l.jsx("div",{className:"w-10 h-14 rounded bg-white/[0.06] flex items-center justify-center",children:l.jsx(qr,{size:16,className:"text-gray-500"})})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("h3",{className:"text-[14px] font-medium text-gray-100 truncate leading-snug",children:n.title||"Untitled"}),n.author&&l.jsx("p",{className:"mt-0.5 text-[12px] text-gray-500 truncate",children:n.author}),a>0&&l.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[l.jsx("div",{className:"flex-1 h-1 rounded-full bg-white/10",children:l.jsx("div",{className:"h-1 rounded-full bg-blue-500 transition-all",style:{width:`${a}%`}})}),l.jsxs("span",{className:"text-[10px] text-gray-500 tabular-nums shrink-0",children:[a,"%"]})]})]}),s&&l.jsx("div",{className:"absolute right-3 top-3",children:l.jsx("button",{onClick:o=>{o.stopPropagation(),i(n.id)},className:"p-1.5 rounded bg-[#1e1e1e] border border-white/10 hover:bg-white/10 text-gray-400 hover:text-white transition-colors shadow-lg",title:"Open",children:l.jsx(qr,{size:14})})})]})}function SH({bookId:n,collapsed:e,onOpenReader:t,onRefresh:i}){const[s,r]=A.useState(null),[a,o]=A.useState(!1),{width:c,handleMouseDown:h}=Sg({defaultWidth:360,minWidth:280,maxWidth:600,storageKey:"bookDetailPanelWidth"});A.useEffect(()=>{if(!n){r(null);return}let b=!1;return o(!0),window.electronAPI.bookGet(n).then(x=>{b||(r(x),o(!1))}).catch(()=>{b||(r(null),o(!1))}),()=>{b=!0}},[n]);const d=A.useCallback(async b=>{if(n)try{const x=await window.electronAPI.bookUpdate({id:n,readStatus:b});r(x),i()}catch(x){console.error("Failed to update book status:",x)}},[n,i]),f=A.useCallback(async()=>{if(n)try{await window.electronAPI.bookDelete(n),i()}catch(b){console.error("Failed to delete book:",b)}},[n,i]),p=s?Math.round(s.readProgress*100):0,g={inbox:"æ”¶ä»¶ç®±",later:"ç¨åŽé˜…è¯»",archive:"å·²å½’æ¡£"},v=s?[{label:"Author",value:s.author,icon:l.jsx(rw,{className:"w-3.5 h-3.5"})},{label:"Publisher",value:s.publisher,icon:l.jsx(aR,{className:"w-3.5 h-3.5"})},{label:"Language",value:s.language,icon:l.jsx(ad,{className:"w-3.5 h-3.5"})}]:[];return l.jsxs("div",{className:`
        flex flex-col bg-[#0f0f0f] border-l border-[#262626] shrink-0
        overflow-hidden relative
        ${e?"w-0 border-l-0":""}
      `,style:e?void 0:{width:c},children:[!e&&l.jsx("div",{onMouseDown:h,className:"absolute left-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500/30 active:bg-blue-500/50 z-10 transition-colors"}),l.jsx("div",{className:"flex flex-col h-full",style:{minWidth:c},children:l.jsx("div",{className:"flex-1 overflow-y-auto p-4 flex flex-col",children:n?a?l.jsx("div",{className:"flex items-center justify-center h-full text-sm text-gray-500",children:"åŠ è½½ä¸­â€¦"}):s?l.jsxs("div",{className:"flex-1 flex flex-col",children:[l.jsx("div",{className:"flex justify-center py-4",children:s.cover?l.jsx("img",{src:s.cover,alt:"",className:"w-32 h-48 rounded-lg object-cover shadow-lg"}):l.jsx("div",{className:"w-32 h-48 rounded-lg bg-white/[0.06] flex items-center justify-center",children:l.jsx(qr,{size:32,className:"text-gray-500"})})}),l.jsx("h2",{className:"text-[16px] font-semibold text-white text-center leading-snug",children:s.title||"Untitled"}),s.author&&l.jsx("p",{className:"mt-1 text-[13px] text-gray-500 text-center",children:s.author}),l.jsxs("div",{className:"mt-6 rounded-lg bg-[#1a1a1a] border border-white/5 p-3",children:[l.jsxs("div",{className:"flex items-center justify-between text-[12px]",children:[l.jsx("span",{className:"text-gray-500",children:"çŠ¶æ€"}),l.jsx("span",{className:"text-white font-medium",children:g[s.readStatus]??s.readStatus})]}),l.jsxs("div",{className:"mt-2",children:[l.jsxs("div",{className:"flex items-center justify-between text-[12px] mb-1",children:[l.jsx("span",{className:"text-gray-500",children:"é˜…è¯»è¿›åº¦"}),l.jsxs("span",{className:"text-white font-medium",children:[p,"%"]})]}),l.jsx("div",{className:"w-full h-1 rounded-full bg-white/10",children:l.jsx("div",{className:"h-1 rounded-full bg-blue-500 transition-all",style:{width:`${p}%`}})})]})]}),l.jsx("div",{className:"mt-4",children:v.map(b=>l.jsxs("div",{className:"flex items-center py-2.5 border-b border-white/5 last:border-b-0",children:[l.jsxs("span",{className:"flex items-center gap-1.5 text-[12px] text-gray-500 w-[120px] shrink-0",children:[b.icon,b.label]}),l.jsx("span",{className:"text-[13px] text-white truncate",children:b.value||"â€”"})]},b.label))}),s.description&&l.jsxs("div",{className:"mt-4",children:[l.jsx("h3",{className:"text-[11px] font-semibold uppercase tracking-wider text-gray-500",children:"Description"}),l.jsx("p",{className:"mt-2 text-[13px] leading-[1.6] text-gray-400 line-clamp-6",children:s.description})]}),l.jsxs("div",{className:"mt-auto pt-6 flex flex-col gap-2",children:[l.jsxs("button",{onClick:()=>t(s.id),className:"w-full py-2 rounded-lg bg-blue-600 hover:bg-blue-500 text-white text-[13px] font-medium transition-colors cursor-pointer flex items-center justify-center gap-2",children:[l.jsx(qr,{size:14}),"æ‰“å¼€é˜…è¯»"]}),l.jsxs("div",{className:"flex gap-2",children:[s.readStatus!=="later"&&l.jsxs("button",{onClick:()=>d("later"),className:"flex-1 py-1.5 rounded-lg bg-white/5 hover:bg-white/10 text-gray-400 hover:text-white text-[12px] transition-colors cursor-pointer flex items-center justify-center gap-1.5",children:[l.jsx(ma,{size:13}),"ç¨åŽ"]}),s.readStatus!=="archive"&&l.jsxs("button",{onClick:()=>d("archive"),className:"flex-1 py-1.5 rounded-lg bg-white/5 hover:bg-white/10 text-gray-400 hover:text-white text-[12px] transition-colors cursor-pointer flex items-center justify-center gap-1.5",children:[l.jsx(tg,{size:13}),"å½’æ¡£"]}),l.jsxs("button",{onClick:f,className:"flex-1 py-1.5 rounded-lg bg-white/5 hover:bg-white/10 text-gray-400 hover:text-red-400 text-[12px] transition-colors cursor-pointer flex items-center justify-center gap-1.5",children:[l.jsx(Wi,{size:13}),"åˆ é™¤"]})]})]})]}):l.jsx("div",{className:"flex items-center justify-center h-full text-sm text-gray-500",children:"ä¹¦ç±ä¸å­˜åœ¨"}):l.jsx("div",{className:"flex items-center justify-center h-full text-sm text-gray-500",children:"é€‰æ‹©ä¸€æœ¬ä¹¦æŸ¥çœ‹è¯¦æƒ…"})})})]})}function AH({onImported:n,collapsed:e}){const[t,i]=A.useState(!1),s=A.useCallback(async()=>{try{(await window.electronAPI.bookImport()).length>0&&n()}catch(d){console.error("Failed to import book:",d)}},[n]),r=A.useCallback(d=>{d.preventDefault(),d.stopPropagation(),i(!0)},[]),a=A.useCallback(d=>{d.preventDefault(),d.stopPropagation(),i(!1)},[]),o=A.useCallback(d=>{d.preventDefault(),d.stopPropagation(),i(!1),s()},[s]),{width:c,handleMouseDown:h}=Sg({defaultWidth:360,minWidth:280,maxWidth:600,storageKey:"bookUploadPanelWidth"});return l.jsxs("div",{className:`
        flex flex-col bg-[#0f0f0f] border-l border-[#262626] shrink-0
        overflow-hidden relative
        ${e?"w-0 border-l-0":""}
      `,style:e?void 0:{width:c},children:[!e&&l.jsx("div",{onMouseDown:h,className:"absolute left-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500/30 active:bg-blue-500/50 z-10 transition-colors"}),l.jsxs("div",{className:"flex flex-col h-full",style:{minWidth:c},children:[l.jsx("div",{className:"shrink-0 px-4 pt-3 pb-2 border-b border-white/5",children:l.jsx("h3",{className:"text-[13px] font-semibold text-white",children:"Upload Books"})}),l.jsx("div",{className:"flex-1 flex items-center justify-center p-6",children:l.jsxs("div",{onDragOver:r,onDragLeave:a,onDrop:o,className:`
              w-full rounded-xl border-2 border-dashed p-8 flex flex-col items-center gap-4 transition-colors
              ${t?"border-blue-500 bg-blue-500/5":"border-white/10 hover:border-white/20"}
            `,children:[l.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/5 flex items-center justify-center",children:l.jsx(vR,{size:24,className:"text-gray-500"})}),l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-[14px] text-gray-300",children:"Drag and drop EPUB/PDF files here"}),l.jsx("p",{className:"mt-1 text-[12px] text-gray-600",children:"Max file size: 500 MB"})]}),l.jsx("button",{onClick:s,className:"text-[13px] text-blue-400 hover:text-blue-300 transition-colors cursor-pointer",children:"Select a book file"})]})}),l.jsxs("div",{className:"shrink-0 px-6 pb-6 flex items-center gap-2 text-[12px] text-gray-600",children:[l.jsx(qr,{size:14}),l.jsx("span",{children:"Supported: EPUB, PDF"})]})]})]})}function EH({items:n,onNavigate:e,loading:t}){function i(s,r=0){return s.map(a=>l.jsxs("li",{children:[l.jsx("button",{onClick:()=>e(a),className:"text-[13px] text-gray-400 hover:text-white hover:bg-white/5 rounded-md px-3 py-1.5 text-left truncate w-full transition-colors cursor-pointer",style:{paddingLeft:`${12+r*12}px`},children:a.label}),a.children&&a.children.length>0&&l.jsx("ul",{className:"space-y-0.5",children:i(a.children,r+1)})]},a.id))}return l.jsx("div",{className:"flex-1 overflow-y-auto p-2",children:n.length>0?l.jsx("ul",{className:"space-y-0.5",children:i(n)}):l.jsx("p",{className:"px-3 py-4 text-[13px] text-gray-500",children:t?"åŠ è½½ä¸­â€¦":"æ­¤ä¹¦ç±æ²¡æœ‰ç›®å½•"})})}const hT={yellow:"#fbbf24",blue:"#3b82f6",green:"#22c55e",red:"#ef4444"};function CH(n){const e=Date.now()-new Date(n).getTime(),t=Math.floor(e/6e4);if(t<1)return"åˆšåˆš";if(t<60)return`${t} åˆ†é’Ÿå‰`;const i=Math.floor(t/60);if(i<24)return`${i} å°æ—¶å‰`;const s=Math.floor(i/24);return s<30?`${s} å¤©å‰`:new Date(n).toLocaleDateString("zh-CN")}function NH({book:n,readProgress:e,highlights:t,activeTab:i,onTabChange:s,focusedHighlightId:r,focusSignal:a,onHighlightsChange:o,onDeleteHighlight:c,onHighlightClick:h}){var M;const{width:d,handleMouseDown:f}=Sg({defaultWidth:500,minWidth:240,maxWidth:500,storageKey:"bookReaderDetailPanelWidth"}),[p,g]=A.useState("info"),[v,b]=A.useState(null),[x,m]=A.useState(""),[y,w]=A.useState(null),E=A.useRef(new Map),S=i??p,_=A.useCallback(L=>{i===void 0&&g(L),s==null||s(L)},[i,s]);A.useEffect(()=>{if(!r||S!=="notebook")return;const L=E.current.get(r);if(!L)return;L.scrollIntoView({behavior:"smooth",block:"center"}),w(r);const O=window.setTimeout(()=>{w(B=>B===r?null:B)},1200);return()=>window.clearTimeout(O)},[r,a,S]);const T=A.useCallback(async(L,O)=>{const B=await window.electronAPI.highlightUpdate({id:L,note:O});o(t.map(G=>G.id===L?B:G)),b(null)},[t,o]),j=[...t].sort((L,O)=>new Date(O.createdAt).getTime()-new Date(L.createdAt).getTime());return l.jsxs("div",{className:"shrink-0 flex flex-col h-full min-h-0 border-l border-[#262626] bg-[#141414] relative",style:{width:d},children:[l.jsx("div",{onMouseDown:f,className:"absolute left-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500/30 active:bg-blue-500/50 z-10 transition-colors"}),l.jsx("div",{className:"shrink-0 flex gap-1.5 px-3 pt-3 pb-1 border-b border-[#262626]",children:[{key:"info",label:"Info"},{key:"notebook",label:"Notebook",count:t.length},{key:"chat",label:"Chat"}].map(L=>l.jsxs("button",{onClick:()=>_(L.key),className:`
              px-3 py-1.5 text-[13px] font-medium rounded-t-md transition-colors cursor-pointer flex items-center gap-1.5 relative
              ${S===L.key?"text-white":"text-gray-500 hover:text-gray-300"}
            `,children:[L.label,L.count!=null&&L.count>0&&l.jsx("span",{className:"text-[11px] text-gray-500",children:L.count}),S===L.key&&l.jsx("span",{className:"absolute bottom-[-1px] left-0 right-0 h-0.5 bg-blue-500 rounded-full"})]},L.key))}),l.jsxs("div",{className:"flex-1 min-h-0 overflow-y-auto p-4",children:[S==="info"&&n&&l.jsxs("div",{className:"flex flex-col gap-5",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-[11px] font-bold uppercase tracking-wider text-gray-500 mb-2",children:"Details"}),[{label:"Type",value:((M=n.fileType)==null?void 0:M.toUpperCase())||"EPUB",icon:l.jsx(El,{className:"w-3.5 h-3.5"})},{label:"Author",value:n.author,icon:l.jsx(rw,{className:"w-3.5 h-3.5"})},{label:"Publisher",value:n.publisher,icon:l.jsx(aR,{className:"w-3.5 h-3.5"})},{label:"Language",value:n.language,icon:l.jsx(ad,{className:"w-3.5 h-3.5"})},{label:"Progress",value:`${Math.round((e??n.readProgress??0)*100)}%`,icon:l.jsx(ma,{className:"w-3.5 h-3.5"})}].map(L=>l.jsxs("div",{className:"flex items-center py-2.5 border-b border-white/5 last:border-b-0",children:[l.jsxs("span",{className:"flex items-center gap-2 text-[11px] text-gray-500 w-[100px] shrink-0 font-medium",children:[l.jsx("span",{className:"text-gray-600",children:L.icon}),L.label]}),l.jsx("span",{className:"text-[13px] text-gray-300 truncate",children:L.value||"â€”"})]},L.label))]}),n.description&&l.jsxs("div",{children:[l.jsx("h3",{className:"text-[11px] font-bold uppercase tracking-wider text-gray-500 mb-2",children:"Description"}),l.jsx("p",{className:"text-[13px] leading-[1.6] text-gray-400 line-clamp-6",children:n.description})]})]}),S==="notebook"&&l.jsx("div",{className:"flex flex-col",children:j.length===0?l.jsx("div",{className:"flex items-center justify-center h-[300px]",children:l.jsxs("div",{className:"text-center text-gray-500",children:[l.jsx(py,{className:"w-8 h-8 mx-auto mb-2 opacity-40"}),l.jsx("p",{className:"text-sm",children:"0 highlights"})]})}):l.jsxs("div",{className:"flex flex-col gap-4",children:[l.jsxs("span",{className:"text-[11px] font-bold uppercase tracking-wider text-gray-500",children:[j.length," ",j.length===1?"highlight":"highlights"]}),j.map(L=>l.jsxs("div",{ref:O=>{O?E.current.set(L.id,O):E.current.delete(L.id)},className:"group relative flex rounded-lg bg-[#1a1a1a] border border-white/5 overflow-hidden cursor-pointer hover:border-white/15 transition-colors",style:{boxShadow:y===L.id?"0 0 0 2px rgba(59,130,246,0.55) inset":void 0},onClick:()=>h==null?void 0:h(L.id),children:[l.jsx("div",{className:"w-[3px] shrink-0",style:{backgroundColor:hT[L.color]??hT.yellow}}),l.jsxs("div",{className:"flex-1 p-3 min-w-0",children:[l.jsxs("p",{className:"text-[13px] leading-[1.5] text-gray-300 italic",children:["â€œ",L.text,"â€"]}),v===L.id?l.jsx("textarea",{autoFocus:!0,value:x,onChange:O=>m(O.target.value),onBlur:()=>T(L.id,x),onKeyDown:O=>{O.key==="Enter"&&!O.shiftKey&&(O.preventDefault(),T(L.id,x)),O.key==="Escape"&&b(null)},className:"mt-2 w-full text-[12px] text-gray-300 bg-white/5 border border-white/10 rounded-md px-2.5 py-1.5 resize-none outline-none focus:border-blue-500/50",rows:2,placeholder:"æ·»åŠ ç¬”è®°â€¦"}):l.jsx("button",{onClick:O=>{O.stopPropagation(),b(L.id),m(L.note||"")},className:"mt-1.5 block text-left text-[12px] text-gray-500 hover:text-gray-400 transition-colors w-full",children:L.note||"æ·»åŠ ç¬”è®°â€¦"}),l.jsx("span",{className:"mt-2 block text-[10px] text-gray-600",children:CH(L.createdAt)})]}),l.jsx("button",{onClick:O=>{O.stopPropagation(),c(L.id)},className:"absolute top-2 right-2 p-1.5 rounded opacity-0 group-hover:opacity-100 hover:bg-white/10 transition-all cursor-pointer text-gray-500 hover:text-red-400",children:l.jsx(Wi,{className:"w-3.5 h-3.5"})})]},L.id))]})}),S==="chat"&&l.jsx("div",{className:"flex items-center justify-center h-[300px]",children:l.jsxs("div",{className:"text-center text-gray-600",children:[l.jsx(so,{className:"w-8 h-8 mx-auto mb-2 opacity-30"}),l.jsx("p",{className:"text-sm",children:"AI å¯¹è¯ï¼ˆäºŒæœŸåŠŸèƒ½ï¼‰"})]})})]})]})}const HR="z-reader-book-settings",_H=[{key:"system",label:"System"},{key:"serif",label:"Serif"},{key:"sans-serif",label:"Sans-serif"},{key:"monospace",label:"Monospace"}],kH=[1.5,1.75,2],TH=[{key:"dark",label:"Dark",preview:"bg-[#0f0f0f] border-gray-700"},{key:"light",label:"Light",preview:"bg-white border-gray-300"},{key:"sepia",label:"Sepia",preview:"bg-[#f4ecd8] border-amber-300"}],dT={font:"system",fontSize:16,lineHeight:1.75,theme:"dark"};function DH(){try{const n=localStorage.getItem(HR);if(n)return{...dT,...JSON.parse(n)}}catch{}return dT}function jH(n){localStorage.setItem(HR,JSON.stringify(n))}const ow={system:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',serif:'"Georgia", "Times New Roman", serif',"sans-serif":'"Helvetica Neue", "Arial", sans-serif',monospace:'"JetBrains Mono", "Fira Code", monospace'};function RH({open:n,onClose:e,settings:t,onSettingsChange:i}){const s=A.useRef(null);if(A.useEffect(()=>{if(!n)return;const a=o=>{s.current&&!s.current.contains(o.target)&&e()};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[n,e]),!n)return null;const r=a=>{const o={...t,...a};i(o),jH(o)};return l.jsxs("div",{ref:s,className:"absolute top-12 right-4 z-50 w-[260px] bg-[#1a1a1a] border border-white/10 rounded-lg shadow-xl p-4 space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("h3",{className:"text-[13px] font-semibold text-white",children:"æŽ’ç‰ˆè®¾ç½®"}),l.jsx("button",{onClick:e,className:"p-1 rounded hover:bg-white/10 text-gray-400 hover:text-white cursor-pointer",children:l.jsx(Vn,{className:"w-4 h-4"})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-[11px] text-gray-500 uppercase tracking-wider",children:"Font"}),l.jsx("div",{className:"mt-1 flex gap-1",children:_H.map(a=>l.jsx("button",{onClick:()=>r({font:a.key}),className:`flex-1 py-1 text-[11px] rounded transition-colors cursor-pointer ${t.font===a.key?"bg-white/10 text-white":"text-gray-500 hover:bg-white/5"}`,children:a.label},a.key))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-[11px] text-gray-500 uppercase tracking-wider",children:"Size"}),l.jsxs("div",{className:"mt-1 flex items-center gap-3",children:[l.jsx("button",{onClick:()=>r({fontSize:Math.max(12,t.fontSize-1)}),className:"w-7 h-7 rounded bg-white/5 text-white text-sm hover:bg-white/10 cursor-pointer",children:"âˆ’"}),l.jsx("span",{className:"text-[13px] text-white w-8 text-center",children:t.fontSize}),l.jsx("button",{onClick:()=>r({fontSize:Math.min(28,t.fontSize+1)}),className:"w-7 h-7 rounded bg-white/5 text-white text-sm hover:bg-white/10 cursor-pointer",children:"+"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-[11px] text-gray-500 uppercase tracking-wider",children:"Line Height"}),l.jsx("div",{className:"mt-1 flex gap-1",children:kH.map(a=>l.jsx("button",{onClick:()=>r({lineHeight:a}),className:`flex-1 py-1 text-[11px] rounded transition-colors cursor-pointer ${t.lineHeight===a?"bg-white/10 text-white":"text-gray-500 hover:bg-white/5"}`,children:a},a))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-[11px] text-gray-500 uppercase tracking-wider",children:"Theme"}),l.jsx("div",{className:"mt-1 flex gap-2",children:TH.map(a=>l.jsx("button",{onClick:()=>r({theme:a.key}),className:`flex-1 py-1.5 text-[11px] rounded border transition-colors cursor-pointer ${a.preview} ${t.theme===a.key?"ring-2 ring-blue-500":""}`,children:a.label},a.key))})]})]})}var nA={exports:{}},$R={exports:{}},LH=void 0,qR=function(n){return n!==LH&&n!==null},MH=qR,OH={object:!0,function:!0,undefined:!0},PH=function(n){return MH(n)?hasOwnProperty.call(OH,typeof n):!1},IH=PH,BH=function(n){if(!IH(n))return!1;try{return n.constructor?n.constructor.prototype===n:!1}catch{return!1}},zH=BH,FH=function(n){if(typeof n!="function"||!hasOwnProperty.call(n,"length"))return!1;try{if(typeof n.length!="number"||typeof n.call!="function"||typeof n.apply!="function")return!1}catch{return!1}return!zH(n)},UH=FH,HH=/^\s*class[\s{/}]/,$H=Function.prototype.toString,qH=function(n){return!(!UH(n)||HH.test($H.call(n)))},VH=function(){var n=Object.assign,e;return typeof n!="function"?!1:(e={foo:"raz"},n(e,{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")},E2,fT;function GH(){return fT||(fT=1,E2=function(){try{return Object.keys("primitive"),!0}catch{return!1}}),E2}var WH=function(){},YH=WH(),eN=function(n){return n!==YH&&n!==null},C2,pT;function XH(){if(pT)return C2;pT=1;var n=eN,e=Object.keys;return C2=function(t){return e(n(t)?Object(t):t)},C2}var N2,gT;function KH(){return gT||(gT=1,N2=GH()()?Object.keys:XH()),N2}var _2,mT;function ZH(){if(mT)return _2;mT=1;var n=eN;return _2=function(e){if(!n(e))throw new TypeError("Cannot use null or undefined");return e},_2}var k2,xT;function QH(){if(xT)return k2;xT=1;var n=KH(),e=ZH(),t=Math.max;return k2=function(i,s){var r,a,o=t(arguments.length,2),c;for(i=Object(e(i)),c=function(h){try{i[h]=s[h]}catch(d){r||(r=d)}},a=1;a<o;++a)s=arguments[a],n(s).forEach(c);if(r!==void 0)throw r;return i},k2}var JH=VH()?Object.assign:QH(),e$=eN,t$=Array.prototype.forEach,n$=Object.create,i$=function(n,e){var t;for(t in n)e[t]=n[t]},s$=function(n){var e=n$(null);return t$.call(arguments,function(t){e$(t)&&i$(Object(t),e)}),e},T2="razdwatrzy",r$=function(){return typeof T2.contains!="function"?!1:T2.contains("dwa")===!0&&T2.contains("foo")===!1},D2,yT;function a$(){if(yT)return D2;yT=1;var n=String.prototype.indexOf;return D2=function(e){return n.call(this,e,arguments[1])>-1},D2}var o$=r$()?String.prototype.contains:a$(),wv=qR,vT=qH,VR=JH,GR=s$,Rm=o$,l$=$R.exports=function(n,e){var t,i,s,r,a;return arguments.length<2||typeof n!="string"?(r=e,e=n,n=null):r=arguments[2],wv(n)?(t=Rm.call(n,"c"),i=Rm.call(n,"e"),s=Rm.call(n,"w")):(t=s=!0,i=!1),a={value:e,configurable:t,enumerable:i,writable:s},r?VR(GR(r),a):a};l$.gs=function(n,e,t){var i,s,r,a;return typeof n!="string"?(r=t,t=e,e=n,n=null):r=arguments[3],wv(e)?vT(e)?wv(t)?vT(t)||(r=t,t=void 0):t=void 0:(r=e,e=t=void 0):e=void 0,wv(n)?(i=Rm.call(n,"c"),s=Rm.call(n,"e")):(i=!0,s=!1),a={get:e,set:t,configurable:i,enumerable:s},r?VR(GR(r),a):a};var c$=$R.exports,u$=function(n){if(typeof n!="function")throw new TypeError(n+" is not a function");return n};(function(n,e){var t=c$,i=u$,s=Function.prototype.apply,r=Function.prototype.call,a=Object.create,o=Object.defineProperty,c=Object.defineProperties,h=Object.prototype.hasOwnProperty,d={configurable:!0,enumerable:!1,writable:!0},f,p,g,v,b,x,m;f=function(y,w){var E;return i(w),h.call(this,"__ee__")?E=this.__ee__:(E=d.value=a(null),o(this,"__ee__",d),d.value=null),E[y]?typeof E[y]=="object"?E[y].push(w):E[y]=[E[y],w]:E[y]=w,this},p=function(y,w){var E,S;return i(w),S=this,f.call(this,y,E=function(){g.call(S,y,E),s.call(w,this,arguments)}),E.__eeOnceListener__=w,this},g=function(y,w){var E,S,_,T;if(i(w),!h.call(this,"__ee__"))return this;if(E=this.__ee__,!E[y])return this;if(S=E[y],typeof S=="object")for(T=0;_=S[T];++T)(_===w||_.__eeOnceListener__===w)&&(S.length===2?E[y]=S[T?0:1]:S.splice(T,1));else(S===w||S.__eeOnceListener__===w)&&delete E[y];return this},v=function(y){var w,E,S,_,T;if(h.call(this,"__ee__")&&(_=this.__ee__[y],!!_))if(typeof _=="object"){for(E=arguments.length,T=new Array(E-1),w=1;w<E;++w)T[w-1]=arguments[w];for(_=_.slice(),w=0;S=_[w];++w)s.call(S,this,T)}else switch(arguments.length){case 1:r.call(_,this);break;case 2:r.call(_,this,arguments[1]);break;case 3:r.call(_,this,arguments[1],arguments[2]);break;default:for(E=arguments.length,T=new Array(E-1),w=1;w<E;++w)T[w-1]=arguments[w];s.call(_,this,T)}},b={on:f,once:p,off:g,emit:v},x={on:t(f),once:t(p),off:t(g),emit:t(v)},m=c({},x),n.exports=e=function(y){return y==null?a(m):c(Object(y),x)},e.methods=b})(nA,nA.exports);var h$=nA.exports;const uo=ed(h$);var du={},fu={};function d$(n,e,t){if(t===void 0&&(t=Array.prototype),n&&typeof t.find=="function")return t.find.call(n,e);for(var i=0;i<n.length;i++)if(Object.prototype.hasOwnProperty.call(n,i)){var s=n[i];if(e.call(void 0,s,i,n))return s}}function tN(n,e){return e===void 0&&(e=Object),e&&typeof e.freeze=="function"?e.freeze(n):n}var WR=tN({HTML:"text/html",isHTML:function(n){return n===WR.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),YR=tN({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(n){return n===YR.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});fu.find=d$;fu.freeze=tN;fu.MIME_TYPE=WR;fu.NAMESPACE=YR;var XR=fu,to=XR.find,Xm=XR.NAMESPACE;function f$(n){return n!==""}function p$(n){return n?n.split(/[\t\n\f\r ]+/).filter(f$):[]}function g$(n,e){return n.hasOwnProperty(e)||(n[e]=!0),n}function bT(n){if(!n)return[];var e=p$(n);return Object.keys(e.reduce(g$,{}))}function m$(n){return function(e){return n&&n.indexOf(e)!==-1}}function gy(n,e){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}function ks(n,e){var t=n.prototype;if(!(t instanceof e)){let i=function(){};i.prototype=e.prototype,i=new i,gy(t,i),n.prototype=t=i}t.constructor!=n&&(typeof n!="function"&&console.error("unknown Class:"+n),t.constructor=n)}var Ts={},ga=Ts.ELEMENT_NODE=1,ig=Ts.ATTRIBUTE_NODE=2,Ub=Ts.TEXT_NODE=3,KR=Ts.CDATA_SECTION_NODE=4,ZR=Ts.ENTITY_REFERENCE_NODE=5,x$=Ts.ENTITY_NODE=6,QR=Ts.PROCESSING_INSTRUCTION_NODE=7,JR=Ts.COMMENT_NODE=8,e4=Ts.DOCUMENT_NODE=9,t4=Ts.DOCUMENT_TYPE_NODE=10,Cl=Ts.DOCUMENT_FRAGMENT_NODE=11,y$=Ts.NOTATION_NODE=12,Xi={},wi={};Xi.INDEX_SIZE_ERR=(wi[1]="Index size error",1);Xi.DOMSTRING_SIZE_ERR=(wi[2]="DOMString size error",2);var As=Xi.HIERARCHY_REQUEST_ERR=(wi[3]="Hierarchy request error",3);Xi.WRONG_DOCUMENT_ERR=(wi[4]="Wrong document",4);Xi.INVALID_CHARACTER_ERR=(wi[5]="Invalid character",5);Xi.NO_DATA_ALLOWED_ERR=(wi[6]="No data allowed",6);Xi.NO_MODIFICATION_ALLOWED_ERR=(wi[7]="No modification allowed",7);var n4=Xi.NOT_FOUND_ERR=(wi[8]="Not found",8);Xi.NOT_SUPPORTED_ERR=(wi[9]="Not supported",9);var wT=Xi.INUSE_ATTRIBUTE_ERR=(wi[10]="Attribute in use",10);Xi.INVALID_STATE_ERR=(wi[11]="Invalid state",11);Xi.SYNTAX_ERR=(wi[12]="Syntax error",12);Xi.INVALID_MODIFICATION_ERR=(wi[13]="Invalid modification",13);Xi.NAMESPACE_ERR=(wi[14]="Invalid namespace",14);Xi.INVALID_ACCESS_ERR=(wi[15]="Invalid access",15);function Hn(n,e){if(e instanceof Error)var t=e;else t=this,Error.call(this,wi[n]),this.message=wi[n],Error.captureStackTrace&&Error.captureStackTrace(this,Hn);return t.code=n,e&&(this.message=this.message+": "+e),t}Hn.prototype=Error.prototype;gy(Xi,Hn);function gl(){}gl.prototype={length:0,item:function(n){return n>=0&&n<this.length?this[n]:null},toString:function(n,e){for(var t=[],i=0;i<this.length;i++)ef(this[i],t,n,e);return t.join("")},filter:function(n){return Array.prototype.filter.call(this,n)},indexOf:function(n){return Array.prototype.indexOf.call(this,n)}};function sg(n,e){this._node=n,this._refresh=e,nN(this)}function nN(n){var e=n._node._inc||n._node.ownerDocument._inc;if(n._inc!==e){var t=n._refresh(n._node);if(p4(n,"length",t.length),!n.$$length||t.length<n.$$length)for(var i=t.length;i in n;i++)Object.prototype.hasOwnProperty.call(n,i)&&delete n[i];gy(t,n),n._inc=e}}sg.prototype.item=function(n){return nN(this),this[n]||null};ks(sg,gl);function Hb(){}function i4(n,e){for(var t=n.length;t--;)if(n[t]===e)return t}function ST(n,e,t,i){if(i?e[i4(e,i)]=t:e[e.length++]=t,n){t.ownerElement=n;var s=n.ownerDocument;s&&(i&&a4(s,n,i),v$(s,n,t))}}function AT(n,e,t){var i=i4(e,t);if(i>=0){for(var s=e.length-1;i<s;)e[i]=e[++i];if(e.length=s,n){var r=n.ownerDocument;r&&(a4(r,n,t),t.ownerElement=null)}}else throw new Hn(n4,new Error(n.tagName+"@"+t))}Hb.prototype={length:0,item:gl.prototype.item,getNamedItem:function(n){for(var e=this.length;e--;){var t=this[e];if(t.nodeName==n)return t}},setNamedItem:function(n){var e=n.ownerElement;if(e&&e!=this._ownerElement)throw new Hn(wT);var t=this.getNamedItem(n.nodeName);return ST(this._ownerElement,this,n,t),t},setNamedItemNS:function(n){var e=n.ownerElement,t;if(e&&e!=this._ownerElement)throw new Hn(wT);return t=this.getNamedItemNS(n.namespaceURI,n.localName),ST(this._ownerElement,this,n,t),t},removeNamedItem:function(n){var e=this.getNamedItem(n);return AT(this._ownerElement,this,e),e},removeNamedItemNS:function(n,e){var t=this.getNamedItemNS(n,e);return AT(this._ownerElement,this,t),t},getNamedItemNS:function(n,e){for(var t=this.length;t--;){var i=this[t];if(i.localName==e&&i.namespaceURI==n)return i}return null}};function s4(){}s4.prototype={hasFeature:function(n,e){return!0},createDocument:function(n,e,t){var i=new my;if(i.implementation=this,i.childNodes=new gl,i.doctype=t||null,t&&i.appendChild(t),e){var s=i.createElementNS(n,e);i.appendChild(s)}return i},createDocumentType:function(n,e,t){var i=new lw;return i.name=n,i.nodeName=n,i.publicId=e||"",i.systemId=t||"",i}};function Xt(){}Xt.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(n,e){return $b(this,n,e)},replaceChild:function(n,e){$b(this,n,e,l4),e&&this.removeChild(e)},removeChild:function(n){return o4(this,n)},appendChild:function(n){return this.insertBefore(n,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(n){return iA(this.ownerDocument||this,this,n)},normalize:function(){for(var n=this.firstChild;n;){var e=n.nextSibling;e&&e.nodeType==Ub&&n.nodeType==Ub?(this.removeChild(e),n.appendData(e.data)):(n.normalize(),n=e)}},isSupported:function(n,e){return this.ownerDocument.implementation.hasFeature(n,e)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(n){for(var e=this;e;){var t=e._nsMap;if(t){for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)&&t[i]===n)return i}e=e.nodeType==ig?e.ownerDocument:e.parentNode}return null},lookupNamespaceURI:function(n){for(var e=this;e;){var t=e._nsMap;if(t&&n in t&&Object.prototype.hasOwnProperty.call(t,n))return t[n];e=e.nodeType==ig?e.ownerDocument:e.parentNode}return null},isDefaultNamespace:function(n){var e=this.lookupPrefix(n);return e==null}};function r4(n){return n=="<"&&"&lt;"||n==">"&&"&gt;"||n=="&"&&"&amp;"||n=='"'&&"&quot;"||"&#"+n.charCodeAt()+";"}gy(Ts,Xt);gy(Ts,Xt.prototype);function Km(n,e){if(e(n))return!0;if(n=n.firstChild)do if(Km(n,e))return!0;while(n=n.nextSibling)}function my(){this.ownerDocument=this}function v$(n,e,t){n&&n._inc++;var i=t.namespaceURI;i===Xm.XMLNS&&(e._nsMap[t.prefix?t.localName:""]=t.value)}function a4(n,e,t,i){n&&n._inc++;var s=t.namespaceURI;s===Xm.XMLNS&&delete e._nsMap[t.prefix?t.localName:""]}function iN(n,e,t){if(n&&n._inc){n._inc++;var i=e.childNodes;if(t)i[i.length++]=t;else{for(var s=e.firstChild,r=0;s;)i[r++]=s,s=s.nextSibling;i.length=r,delete i[i.length]}}}function o4(n,e){var t=e.previousSibling,i=e.nextSibling;return t?t.nextSibling=i:n.firstChild=i,i?i.previousSibling=t:n.lastChild=t,e.parentNode=null,e.previousSibling=null,e.nextSibling=null,iN(n.ownerDocument,n),e}function b$(n){return n&&(n.nodeType===Xt.DOCUMENT_NODE||n.nodeType===Xt.DOCUMENT_FRAGMENT_NODE||n.nodeType===Xt.ELEMENT_NODE)}function w$(n){return n&&(no(n)||sN(n)||Nl(n)||n.nodeType===Xt.DOCUMENT_FRAGMENT_NODE||n.nodeType===Xt.COMMENT_NODE||n.nodeType===Xt.PROCESSING_INSTRUCTION_NODE)}function Nl(n){return n&&n.nodeType===Xt.DOCUMENT_TYPE_NODE}function no(n){return n&&n.nodeType===Xt.ELEMENT_NODE}function sN(n){return n&&n.nodeType===Xt.TEXT_NODE}function ET(n,e){var t=n.childNodes||[];if(to(t,no)||Nl(e))return!1;var i=to(t,Nl);return!(e&&i&&t.indexOf(i)>t.indexOf(e))}function CT(n,e){var t=n.childNodes||[];function i(r){return no(r)&&r!==e}if(to(t,i))return!1;var s=to(t,Nl);return!(e&&s&&t.indexOf(s)>t.indexOf(e))}function S$(n,e,t){if(!b$(n))throw new Hn(As,"Unexpected parent node type "+n.nodeType);if(t&&t.parentNode!==n)throw new Hn(n4,"child not in parent");if(!w$(e)||Nl(e)&&n.nodeType!==Xt.DOCUMENT_NODE)throw new Hn(As,"Unexpected node type "+e.nodeType+" for parent node type "+n.nodeType)}function A$(n,e,t){var i=n.childNodes||[],s=e.childNodes||[];if(e.nodeType===Xt.DOCUMENT_FRAGMENT_NODE){var r=s.filter(no);if(r.length>1||to(s,sN))throw new Hn(As,"More than one element or text in fragment");if(r.length===1&&!ET(n,t))throw new Hn(As,"Element in fragment can not be inserted before doctype")}if(no(e)&&!ET(n,t))throw new Hn(As,"Only one element can be added and only after doctype");if(Nl(e)){if(to(i,Nl))throw new Hn(As,"Only one doctype is allowed");var a=to(i,no);if(t&&i.indexOf(a)<i.indexOf(t))throw new Hn(As,"Doctype can only be inserted before an element");if(!t&&a)throw new Hn(As,"Doctype can not be appended since element is present")}}function l4(n,e,t){var i=n.childNodes||[],s=e.childNodes||[];if(e.nodeType===Xt.DOCUMENT_FRAGMENT_NODE){var r=s.filter(no);if(r.length>1||to(s,sN))throw new Hn(As,"More than one element or text in fragment");if(r.length===1&&!CT(n,t))throw new Hn(As,"Element in fragment can not be inserted before doctype")}if(no(e)&&!CT(n,t))throw new Hn(As,"Only one element can be added and only after doctype");if(Nl(e)){if(to(i,function(c){return Nl(c)&&c!==t}))throw new Hn(As,"Only one doctype is allowed");var a=to(i,no);if(t&&i.indexOf(a)<i.indexOf(t))throw new Hn(As,"Doctype can only be inserted before an element")}}function $b(n,e,t,i){S$(n,e,t),n.nodeType===Xt.DOCUMENT_NODE&&(i||A$)(n,e,t);var s=e.parentNode;if(s&&s.removeChild(e),e.nodeType===Cl){var r=e.firstChild;if(r==null)return e;var a=e.lastChild}else r=a=e;var o=t?t.previousSibling:n.lastChild;r.previousSibling=o,a.nextSibling=t,o?o.nextSibling=r:n.firstChild=r,t==null?n.lastChild=a:t.previousSibling=a;do r.parentNode=n;while(r!==a&&(r=r.nextSibling));return iN(n.ownerDocument||n,n),e.nodeType==Cl&&(e.firstChild=e.lastChild=null),e}function E$(n,e){return e.parentNode&&e.parentNode.removeChild(e),e.parentNode=n,e.previousSibling=n.lastChild,e.nextSibling=null,e.previousSibling?e.previousSibling.nextSibling=e:n.firstChild=e,n.lastChild=e,iN(n.ownerDocument,n,e),e}my.prototype={nodeName:"#document",nodeType:e4,doctype:null,documentElement:null,_inc:1,insertBefore:function(n,e){if(n.nodeType==Cl){for(var t=n.firstChild;t;){var i=t.nextSibling;this.insertBefore(t,e),t=i}return n}return $b(this,n,e),n.ownerDocument=this,this.documentElement===null&&n.nodeType===ga&&(this.documentElement=n),n},removeChild:function(n){return this.documentElement==n&&(this.documentElement=null),o4(this,n)},replaceChild:function(n,e){$b(this,n,e,l4),n.ownerDocument=this,e&&this.removeChild(e),no(n)&&(this.documentElement=n)},importNode:function(n,e){return f4(this,n,e)},getElementById:function(n){var e=null;return Km(this.documentElement,function(t){if(t.nodeType==ga&&t.getAttribute("id")==n)return e=t,!0}),e},getElementsByClassName:function(n){var e=bT(n);return new sg(this,function(t){var i=[];return e.length>0&&Km(t.documentElement,function(s){if(s!==t&&s.nodeType===ga){var r=s.getAttribute("class");if(r){var a=n===r;if(!a){var o=bT(r);a=e.every(m$(o))}a&&i.push(s)}}}),i})},createElement:function(n){var e=new Kh;e.ownerDocument=this,e.nodeName=n,e.tagName=n,e.localName=n,e.childNodes=new gl;var t=e.attributes=new Hb;return t._ownerElement=e,e},createDocumentFragment:function(){var n=new cw;return n.ownerDocument=this,n.childNodes=new gl,n},createTextNode:function(n){var e=new rN;return e.ownerDocument=this,e.appendData(n),e},createComment:function(n){var e=new aN;return e.ownerDocument=this,e.appendData(n),e},createCDATASection:function(n){var e=new oN;return e.ownerDocument=this,e.appendData(n),e},createProcessingInstruction:function(n,e){var t=new cN;return t.ownerDocument=this,t.tagName=t.nodeName=t.target=n,t.nodeValue=t.data=e,t},createAttribute:function(n){var e=new qb;return e.ownerDocument=this,e.name=n,e.nodeName=n,e.localName=n,e.specified=!0,e},createEntityReference:function(n){var e=new lN;return e.ownerDocument=this,e.nodeName=n,e},createElementNS:function(n,e){var t=new Kh,i=e.split(":"),s=t.attributes=new Hb;return t.childNodes=new gl,t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.namespaceURI=n,i.length==2?(t.prefix=i[0],t.localName=i[1]):t.localName=e,s._ownerElement=t,t},createAttributeNS:function(n,e){var t=new qb,i=e.split(":");return t.ownerDocument=this,t.nodeName=e,t.name=e,t.namespaceURI=n,t.specified=!0,i.length==2?(t.prefix=i[0],t.localName=i[1]):t.localName=e,t}};ks(my,Xt);function Kh(){this._nsMap={}}Kh.prototype={nodeType:ga,hasAttribute:function(n){return this.getAttributeNode(n)!=null},getAttribute:function(n){var e=this.getAttributeNode(n);return e&&e.value||""},getAttributeNode:function(n){return this.attributes.getNamedItem(n)},setAttribute:function(n,e){var t=this.ownerDocument.createAttribute(n);t.value=t.nodeValue=""+e,this.setAttributeNode(t)},removeAttribute:function(n){var e=this.getAttributeNode(n);e&&this.removeAttributeNode(e)},appendChild:function(n){return n.nodeType===Cl?this.insertBefore(n,null):E$(this,n)},setAttributeNode:function(n){return this.attributes.setNamedItem(n)},setAttributeNodeNS:function(n){return this.attributes.setNamedItemNS(n)},removeAttributeNode:function(n){return this.attributes.removeNamedItem(n.nodeName)},removeAttributeNS:function(n,e){var t=this.getAttributeNodeNS(n,e);t&&this.removeAttributeNode(t)},hasAttributeNS:function(n,e){return this.getAttributeNodeNS(n,e)!=null},getAttributeNS:function(n,e){var t=this.getAttributeNodeNS(n,e);return t&&t.value||""},setAttributeNS:function(n,e,t){var i=this.ownerDocument.createAttributeNS(n,e);i.value=i.nodeValue=""+t,this.setAttributeNode(i)},getAttributeNodeNS:function(n,e){return this.attributes.getNamedItemNS(n,e)},getElementsByTagName:function(n){return new sg(this,function(e){var t=[];return Km(e,function(i){i!==e&&i.nodeType==ga&&(n==="*"||i.tagName==n)&&t.push(i)}),t})},getElementsByTagNameNS:function(n,e){return new sg(this,function(t){var i=[];return Km(t,function(s){s!==t&&s.nodeType===ga&&(n==="*"||s.namespaceURI===n)&&(e==="*"||s.localName==e)&&i.push(s)}),i})}};my.prototype.getElementsByTagName=Kh.prototype.getElementsByTagName;my.prototype.getElementsByTagNameNS=Kh.prototype.getElementsByTagNameNS;ks(Kh,Xt);function qb(){}qb.prototype.nodeType=ig;ks(qb,Xt);function xy(){}xy.prototype={data:"",substringData:function(n,e){return this.data.substring(n,n+e)},appendData:function(n){n=this.data+n,this.nodeValue=this.data=n,this.length=n.length},insertData:function(n,e){this.replaceData(n,0,e)},appendChild:function(n){throw new Error(wi[As])},deleteData:function(n,e){this.replaceData(n,e,"")},replaceData:function(n,e,t){var i=this.data.substring(0,n),s=this.data.substring(n+e);t=i+t+s,this.nodeValue=this.data=t,this.length=t.length}};ks(xy,Xt);function rN(){}rN.prototype={nodeName:"#text",nodeType:Ub,splitText:function(n){var e=this.data,t=e.substring(n);e=e.substring(0,n),this.data=this.nodeValue=e,this.length=e.length;var i=this.ownerDocument.createTextNode(t);return this.parentNode&&this.parentNode.insertBefore(i,this.nextSibling),i}};ks(rN,xy);function aN(){}aN.prototype={nodeName:"#comment",nodeType:JR};ks(aN,xy);function oN(){}oN.prototype={nodeName:"#cdata-section",nodeType:KR};ks(oN,xy);function lw(){}lw.prototype.nodeType=t4;ks(lw,Xt);function c4(){}c4.prototype.nodeType=y$;ks(c4,Xt);function u4(){}u4.prototype.nodeType=x$;ks(u4,Xt);function lN(){}lN.prototype.nodeType=ZR;ks(lN,Xt);function cw(){}cw.prototype.nodeName="#document-fragment";cw.prototype.nodeType=Cl;ks(cw,Xt);function cN(){}cN.prototype.nodeType=QR;ks(cN,Xt);function h4(){}h4.prototype.serializeToString=function(n,e,t){return d4.call(n,e,t)};Xt.prototype.toString=d4;function d4(n,e){var t=[],i=this.nodeType==9&&this.documentElement||this,s=i.prefix,r=i.namespaceURI;if(r&&s==null){var s=i.lookupPrefix(r);if(s==null)var a=[{namespace:r,prefix:null}]}return ef(this,t,n,e,a),t.join("")}function NT(n,e,t){var i=n.prefix||"",s=n.namespaceURI;if(!s||i==="xml"&&s===Xm.XML||s===Xm.XMLNS)return!1;for(var r=t.length;r--;){var a=t[r];if(a.prefix===i)return a.namespace!==s}return!0}function j2(n,e,t){n.push(" ",e,'="',t.replace(/[<&"]/g,r4),'"')}function ef(n,e,t,i,s){if(s||(s=[]),i)if(n=i(n),n){if(typeof n=="string"){e.push(n);return}}else return;switch(n.nodeType){case ga:var r=n.attributes,a=r.length,m=n.firstChild,o=n.tagName;t=Xm.isHTML(n.namespaceURI)||t;var c=o;if(!t&&!n.prefix&&n.namespaceURI){for(var h,d=0;d<r.length;d++)if(r.item(d).name==="xmlns"){h=r.item(d).value;break}if(!h)for(var f=s.length-1;f>=0;f--){var p=s[f];if(p.prefix===""&&p.namespace===n.namespaceURI){h=p.namespace;break}}if(h!==n.namespaceURI)for(var f=s.length-1;f>=0;f--){var p=s[f];if(p.namespace===n.namespaceURI){p.prefix&&(c=p.prefix+":"+o);break}}}e.push("<",c);for(var g=0;g<a;g++){var v=r.item(g);v.prefix=="xmlns"?s.push({prefix:v.localName,namespace:v.value}):v.nodeName=="xmlns"&&s.push({prefix:"",namespace:v.value})}for(var g=0;g<a;g++){var v=r.item(g);if(NT(v,t,s)){var b=v.prefix||"",x=v.namespaceURI;j2(e,b?"xmlns:"+b:"xmlns",x),s.push({prefix:b,namespace:x})}ef(v,e,t,i,s)}if(o===c&&NT(n,t,s)){var b=n.prefix||"",x=n.namespaceURI;j2(e,b?"xmlns:"+b:"xmlns",x),s.push({prefix:b,namespace:x})}if(m||t&&!/^(?:meta|link|img|br|hr|input)$/i.test(o)){if(e.push(">"),t&&/^script$/i.test(o))for(;m;)m.data?e.push(m.data):ef(m,e,t,i,s.slice()),m=m.nextSibling;else for(;m;)ef(m,e,t,i,s.slice()),m=m.nextSibling;e.push("</",c,">")}else e.push("/>");return;case e4:case Cl:for(var m=n.firstChild;m;)ef(m,e,t,i,s.slice()),m=m.nextSibling;return;case ig:return j2(e,n.name,n.value);case Ub:return e.push(n.data.replace(/[<&]/g,r4).replace(/]]>/g,"]]&gt;"));case KR:return e.push("<![CDATA[",n.data,"]]>");case JR:return e.push("<!--",n.data,"-->");case t4:var y=n.publicId,w=n.systemId;if(e.push("<!DOCTYPE ",n.name),y)e.push(" PUBLIC ",y),w&&w!="."&&e.push(" ",w),e.push(">");else if(w&&w!=".")e.push(" SYSTEM ",w,">");else{var E=n.internalSubset;E&&e.push(" [",E,"]"),e.push(">")}return;case QR:return e.push("<?",n.target," ",n.data,"?>");case ZR:return e.push("&",n.nodeName,";");default:e.push("??",n.nodeName)}}function f4(n,e,t){var i;switch(e.nodeType){case ga:i=e.cloneNode(!1),i.ownerDocument=n;case Cl:break;case ig:t=!0;break}if(i||(i=e.cloneNode(!1)),i.ownerDocument=n,i.parentNode=null,t)for(var s=e.firstChild;s;)i.appendChild(f4(n,s,t)),s=s.nextSibling;return i}function iA(n,e,t){var i=new e.constructor;for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){var r=e[s];typeof r!="object"&&r!=i[s]&&(i[s]=r)}switch(e.childNodes&&(i.childNodes=new gl),i.ownerDocument=n,i.nodeType){case ga:var a=e.attributes,o=i.attributes=new Hb,c=a.length;o._ownerElement=i;for(var h=0;h<c;h++)i.setAttributeNode(iA(n,a.item(h),!0));break;case ig:t=!0}if(t)for(var d=e.firstChild;d;)i.appendChild(iA(n,d,t)),d=d.nextSibling;return i}function p4(n,e,t){n[e]=t}try{if(Object.defineProperty){let n=function(e){switch(e.nodeType){case ga:case Cl:var t=[];for(e=e.firstChild;e;)e.nodeType!==7&&e.nodeType!==8&&t.push(n(e)),e=e.nextSibling;return t.join("");default:return e.nodeValue}};Object.defineProperty(sg.prototype,"length",{get:function(){return nN(this),this.$$length}}),Object.defineProperty(Xt.prototype,"textContent",{get:function(){return n(this)},set:function(e){switch(this.nodeType){case ga:case Cl:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),p4=function(e,t,i){e["$$"+t]=i}}}catch{}du.DocumentType=lw;du.DOMException=Hn;du.DOMImplementation=s4;du.Element=Kh;du.Node=Xt;du.NodeList=gl;du.XMLSerializer=h4;var yy={},g4={};(function(n){var e=fu.freeze;n.XML_ENTITIES=e({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),n.HTML_ENTITIES=e({Aacute:"Ã",aacute:"Ã¡",Abreve:"Ä‚",abreve:"Äƒ",ac:"âˆ¾",acd:"âˆ¿",acE:"âˆ¾Ì³",Acirc:"Ã‚",acirc:"Ã¢",acute:"Â´",Acy:"Ð",acy:"Ð°",AElig:"Ã†",aelig:"Ã¦",af:"â¡",Afr:"ð”„",afr:"ð”ž",Agrave:"Ã€",agrave:"Ã ",alefsym:"â„µ",aleph:"â„µ",Alpha:"Î‘",alpha:"Î±",Amacr:"Ä€",amacr:"Ä",amalg:"â¨¿",AMP:"&",amp:"&",And:"â©“",and:"âˆ§",andand:"â©•",andd:"â©œ",andslope:"â©˜",andv:"â©š",ang:"âˆ ",ange:"â¦¤",angle:"âˆ ",angmsd:"âˆ¡",angmsdaa:"â¦¨",angmsdab:"â¦©",angmsdac:"â¦ª",angmsdad:"â¦«",angmsdae:"â¦¬",angmsdaf:"â¦­",angmsdag:"â¦®",angmsdah:"â¦¯",angrt:"âˆŸ",angrtvb:"âŠ¾",angrtvbd:"â¦",angsph:"âˆ¢",angst:"Ã…",angzarr:"â¼",Aogon:"Ä„",aogon:"Ä…",Aopf:"ð”¸",aopf:"ð•’",ap:"â‰ˆ",apacir:"â©¯",apE:"â©°",ape:"â‰Š",apid:"â‰‹",apos:"'",ApplyFunction:"â¡",approx:"â‰ˆ",approxeq:"â‰Š",Aring:"Ã…",aring:"Ã¥",Ascr:"ð’œ",ascr:"ð’¶",Assign:"â‰”",ast:"*",asymp:"â‰ˆ",asympeq:"â‰",Atilde:"Ãƒ",atilde:"Ã£",Auml:"Ã„",auml:"Ã¤",awconint:"âˆ³",awint:"â¨‘",backcong:"â‰Œ",backepsilon:"Ï¶",backprime:"â€µ",backsim:"âˆ½",backsimeq:"â‹",Backslash:"âˆ–",Barv:"â«§",barvee:"âŠ½",Barwed:"âŒ†",barwed:"âŒ…",barwedge:"âŒ…",bbrk:"âŽµ",bbrktbrk:"âŽ¶",bcong:"â‰Œ",Bcy:"Ð‘",bcy:"Ð±",bdquo:"â€ž",becaus:"âˆµ",Because:"âˆµ",because:"âˆµ",bemptyv:"â¦°",bepsi:"Ï¶",bernou:"â„¬",Bernoullis:"â„¬",Beta:"Î’",beta:"Î²",beth:"â„¶",between:"â‰¬",Bfr:"ð”…",bfr:"ð”Ÿ",bigcap:"â‹‚",bigcirc:"â—¯",bigcup:"â‹ƒ",bigodot:"â¨€",bigoplus:"â¨",bigotimes:"â¨‚",bigsqcup:"â¨†",bigstar:"â˜…",bigtriangledown:"â–½",bigtriangleup:"â–³",biguplus:"â¨„",bigvee:"â‹",bigwedge:"â‹€",bkarow:"â¤",blacklozenge:"â§«",blacksquare:"â–ª",blacktriangle:"â–´",blacktriangledown:"â–¾",blacktriangleleft:"â—‚",blacktriangleright:"â–¸",blank:"â£",blk12:"â–’",blk14:"â–‘",blk34:"â–“",block:"â–ˆ",bne:"=âƒ¥",bnequiv:"â‰¡âƒ¥",bNot:"â«­",bnot:"âŒ",Bopf:"ð”¹",bopf:"ð•“",bot:"âŠ¥",bottom:"âŠ¥",bowtie:"â‹ˆ",boxbox:"â§‰",boxDL:"â•—",boxDl:"â•–",boxdL:"â••",boxdl:"â”",boxDR:"â•”",boxDr:"â•“",boxdR:"â•’",boxdr:"â”Œ",boxH:"â•",boxh:"â”€",boxHD:"â•¦",boxHd:"â•¤",boxhD:"â•¥",boxhd:"â”¬",boxHU:"â•©",boxHu:"â•§",boxhU:"â•¨",boxhu:"â”´",boxminus:"âŠŸ",boxplus:"âŠž",boxtimes:"âŠ ",boxUL:"â•",boxUl:"â•œ",boxuL:"â•›",boxul:"â”˜",boxUR:"â•š",boxUr:"â•™",boxuR:"â•˜",boxur:"â””",boxV:"â•‘",boxv:"â”‚",boxVH:"â•¬",boxVh:"â•«",boxvH:"â•ª",boxvh:"â”¼",boxVL:"â•£",boxVl:"â•¢",boxvL:"â•¡",boxvl:"â”¤",boxVR:"â• ",boxVr:"â•Ÿ",boxvR:"â•ž",boxvr:"â”œ",bprime:"â€µ",Breve:"Ë˜",breve:"Ë˜",brvbar:"Â¦",Bscr:"â„¬",bscr:"ð’·",bsemi:"â",bsim:"âˆ½",bsime:"â‹",bsol:"\\",bsolb:"â§…",bsolhsub:"âŸˆ",bull:"â€¢",bullet:"â€¢",bump:"â‰Ž",bumpE:"âª®",bumpe:"â‰",Bumpeq:"â‰Ž",bumpeq:"â‰",Cacute:"Ä†",cacute:"Ä‡",Cap:"â‹’",cap:"âˆ©",capand:"â©„",capbrcup:"â©‰",capcap:"â©‹",capcup:"â©‡",capdot:"â©€",CapitalDifferentialD:"â……",caps:"âˆ©ï¸€",caret:"â",caron:"Ë‡",Cayleys:"â„­",ccaps:"â©",Ccaron:"ÄŒ",ccaron:"Ä",Ccedil:"Ã‡",ccedil:"Ã§",Ccirc:"Äˆ",ccirc:"Ä‰",Cconint:"âˆ°",ccups:"â©Œ",ccupssm:"â©",Cdot:"ÄŠ",cdot:"Ä‹",cedil:"Â¸",Cedilla:"Â¸",cemptyv:"â¦²",cent:"Â¢",CenterDot:"Â·",centerdot:"Â·",Cfr:"â„­",cfr:"ð” ",CHcy:"Ð§",chcy:"Ñ‡",check:"âœ“",checkmark:"âœ“",Chi:"Î§",chi:"Ï‡",cir:"â—‹",circ:"Ë†",circeq:"â‰—",circlearrowleft:"â†º",circlearrowright:"â†»",circledast:"âŠ›",circledcirc:"âŠš",circleddash:"âŠ",CircleDot:"âŠ™",circledR:"Â®",circledS:"â“ˆ",CircleMinus:"âŠ–",CirclePlus:"âŠ•",CircleTimes:"âŠ—",cirE:"â§ƒ",cire:"â‰—",cirfnint:"â¨",cirmid:"â«¯",cirscir:"â§‚",ClockwiseContourIntegral:"âˆ²",CloseCurlyDoubleQuote:"â€",CloseCurlyQuote:"â€™",clubs:"â™£",clubsuit:"â™£",Colon:"âˆ·",colon:":",Colone:"â©´",colone:"â‰”",coloneq:"â‰”",comma:",",commat:"@",comp:"âˆ",compfn:"âˆ˜",complement:"âˆ",complexes:"â„‚",cong:"â‰…",congdot:"â©­",Congruent:"â‰¡",Conint:"âˆ¯",conint:"âˆ®",ContourIntegral:"âˆ®",Copf:"â„‚",copf:"ð•”",coprod:"âˆ",Coproduct:"âˆ",COPY:"Â©",copy:"Â©",copysr:"â„—",CounterClockwiseContourIntegral:"âˆ³",crarr:"â†µ",Cross:"â¨¯",cross:"âœ—",Cscr:"ð’ž",cscr:"ð’¸",csub:"â«",csube:"â«‘",csup:"â«",csupe:"â«’",ctdot:"â‹¯",cudarrl:"â¤¸",cudarrr:"â¤µ",cuepr:"â‹ž",cuesc:"â‹Ÿ",cularr:"â†¶",cularrp:"â¤½",Cup:"â‹“",cup:"âˆª",cupbrcap:"â©ˆ",CupCap:"â‰",cupcap:"â©†",cupcup:"â©Š",cupdot:"âŠ",cupor:"â©…",cups:"âˆªï¸€",curarr:"â†·",curarrm:"â¤¼",curlyeqprec:"â‹ž",curlyeqsucc:"â‹Ÿ",curlyvee:"â‹Ž",curlywedge:"â‹",curren:"Â¤",curvearrowleft:"â†¶",curvearrowright:"â†·",cuvee:"â‹Ž",cuwed:"â‹",cwconint:"âˆ²",cwint:"âˆ±",cylcty:"âŒ­",Dagger:"â€¡",dagger:"â€ ",daleth:"â„¸",Darr:"â†¡",dArr:"â‡“",darr:"â†“",dash:"â€",Dashv:"â«¤",dashv:"âŠ£",dbkarow:"â¤",dblac:"Ë",Dcaron:"ÄŽ",dcaron:"Ä",Dcy:"Ð”",dcy:"Ð´",DD:"â……",dd:"â…†",ddagger:"â€¡",ddarr:"â‡Š",DDotrahd:"â¤‘",ddotseq:"â©·",deg:"Â°",Del:"âˆ‡",Delta:"Î”",delta:"Î´",demptyv:"â¦±",dfisht:"â¥¿",Dfr:"ð”‡",dfr:"ð”¡",dHar:"â¥¥",dharl:"â‡ƒ",dharr:"â‡‚",DiacriticalAcute:"Â´",DiacriticalDot:"Ë™",DiacriticalDoubleAcute:"Ë",DiacriticalGrave:"`",DiacriticalTilde:"Ëœ",diam:"â‹„",Diamond:"â‹„",diamond:"â‹„",diamondsuit:"â™¦",diams:"â™¦",die:"Â¨",DifferentialD:"â…†",digamma:"Ï",disin:"â‹²",div:"Ã·",divide:"Ã·",divideontimes:"â‹‡",divonx:"â‹‡",DJcy:"Ð‚",djcy:"Ñ’",dlcorn:"âŒž",dlcrop:"âŒ",dollar:"$",Dopf:"ð”»",dopf:"ð••",Dot:"Â¨",dot:"Ë™",DotDot:"âƒœ",doteq:"â‰",doteqdot:"â‰‘",DotEqual:"â‰",dotminus:"âˆ¸",dotplus:"âˆ”",dotsquare:"âŠ¡",doublebarwedge:"âŒ†",DoubleContourIntegral:"âˆ¯",DoubleDot:"Â¨",DoubleDownArrow:"â‡“",DoubleLeftArrow:"â‡",DoubleLeftRightArrow:"â‡”",DoubleLeftTee:"â«¤",DoubleLongLeftArrow:"âŸ¸",DoubleLongLeftRightArrow:"âŸº",DoubleLongRightArrow:"âŸ¹",DoubleRightArrow:"â‡’",DoubleRightTee:"âŠ¨",DoubleUpArrow:"â‡‘",DoubleUpDownArrow:"â‡•",DoubleVerticalBar:"âˆ¥",DownArrow:"â†“",Downarrow:"â‡“",downarrow:"â†“",DownArrowBar:"â¤“",DownArrowUpArrow:"â‡µ",DownBreve:"Ì‘",downdownarrows:"â‡Š",downharpoonleft:"â‡ƒ",downharpoonright:"â‡‚",DownLeftRightVector:"â¥",DownLeftTeeVector:"â¥ž",DownLeftVector:"â†½",DownLeftVectorBar:"â¥–",DownRightTeeVector:"â¥Ÿ",DownRightVector:"â‡",DownRightVectorBar:"â¥—",DownTee:"âŠ¤",DownTeeArrow:"â†§",drbkarow:"â¤",drcorn:"âŒŸ",drcrop:"âŒŒ",Dscr:"ð’Ÿ",dscr:"ð’¹",DScy:"Ð…",dscy:"Ñ•",dsol:"â§¶",Dstrok:"Ä",dstrok:"Ä‘",dtdot:"â‹±",dtri:"â–¿",dtrif:"â–¾",duarr:"â‡µ",duhar:"â¥¯",dwangle:"â¦¦",DZcy:"Ð",dzcy:"ÑŸ",dzigrarr:"âŸ¿",Eacute:"Ã‰",eacute:"Ã©",easter:"â©®",Ecaron:"Äš",ecaron:"Ä›",ecir:"â‰–",Ecirc:"ÃŠ",ecirc:"Ãª",ecolon:"â‰•",Ecy:"Ð­",ecy:"Ñ",eDDot:"â©·",Edot:"Ä–",eDot:"â‰‘",edot:"Ä—",ee:"â…‡",efDot:"â‰’",Efr:"ð”ˆ",efr:"ð”¢",eg:"âªš",Egrave:"Ãˆ",egrave:"Ã¨",egs:"âª–",egsdot:"âª˜",el:"âª™",Element:"âˆˆ",elinters:"â§",ell:"â„“",els:"âª•",elsdot:"âª—",Emacr:"Ä’",emacr:"Ä“",empty:"âˆ…",emptyset:"âˆ…",EmptySmallSquare:"â—»",emptyv:"âˆ…",EmptyVerySmallSquare:"â–«",emsp:"â€ƒ",emsp13:"â€„",emsp14:"â€…",ENG:"ÅŠ",eng:"Å‹",ensp:"â€‚",Eogon:"Ä˜",eogon:"Ä™",Eopf:"ð”¼",eopf:"ð•–",epar:"â‹•",eparsl:"â§£",eplus:"â©±",epsi:"Îµ",Epsilon:"Î•",epsilon:"Îµ",epsiv:"Ïµ",eqcirc:"â‰–",eqcolon:"â‰•",eqsim:"â‰‚",eqslantgtr:"âª–",eqslantless:"âª•",Equal:"â©µ",equals:"=",EqualTilde:"â‰‚",equest:"â‰Ÿ",Equilibrium:"â‡Œ",equiv:"â‰¡",equivDD:"â©¸",eqvparsl:"â§¥",erarr:"â¥±",erDot:"â‰“",Escr:"â„°",escr:"â„¯",esdot:"â‰",Esim:"â©³",esim:"â‰‚",Eta:"Î—",eta:"Î·",ETH:"Ã",eth:"Ã°",Euml:"Ã‹",euml:"Ã«",euro:"â‚¬",excl:"!",exist:"âˆƒ",Exists:"âˆƒ",expectation:"â„°",ExponentialE:"â…‡",exponentiale:"â…‡",fallingdotseq:"â‰’",Fcy:"Ð¤",fcy:"Ñ„",female:"â™€",ffilig:"ï¬ƒ",fflig:"ï¬€",ffllig:"ï¬„",Ffr:"ð”‰",ffr:"ð”£",filig:"ï¬",FilledSmallSquare:"â—¼",FilledVerySmallSquare:"â–ª",fjlig:"fj",flat:"â™­",fllig:"ï¬‚",fltns:"â–±",fnof:"Æ’",Fopf:"ð”½",fopf:"ð•—",ForAll:"âˆ€",forall:"âˆ€",fork:"â‹”",forkv:"â«™",Fouriertrf:"â„±",fpartint:"â¨",frac12:"Â½",frac13:"â…“",frac14:"Â¼",frac15:"â…•",frac16:"â…™",frac18:"â…›",frac23:"â…”",frac25:"â…–",frac34:"Â¾",frac35:"â…—",frac38:"â…œ",frac45:"â…˜",frac56:"â…š",frac58:"â…",frac78:"â…ž",frasl:"â„",frown:"âŒ¢",Fscr:"â„±",fscr:"ð’»",gacute:"Çµ",Gamma:"Î“",gamma:"Î³",Gammad:"Ïœ",gammad:"Ï",gap:"âª†",Gbreve:"Äž",gbreve:"ÄŸ",Gcedil:"Ä¢",Gcirc:"Äœ",gcirc:"Ä",Gcy:"Ð“",gcy:"Ð³",Gdot:"Ä ",gdot:"Ä¡",gE:"â‰§",ge:"â‰¥",gEl:"âªŒ",gel:"â‹›",geq:"â‰¥",geqq:"â‰§",geqslant:"â©¾",ges:"â©¾",gescc:"âª©",gesdot:"âª€",gesdoto:"âª‚",gesdotol:"âª„",gesl:"â‹›ï¸€",gesles:"âª”",Gfr:"ð”Š",gfr:"ð”¤",Gg:"â‹™",gg:"â‰«",ggg:"â‹™",gimel:"â„·",GJcy:"Ðƒ",gjcy:"Ñ“",gl:"â‰·",gla:"âª¥",glE:"âª’",glj:"âª¤",gnap:"âªŠ",gnapprox:"âªŠ",gnE:"â‰©",gne:"âªˆ",gneq:"âªˆ",gneqq:"â‰©",gnsim:"â‹§",Gopf:"ð”¾",gopf:"ð•˜",grave:"`",GreaterEqual:"â‰¥",GreaterEqualLess:"â‹›",GreaterFullEqual:"â‰§",GreaterGreater:"âª¢",GreaterLess:"â‰·",GreaterSlantEqual:"â©¾",GreaterTilde:"â‰³",Gscr:"ð’¢",gscr:"â„Š",gsim:"â‰³",gsime:"âªŽ",gsiml:"âª",Gt:"â‰«",GT:">",gt:">",gtcc:"âª§",gtcir:"â©º",gtdot:"â‹—",gtlPar:"â¦•",gtquest:"â©¼",gtrapprox:"âª†",gtrarr:"â¥¸",gtrdot:"â‹—",gtreqless:"â‹›",gtreqqless:"âªŒ",gtrless:"â‰·",gtrsim:"â‰³",gvertneqq:"â‰©ï¸€",gvnE:"â‰©ï¸€",Hacek:"Ë‡",hairsp:"â€Š",half:"Â½",hamilt:"â„‹",HARDcy:"Ðª",hardcy:"ÑŠ",hArr:"â‡”",harr:"â†”",harrcir:"â¥ˆ",harrw:"â†­",Hat:"^",hbar:"â„",Hcirc:"Ä¤",hcirc:"Ä¥",hearts:"â™¥",heartsuit:"â™¥",hellip:"â€¦",hercon:"âŠ¹",Hfr:"â„Œ",hfr:"ð”¥",HilbertSpace:"â„‹",hksearow:"â¤¥",hkswarow:"â¤¦",hoarr:"â‡¿",homtht:"âˆ»",hookleftarrow:"â†©",hookrightarrow:"â†ª",Hopf:"â„",hopf:"ð•™",horbar:"â€•",HorizontalLine:"â”€",Hscr:"â„‹",hscr:"ð’½",hslash:"â„",Hstrok:"Ä¦",hstrok:"Ä§",HumpDownHump:"â‰Ž",HumpEqual:"â‰",hybull:"âƒ",hyphen:"â€",Iacute:"Ã",iacute:"Ã­",ic:"â£",Icirc:"ÃŽ",icirc:"Ã®",Icy:"Ð˜",icy:"Ð¸",Idot:"Ä°",IEcy:"Ð•",iecy:"Ðµ",iexcl:"Â¡",iff:"â‡”",Ifr:"â„‘",ifr:"ð”¦",Igrave:"ÃŒ",igrave:"Ã¬",ii:"â…ˆ",iiiint:"â¨Œ",iiint:"âˆ­",iinfin:"â§œ",iiota:"â„©",IJlig:"Ä²",ijlig:"Ä³",Im:"â„‘",Imacr:"Äª",imacr:"Ä«",image:"â„‘",ImaginaryI:"â…ˆ",imagline:"â„",imagpart:"â„‘",imath:"Ä±",imof:"âŠ·",imped:"Æµ",Implies:"â‡’",in:"âˆˆ",incare:"â„…",infin:"âˆž",infintie:"â§",inodot:"Ä±",Int:"âˆ¬",int:"âˆ«",intcal:"âŠº",integers:"â„¤",Integral:"âˆ«",intercal:"âŠº",Intersection:"â‹‚",intlarhk:"â¨—",intprod:"â¨¼",InvisibleComma:"â£",InvisibleTimes:"â¢",IOcy:"Ð",iocy:"Ñ‘",Iogon:"Ä®",iogon:"Ä¯",Iopf:"ð•€",iopf:"ð•š",Iota:"Î™",iota:"Î¹",iprod:"â¨¼",iquest:"Â¿",Iscr:"â„",iscr:"ð’¾",isin:"âˆˆ",isindot:"â‹µ",isinE:"â‹¹",isins:"â‹´",isinsv:"â‹³",isinv:"âˆˆ",it:"â¢",Itilde:"Ä¨",itilde:"Ä©",Iukcy:"Ð†",iukcy:"Ñ–",Iuml:"Ã",iuml:"Ã¯",Jcirc:"Ä´",jcirc:"Äµ",Jcy:"Ð™",jcy:"Ð¹",Jfr:"ð”",jfr:"ð”§",jmath:"È·",Jopf:"ð•",jopf:"ð•›",Jscr:"ð’¥",jscr:"ð’¿",Jsercy:"Ðˆ",jsercy:"Ñ˜",Jukcy:"Ð„",jukcy:"Ñ”",Kappa:"Îš",kappa:"Îº",kappav:"Ï°",Kcedil:"Ä¶",kcedil:"Ä·",Kcy:"Ðš",kcy:"Ðº",Kfr:"ð”Ž",kfr:"ð”¨",kgreen:"Ä¸",KHcy:"Ð¥",khcy:"Ñ…",KJcy:"ÐŒ",kjcy:"Ñœ",Kopf:"ð•‚",kopf:"ð•œ",Kscr:"ð’¦",kscr:"ð“€",lAarr:"â‡š",Lacute:"Ä¹",lacute:"Äº",laemptyv:"â¦´",lagran:"â„’",Lambda:"Î›",lambda:"Î»",Lang:"âŸª",lang:"âŸ¨",langd:"â¦‘",langle:"âŸ¨",lap:"âª…",Laplacetrf:"â„’",laquo:"Â«",Larr:"â†ž",lArr:"â‡",larr:"â†",larrb:"â‡¤",larrbfs:"â¤Ÿ",larrfs:"â¤",larrhk:"â†©",larrlp:"â†«",larrpl:"â¤¹",larrsim:"â¥³",larrtl:"â†¢",lat:"âª«",lAtail:"â¤›",latail:"â¤™",late:"âª­",lates:"âª­ï¸€",lBarr:"â¤Ž",lbarr:"â¤Œ",lbbrk:"â²",lbrace:"{",lbrack:"[",lbrke:"â¦‹",lbrksld:"â¦",lbrkslu:"â¦",Lcaron:"Ä½",lcaron:"Ä¾",Lcedil:"Ä»",lcedil:"Ä¼",lceil:"âŒˆ",lcub:"{",Lcy:"Ð›",lcy:"Ð»",ldca:"â¤¶",ldquo:"â€œ",ldquor:"â€ž",ldrdhar:"â¥§",ldrushar:"â¥‹",ldsh:"â†²",lE:"â‰¦",le:"â‰¤",LeftAngleBracket:"âŸ¨",LeftArrow:"â†",Leftarrow:"â‡",leftarrow:"â†",LeftArrowBar:"â‡¤",LeftArrowRightArrow:"â‡†",leftarrowtail:"â†¢",LeftCeiling:"âŒˆ",LeftDoubleBracket:"âŸ¦",LeftDownTeeVector:"â¥¡",LeftDownVector:"â‡ƒ",LeftDownVectorBar:"â¥™",LeftFloor:"âŒŠ",leftharpoondown:"â†½",leftharpoonup:"â†¼",leftleftarrows:"â‡‡",LeftRightArrow:"â†”",Leftrightarrow:"â‡”",leftrightarrow:"â†”",leftrightarrows:"â‡†",leftrightharpoons:"â‡‹",leftrightsquigarrow:"â†­",LeftRightVector:"â¥Ž",LeftTee:"âŠ£",LeftTeeArrow:"â†¤",LeftTeeVector:"â¥š",leftthreetimes:"â‹‹",LeftTriangle:"âŠ²",LeftTriangleBar:"â§",LeftTriangleEqual:"âŠ´",LeftUpDownVector:"â¥‘",LeftUpTeeVector:"â¥ ",LeftUpVector:"â†¿",LeftUpVectorBar:"â¥˜",LeftVector:"â†¼",LeftVectorBar:"â¥’",lEg:"âª‹",leg:"â‹š",leq:"â‰¤",leqq:"â‰¦",leqslant:"â©½",les:"â©½",lescc:"âª¨",lesdot:"â©¿",lesdoto:"âª",lesdotor:"âªƒ",lesg:"â‹šï¸€",lesges:"âª“",lessapprox:"âª…",lessdot:"â‹–",lesseqgtr:"â‹š",lesseqqgtr:"âª‹",LessEqualGreater:"â‹š",LessFullEqual:"â‰¦",LessGreater:"â‰¶",lessgtr:"â‰¶",LessLess:"âª¡",lesssim:"â‰²",LessSlantEqual:"â©½",LessTilde:"â‰²",lfisht:"â¥¼",lfloor:"âŒŠ",Lfr:"ð”",lfr:"ð”©",lg:"â‰¶",lgE:"âª‘",lHar:"â¥¢",lhard:"â†½",lharu:"â†¼",lharul:"â¥ª",lhblk:"â–„",LJcy:"Ð‰",ljcy:"Ñ™",Ll:"â‹˜",ll:"â‰ª",llarr:"â‡‡",llcorner:"âŒž",Lleftarrow:"â‡š",llhard:"â¥«",lltri:"â—º",Lmidot:"Ä¿",lmidot:"Å€",lmoust:"âŽ°",lmoustache:"âŽ°",lnap:"âª‰",lnapprox:"âª‰",lnE:"â‰¨",lne:"âª‡",lneq:"âª‡",lneqq:"â‰¨",lnsim:"â‹¦",loang:"âŸ¬",loarr:"â‡½",lobrk:"âŸ¦",LongLeftArrow:"âŸµ",Longleftarrow:"âŸ¸",longleftarrow:"âŸµ",LongLeftRightArrow:"âŸ·",Longleftrightarrow:"âŸº",longleftrightarrow:"âŸ·",longmapsto:"âŸ¼",LongRightArrow:"âŸ¶",Longrightarrow:"âŸ¹",longrightarrow:"âŸ¶",looparrowleft:"â†«",looparrowright:"â†¬",lopar:"â¦…",Lopf:"ð•ƒ",lopf:"ð•",loplus:"â¨­",lotimes:"â¨´",lowast:"âˆ—",lowbar:"_",LowerLeftArrow:"â†™",LowerRightArrow:"â†˜",loz:"â—Š",lozenge:"â—Š",lozf:"â§«",lpar:"(",lparlt:"â¦“",lrarr:"â‡†",lrcorner:"âŒŸ",lrhar:"â‡‹",lrhard:"â¥­",lrm:"â€Ž",lrtri:"âŠ¿",lsaquo:"â€¹",Lscr:"â„’",lscr:"ð“",Lsh:"â†°",lsh:"â†°",lsim:"â‰²",lsime:"âª",lsimg:"âª",lsqb:"[",lsquo:"â€˜",lsquor:"â€š",Lstrok:"Å",lstrok:"Å‚",Lt:"â‰ª",LT:"<",lt:"<",ltcc:"âª¦",ltcir:"â©¹",ltdot:"â‹–",lthree:"â‹‹",ltimes:"â‹‰",ltlarr:"â¥¶",ltquest:"â©»",ltri:"â—ƒ",ltrie:"âŠ´",ltrif:"â—‚",ltrPar:"â¦–",lurdshar:"â¥Š",luruhar:"â¥¦",lvertneqq:"â‰¨ï¸€",lvnE:"â‰¨ï¸€",macr:"Â¯",male:"â™‚",malt:"âœ ",maltese:"âœ ",Map:"â¤…",map:"â†¦",mapsto:"â†¦",mapstodown:"â†§",mapstoleft:"â†¤",mapstoup:"â†¥",marker:"â–®",mcomma:"â¨©",Mcy:"Ðœ",mcy:"Ð¼",mdash:"â€”",mDDot:"âˆº",measuredangle:"âˆ¡",MediumSpace:"âŸ",Mellintrf:"â„³",Mfr:"ð”",mfr:"ð”ª",mho:"â„§",micro:"Âµ",mid:"âˆ£",midast:"*",midcir:"â«°",middot:"Â·",minus:"âˆ’",minusb:"âŠŸ",minusd:"âˆ¸",minusdu:"â¨ª",MinusPlus:"âˆ“",mlcp:"â«›",mldr:"â€¦",mnplus:"âˆ“",models:"âŠ§",Mopf:"ð•„",mopf:"ð•ž",mp:"âˆ“",Mscr:"â„³",mscr:"ð“‚",mstpos:"âˆ¾",Mu:"Îœ",mu:"Î¼",multimap:"âŠ¸",mumap:"âŠ¸",nabla:"âˆ‡",Nacute:"Åƒ",nacute:"Å„",nang:"âˆ âƒ’",nap:"â‰‰",napE:"â©°Ì¸",napid:"â‰‹Ì¸",napos:"Å‰",napprox:"â‰‰",natur:"â™®",natural:"â™®",naturals:"â„•",nbsp:"Â ",nbump:"â‰ŽÌ¸",nbumpe:"â‰Ì¸",ncap:"â©ƒ",Ncaron:"Å‡",ncaron:"Åˆ",Ncedil:"Å…",ncedil:"Å†",ncong:"â‰‡",ncongdot:"â©­Ì¸",ncup:"â©‚",Ncy:"Ð",ncy:"Ð½",ndash:"â€“",ne:"â‰ ",nearhk:"â¤¤",neArr:"â‡—",nearr:"â†—",nearrow:"â†—",nedot:"â‰Ì¸",NegativeMediumSpace:"â€‹",NegativeThickSpace:"â€‹",NegativeThinSpace:"â€‹",NegativeVeryThinSpace:"â€‹",nequiv:"â‰¢",nesear:"â¤¨",nesim:"â‰‚Ì¸",NestedGreaterGreater:"â‰«",NestedLessLess:"â‰ª",NewLine:`
`,nexist:"âˆ„",nexists:"âˆ„",Nfr:"ð”‘",nfr:"ð”«",ngE:"â‰§Ì¸",nge:"â‰±",ngeq:"â‰±",ngeqq:"â‰§Ì¸",ngeqslant:"â©¾Ì¸",nges:"â©¾Ì¸",nGg:"â‹™Ì¸",ngsim:"â‰µ",nGt:"â‰«âƒ’",ngt:"â‰¯",ngtr:"â‰¯",nGtv:"â‰«Ì¸",nhArr:"â‡Ž",nharr:"â†®",nhpar:"â«²",ni:"âˆ‹",nis:"â‹¼",nisd:"â‹º",niv:"âˆ‹",NJcy:"ÐŠ",njcy:"Ñš",nlArr:"â‡",nlarr:"â†š",nldr:"â€¥",nlE:"â‰¦Ì¸",nle:"â‰°",nLeftarrow:"â‡",nleftarrow:"â†š",nLeftrightarrow:"â‡Ž",nleftrightarrow:"â†®",nleq:"â‰°",nleqq:"â‰¦Ì¸",nleqslant:"â©½Ì¸",nles:"â©½Ì¸",nless:"â‰®",nLl:"â‹˜Ì¸",nlsim:"â‰´",nLt:"â‰ªâƒ’",nlt:"â‰®",nltri:"â‹ª",nltrie:"â‹¬",nLtv:"â‰ªÌ¸",nmid:"âˆ¤",NoBreak:"â ",NonBreakingSpace:"Â ",Nopf:"â„•",nopf:"ð•Ÿ",Not:"â«¬",not:"Â¬",NotCongruent:"â‰¢",NotCupCap:"â‰­",NotDoubleVerticalBar:"âˆ¦",NotElement:"âˆ‰",NotEqual:"â‰ ",NotEqualTilde:"â‰‚Ì¸",NotExists:"âˆ„",NotGreater:"â‰¯",NotGreaterEqual:"â‰±",NotGreaterFullEqual:"â‰§Ì¸",NotGreaterGreater:"â‰«Ì¸",NotGreaterLess:"â‰¹",NotGreaterSlantEqual:"â©¾Ì¸",NotGreaterTilde:"â‰µ",NotHumpDownHump:"â‰ŽÌ¸",NotHumpEqual:"â‰Ì¸",notin:"âˆ‰",notindot:"â‹µÌ¸",notinE:"â‹¹Ì¸",notinva:"âˆ‰",notinvb:"â‹·",notinvc:"â‹¶",NotLeftTriangle:"â‹ª",NotLeftTriangleBar:"â§Ì¸",NotLeftTriangleEqual:"â‹¬",NotLess:"â‰®",NotLessEqual:"â‰°",NotLessGreater:"â‰¸",NotLessLess:"â‰ªÌ¸",NotLessSlantEqual:"â©½Ì¸",NotLessTilde:"â‰´",NotNestedGreaterGreater:"âª¢Ì¸",NotNestedLessLess:"âª¡Ì¸",notni:"âˆŒ",notniva:"âˆŒ",notnivb:"â‹¾",notnivc:"â‹½",NotPrecedes:"âŠ€",NotPrecedesEqual:"âª¯Ì¸",NotPrecedesSlantEqual:"â‹ ",NotReverseElement:"âˆŒ",NotRightTriangle:"â‹«",NotRightTriangleBar:"â§Ì¸",NotRightTriangleEqual:"â‹­",NotSquareSubset:"âŠÌ¸",NotSquareSubsetEqual:"â‹¢",NotSquareSuperset:"âŠÌ¸",NotSquareSupersetEqual:"â‹£",NotSubset:"âŠ‚âƒ’",NotSubsetEqual:"âŠˆ",NotSucceeds:"âŠ",NotSucceedsEqual:"âª°Ì¸",NotSucceedsSlantEqual:"â‹¡",NotSucceedsTilde:"â‰¿Ì¸",NotSuperset:"âŠƒâƒ’",NotSupersetEqual:"âŠ‰",NotTilde:"â‰",NotTildeEqual:"â‰„",NotTildeFullEqual:"â‰‡",NotTildeTilde:"â‰‰",NotVerticalBar:"âˆ¤",npar:"âˆ¦",nparallel:"âˆ¦",nparsl:"â«½âƒ¥",npart:"âˆ‚Ì¸",npolint:"â¨”",npr:"âŠ€",nprcue:"â‹ ",npre:"âª¯Ì¸",nprec:"âŠ€",npreceq:"âª¯Ì¸",nrArr:"â‡",nrarr:"â†›",nrarrc:"â¤³Ì¸",nrarrw:"â†Ì¸",nRightarrow:"â‡",nrightarrow:"â†›",nrtri:"â‹«",nrtrie:"â‹­",nsc:"âŠ",nsccue:"â‹¡",nsce:"âª°Ì¸",Nscr:"ð’©",nscr:"ð“ƒ",nshortmid:"âˆ¤",nshortparallel:"âˆ¦",nsim:"â‰",nsime:"â‰„",nsimeq:"â‰„",nsmid:"âˆ¤",nspar:"âˆ¦",nsqsube:"â‹¢",nsqsupe:"â‹£",nsub:"âŠ„",nsubE:"â«…Ì¸",nsube:"âŠˆ",nsubset:"âŠ‚âƒ’",nsubseteq:"âŠˆ",nsubseteqq:"â«…Ì¸",nsucc:"âŠ",nsucceq:"âª°Ì¸",nsup:"âŠ…",nsupE:"â«†Ì¸",nsupe:"âŠ‰",nsupset:"âŠƒâƒ’",nsupseteq:"âŠ‰",nsupseteqq:"â«†Ì¸",ntgl:"â‰¹",Ntilde:"Ã‘",ntilde:"Ã±",ntlg:"â‰¸",ntriangleleft:"â‹ª",ntrianglelefteq:"â‹¬",ntriangleright:"â‹«",ntrianglerighteq:"â‹­",Nu:"Î",nu:"Î½",num:"#",numero:"â„–",numsp:"â€‡",nvap:"â‰âƒ’",nVDash:"âŠ¯",nVdash:"âŠ®",nvDash:"âŠ­",nvdash:"âŠ¬",nvge:"â‰¥âƒ’",nvgt:">âƒ’",nvHarr:"â¤„",nvinfin:"â§ž",nvlArr:"â¤‚",nvle:"â‰¤âƒ’",nvlt:"<âƒ’",nvltrie:"âŠ´âƒ’",nvrArr:"â¤ƒ",nvrtrie:"âŠµâƒ’",nvsim:"âˆ¼âƒ’",nwarhk:"â¤£",nwArr:"â‡–",nwarr:"â†–",nwarrow:"â†–",nwnear:"â¤§",Oacute:"Ã“",oacute:"Ã³",oast:"âŠ›",ocir:"âŠš",Ocirc:"Ã”",ocirc:"Ã´",Ocy:"Ðž",ocy:"Ð¾",odash:"âŠ",Odblac:"Å",odblac:"Å‘",odiv:"â¨¸",odot:"âŠ™",odsold:"â¦¼",OElig:"Å’",oelig:"Å“",ofcir:"â¦¿",Ofr:"ð”’",ofr:"ð”¬",ogon:"Ë›",Ograve:"Ã’",ograve:"Ã²",ogt:"â§",ohbar:"â¦µ",ohm:"Î©",oint:"âˆ®",olarr:"â†º",olcir:"â¦¾",olcross:"â¦»",oline:"â€¾",olt:"â§€",Omacr:"ÅŒ",omacr:"Å",Omega:"Î©",omega:"Ï‰",Omicron:"ÎŸ",omicron:"Î¿",omid:"â¦¶",ominus:"âŠ–",Oopf:"ð•†",oopf:"ð• ",opar:"â¦·",OpenCurlyDoubleQuote:"â€œ",OpenCurlyQuote:"â€˜",operp:"â¦¹",oplus:"âŠ•",Or:"â©”",or:"âˆ¨",orarr:"â†»",ord:"â©",order:"â„´",orderof:"â„´",ordf:"Âª",ordm:"Âº",origof:"âŠ¶",oror:"â©–",orslope:"â©—",orv:"â©›",oS:"â“ˆ",Oscr:"ð’ª",oscr:"â„´",Oslash:"Ã˜",oslash:"Ã¸",osol:"âŠ˜",Otilde:"Ã•",otilde:"Ãµ",Otimes:"â¨·",otimes:"âŠ—",otimesas:"â¨¶",Ouml:"Ã–",ouml:"Ã¶",ovbar:"âŒ½",OverBar:"â€¾",OverBrace:"âž",OverBracket:"âŽ´",OverParenthesis:"âœ",par:"âˆ¥",para:"Â¶",parallel:"âˆ¥",parsim:"â«³",parsl:"â«½",part:"âˆ‚",PartialD:"âˆ‚",Pcy:"ÐŸ",pcy:"Ð¿",percnt:"%",period:".",permil:"â€°",perp:"âŠ¥",pertenk:"â€±",Pfr:"ð”“",pfr:"ð”­",Phi:"Î¦",phi:"Ï†",phiv:"Ï•",phmmat:"â„³",phone:"â˜Ž",Pi:"Î ",pi:"Ï€",pitchfork:"â‹”",piv:"Ï–",planck:"â„",planckh:"â„Ž",plankv:"â„",plus:"+",plusacir:"â¨£",plusb:"âŠž",pluscir:"â¨¢",plusdo:"âˆ”",plusdu:"â¨¥",pluse:"â©²",PlusMinus:"Â±",plusmn:"Â±",plussim:"â¨¦",plustwo:"â¨§",pm:"Â±",Poincareplane:"â„Œ",pointint:"â¨•",Popf:"â„™",popf:"ð•¡",pound:"Â£",Pr:"âª»",pr:"â‰º",prap:"âª·",prcue:"â‰¼",prE:"âª³",pre:"âª¯",prec:"â‰º",precapprox:"âª·",preccurlyeq:"â‰¼",Precedes:"â‰º",PrecedesEqual:"âª¯",PrecedesSlantEqual:"â‰¼",PrecedesTilde:"â‰¾",preceq:"âª¯",precnapprox:"âª¹",precneqq:"âªµ",precnsim:"â‹¨",precsim:"â‰¾",Prime:"â€³",prime:"â€²",primes:"â„™",prnap:"âª¹",prnE:"âªµ",prnsim:"â‹¨",prod:"âˆ",Product:"âˆ",profalar:"âŒ®",profline:"âŒ’",profsurf:"âŒ“",prop:"âˆ",Proportion:"âˆ·",Proportional:"âˆ",propto:"âˆ",prsim:"â‰¾",prurel:"âŠ°",Pscr:"ð’«",pscr:"ð“…",Psi:"Î¨",psi:"Ïˆ",puncsp:"â€ˆ",Qfr:"ð””",qfr:"ð”®",qint:"â¨Œ",Qopf:"â„š",qopf:"ð•¢",qprime:"â—",Qscr:"ð’¬",qscr:"ð“†",quaternions:"â„",quatint:"â¨–",quest:"?",questeq:"â‰Ÿ",QUOT:'"',quot:'"',rAarr:"â‡›",race:"âˆ½Ì±",Racute:"Å”",racute:"Å•",radic:"âˆš",raemptyv:"â¦³",Rang:"âŸ«",rang:"âŸ©",rangd:"â¦’",range:"â¦¥",rangle:"âŸ©",raquo:"Â»",Rarr:"â† ",rArr:"â‡’",rarr:"â†’",rarrap:"â¥µ",rarrb:"â‡¥",rarrbfs:"â¤ ",rarrc:"â¤³",rarrfs:"â¤ž",rarrhk:"â†ª",rarrlp:"â†¬",rarrpl:"â¥…",rarrsim:"â¥´",Rarrtl:"â¤–",rarrtl:"â†£",rarrw:"â†",rAtail:"â¤œ",ratail:"â¤š",ratio:"âˆ¶",rationals:"â„š",RBarr:"â¤",rBarr:"â¤",rbarr:"â¤",rbbrk:"â³",rbrace:"}",rbrack:"]",rbrke:"â¦Œ",rbrksld:"â¦Ž",rbrkslu:"â¦",Rcaron:"Å˜",rcaron:"Å™",Rcedil:"Å–",rcedil:"Å—",rceil:"âŒ‰",rcub:"}",Rcy:"Ð ",rcy:"Ñ€",rdca:"â¤·",rdldhar:"â¥©",rdquo:"â€",rdquor:"â€",rdsh:"â†³",Re:"â„œ",real:"â„œ",realine:"â„›",realpart:"â„œ",reals:"â„",rect:"â–­",REG:"Â®",reg:"Â®",ReverseElement:"âˆ‹",ReverseEquilibrium:"â‡‹",ReverseUpEquilibrium:"â¥¯",rfisht:"â¥½",rfloor:"âŒ‹",Rfr:"â„œ",rfr:"ð”¯",rHar:"â¥¤",rhard:"â‡",rharu:"â‡€",rharul:"â¥¬",Rho:"Î¡",rho:"Ï",rhov:"Ï±",RightAngleBracket:"âŸ©",RightArrow:"â†’",Rightarrow:"â‡’",rightarrow:"â†’",RightArrowBar:"â‡¥",RightArrowLeftArrow:"â‡„",rightarrowtail:"â†£",RightCeiling:"âŒ‰",RightDoubleBracket:"âŸ§",RightDownTeeVector:"â¥",RightDownVector:"â‡‚",RightDownVectorBar:"â¥•",RightFloor:"âŒ‹",rightharpoondown:"â‡",rightharpoonup:"â‡€",rightleftarrows:"â‡„",rightleftharpoons:"â‡Œ",rightrightarrows:"â‡‰",rightsquigarrow:"â†",RightTee:"âŠ¢",RightTeeArrow:"â†¦",RightTeeVector:"â¥›",rightthreetimes:"â‹Œ",RightTriangle:"âŠ³",RightTriangleBar:"â§",RightTriangleEqual:"âŠµ",RightUpDownVector:"â¥",RightUpTeeVector:"â¥œ",RightUpVector:"â†¾",RightUpVectorBar:"â¥”",RightVector:"â‡€",RightVectorBar:"â¥“",ring:"Ëš",risingdotseq:"â‰“",rlarr:"â‡„",rlhar:"â‡Œ",rlm:"â€",rmoust:"âŽ±",rmoustache:"âŽ±",rnmid:"â«®",roang:"âŸ­",roarr:"â‡¾",robrk:"âŸ§",ropar:"â¦†",Ropf:"â„",ropf:"ð•£",roplus:"â¨®",rotimes:"â¨µ",RoundImplies:"â¥°",rpar:")",rpargt:"â¦”",rppolint:"â¨’",rrarr:"â‡‰",Rrightarrow:"â‡›",rsaquo:"â€º",Rscr:"â„›",rscr:"ð“‡",Rsh:"â†±",rsh:"â†±",rsqb:"]",rsquo:"â€™",rsquor:"â€™",rthree:"â‹Œ",rtimes:"â‹Š",rtri:"â–¹",rtrie:"âŠµ",rtrif:"â–¸",rtriltri:"â§Ž",RuleDelayed:"â§´",ruluhar:"â¥¨",rx:"â„ž",Sacute:"Åš",sacute:"Å›",sbquo:"â€š",Sc:"âª¼",sc:"â‰»",scap:"âª¸",Scaron:"Å ",scaron:"Å¡",sccue:"â‰½",scE:"âª´",sce:"âª°",Scedil:"Åž",scedil:"ÅŸ",Scirc:"Åœ",scirc:"Å",scnap:"âªº",scnE:"âª¶",scnsim:"â‹©",scpolint:"â¨“",scsim:"â‰¿",Scy:"Ð¡",scy:"Ñ",sdot:"â‹…",sdotb:"âŠ¡",sdote:"â©¦",searhk:"â¤¥",seArr:"â‡˜",searr:"â†˜",searrow:"â†˜",sect:"Â§",semi:";",seswar:"â¤©",setminus:"âˆ–",setmn:"âˆ–",sext:"âœ¶",Sfr:"ð”–",sfr:"ð”°",sfrown:"âŒ¢",sharp:"â™¯",SHCHcy:"Ð©",shchcy:"Ñ‰",SHcy:"Ð¨",shcy:"Ñˆ",ShortDownArrow:"â†“",ShortLeftArrow:"â†",shortmid:"âˆ£",shortparallel:"âˆ¥",ShortRightArrow:"â†’",ShortUpArrow:"â†‘",shy:"Â­",Sigma:"Î£",sigma:"Ïƒ",sigmaf:"Ï‚",sigmav:"Ï‚",sim:"âˆ¼",simdot:"â©ª",sime:"â‰ƒ",simeq:"â‰ƒ",simg:"âªž",simgE:"âª ",siml:"âª",simlE:"âªŸ",simne:"â‰†",simplus:"â¨¤",simrarr:"â¥²",slarr:"â†",SmallCircle:"âˆ˜",smallsetminus:"âˆ–",smashp:"â¨³",smeparsl:"â§¤",smid:"âˆ£",smile:"âŒ£",smt:"âªª",smte:"âª¬",smtes:"âª¬ï¸€",SOFTcy:"Ð¬",softcy:"ÑŒ",sol:"/",solb:"â§„",solbar:"âŒ¿",Sopf:"ð•Š",sopf:"ð•¤",spades:"â™ ",spadesuit:"â™ ",spar:"âˆ¥",sqcap:"âŠ“",sqcaps:"âŠ“ï¸€",sqcup:"âŠ”",sqcups:"âŠ”ï¸€",Sqrt:"âˆš",sqsub:"âŠ",sqsube:"âŠ‘",sqsubset:"âŠ",sqsubseteq:"âŠ‘",sqsup:"âŠ",sqsupe:"âŠ’",sqsupset:"âŠ",sqsupseteq:"âŠ’",squ:"â–¡",Square:"â–¡",square:"â–¡",SquareIntersection:"âŠ“",SquareSubset:"âŠ",SquareSubsetEqual:"âŠ‘",SquareSuperset:"âŠ",SquareSupersetEqual:"âŠ’",SquareUnion:"âŠ”",squarf:"â–ª",squf:"â–ª",srarr:"â†’",Sscr:"ð’®",sscr:"ð“ˆ",ssetmn:"âˆ–",ssmile:"âŒ£",sstarf:"â‹†",Star:"â‹†",star:"â˜†",starf:"â˜…",straightepsilon:"Ïµ",straightphi:"Ï•",strns:"Â¯",Sub:"â‹",sub:"âŠ‚",subdot:"âª½",subE:"â«…",sube:"âŠ†",subedot:"â«ƒ",submult:"â«",subnE:"â«‹",subne:"âŠŠ",subplus:"âª¿",subrarr:"â¥¹",Subset:"â‹",subset:"âŠ‚",subseteq:"âŠ†",subseteqq:"â«…",SubsetEqual:"âŠ†",subsetneq:"âŠŠ",subsetneqq:"â«‹",subsim:"â«‡",subsub:"â«•",subsup:"â«“",succ:"â‰»",succapprox:"âª¸",succcurlyeq:"â‰½",Succeeds:"â‰»",SucceedsEqual:"âª°",SucceedsSlantEqual:"â‰½",SucceedsTilde:"â‰¿",succeq:"âª°",succnapprox:"âªº",succneqq:"âª¶",succnsim:"â‹©",succsim:"â‰¿",SuchThat:"âˆ‹",Sum:"âˆ‘",sum:"âˆ‘",sung:"â™ª",Sup:"â‹‘",sup:"âŠƒ",sup1:"Â¹",sup2:"Â²",sup3:"Â³",supdot:"âª¾",supdsub:"â«˜",supE:"â«†",supe:"âŠ‡",supedot:"â«„",Superset:"âŠƒ",SupersetEqual:"âŠ‡",suphsol:"âŸ‰",suphsub:"â«—",suplarr:"â¥»",supmult:"â«‚",supnE:"â«Œ",supne:"âŠ‹",supplus:"â«€",Supset:"â‹‘",supset:"âŠƒ",supseteq:"âŠ‡",supseteqq:"â«†",supsetneq:"âŠ‹",supsetneqq:"â«Œ",supsim:"â«ˆ",supsub:"â«”",supsup:"â«–",swarhk:"â¤¦",swArr:"â‡™",swarr:"â†™",swarrow:"â†™",swnwar:"â¤ª",szlig:"ÃŸ",Tab:"	",target:"âŒ–",Tau:"Î¤",tau:"Ï„",tbrk:"âŽ´",Tcaron:"Å¤",tcaron:"Å¥",Tcedil:"Å¢",tcedil:"Å£",Tcy:"Ð¢",tcy:"Ñ‚",tdot:"âƒ›",telrec:"âŒ•",Tfr:"ð”—",tfr:"ð”±",there4:"âˆ´",Therefore:"âˆ´",therefore:"âˆ´",Theta:"Î˜",theta:"Î¸",thetasym:"Ï‘",thetav:"Ï‘",thickapprox:"â‰ˆ",thicksim:"âˆ¼",ThickSpace:"âŸâ€Š",thinsp:"â€‰",ThinSpace:"â€‰",thkap:"â‰ˆ",thksim:"âˆ¼",THORN:"Ãž",thorn:"Ã¾",Tilde:"âˆ¼",tilde:"Ëœ",TildeEqual:"â‰ƒ",TildeFullEqual:"â‰…",TildeTilde:"â‰ˆ",times:"Ã—",timesb:"âŠ ",timesbar:"â¨±",timesd:"â¨°",tint:"âˆ­",toea:"â¤¨",top:"âŠ¤",topbot:"âŒ¶",topcir:"â«±",Topf:"ð•‹",topf:"ð•¥",topfork:"â«š",tosa:"â¤©",tprime:"â€´",TRADE:"â„¢",trade:"â„¢",triangle:"â–µ",triangledown:"â–¿",triangleleft:"â—ƒ",trianglelefteq:"âŠ´",triangleq:"â‰œ",triangleright:"â–¹",trianglerighteq:"âŠµ",tridot:"â—¬",trie:"â‰œ",triminus:"â¨º",TripleDot:"âƒ›",triplus:"â¨¹",trisb:"â§",tritime:"â¨»",trpezium:"â¢",Tscr:"ð’¯",tscr:"ð“‰",TScy:"Ð¦",tscy:"Ñ†",TSHcy:"Ð‹",tshcy:"Ñ›",Tstrok:"Å¦",tstrok:"Å§",twixt:"â‰¬",twoheadleftarrow:"â†ž",twoheadrightarrow:"â† ",Uacute:"Ãš",uacute:"Ãº",Uarr:"â†Ÿ",uArr:"â‡‘",uarr:"â†‘",Uarrocir:"â¥‰",Ubrcy:"ÐŽ",ubrcy:"Ñž",Ubreve:"Å¬",ubreve:"Å­",Ucirc:"Ã›",ucirc:"Ã»",Ucy:"Ð£",ucy:"Ñƒ",udarr:"â‡…",Udblac:"Å°",udblac:"Å±",udhar:"â¥®",ufisht:"â¥¾",Ufr:"ð”˜",ufr:"ð”²",Ugrave:"Ã™",ugrave:"Ã¹",uHar:"â¥£",uharl:"â†¿",uharr:"â†¾",uhblk:"â–€",ulcorn:"âŒœ",ulcorner:"âŒœ",ulcrop:"âŒ",ultri:"â—¸",Umacr:"Åª",umacr:"Å«",uml:"Â¨",UnderBar:"_",UnderBrace:"âŸ",UnderBracket:"âŽµ",UnderParenthesis:"â",Union:"â‹ƒ",UnionPlus:"âŠŽ",Uogon:"Å²",uogon:"Å³",Uopf:"ð•Œ",uopf:"ð•¦",UpArrow:"â†‘",Uparrow:"â‡‘",uparrow:"â†‘",UpArrowBar:"â¤’",UpArrowDownArrow:"â‡…",UpDownArrow:"â†•",Updownarrow:"â‡•",updownarrow:"â†•",UpEquilibrium:"â¥®",upharpoonleft:"â†¿",upharpoonright:"â†¾",uplus:"âŠŽ",UpperLeftArrow:"â†–",UpperRightArrow:"â†—",Upsi:"Ï’",upsi:"Ï…",upsih:"Ï’",Upsilon:"Î¥",upsilon:"Ï…",UpTee:"âŠ¥",UpTeeArrow:"â†¥",upuparrows:"â‡ˆ",urcorn:"âŒ",urcorner:"âŒ",urcrop:"âŒŽ",Uring:"Å®",uring:"Å¯",urtri:"â—¹",Uscr:"ð’°",uscr:"ð“Š",utdot:"â‹°",Utilde:"Å¨",utilde:"Å©",utri:"â–µ",utrif:"â–´",uuarr:"â‡ˆ",Uuml:"Ãœ",uuml:"Ã¼",uwangle:"â¦§",vangrt:"â¦œ",varepsilon:"Ïµ",varkappa:"Ï°",varnothing:"âˆ…",varphi:"Ï•",varpi:"Ï–",varpropto:"âˆ",vArr:"â‡•",varr:"â†•",varrho:"Ï±",varsigma:"Ï‚",varsubsetneq:"âŠŠï¸€",varsubsetneqq:"â«‹ï¸€",varsupsetneq:"âŠ‹ï¸€",varsupsetneqq:"â«Œï¸€",vartheta:"Ï‘",vartriangleleft:"âŠ²",vartriangleright:"âŠ³",Vbar:"â««",vBar:"â«¨",vBarv:"â«©",Vcy:"Ð’",vcy:"Ð²",VDash:"âŠ«",Vdash:"âŠ©",vDash:"âŠ¨",vdash:"âŠ¢",Vdashl:"â«¦",Vee:"â‹",vee:"âˆ¨",veebar:"âŠ»",veeeq:"â‰š",vellip:"â‹®",Verbar:"â€–",verbar:"|",Vert:"â€–",vert:"|",VerticalBar:"âˆ£",VerticalLine:"|",VerticalSeparator:"â˜",VerticalTilde:"â‰€",VeryThinSpace:"â€Š",Vfr:"ð”™",vfr:"ð”³",vltri:"âŠ²",vnsub:"âŠ‚âƒ’",vnsup:"âŠƒâƒ’",Vopf:"ð•",vopf:"ð•§",vprop:"âˆ",vrtri:"âŠ³",Vscr:"ð’±",vscr:"ð“‹",vsubnE:"â«‹ï¸€",vsubne:"âŠŠï¸€",vsupnE:"â«Œï¸€",vsupne:"âŠ‹ï¸€",Vvdash:"âŠª",vzigzag:"â¦š",Wcirc:"Å´",wcirc:"Åµ",wedbar:"â©Ÿ",Wedge:"â‹€",wedge:"âˆ§",wedgeq:"â‰™",weierp:"â„˜",Wfr:"ð”š",wfr:"ð”´",Wopf:"ð•Ž",wopf:"ð•¨",wp:"â„˜",wr:"â‰€",wreath:"â‰€",Wscr:"ð’²",wscr:"ð“Œ",xcap:"â‹‚",xcirc:"â—¯",xcup:"â‹ƒ",xdtri:"â–½",Xfr:"ð”›",xfr:"ð”µ",xhArr:"âŸº",xharr:"âŸ·",Xi:"Îž",xi:"Î¾",xlArr:"âŸ¸",xlarr:"âŸµ",xmap:"âŸ¼",xnis:"â‹»",xodot:"â¨€",Xopf:"ð•",xopf:"ð•©",xoplus:"â¨",xotime:"â¨‚",xrArr:"âŸ¹",xrarr:"âŸ¶",Xscr:"ð’³",xscr:"ð“",xsqcup:"â¨†",xuplus:"â¨„",xutri:"â–³",xvee:"â‹",xwedge:"â‹€",Yacute:"Ã",yacute:"Ã½",YAcy:"Ð¯",yacy:"Ñ",Ycirc:"Å¶",ycirc:"Å·",Ycy:"Ð«",ycy:"Ñ‹",yen:"Â¥",Yfr:"ð”œ",yfr:"ð”¶",YIcy:"Ð‡",yicy:"Ñ—",Yopf:"ð•",yopf:"ð•ª",Yscr:"ð’´",yscr:"ð“Ž",YUcy:"Ð®",yucy:"ÑŽ",Yuml:"Å¸",yuml:"Ã¿",Zacute:"Å¹",zacute:"Åº",Zcaron:"Å½",zcaron:"Å¾",Zcy:"Ð—",zcy:"Ð·",Zdot:"Å»",zdot:"Å¼",zeetrf:"â„¨",ZeroWidthSpace:"â€‹",Zeta:"Î–",zeta:"Î¶",Zfr:"â„¨",zfr:"ð”·",ZHcy:"Ð–",zhcy:"Ð¶",zigrarr:"â‡",Zopf:"â„¤",zopf:"ð•«",Zscr:"ð’µ",zscr:"ð“",zwj:"â€",zwnj:"â€Œ"}),n.entityMap=n.HTML_ENTITIES})(g4);var uN={},Zm=fu.NAMESPACE,sA=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,_T=new RegExp("[\\-\\.0-9"+sA.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),kT=new RegExp("^"+sA.source+_T.source+"*(?::"+sA.source+_T.source+"*)?$"),Lg=0,Ml=1,bd=2,Mg=3,wd=4,Sd=5,Og=6,Xy=7;function rg(n,e){this.message=n,this.locator=e,Error.captureStackTrace&&Error.captureStackTrace(this,rg)}rg.prototype=new Error;rg.prototype.name=rg.name;function m4(){}m4.prototype={parse:function(n,e,t){var i=this.domBuilder;i.startDocument(),x4(e,e={}),C$(n,e,t,i,this.errorHandler),i.endDocument()}};function C$(n,e,t,i,s){function r(V){if(V>65535){V-=65536;var H=55296+(V>>10),P=56320+(V&1023);return String.fromCharCode(H,P)}else return String.fromCharCode(V)}function a(V){var H=V.slice(1,-1);return H in t?t[H]:H.charAt(0)==="#"?r(parseInt(H.substr(1).replace("x","0x"))):(s.error("entity not found:"+V),V)}function o(V){if(V>b){var H=n.substring(b,V).replace(/&#?\w+;/g,a);p&&c(b),i.characters(H,0,V-b),b=V}}function c(V,H){for(;V>=d&&(H=f.exec(n));)h=H.index,d=h+H[0].length,p.lineNumber++;p.columnNumber=V-h+1}for(var h=0,d=0,f=/.*(?:\r\n?|\n)|.*$/g,p=i.locator,g=[{currentNSMap:e}],v={},b=0;;){try{var x=n.indexOf("<",b);if(x<0){if(!n.substr(b).match(/^\s*$/)){var m=i.doc,y=m.createTextNode(n.substr(b));m.appendChild(y),i.currentElement=y}return}switch(x>b&&o(x),n.charAt(x+1)){case"/":var O=n.indexOf(">",x+3),w=n.substring(x+2,O).replace(/[ \t\n\r]+$/g,""),E=g.pop();O<0?(w=n.substring(x+2).replace(/[\s<].*/,""),s.error("end tag name: "+w+" is not complete:"+E.tagName),O=x+1+w.length):w.match(/\s</)&&(w=w.replace(/[\s<].*/,""),s.error("end tag name: "+w+" maybe not complete"),O=x+1+w.length);var S=E.localNSMap,_=E.tagName==w,T=_||E.tagName&&E.tagName.toLowerCase()==w.toLowerCase();if(T){if(i.endElement(E.uri,E.localName,w),S)for(var j in S)Object.prototype.hasOwnProperty.call(S,j)&&i.endPrefixMapping(j);_||s.fatalError("end tag name: "+w+" is not match the current start tagName:"+E.tagName)}else g.push(E);O++;break;case"?":p&&c(x),O=D$(n,x,i);break;case"!":p&&c(x),O=T$(n,x,i,s);break;default:p&&c(x);var M=new y4,L=g[g.length-1].currentNSMap,O=N$(n,x,M,L,a,s),B=M.length;if(!M.closed&&k$(n,O,M.tagName,v)&&(M.closed=!0,t.nbsp||s.warning("unclosed xml attribute")),p&&B){for(var G=TT(p,{}),W=0;W<B;W++){var J=M[W];c(J.offset),J.locator=TT(p,{})}i.locator=G,DT(M,i,L)&&g.push(M),i.locator=p}else DT(M,i,L)&&g.push(M);Zm.isHTML(M.uri)&&!M.closed?O=_$(n,O,M.tagName,a,i):O++}}catch(V){if(V instanceof rg)throw V;s.error("element parse error: "+V),O=-1}O>b?b=O:o(Math.max(x,b)+1)}}function TT(n,e){return e.lineNumber=n.lineNumber,e.columnNumber=n.columnNumber,e}function N$(n,e,t,i,s,r){function a(p,g,v){t.attributeNames.hasOwnProperty(p)&&r.fatalError("Attribute "+p+" redefined"),t.addValue(p,g,v)}for(var o,c,h=++e,d=Lg;;){var f=n.charAt(h);switch(f){case"=":if(d===Ml)o=n.slice(e,h),d=Mg;else if(d===bd)d=Mg;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(d===Mg||d===Ml)if(d===Ml&&(r.warning('attribute value must after "="'),o=n.slice(e,h)),e=h+1,h=n.indexOf(f,e),h>0)c=n.slice(e,h).replace(/&#?\w+;/g,s),a(o,c,e-1),d=Sd;else throw new Error("attribute value no end '"+f+"' match");else if(d==wd)c=n.slice(e,h).replace(/&#?\w+;/g,s),a(o,c,e),r.warning('attribute "'+o+'" missed start quot('+f+")!!"),e=h+1,d=Sd;else throw new Error('attribute value must after "="');break;case"/":switch(d){case Lg:t.setTagName(n.slice(e,h));case Sd:case Og:case Xy:d=Xy,t.closed=!0;case wd:case Ml:break;case bd:t.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return r.error("unexpected end of input"),d==Lg&&t.setTagName(n.slice(e,h)),h;case">":switch(d){case Lg:t.setTagName(n.slice(e,h));case Sd:case Og:case Xy:break;case wd:case Ml:c=n.slice(e,h),c.slice(-1)==="/"&&(t.closed=!0,c=c.slice(0,-1));case bd:d===bd&&(c=o),d==wd?(r.warning('attribute "'+c+'" missed quot(")!'),a(o,c.replace(/&#?\w+;/g,s),e)):((!Zm.isHTML(i[""])||!c.match(/^(?:disabled|checked|selected)$/i))&&r.warning('attribute "'+c+'" missed value!! "'+c+'" instead!!'),a(c,c,e));break;case Mg:throw new Error("attribute value missed!!")}return h;case"Â€":f=" ";default:if(f<=" ")switch(d){case Lg:t.setTagName(n.slice(e,h)),d=Og;break;case Ml:o=n.slice(e,h),d=bd;break;case wd:var c=n.slice(e,h).replace(/&#?\w+;/g,s);r.warning('attribute "'+c+'" missed quot(")!!'),a(o,c,e);case Sd:d=Og;break}else switch(d){case bd:t.tagName,(!Zm.isHTML(i[""])||!o.match(/^(?:disabled|checked|selected)$/i))&&r.warning('attribute "'+o+'" missed value!! "'+o+'" instead2!!'),a(o,o,e),e=h,d=Ml;break;case Sd:r.warning('attribute space is required"'+o+'"!!');case Og:d=Ml,e=h;break;case Mg:d=wd,e=h;break;case Xy:throw new Error("elements closed character '/' and '>' must be connected to")}}h++}}function DT(n,e,t){for(var i=n.tagName,s=null,f=n.length;f--;){var r=n[f],a=r.qName,o=r.value,p=a.indexOf(":");if(p>0)var c=r.prefix=a.slice(0,p),h=a.slice(p+1),d=c==="xmlns"&&h;else h=a,c=null,d=a==="xmlns"&&"";r.localName=h,d!==!1&&(s==null&&(s={},x4(t,t={})),t[d]=s[d]=o,r.uri=Zm.XMLNS,e.startPrefixMapping(d,o))}for(var f=n.length;f--;){r=n[f];var c=r.prefix;c&&(c==="xml"&&(r.uri=Zm.XML),c!=="xmlns"&&(r.uri=t[c||""]))}var p=i.indexOf(":");p>0?(c=n.prefix=i.slice(0,p),h=n.localName=i.slice(p+1)):(c=null,h=n.localName=i);var g=n.uri=t[c||""];if(e.startElement(g,h,i,n),n.closed){if(e.endElement(g,h,i),s)for(c in s)Object.prototype.hasOwnProperty.call(s,c)&&e.endPrefixMapping(c)}else return n.currentNSMap=t,n.localNSMap=s,!0}function _$(n,e,t,i,s){if(/^(?:script|textarea)$/i.test(t)){var r=n.indexOf("</"+t+">",e),a=n.substring(e+1,r);if(/[&<]/.test(a))return/^script$/i.test(t)?(s.characters(a,0,a.length),r):(a=a.replace(/&#?\w+;/g,i),s.characters(a,0,a.length),r)}return e+1}function k$(n,e,t,i){var s=i[t];return s==null&&(s=n.lastIndexOf("</"+t+">"),s<e&&(s=n.lastIndexOf("</"+t)),i[t]=s),s<e}function x4(n,e){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}function T$(n,e,t,i){var s=n.charAt(e+2);switch(s){case"-":if(n.charAt(e+3)==="-"){var r=n.indexOf("-->",e+4);return r>e?(t.comment(n,e+4,r-e-4),r+3):(i.error("Unclosed comment"),-1)}else return-1;default:if(n.substr(e+3,6)=="CDATA["){var r=n.indexOf("]]>",e+9);return t.startCDATA(),t.characters(n,e+9,r-e-9),t.endCDATA(),r+3}var a=j$(n,e),o=a.length;if(o>1&&/!doctype/i.test(a[0][0])){var c=a[1][0],h=!1,d=!1;o>3&&(/^public$/i.test(a[2][0])?(h=a[3][0],d=o>4&&a[4][0]):/^system$/i.test(a[2][0])&&(d=a[3][0]));var f=a[o-1];return t.startDTD(c,h,d),t.endDTD(),f.index+f[0].length}}return-1}function D$(n,e,t){var i=n.indexOf("?>",e);if(i){var s=n.substring(e,i).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return s?(s[0].length,t.processingInstruction(s[1],s[2]),i+2):-1}return-1}function y4(){this.attributeNames={}}y4.prototype={setTagName:function(n){if(!kT.test(n))throw new Error("invalid tagName:"+n);this.tagName=n},addValue:function(n,e,t){if(!kT.test(n))throw new Error("invalid attribute:"+n);this.attributeNames[n]=this.length,this[this.length++]={qName:n,value:e,offset:t}},length:0,getLocalName:function(n){return this[n].localName},getLocator:function(n){return this[n].locator},getQName:function(n){return this[n].qName},getURI:function(n){return this[n].uri},getValue:function(n){return this[n].value}};function j$(n,e){var t,i=[],s=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(s.lastIndex=e,s.exec(n);t=s.exec(n);)if(i.push(t),t[1])return i}uN.XMLReader=m4;uN.ParseError=rg;var R$=fu,hN=du,jT=g4,v4=uN,L$=hN.DOMImplementation,RT=R$.NAMESPACE,M$=v4.ParseError,O$=v4.XMLReader;function b4(n){this.options=n||{locator:{}}}b4.prototype.parseFromString=function(n,e){var t=this.options,i=new O$,s=t.domBuilder||new vy,r=t.errorHandler,a=t.locator,o=t.xmlns||{},c=/\/x?html?$/.test(e),h=c?jT.HTML_ENTITIES:jT.XML_ENTITIES;return a&&s.setDocumentLocator(a),i.errorHandler=P$(r,s,a),i.domBuilder=t.domBuilder||s,c&&(o[""]=RT.HTML),o.xml=o.xml||RT.XML,n&&typeof n=="string"?i.parse(n,o,h):i.errorHandler.error("invalid doc source"),s.doc};function P$(n,e,t){if(!n){if(e instanceof vy)return e;n=e}var i={},s=n instanceof Function;t=t||{};function r(a){var o=n[a];!o&&s&&(o=n.length==2?function(c){n(a,c)}:n),i[a]=o&&function(c){o("[xmldom "+a+"]	"+c+rA(t))}||function(){}}return r("warning"),r("error"),r("fatalError"),i}function vy(){this.cdata=!1}function Ad(n,e){e.lineNumber=n.lineNumber,e.columnNumber=n.columnNumber}vy.prototype={startDocument:function(){this.doc=new L$().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(n,e,t,i){var s=this.doc,r=s.createElementNS(n,t||e),a=i.length;Ky(this,r),this.currentElement=r,this.locator&&Ad(this.locator,r);for(var o=0;o<a;o++){var n=i.getURI(o),c=i.getValue(o),t=i.getQName(o),h=s.createAttributeNS(n,t);this.locator&&Ad(i.getLocator(o),h),h.value=h.nodeValue=c,r.setAttributeNode(h)}},endElement:function(n,e,t){var i=this.currentElement;i.tagName,this.currentElement=i.parentNode},startPrefixMapping:function(n,e){},endPrefixMapping:function(n){},processingInstruction:function(n,e){var t=this.doc.createProcessingInstruction(n,e);this.locator&&Ad(this.locator,t),Ky(this,t)},ignorableWhitespace:function(n,e,t){},characters:function(n,e,t){if(n=LT.apply(this,arguments),n){if(this.cdata)var i=this.doc.createCDATASection(n);else var i=this.doc.createTextNode(n);this.currentElement?this.currentElement.appendChild(i):/^\s*$/.test(n)&&this.doc.appendChild(i),this.locator&&Ad(this.locator,i)}},skippedEntity:function(n){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(n){(this.locator=n)&&(n.lineNumber=0)},comment:function(n,e,t){n=LT.apply(this,arguments);var i=this.doc.createComment(n);this.locator&&Ad(this.locator,i),Ky(this,i)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(n,e,t){var i=this.doc.implementation;if(i&&i.createDocumentType){var s=i.createDocumentType(n,e,t);this.locator&&Ad(this.locator,s),Ky(this,s),this.doc.doctype=s}},warning:function(n){console.warn("[xmldom warning]	"+n,rA(this.locator))},error:function(n){console.error("[xmldom error]	"+n,rA(this.locator))},fatalError:function(n){throw new M$(n,this.locator)}};function rA(n){if(n)return`
@`+(n.systemId||"")+"#[line:"+n.lineNumber+",col:"+n.columnNumber+"]"}function LT(n,e,t){return typeof n=="string"?n.substr(e,t):n.length>=e+t||e?new java.lang.String(n,e,t)+"":n}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(n){vy.prototype[n]=function(){return null}});function Ky(n,e){n.currentElement?n.currentElement.appendChild(e):n.doc.appendChild(e)}yy.__DOMHandler=vy;yy.DOMParser=b4;yy.DOMImplementation=hN.DOMImplementation;yy.XMLSerializer=hN.XMLSerializer;var w4=yy.DOMParser;const dN=typeof window<"u"?window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame:!1,I$=1,B$=3,S4=typeof URL<"u"?URL:typeof window<"u"?window.URL||window.webkitURL||window.mozURL:void 0;function uw(){var n=new Date().getTime(),e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var i=(n+Math.random()*16)%16|0;return n=Math.floor(n/16),(t=="x"?i:i&7|8).toString(16)});return e}function z$(){return Math.max(document.documentElement.clientHeight,document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight)}function A4(n){return!!(n&&n.nodeType==1)}function Mn(n){return!isNaN(parseFloat(n))&&isFinite(n)}function E4(n){let e=parseFloat(n);return Mn(n)===!1?!1:typeof n=="string"&&n.indexOf(".")>-1?!0:Math.floor(e)!==e}function jd(n){var e=["Webkit","webkit","Moz","O","ms"],t=["-webkit-","-webkit-","-moz-","-o-","-ms-"],i=n.toLowerCase(),s=e.length;if(typeof document>"u"||typeof document.body.style[i]<"u")return n;for(var r=0;r<s;r++)if(typeof document.body.style[t[r]+i]<"u")return t[r]+i;return n}function C4(n){for(var e=1,t=arguments.length;e<t;e++){var i=arguments[e];for(var s in i)n[s]===void 0&&(n[s]=i[s])}return n}function Ii(n){var e=[].slice.call(arguments,1);return e.forEach(function(t){t&&Object.getOwnPropertyNames(t).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}),n}function F$(n,e,t){var i=ag(n,e,t);return e.splice(i,0,n),i}function ag(n,e,t,i,s){var r=i||0,a=s||e.length,o=parseInt(r+(a-r)/2),c;return t||(t=function(h,d){if(h>d)return 1;if(h<d)return-1;if(h==d)return 0}),a-r<=0?o:(c=t(e[o],n),a-r===1?c>=0?o:o+1:c===0?o:c===-1?ag(n,e,t,o,a):ag(n,e,t,r,o))}function Vb(n,e,t,i,s){var r=i||0,a=s||e.length,o=parseInt(r+(a-r)/2),c;return t||(t=function(h,d){if(h>d)return 1;if(h<d)return-1;if(h==d)return 0}),a-r<=0?-1:(c=t(e[o],n),a-r===1?c===0?o:-1:c===0?o:c===-1?Vb(n,e,t,o,a):Vb(n,e,t,r,o))}function Sv(n){var e=window.getComputedStyle(n),t=["width","paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"],i=["height","paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"],s=0,r=0;return t.forEach(function(a){s+=parseFloat(e[a])||0}),i.forEach(function(a){r+=parseFloat(e[a])||0}),{height:r,width:s}}function Gb(n){var e=window.getComputedStyle(n),t=["paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"],i=["paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"],s=0,r=0;return t.forEach(function(a){s+=parseFloat(e[a])||0}),i.forEach(function(a){r+=parseFloat(e[a])||0}),{height:r,width:s}}function aA(n){let e,t=n.ownerDocument;if(n.nodeType==Node.TEXT_NODE){let i=t.createRange();i.selectNodeContents(n),e=i.getBoundingClientRect()}else e=n.getBoundingClientRect();return e}function Wb(){var n=window.innerWidth,e=window.innerHeight;return{top:0,left:0,right:n,bottom:e,width:n,height:e}}function fN(n,e){for(var t=n.parentNode,i=t.childNodes,s,r=-1,a=0;a<i.length&&(s=i[a],s.nodeType===e&&r++,s!=n);a++);return r}function U$(n){return fN(n,B$)}function N4(n){return fN(n,I$)}function Qm(n){return["xml","opf","ncx"].indexOf(n)>-1}function _4(n,e){return new Blob([n],{type:e})}function Yb(n,e){var t,i=_4(n,e);return t=S4.createObjectURL(i),t}function k4(n){return S4.revokeObjectURL(n)}function oA(n,e){var t,i;if(typeof n=="string")return t=btoa(n),i="data:"+e+";base64,"+t,i}function T4(n){return Object.prototype.toString.call(n).slice(8,-1)}function io(n,e,t){var i,s;return typeof DOMParser>"u"||t?s=w4:s=DOMParser,n.charCodeAt(0)===65279&&(n=n.slice(1)),i=new s().parseFromString(n,e),i}function ln(n,e){var t;if(!n)throw new Error("No Element Provided");if(typeof n.querySelector<"u")return n.querySelector(e);if(t=n.getElementsByTagName(e),t.length)return t[0]}function _l(n,e){return typeof n.querySelector<"u"?n.querySelectorAll(e):n.getElementsByTagName(e)}function Rd(n,e,t){var i,s;if(typeof n.querySelector<"u"){e+="[";for(var r in t)e+=r+"~='"+t[r]+"'";return e+="]",n.querySelector(e)}else if(i=n.getElementsByTagName(e),s=Array.prototype.slice.call(i,0).filter(function(a){for(var o in t)if(a.getAttribute(o)===t[o])return!0;return!1}),s)return s[0]}function Xb(n,e){var t=n.ownerDocument||n;typeof t.createTreeWalker<"u"?D4(n,e,NodeFilter.SHOW_TEXT):pN(n,function(i){i&&i.nodeType===3&&e(i)})}function D4(n,e,t){var i=document.createTreeWalker(n,t,null,!1);let s;for(;s=i.nextNode();)e(s)}function pN(n,e){if(e(n))return!0;if(n=n.firstChild,n)do{if(pN(n,e))return!0;n=n.nextSibling}while(n)}function j4(n){return new Promise(function(e,t){var i=new FileReader;i.readAsDataURL(n),i.onloadend=function(){e(i.result)}})}function Dt(){this.resolve=null,this.reject=null,this.id=uw(),this.promise=new Promise((n,e)=>{this.resolve=n,this.reject=e}),Object.freeze(this)}function Kb(n,e,t){var i;if(typeof n.querySelector<"u"&&(i=n.querySelector(`${e}[*|type="${t}"]`)),!i||i.length===0){i=_l(n,e);for(var s=0;s<i.length;s++)if(i[s].getAttributeNS("http://www.idpf.org/2007/ops","type")===t||i[s].getAttribute("epub:type")===t)return i[s]}else return i}function lA(n){for(var e=[],t=n.childNodes,i=0;i<t.length;i++){let s=t[i];s.nodeType===1&&e.push(s)}return e}function cA(n){for(var e=[n];n;n=n.parentNode)e.unshift(n);return e}function Ld(n,e,t){for(var i=[],s=n.childNodes,r=0;r<s.length;r++){let a=s[r];if(a.nodeType===1&&a.nodeName.toLowerCase()===e){if(t)return a;i.push(a)}}if(!t)return i}function H$(n,e){let t;if(!(n===null||e===""))for(t=n.parentNode;t.nodeType===1;){if(t.tagName.toLowerCase()===e)return t;t=t.parentNode}}class R4{constructor(){this.collapsed=!1,this.commonAncestorContainer=void 0,this.endContainer=void 0,this.endOffset=void 0,this.startContainer=void 0,this.startOffset=void 0}setStart(e,t){this.startContainer=e,this.startOffset=t,this.endContainer?this.commonAncestorContainer=this._commonAncestorContainer():this.collapse(!0),this._checkCollapsed()}setEnd(e,t){this.endContainer=e,this.endOffset=t,this.startContainer?(this.collapsed=!1,this.commonAncestorContainer=this._commonAncestorContainer()):this.collapse(!1),this._checkCollapsed()}collapse(e){this.collapsed=!0,e?(this.endContainer=this.startContainer,this.endOffset=this.startOffset,this.commonAncestorContainer=this.startContainer.parentNode):(this.startContainer=this.endContainer,this.startOffset=this.endOffset,this.commonAncestorContainer=this.endOffset.parentNode)}selectNode(e){let t=e.parentNode,i=Array.prototype.indexOf.call(t.childNodes,e);this.setStart(t,i),this.setEnd(t,i+1)}selectNodeContents(e){e.childNodes[e.childNodes-1];let t=e.nodeType===3?e.textContent.length:parent.childNodes.length;this.setStart(e,0),this.setEnd(e,t)}_commonAncestorContainer(e,t){var i=cA(e||this.startContainer),s=cA(t||this.endContainer);if(i[0]==s[0]){for(var r=0;r<i.length;r++)if(i[r]!=s[r])return i[r-1]}}_checkCollapsed(){this.startContainer===this.endContainer&&this.startOffset===this.endOffset?this.collapsed=!0:this.collapsed=!1}toString(){}}const $$=Object.freeze(Object.defineProperty({__proto__:null,RangeObject:R4,blob2base64:j4,borders:Gb,bounds:Sv,createBase64Url:oA,createBlob:_4,createBlobUrl:Yb,defaults:C4,defer:Dt,documentHeight:z$,extend:Ii,filterChildren:Ld,findChildren:lA,getParentByTagName:H$,indexOfElementNode:N4,indexOfNode:fN,indexOfSorted:Vb,indexOfTextNode:U$,insert:F$,isElement:A4,isFloat:E4,isNumber:Mn,isXml:Qm,locationOf:ag,nodeBounds:aA,parents:cA,parse:io,prefixed:jd,qs:ln,qsa:_l,qsp:Rd,querySelectorByType:Kb,requestAnimationFrame:dN,revokeBlobUrl:k4,sprint:Xb,treeWalker:D4,type:T4,uuid:uw,walk:pN,windowBounds:Wb},Symbol.toStringTag,{value:"Module"}));if(!L4)var L4={cwd:function(){return"/"}};function Ea(n){if(typeof n!="string")throw new TypeError("Path must be a string. Received "+n)}function MT(n,e){for(var t="",i=-1,s=0,r,a=0;a<=n.length;++a){if(a<n.length)r=n.charCodeAt(a);else{if(r===47)break;r=47}if(r===47){if(!(i===a-1||s===1))if(i!==a-1&&s===2){if(t.length<2||t.charCodeAt(t.length-1)!==46||t.charCodeAt(t.length-2)!==46){if(t.length>2){for(var o=t.length-1,c=o;c>=0&&t.charCodeAt(c)!==47;--c);if(c!==o){c===-1?t="":t=t.slice(0,c),i=a,s=0;continue}}else if(t.length===2||t.length===1){t="",i=a,s=0;continue}}e&&(t.length>0?t+="/..":t="..")}else t.length>0?t+="/"+n.slice(i+1,a):t=n.slice(i+1,a);i=a,s=0}else r===46&&s!==-1?++s:s=-1}return t}function q$(n,e){var t=e.dir||e.root,i=e.base||(e.name||"")+(e.ext||"");return t?t===e.root?t+i:t+n+i:i}var Av={resolve:function(){for(var e="",t=!1,i,s=arguments.length-1;s>=-1&&!t;s--){var r;s>=0?r=arguments[s]:(i===void 0&&(i=L4.cwd()),r=i),Ea(r),r.length!==0&&(e=r+"/"+e,t=r.charCodeAt(0)===47)}return e=MT(e,!t),t?e.length>0?"/"+e:"/":e.length>0?e:"."},normalize:function(e){if(Ea(e),e.length===0)return".";var t=e.charCodeAt(0)===47,i=e.charCodeAt(e.length-1)===47;return e=MT(e,!t),e.length===0&&!t&&(e="."),e.length>0&&i&&(e+="/"),t?"/"+e:e},isAbsolute:function(e){return Ea(e),e.length>0&&e.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var e,t=0;t<arguments.length;++t){var i=arguments[t];Ea(i),i.length>0&&(e===void 0?e=i:e+="/"+i)}return e===void 0?".":Av.normalize(e)},relative:function(e,t){if(Ea(e),Ea(t),e===t||(e=Av.resolve(e),t=Av.resolve(t),e===t))return"";for(var i=1;i<e.length&&e.charCodeAt(i)===47;++i);for(var s=e.length,r=s-i,a=1;a<t.length&&t.charCodeAt(a)===47;++a);for(var o=t.length,c=o-a,h=r<c?r:c,d=-1,f=0;f<=h;++f){if(f===h){if(c>h){if(t.charCodeAt(a+f)===47)return t.slice(a+f+1);if(f===0)return t.slice(a+f)}else r>h&&(e.charCodeAt(i+f)===47?d=f:f===0&&(d=0));break}var p=e.charCodeAt(i+f),g=t.charCodeAt(a+f);if(p!==g)break;p===47&&(d=f)}var v="";for(f=i+d+1;f<=s;++f)(f===s||e.charCodeAt(f)===47)&&(v.length===0?v+="..":v+="/..");return v.length>0?v+t.slice(a+d):(a+=d,t.charCodeAt(a)===47&&++a,t.slice(a))},_makeLong:function(e){return e},dirname:function(e){if(Ea(e),e.length===0)return".";for(var t=e.charCodeAt(0),i=t===47,s=-1,r=!0,a=e.length-1;a>=1;--a)if(t=e.charCodeAt(a),t===47){if(!r){s=a;break}}else r=!1;return s===-1?i?"/":".":i&&s===1?"//":e.slice(0,s)},basename:function(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');Ea(e);var i=0,s=-1,r=!0,a;if(t!==void 0&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var o=t.length-1,c=-1;for(a=e.length-1;a>=0;--a){var h=e.charCodeAt(a);if(h===47){if(!r){i=a+1;break}}else c===-1&&(r=!1,c=a+1),o>=0&&(h===t.charCodeAt(o)?--o===-1&&(s=a):(o=-1,s=c))}return i===s?s=c:s===-1&&(s=e.length),e.slice(i,s)}else{for(a=e.length-1;a>=0;--a)if(e.charCodeAt(a)===47){if(!r){i=a+1;break}}else s===-1&&(r=!1,s=a+1);return s===-1?"":e.slice(i,s)}},extname:function(e){Ea(e);for(var t=-1,i=0,s=-1,r=!0,a=0,o=e.length-1;o>=0;--o){var c=e.charCodeAt(o);if(c===47){if(!r){i=o+1;break}continue}s===-1&&(r=!1,s=o+1),c===46?t===-1?t=o:a!==1&&(a=1):t!==-1&&(a=-1)}return t===-1||s===-1||a===0||a===1&&t===s-1&&t===i+1?"":e.slice(t,s)},format:function(e){if(e===null||typeof e!="object")throw new TypeError('Parameter "pathObject" must be an object, not '+typeof e);return q$("/",e)},parse:function(e){Ea(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;var i=e.charCodeAt(0),s=i===47,r;s?(t.root="/",r=1):r=0;for(var a=-1,o=0,c=-1,h=!0,d=e.length-1,f=0;d>=r;--d){if(i=e.charCodeAt(d),i===47){if(!h){o=d+1;break}continue}c===-1&&(h=!1,c=d+1),i===46?a===-1?a=d:f!==1&&(f=1):a!==-1&&(f=-1)}return a===-1||c===-1||f===0||f===1&&a===c-1&&a===o+1?c!==-1&&(o===0&&s?t.base=t.name=e.slice(1,c):t.base=t.name=e.slice(o,c)):(o===0&&s?(t.name=e.slice(1,a),t.base=e.slice(1,c)):(t.name=e.slice(o,a),t.base=e.slice(o,c)),t.ext=e.slice(a,c)),o>0?t.dir=e.slice(0,o-1):s&&(t.dir="/"),t},sep:"/",delimiter:":",posix:null},V$=Av;const Hc=ed(V$);class kl{constructor(e){var t,i;t=e.indexOf("://"),t>-1&&(e=new URL(e).pathname),i=this.parse(e),this.path=e,this.isDirectory(e)?this.directory=e:this.directory=i.dir+"/",this.filename=i.base,this.extension=i.ext.slice(1)}parse(e){return Hc.parse(e)}isAbsolute(e){return Hc.isAbsolute(e||this.path)}isDirectory(e){return e.charAt(e.length-1)==="/"}resolve(e){return Hc.resolve(this.directory,e)}relative(e){var t=e&&e.indexOf("://")>-1;return t?e:Hc.relative(this.directory,e)}splitPath(e){return this.splitPathRe.exec(e).slice(1)}toString(){return this.path}}class Qr{constructor(e,t){var i=e.indexOf("://")>-1,s=e,r;if(this.Url=void 0,this.href=e,this.protocol="",this.origin="",this.hash="",this.hash="",this.search="",this.base=t,!i&&t!==!1&&typeof t!="string"&&window&&window.location&&(this.base=window.location.href),i||this.base)try{this.base?this.Url=new URL(e,this.base):this.Url=new URL(e),this.href=this.Url.href,this.protocol=this.Url.protocol,this.origin=this.Url.origin,this.hash=this.Url.hash,this.search=this.Url.search,s=this.Url.pathname+(this.Url.search?this.Url.search:"")}catch{this.Url=void 0,this.base&&(r=new kl(this.base),s=r.resolve(s))}this.Path=new kl(s),this.directory=this.Path.directory,this.filename=this.Path.filename,this.extension=this.Path.extension}path(){return this.Path}resolve(e){var t=e.indexOf("://")>-1,i;return t?e:(i=Hc.resolve(this.directory,e),this.origin+i)}relative(e){return Hc.relative(e,this.directory)}toString(){return this.href}}const Ed=1,pr=3,G$=9;class jt{constructor(e,t,i){var s;if(this.str="",this.base={},this.spinePos=0,this.range=!1,this.path={},this.start=null,this.end=null,!(this instanceof jt))return new jt(e,t,i);if(typeof t=="string"?this.base=this.parseComponent(t):typeof t=="object"&&t.steps&&(this.base=t),s=this.checkType(e),s==="string")return this.str=e,Ii(this,this.parse(e));if(s==="range")return Ii(this,this.fromRange(e,this.base,i));if(s==="node")return Ii(this,this.fromNode(e,this.base,i));if(s==="EpubCFI"&&e.path)return e;if(e)throw new TypeError("not a valid argument for EpubCFI");return this}checkType(e){return this.isCfiString(e)?"string":e&&typeof e=="object"&&(T4(e)==="Range"||typeof e.startContainer<"u")?"range":e&&typeof e=="object"&&typeof e.nodeType<"u"?"node":e&&typeof e=="object"&&e instanceof jt?"EpubCFI":!1}parse(e){var t={spinePos:-1,range:!1,base:{},path:{},start:null,end:null},i,s,r;return typeof e!="string"?{spinePos:-1}:(e.indexOf("epubcfi(")===0&&e[e.length-1]===")"&&(e=e.slice(8,e.length-1)),i=this.getChapterComponent(e),i?(t.base=this.parseComponent(i),s=this.getPathComponent(e),t.path=this.parseComponent(s),r=this.getRange(e),r&&(t.range=!0,t.start=this.parseComponent(r[0]),t.end=this.parseComponent(r[1])),t.spinePos=t.base.steps[1].index,t):{spinePos:-1})}parseComponent(e){var t={steps:[],terminal:{offset:null,assertion:null}},i=e.split(":"),s=i[0].split("/"),r;return i.length>1&&(r=i[1],t.terminal=this.parseTerminal(r)),s[0]===""&&s.shift(),t.steps=s.map((function(a){return this.parseStep(a)}).bind(this)),t}parseStep(e){var t,i,s,r,a;if(r=e.match(/\[(.*)\]/),r&&r[1]&&(a=r[1]),i=parseInt(e),!isNaN(i))return i%2===0?(t="element",s=i/2-1):(t="text",s=(i-1)/2),{type:t,index:s,id:a||null}}parseTerminal(e){var t,i,s=e.match(/\[(.*)\]/);return s&&s[1]?(t=parseInt(e.split("[")[0]),i=s[1]):t=parseInt(e),Mn(t)||(t=null),{offset:t,assertion:i}}getChapterComponent(e){var t=e.split("!");return t[0]}getPathComponent(e){var t=e.split("!");if(t[1])return t[1].split(",")[0]}getRange(e){var t=e.split(",");return t.length===3?[t[1],t[2]]:!1}getCharecterOffsetComponent(e){var t=e.split(":");return t[1]||""}joinSteps(e){return e?e.map(function(t){var i="";return t.type==="element"&&(i+=(t.index+1)*2),t.type==="text"&&(i+=1+2*t.index),t.id&&(i+="["+t.id+"]"),i}).join("/"):""}segmentString(e){var t="/";return t+=this.joinSteps(e.steps),e.terminal&&e.terminal.offset!=null&&(t+=":"+e.terminal.offset),e.terminal&&e.terminal.assertion!=null&&(t+="["+e.terminal.assertion+"]"),t}toString(){var e="epubcfi(";return e+=this.segmentString(this.base),e+="!",e+=this.segmentString(this.path),this.range&&this.start&&(e+=",",e+=this.segmentString(this.start)),this.range&&this.end&&(e+=",",e+=this.segmentString(this.end)),e+=")",e}compare(e,t){var i,s,r,a;if(typeof e=="string"&&(e=new jt(e)),typeof t=="string"&&(t=new jt(t)),e.spinePos>t.spinePos)return 1;if(e.spinePos<t.spinePos)return-1;e.range?(i=e.path.steps.concat(e.start.steps),r=e.start.terminal):(i=e.path.steps,r=e.path.terminal),t.range?(s=t.path.steps.concat(t.start.steps),a=t.start.terminal):(s=t.path.steps,a=t.path.terminal);for(var o=0;o<i.length;o++){if(!i[o])return-1;if(!s[o]||i[o].index>s[o].index)return 1;if(i[o].index<s[o].index)return-1}return i.length<s.length?-1:r.offset>a.offset?1:r.offset<a.offset?-1:0}step(e){var t=e.nodeType===pr?"text":"element";return{id:e.id,tagName:e.tagName,type:t,index:this.position(e)}}filteredStep(e,t){var i=this.filter(e,t),s;if(i)return s=i.nodeType===pr?"text":"element",{id:i.id,tagName:i.tagName,type:s,index:this.filteredPosition(i,t)}}pathTo(e,t,i){for(var s={steps:[],terminal:{offset:null,assertion:null}},r=e,a;r&&r.parentNode&&r.parentNode.nodeType!=G$;)i?a=this.filteredStep(r,i):a=this.step(r),a&&s.steps.unshift(a),r=r.parentNode;return t!=null&&t>=0&&(s.terminal.offset=t,s.steps[s.steps.length-1].type!="text"&&s.steps.push({type:"text",index:0})),s}equalStep(e,t){return!e||!t?!1:e.index===t.index&&e.id===t.id&&e.type===t.type}fromRange(e,t,i){var s={range:!1,base:{},path:{},start:null,end:null},r=e.startContainer,a=e.endContainer,o=e.startOffset,c=e.endOffset,h=!1;if(i&&(h=r.ownerDocument.querySelector("."+i)!=null),typeof t=="string"?(s.base=this.parseComponent(t),s.spinePos=s.base.steps[1].index):typeof t=="object"&&(s.base=t),e.collapsed)h&&(o=this.patchOffset(r,o,i)),s.path=this.pathTo(r,o,i);else{s.range=!0,h&&(o=this.patchOffset(r,o,i)),s.start=this.pathTo(r,o,i),h&&(c=this.patchOffset(a,c,i)),s.end=this.pathTo(a,c,i),s.path={steps:[],terminal:null};var d=s.start.steps.length,f;for(f=0;f<d&&this.equalStep(s.start.steps[f],s.end.steps[f]);f++)f===d-1?s.start.terminal===s.end.terminal&&(s.path.steps.push(s.start.steps[f]),s.range=!1):s.path.steps.push(s.start.steps[f]);s.start.steps=s.start.steps.slice(s.path.steps.length),s.end.steps=s.end.steps.slice(s.path.steps.length)}return s}fromNode(e,t,i){var s={range:!1,base:{},path:{},start:null,end:null};return typeof t=="string"?(s.base=this.parseComponent(t),s.spinePos=s.base.steps[1].index):typeof t=="object"&&(s.base=t),s.path=this.pathTo(e,null,i),s}filter(e,t){var i,s,r,a,o,c=!1;return e.nodeType===pr?(c=!0,r=e.parentNode,i=e.parentNode.classList.contains(t)):(c=!1,i=e.classList.contains(t)),i&&c?(a=r.previousSibling,o=r.nextSibling,a&&a.nodeType===pr?s=a:o&&o.nodeType===pr&&(s=o),s||e):i&&!c?!1:e}patchOffset(e,t,i){if(e.nodeType!=pr)throw new Error("Anchor must be a text node");var s=e,r=t;for(e.parentNode.classList.contains(i)&&(s=e.parentNode);s.previousSibling;){if(s.previousSibling.nodeType===Ed)if(s.previousSibling.classList.contains(i))r+=s.previousSibling.textContent.length;else break;else r+=s.previousSibling.textContent.length;s=s.previousSibling}return r}normalizedMap(e,t,i){var s={},r=-1,a,o=e.length,c,h;for(a=0;a<o;a++)c=e[a].nodeType,c===Ed&&e[a].classList.contains(i)&&(c=pr),a>0&&c===pr&&h===pr?s[a]=r:t===c&&(r=r+1,s[a]=r),h=c;return s}position(e){var t,i;return e.nodeType===Ed?(t=e.parentNode.children,t||(t=lA(e.parentNode)),i=Array.prototype.indexOf.call(t,e)):(t=this.textNodes(e.parentNode),i=t.indexOf(e)),i}filteredPosition(e,t){var i,s,r;return e.nodeType===Ed?(i=e.parentNode.children,r=this.normalizedMap(i,Ed,t)):(i=e.parentNode.childNodes,e.parentNode.classList.contains(t)&&(e=e.parentNode,i=e.parentNode.childNodes),r=this.normalizedMap(i,pr,t)),s=Array.prototype.indexOf.call(i,e),r[s]}stepsToXpath(e){var t=[".","*"];return e.forEach(function(i){var s=i.index+1;i.id?t.push("*[position()="+s+" and @id='"+i.id+"']"):i.type==="text"?t.push("text()["+s+"]"):t.push("*["+s+"]")}),t.join("/")}stepsToQuerySelector(e){var t=["html"];return e.forEach(function(i){var s=i.index+1;i.id?t.push("#"+i.id):i.type==="text"||t.push("*:nth-child("+s+")")}),t.join(">")}textNodes(e,t){return Array.prototype.slice.call(e.childNodes).filter(function(i){return i.nodeType===pr?!0:!!(t&&i.classList.contains(t))})}walkToNode(e,t,i){var s=t||document,r=s.documentElement,a,o,c=e.length,h;for(h=0;h<c&&(o=e[h],o.type==="element"?o.id?r=s.getElementById(o.id):(a=r.children||lA(r),r=a[o.index]):o.type==="text"&&(r=this.textNodes(r,i)[o.index]),!!r);h++);return r}findNode(e,t,i){var s=t||document,r,a;return!i&&typeof s.evaluate<"u"?(a=this.stepsToXpath(e),r=s.evaluate(a,s,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue):i?r=this.walkToNode(e,s,i):r=this.walkToNode(e,s),r}fixMiss(e,t,i,s){var r=this.findNode(e.slice(0,-1),i,s),a=r.childNodes,o=this.normalizedMap(a,pr,s),c,h,d=e[e.length-1].index;for(let f in o){if(!o.hasOwnProperty(f))return;if(o[f]===d)if(c=a[f],h=c.textContent.length,t>h)t=t-h;else{c.nodeType===Ed?r=c.childNodes[0]:r=c;break}}return{container:r,offset:t}}toRange(e,t){var i=e||document,s,r,a,o,c,h=this,d,f,p=t?i.querySelector("."+t)!=null:!1,g;if(typeof i.createRange<"u"?s=i.createRange():s=new R4,h.range?(r=h.start,d=h.path.steps.concat(r.steps),o=this.findNode(d,i,p?t:null),a=h.end,f=h.path.steps.concat(a.steps),c=this.findNode(f,i,p?t:null)):(r=h.path,d=h.path.steps,o=this.findNode(h.path.steps,i,p?t:null)),o)try{r.terminal.offset!=null?s.setStart(o,r.terminal.offset):s.setStart(o,0)}catch{g=this.fixMiss(d,r.terminal.offset,i,p?t:null),s.setStart(g.container,g.offset)}else return console.log("No startContainer found for",this.toString()),null;if(c)try{a.terminal.offset!=null?s.setEnd(c,a.terminal.offset):s.setEnd(c,0)}catch{g=this.fixMiss(f,h.end.terminal.offset,i,p?t:null),s.setEnd(g.container,g.offset)}return s}isCfiString(e){return typeof e=="string"&&e.indexOf("epubcfi(")===0&&e[e.length-1]===")"}generateChapterComponent(e,t,i){var s=parseInt(t),r=(e+1)*2,a="/"+r+"/";return a+=(s+1)*2,i&&(a+="["+i+"]"),a}collapse(e){this.range&&(this.range=!1,e?(this.path.steps=this.path.steps.concat(this.start.steps),this.path.terminal=this.start.terminal):(this.path.steps=this.path.steps.concat(this.end.steps),this.path.terminal=this.end.terminal))}}class da{constructor(e){this.context=e||this,this.hooks=[]}register(){for(var e=0;e<arguments.length;++e)if(typeof arguments[e]=="function")this.hooks.push(arguments[e]);else for(var t=0;t<arguments[e].length;++t)this.hooks.push(arguments[e][t])}deregister(e){let t;for(let i=0;i<this.hooks.length;i++)if(t=this.hooks[i],t===e){this.hooks.splice(i,1);break}}trigger(){var e=arguments,t=this.context,i=[];return this.hooks.forEach(function(s){try{var r=s.apply(t,e)}catch(a){console.log(a)}r&&typeof r.then=="function"&&i.push(r)}),Promise.all(i)}list(){return this.hooks}clear(){return this.hooks=[]}}function M4(n,e){var t,i,s=e.url,r=s.indexOf("://")>-1;n&&(i=ln(n,"head"),t=ln(i,"base"),t||(t=n.createElement("base"),i.insertBefore(t,i.firstChild)),!r&&window&&window.location&&(s=window.location.origin+s),t.setAttribute("href",s))}function W$(n,e){var t,i,s=e.canonical;n&&(t=ln(n,"head"),i=ln(t,"link[rel='canonical']"),i?i.setAttribute("href",s):(i=n.createElement("link"),i.setAttribute("rel","canonical"),i.setAttribute("href",s),t.appendChild(i)))}function Y$(n,e){var t,i,s=e.idref;n&&(t=ln(n,"head"),i=ln(t,"link[property='dc.identifier']"),i?i.setAttribute("content",s):(i=n.createElement("meta"),i.setAttribute("name","dc.identifier"),i.setAttribute("content",s),t.appendChild(i)))}function X$(n,e){var t=n.querySelectorAll("a[href]");if(t.length)for(var i=ln(n.ownerDocument,"base"),s=i?i.getAttribute("href"):void 0,r=(function(o){var c=o.getAttribute("href");if(c.indexOf("mailto:")!==0){var h=c.indexOf("://")>-1;if(h)o.setAttribute("target","_blank");else{var d;try{d=new Qr(c,s)}catch{}o.onclick=function(){return d&&d.hash?e(d.Path.path+d.hash):e(d?d.Path.path:c),!1}}}}).bind(this),a=0;a<t.length;a++)r(t[a])}function OT(n,e,t){return e.forEach(function(i,s){i&&t[s]&&(i=i.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),n=n.replace(new RegExp(i,"g"),t[s]))}),n}function Jm(n,e,t,i){var s=typeof window<"u"?window.URL:!1,r=s?"blob":"arraybuffer",a=new Dt,o=new XMLHttpRequest,c=XMLHttpRequest.prototype,h;"overrideMimeType"in c||Object.defineProperty(c,"overrideMimeType",{value:function(){}}),t&&(o.withCredentials=!0),o.onreadystatechange=f,o.onerror=d,o.open("GET",n,!0);for(h in i)o.setRequestHeader(h,i[h]);e=="json"&&o.setRequestHeader("Accept","application/json"),e||(e=new kl(n).extension),e=="blob"&&(o.responseType=r),Qm(e)&&o.overrideMimeType("text/xml"),e=="binary"&&(o.responseType="arraybuffer"),o.send();function d(p){a.reject(p)}function f(){if(this.readyState===XMLHttpRequest.DONE){var p=!1;if((this.responseType===""||this.responseType==="document")&&(p=this.responseXML),this.status===200||this.status===0||p){var g;if(!this.response&&!p)return a.reject({status:this.status,message:"Empty Response",stack:new Error().stack}),a.promise;if(this.status===403)return a.reject({status:this.status,response:this.response,message:"Forbidden",stack:new Error().stack}),a.promise;p?g=this.responseXML:Qm(e)?g=io(this.response,"text/xml"):e=="xhtml"?g=io(this.response,"application/xhtml+xml"):e=="html"||e=="htm"?g=io(this.response,"text/html"):e=="json"?g=JSON.parse(this.response):e=="blob"?s?g=this.response:g=new Blob([this.response]):g=this.response,a.resolve(g)}else a.reject({status:this.status,message:this.response,stack:new Error().stack})}}return a.promise}class K${constructor(e,t){this.idref=e.idref,this.linear=e.linear==="yes",this.properties=e.properties,this.index=e.index,this.href=e.href,this.url=e.url,this.canonical=e.canonical,this.next=e.next,this.prev=e.prev,this.cfiBase=e.cfiBase,t?this.hooks=t:(this.hooks={},this.hooks.serialize=new da(this),this.hooks.content=new da(this)),this.document=void 0,this.contents=void 0,this.output=void 0}load(e){var t=e||this.request||Jm,i=new Dt,s=i.promise;return this.contents?i.resolve(this.contents):t(this.url).then((function(r){return this.document=r,this.contents=r.documentElement,this.hooks.content.trigger(this.document,this)}).bind(this)).then((function(){i.resolve(this.contents)}).bind(this)).catch(function(r){i.reject(r)}),s}base(){return M4(this.document,this)}render(e){var t=new Dt,i=t.promise;return this.output,this.load(e).then((function(s){var r=typeof navigator<"u"&&navigator.userAgent||"",a=r.indexOf("Trident")>=0,o;typeof XMLSerializer>"u"||a?o=w4:o=XMLSerializer;var c=new o;return this.output=c.serializeToString(s),this.output}).bind(this)).then((function(){return this.hooks.serialize.trigger(this.output,this)}).bind(this)).then((function(){t.resolve(this.output)}).bind(this)).catch(function(s){t.reject(s)}),i}find(e){var t=this,i=[],s=e.toLowerCase(),r=function(a){for(var o=a.textContent.toLowerCase(),c=t.document.createRange(),h,d,f=-1,p,g=150;d!=-1;)d=o.indexOf(s,f+1),d!=-1&&(c=t.document.createRange(),c.setStart(a,d),c.setEnd(a,d+s.length),h=t.cfiFromRange(c),a.textContent.length<g?p=a.textContent:(p=a.textContent.substring(d-g/2,d+g/2),p="..."+p+"..."),i.push({cfi:h,excerpt:p})),f=d};return Xb(t.document,function(a){r(a)}),i}search(e,t=5){if(typeof document.createTreeWalker>"u")return this.find(e);let i=[];const s=150,r=this,a=e.toLowerCase(),o=function(f){const v=f.reduce((b,x)=>b+x.textContent,"").toLowerCase().indexOf(a);if(v!=-1){const x=v+a.length;let m=0,y=0;if(v<f[0].length){let w;for(;m<f.length-1&&(y+=f[m].length,!(x<=y));)m+=1;let E=f[0],S=f[m],_=r.document.createRange();_.setStart(E,v);let T=f.slice(0,m).reduce((M,L)=>M+L.textContent.length,0);_.setEnd(S,T>x?x:x-T),w=r.cfiFromRange(_);let j=f.slice(0,m+1).reduce((M,L)=>M+L.textContent,"");j.length>s&&(j=j.substring(v-s/2,v+s/2),j="..."+j+"..."),i.push({cfi:w,excerpt:j})}}},c=document.createTreeWalker(r.document,NodeFilter.SHOW_TEXT,null,!1);let h,d=[];for(;h=c.nextNode();)d.push(h),d.length==t&&(o(d.slice(0,t)),d=d.slice(1,t));return d.length>0&&o(d),i}reconcileLayoutSettings(e){var t={layout:e.layout,spread:e.spread,orientation:e.orientation};return this.properties.forEach(function(i){var s=i.replace("rendition:",""),r=s.indexOf("-"),a,o;r!=-1&&(a=s.slice(0,r),o=s.slice(r+1),t[a]=o)}),t}cfiFromRange(e){return new jt(e,this.cfiBase).toString()}cfiFromElement(e){return new jt(e,this.cfiBase).toString()}unload(){this.document=void 0,this.contents=void 0,this.output=void 0}destroy(){this.unload(),this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.idref=void 0,this.linear=void 0,this.properties=void 0,this.index=void 0,this.href=void 0,this.url=void 0,this.next=void 0,this.prev=void 0,this.cfiBase=void 0}}class Z${constructor(){this.spineItems=[],this.spineByHref={},this.spineById={},this.hooks={},this.hooks.serialize=new da,this.hooks.content=new da,this.hooks.content.register(M4),this.hooks.content.register(W$),this.hooks.content.register(Y$),this.epubcfi=new jt,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}unpack(e,t,i){this.items=e.spine,this.manifest=e.manifest,this.spineNodeIndex=e.spineNodeIndex,this.baseUrl=e.baseUrl||e.basePath||"",this.length=this.items.length,this.items.forEach((s,r)=>{var a=this.manifest[s.idref],o;s.index=r,s.cfiBase=this.epubcfi.generateChapterComponent(this.spineNodeIndex,s.index,s.id),s.href&&(s.url=t(s.href,!0),s.canonical=i(s.href)),a&&(s.href=a.href,s.url=t(s.href,!0),s.canonical=i(s.href),a.properties.length&&s.properties.push.apply(s.properties,a.properties)),s.linear==="yes"?(s.prev=(function(){let c=s.index;for(;c>0;){let h=this.get(c-1);if(h&&h.linear)return h;c-=1}}).bind(this),s.next=(function(){let c=s.index;for(;c<this.spineItems.length-1;){let h=this.get(c+1);if(h&&h.linear)return h;c+=1}}).bind(this)):(s.prev=function(){},s.next=function(){}),o=new K$(s,this.hooks),this.append(o)}),this.loaded=!0}get(e){var t=0;if(typeof e>"u")for(;t<this.spineItems.length;){let i=this.spineItems[t];if(i&&i.linear)break;t+=1}else this.epubcfi.isCfiString(e)?t=new jt(e).spinePos:typeof e=="number"||isNaN(e)===!1?t=e:typeof e=="string"&&e.indexOf("#")===0?t=this.spineById[e.substring(1)]:typeof e=="string"&&(e=e.split("#")[0],t=this.spineByHref[e]||this.spineByHref[encodeURI(e)]);return this.spineItems[t]||null}append(e){var t=this.spineItems.length;return e.index=t,this.spineItems.push(e),this.spineByHref[decodeURI(e.href)]=t,this.spineByHref[encodeURI(e.href)]=t,this.spineByHref[e.href]=t,this.spineById[e.idref]=t,t}prepend(e){return this.spineByHref[e.href]=0,this.spineById[e.idref]=0,this.spineItems.forEach(function(t,i){t.index=i}),0}remove(e){var t=this.spineItems.indexOf(e);if(t>-1)return delete this.spineByHref[e.href],delete this.spineById[e.idref],this.spineItems.splice(t,1)}each(){return this.spineItems.forEach.apply(this.spineItems,arguments)}first(){let e=0;do{let t=this.get(e);if(t&&t.linear)return t;e+=1}while(e<this.spineItems.length)}last(){let e=this.spineItems.length-1;do{let t=this.get(e);if(t&&t.linear)return t;e-=1}while(e>=0)}destroy(){this.each(e=>e.destroy()),this.spineItems=void 0,this.spineByHref=void 0,this.spineById=void 0,this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.epubcfi=void 0,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}}class gN{constructor(e){this._q=[],this.context=e,this.tick=dN,this.running=!1,this.paused=!1}enqueue(){var e,t,i,s=[].shift.call(arguments),r=arguments;if(!s)throw new Error("No Task Provided");return typeof s=="function"?(e=new Dt,t=e.promise,i={task:s,args:r,deferred:e,promise:t}):i={promise:s},this._q.push(i),this.paused==!1&&!this.running&&this.run(),i.promise}dequeue(){var e,t,i;if(this._q.length&&!this.paused){if(e=this._q.shift(),t=e.task,t)return i=t.apply(this.context,e.args),i&&typeof i.then=="function"?i.then((function(){e.deferred.resolve.apply(this.context,arguments)}).bind(this),(function(){e.deferred.reject.apply(this.context,arguments)}).bind(this)):(e.deferred.resolve.apply(this.context,i),e.promise);if(e.promise)return e.promise}else return e=new Dt,e.deferred.resolve(),e.promise}dump(){for(;this._q.length;)this.dequeue()}run(){return this.running||(this.running=!0,this.defered=new Dt),this.tick.call(window,()=>{this._q.length?this.dequeue().then((function(){this.run()}).bind(this)):(this.defered.resolve(),this.running=void 0)}),this.paused==!0&&(this.paused=!1),this.defered.promise}flush(){if(this.running)return this.running;if(this._q.length)return this.running=this.dequeue().then((function(){return this.running=void 0,this.flush()}).bind(this)),this.running}clear(){this._q=[]}length(){return this._q.length}pause(){this.paused=!0}stop(){this._q=[],this.running=!1,this.paused=!0}}const hw="0.3",Ev=["keydown","keyup","keypressed","mouseup","mousedown","mousemove","click","touchend","touchstart","touchmove"],Ue={BOOK:{OPEN_FAILED:"openFailed"},CONTENTS:{EXPAND:"expand",RESIZE:"resize",SELECTED:"selected",SELECTED_RANGE:"selectedRange",LINK_CLICKED:"linkClicked"},LOCATIONS:{CHANGED:"changed"},MANAGERS:{RESIZE:"resize",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",ADDED:"added",SCROLL:"scroll",SCROLLED:"scrolled",REMOVED:"removed"},VIEWS:{AXIS:"axis",WRITING_MODE:"writingMode",LOAD_ERROR:"loaderror",RENDERED:"rendered",RESIZED:"resized",DISPLAYED:"displayed",SHOWN:"shown",HIDDEN:"hidden",MARK_CLICKED:"markClicked"},RENDITION:{STARTED:"started",ATTACHED:"attached",DISPLAYED:"displayed",DISPLAY_ERROR:"displayerror",RENDERED:"rendered",REMOVED:"removed",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",LOCATION_CHANGED:"locationChanged",RELOCATED:"relocated",MARK_CLICKED:"markClicked",SELECTED:"selected",LAYOUT:"layout"},LAYOUT:{UPDATED:"updated"},ANNOTATION:{ATTACH:"attach",DETACH:"detach"}};class O4{constructor(e,t,i){this.spine=e,this.request=t,this.pause=i||100,this.q=new gN(this),this.epubcfi=new jt,this._locations=[],this._locationsWords=[],this.total=0,this.break=150,this._current=0,this._wordCounter=0,this.currentLocation="",this._currentCfi="",this.processingTimeout=void 0}generate(e){return e&&(this.break=e),this.q.pause(),this.spine.each((function(t){t.linear&&this.q.enqueue(this.process.bind(this),t)}).bind(this)),this.q.run().then((function(){return this.total=this._locations.length-1,this._currentCfi&&(this.currentLocation=this._currentCfi),this._locations}).bind(this))}createRange(){return{startContainer:void 0,startOffset:void 0,endContainer:void 0,endOffset:void 0}}process(e){return e.load(this.request).then((function(t){var i=new Dt,s=this.parse(t,e.cfiBase);return this._locations=this._locations.concat(s),e.unload(),this.processingTimeout=setTimeout(()=>i.resolve(s),this.pause),i.promise}).bind(this))}parse(e,t,i){var s=[],r,a=e.ownerDocument,o=ln(a,"body"),c=0,h,d=i||this.break,f=function(p){var g=p.length,v,b=0;if(p.textContent.trim().length===0)return!1;for(c==0&&(r=this.createRange(),r.startContainer=p,r.startOffset=0),v=d-c,v>g&&(c+=g,b=g);b<g;)if(v=d-c,c===0&&(b+=1,r=this.createRange(),r.startContainer=p,r.startOffset=b),b+v>=g)c+=g-b,b=g;else{b+=v,r.endContainer=p,r.endOffset=b;let x=new jt(r,t).toString();s.push(x),c=0}h=p};if(Xb(o,f.bind(this)),r&&r.startContainer&&h){r.endContainer=h,r.endOffset=h.length;let p=new jt(r,t).toString();s.push(p),c=0}return s}generateFromWords(e,t,i){var s=e?new jt(e):void 0;return this.q.pause(),this._locationsWords=[],this._wordCounter=0,this.spine.each((function(r){r.linear&&(s?r.index>=s.spinePos&&this.q.enqueue(this.processWords.bind(this),r,t,s,i):this.q.enqueue(this.processWords.bind(this),r,t,s,i))}).bind(this)),this.q.run().then((function(){return this._currentCfi&&(this.currentLocation=this._currentCfi),this._locationsWords}).bind(this))}processWords(e,t,i,s){return s&&this._locationsWords.length>=s?Promise.resolve():e.load(this.request).then((function(r){var a=new Dt,o=this.parseWords(r,e,t,i),c=s-this._locationsWords.length;return this._locationsWords=this._locationsWords.concat(o.length>=s?o.slice(0,c):o),e.unload(),this.processingTimeout=setTimeout(()=>a.resolve(o),this.pause),a.promise}).bind(this))}countWords(e){return e=e.replace(/(^\s*)|(\s*$)/gi,""),e=e.replace(/[ ]{2,}/gi," "),e=e.replace(/\n /,`
`),e.split(" ").length}parseWords(e,t,i,s){var r=t.cfiBase,a=[],o=e.ownerDocument,c=ln(o,"body"),h=i,d=s?s.spinePos!==t.index:!0,f;s&&t.index===s.spinePos&&(f=s.findNode(s.range?s.path.steps.concat(s.start.steps):s.path.steps,e.ownerDocument));var p=function(g){if(!d)if(g===f)d=!0;else return!1;if(g.textContent.length<10&&g.textContent.trim().length===0)return!1;var v=this.countWords(g.textContent),b,x=0;if(v===0)return!1;for(b=h-this._wordCounter,b>v&&(this._wordCounter+=v,x=v);x<v;)if(b=h-this._wordCounter,x+b>=v)this._wordCounter+=v-x,x=v;else{x+=b;let m=new jt(g,r);a.push({cfi:m.toString(),wordCount:this._wordCounter}),this._wordCounter=0}};return Xb(c,p.bind(this)),a}locationFromCfi(e){let t;return jt.prototype.isCfiString(e)&&(e=new jt(e)),this._locations.length===0?-1:(t=ag(e,this._locations,this.epubcfi.compare),t>this.total?this.total:t)}percentageFromCfi(e){if(this._locations.length===0)return null;var t=this.locationFromCfi(e);return this.percentageFromLocation(t)}percentageFromLocation(e){return!e||!this.total?0:e/this.total}cfiFromLocation(e){var t=-1;return typeof e!="number"&&(e=parseInt(e)),e>=0&&e<this._locations.length&&(t=this._locations[e]),t}cfiFromPercentage(e){let t;if(e>1&&console.warn("Normalize cfiFromPercentage value to between 0 - 1"),e>=1){let i=new jt(this._locations[this.total]);return i.collapse(),i.toString()}return t=Math.ceil(this.total*e),this.cfiFromLocation(t)}load(e){return typeof e=="string"?this._locations=JSON.parse(e):this._locations=e,this.total=this._locations.length-1,this._locations}save(){return JSON.stringify(this._locations)}getCurrent(){return this._current}setCurrent(e){var t;if(typeof e=="string")this._currentCfi=e;else if(typeof e=="number")this._current=e;else return;this._locations.length!==0&&(typeof e=="string"?(t=this.locationFromCfi(e),this._current=t):t=e,this.emit(Ue.LOCATIONS.CHANGED,{percentage:this.percentageFromLocation(t)}))}get currentLocation(){return this._current}set currentLocation(e){this.setCurrent(e)}length(){return this._locations.length}destroy(){this.spine=void 0,this.request=void 0,this.pause=void 0,this.q.stop(),this.q=void 0,this.epubcfi=void 0,this._locations=void 0,this.total=void 0,this.break=void 0,this._current=void 0,this.currentLocation=void 0,this._currentCfi=void 0,clearTimeout(this.processingTimeout)}}uo(O4.prototype);class Q${constructor(e){this.packagePath="",this.directory="",this.encoding="",e&&this.parse(e)}parse(e){var t;if(!e)throw new Error("Container File Not Found");if(t=ln(e,"rootfile"),!t)throw new Error("No RootFile Found");this.packagePath=t.getAttribute("full-path"),this.directory=Hc.dirname(this.packagePath),this.encoding=e.xmlEncoding}destroy(){this.packagePath=void 0,this.directory=void 0,this.encoding=void 0}}class PT{constructor(e){this.manifest={},this.navPath="",this.ncxPath="",this.coverPath="",this.spineNodeIndex=0,this.spine=[],this.metadata={},e&&this.parse(e)}parse(e){var t,i,s;if(!e)throw new Error("Package File Not Found");if(t=ln(e,"metadata"),!t)throw new Error("No Metadata Found");if(i=ln(e,"manifest"),!i)throw new Error("No Manifest Found");if(s=ln(e,"spine"),!s)throw new Error("No Spine Found");return this.manifest=this.parseManifest(i),this.navPath=this.findNavPath(i),this.ncxPath=this.findNcxPath(i,s),this.coverPath=this.findCoverPath(e),this.spineNodeIndex=N4(s),this.spine=this.parseSpine(s,this.manifest),this.uniqueIdentifier=this.findUniqueIdentifier(e),this.metadata=this.parseMetadata(t),this.metadata.direction=s.getAttribute("page-progression-direction"),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex}}parseMetadata(e){var t={};return t.title=this.getElementText(e,"title"),t.creator=this.getElementText(e,"creator"),t.description=this.getElementText(e,"description"),t.pubdate=this.getElementText(e,"date"),t.publisher=this.getElementText(e,"publisher"),t.identifier=this.getElementText(e,"identifier"),t.language=this.getElementText(e,"language"),t.rights=this.getElementText(e,"rights"),t.modified_date=this.getPropertyText(e,"dcterms:modified"),t.layout=this.getPropertyText(e,"rendition:layout"),t.orientation=this.getPropertyText(e,"rendition:orientation"),t.flow=this.getPropertyText(e,"rendition:flow"),t.viewport=this.getPropertyText(e,"rendition:viewport"),t.media_active_class=this.getPropertyText(e,"media:active-class"),t.spread=this.getPropertyText(e,"rendition:spread"),t}parseManifest(e){var t={},i=_l(e,"item"),s=Array.prototype.slice.call(i);return s.forEach(function(r){var a=r.getAttribute("id"),o=r.getAttribute("href")||"",c=r.getAttribute("media-type")||"",h=r.getAttribute("media-overlay")||"",d=r.getAttribute("properties")||"";t[a]={href:o,type:c,overlay:h,properties:d.length?d.split(" "):[]}}),t}parseSpine(e,t){var i=[],s=_l(e,"itemref"),r=Array.prototype.slice.call(s);return r.forEach(function(a,o){var c=a.getAttribute("idref"),h=a.getAttribute("properties")||"",d=h.length?h.split(" "):[],f={id:a.getAttribute("id"),idref:c,linear:a.getAttribute("linear")||"yes",properties:d,index:o};i.push(f)}),i}findUniqueIdentifier(e){var t=e.documentElement.getAttribute("unique-identifier");if(!t)return"";var i=e.getElementById(t);return i&&i.localName==="identifier"&&i.namespaceURI==="http://purl.org/dc/elements/1.1/"&&i.childNodes.length>0?i.childNodes[0].nodeValue.trim():""}findNavPath(e){var t=Rd(e,"item",{properties:"nav"});return t?t.getAttribute("href"):!1}findNcxPath(e,t){var i=Rd(e,"item",{"media-type":"application/x-dtbncx+xml"}),s;return i||(s=t.getAttribute("toc"),s&&(i=e.querySelector(`#${s}`))),i?i.getAttribute("href"):!1}findCoverPath(e){var t=ln(e,"package");t.getAttribute("version");var i=Rd(e,"item",{properties:"cover-image"});if(i)return i.getAttribute("href");var s=Rd(e,"meta",{name:"cover"});if(s){var r=s.getAttribute("content"),a=e.getElementById(r);return a?a.getAttribute("href"):""}else return!1}getElementText(e,t){var i=e.getElementsByTagNameNS("http://purl.org/dc/elements/1.1/",t),s;return!i||i.length===0?"":(s=i[0],s.childNodes.length?s.childNodes[0].nodeValue:"")}getPropertyText(e,t){var i=Rd(e,"meta",{property:t});return i&&i.childNodes.length?i.childNodes[0].nodeValue:""}load(e){this.metadata=e.metadata;let t=e.readingOrder||e.spine;return this.spine=t.map((i,s)=>(i.index=s,i.linear=i.linear||"yes",i)),e.resources.forEach((i,s)=>{this.manifest[s]=i,i.rel&&i.rel[0]==="cover"&&(this.coverPath=i.href)}),this.spineNodeIndex=0,this.toc=e.toc.map((i,s)=>(i.label=i.title,i)),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex,toc:this.toc}}destroy(){this.manifest=void 0,this.navPath=void 0,this.ncxPath=void 0,this.coverPath=void 0,this.spineNodeIndex=void 0,this.spine=void 0,this.metadata=void 0}}class R2{constructor(e){this.toc=[],this.tocByHref={},this.tocById={},this.landmarks=[],this.landmarksByType={},this.length=0,e&&this.parse(e)}parse(e){let t=e.nodeType,i,s;t&&(i=ln(e,"html"),s=ln(e,"ncx")),t?i?(this.toc=this.parseNav(e),this.landmarks=this.parseLandmarks(e)):s&&(this.toc=this.parseNcx(e)):this.toc=this.load(e),this.length=0,this.unpack(this.toc)}unpack(e){for(var t,i=0;i<e.length;i++)t=e[i],t.href&&(this.tocByHref[t.href]=i),t.id&&(this.tocById[t.id]=i),this.length++,t.subitems.length&&this.unpack(t.subitems)}get(e){var t;return e?(e.indexOf("#")===0?t=this.tocById[e.substring(1)]:e in this.tocByHref&&(t=this.tocByHref[e]),this.getByIndex(e,t,this.toc)):this.toc}getByIndex(e,t,i){if(i.length===0)return;const s=i[t];if(s&&(e===s.id||e===s.href))return s;{let r;for(let a=0;a<i.length&&(r=this.getByIndex(e,t,i[a].subitems),!r);++a);return r}}landmark(e){var t;return e?(t=this.landmarksByType[e],this.landmarks[t]):this.landmarks}parseNav(e){var t=Kb(e,"nav","toc"),i=[];if(!t)return i;let s=Ld(t,"ol",!0);return s&&(i=this.parseNavList(s)),i}parseNavList(e,t){const i=[];if(!e||!e.children)return i;for(let s=0;s<e.children.length;s++){const r=this.navItem(e.children[s],t);r&&i.push(r)}return i}navItem(e,t){let i=e.getAttribute("id")||void 0,s=Ld(e,"a",!0)||Ld(e,"span",!0);if(!s)return;let r=s.getAttribute("href")||"";i||(i=r);let a=s.textContent||"",o=[],c=Ld(e,"ol",!0);return c&&(o=this.parseNavList(c,i)),{id:i,href:r,label:a,subitems:o,parent:t}}parseLandmarks(e){var t=Kb(e,"nav","landmarks"),i=t?_l(t,"li"):[],s=i.length,r,a=[],o;if(!i||s===0)return a;for(r=0;r<s;++r)o=this.landmarkItem(i[r]),o&&(a.push(o),this.landmarksByType[o.type]=r);return a}landmarkItem(e){let t=Ld(e,"a",!0);if(!t)return;let i=t.getAttributeNS("http://www.idpf.org/2007/ops","type")||void 0,s=t.getAttribute("href")||"",r=t.textContent||"";return{href:s,label:r,type:i}}parseNcx(e){var t=_l(e,"navPoint"),i=t.length,s,r={},a=[],o,c;if(!t||i===0)return a;for(s=0;s<i;++s)o=this.ncxItem(t[s]),r[o.id]=o,o.parent?(c=r[o.parent],c.subitems.push(o)):a.push(o);return a}ncxItem(e){var t=e.getAttribute("id")||!1,i=ln(e,"content"),s=i.getAttribute("src"),r=ln(e,"navLabel"),a=r.textContent?r.textContent:"",o=[],c=e.parentNode,h;return c&&(c.nodeName==="navPoint"||c.nodeName.split(":").slice(-1)[0]==="navPoint")&&(h=c.getAttribute("id")),{id:t,href:s,label:a,subitems:o,parent:h}}load(e){return e.map(t=>(t.label=t.title,t.subitems=t.children?this.load(t.children):[],t))}forEach(e){return this.toc.forEach(e)}}var Pg={application:{ecmascript:["es","ecma"],javascript:"js",ogg:"ogx",pdf:"pdf",postscript:["ps","ai","eps","epsi","epsf","eps2","eps3"],"rdf+xml":"rdf",smil:["smi","smil"],"xhtml+xml":["xhtml","xht"],xml:["xml","xsl","xsd","opf","ncx"],zip:"zip","x-httpd-eruby":"rhtml","x-latex":"latex","x-maker":["frm","maker","frame","fm","fb","book","fbdoc"],"x-object":"o","x-shockwave-flash":["swf","swfl"],"x-silverlight":"scr","epub+zip":"epub","font-tdpfr":"pfr","inkml+xml":["ink","inkml"],json:"json","jsonml+json":"jsonml","mathml+xml":"mathml","metalink+xml":"metalink",mp4:"mp4s","omdoc+xml":"omdoc",oxps:"oxps","vnd.amazon.ebook":"azw",widget:"wgt","x-dtbook+xml":"dtb","x-dtbresource+xml":"res","x-font-bdf":"bdf","x-font-ghostscript":"gsf","x-font-linux-psf":"psf","x-font-otf":"otf","x-font-pcf":"pcf","x-font-snf":"snf","x-font-ttf":["ttf","ttc"],"x-font-type1":["pfa","pfb","pfm","afm"],"x-font-woff":"woff","x-mobipocket-ebook":["prc","mobi"],"x-mspublisher":"pub","x-nzb":"nzb","x-tgif":"obj","xaml+xml":"xaml","xml-dtd":"dtd","xproc+xml":"xpl","xslt+xml":"xslt","internet-property-stream":"acx","x-compress":"z","x-compressed":"tgz","x-gzip":"gz"},audio:{flac:"flac",midi:["mid","midi","kar","rmi"],mpeg:["mpga","mpega","mp2","mp3","m4a","mp2a","m2a","m3a"],mpegurl:"m3u",ogg:["oga","ogg","spx"],"x-aiff":["aif","aiff","aifc"],"x-ms-wma":"wma","x-wav":"wav",adpcm:"adp",mp4:"mp4a",webm:"weba","x-aac":"aac","x-caf":"caf","x-matroska":"mka","x-pn-realaudio-plugin":"rmp",xm:"xm",mid:["mid","rmi"]},image:{gif:"gif",ief:"ief",jpeg:["jpeg","jpg","jpe"],pcx:"pcx",png:"png","svg+xml":["svg","svgz"],tiff:["tiff","tif"],"x-icon":"ico",bmp:"bmp",webp:"webp","x-pict":["pic","pct"],"x-tga":"tga","cis-cod":"cod"},text:{"cache-manifest":["manifest","appcache"],css:"css",csv:"csv",html:["html","htm","shtml","stm"],mathml:"mml",plain:["txt","text","brf","conf","def","list","log","in","bas"],richtext:"rtx","tab-separated-values":"tsv","x-bibtex":"bib"},video:{mpeg:["mpeg","mpg","mpe","m1v","m2v","mp2","mpa","mpv2"],mp4:["mp4","mp4v","mpg4"],quicktime:["qt","mov"],ogg:"ogv","vnd.mpegurl":["mxu","m4u"],"x-flv":"flv","x-la-asf":["lsf","lsx"],"x-mng":"mng","x-ms-asf":["asf","asx","asr"],"x-ms-wm":"wm","x-ms-wmv":"wmv","x-ms-wmx":"wmx","x-ms-wvx":"wvx","x-msvideo":"avi","x-sgi-movie":"movie","x-matroska":["mpv","mkv","mk3d","mks"],"3gpp2":"3g2",h261:"h261",h263:"h263",h264:"h264",jpeg:"jpgv",jpm:["jpm","jpgm"],mj2:["mj2","mjp2"],"vnd.ms-playready.media.pyv":"pyv","vnd.uvvu.mp4":["uvu","uvvu"],"vnd.vivo":"viv",webm:"webm","x-f4v":"f4v","x-m4v":"m4v","x-ms-vob":"vob","x-smv":"smv"}},J$=function(){var n,e,t,i,s={};for(n in Pg)if(Pg.hasOwnProperty(n)){for(e in Pg[n])if(Pg[n].hasOwnProperty(e))if(t=Pg[n][e],typeof t=="string")s[t]=n+"/"+e;else for(i=0;i<t.length;i++)s[t[i]]=n+"/"+e}return s}(),eq="text/plain";function tq(n){return n&&J$[n.split(".").pop().toLowerCase()]||eq}const gf={lookup:tq};class nq{constructor(e,t){this.settings={replacements:t&&t.replacements||"base64",archive:t&&t.archive,resolver:t&&t.resolver,request:t&&t.request},this.process(e)}process(e){this.manifest=e,this.resources=Object.keys(e).map(function(t){return e[t]}),this.replacementUrls=[],this.html=[],this.assets=[],this.css=[],this.urls=[],this.cssUrls=[],this.split(),this.splitUrls()}split(){this.html=this.resources.filter(function(e){if(e.type==="application/xhtml+xml"||e.type==="text/html")return!0}),this.assets=this.resources.filter(function(e){if(e.type!=="application/xhtml+xml"&&e.type!=="text/html")return!0}),this.css=this.resources.filter(function(e){if(e.type==="text/css")return!0})}splitUrls(){this.urls=this.assets.map((function(e){return e.href}).bind(this)),this.cssUrls=this.css.map(function(e){return e.href})}createUrl(e){var t=new Qr(e),i=gf.lookup(t.filename);return this.settings.archive?this.settings.archive.createUrl(e,{base64:this.settings.replacements==="base64"}):this.settings.replacements==="base64"?this.settings.request(e,"blob").then(s=>j4(s)).then(s=>oA(s,i)):this.settings.request(e,"blob").then(s=>Yb(s,i))}replacements(){if(this.settings.replacements==="none")return new Promise((function(t){t(this.urls)}).bind(this));var e=this.urls.map(t=>{var i=this.settings.resolver(t);return this.createUrl(i).catch(s=>(console.error(s),null))});return Promise.all(e).then(t=>(this.replacementUrls=t.filter(i=>typeof i=="string"),t))}replaceCss(e,t){var i=[];return e=e||this.settings.archive,t=t||this.settings.resolver,this.cssUrls.forEach((function(s){var r=this.createCssFile(s,e,t).then((function(a){var o=this.urls.indexOf(s);o>-1&&(this.replacementUrls[o]=a)}).bind(this));i.push(r)}).bind(this)),Promise.all(i)}createCssFile(e){var t;if(Hc.isAbsolute(e))return new Promise(function(a){a()});var i=this.settings.resolver(e),s;this.settings.archive?s=this.settings.archive.getText(i):s=this.settings.request(i,"text");var r=this.urls.map(a=>{var o=this.settings.resolver(a),c=new kl(i).relative(o);return c});return s?s.then(a=>(a=OT(a,r,this.replacementUrls),this.settings.replacements==="base64"?t=oA(a,"text/css"):t=Yb(a,"text/css"),t),a=>new Promise(function(o){o()})):new Promise(function(a){a()})}relativeTo(e,t){return t=t||this.settings.resolver,this.urls.map((function(i){var s=t(i),r=new kl(e).relative(s);return r}).bind(this))}get(e){var t=this.urls.indexOf(e);if(t!==-1)return this.replacementUrls.length?new Promise((function(i,s){i(this.replacementUrls[t])}).bind(this)):this.createUrl(e)}substitute(e,t){var i;return t?i=this.relativeTo(t):i=this.urls,OT(e,i,this.replacementUrls)}destroy(){this.settings=void 0,this.manifest=void 0,this.resources=void 0,this.replacementUrls=void 0,this.html=void 0,this.assets=void 0,this.css=void 0,this.urls=void 0,this.cssUrls=void 0}}class L2{constructor(e){this.pages=[],this.locations=[],this.epubcfi=new jt,this.firstPage=0,this.lastPage=0,this.totalPages=0,this.toc=void 0,this.ncx=void 0,e&&(this.pageList=this.parse(e)),this.pageList&&this.pageList.length&&this.process(this.pageList)}parse(e){var t=ln(e,"html"),i=ln(e,"ncx");if(t)return this.parseNav(e);if(i)return this.parseNcx(e)}parseNav(e){var t=Kb(e,"nav","page-list"),i=t?_l(t,"li"):[],s=i.length,r,a=[],o;if(!i||s===0)return a;for(r=0;r<s;++r)o=this.item(i[r]),a.push(o);return a}parseNcx(e){var t=[],i=0,s,r,a,o=0;if(r=ln(e,"pageList"),!r||(a=_l(r,"pageTarget"),o=a.length,!a||a.length===0))return t;for(i=0;i<o;++i)s=this.ncxItem(a[i]),t.push(s);return t}ncxItem(e){var t=ln(e,"navLabel"),i=ln(t,"text"),s=i.textContent,r=ln(e,"content"),a=r.getAttribute("src"),o=parseInt(s,10);return{href:a,page:o}}item(e){var t=ln(e,"a"),i=t.getAttribute("href")||"",s=t.textContent||"",r=parseInt(s),a=i.indexOf("epubcfi"),o,c,h;return a!=-1?(o=i.split("#"),c=o[0],h=o.length>1?o[1]:!1,{cfi:h,href:i,packageUrl:c,page:r}):{href:i,page:r}}process(e){e.forEach(function(t){this.pages.push(t.page),t.cfi&&this.locations.push(t.cfi)},this),this.firstPage=parseInt(this.pages[0]),this.lastPage=parseInt(this.pages[this.pages.length-1]),this.totalPages=this.lastPage-this.firstPage}pageFromCfi(e){var t=-1;if(this.locations.length===0)return-1;var i=Vb(e,this.locations,this.epubcfi.compare);return i!=-1?t=this.pages[i]:(i=ag(e,this.locations,this.epubcfi.compare),t=i-1>=0?this.pages[i-1]:this.pages[0],t!==void 0||(t=-1)),t}cfiFromPage(e){var t=-1;typeof e!="number"&&(e=parseInt(e));var i=this.pages.indexOf(e);return i!=-1&&(t=this.locations[i]),t}pageFromPercentage(e){var t=Math.round(this.totalPages*e);return t}percentageFromPage(e){var t=(e-this.firstPage)/this.totalPages;return Math.round(t*1e3)/1e3}percentageFromCfi(e){var t=this.pageFromCfi(e),i=this.percentageFromPage(t);return i}destroy(){this.pages=void 0,this.locations=void 0,this.epubcfi=void 0,this.pageList=void 0,this.toc=void 0,this.ncx=void 0}}class P4{constructor(e){this.settings=e,this.name=e.layout||"reflowable",this._spread=e.spread!=="none",this._minSpreadWidth=e.minSpreadWidth||800,this._evenSpreads=e.evenSpreads||!1,e.flow==="scrolled"||e.flow==="scrolled-continuous"||e.flow==="scrolled-doc"?this._flow="scrolled":this._flow="paginated",this.width=0,this.height=0,this.spreadWidth=0,this.delta=0,this.columnWidth=0,this.gap=0,this.divisor=1,this.props={name:this.name,spread:this._spread,flow:this._flow,width:0,height:0,spreadWidth:0,delta:0,columnWidth:0,gap:0,divisor:1}}flow(e){return typeof e<"u"&&(e==="scrolled"||e==="scrolled-continuous"||e==="scrolled-doc"?this._flow="scrolled":this._flow="paginated",this.update({flow:this._flow})),this._flow}spread(e,t){return e&&(this._spread=e!=="none",this.update({spread:this._spread})),t>=0&&(this._minSpreadWidth=t),this._spread}calculate(e,t,i){var s=1,r=i||0,a=e,o=t,c=Math.floor(a/12),h,d,f,p;this._spread&&a>=this._minSpreadWidth?s=2:s=1,this.name==="reflowable"&&this._flow==="paginated"&&!(i>=0)&&(r=c%2===0?c:c-1),this.name==="pre-paginated"&&(r=0),s>1?(h=a/s-r,f=h+r):(h=a,f=a),this.name==="pre-paginated"&&s>1&&(a=h),d=h*s+r,p=a,this.width=a,this.height=o,this.spreadWidth=d,this.pageWidth=f,this.delta=p,this.columnWidth=h,this.gap=r,this.divisor=s,this.update({width:a,height:o,spreadWidth:d,pageWidth:f,delta:p,columnWidth:h,gap:r,divisor:s})}format(e,t,i){var s;return this.name==="pre-paginated"?s=e.fit(this.columnWidth,this.height,t):this._flow==="paginated"?s=e.columns(this.width,this.height,this.columnWidth,this.gap,this.settings.direction):i&&i==="horizontal"?s=e.size(null,this.height):s=e.size(this.width,null),s}count(e,t){let i,s;return this.name==="pre-paginated"?(i=1,s=1):this._flow==="paginated"?(t=t||this.delta,i=Math.ceil(e/t),s=i*this.divisor):(t=t||this.height,i=Math.ceil(e/t),s=i),{spreads:i,pages:s}}update(e){if(Object.keys(e).forEach(t=>{this.props[t]===e[t]&&delete e[t]}),Object.keys(e).length>0){let t=Ii(this.props,e);this.emit(Ue.LAYOUT.UPDATED,t,e)}}}uo(P4.prototype);class iq{constructor(e){this.rendition=e,this._themes={default:{rules:{},url:"",serialized:""}},this._overrides={},this._current="default",this._injected=[],this.rendition.hooks.content.register(this.inject.bind(this)),this.rendition.hooks.content.register(this.overrides.bind(this))}register(){if(arguments.length!==0){if(arguments.length===1&&typeof arguments[0]=="object")return this.registerThemes(arguments[0]);if(arguments.length===1&&typeof arguments[0]=="string")return this.default(arguments[0]);if(arguments.length===2&&typeof arguments[1]=="string")return this.registerUrl(arguments[0],arguments[1]);if(arguments.length===2&&typeof arguments[1]=="object")return this.registerRules(arguments[0],arguments[1])}}default(e){if(e){if(typeof e=="string")return this.registerUrl("default",e);if(typeof e=="object")return this.registerRules("default",e)}}registerThemes(e){for(var t in e)e.hasOwnProperty(t)&&(typeof e[t]=="string"?this.registerUrl(t,e[t]):this.registerRules(t,e[t]))}registerCss(e,t){this._themes[e]={serialized:t},(this._injected[e]||e=="default")&&this.update(e)}registerUrl(e,t){var i=new Qr(t);this._themes[e]={url:i.toString()},(this._injected[e]||e=="default")&&this.update(e)}registerRules(e,t){this._themes[e]={rules:t},(this._injected[e]||e=="default")&&this.update(e)}select(e){var t=this._current,i;this._current=e,this.update(e),i=this.rendition.getContents(),i.forEach(s=>{s.removeClass(t),s.addClass(e)})}update(e){var t=this.rendition.getContents();t.forEach(i=>{this.add(e,i)})}inject(e){var t=[],i=this._themes,s;for(var r in i)i.hasOwnProperty(r)&&(r===this._current||r==="default")&&(s=i[r],(s.rules&&Object.keys(s.rules).length>0||s.url&&t.indexOf(s.url)===-1)&&this.add(r,e),this._injected.push(r));this._current!="default"&&e.addClass(this._current)}add(e,t){var i=this._themes[e];!i||!t||(i.url?t.addStylesheet(i.url):i.serialized?(t.addStylesheetCss(i.serialized,e),i.injected=!0):i.rules&&(t.addStylesheetRules(i.rules,e),i.injected=!0))}override(e,t,i){var s=this.rendition.getContents();this._overrides[e]={value:t,priority:i===!0},s.forEach(r=>{r.css(e,this._overrides[e].value,this._overrides[e].priority)})}removeOverride(e){var t=this.rendition.getContents();delete this._overrides[e],t.forEach(i=>{i.css(e)})}overrides(e){var t=this._overrides;for(var i in t)t.hasOwnProperty(i)&&e.css(i,t[i].value,t[i].priority)}fontSize(e){this.override("font-size",e)}font(e){this.override("font-family",e,!0)}destroy(){this.rendition=void 0,this._themes=void 0,this._overrides=void 0,this._current=void 0,this._injected=void 0}}class Zb{constructor(e,t,i,s=!1){this.layout=e,this.horizontal=i==="horizontal",this.direction=t||"ltr",this._dev=s}section(e){var t=this.findRanges(e),i=this.rangeListToCfiList(e.section.cfiBase,t);return i}page(e,t,i,s){var r=e&&e.document?e.document.body:!1,a;if(r){if(a=this.rangePairToCfiPair(t,{start:this.findStart(r,i,s),end:this.findEnd(r,i,s)}),this._dev===!0){let o=e.document,c=new jt(a.start).toRange(o),h=new jt(a.end).toRange(o),d=o.defaultView.getSelection(),f=o.createRange();d.removeAllRanges(),f.setStart(c.startContainer,c.startOffset),f.setEnd(h.endContainer,h.endOffset),d.addRange(f)}return a}}walk(e,t){if(!(e&&e.nodeType===Node.TEXT_NODE)){var i={acceptNode:function(c){return c.data.trim().length>0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}},s=i.acceptNode;s.acceptNode=i.acceptNode;for(var r=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,s,!1),a,o;(a=r.nextNode())&&(o=t(a),!o););return o}}findRanges(e){for(var t=[],i=e.contents.scrollWidth(),s=Math.ceil(i/this.layout.spreadWidth),r=s*this.layout.divisor,a=this.layout.columnWidth,o=this.layout.gap,c,h,d=0;d<r.pages;d++)c=(a+o)*d,h=a*(d+1)+o*d,t.push({start:this.findStart(e.document.body,c,h),end:this.findEnd(e.document.body,c,h)});return t}findStart(e,t,i){for(var s=[e],r,a,o=e;s.length;)if(r=s.shift(),a=this.walk(r,c=>{var h,d,f,p,g;if(g=aA(c),this.horizontal&&this.direction==="ltr"){if(h=this.horizontal?g.left:g.top,d=this.horizontal?g.right:g.bottom,h>=t&&h<=i)return c;if(d>t)return c;o=c,s.push(c)}else if(this.horizontal&&this.direction==="rtl"){if(h=g.left,d=g.right,d<=i&&d>=t)return c;if(h<i)return c;o=c,s.push(c)}else{if(f=g.top,p=g.bottom,f>=t&&f<=i)return c;if(p>t)return c;o=c,s.push(c)}}),a)return this.findTextStartRange(a,t,i);return this.findTextStartRange(o,t,i)}findEnd(e,t,i){for(var s=[e],r,a=e,o;s.length;)if(r=s.shift(),o=this.walk(r,c=>{var h,d,f,p,g;if(g=aA(c),this.horizontal&&this.direction==="ltr"){if(h=Math.round(g.left),d=Math.round(g.right),h>i&&a)return a;if(d>i)return c;a=c,s.push(c)}else if(this.horizontal&&this.direction==="rtl"){if(h=Math.round(this.horizontal?g.left:g.top),d=Math.round(this.horizontal?g.right:g.bottom),d<t&&a)return a;if(h<t)return c;a=c,s.push(c)}else{if(f=Math.round(g.top),p=Math.round(g.bottom),f>i&&a)return a;if(p>i)return c;a=c,s.push(c)}}),o)return this.findTextEndRange(o,t,i);return this.findTextEndRange(a,t,i)}findTextStartRange(e,t,i){for(var s=this.splitTextNodeIntoRanges(e),r,a,o,c,h,d=0;d<s.length;d++)if(r=s[d],a=r.getBoundingClientRect(),this.horizontal&&this.direction==="ltr"){if(o=a.left,o>=t)return r}else if(this.horizontal&&this.direction==="rtl"){if(h=a.right,h<=i)return r}else if(c=a.top,c>=t)return r;return s[0]}findTextEndRange(e,t,i){for(var s=this.splitTextNodeIntoRanges(e),r,a,o,c,h,d,f,p=0;p<s.length;p++){if(a=s[p],o=a.getBoundingClientRect(),this.horizontal&&this.direction==="ltr"){if(c=o.left,h=o.right,c>i&&r)return r;if(h>i)return a}else if(this.horizontal&&this.direction==="rtl"){if(c=o.left,h=o.right,h<t&&r)return r;if(c<t)return a}else{if(d=o.top,f=o.bottom,d>i&&r)return r;if(f>i)return a}r=a}return s[s.length-1]}splitTextNodeIntoRanges(e,t){var i=[],s=e.textContent||"",r=s.trim(),a,o=e.ownerDocument,c=t||" ",h=r.indexOf(c);if(h===-1||e.nodeType!=Node.TEXT_NODE)return a=o.createRange(),a.selectNodeContents(e),[a];for(a=o.createRange(),a.setStart(e,0),a.setEnd(e,h),i.push(a),a=!1;h!=-1;)h=r.indexOf(c,h+1),h>0&&(a&&(a.setEnd(e,h),i.push(a)),a=o.createRange(),a.setStart(e,h+1));return a&&(a.setEnd(e,r.length),i.push(a)),i}rangePairToCfiPair(e,t){var i=t.start,s=t.end;i.collapse(!0),s.collapse(!1);let r=new jt(i,e).toString(),a=new jt(s,e).toString();return{start:r,end:a}}rangeListToCfiList(e,t){for(var i=[],s,r=0;r<t.length;r++)s=this.rangePairToCfiPair(e,t[r]),i.push(s);return i}axis(e){return e&&(this.horizontal=e==="horizontal"),this.horizontal}}const I4=typeof navigator<"u",sq=I4&&/Chrome/.test(navigator.userAgent),IT=I4&&!sq&&/AppleWebKit/.test(navigator.userAgent),rq=1;class mN{constructor(e,t,i,s){this.epubcfi=new jt,this.document=e,this.documentElement=this.document.documentElement,this.content=t||this.document.body,this.window=this.document.defaultView,this._size={width:0,height:0},this.sectionIndex=s||0,this.cfiBase=i||"",this.epubReadingSystem("epub.js",hw),this.called=0,this.active=!0,this.listeners()}static get listenedEvents(){return Ev}width(e){var t=this.content;return e&&Mn(e)&&(e=e+"px"),e&&(t.style.width=e),parseInt(this.window.getComputedStyle(t).width)}height(e){var t=this.content;return e&&Mn(e)&&(e=e+"px"),e&&(t.style.height=e),parseInt(this.window.getComputedStyle(t).height)}contentWidth(e){var t=this.content||this.document.body;return e&&Mn(e)&&(e=e+"px"),e&&(t.style.width=e),parseInt(this.window.getComputedStyle(t).width)}contentHeight(e){var t=this.content||this.document.body;return e&&Mn(e)&&(e=e+"px"),e&&(t.style.height=e),parseInt(this.window.getComputedStyle(t).height)}textWidth(){let e,t,i=this.document.createRange(),s=this.content||this.document.body,r=Gb(s);return i.selectNodeContents(s),e=i.getBoundingClientRect(),t=e.width,r&&r.width&&(t+=r.width),Math.round(t)}textHeight(){let e,t,i=this.document.createRange(),s=this.content||this.document.body;return i.selectNodeContents(s),e=i.getBoundingClientRect(),t=e.bottom,Math.round(t)}scrollWidth(){var e=this.documentElement.scrollWidth;return e}scrollHeight(){var e=this.documentElement.scrollHeight;return e}overflow(e){return e&&(this.documentElement.style.overflow=e),this.window.getComputedStyle(this.documentElement).overflow}overflowX(e){return e&&(this.documentElement.style.overflowX=e),this.window.getComputedStyle(this.documentElement).overflowX}overflowY(e){return e&&(this.documentElement.style.overflowY=e),this.window.getComputedStyle(this.documentElement).overflowY}css(e,t,i){var s=this.content||this.document.body;return t?s.style.setProperty(e,t,i?"important":""):s.style.removeProperty(e),this.window.getComputedStyle(s)[e]}viewport(e){var t=this.document.querySelector("meta[name='viewport']"),i={width:void 0,height:void 0,scale:void 0,minimum:void 0,maximum:void 0,scalable:void 0},s=[],r={};if(t&&t.hasAttribute("content")){let a=t.getAttribute("content"),o=a.match(/width\s*=\s*([^,]*)/),c=a.match(/height\s*=\s*([^,]*)/),h=a.match(/initial-scale\s*=\s*([^,]*)/),d=a.match(/minimum-scale\s*=\s*([^,]*)/),f=a.match(/maximum-scale\s*=\s*([^,]*)/),p=a.match(/user-scalable\s*=\s*([^,]*)/);o&&o.length&&typeof o[1]<"u"&&(i.width=o[1]),c&&c.length&&typeof c[1]<"u"&&(i.height=c[1]),h&&h.length&&typeof h[1]<"u"&&(i.scale=h[1]),d&&d.length&&typeof d[1]<"u"&&(i.minimum=d[1]),f&&f.length&&typeof f[1]<"u"&&(i.maximum=f[1]),p&&p.length&&typeof p[1]<"u"&&(i.scalable=p[1])}return r=C4(e||{},i),e&&(r.width&&s.push("width="+r.width),r.height&&s.push("height="+r.height),r.scale&&s.push("initial-scale="+r.scale),r.scalable==="no"?(s.push("minimum-scale="+r.scale),s.push("maximum-scale="+r.scale),s.push("user-scalable="+r.scalable)):(r.scalable&&s.push("user-scalable="+r.scalable),r.minimum&&s.push("minimum-scale="+r.minimum),r.maximum&&s.push("minimum-scale="+r.maximum)),t||(t=this.document.createElement("meta"),t.setAttribute("name","viewport"),this.document.querySelector("head").appendChild(t)),t.setAttribute("content",s.join(", ")),this.window.scrollTo(0,0)),r}expand(){this.emit(Ue.CONTENTS.EXPAND)}listeners(){this.imageLoadListeners(),this.mediaQueryListeners(),this.addEventListeners(),this.addSelectionListeners(),typeof ResizeObserver>"u"?(this.resizeListeners(),this.visibilityListeners()):this.resizeObservers(),this.linksHandler()}removeListeners(){this.removeEventListeners(),this.removeSelectionListeners(),this.observer&&this.observer.disconnect(),clearTimeout(this.expanding)}resizeCheck(){let e=this.textWidth(),t=this.textHeight();(e!=this._size.width||t!=this._size.height)&&(this._size={width:e,height:t},this.onResize&&this.onResize(this._size),this.emit(Ue.CONTENTS.RESIZE,this._size))}resizeListeners(){clearTimeout(this.expanding),requestAnimationFrame(this.resizeCheck.bind(this)),this.expanding=setTimeout(this.resizeListeners.bind(this),350)}visibilityListeners(){document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&this.active===!1?(this.active=!0,this.resizeListeners()):(this.active=!1,clearTimeout(this.expanding))})}transitionListeners(){let e=this.content;e.style.transitionProperty="font, font-size, font-size-adjust, font-stretch, font-variation-settings, font-weight, width, height",e.style.transitionDuration="0.001ms",e.style.transitionTimingFunction="linear",e.style.transitionDelay="0",this._resizeCheck=this.resizeCheck.bind(this),this.document.addEventListener("transitionend",this._resizeCheck)}mediaQueryListeners(){for(var e=this.document.styleSheets,t=(function(o){o.matches&&!this._expanding&&setTimeout(this.expand.bind(this),1)}).bind(this),i=0;i<e.length;i+=1){var s;try{s=e[i].cssRules}catch{return}if(!s)return;for(var r=0;r<s.length;r+=1)if(s[r].media){var a=this.window.matchMedia(s[r].media.mediaText);a.addListener(t)}}}resizeObservers(){this.observer=new ResizeObserver(e=>{requestAnimationFrame(this.resizeCheck.bind(this))}),this.observer.observe(this.document.documentElement)}mutationObservers(){this.observer=new MutationObserver(t=>{this.resizeCheck()});let e={attributes:!0,childList:!0,characterData:!0,subtree:!0};this.observer.observe(this.document,e)}imageLoadListeners(){for(var e=this.document.querySelectorAll("img"),t,i=0;i<e.length;i++)t=e[i],typeof t.naturalWidth<"u"&&t.naturalWidth===0&&(t.onload=this.expand.bind(this))}fontLoadListeners(){!this.document||!this.document.fonts||this.document.fonts.ready.then((function(){this.resizeCheck()}).bind(this))}root(){return this.document?this.document.documentElement:null}locationOf(e,t){var i,s={left:0,top:0};if(!this.document)return s;if(this.epubcfi.isCfiString(e)){let r=new jt(e).toRange(this.document,t);if(r){try{if(!r.endContainer||r.startContainer==r.endContainer&&r.startOffset==r.endOffset){let a=r.startContainer.textContent.indexOf(" ",r.startOffset);a==-1&&(a=r.startContainer.textContent.length),r.setEnd(r.startContainer,a)}}catch(a){console.error("setting end offset to start container length failed",a)}if(r.startContainer.nodeType===Node.ELEMENT_NODE)i=r.startContainer.getBoundingClientRect(),s.left=i.left,s.top=i.top;else if(IT){let a=r.startContainer,o=new Range;try{a.nodeType===rq?i=a.getBoundingClientRect():r.startOffset+2<a.length?(o.setStart(a,r.startOffset),o.setEnd(a,r.startOffset+2),i=o.getBoundingClientRect()):r.startOffset-2>0?(o.setStart(a,r.startOffset-2),o.setEnd(a,r.startOffset),i=o.getBoundingClientRect()):i=a.parentNode.getBoundingClientRect()}catch(c){console.error(c,c.stack)}}else i=r.getBoundingClientRect()}}else if(typeof e=="string"&&e.indexOf("#")>-1){let r=e.substring(e.indexOf("#")+1),a=this.document.getElementById(r);if(a)if(IT){let o=new Range;o.selectNode(a),i=o.getBoundingClientRect()}else i=a.getBoundingClientRect()}return i&&(s.left=i.left,s.top=i.top),s}addStylesheet(e){return new Promise((function(t,i){var s,r=!1;if(!this.document){t(!1);return}if(s=this.document.querySelector("link[href='"+e+"']"),s){t(!0);return}s=this.document.createElement("link"),s.type="text/css",s.rel="stylesheet",s.href=e,s.onload=s.onreadystatechange=function(){!r&&(!this.readyState||this.readyState=="complete")&&(r=!0,setTimeout(()=>{t(!0)},1))},this.document.head.appendChild(s)}).bind(this))}_getStylesheetNode(e){var t;return e="epubjs-inserted-css-"+(e||""),this.document?(t=this.document.getElementById(e),t||(t=this.document.createElement("style"),t.id=e,this.document.head.appendChild(t)),t):!1}addStylesheetCss(e,t){if(!this.document||!e)return!1;var i;return i=this._getStylesheetNode(t),i.innerHTML=e,!0}addStylesheetRules(e,t){var i;if(!(!this.document||!e||e.length===0))if(i=this._getStylesheetNode(t).sheet,Object.prototype.toString.call(e)==="[object Array]")for(var s=0,r=e.length;s<r;s++){var a=1,o=e[s],c=e[s][0],h="";Object.prototype.toString.call(o[1][0])==="[object Array]"&&(o=o[1],a=0);for(var d=o.length;a<d;a++){var f=o[a];h+=f[0]+":"+f[1]+(f[2]?" !important":"")+`;
`}i.insertRule(c+"{"+h+"}",i.cssRules.length)}else Object.keys(e).forEach(g=>{const v=e[g];if(Array.isArray(v))v.forEach(b=>{const m=Object.keys(b).map(y=>`${y}:${b[y]}`).join(";");i.insertRule(`${g}{${m}}`,i.cssRules.length)});else{const x=Object.keys(v).map(m=>`${m}:${v[m]}`).join(";");i.insertRule(`${g}{${x}}`,i.cssRules.length)}})}addScript(e){return new Promise((function(t,i){var s,r=!1;if(!this.document){t(!1);return}s=this.document.createElement("script"),s.type="text/javascript",s.async=!0,s.src=e,s.onload=s.onreadystatechange=function(){!r&&(!this.readyState||this.readyState=="complete")&&(r=!0,setTimeout(function(){t(!0)},1))},this.document.head.appendChild(s)}).bind(this))}addClass(e){var t;this.document&&(t=this.content||this.document.body,t&&t.classList.add(e))}removeClass(e){var t;this.document&&(t=this.content||this.document.body,t&&t.classList.remove(e))}addEventListeners(){this.document&&(this._triggerEvent=this.triggerEvent.bind(this),Ev.forEach(function(e){this.document.addEventListener(e,this._triggerEvent,{passive:!0})},this))}removeEventListeners(){this.document&&(Ev.forEach(function(e){this.document.removeEventListener(e,this._triggerEvent,{passive:!0})},this),this._triggerEvent=void 0)}triggerEvent(e){this.emit(e.type,e)}addSelectionListeners(){this.document&&(this._onSelectionChange=this.onSelectionChange.bind(this),this.document.addEventListener("selectionchange",this._onSelectionChange,{passive:!0}))}removeSelectionListeners(){this.document&&(this.document.removeEventListener("selectionchange",this._onSelectionChange,{passive:!0}),this._onSelectionChange=void 0)}onSelectionChange(e){this.selectionEndTimeout&&clearTimeout(this.selectionEndTimeout),this.selectionEndTimeout=setTimeout((function(){var t=this.window.getSelection();this.triggerSelectedEvent(t)}).bind(this),250)}triggerSelectedEvent(e){var t,i;e&&e.rangeCount>0&&(t=e.getRangeAt(0),t.collapsed||(i=new jt(t,this.cfiBase).toString(),this.emit(Ue.CONTENTS.SELECTED,i),this.emit(Ue.CONTENTS.SELECTED_RANGE,t)))}range(e,t){var i=new jt(e);return i.toRange(this.document,t)}cfiFromRange(e,t){return new jt(e,this.cfiBase,t).toString()}cfiFromNode(e,t){return new jt(e,this.cfiBase,t).toString()}map(e){var t=new Zb(e);return t.section()}size(e,t){var i={scale:1,scalable:"no"};this.layoutStyle("scrolling"),e>=0&&(this.width(e),i.width=e,this.css("padding","0 "+e/12+"px")),t>=0&&(this.height(t),i.height=t),this.css("margin","0"),this.css("box-sizing","border-box"),this.viewport(i)}columns(e,t,i,s,r){let a=jd("column-axis"),o=jd("column-gap"),c=jd("column-width"),h=jd("column-fill"),f=this.writingMode().indexOf("vertical")===0?"vertical":"horizontal";this.layoutStyle("paginated"),r==="rtl"&&f==="horizontal"&&this.direction(r),this.width(e),this.height(t),this.viewport({width:e,height:t,scale:1,scalable:"no"}),this.css("overflow-y","hidden"),this.css("margin","0",!0),f==="vertical"?(this.css("padding-top",s/2+"px",!0),this.css("padding-bottom",s/2+"px",!0),this.css("padding-left","20px"),this.css("padding-right","20px"),this.css(a,"vertical")):(this.css("padding-top","20px"),this.css("padding-bottom","20px"),this.css("padding-left",s/2+"px",!0),this.css("padding-right",s/2+"px",!0),this.css(a,"horizontal")),this.css("box-sizing","border-box"),this.css("max-width","inherit"),this.css(h,"auto"),this.css(o,s+"px"),this.css(c,i+"px"),this.css("-webkit-line-box-contain","block glyphs replaced")}scaler(e,t,i){var s="scale("+e+")",r="";this.css("transform-origin","top left"),(t>=0||i>=0)&&(r=" translate("+(t||0)+"px, "+(i||0)+"px )"),this.css("transform",s+r)}fit(e,t,i){var s=this.viewport(),r=parseInt(s.width),a=parseInt(s.height),o=e/r,c=t/a,h=o<c?o:c;if(this.layoutStyle("paginated"),this.width(r),this.height(a),this.overflow("hidden"),this.scaler(h,0,0),this.css("background-size",r*h+"px "+a*h+"px"),this.css("background-color","transparent"),i&&i.properties.includes("page-spread-left")){var d=e-r*h;this.css("margin-left",d+"px")}}direction(e){this.documentElement&&(this.documentElement.style.direction=e)}mapPage(e,t,i,s,r){var a=new Zb(t,r);return a.page(this,e,i,s)}linksHandler(){X$(this.content,e=>{this.emit(Ue.CONTENTS.LINK_CLICKED,e)})}writingMode(e){let t=jd("writing-mode");return e&&this.documentElement&&(this.documentElement.style[t]=e),this.window.getComputedStyle(this.documentElement)[t]||""}layoutStyle(e){return e&&(this._layoutStyle=e,navigator.epubReadingSystem.layoutStyle=this._layoutStyle),this._layoutStyle||"paginated"}epubReadingSystem(e,t){return navigator.epubReadingSystem={name:e,version:t,layoutStyle:this.layoutStyle(),hasFeature:function(i){switch(i){case"dom-manipulation":return!0;case"layout-changes":return!0;case"touch-events":return!0;case"mouse-events":return!0;case"keyboard-events":return!0;case"spine-scripting":return!1;default:return!1}}},navigator.epubReadingSystem}destroy(){this.removeListeners()}}uo(mN.prototype);class aq{constructor(e){this.rendition=e,this.highlights=[],this.underlines=[],this.marks=[],this._annotations={},this._annotationsBySectionIndex={},this.rendition.hooks.render.register(this.inject.bind(this)),this.rendition.hooks.unloaded.register(this.clear.bind(this))}add(e,t,i,s,r,a){let o=encodeURI(t+e),h=new jt(t).spinePos,d=new B4({type:e,cfiRange:t,data:i,sectionIndex:h,cb:s,className:r,styles:a});return this._annotations[o]=d,h in this._annotationsBySectionIndex?this._annotationsBySectionIndex[h].push(o):this._annotationsBySectionIndex[h]=[o],this.rendition.views().forEach(p=>{d.sectionIndex===p.index&&d.attach(p)}),d}remove(e,t){let i=encodeURI(e+t);if(i in this._annotations){let s=this._annotations[i];if(t&&s.type!==t)return;this.rendition.views().forEach(a=>{this._removeFromAnnotationBySectionIndex(s.sectionIndex,i),s.sectionIndex===a.index&&s.detach(a)}),delete this._annotations[i]}}_removeFromAnnotationBySectionIndex(e,t){this._annotationsBySectionIndex[e]=this._annotationsAt(e).filter(i=>i!==t)}_annotationsAt(e){return this._annotationsBySectionIndex[e]}highlight(e,t,i,s,r){return this.add("highlight",e,t,i,s,r)}underline(e,t,i,s,r){return this.add("underline",e,t,i,s,r)}mark(e,t,i){return this.add("mark",e,t,i)}each(){return this._annotations.forEach.apply(this._annotations,arguments)}inject(e){let t=e.index;t in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[t].forEach(s=>{this._annotations[s].attach(e)})}clear(e){let t=e.index;t in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[t].forEach(s=>{this._annotations[s].detach(e)})}show(){}hide(){}}class B4{constructor({type:e,cfiRange:t,data:i,sectionIndex:s,cb:r,className:a,styles:o}){this.type=e,this.cfiRange=t,this.data=i,this.sectionIndex=s,this.mark=void 0,this.cb=r,this.className=a,this.styles=o}update(e){this.data=e}attach(e){let{cfiRange:t,data:i,type:s,mark:r,cb:a,className:o,styles:c}=this,h;return s==="highlight"?h=e.highlight(t,i,a,o,c):s==="underline"?h=e.underline(t,i,a,o,c):s==="mark"&&(h=e.mark(t,i,a)),this.mark=h,this.emit(Ue.ANNOTATION.ATTACH,h),h}detach(e){let{cfiRange:t,type:i}=this,s;return e&&(i==="highlight"?s=e.unhighlight(t):i==="underline"?s=e.ununderline(t):i==="mark"&&(s=e.unmark(t))),this.mark=void 0,this.emit(Ue.ANNOTATION.DETACH,s),s}text(){}}uo(B4.prototype);var hl={},dw={};Object.defineProperty(dw,"__esModule",{value:!0});dw.createElement=z4;function z4(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}dw.default={createElement:z4};var by={};Object.defineProperty(by,"__esModule",{value:!0});by.proxyMouse=F4;by.clone=U4;by.default={proxyMouse:F4};function F4(n,e){function t(a){for(var o=e.length-1;o>=0;o--){var c=e[o],h=a.clientX,d=a.clientY;if(a.touches&&a.touches.length&&(h=a.touches[0].clientX,d=a.touches[0].clientY),!!oq(c,n,h,d)){c.dispatchEvent(U4(a));break}}}if(n.nodeName==="iframe"||n.nodeName==="IFRAME")try{this.target=n.contentDocument}catch{this.target=n}else this.target=n;for(var i=["mouseup","mousedown","click","touchstart"],s=0;s<i.length;s++){var r=i[s];this.target.addEventListener(r,function(a){return t(a)},!1)}}function U4(n){var e=Object.assign({},n,{bubbles:!1});try{return new MouseEvent(n.type,e)}catch{var t=document.createEvent("MouseEvents");return t.initMouseEvent(n.type,!1,e.cancelable,e.view,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget),t}}function oq(n,e,t,i){var s=e.getBoundingClientRect();function r(d,f,p){var g=d.top-s.top,v=d.left-s.left,b=g+d.height,x=v+d.width;return g<=p&&v<=f&&b>p&&x>f}var a=n.getBoundingClientRect();if(!r(a,t,i))return!1;for(var o=n.getClientRects(),c=0,h=o.length;c<h;c++)if(r(o[c],t,i))return!0;return!1}var Qb,xN;Object.defineProperty(hl,"__esModule",{value:!0});var H4=hl.Underline=xN=hl.Highlight=hl.Mark=Qb=hl.Pane=void 0,lq=function n(e,t,i){e===null&&(e=Function.prototype);var s=Object.getOwnPropertyDescriptor(e,t);if(s===void 0){var r=Object.getPrototypeOf(e);return r===null?void 0:n(r,t,i)}else{if("value"in s)return s.value;var a=s.get;return a===void 0?void 0:a.call(i)}},fw=function(){function n(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}}(),cq=dw,e0=$4(cq),uq=by,hq=$4(uq);function $4(n){return n&&n.__esModule?n:{default:n}}function q4(n,e){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:n}function V4(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(n,e):n.__proto__=e)}function pw(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}Qb=hl.Pane=function(){function n(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document.body;pw(this,n),this.target=e,this.element=e0.default.createElement("svg"),this.marks=[],this.element.style.position="absolute",this.element.setAttribute("pointer-events","none"),hq.default.proxyMouse(this.target,this.marks),this.container=t,this.container.appendChild(this.element),this.render()}return fw(n,[{key:"addMark",value:function(t){var i=e0.default.createElement("g");return this.element.appendChild(i),t.bind(i,this.container),this.marks.push(t),t.render(),t}},{key:"removeMark",value:function(t){var i=this.marks.indexOf(t);if(i!==-1){var s=t.unbind();this.element.removeChild(s),this.marks.splice(i,1)}}},{key:"render",value:function(){gq(this.element,pq(this.target,this.container));var t=!0,i=!1,s=void 0;try{for(var r=this.marks[Symbol.iterator](),a;!(t=(a=r.next()).done);t=!0){var o=a.value;o.render()}}catch(c){i=!0,s=c}finally{try{!t&&r.return&&r.return()}finally{if(i)throw s}}}}]),n}();var dq=hl.Mark=function(){function n(){pw(this,n),this.element=null}return fw(n,[{key:"bind",value:function(t,i){this.element=t,this.container=i}},{key:"unbind",value:function(){var t=this.element;return this.element=null,t}},{key:"render",value:function(){}},{key:"dispatchEvent",value:function(t){this.element&&this.element.dispatchEvent(t)}},{key:"getBoundingClientRect",value:function(){return this.element.getBoundingClientRect()}},{key:"getClientRects",value:function(){for(var t=[],i=this.element.firstChild;i;)t.push(i.getBoundingClientRect()),i=i.nextSibling;return t}},{key:"filteredRanges",value:function(){var t=Array.from(this.range.getClientRects());return t.filter(function(i){for(var s=0;s<t.length;s++){if(t[s]===i)return!0;var r=mq(t[s],i);if(r)return!1}return!0})}}]),n}(),fq=xN=hl.Highlight=function(n){V4(e,n);function e(t,i,s,r){pw(this,e);var a=q4(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return a.range=t,a.className=i,a.data=s||{},a.attributes=r||{},a}return fw(e,[{key:"bind",value:function(i,s){lq(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"bind",this).call(this,i,s);for(var r in this.data)this.data.hasOwnProperty(r)&&(this.element.dataset[r]=this.data[r]);for(var r in this.attributes)this.attributes.hasOwnProperty(r)&&this.element.setAttribute(r,this.attributes[r]);this.className&&this.element.classList.add(this.className)}},{key:"render",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var i=this.element.ownerDocument.createDocumentFragment(),s=this.filteredRanges(),r=this.element.getBoundingClientRect(),a=this.container.getBoundingClientRect(),o=0,c=s.length;o<c;o++){var h=s[o],d=e0.default.createElement("rect");d.setAttribute("x",h.left-r.left+a.left),d.setAttribute("y",h.top-r.top+a.top),d.setAttribute("height",h.height),d.setAttribute("width",h.width),i.appendChild(d)}this.element.appendChild(i)}}]),e}(dq);H4=hl.Underline=function(n){V4(e,n);function e(t,i,s,r){return pw(this,e),q4(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,s,r))}return fw(e,[{key:"render",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var i=this.element.ownerDocument.createDocumentFragment(),s=this.filteredRanges(),r=this.element.getBoundingClientRect(),a=this.container.getBoundingClientRect(),o=0,c=s.length;o<c;o++){var h=s[o],d=e0.default.createElement("rect");d.setAttribute("x",h.left-r.left+a.left),d.setAttribute("y",h.top-r.top+a.top),d.setAttribute("height",h.height),d.setAttribute("width",h.width),d.setAttribute("fill","none");var f=e0.default.createElement("line");f.setAttribute("x1",h.left-r.left+a.left),f.setAttribute("x2",h.left-r.left+a.left+h.width),f.setAttribute("y1",h.top-r.top+a.top+h.height-1),f.setAttribute("y2",h.top-r.top+a.top+h.height-1),f.setAttribute("stroke-width",1),f.setAttribute("stroke","black"),f.setAttribute("stroke-linecap","square"),i.appendChild(d),i.appendChild(f)}this.element.appendChild(i)}}]),e}(fq);function pq(n,e){var t=e.getBoundingClientRect(),i=n.getBoundingClientRect();return{top:i.top-t.top,left:i.left-t.left,height:n.scrollHeight,width:n.scrollWidth}}function gq(n,e){n.style.setProperty("top",e.top+"px","important"),n.style.setProperty("left",e.left+"px","important"),n.style.setProperty("height",e.height+"px","important"),n.style.setProperty("width",e.width+"px","important")}function mq(n,e){return e.right<=n.right&&e.left>=n.left&&e.top>=n.top&&e.bottom<=n.bottom}class G4{constructor(e,t){this.settings=Ii({ignoreClass:"",axis:void 0,direction:void 0,width:0,height:0,layout:void 0,globalLayoutProperties:{},method:void 0,forceRight:!1,allowScriptedContent:!1,allowPopups:!1},t||{}),this.id="epubjs-view-"+uw(),this.section=e,this.index=e.index,this.element=this.container(this.settings.axis),this.added=!1,this.displayed=!1,this.rendered=!1,this.fixedWidth=0,this.fixedHeight=0,this.epubcfi=new jt,this.layout=this.settings.layout,this.pane=void 0,this.highlights={},this.underlines={},this.marks={}}container(e){var t=document.createElement("div");return t.classList.add("epub-view"),t.style.height="0px",t.style.width="0px",t.style.overflow="hidden",t.style.position="relative",t.style.display="block",e&&e=="horizontal"?t.style.flex="none":t.style.flex="initial",t}create(){return this.iframe?this.iframe:(this.element||(this.element=this.createContainer()),this.iframe=document.createElement("iframe"),this.iframe.id=this.id,this.iframe.scrolling="no",this.iframe.style.overflow="hidden",this.iframe.seamless="seamless",this.iframe.style.border="none",this.iframe.sandbox="allow-same-origin",this.settings.allowScriptedContent&&(this.iframe.sandbox+=" allow-scripts"),this.settings.allowPopups&&(this.iframe.sandbox+=" allow-popups"),this.iframe.setAttribute("enable-annotation","true"),this.resizing=!0,this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this.element.setAttribute("ref",this.index),this.added=!0,this.elementBounds=Sv(this.element),"srcdoc"in this.iframe?this.supportsSrcdoc=!0:this.supportsSrcdoc=!1,this.settings.method||(this.settings.method=this.supportsSrcdoc?"srcdoc":"write"),this.iframe)}render(e,t){return this.create(),this.size(),this.sectionRender||(this.sectionRender=this.section.render(e)),this.sectionRender.then((function(i){return this.load(i)}).bind(this)).then((function(){let i=this.contents.writingMode(),s;return this.settings.flow==="scrolled"?s=i.indexOf("vertical")===0?"horizontal":"vertical":s=i.indexOf("vertical")===0?"vertical":"horizontal",i.indexOf("vertical")===0&&this.settings.flow==="paginated"&&(this.layout.delta=this.layout.height),this.setAxis(s),this.emit(Ue.VIEWS.AXIS,s),this.setWritingMode(i),this.emit(Ue.VIEWS.WRITING_MODE,i),this.layout.format(this.contents,this.section,this.axis),this.addListeners(),new Promise((r,a)=>{this.expand(),this.settings.forceRight&&(this.element.style.marginLeft=this.width()+"px"),r()})}).bind(this),(function(i){return this.emit(Ue.VIEWS.LOAD_ERROR,i),new Promise((s,r)=>{r(i)})}).bind(this)).then((function(){this.emit(Ue.VIEWS.RENDERED,this.section)}).bind(this))}reset(){this.iframe&&(this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this._textWidth=void 0,this._contentWidth=void 0,this._textHeight=void 0,this._contentHeight=void 0),this._needsReframe=!0}size(e,t){var i=e||this.settings.width,s=t||this.settings.height;this.layout.name==="pre-paginated"?this.lock("both",i,s):this.settings.axis==="horizontal"?this.lock("height",i,s):this.lock("width",i,s),this.settings.width=i,this.settings.height=s}lock(e,t,i){var s=Gb(this.element),r;this.iframe?r=Gb(this.iframe):r={width:0,height:0},e=="width"&&Mn(t)&&(this.lockedWidth=t-s.width-r.width),e=="height"&&Mn(i)&&(this.lockedHeight=i-s.height-r.height),e==="both"&&Mn(t)&&Mn(i)&&(this.lockedWidth=t-s.width-r.width,this.lockedHeight=i-s.height-r.height),this.displayed&&this.iframe&&this.expand()}expand(e){var t=this.lockedWidth,i=this.lockedHeight,s;!this.iframe||this._expanding||(this._expanding=!0,this.layout.name==="pre-paginated"?(t=this.layout.columnWidth,i=this.layout.height):this.settings.axis==="horizontal"?(t=this.contents.textWidth(),t%this.layout.pageWidth>0&&(t=Math.ceil(t/this.layout.pageWidth)*this.layout.pageWidth),this.settings.forceEvenPages&&(s=t/this.layout.pageWidth,this.layout.divisor>1&&this.layout.name==="reflowable"&&s%2>0&&(t+=this.layout.pageWidth))):this.settings.axis==="vertical"&&(i=this.contents.textHeight(),this.settings.flow==="paginated"&&i%this.layout.height>0&&(i=Math.ceil(i/this.layout.height)*this.layout.height)),(this._needsReframe||t!=this._width||i!=this._height)&&this.reframe(t,i),this._expanding=!1)}reframe(e,t){var i;Mn(e)&&(this.element.style.width=e+"px",this.iframe.style.width=e+"px",this._width=e),Mn(t)&&(this.element.style.height=t+"px",this.iframe.style.height=t+"px",this._height=t);let s=this.prevBounds?e-this.prevBounds.width:e,r=this.prevBounds?t-this.prevBounds.height:t;i={width:e,height:t,widthDelta:s,heightDelta:r},this.pane&&this.pane.render(),requestAnimationFrame(()=>{let a;for(let o in this.marks)this.marks.hasOwnProperty(o)&&(a=this.marks[o],this.placeMark(a.element,a.range))}),this.onResize(this,i),this.emit(Ue.VIEWS.RESIZED,i),this.prevBounds=i,this.elementBounds=Sv(this.element)}load(e){var t=new Dt,i=t.promise;if(!this.iframe)return t.reject(new Error("No Iframe Available")),i;if(this.iframe.onload=(function(r){this.onLoad(r,t)}).bind(this),this.settings.method==="blobUrl")this.blobUrl=Yb(e,"application/xhtml+xml"),this.iframe.src=this.blobUrl,this.element.appendChild(this.iframe);else if(this.settings.method==="srcdoc")this.iframe.srcdoc=e,this.element.appendChild(this.iframe);else{if(this.element.appendChild(this.iframe),this.document=this.iframe.contentDocument,!this.document)return t.reject(new Error("No Document Available")),i;if(this.iframe.contentDocument.open(),window.MSApp&&MSApp.execUnsafeLocalFunction){var s=this;MSApp.execUnsafeLocalFunction(function(){s.iframe.contentDocument.write(e)})}else this.iframe.contentDocument.write(e);this.iframe.contentDocument.close()}return i}onLoad(e,t){this.window=this.iframe.contentWindow,this.document=this.iframe.contentDocument,this.contents=new mN(this.document,this.document.body,this.section.cfiBase,this.section.index),this.rendering=!1;var i=this.document.querySelector("link[rel='canonical']");i?i.setAttribute("href",this.section.canonical):(i=this.document.createElement("link"),i.setAttribute("rel","canonical"),i.setAttribute("href",this.section.canonical),this.document.querySelector("head").appendChild(i)),this.contents.on(Ue.CONTENTS.EXPAND,()=>{this.displayed&&this.iframe&&(this.expand(),this.contents&&this.layout.format(this.contents))}),this.contents.on(Ue.CONTENTS.RESIZE,s=>{this.displayed&&this.iframe&&(this.expand(),this.contents&&this.layout.format(this.contents))}),t.resolve(this.contents)}setLayout(e){this.layout=e,this.contents&&(this.layout.format(this.contents),this.expand())}setAxis(e){this.settings.axis=e,e=="horizontal"?this.element.style.flex="none":this.element.style.flex="initial",this.size()}setWritingMode(e){this.writingMode=e}addListeners(){}removeListeners(e){}display(e){var t=new Dt;return this.displayed?t.resolve(this):this.render(e).then((function(){this.emit(Ue.VIEWS.DISPLAYED,this),this.onDisplayed(this),this.displayed=!0,t.resolve(this)}).bind(this),function(i){t.reject(i,this)}),t.promise}show(){this.element.style.visibility="visible",this.iframe&&(this.iframe.style.visibility="visible",this.iframe.style.transform="translateZ(0)",this.iframe.offsetWidth,this.iframe.style.transform=null),this.emit(Ue.VIEWS.SHOWN,this)}hide(){this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.stopExpanding=!0,this.emit(Ue.VIEWS.HIDDEN,this)}offset(){return{top:this.element.offsetTop,left:this.element.offsetLeft}}width(){return this._width}height(){return this._height}position(){return this.element.getBoundingClientRect()}locationOf(e){this.iframe.getBoundingClientRect();var t=this.contents.locationOf(e,this.settings.ignoreClass);return{left:t.left,top:t.top}}onDisplayed(e){}onResize(e,t){}bounds(e){return(e||!this.elementBounds)&&(this.elementBounds=Sv(this.element)),this.elementBounds}highlight(e,t={},i,s="epubjs-hl",r={}){if(!this.contents)return;const a=Object.assign({fill:"yellow","fill-opacity":"0.3","mix-blend-mode":"multiply"},r);let o=this.contents.range(e),c=()=>{this.emit(Ue.VIEWS.MARK_CLICKED,e,t)};t.epubcfi=e,this.pane||(this.pane=new Qb(this.iframe,this.element));let h=new xN(o,s,t,a),d=this.pane.addMark(h);return this.highlights[e]={mark:d,element:d.element,listeners:[c,i]},d.element.setAttribute("ref",s),d.element.addEventListener("click",c),d.element.addEventListener("touchstart",c),i&&(d.element.addEventListener("click",i),d.element.addEventListener("touchstart",i)),d}underline(e,t={},i,s="epubjs-ul",r={}){if(!this.contents)return;const a=Object.assign({stroke:"black","stroke-opacity":"0.3","mix-blend-mode":"multiply"},r);let o=this.contents.range(e),c=()=>{this.emit(Ue.VIEWS.MARK_CLICKED,e,t)};t.epubcfi=e,this.pane||(this.pane=new Qb(this.iframe,this.element));let h=new H4(o,s,t,a),d=this.pane.addMark(h);return this.underlines[e]={mark:d,element:d.element,listeners:[c,i]},d.element.setAttribute("ref",s),d.element.addEventListener("click",c),d.element.addEventListener("touchstart",c),i&&(d.element.addEventListener("click",i),d.element.addEventListener("touchstart",i)),d}mark(e,t={},i){if(!this.contents)return;if(e in this.marks)return this.marks[e];let s=this.contents.range(e);if(!s)return;let r=s.commonAncestorContainer,a=r.nodeType===1?r:r.parentNode,o=h=>{this.emit(Ue.VIEWS.MARK_CLICKED,e,t)};s.collapsed&&r.nodeType===1?(s=new Range,s.selectNodeContents(r)):s.collapsed&&(s=new Range,s.selectNodeContents(a));let c=this.document.createElement("a");return c.setAttribute("ref","epubjs-mk"),c.style.position="absolute",c.dataset.epubcfi=e,t&&Object.keys(t).forEach(h=>{c.dataset[h]=t[h]}),i&&(c.addEventListener("click",i),c.addEventListener("touchstart",i)),c.addEventListener("click",o),c.addEventListener("touchstart",o),this.placeMark(c,s),this.element.appendChild(c),this.marks[e]={element:c,range:s,listeners:[o,i]},a}placeMark(e,t){let i,s,r;if(this.layout.name==="pre-paginated"||this.settings.axis!=="horizontal"){let o=t.getBoundingClientRect();i=o.top,s=o.right}else{let o=t.getClientRects(),c;for(var a=0;a!=o.length;a++)c=o[a],(!r||c.left<r)&&(r=c.left,s=Math.ceil(r/this.layout.props.pageWidth)*this.layout.props.pageWidth-this.layout.gap/2,i=c.top)}e.style.top=`${i}px`,e.style.left=`${s}px`}unhighlight(e){let t;e in this.highlights&&(t=this.highlights[e],this.pane.removeMark(t.mark),t.listeners.forEach(i=>{i&&(t.element.removeEventListener("click",i),t.element.removeEventListener("touchstart",i))}),delete this.highlights[e])}ununderline(e){let t;e in this.underlines&&(t=this.underlines[e],this.pane.removeMark(t.mark),t.listeners.forEach(i=>{i&&(t.element.removeEventListener("click",i),t.element.removeEventListener("touchstart",i))}),delete this.underlines[e])}unmark(e){let t;e in this.marks&&(t=this.marks[e],this.element.removeChild(t.element),t.listeners.forEach(i=>{i&&(t.element.removeEventListener("click",i),t.element.removeEventListener("touchstart",i))}),delete this.marks[e])}destroy(){for(let e in this.highlights)this.unhighlight(e);for(let e in this.underlines)this.ununderline(e);for(let e in this.marks)this.unmark(e);this.blobUrl&&k4(this.blobUrl),this.displayed&&(this.displayed=!1,this.removeListeners(),this.contents.destroy(),this.stopExpanding=!0,this.element.removeChild(this.iframe),this.pane&&(this.pane.element.remove(),this.pane=void 0),this.iframe=void 0,this.contents=void 0,this._textWidth=null,this._textHeight=null,this._width=null,this._height=null)}}uo(G4.prototype);function xq(){var n="reverse",e=yq();return document.body.appendChild(e),e.scrollLeft>0?n="default":typeof Element<"u"&&Element.prototype.scrollIntoView?(e.children[0].children[1].scrollIntoView(),e.scrollLeft<0&&(n="negative")):(e.scrollLeft=1,e.scrollLeft===0&&(n="negative")),document.body.removeChild(e),n}function yq(){var n=document.createElement("div");n.dir="rtl",n.style.position="fixed",n.style.width="1px",n.style.height="1px",n.style.top="0px",n.style.left="0px",n.style.overflow="hidden";var e=document.createElement("div");e.style.width="2px";var t=document.createElement("span");t.style.width="1px",t.style.display="inline-block";var i=document.createElement("span");return i.style.width="1px",i.style.display="inline-block",e.appendChild(t),e.appendChild(i),n.appendChild(e),n}function vq(n){var e=typeof n;return n!=null&&(e=="object"||e=="function")}var yN=vq,bq=typeof zr=="object"&&zr&&zr.Object===Object&&zr,wq=bq,Sq=wq,Aq=typeof self=="object"&&self&&self.Object===Object&&self,Eq=Sq||Aq||Function("return this")(),W4=Eq,Cq=W4,Nq=function(){return Cq.Date.now()},_q=Nq,kq=/\s/;function Tq(n){for(var e=n.length;e--&&kq.test(n.charAt(e)););return e}var Dq=Tq,jq=Dq,Rq=/^\s+/;function Lq(n){return n&&n.slice(0,jq(n)+1).replace(Rq,"")}var Mq=Lq,Oq=W4,Pq=Oq.Symbol,Y4=Pq,BT=Y4,X4=Object.prototype,Iq=X4.hasOwnProperty,Bq=X4.toString,Ig=BT?BT.toStringTag:void 0;function zq(n){var e=Iq.call(n,Ig),t=n[Ig];try{n[Ig]=void 0;var i=!0}catch{}var s=Bq.call(n);return i&&(e?n[Ig]=t:delete n[Ig]),s}var Fq=zq,Uq=Object.prototype,Hq=Uq.toString;function $q(n){return Hq.call(n)}var qq=$q,zT=Y4,Vq=Fq,Gq=qq,Wq="[object Null]",Yq="[object Undefined]",FT=zT?zT.toStringTag:void 0;function Xq(n){return n==null?n===void 0?Yq:Wq:FT&&FT in Object(n)?Vq(n):Gq(n)}var Kq=Xq;function Zq(n){return n!=null&&typeof n=="object"}var Qq=Zq,Jq=Kq,eV=Qq,tV="[object Symbol]";function nV(n){return typeof n=="symbol"||eV(n)&&Jq(n)==tV}var iV=nV,sV=Mq,UT=yN,rV=iV,HT=NaN,aV=/^[-+]0x[0-9a-f]+$/i,oV=/^0b[01]+$/i,lV=/^0o[0-7]+$/i,cV=parseInt;function uV(n){if(typeof n=="number")return n;if(rV(n))return HT;if(UT(n)){var e=typeof n.valueOf=="function"?n.valueOf():n;n=UT(e)?e+"":e}if(typeof n!="string")return n===0?n:+n;n=sV(n);var t=oV.test(n);return t||lV.test(n)?cV(n.slice(2),t?2:8):aV.test(n)?HT:+n}var hV=uV,dV=yN,M2=_q,$T=hV,fV="Expected a function",pV=Math.max,gV=Math.min;function mV(n,e,t){var i,s,r,a,o,c,h=0,d=!1,f=!1,p=!0;if(typeof n!="function")throw new TypeError(fV);e=$T(e)||0,dV(t)&&(d=!!t.leading,f="maxWait"in t,r=f?pV($T(t.maxWait)||0,e):r,p="trailing"in t?!!t.trailing:p);function g(_){var T=i,j=s;return i=s=void 0,h=_,a=n.apply(j,T),a}function v(_){return h=_,o=setTimeout(m,e),d?g(_):a}function b(_){var T=_-c,j=_-h,M=e-T;return f?gV(M,r-j):M}function x(_){var T=_-c,j=_-h;return c===void 0||T>=e||T<0||f&&j>=r}function m(){var _=M2();if(x(_))return y(_);o=setTimeout(m,b(_))}function y(_){return o=void 0,p&&i?g(_):(i=s=void 0,a)}function w(){o!==void 0&&clearTimeout(o),h=0,i=c=s=o=void 0}function E(){return o===void 0?a:y(M2())}function S(){var _=M2(),T=x(_);if(i=arguments,s=this,c=_,T){if(o===void 0)return v(c);if(f)return clearTimeout(o),o=setTimeout(m,e),g(c)}return o===void 0&&(o=setTimeout(m,e)),a}return S.cancel=w,S.flush=E,S}var K4=mV;const xV=ed(K4);var yV=K4,vV=yN,bV="Expected a function";function wV(n,e,t){var i=!0,s=!0;if(typeof n!="function")throw new TypeError(bV);return vV(t)&&(i="leading"in t?!!t.leading:i,s="trailing"in t?!!t.trailing:s),yV(n,e,{leading:i,maxWait:e,trailing:s})}var SV=wV;const AV=ed(SV);class EV{constructor(e){this.settings=e||{},this.id="epubjs-container-"+uw(),this.container=this.create(this.settings),this.settings.hidden&&(this.wrapper=this.wrap(this.container))}create(e){let t=e.height,i=e.width,s=e.overflow||!1,r=e.axis||"vertical",a=e.direction;Ii(this.settings,e),e.height&&Mn(e.height)&&(t=e.height+"px"),e.width&&Mn(e.width)&&(i=e.width+"px");let o=document.createElement("div");return o.id=this.id,o.classList.add("epub-container"),o.style.wordSpacing="0",o.style.lineHeight="0",o.style.verticalAlign="top",o.style.position="relative",r==="horizontal"&&(o.style.display="flex",o.style.flexDirection="row",o.style.flexWrap="nowrap"),i&&(o.style.width=i),t&&(o.style.height=t),s&&(s==="scroll"&&r==="vertical"?(o.style["overflow-y"]=s,o.style["overflow-x"]="hidden"):s==="scroll"&&r==="horizontal"?(o.style["overflow-y"]="hidden",o.style["overflow-x"]=s):o.style.overflow=s),a&&(o.dir=a,o.style.direction=a),a&&this.settings.fullsize&&(document.body.style.direction=a),o}wrap(e){var t=document.createElement("div");return t.style.visibility="hidden",t.style.overflow="hidden",t.style.width="0",t.style.height="0",t.appendChild(e),t}getElement(e){var t;if(A4(e)?t=e:typeof e=="string"&&(t=document.getElementById(e)),!t)throw new Error("Not an Element");return t}attachTo(e){var t=this.getElement(e),i;if(t)return this.settings.hidden?i=this.wrapper:i=this.container,t.appendChild(i),this.element=t,t}getContainer(){return this.container}onResize(e){(!Mn(this.settings.width)||!Mn(this.settings.height))&&(this.resizeFunc=AV(e,50),window.addEventListener("resize",this.resizeFunc,!1))}onOrientationChange(e){this.orientationChangeFunc=e,window.addEventListener("orientationchange",this.orientationChangeFunc,!1)}size(e,t){var i;let s=e||this.settings.width,r=t||this.settings.height;e===null?(i=this.element.getBoundingClientRect(),i.width&&(e=Math.floor(i.width),this.container.style.width=e+"px")):Mn(e)?this.container.style.width=e+"px":this.container.style.width=e,t===null?(i=i||this.element.getBoundingClientRect(),i.height&&(t=i.height,this.container.style.height=t+"px")):Mn(t)?this.container.style.height=t+"px":this.container.style.height=t,Mn(e)||(e=this.container.clientWidth),Mn(t)||(t=this.container.clientHeight),this.containerStyles=window.getComputedStyle(this.container),this.containerPadding={left:parseFloat(this.containerStyles["padding-left"])||0,right:parseFloat(this.containerStyles["padding-right"])||0,top:parseFloat(this.containerStyles["padding-top"])||0,bottom:parseFloat(this.containerStyles["padding-bottom"])||0};let a=Wb(),o=window.getComputedStyle(document.body),c={left:parseFloat(o["padding-left"])||0,right:parseFloat(o["padding-right"])||0,top:parseFloat(o["padding-top"])||0,bottom:parseFloat(o["padding-bottom"])||0};return s||(e=a.width-c.left-c.right),(this.settings.fullsize&&!r||!r)&&(t=a.height-c.top-c.bottom),{width:e-this.containerPadding.left-this.containerPadding.right,height:t-this.containerPadding.top-this.containerPadding.bottom}}bounds(){let e;return this.container.style.overflow!=="visible"&&(e=this.container&&this.container.getBoundingClientRect()),!e||!e.width||!e.height?Wb():e}getSheet(){var e=document.createElement("style");return e.appendChild(document.createTextNode("")),document.head.appendChild(e),e.sheet}addStyleRules(e,t){var i="#"+this.id+" ",s="";this.sheet||(this.sheet=this.getSheet()),t.forEach(function(r){for(var a in r)r.hasOwnProperty(a)&&(s+=a+":"+r[a]+";")}),this.sheet.insertRule(i+e+" {"+s+"}",0)}axis(e){e==="horizontal"?(this.container.style.display="flex",this.container.style.flexDirection="row",this.container.style.flexWrap="nowrap"):this.container.style.display="block",this.settings.axis=e}direction(e){this.container&&(this.container.dir=e,this.container.style.direction=e),this.settings.fullsize&&(document.body.style.direction=e),this.settings.dir=e}overflow(e){this.container&&(e==="scroll"&&this.settings.axis==="vertical"?(this.container.style["overflow-y"]=e,this.container.style["overflow-x"]="hidden"):e==="scroll"&&this.settings.axis==="horizontal"?(this.container.style["overflow-y"]="hidden",this.container.style["overflow-x"]=e):this.container.style.overflow=e),this.settings.overflow=e}destroy(){this.element&&(this.settings.hidden?this.wrapper:this.container,this.element.contains(this.container)&&this.element.removeChild(this.container),window.removeEventListener("resize",this.resizeFunc),window.removeEventListener("orientationChange",this.orientationChangeFunc))}}class CV{constructor(e){this.container=e,this._views=[],this.length=0,this.hidden=!1}all(){return this._views}first(){return this._views[0]}last(){return this._views[this._views.length-1]}indexOf(e){return this._views.indexOf(e)}slice(){return this._views.slice.apply(this._views,arguments)}get(e){return this._views[e]}append(e){return this._views.push(e),this.container&&this.container.appendChild(e.element),this.length++,e}prepend(e){return this._views.unshift(e),this.container&&this.container.insertBefore(e.element,this.container.firstChild),this.length++,e}insert(e,t){return this._views.splice(t,0,e),this.container&&(t<this.container.children.length?this.container.insertBefore(e.element,this.container.children[t]):this.container.appendChild(e.element)),this.length++,e}remove(e){var t=this._views.indexOf(e);t>-1&&this._views.splice(t,1),this.destroy(e),this.length--}destroy(e){e.displayed&&e.destroy(),this.container&&this.container.removeChild(e.element),e=null}forEach(){return this._views.forEach.apply(this._views,arguments)}clear(){var e,t=this.length;if(this.length){for(var i=0;i<t;i++)e=this._views[i],this.destroy(e);this._views=[],this.length=0}}find(e){for(var t,i=this.length,s=0;s<i;s++)if(t=this._views[s],t.displayed&&t.section.index==e.index)return t}displayed(){for(var e=[],t,i=this.length,s=0;s<i;s++)t=this._views[s],t.displayed&&e.push(t);return e}show(){for(var e,t=this.length,i=0;i<t;i++)e=this._views[i],e.displayed&&e.show();this.hidden=!1}hide(){for(var e,t=this.length,i=0;i<t;i++)e=this._views[i],e.displayed&&e.hide();this.hidden=!0}}class Jb{constructor(e){this.name="default",this.optsSettings=e.settings,this.View=e.view,this.request=e.request,this.renditionQueue=e.queue,this.q=new gN(this),this.settings=Ii(this.settings||{},{infinite:!0,hidden:!1,width:void 0,height:void 0,axis:void 0,writingMode:void 0,flow:"scrolled",ignoreClass:"",fullsize:void 0,allowScriptedContent:!1,allowPopups:!1}),Ii(this.settings,e.settings||{}),this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,method:this.settings.method,width:0,height:0,forceEvenPages:!0,allowScriptedContent:this.settings.allowScriptedContent,allowPopups:this.settings.allowPopups},this.rendered=!1}render(e,t){let i=e.tagName;typeof this.settings.fullsize>"u"&&i&&(i.toLowerCase()=="body"||i.toLowerCase()=="html")&&(this.settings.fullsize=!0),this.settings.fullsize&&(this.settings.overflow="visible",this.overflow=this.settings.overflow),this.settings.size=t,this.settings.rtlScrollType=xq(),this.stage=new EV({width:t.width,height:t.height,overflow:this.overflow,hidden:this.settings.hidden,axis:this.settings.axis,fullsize:this.settings.fullsize,direction:this.settings.direction}),this.stage.attachTo(e),this.container=this.stage.getContainer(),this.views=new CV(this.container),this._bounds=this.bounds(),this._stageSize=this.stage.size(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.stage.onResize(this.onResized.bind(this)),this.stage.onOrientationChange(this.onOrientationChange.bind(this)),this.addEventListeners(),this.layout&&this.updateLayout(),this.rendered=!0}addEventListeners(){var e;window.addEventListener("unload",(function(t){this.destroy()}).bind(this)),this.settings.fullsize?e=window:e=this.container,this._onScroll=this.onScroll.bind(this),e.addEventListener("scroll",this._onScroll)}removeEventListeners(){var e;this.settings.fullsize?e=window:e=this.container,e.removeEventListener("scroll",this._onScroll),this._onScroll=void 0}destroy(){clearTimeout(this.orientationTimeout),clearTimeout(this.resizeTimeout),clearTimeout(this.afterScrolled),this.clear(),this.removeEventListeners(),this.stage.destroy(),this.rendered=!1}onOrientationChange(e){let{orientation:t}=window;this.optsSettings.resizeOnOrientationChange&&this.resize(),clearTimeout(this.orientationTimeout),this.orientationTimeout=setTimeout((function(){this.orientationTimeout=void 0,this.optsSettings.resizeOnOrientationChange&&this.resize(),this.emit(Ue.MANAGERS.ORIENTATION_CHANGE,t)}).bind(this),500)}onResized(e){this.resize()}resize(e,t,i){let s=this.stage.size(e,t);if(this.winBounds=Wb(),this.orientationTimeout&&this.winBounds.width===this.winBounds.height){this._stageSize=void 0;return}this._stageSize&&this._stageSize.width===s.width&&this._stageSize.height===s.height||(this._stageSize=s,this._bounds=this.bounds(),this.clear(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.updateLayout(),this.emit(Ue.MANAGERS.RESIZED,{width:this._stageSize.width,height:this._stageSize.height},i))}createView(e,t){return new this.View(e,Ii(this.viewSettings,{forceRight:t}))}handleNextPrePaginated(e,t,i){let s;if(this.layout.name==="pre-paginated"&&this.layout.divisor>1){if(e||t.index===0)return;if(s=t.next(),s&&!s.properties.includes("page-spread-left"))return i.call(this,s)}}display(e,t){var i=new Dt,s=i.promise;(t===e.href||Mn(t))&&(t=void 0);var r=this.views.find(e);if(r&&e&&this.layout.name!=="pre-paginated"){let o=r.offset();if(this.settings.direction==="ltr")this.scrollTo(o.left,o.top,!0);else{let c=r.width();this.scrollTo(o.left+c,o.top,!0)}if(t){let c=r.locationOf(t),h=r.width();this.moveTo(c,h)}return i.resolve(),s}this.clear();let a=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&e.properties.includes("page-spread-right")&&(a=!0),this.add(e,a).then((function(o){if(t){let c=o.locationOf(t),h=o.width();this.moveTo(c,h)}}).bind(this),o=>{i.reject(o)}).then((function(){return this.handleNextPrePaginated(a,e,this.add)}).bind(this)).then((function(){this.views.show(),i.resolve()}).bind(this)),s}afterDisplayed(e){this.emit(Ue.MANAGERS.ADDED,e)}afterResized(e){this.emit(Ue.MANAGERS.RESIZE,e.section)}moveTo(e,t){var i=0,s=0;this.isPaginated?(i=Math.floor(e.left/this.layout.delta)*this.layout.delta,i+this.layout.delta>this.container.scrollWidth&&(i=this.container.scrollWidth-this.layout.delta),s=Math.floor(e.top/this.layout.delta)*this.layout.delta,s+this.layout.delta>this.container.scrollHeight&&(s=this.container.scrollHeight-this.layout.delta)):s=e.top,this.settings.direction==="rtl"&&(i=i+this.layout.delta,i=i-t),this.scrollTo(i,s,!0)}add(e,t){var i=this.createView(e,t);return this.views.append(i),i.onDisplayed=this.afterDisplayed.bind(this),i.onResize=this.afterResized.bind(this),i.on(Ue.VIEWS.AXIS,s=>{this.updateAxis(s)}),i.on(Ue.VIEWS.WRITING_MODE,s=>{this.updateWritingMode(s)}),i.display(this.request)}append(e,t){var i=this.createView(e,t);return this.views.append(i),i.onDisplayed=this.afterDisplayed.bind(this),i.onResize=this.afterResized.bind(this),i.on(Ue.VIEWS.AXIS,s=>{this.updateAxis(s)}),i.on(Ue.VIEWS.WRITING_MODE,s=>{this.updateWritingMode(s)}),i.display(this.request)}prepend(e,t){var i=this.createView(e,t);return i.on(Ue.VIEWS.RESIZED,s=>{this.counter(s)}),this.views.prepend(i),i.onDisplayed=this.afterDisplayed.bind(this),i.onResize=this.afterResized.bind(this),i.on(Ue.VIEWS.AXIS,s=>{this.updateAxis(s)}),i.on(Ue.VIEWS.WRITING_MODE,s=>{this.updateWritingMode(s)}),i.display(this.request)}counter(e){this.settings.axis==="vertical"?this.scrollBy(0,e.heightDelta,!0):this.scrollBy(e.widthDelta,0,!0)}next(){var e,t;let i=this.settings.direction;if(this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"&&(!i||i==="ltr")?(this.scrollLeft=this.container.scrollLeft,t=this.container.scrollLeft+this.container.offsetWidth+this.layout.delta,t<=this.container.scrollWidth?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next()):this.isPaginated&&this.settings.axis==="horizontal"&&i==="rtl"?(this.scrollLeft=this.container.scrollLeft,this.settings.rtlScrollType==="default"?(t=this.container.scrollLeft,t>0?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next()):(t=this.container.scrollLeft+this.layout.delta*-1,t>this.container.scrollWidth*-1?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next())):this.isPaginated&&this.settings.axis==="vertical"?(this.scrollTop=this.container.scrollTop,this.container.scrollTop+this.container.offsetHeight<this.container.scrollHeight?this.scrollBy(0,this.layout.height,!0):e=this.views.last().section.next()):e=this.views.last().section.next(),e)){this.clear(),this.updateLayout();let s=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&e.properties.includes("page-spread-right")&&(s=!0),this.append(e,s).then((function(){return this.handleNextPrePaginated(s,e,this.append)}).bind(this),r=>r).then((function(){!this.isPaginated&&this.settings.axis==="horizontal"&&this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"&&this.scrollTo(this.container.scrollWidth,0,!0),this.views.show()}).bind(this))}}prev(){var e,t;let i=this.settings.direction;if(this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"&&(!i||i==="ltr")?(this.scrollLeft=this.container.scrollLeft,t=this.container.scrollLeft,t>0?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev()):this.isPaginated&&this.settings.axis==="horizontal"&&i==="rtl"?(this.scrollLeft=this.container.scrollLeft,this.settings.rtlScrollType==="default"?(t=this.container.scrollLeft+this.container.offsetWidth,t<this.container.scrollWidth?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev()):(t=this.container.scrollLeft,t<0?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev())):this.isPaginated&&this.settings.axis==="vertical"?(this.scrollTop=this.container.scrollTop,this.container.scrollTop>0?this.scrollBy(0,-this.layout.height,!0):e=this.views.first().section.prev()):e=this.views.first().section.prev(),e)){this.clear(),this.updateLayout();let s=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&typeof e.prev()!="object"&&(s=!0),this.prepend(e,s).then((function(){var r;if(this.layout.name==="pre-paginated"&&this.layout.divisor>1&&(r=e.prev(),r))return this.prepend(r)}).bind(this),r=>r).then((function(){this.isPaginated&&this.settings.axis==="horizontal"&&(this.settings.direction==="rtl"?this.settings.rtlScrollType==="default"?this.scrollTo(0,0,!0):this.scrollTo(this.container.scrollWidth*-1+this.layout.delta,0,!0):this.scrollTo(this.container.scrollWidth-this.layout.delta,0,!0)),this.views.show()}).bind(this))}}current(){var e=this.visible();return e.length?e[e.length-1]:null}clear(){this.views&&(this.views.hide(),this.scrollTo(0,0,!0),this.views.clear())}currentLocation(){return this.updateLayout(),this.isPaginated&&this.settings.axis==="horizontal"?this.location=this.paginatedLocation():this.location=this.scrolledLocation(),this.location}scrolledLocation(){let e=this.visible(),t=this.container.getBoundingClientRect(),i=t.height<window.innerHeight?t.height:window.innerHeight,s=t.width<window.innerWidth?t.width:window.innerWidth,r=this.settings.axis==="vertical";this.settings.direction;let a=0,o=0;return this.settings.fullsize&&(a=r?window.scrollY:window.scrollX),e.map(h=>{let{index:d,href:f}=h.section,p=h.position(),g=h.width(),v=h.height(),b,x,m,y;r?(b=a+t.top-p.top+o,x=b+i-o,y=this.layout.count(v,i).pages,m=i):(b=a+t.left-p.left+o,x=b+s-o,y=this.layout.count(g,s).pages,m=s);let w=Math.ceil(b/m),E=[],S=Math.ceil(x/m);if(this.settings.direction==="rtl"&&!r){let j=w;w=y-S,S=y-j}E=[];for(var _=w;_<=S;_++){let j=_+1;E.push(j)}let T=this.mapping.page(h.contents,h.section.cfiBase,b,x);return{index:d,href:f,pages:E,totalPages:y,mapping:T}})}paginatedLocation(){let e=this.visible(),t=this.container.getBoundingClientRect(),i=0,s=0;return this.settings.fullsize&&(i=window.scrollX),e.map(a=>{let{index:o,href:c}=a.section,h,d=a.position(),f=a.width(),p,g,v;this.settings.direction==="rtl"?(h=t.right-i,v=Math.min(Math.abs(h-d.left),this.layout.width)-s,g=d.width-(d.right-h)-s,p=g-v):(h=t.left+i,v=Math.min(d.right-h,this.layout.width)-s,p=h-d.left+s,g=p+v),s+=v;let b=this.mapping.page(a.contents,a.section.cfiBase,p,g),x=this.layout.count(f).pages,m=Math.floor(p/this.layout.pageWidth),y=[],w=Math.floor(g/this.layout.pageWidth);if(m<0&&(m=0,w=w+1),this.settings.direction==="rtl"){let S=m;m=x-w,w=x-S}for(var E=m+1;E<=w;E++){let S=E;y.push(S)}return{index:o,href:c,pages:y,totalPages:x,mapping:b}})}isVisible(e,t,i,s){var r=e.position(),a=s||this.bounds();return this.settings.axis==="horizontal"&&r.right>a.left-t&&r.left<a.right+i?!0:this.settings.axis==="vertical"&&r.bottom>a.top-t&&r.top<a.bottom+i}visible(){for(var e=this.bounds(),t=this.views.displayed(),i=t.length,s=[],r,a,o=0;o<i;o++)a=t[o],r=this.isVisible(a,0,0,e),r===!0&&s.push(a);return s}scrollBy(e,t,i){let s=this.settings.direction==="rtl"?-1:1;i&&(this.ignore=!0),this.settings.fullsize?window.scrollBy(e*s,t*s):(e&&(this.container.scrollLeft+=e*s),t&&(this.container.scrollTop+=t)),this.scrolled=!0}scrollTo(e,t,i){i&&(this.ignore=!0),this.settings.fullsize?window.scrollTo(e,t):(this.container.scrollLeft=e,this.container.scrollTop=t),this.scrolled=!0}onScroll(){let e,t;this.settings.fullsize?(e=window.scrollY,t=window.scrollX):(e=this.container.scrollTop,t=this.container.scrollLeft),this.scrollTop=e,this.scrollLeft=t,this.ignore?this.ignore=!1:(this.emit(Ue.MANAGERS.SCROLL,{top:e,left:t}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout((function(){this.emit(Ue.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}).bind(this),20))}bounds(){var e;return e=this.stage.bounds(),e}applyLayout(e){this.layout=e,this.updateLayout(),this.views&&this.views.length>0&&this.layout.name==="pre-paginated"&&this.display(this.views.first().section)}updateLayout(){this.stage&&(this._stageSize=this.stage.size(),this.isPaginated?(this.layout.calculate(this._stageSize.width,this._stageSize.height,this.settings.gap),this.settings.offset=this.layout.delta/this.layout.divisor):this.layout.calculate(this._stageSize.width,this._stageSize.height),this.viewSettings.width=this.layout.width,this.viewSettings.height=this.layout.height,this.setLayout(this.layout))}setLayout(e){this.viewSettings.layout=e,this.mapping=new Zb(e.props,this.settings.direction,this.settings.axis),this.views&&this.views.forEach(function(t){t&&t.setLayout(e)})}updateWritingMode(e){this.writingMode=e}updateAxis(e,t){!t&&e===this.settings.axis||(this.settings.axis=e,this.stage&&this.stage.axis(e),this.viewSettings.axis=e,this.mapping&&(this.mapping=new Zb(this.layout.props,this.settings.direction,this.settings.axis)),this.layout&&(e==="vertical"?this.layout.spread("none"):this.layout.spread(this.layout.settings.spread)))}updateFlow(e,t="auto"){let i=e==="paginated"||e==="auto";this.isPaginated=i,e==="scrolled-doc"||e==="scrolled-continuous"||e==="scrolled"?this.updateAxis("vertical"):this.updateAxis("horizontal"),this.viewSettings.flow=e,this.settings.overflow?this.overflow=this.settings.overflow:this.overflow=i?"hidden":t,this.stage&&this.stage.overflow(this.overflow),this.updateLayout()}getContents(){var e=[];return this.views&&this.views.forEach(function(t){const i=t&&t.contents;i&&e.push(i)}),e}direction(e="ltr"){this.settings.direction=e,this.stage&&this.stage.direction(e),this.viewSettings.direction=e,this.updateLayout()}isRendered(){return this.rendered}}uo(Jb.prototype);const NV={easeInCubic:function(n){return Math.pow(n,3)}};class uA{constructor(e,t){this.settings=Ii({duration:80,minVelocity:.2,minDistance:10,easing:NV.easeInCubic},t||{}),this.supportsTouch=this.supportsTouch(),this.supportsTouch&&this.setup(e)}setup(e){this.manager=e,this.layout=this.manager.layout,this.fullsize=this.manager.settings.fullsize,this.fullsize?(this.element=this.manager.stage.element,this.scroller=window,this.disableScroll()):(this.element=this.manager.stage.container,this.scroller=this.element,this.element.style.WebkitOverflowScrolling="touch"),this.manager.settings.offset=this.layout.width,this.manager.settings.afterScrolledTimeout=this.settings.duration*2,this.isVertical=this.manager.settings.axis==="vertical",!(!this.manager.isPaginated||this.isVertical)&&(this.touchCanceler=!1,this.resizeCanceler=!1,this.snapping=!1,this.scrollLeft,this.scrollTop,this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0,this.addListeners())}supportsTouch(){return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)}disableScroll(){this.element.style.overflow="hidden"}enableScroll(){this.element.style.overflow=""}addListeners(){this._onResize=this.onResize.bind(this),window.addEventListener("resize",this._onResize),this._onScroll=this.onScroll.bind(this),this.scroller.addEventListener("scroll",this._onScroll),this._onTouchStart=this.onTouchStart.bind(this),this.scroller.addEventListener("touchstart",this._onTouchStart,{passive:!0}),this.on("touchstart",this._onTouchStart),this._onTouchMove=this.onTouchMove.bind(this),this.scroller.addEventListener("touchmove",this._onTouchMove,{passive:!0}),this.on("touchmove",this._onTouchMove),this._onTouchEnd=this.onTouchEnd.bind(this),this.scroller.addEventListener("touchend",this._onTouchEnd,{passive:!0}),this.on("touchend",this._onTouchEnd),this._afterDisplayed=this.afterDisplayed.bind(this),this.manager.on(Ue.MANAGERS.ADDED,this._afterDisplayed)}removeListeners(){window.removeEventListener("resize",this._onResize),this._onResize=void 0,this.scroller.removeEventListener("scroll",this._onScroll),this._onScroll=void 0,this.scroller.removeEventListener("touchstart",this._onTouchStart,{passive:!0}),this.off("touchstart",this._onTouchStart),this._onTouchStart=void 0,this.scroller.removeEventListener("touchmove",this._onTouchMove,{passive:!0}),this.off("touchmove",this._onTouchMove),this._onTouchMove=void 0,this.scroller.removeEventListener("touchend",this._onTouchEnd,{passive:!0}),this.off("touchend",this._onTouchEnd),this._onTouchEnd=void 0,this.manager.off(Ue.MANAGERS.ADDED,this._afterDisplayed),this._afterDisplayed=void 0}afterDisplayed(e){let t=e.contents;["touchstart","touchmove","touchend"].forEach(i=>{t.on(i,s=>this.triggerViewEvent(s,t))})}triggerViewEvent(e,t){this.emit(e.type,e,t)}onScroll(e){this.scrollLeft=this.fullsize?window.scrollX:this.scroller.scrollLeft,this.scrollTop=this.fullsize?window.scrollY:this.scroller.scrollTop}onResize(e){this.resizeCanceler=!0}onTouchStart(e){let{screenX:t,screenY:i}=e.touches[0];this.fullsize&&this.enableScroll(),this.touchCanceler=!0,this.startTouchX||(this.startTouchX=t,this.startTouchY=i,this.startTime=this.now()),this.endTouchX=t,this.endTouchY=i,this.endTime=this.now()}onTouchMove(e){let{screenX:t,screenY:i}=e.touches[0],s=Math.abs(i-this.endTouchY);this.touchCanceler=!0,!this.fullsize&&s<10&&(this.element.scrollLeft-=t-this.endTouchX),this.endTouchX=t,this.endTouchY=i,this.endTime=this.now()}onTouchEnd(e){this.fullsize&&this.disableScroll(),this.touchCanceler=!1;let t=this.wasSwiped();t!==0?this.snap(t):this.snap(),this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0}wasSwiped(){let e=this.layout.pageWidth*this.layout.divisor,t=this.endTouchX-this.startTouchX,i=Math.abs(t),s=this.endTime-this.startTime,r=t/s,a=this.settings.minVelocity;if(i<=this.settings.minDistance||i>=e)return 0;if(r>a)return-1;if(r<-a)return 1}needsSnap(){let e=this.scrollLeft,t=this.layout.pageWidth*this.layout.divisor;return e%t!==0}snap(e=0){let t=this.scrollLeft,i=this.layout.pageWidth*this.layout.divisor,s=Math.round(t/i)*i;return e&&(s+=e*i),this.smoothScrollTo(s)}smoothScrollTo(e){const t=new Dt,i=this.scrollLeft,s=this.now(),r=this.settings.duration,a=this.settings.easing;this.snapping=!0;function o(){const c=this.now(),h=Math.min(1,(c-s)/r);if(a(h),this.touchCanceler||this.resizeCanceler){this.resizeCanceler=!1,this.snapping=!1,t.resolve();return}h<1?(window.requestAnimationFrame(o.bind(this)),this.scrollTo(i+(e-i)*h,0)):(this.scrollTo(e,0),this.snapping=!1,t.resolve())}return o.call(this),t.promise}scrollTo(e=0,t=0){this.fullsize?window.scroll(e,t):(this.scroller.scrollLeft=e,this.scroller.scrollTop=t)}now(){return"now"in window.performance?performance.now():new Date().getTime()}destroy(){this.scroller&&(this.fullsize&&this.enableScroll(),this.removeListeners(),this.scroller=void 0)}}uo(uA.prototype);class _V extends Jb{constructor(e){super(e),this.name="continuous",this.settings=Ii(this.settings||{},{infinite:!0,overflow:void 0,axis:void 0,writingMode:void 0,flow:"scrolled",offset:500,offsetDelta:250,width:void 0,height:void 0,snap:!1,afterScrolledTimeout:10,allowScriptedContent:!1,allowPopups:!1}),Ii(this.settings,e.settings||{}),e.settings.gap!="undefined"&&e.settings.gap===0&&(this.settings.gap=e.settings.gap),this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,width:0,height:0,forceEvenPages:!1,allowScriptedContent:this.settings.allowScriptedContent,allowPopups:this.settings.allowPopups},this.scrollTop=0,this.scrollLeft=0}display(e,t){return Jb.prototype.display.call(this,e,t).then((function(){return this.fill()}).bind(this))}fill(e){var t=e||new Dt;return this.q.enqueue(()=>this.check()).then(i=>{i?this.fill(t):t.resolve()}),t.promise}moveTo(e){var t=0,i=0;this.isPaginated?(t=Math.floor(e.left/this.layout.delta)*this.layout.delta,t+this.settings.offsetDelta):(i=e.top,e.top+this.settings.offsetDelta),(t>0||i>0)&&this.scrollBy(t,i,!0)}afterResized(e){this.emit(Ue.MANAGERS.RESIZE,e.section)}removeShownListeners(e){e.onDisplayed=function(){}}add(e){var t=this.createView(e);return this.views.append(t),t.on(Ue.VIEWS.RESIZED,i=>{t.expanded=!0}),t.on(Ue.VIEWS.AXIS,i=>{this.updateAxis(i)}),t.on(Ue.VIEWS.WRITING_MODE,i=>{this.updateWritingMode(i)}),t.onDisplayed=this.afterDisplayed.bind(this),t.onResize=this.afterResized.bind(this),t.display(this.request)}append(e){var t=this.createView(e);return t.on(Ue.VIEWS.RESIZED,i=>{t.expanded=!0}),t.on(Ue.VIEWS.AXIS,i=>{this.updateAxis(i)}),t.on(Ue.VIEWS.WRITING_MODE,i=>{this.updateWritingMode(i)}),this.views.append(t),t.onDisplayed=this.afterDisplayed.bind(this),t}prepend(e){var t=this.createView(e);return t.on(Ue.VIEWS.RESIZED,i=>{this.counter(i),t.expanded=!0}),t.on(Ue.VIEWS.AXIS,i=>{this.updateAxis(i)}),t.on(Ue.VIEWS.WRITING_MODE,i=>{this.updateWritingMode(i)}),this.views.prepend(t),t.onDisplayed=this.afterDisplayed.bind(this),t}counter(e){this.settings.axis==="vertical"?this.scrollBy(0,e.heightDelta,!0):this.scrollBy(e.widthDelta,0,!0)}update(e){for(var t=this.bounds(),i=this.views.all(),s=i.length,r=typeof e<"u"?e:this.settings.offset||0,a,o,c=new Dt,h=[],d=0;d<s;d++)if(o=i[d],a=this.isVisible(o,r,r,t),a===!0)if(o.displayed)o.show();else{let f=o.display(this.request).then(function(p){p.show()},p=>{o.hide()});h.push(f)}else this.q.enqueue(o.destroy.bind(o)),clearTimeout(this.trimTimeout),this.trimTimeout=setTimeout((function(){this.q.enqueue(this.trim.bind(this))}).bind(this),250);return h.length?Promise.all(h).catch(f=>{c.reject(f)}):(c.resolve(),c.promise)}check(e,t){var i=new Dt,s=[],r=this.settings.axis==="horizontal",a=this.settings.offset||0;e&&r&&(a=e),t&&!r&&(a=t);var o=this._bounds;let c=r?this.scrollLeft:this.scrollTop,h=r?Math.floor(o.width):o.height,d=r?this.container.scrollWidth:this.container.scrollHeight,f=this.writingMode&&this.writingMode.indexOf("vertical")===0?"vertical":"horizontal",p=this.settings.rtlScrollType,g=this.settings.direction==="rtl";this.settings.fullsize?(r&&g&&p==="negative"||!r&&g&&p==="default")&&(c=c*-1):(g&&p==="default"&&f==="horizontal"&&(c=d-h-c),g&&p==="negative"&&f==="horizontal"&&(c=c*-1));let v=()=>{let w=this.views.first(),E=w&&w.section.prev();E&&s.push(this.prepend(E))},b=()=>{let w=this.views.last(),E=w&&w.section.next();E&&s.push(this.append(E))},x=c+h+a,m=c-a;x>=d&&b(),m<0&&v();let y=s.map(w=>w.display(this.request));return s.length?Promise.all(y).then(()=>this.check()).then(()=>this.update(a),w=>w):(this.q.enqueue((function(){this.update()}).bind(this)),i.resolve(!1),i.promise)}trim(){for(var e=new Dt,t=this.views.displayed(),i=t[0],s=t[t.length-1],r=this.views.indexOf(i),a=this.views.indexOf(s),o=this.views.slice(0,r),c=this.views.slice(a+1),h=0;h<o.length-1;h++)this.erase(o[h],o);for(var d=1;d<c.length;d++)this.erase(c[d]);return e.resolve(),e.promise}erase(e,t){var i,s;this.settings.fullsize?(i=window.scrollY,s=window.scrollX):(i=this.container.scrollTop,s=this.container.scrollLeft);var r=e.bounds();this.views.remove(e),t&&(this.settings.axis==="vertical"?this.scrollTo(0,i-r.height,!0):this.settings.direction==="rtl"?this.settings.fullsize?this.scrollTo(s+Math.floor(r.width),0,!0):this.scrollTo(s,0,!0):this.scrollTo(s-Math.floor(r.width),0,!0))}addEventListeners(e){window.addEventListener("unload",(function(t){this.ignore=!0,this.destroy()}).bind(this)),this.addScrollListeners(),this.isPaginated&&this.settings.snap&&(this.snapper=new uA(this,this.settings.snap&&typeof this.settings.snap=="object"&&this.settings.snap))}addScrollListeners(){var e;this.tick=dN;let t=this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"?-1:1;this.scrollDeltaVert=0,this.scrollDeltaHorz=0,this.settings.fullsize?(e=window,this.scrollTop=window.scrollY*t,this.scrollLeft=window.scrollX*t):(e=this.container,this.scrollTop=this.container.scrollTop,this.scrollLeft=this.container.scrollLeft),this._onScroll=this.onScroll.bind(this),e.addEventListener("scroll",this._onScroll),this._scrolled=xV(this.scrolled.bind(this),30),this.didScroll=!1}removeEventListeners(){var e;this.settings.fullsize?e=window:e=this.container,e.removeEventListener("scroll",this._onScroll),this._onScroll=void 0}onScroll(){let e,t,i=this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"?-1:1;this.settings.fullsize?(e=window.scrollY*i,t=window.scrollX*i):(e=this.container.scrollTop,t=this.container.scrollLeft),this.scrollTop=e,this.scrollLeft=t,this.ignore?this.ignore=!1:this._scrolled(),this.scrollDeltaVert+=Math.abs(e-this.prevScrollTop),this.scrollDeltaHorz+=Math.abs(t-this.prevScrollLeft),this.prevScrollTop=e,this.prevScrollLeft=t,clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout((function(){this.scrollDeltaVert=0,this.scrollDeltaHorz=0}).bind(this),150),clearTimeout(this.afterScrolled),this.didScroll=!1}scrolled(){this.q.enqueue((function(){return this.check()}).bind(this)),this.emit(Ue.MANAGERS.SCROLL,{top:this.scrollTop,left:this.scrollLeft}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout((function(){this.snapper&&this.snapper.supportsTouch&&this.snapper.needsSnap()||this.emit(Ue.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}).bind(this),this.settings.afterScrolledTimeout)}next(){let e=this.layout.props.name==="pre-paginated"&&this.layout.props.spread?this.layout.props.delta*2:this.layout.props.delta;this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"?this.scrollBy(e,0,!0):this.scrollBy(0,this.layout.height,!0),this.q.enqueue((function(){return this.check()}).bind(this)))}prev(){let e=this.layout.props.name==="pre-paginated"&&this.layout.props.spread?this.layout.props.delta*2:this.layout.props.delta;this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"?this.scrollBy(-e,0,!0):this.scrollBy(0,-this.layout.height,!0),this.q.enqueue((function(){return this.check()}).bind(this)))}updateFlow(e){this.rendered&&this.snapper&&(this.snapper.destroy(),this.snapper=void 0),super.updateFlow(e,"scroll"),this.rendered&&this.isPaginated&&this.settings.snap&&(this.snapper=new uA(this,this.settings.snap&&typeof this.settings.snap=="object"&&this.settings.snap))}destroy(){super.destroy(),this.snapper&&this.snapper.destroy()}}class vN{constructor(e,t){this.settings=Ii(this.settings||{},{width:null,height:null,ignoreClass:"",manager:"default",view:"iframe",flow:null,layout:null,spread:null,minSpreadWidth:800,stylesheet:null,resizeOnOrientationChange:!0,script:null,snap:!1,defaultDirection:"ltr",allowScriptedContent:!1,allowPopups:!1}),Ii(this.settings,t),typeof this.settings.manager=="object"&&(this.manager=this.settings.manager),this.book=e,this.hooks={},this.hooks.display=new da(this),this.hooks.serialize=new da(this),this.hooks.content=new da(this),this.hooks.unloaded=new da(this),this.hooks.layout=new da(this),this.hooks.render=new da(this),this.hooks.show=new da(this),this.hooks.content.register(this.handleLinks.bind(this)),this.hooks.content.register(this.passEvents.bind(this)),this.hooks.content.register(this.adjustImages.bind(this)),this.book.spine.hooks.content.register(this.injectIdentifier.bind(this)),this.settings.stylesheet&&this.book.spine.hooks.content.register(this.injectStylesheet.bind(this)),this.settings.script&&this.book.spine.hooks.content.register(this.injectScript.bind(this)),this.themes=new iq(this),this.annotations=new aq(this),this.epubcfi=new jt,this.q=new gN(this),this.location=void 0,this.q.enqueue(this.book.opened),this.starting=new Dt,this.started=this.starting.promise,this.q.enqueue(this.start)}setManager(e){this.manager=e}requireManager(e){var t;return typeof e=="string"&&e==="default"?t=Jb:typeof e=="string"&&e==="continuous"?t=_V:t=e,t}requireView(e){var t;return typeof e=="string"&&e==="iframe"?t=G4:t=e,t}start(){switch(!this.settings.layout&&(this.book.package.metadata.layout==="pre-paginated"||this.book.displayOptions.fixedLayout==="true")&&(this.settings.layout="pre-paginated"),this.book.package.metadata.spread){case"none":this.settings.spread="none";break;case"both":this.settings.spread=!0;break}this.manager||(this.ViewManager=this.requireManager(this.settings.manager),this.View=this.requireView(this.settings.view),this.manager=new this.ViewManager({view:this.View,queue:this.q,request:this.book.load.bind(this.book),settings:this.settings})),this.direction(this.book.package.metadata.direction||this.settings.defaultDirection),this.settings.globalLayoutProperties=this.determineLayoutProperties(this.book.package.metadata),this.flow(this.settings.globalLayoutProperties.flow),this.layout(this.settings.globalLayoutProperties),this.manager.on(Ue.MANAGERS.ADDED,this.afterDisplayed.bind(this)),this.manager.on(Ue.MANAGERS.REMOVED,this.afterRemoved.bind(this)),this.manager.on(Ue.MANAGERS.RESIZED,this.onResized.bind(this)),this.manager.on(Ue.MANAGERS.ORIENTATION_CHANGE,this.onOrientationChange.bind(this)),this.manager.on(Ue.MANAGERS.SCROLLED,this.reportLocation.bind(this)),this.emit(Ue.RENDITION.STARTED),this.starting.resolve()}attachTo(e){return this.q.enqueue((function(){this.manager.render(e,{width:this.settings.width,height:this.settings.height}),this.emit(Ue.RENDITION.ATTACHED)}).bind(this))}display(e){return this.displaying&&this.displaying.resolve(),this.q.enqueue(this._display,e)}_display(e){if(this.book){this.epubcfi.isCfiString(e);var t=new Dt,i=t.promise,s;return this.displaying=t,this.book.locations.length()&&E4(e)&&(e=this.book.locations.cfiFromPercentage(parseFloat(e))),s=this.book.spine.get(e),s?(this.manager.display(s,e).then(()=>{t.resolve(s),this.displaying=void 0,this.emit(Ue.RENDITION.DISPLAYED,s),this.reportLocation()},r=>{this.emit(Ue.RENDITION.DISPLAY_ERROR,r)}),i):(t.reject(new Error("No Section Found")),i)}}afterDisplayed(e){e.on(Ue.VIEWS.MARK_CLICKED,(t,i)=>this.triggerMarkEvent(t,i,e.contents)),this.hooks.render.trigger(e,this).then(()=>{e.contents?this.hooks.content.trigger(e.contents,this).then(()=>{this.emit(Ue.RENDITION.RENDERED,e.section,e)}):this.emit(Ue.RENDITION.RENDERED,e.section,e)})}afterRemoved(e){this.hooks.unloaded.trigger(e,this).then(()=>{this.emit(Ue.RENDITION.REMOVED,e.section,e)})}onResized(e,t){this.emit(Ue.RENDITION.RESIZED,{width:e.width,height:e.height},t),this.location&&this.location.start&&this.display(t||this.location.start.cfi)}onOrientationChange(e){this.emit(Ue.RENDITION.ORIENTATION_CHANGE,e)}moveTo(e){this.manager.moveTo(e)}resize(e,t,i){e&&(this.settings.width=e),t&&(this.settings.height=t),this.manager.resize(e,t,i)}clear(){this.manager.clear()}next(){return this.q.enqueue(this.manager.next.bind(this.manager)).then(this.reportLocation.bind(this))}prev(){return this.q.enqueue(this.manager.prev.bind(this.manager)).then(this.reportLocation.bind(this))}determineLayoutProperties(e){var t,i=this.settings.layout||e.layout||"reflowable",s=this.settings.spread||e.spread||"auto",r=this.settings.orientation||e.orientation||"auto",a=this.settings.flow||e.flow||"auto",o=e.viewport||"",c=this.settings.minSpreadWidth||e.minSpreadWidth||800,h=this.settings.direction||e.direction||"ltr";return(this.settings.width===0||this.settings.width>0)&&(this.settings.height===0||this.settings.height>0),t={layout:i,spread:s,orientation:r,flow:a,viewport:o,minSpreadWidth:c,direction:h},t}flow(e){var t=e;(e==="scrolled"||e==="scrolled-doc"||e==="scrolled-continuous")&&(t="scrolled"),(e==="auto"||e==="paginated")&&(t="paginated"),this.settings.flow=e,this._layout&&this._layout.flow(t),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this.manager&&this.manager.updateFlow(t),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}layout(e){return e&&(this._layout=new P4(e),this._layout.spread(e.spread,this.settings.minSpreadWidth),this._layout.on(Ue.LAYOUT.UPDATED,(t,i)=>{this.emit(Ue.RENDITION.LAYOUT,t,i)})),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this._layout}spread(e,t){this.settings.spread=e,t&&(this.settings.minSpreadWidth=t),this._layout&&this._layout.spread(e,t),this.manager&&this.manager.isRendered()&&this.manager.updateLayout()}direction(e){this.settings.direction=e||"ltr",this.manager&&this.manager.direction(this.settings.direction),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}reportLocation(){return this.q.enqueue((function(){requestAnimationFrame((function(){var i=this.manager.currentLocation();if(i&&i.then&&typeof i.then=="function")i.then((function(s){let r=this.located(s);!r||!r.start||!r.end||(this.location=r,this.emit(Ue.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit(Ue.RENDITION.RELOCATED,this.location))}).bind(this));else if(i){let s=this.located(i);if(!s||!s.start||!s.end)return;this.location=s,this.emit(Ue.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit(Ue.RENDITION.RELOCATED,this.location)}}).bind(this))}).bind(this))}currentLocation(){var e=this.manager.currentLocation();if(e&&e.then&&typeof e.then=="function")e.then((function(t){return this.located(t)}).bind(this));else if(e)return this.located(e)}located(e){if(!e.length)return{};let t=e[0],i=e[e.length-1],s={start:{index:t.index,href:t.href,cfi:t.mapping.start,displayed:{page:t.pages[0]||1,total:t.totalPages}},end:{index:i.index,href:i.href,cfi:i.mapping.end,displayed:{page:i.pages[i.pages.length-1]||1,total:i.totalPages}}},r=this.book.locations.locationFromCfi(t.mapping.start),a=this.book.locations.locationFromCfi(i.mapping.end);r!=null&&(s.start.location=r,s.start.percentage=this.book.locations.percentageFromLocation(r)),a!=null&&(s.end.location=a,s.end.percentage=this.book.locations.percentageFromLocation(a));let o=this.book.pageList.pageFromCfi(t.mapping.start),c=this.book.pageList.pageFromCfi(i.mapping.end);return o!=-1&&(s.start.page=o),c!=-1&&(s.end.page=c),i.index===this.book.spine.last().index&&s.end.displayed.page>=s.end.displayed.total&&(s.atEnd=!0),t.index===this.book.spine.first().index&&s.start.displayed.page===1&&(s.atStart=!0),s}destroy(){this.manager&&this.manager.destroy(),this.book=void 0}passEvents(e){Ev.forEach(t=>{e.on(t,i=>this.triggerViewEvent(i,e))}),e.on(Ue.CONTENTS.SELECTED,t=>this.triggerSelectedEvent(t,e))}triggerViewEvent(e,t){this.emit(e.type,e,t)}triggerSelectedEvent(e,t){this.emit(Ue.RENDITION.SELECTED,e,t)}triggerMarkEvent(e,t,i){this.emit(Ue.RENDITION.MARK_CLICKED,e,t,i)}getRange(e,t){var i=new jt(e),s=this.manager.visible().filter(function(r){if(i.spinePos===r.index)return!0});if(s.length)return s[0].contents.range(i,t)}adjustImages(e){if(this._layout.name==="pre-paginated")return new Promise(function(r){r()});let t=e.window.getComputedStyle(e.content,null),i=(e.content.offsetHeight-(parseFloat(t.paddingTop)+parseFloat(t.paddingBottom)))*.95,s=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight);return e.addStylesheetRules({img:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-s+"px":"100%")+"!important","max-height":i+"px!important","object-fit":"contain","page-break-inside":"avoid","break-inside":"avoid","box-sizing":"border-box"},svg:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-s+"px":"100%")+"!important","max-height":i+"px!important","page-break-inside":"avoid","break-inside":"avoid"}}),new Promise(function(r,a){setTimeout(function(){r()},1)})}getContents(){return this.manager?this.manager.getContents():[]}views(){return(this.manager?this.manager.views:void 0)||[]}handleLinks(e){e&&e.on(Ue.CONTENTS.LINK_CLICKED,t=>{let i=this.book.path.relative(t);this.display(i)})}injectStylesheet(e,t){let i=e.createElement("link");i.setAttribute("type","text/css"),i.setAttribute("rel","stylesheet"),i.setAttribute("href",this.settings.stylesheet),e.getElementsByTagName("head")[0].appendChild(i)}injectScript(e,t){let i=e.createElement("script");i.setAttribute("type","text/javascript"),i.setAttribute("src",this.settings.script),i.textContent=" ",e.getElementsByTagName("head")[0].appendChild(i)}injectIdentifier(e,t){let i=this.book.packaging.metadata.identifier,s=e.createElement("meta");s.setAttribute("name","dc.relation.ispartof"),i&&s.setAttribute("content",i),e.getElementsByTagName("head")[0].appendChild(s)}}uo(vN.prototype);function $c(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Z4={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(n,e){(function(t){n.exports=t()})(function(){return function t(i,s,r){function a(h,d){if(!s[h]){if(!i[h]){var f=typeof $c=="function"&&$c;if(!d&&f)return f(h,!0);if(o)return o(h,!0);var p=new Error("Cannot find module '"+h+"'");throw p.code="MODULE_NOT_FOUND",p}var g=s[h]={exports:{}};i[h][0].call(g.exports,function(v){var b=i[h][1][v];return a(b||v)},g,g.exports,t,i,s,r)}return s[h].exports}for(var o=typeof $c=="function"&&$c,c=0;c<r.length;c++)a(r[c]);return a}({1:[function(t,i,s){var r=t("./utils"),a=t("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";s.encode=function(c){for(var h=[],d,f,p,g,v,b,x,m=0,y=c.length,w=y,E=r.getTypeOf(c)!=="string";m<c.length;)w=y-m,E?(d=c[m++],f=m<y?c[m++]:0,p=m<y?c[m++]:0):(d=c.charCodeAt(m++),f=m<y?c.charCodeAt(m++):0,p=m<y?c.charCodeAt(m++):0),g=d>>2,v=(d&3)<<4|f>>4,b=w>1?(f&15)<<2|p>>6:64,x=w>2?p&63:64,h.push(o.charAt(g)+o.charAt(v)+o.charAt(b)+o.charAt(x));return h.join("")},s.decode=function(c){var h,d,f,p,g,v,b,x=0,m=0,y="data:";if(c.substr(0,y.length)===y)throw new Error("Invalid base64 input, it looks like a data url.");c=c.replace(/[^A-Za-z0-9+/=]/g,"");var w=c.length*3/4;if(c.charAt(c.length-1)===o.charAt(64)&&w--,c.charAt(c.length-2)===o.charAt(64)&&w--,w%1!==0)throw new Error("Invalid base64 input, bad content length.");var E;for(a.uint8array?E=new Uint8Array(w|0):E=new Array(w|0);x<c.length;)p=o.indexOf(c.charAt(x++)),g=o.indexOf(c.charAt(x++)),v=o.indexOf(c.charAt(x++)),b=o.indexOf(c.charAt(x++)),h=p<<2|g>>4,d=(g&15)<<4|v>>2,f=(v&3)<<6|b,E[m++]=h,v!==64&&(E[m++]=d),b!==64&&(E[m++]=f);return E}},{"./support":30,"./utils":32}],2:[function(t,i,s){var r=t("./external"),a=t("./stream/DataWorker"),o=t("./stream/Crc32Probe"),c=t("./stream/DataLengthProbe");function h(d,f,p,g,v){this.compressedSize=d,this.uncompressedSize=f,this.crc32=p,this.compression=g,this.compressedContent=v}h.prototype={getContentWorker:function(){var d=new a(r.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new c("data_length")),f=this;return d.on("end",function(){if(this.streamInfo.data_length!==f.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),d},getCompressedWorker:function(){return new a(r.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},h.createWorkerFrom=function(d,f,p){return d.pipe(new o).pipe(new c("uncompressedSize")).pipe(f.compressWorker(p)).pipe(new c("compressedSize")).withStreamInfo("compression",f)},i.exports=h},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,i,s){var r=t("./stream/GenericWorker");s.STORE={magic:"\0\0",compressWorker:function(){return new r("STORE compression")},uncompressWorker:function(){return new r("STORE decompression")}},s.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,i,s){var r=t("./utils");function a(){for(var d,f=[],p=0;p<256;p++){d=p;for(var g=0;g<8;g++)d=d&1?3988292384^d>>>1:d>>>1;f[p]=d}return f}var o=a();function c(d,f,p,g){var v=o,b=g+p;d=d^-1;for(var x=g;x<b;x++)d=d>>>8^v[(d^f[x])&255];return d^-1}function h(d,f,p,g){var v=o,b=g+p;d=d^-1;for(var x=g;x<b;x++)d=d>>>8^v[(d^f.charCodeAt(x))&255];return d^-1}i.exports=function(f,p){if(typeof f>"u"||!f.length)return 0;var g=r.getTypeOf(f)!=="string";return g?c(p|0,f,f.length,0):h(p|0,f,f.length,0)}},{"./utils":32}],5:[function(t,i,s){s.base64=!1,s.binary=!1,s.dir=!1,s.createFolders=!0,s.date=null,s.compression=null,s.compressionOptions=null,s.comment=null,s.unixPermissions=null,s.dosPermissions=null},{}],6:[function(t,i,s){var r=null;typeof Promise<"u"?r=Promise:r=t("lie"),i.exports={Promise:r}},{lie:37}],7:[function(t,i,s){var r=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",a=t("pako"),o=t("./utils"),c=t("./stream/GenericWorker"),h=r?"uint8array":"array";s.magic="\b\0";function d(f,p){c.call(this,"FlateWorker/"+f),this._pako=null,this._pakoAction=f,this._pakoOptions=p,this.meta={}}o.inherits(d,c),d.prototype.processChunk=function(f){this.meta=f.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(h,f.data),!1)},d.prototype.flush=function(){c.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},d.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this._pako=null},d.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var f=this;this._pako.onData=function(p){f.push({data:p,meta:f.meta})}},s.compressWorker=function(f){return new d("Deflate",f)},s.uncompressWorker=function(){return new d("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,i,s){var r=t("../utils"),a=t("../stream/GenericWorker"),o=t("../utf8"),c=t("../crc32"),h=t("../signature"),d=function(m,y){var w="",E;for(E=0;E<y;E++)w+=String.fromCharCode(m&255),m=m>>>8;return w},f=function(m,y){var w=m;return m||(w=y?16893:33204),(w&65535)<<16},p=function(m){return(m||0)&63},g=function(m,y,w,E,S,_){var T=m.file,j=m.compression,M=_!==o.utf8encode,L=r.transformTo("string",_(T.name)),O=r.transformTo("string",o.utf8encode(T.name)),B=T.comment,G=r.transformTo("string",_(B)),W=r.transformTo("string",o.utf8encode(B)),J=O.length!==T.name.length,V=W.length!==B.length,H,P,Y="",ge="",ae="",ee=T.dir,le=T.date,ie={crc32:0,compressedSize:0,uncompressedSize:0};(!y||w)&&(ie.crc32=m.crc32,ie.compressedSize=m.compressedSize,ie.uncompressedSize=m.uncompressedSize);var Q=0;y&&(Q|=8),!M&&(J||V)&&(Q|=2048);var Z=0,re=0;ee&&(Z|=16),S==="UNIX"?(re=798,Z|=f(T.unixPermissions,ee)):(re=20,Z|=p(T.dosPermissions)),H=le.getUTCHours(),H=H<<6,H=H|le.getUTCMinutes(),H=H<<5,H=H|le.getUTCSeconds()/2,P=le.getUTCFullYear()-1980,P=P<<4,P=P|le.getUTCMonth()+1,P=P<<5,P=P|le.getUTCDate(),J&&(ge=d(1,1)+d(c(L),4)+O,Y+="up"+d(ge.length,2)+ge),V&&(ae=d(1,1)+d(c(G),4)+W,Y+="uc"+d(ae.length,2)+ae);var se="";se+=`
\0`,se+=d(Q,2),se+=j.magic,se+=d(H,2),se+=d(P,2),se+=d(ie.crc32,4),se+=d(ie.compressedSize,4),se+=d(ie.uncompressedSize,4),se+=d(L.length,2),se+=d(Y.length,2);var be=h.LOCAL_FILE_HEADER+se+L+Y,pe=h.CENTRAL_FILE_HEADER+d(re,2)+se+d(G.length,2)+"\0\0\0\0"+d(Z,4)+d(E,4)+L+Y+G;return{fileRecord:be,dirRecord:pe}},v=function(m,y,w,E,S){var _="",T=r.transformTo("string",S(E));return _=h.CENTRAL_DIRECTORY_END+"\0\0\0\0"+d(m,2)+d(m,2)+d(y,4)+d(w,4)+d(T.length,2)+T,_},b=function(m){var y="";return y=h.DATA_DESCRIPTOR+d(m.crc32,4)+d(m.compressedSize,4)+d(m.uncompressedSize,4),y};function x(m,y,w,E){a.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=y,this.zipPlatform=w,this.encodeFileName=E,this.streamFiles=m,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}r.inherits(x,a),x.prototype.push=function(m){var y=m.meta.percent||0,w=this.entriesCount,E=this._sources.length;this.accumulate?this.contentBuffer.push(m):(this.bytesWritten+=m.data.length,a.prototype.push.call(this,{data:m.data,meta:{currentFile:this.currentFile,percent:w?(y+100*(w-E-1))/w:100}}))},x.prototype.openedSource=function(m){this.currentSourceOffset=this.bytesWritten,this.currentFile=m.file.name;var y=this.streamFiles&&!m.file.dir;if(y){var w=g(m,y,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:w.fileRecord,meta:{percent:0}})}else this.accumulate=!0},x.prototype.closedSource=function(m){this.accumulate=!1;var y=this.streamFiles&&!m.file.dir,w=g(m,y,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(w.dirRecord),y)this.push({data:b(m),meta:{percent:100}});else for(this.push({data:w.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},x.prototype.flush=function(){for(var m=this.bytesWritten,y=0;y<this.dirRecords.length;y++)this.push({data:this.dirRecords[y],meta:{percent:100}});var w=this.bytesWritten-m,E=v(this.dirRecords.length,w,m,this.zipComment,this.encodeFileName);this.push({data:E,meta:{percent:100}})},x.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},x.prototype.registerPrevious=function(m){this._sources.push(m);var y=this;return m.on("data",function(w){y.processChunk(w)}),m.on("end",function(){y.closedSource(y.previous.streamInfo),y._sources.length?y.prepareNextSource():y.end()}),m.on("error",function(w){y.error(w)}),this},x.prototype.resume=function(){if(!a.prototype.resume.call(this))return!1;if(!this.previous&&this._sources.length)return this.prepareNextSource(),!0;if(!this.previous&&!this._sources.length&&!this.generatedError)return this.end(),!0},x.prototype.error=function(m){var y=this._sources;if(!a.prototype.error.call(this,m))return!1;for(var w=0;w<y.length;w++)try{y[w].error(m)}catch{}return!0},x.prototype.lock=function(){a.prototype.lock.call(this);for(var m=this._sources,y=0;y<m.length;y++)m[y].lock()},i.exports=x},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,i,s){var r=t("../compressions"),a=t("./ZipFileWorker"),o=function(c,h){var d=c||h,f=r[d];if(!f)throw new Error(d+" is not a valid compression method !");return f};s.generateWorker=function(c,h,d){var f=new a(h.streamFiles,d,h.platform,h.encodeFileName),p=0;try{c.forEach(function(g,v){p++;var b=o(v.options.compression,h.compression),x=v.options.compressionOptions||h.compressionOptions||{},m=v.dir,y=v.date;v._compressWorker(b,x).withStreamInfo("file",{name:g,dir:m,date:y,comment:v.comment||"",unixPermissions:v.unixPermissions,dosPermissions:v.dosPermissions}).pipe(f)}),f.entriesCount=p}catch(g){f.error(g)}return f}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,i,s){function r(){if(!(this instanceof r))return new r;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new r;for(var o in this)typeof this[o]!="function"&&(a[o]=this[o]);return a}}r.prototype=t("./object"),r.prototype.loadAsync=t("./load"),r.support=t("./support"),r.defaults=t("./defaults"),r.version="3.10.1",r.loadAsync=function(a,o){return new r().loadAsync(a,o)},r.external=t("./external"),i.exports=r},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,i,s){var r=t("./utils"),a=t("./external"),o=t("./utf8"),c=t("./zipEntries"),h=t("./stream/Crc32Probe"),d=t("./nodejsUtils");function f(p){return new a.Promise(function(g,v){var b=p.decompressed.getContentWorker().pipe(new h);b.on("error",function(x){v(x)}).on("end",function(){b.streamInfo.crc32!==p.decompressed.crc32?v(new Error("Corrupted zip : CRC32 mismatch")):g()}).resume()})}i.exports=function(p,g){var v=this;return g=r.extend(g||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),d.isNode&&d.isStream(p)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):r.prepareContent("the loaded zip file",p,!0,g.optimizedBinaryString,g.base64).then(function(b){var x=new c(g);return x.load(b),x}).then(function(x){var m=[a.Promise.resolve(x)],y=x.files;if(g.checkCRC32)for(var w=0;w<y.length;w++)m.push(f(y[w]));return a.Promise.all(m)}).then(function(x){for(var m=x.shift(),y=m.files,w=0;w<y.length;w++){var E=y[w],S=E.fileNameStr,_=r.resolve(E.fileNameStr);v.file(_,E.decompressed,{binary:!0,optimizedBinaryString:!0,date:E.date,dir:E.dir,comment:E.fileCommentStr.length?E.fileCommentStr:null,unixPermissions:E.unixPermissions,dosPermissions:E.dosPermissions,createFolders:g.createFolders}),E.dir||(v.file(_).unsafeOriginalName=S)}return m.zipComment.length&&(v.comment=m.zipComment),v})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,i,s){var r=t("../utils"),a=t("../stream/GenericWorker");function o(c,h){a.call(this,"Nodejs stream input adapter for "+c),this._upstreamEnded=!1,this._bindStream(h)}r.inherits(o,a),o.prototype._bindStream=function(c){var h=this;this._stream=c,c.pause(),c.on("data",function(d){h.push({data:d,meta:{percent:0}})}).on("error",function(d){h.isPaused?this.generatedError=d:h.error(d)}).on("end",function(){h.isPaused?h._upstreamEnded=!0:h.end()})},o.prototype.pause=function(){return a.prototype.pause.call(this)?(this._stream.pause(),!0):!1},o.prototype.resume=function(){return a.prototype.resume.call(this)?(this._upstreamEnded?this.end():this._stream.resume(),!0):!1},i.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,i,s){var r=t("readable-stream").Readable,a=t("../utils");a.inherits(o,r);function o(c,h,d){r.call(this,h),this._helper=c;var f=this;c.on("data",function(p,g){f.push(p)||f._helper.pause(),d&&d(g)}).on("error",function(p){f.emit("error",p)}).on("end",function(){f.push(null)})}o.prototype._read=function(){this._helper.resume()},i.exports=o},{"../utils":32,"readable-stream":16}],14:[function(t,i,s){i.exports={isNode:typeof Buffer<"u",newBufferFrom:function(r,a){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(r,a);if(typeof r=="number")throw new Error('The "data" argument must not be a number');return new Buffer(r,a)},allocBuffer:function(r){if(Buffer.alloc)return Buffer.alloc(r);var a=new Buffer(r);return a.fill(0),a},isBuffer:function(r){return Buffer.isBuffer(r)},isStream:function(r){return r&&typeof r.on=="function"&&typeof r.pause=="function"&&typeof r.resume=="function"}}},{}],15:[function(t,i,s){var r=t("./utf8"),a=t("./utils"),o=t("./stream/GenericWorker"),c=t("./stream/StreamHelper"),h=t("./defaults"),d=t("./compressedObject"),f=t("./zipObject"),p=t("./generate"),g=t("./nodejsUtils"),v=t("./nodejs/NodejsStreamInputAdapter"),b=function(S,_,T){var j=a.getTypeOf(_),M,L=a.extend(T||{},h);L.date=L.date||new Date,L.compression!==null&&(L.compression=L.compression.toUpperCase()),typeof L.unixPermissions=="string"&&(L.unixPermissions=parseInt(L.unixPermissions,8)),L.unixPermissions&&L.unixPermissions&16384&&(L.dir=!0),L.dosPermissions&&L.dosPermissions&16&&(L.dir=!0),L.dir&&(S=m(S)),L.createFolders&&(M=x(S))&&y.call(this,M,!0);var O=j==="string"&&L.binary===!1&&L.base64===!1;(!T||typeof T.binary>"u")&&(L.binary=!O);var B=_ instanceof d&&_.uncompressedSize===0;(B||L.dir||!_||_.length===0)&&(L.base64=!1,L.binary=!0,_="",L.compression="STORE",j="string");var G=null;_ instanceof d||_ instanceof o?G=_:g.isNode&&g.isStream(_)?G=new v(S,_):G=a.prepareContent(S,_,L.binary,L.optimizedBinaryString,L.base64);var W=new f(S,G,L);this.files[S]=W},x=function(S){S.slice(-1)==="/"&&(S=S.substring(0,S.length-1));var _=S.lastIndexOf("/");return _>0?S.substring(0,_):""},m=function(S){return S.slice(-1)!=="/"&&(S+="/"),S},y=function(S,_){return _=typeof _<"u"?_:h.createFolders,S=m(S),this.files[S]||b.call(this,S,null,{dir:!0,createFolders:_}),this.files[S]};function w(S){return Object.prototype.toString.call(S)==="[object RegExp]"}var E={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(S){var _,T,j;for(_ in this.files)j=this.files[_],T=_.slice(this.root.length,_.length),T&&_.slice(0,this.root.length)===this.root&&S(T,j)},filter:function(S){var _=[];return this.forEach(function(T,j){S(T,j)&&_.push(j)}),_},file:function(S,_,T){if(arguments.length===1)if(w(S)){var j=S;return this.filter(function(L,O){return!O.dir&&j.test(L)})}else{var M=this.files[this.root+S];return M&&!M.dir?M:null}else S=this.root+S,b.call(this,S,_,T);return this},folder:function(S){if(!S)return this;if(w(S))return this.filter(function(M,L){return L.dir&&S.test(M)});var _=this.root+S,T=y.call(this,_),j=this.clone();return j.root=T.name,j},remove:function(S){S=this.root+S;var _=this.files[S];if(_||(S.slice(-1)!=="/"&&(S+="/"),_=this.files[S]),_&&!_.dir)delete this.files[S];else for(var T=this.filter(function(M,L){return L.name.slice(0,S.length)===S}),j=0;j<T.length;j++)delete this.files[T[j].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(S){var _,T={};try{if(T=a.extend(S||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:r.utf8encode}),T.type=T.type.toLowerCase(),T.compression=T.compression.toUpperCase(),T.type==="binarystring"&&(T.type="string"),!T.type)throw new Error("No output type specified.");a.checkSupport(T.type),(T.platform==="darwin"||T.platform==="freebsd"||T.platform==="linux"||T.platform==="sunos")&&(T.platform="UNIX"),T.platform==="win32"&&(T.platform="DOS");var j=T.comment||this.comment||"";_=p.generateWorker(this,T,j)}catch(M){_=new o("error"),_.error(M)}return new c(_,T.type||"string",T.mimeType)},generateAsync:function(S,_){return this.generateInternalStream(S).accumulate(_)},generateNodeStream:function(S,_){return S=S||{},S.type||(S.type="nodebuffer"),this.generateInternalStream(S).toNodejsStream(_)}};i.exports=E},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,i,s){i.exports=t("stream")},{stream:void 0}],17:[function(t,i,s){var r=t("./DataReader"),a=t("../utils");function o(c){r.call(this,c);for(var h=0;h<this.data.length;h++)c[h]=c[h]&255}a.inherits(o,r),o.prototype.byteAt=function(c){return this.data[this.zero+c]},o.prototype.lastIndexOfSignature=function(c){for(var h=c.charCodeAt(0),d=c.charCodeAt(1),f=c.charCodeAt(2),p=c.charCodeAt(3),g=this.length-4;g>=0;--g)if(this.data[g]===h&&this.data[g+1]===d&&this.data[g+2]===f&&this.data[g+3]===p)return g-this.zero;return-1},o.prototype.readAndCheckSignature=function(c){var h=c.charCodeAt(0),d=c.charCodeAt(1),f=c.charCodeAt(2),p=c.charCodeAt(3),g=this.readData(4);return h===g[0]&&d===g[1]&&f===g[2]&&p===g[3]},o.prototype.readData=function(c){if(this.checkOffset(c),c===0)return[];var h=this.data.slice(this.zero+this.index,this.zero+this.index+c);return this.index+=c,h},i.exports=o},{"../utils":32,"./DataReader":18}],18:[function(t,i,s){var r=t("../utils");function a(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(){},readInt:function(o){var c=0,h;for(this.checkOffset(o),h=this.index+o-1;h>=this.index;h--)c=(c<<8)+this.byteAt(h);return this.index+=o,c},readString:function(o){return r.transformTo("string",this.readData(o))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC((o>>25&127)+1980,(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(o&31)<<1))}},i.exports=a},{"../utils":32}],19:[function(t,i,s){var r=t("./Uint8ArrayReader"),a=t("../utils");function o(c){r.call(this,c)}a.inherits(o,r),o.prototype.readData=function(c){this.checkOffset(c);var h=this.data.slice(this.zero+this.index,this.zero+this.index+c);return this.index+=c,h},i.exports=o},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,i,s){var r=t("./DataReader"),a=t("../utils");function o(c){r.call(this,c)}a.inherits(o,r),o.prototype.byteAt=function(c){return this.data.charCodeAt(this.zero+c)},o.prototype.lastIndexOfSignature=function(c){return this.data.lastIndexOf(c)-this.zero},o.prototype.readAndCheckSignature=function(c){var h=this.readData(4);return c===h},o.prototype.readData=function(c){this.checkOffset(c);var h=this.data.slice(this.zero+this.index,this.zero+this.index+c);return this.index+=c,h},i.exports=o},{"../utils":32,"./DataReader":18}],21:[function(t,i,s){var r=t("./ArrayReader"),a=t("../utils");function o(c){r.call(this,c)}a.inherits(o,r),o.prototype.readData=function(c){if(this.checkOffset(c),c===0)return new Uint8Array(0);var h=this.data.subarray(this.zero+this.index,this.zero+this.index+c);return this.index+=c,h},i.exports=o},{"../utils":32,"./ArrayReader":17}],22:[function(t,i,s){var r=t("../utils"),a=t("../support"),o=t("./ArrayReader"),c=t("./StringReader"),h=t("./NodeBufferReader"),d=t("./Uint8ArrayReader");i.exports=function(f){var p=r.getTypeOf(f);return r.checkSupport(p),p==="string"&&!a.uint8array?new c(f):p==="nodebuffer"?new h(f):a.uint8array?new d(r.transformTo("uint8array",f)):new o(r.transformTo("array",f))}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,i,s){s.LOCAL_FILE_HEADER="PK",s.CENTRAL_FILE_HEADER="PK",s.CENTRAL_DIRECTORY_END="PK",s.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",s.ZIP64_CENTRAL_DIRECTORY_END="PK",s.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,i,s){var r=t("./GenericWorker"),a=t("../utils");function o(c){r.call(this,"ConvertWorker to "+c),this.destType=c}a.inherits(o,r),o.prototype.processChunk=function(c){this.push({data:a.transformTo(this.destType,c.data),meta:c.meta})},i.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(t,i,s){var r=t("./GenericWorker"),a=t("../crc32"),o=t("../utils");function c(){r.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}o.inherits(c,r),c.prototype.processChunk=function(h){this.streamInfo.crc32=a(h.data,this.streamInfo.crc32||0),this.push(h)},i.exports=c},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,i,s){var r=t("../utils"),a=t("./GenericWorker");function o(c){a.call(this,"DataLengthProbe for "+c),this.propName=c,this.withStreamInfo(c,0)}r.inherits(o,a),o.prototype.processChunk=function(c){if(c){var h=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=h+c.data.length}a.prototype.processChunk.call(this,c)},i.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(t,i,s){var r=t("../utils"),a=t("./GenericWorker"),o=16*1024;function c(h){a.call(this,"DataWorker");var d=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,h.then(function(f){d.dataIsReady=!0,d.data=f,d.max=f&&f.length||0,d.type=r.getTypeOf(f),d.isPaused||d._tickAndRepeat()},function(f){d.error(f)})}r.inherits(c,a),c.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},c.prototype.resume=function(){return a.prototype.resume.call(this)?(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,r.delay(this._tickAndRepeat,[],this)),!0):!1},c.prototype._tickAndRepeat=function(){this._tickScheduled=!1,!(this.isPaused||this.isFinished)&&(this._tick(),this.isFinished||(r.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},c.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var h=o,d=null,f=Math.min(this.max,this.index+h);if(this.index>=this.max)return this.end();switch(this.type){case"string":d=this.data.substring(this.index,f);break;case"uint8array":d=this.data.subarray(this.index,f);break;case"array":case"nodebuffer":d=this.data.slice(this.index,f);break}return this.index=f,this.push({data:d,meta:{percent:this.max?this.index/this.max*100:0}})},i.exports=c},{"../utils":32,"./GenericWorker":28}],28:[function(t,i,s){function r(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}r.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return this.isFinished?!1:(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,o){return this._listeners[a].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,o){if(this._listeners[a])for(var c=0;c<this._listeners[a].length;c++)this._listeners[a][c].call(this,o)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var o=this;return a.on("data",function(c){o.processChunk(c)}),a.on("end",function(){o.end()}),a.on("error",function(c){o.error(c)}),this},pause:function(){return this.isPaused||this.isFinished?!1:(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var a=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,o){return this.extraStreamInfo[a]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},i.exports=r},{}],29:[function(t,i,s){var r=t("../utils"),a=t("./ConvertWorker"),o=t("./GenericWorker"),c=t("../base64"),h=t("../support"),d=t("../external"),f=null;if(h.nodestream)try{f=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function p(x,m,y){switch(x){case"blob":return r.newBlob(r.transformTo("arraybuffer",m),y);case"base64":return c.encode(m);default:return r.transformTo(x,m)}}function g(x,m){var y,w=0,E=null,S=0;for(y=0;y<m.length;y++)S+=m[y].length;switch(x){case"string":return m.join("");case"array":return Array.prototype.concat.apply([],m);case"uint8array":for(E=new Uint8Array(S),y=0;y<m.length;y++)E.set(m[y],w),w+=m[y].length;return E;case"nodebuffer":return Buffer.concat(m);default:throw new Error("concat : unsupported type '"+x+"'")}}function v(x,m){return new d.Promise(function(y,w){var E=[],S=x._internalType,_=x._outputType,T=x._mimeType;x.on("data",function(j,M){E.push(j),m&&m(M)}).on("error",function(j){E=[],w(j)}).on("end",function(){try{var j=p(_,g(S,E),T);y(j)}catch(M){w(M)}E=[]}).resume()})}function b(x,m,y){var w=m;switch(m){case"blob":case"arraybuffer":w="uint8array";break;case"base64":w="string";break}try{this._internalType=w,this._outputType=m,this._mimeType=y,r.checkSupport(w),this._worker=x.pipe(new a(w)),x.lock()}catch(E){this._worker=new o("error"),this._worker.error(E)}}b.prototype={accumulate:function(x){return v(this,x)},on:function(x,m){var y=this;return x==="data"?this._worker.on(x,function(w){m.call(y,w.data,w.meta)}):this._worker.on(x,function(){r.delay(m,arguments,y)}),this},resume:function(){return r.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(x){if(r.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new f(this,{objectMode:this._outputType!=="nodebuffer"},x)}},i.exports=b},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,i,s){if(s.base64=!0,s.array=!0,s.string=!0,s.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",s.nodebuffer=typeof Buffer<"u",s.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")s.blob=!1;else{var r=new ArrayBuffer(0);try{s.blob=new Blob([r],{type:"application/zip"}).size===0}catch{try{var a=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,o=new a;o.append(r),s.blob=o.getBlob("application/zip").size===0}catch{s.blob=!1}}}try{s.nodestream=!!t("readable-stream").Readable}catch{s.nodestream=!1}},{"readable-stream":16}],31:[function(t,i,s){for(var r=t("./utils"),a=t("./support"),o=t("./nodejsUtils"),c=t("./stream/GenericWorker"),h=new Array(256),d=0;d<256;d++)h[d]=d>=252?6:d>=248?5:d>=240?4:d>=224?3:d>=192?2:1;h[254]=h[254]=1;var f=function(x){var m,y,w,E,S,_=x.length,T=0;for(E=0;E<_;E++)y=x.charCodeAt(E),(y&64512)===55296&&E+1<_&&(w=x.charCodeAt(E+1),(w&64512)===56320&&(y=65536+(y-55296<<10)+(w-56320),E++)),T+=y<128?1:y<2048?2:y<65536?3:4;for(a.uint8array?m=new Uint8Array(T):m=new Array(T),S=0,E=0;S<T;E++)y=x.charCodeAt(E),(y&64512)===55296&&E+1<_&&(w=x.charCodeAt(E+1),(w&64512)===56320&&(y=65536+(y-55296<<10)+(w-56320),E++)),y<128?m[S++]=y:y<2048?(m[S++]=192|y>>>6,m[S++]=128|y&63):y<65536?(m[S++]=224|y>>>12,m[S++]=128|y>>>6&63,m[S++]=128|y&63):(m[S++]=240|y>>>18,m[S++]=128|y>>>12&63,m[S++]=128|y>>>6&63,m[S++]=128|y&63);return m},p=function(x,m){var y;for(m=m||x.length,m>x.length&&(m=x.length),y=m-1;y>=0&&(x[y]&192)===128;)y--;return y<0||y===0?m:y+h[x[y]]>m?y:m},g=function(x){var m,y,w,E,S=x.length,_=new Array(S*2);for(y=0,m=0;m<S;){if(w=x[m++],w<128){_[y++]=w;continue}if(E=h[w],E>4){_[y++]=65533,m+=E-1;continue}for(w&=E===2?31:E===3?15:7;E>1&&m<S;)w=w<<6|x[m++]&63,E--;if(E>1){_[y++]=65533;continue}w<65536?_[y++]=w:(w-=65536,_[y++]=55296|w>>10&1023,_[y++]=56320|w&1023)}return _.length!==y&&(_.subarray?_=_.subarray(0,y):_.length=y),r.applyFromCharCode(_)};s.utf8encode=function(m){return a.nodebuffer?o.newBufferFrom(m,"utf-8"):f(m)},s.utf8decode=function(m){return a.nodebuffer?r.transformTo("nodebuffer",m).toString("utf-8"):(m=r.transformTo(a.uint8array?"uint8array":"array",m),g(m))};function v(){c.call(this,"utf-8 decode"),this.leftOver=null}r.inherits(v,c),v.prototype.processChunk=function(x){var m=r.transformTo(a.uint8array?"uint8array":"array",x.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var y=m;m=new Uint8Array(y.length+this.leftOver.length),m.set(this.leftOver,0),m.set(y,this.leftOver.length)}else m=this.leftOver.concat(m);this.leftOver=null}var w=p(m),E=m;w!==m.length&&(a.uint8array?(E=m.subarray(0,w),this.leftOver=m.subarray(w,m.length)):(E=m.slice(0,w),this.leftOver=m.slice(w,m.length))),this.push({data:s.utf8decode(E),meta:x.meta})},v.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:s.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},s.Utf8DecodeWorker=v;function b(){c.call(this,"utf-8 encode")}r.inherits(b,c),b.prototype.processChunk=function(x){this.push({data:s.utf8encode(x.data),meta:x.meta})},s.Utf8EncodeWorker=b},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,i,s){var r=t("./support"),a=t("./base64"),o=t("./nodejsUtils"),c=t("./external");t("setimmediate");function h(x){var m=null;return r.uint8array?m=new Uint8Array(x.length):m=new Array(x.length),f(x,m)}s.newBlob=function(x,m){s.checkSupport("blob");try{return new Blob([x],{type:m})}catch{try{var y=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,w=new y;return w.append(x),w.getBlob(m)}catch{throw new Error("Bug : can't construct the Blob.")}}};function d(x){return x}function f(x,m){for(var y=0;y<x.length;++y)m[y]=x.charCodeAt(y)&255;return m}var p={stringifyByChunk:function(x,m,y){var w=[],E=0,S=x.length;if(S<=y)return String.fromCharCode.apply(null,x);for(;E<S;)m==="array"||m==="nodebuffer"?w.push(String.fromCharCode.apply(null,x.slice(E,Math.min(E+y,S)))):w.push(String.fromCharCode.apply(null,x.subarray(E,Math.min(E+y,S)))),E+=y;return w.join("")},stringifyByChar:function(x){for(var m="",y=0;y<x.length;y++)m+=String.fromCharCode(x[y]);return m},applyCanBeUsed:{uint8array:function(){try{return r.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return r.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch{return!1}}()}};function g(x){var m=65536,y=s.getTypeOf(x),w=!0;if(y==="uint8array"?w=p.applyCanBeUsed.uint8array:y==="nodebuffer"&&(w=p.applyCanBeUsed.nodebuffer),w)for(;m>1;)try{return p.stringifyByChunk(x,y,m)}catch{m=Math.floor(m/2)}return p.stringifyByChar(x)}s.applyFromCharCode=g;function v(x,m){for(var y=0;y<x.length;y++)m[y]=x[y];return m}var b={};b.string={string:d,array:function(x){return f(x,new Array(x.length))},arraybuffer:function(x){return b.string.uint8array(x).buffer},uint8array:function(x){return f(x,new Uint8Array(x.length))},nodebuffer:function(x){return f(x,o.allocBuffer(x.length))}},b.array={string:g,array:d,arraybuffer:function(x){return new Uint8Array(x).buffer},uint8array:function(x){return new Uint8Array(x)},nodebuffer:function(x){return o.newBufferFrom(x)}},b.arraybuffer={string:function(x){return g(new Uint8Array(x))},array:function(x){return v(new Uint8Array(x),new Array(x.byteLength))},arraybuffer:d,uint8array:function(x){return new Uint8Array(x)},nodebuffer:function(x){return o.newBufferFrom(new Uint8Array(x))}},b.uint8array={string:g,array:function(x){return v(x,new Array(x.length))},arraybuffer:function(x){return x.buffer},uint8array:d,nodebuffer:function(x){return o.newBufferFrom(x)}},b.nodebuffer={string:g,array:function(x){return v(x,new Array(x.length))},arraybuffer:function(x){return b.nodebuffer.uint8array(x).buffer},uint8array:function(x){return v(x,new Uint8Array(x.length))},nodebuffer:d},s.transformTo=function(x,m){if(m||(m=""),!x)return m;s.checkSupport(x);var y=s.getTypeOf(m),w=b[y][x](m);return w},s.resolve=function(x){for(var m=x.split("/"),y=[],w=0;w<m.length;w++){var E=m[w];E==="."||E===""&&w!==0&&w!==m.length-1||(E===".."?y.pop():y.push(E))}return y.join("/")},s.getTypeOf=function(x){if(typeof x=="string")return"string";if(Object.prototype.toString.call(x)==="[object Array]")return"array";if(r.nodebuffer&&o.isBuffer(x))return"nodebuffer";if(r.uint8array&&x instanceof Uint8Array)return"uint8array";if(r.arraybuffer&&x instanceof ArrayBuffer)return"arraybuffer"},s.checkSupport=function(x){var m=r[x.toLowerCase()];if(!m)throw new Error(x+" is not supported by this platform")},s.MAX_VALUE_16BITS=65535,s.MAX_VALUE_32BITS=-1,s.pretty=function(x){var m="",y,w;for(w=0;w<(x||"").length;w++)y=x.charCodeAt(w),m+="\\x"+(y<16?"0":"")+y.toString(16).toUpperCase();return m},s.delay=function(x,m,y){setImmediate(function(){x.apply(y||null,m||[])})},s.inherits=function(x,m){var y=function(){};y.prototype=m.prototype,x.prototype=new y},s.extend=function(){var x={},m,y;for(m=0;m<arguments.length;m++)for(y in arguments[m])Object.prototype.hasOwnProperty.call(arguments[m],y)&&typeof x[y]>"u"&&(x[y]=arguments[m][y]);return x},s.prepareContent=function(x,m,y,w,E){var S=c.Promise.resolve(m).then(function(_){var T=r.blob&&(_ instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(_))!==-1);return T&&typeof FileReader<"u"?new c.Promise(function(j,M){var L=new FileReader;L.onload=function(O){j(O.target.result)},L.onerror=function(O){M(O.target.error)},L.readAsArrayBuffer(_)}):_});return S.then(function(_){var T=s.getTypeOf(_);return T?(T==="arraybuffer"?_=s.transformTo("uint8array",_):T==="string"&&(E?_=a.decode(_):y&&w!==!0&&(_=h(_))),_):c.Promise.reject(new Error("Can't read the data of '"+x+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,i,s){var r=t("./reader/readerFor"),a=t("./utils"),o=t("./signature"),c=t("./zipEntry"),h=t("./support");function d(f){this.files=[],this.loadOptions=f}d.prototype={checkSignature:function(f){if(!this.reader.readAndCheckSignature(f)){this.reader.index-=4;var p=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(p)+", expected "+a.pretty(f)+")")}},isSignature:function(f,p){var g=this.reader.index;this.reader.setIndex(f);var v=this.reader.readString(4),b=v===p;return this.reader.setIndex(g),b},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var f=this.reader.readData(this.zipCommentLength),p=h.uint8array?"uint8array":"array",g=a.transformTo(p,f);this.zipComment=this.loadOptions.decodeFileName(g)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var f=this.zip64EndOfCentralSize-44,p=0,g,v,b;p<f;)g=this.reader.readInt(2),v=this.reader.readInt(4),b=this.reader.readData(v),this.zip64ExtensibleData[g]={id:g,length:v,value:b}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var f,p;for(f=0;f<this.files.length;f++)p=this.files[f],this.reader.setIndex(p.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),p.readLocalPart(this.reader),p.handleUTF8(),p.processAttributes()},readCentralDir:function(){var f;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)f=new c({zip64:this.zip64},this.loadOptions),f.readCentralPart(this.reader),this.files.push(f);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var f=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(f<0){var p=!this.isSignature(0,o.LOCAL_FILE_HEADER);throw p?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory")}this.reader.setIndex(f);var g=f;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,f=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),f<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(f),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var v=this.centralDirOffset+this.centralDirSize;this.zip64&&(v+=20,v+=12+this.zip64EndOfCentralSize);var b=g-v;if(b>0)this.isSignature(g,o.CENTRAL_FILE_HEADER)||(this.reader.zero=b);else if(b<0)throw new Error("Corrupted zip: missing "+Math.abs(b)+" bytes.")},prepareReader:function(f){this.reader=r(f)},load:function(f){this.prepareReader(f),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},i.exports=d},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,i,s){var r=t("./reader/readerFor"),a=t("./utils"),o=t("./compressedObject"),c=t("./crc32"),h=t("./utf8"),d=t("./compressions"),f=t("./support"),p=0,g=3,v=function(x){for(var m in d)if(Object.prototype.hasOwnProperty.call(d,m)&&d[m].magic===x)return d[m];return null};function b(x,m){this.options=x,this.loadOptions=m}b.prototype={isEncrypted:function(){return(this.bitFlag&1)===1},useUTF8:function(){return(this.bitFlag&2048)===2048},readLocalPart:function(x){var m,y;if(x.skip(22),this.fileNameLength=x.readInt(2),y=x.readInt(2),this.fileName=x.readData(this.fileNameLength),x.skip(y),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(m=v(this.compressionMethod),m===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,m,x.readData(this.compressedSize))},readCentralPart:function(x){this.versionMadeBy=x.readInt(2),x.skip(2),this.bitFlag=x.readInt(2),this.compressionMethod=x.readString(2),this.date=x.readDate(),this.crc32=x.readInt(4),this.compressedSize=x.readInt(4),this.uncompressedSize=x.readInt(4);var m=x.readInt(2);if(this.extraFieldsLength=x.readInt(2),this.fileCommentLength=x.readInt(2),this.diskNumberStart=x.readInt(2),this.internalFileAttributes=x.readInt(2),this.externalFileAttributes=x.readInt(4),this.localHeaderOffset=x.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");x.skip(m),this.readExtraFields(x),this.parseZIP64ExtraField(x),this.fileComment=x.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var x=this.versionMadeBy>>8;this.dir=!!(this.externalFileAttributes&16),x===p&&(this.dosPermissions=this.externalFileAttributes&63),x===g&&(this.unixPermissions=this.externalFileAttributes>>16&65535),!this.dir&&this.fileNameStr.slice(-1)==="/"&&(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var x=r(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=x.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=x.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=x.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=x.readInt(4))}},readExtraFields:function(x){var m=x.index+this.extraFieldsLength,y,w,E;for(this.extraFields||(this.extraFields={});x.index+4<m;)y=x.readInt(2),w=x.readInt(2),E=x.readData(w),this.extraFields[y]={id:y,length:w,value:E};x.setIndex(m)},handleUTF8:function(){var x=f.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=h.utf8decode(this.fileName),this.fileCommentStr=h.utf8decode(this.fileComment);else{var m=this.findExtraFieldUnicodePath();if(m!==null)this.fileNameStr=m;else{var y=a.transformTo(x,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(y)}var w=this.findExtraFieldUnicodeComment();if(w!==null)this.fileCommentStr=w;else{var E=a.transformTo(x,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(E)}}},findExtraFieldUnicodePath:function(){var x=this.extraFields[28789];if(x){var m=r(x.value);return m.readInt(1)!==1||c(this.fileName)!==m.readInt(4)?null:h.utf8decode(m.readData(x.length-5))}return null},findExtraFieldUnicodeComment:function(){var x=this.extraFields[25461];if(x){var m=r(x.value);return m.readInt(1)!==1||c(this.fileComment)!==m.readInt(4)?null:h.utf8decode(m.readData(x.length-5))}return null}},i.exports=b},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,i,s){var r=t("./stream/StreamHelper"),a=t("./stream/DataWorker"),o=t("./utf8"),c=t("./compressedObject"),h=t("./stream/GenericWorker"),d=function(v,b,x){this.name=v,this.dir=x.dir,this.date=x.date,this.comment=x.comment,this.unixPermissions=x.unixPermissions,this.dosPermissions=x.dosPermissions,this._data=b,this._dataBinary=x.binary,this.options={compression:x.compression,compressionOptions:x.compressionOptions}};d.prototype={internalStream:function(v){var b=null,x="string";try{if(!v)throw new Error("No output type specified.");x=v.toLowerCase();var m=x==="string"||x==="text";(x==="binarystring"||x==="text")&&(x="string"),b=this._decompressWorker();var y=!this._dataBinary;y&&!m&&(b=b.pipe(new o.Utf8EncodeWorker)),!y&&m&&(b=b.pipe(new o.Utf8DecodeWorker))}catch(w){b=new h("error"),b.error(w)}return new r(b,x,"")},async:function(v,b){return this.internalStream(v).accumulate(b)},nodeStream:function(v,b){return this.internalStream(v||"nodebuffer").toNodejsStream(b)},_compressWorker:function(v,b){if(this._data instanceof c&&this._data.compression.magic===v.magic)return this._data.getCompressedWorker();var x=this._decompressWorker();return this._dataBinary||(x=x.pipe(new o.Utf8EncodeWorker)),c.createWorkerFrom(x,v,b)},_decompressWorker:function(){return this._data instanceof c?this._data.getContentWorker():this._data instanceof h?this._data:new a(this._data)}};for(var f=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],p=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},g=0;g<f.length;g++)d.prototype[f[g]]=p;i.exports=d},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,i,s){(function(r){var a=r.MutationObserver||r.WebKitMutationObserver,o;if(a){var c=0,h=new a(v),d=r.document.createTextNode("");h.observe(d,{characterData:!0}),o=function(){d.data=c=++c%2}}else if(!r.setImmediate&&typeof r.MessageChannel<"u"){var f=new r.MessageChannel;f.port1.onmessage=v,o=function(){f.port2.postMessage(0)}}else"document"in r&&"onreadystatechange"in r.document.createElement("script")?o=function(){var x=r.document.createElement("script");x.onreadystatechange=function(){v(),x.onreadystatechange=null,x.parentNode.removeChild(x),x=null},r.document.documentElement.appendChild(x)}:o=function(){setTimeout(v,0)};var p,g=[];function v(){p=!0;for(var x,m,y=g.length;y;){for(m=g,g=[],x=-1;++x<y;)m[x]();y=g.length}p=!1}i.exports=b;function b(x){g.push(x)===1&&!p&&o()}}).call(this,typeof zr<"u"?zr:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,i,s){var r=t("immediate");function a(){}var o={},c=["REJECTED"],h=["FULFILLED"],d=["PENDING"];i.exports=f;function f(S){if(typeof S!="function")throw new TypeError("resolver must be a function");this.state=d,this.queue=[],this.outcome=void 0,S!==a&&b(this,S)}f.prototype.finally=function(S){if(typeof S!="function")return this;var _=this.constructor;return this.then(T,j);function T(M){function L(){return M}return _.resolve(S()).then(L)}function j(M){function L(){throw M}return _.resolve(S()).then(L)}},f.prototype.catch=function(S){return this.then(null,S)},f.prototype.then=function(S,_){if(typeof S!="function"&&this.state===h||typeof _!="function"&&this.state===c)return this;var T=new this.constructor(a);if(this.state!==d){var j=this.state===h?S:_;g(T,j,this.outcome)}else this.queue.push(new p(T,S,_));return T};function p(S,_,T){this.promise=S,typeof _=="function"&&(this.onFulfilled=_,this.callFulfilled=this.otherCallFulfilled),typeof T=="function"&&(this.onRejected=T,this.callRejected=this.otherCallRejected)}p.prototype.callFulfilled=function(S){o.resolve(this.promise,S)},p.prototype.otherCallFulfilled=function(S){g(this.promise,this.onFulfilled,S)},p.prototype.callRejected=function(S){o.reject(this.promise,S)},p.prototype.otherCallRejected=function(S){g(this.promise,this.onRejected,S)};function g(S,_,T){r(function(){var j;try{j=_(T)}catch(M){return o.reject(S,M)}j===S?o.reject(S,new TypeError("Cannot resolve promise with itself")):o.resolve(S,j)})}o.resolve=function(S,_){var T=x(v,_);if(T.status==="error")return o.reject(S,T.value);var j=T.value;if(j)b(S,j);else{S.state=h,S.outcome=_;for(var M=-1,L=S.queue.length;++M<L;)S.queue[M].callFulfilled(_)}return S},o.reject=function(S,_){S.state=c,S.outcome=_;for(var T=-1,j=S.queue.length;++T<j;)S.queue[T].callRejected(_);return S};function v(S){var _=S&&S.then;if(S&&(typeof S=="object"||typeof S=="function")&&typeof _=="function")return function(){_.apply(S,arguments)}}function b(S,_){var T=!1;function j(B){T||(T=!0,o.reject(S,B))}function M(B){T||(T=!0,o.resolve(S,B))}function L(){_(M,j)}var O=x(L);O.status==="error"&&j(O.value)}function x(S,_){var T={};try{T.value=S(_),T.status="success"}catch(j){T.status="error",T.value=j}return T}f.resolve=m;function m(S){return S instanceof this?S:o.resolve(new this(a),S)}f.reject=y;function y(S){var _=new this(a);return o.reject(_,S)}f.all=w;function w(S){var _=this;if(Object.prototype.toString.call(S)!=="[object Array]")return this.reject(new TypeError("must be an array"));var T=S.length,j=!1;if(!T)return this.resolve([]);for(var M=new Array(T),L=0,O=-1,B=new this(a);++O<T;)G(S[O],O);return B;function G(W,J){_.resolve(W).then(V,function(H){j||(j=!0,o.reject(B,H))});function V(H){M[J]=H,++L===T&&!j&&(j=!0,o.resolve(B,M))}}}f.race=E;function E(S){var _=this;if(Object.prototype.toString.call(S)!=="[object Array]")return this.reject(new TypeError("must be an array"));var T=S.length,j=!1;if(!T)return this.resolve([]);for(var M=-1,L=new this(a);++M<T;)O(S[M]);return L;function O(B){_.resolve(B).then(function(G){j||(j=!0,o.resolve(L,G))},function(G){j||(j=!0,o.reject(L,G))})}}},{immediate:36}],38:[function(t,i,s){var r=t("./lib/utils/common").assign,a=t("./lib/deflate"),o=t("./lib/inflate"),c=t("./lib/zlib/constants"),h={};r(h,a,o,c),i.exports=h},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,i,s){var r=t("./zlib/deflate"),a=t("./utils/common"),o=t("./utils/strings"),c=t("./zlib/messages"),h=t("./zlib/zstream"),d=Object.prototype.toString,f=0,p=4,g=0,v=1,b=2,x=-1,m=0,y=8;function w(T){if(!(this instanceof w))return new w(T);this.options=a.assign({level:x,method:y,chunkSize:16384,windowBits:15,memLevel:8,strategy:m,to:""},T||{});var j=this.options;j.raw&&j.windowBits>0?j.windowBits=-j.windowBits:j.gzip&&j.windowBits>0&&j.windowBits<16&&(j.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var M=r.deflateInit2(this.strm,j.level,j.method,j.windowBits,j.memLevel,j.strategy);if(M!==g)throw new Error(c[M]);if(j.header&&r.deflateSetHeader(this.strm,j.header),j.dictionary){var L;if(typeof j.dictionary=="string"?L=o.string2buf(j.dictionary):d.call(j.dictionary)==="[object ArrayBuffer]"?L=new Uint8Array(j.dictionary):L=j.dictionary,M=r.deflateSetDictionary(this.strm,L),M!==g)throw new Error(c[M]);this._dict_set=!0}}w.prototype.push=function(T,j){var M=this.strm,L=this.options.chunkSize,O,B;if(this.ended)return!1;B=j===~~j?j:j===!0?p:f,typeof T=="string"?M.input=o.string2buf(T):d.call(T)==="[object ArrayBuffer]"?M.input=new Uint8Array(T):M.input=T,M.next_in=0,M.avail_in=M.input.length;do{if(M.avail_out===0&&(M.output=new a.Buf8(L),M.next_out=0,M.avail_out=L),O=r.deflate(M,B),O!==v&&O!==g)return this.onEnd(O),this.ended=!0,!1;(M.avail_out===0||M.avail_in===0&&(B===p||B===b))&&(this.options.to==="string"?this.onData(o.buf2binstring(a.shrinkBuf(M.output,M.next_out))):this.onData(a.shrinkBuf(M.output,M.next_out)))}while((M.avail_in>0||M.avail_out===0)&&O!==v);return B===p?(O=r.deflateEnd(this.strm),this.onEnd(O),this.ended=!0,O===g):(B===b&&(this.onEnd(g),M.avail_out=0),!0)},w.prototype.onData=function(T){this.chunks.push(T)},w.prototype.onEnd=function(T){T===g&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=T,this.msg=this.strm.msg};function E(T,j){var M=new w(j);if(M.push(T,!0),M.err)throw M.msg||c[M.err];return M.result}function S(T,j){return j=j||{},j.raw=!0,E(T,j)}function _(T,j){return j=j||{},j.gzip=!0,E(T,j)}s.Deflate=w,s.deflate=E,s.deflateRaw=S,s.gzip=_},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,i,s){var r=t("./zlib/inflate"),a=t("./utils/common"),o=t("./utils/strings"),c=t("./zlib/constants"),h=t("./zlib/messages"),d=t("./zlib/zstream"),f=t("./zlib/gzheader"),p=Object.prototype.toString;function g(x){if(!(this instanceof g))return new g(x);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},x||{});var m=this.options;m.raw&&m.windowBits>=0&&m.windowBits<16&&(m.windowBits=-m.windowBits,m.windowBits===0&&(m.windowBits=-15)),m.windowBits>=0&&m.windowBits<16&&!(x&&x.windowBits)&&(m.windowBits+=32),m.windowBits>15&&m.windowBits<48&&(m.windowBits&15||(m.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var y=r.inflateInit2(this.strm,m.windowBits);if(y!==c.Z_OK)throw new Error(h[y]);this.header=new f,r.inflateGetHeader(this.strm,this.header)}g.prototype.push=function(x,m){var y=this.strm,w=this.options.chunkSize,E=this.options.dictionary,S,_,T,j,M,L,O=!1;if(this.ended)return!1;_=m===~~m?m:m===!0?c.Z_FINISH:c.Z_NO_FLUSH,typeof x=="string"?y.input=o.binstring2buf(x):p.call(x)==="[object ArrayBuffer]"?y.input=new Uint8Array(x):y.input=x,y.next_in=0,y.avail_in=y.input.length;do{if(y.avail_out===0&&(y.output=new a.Buf8(w),y.next_out=0,y.avail_out=w),S=r.inflate(y,c.Z_NO_FLUSH),S===c.Z_NEED_DICT&&E&&(typeof E=="string"?L=o.string2buf(E):p.call(E)==="[object ArrayBuffer]"?L=new Uint8Array(E):L=E,S=r.inflateSetDictionary(this.strm,L)),S===c.Z_BUF_ERROR&&O===!0&&(S=c.Z_OK,O=!1),S!==c.Z_STREAM_END&&S!==c.Z_OK)return this.onEnd(S),this.ended=!0,!1;y.next_out&&(y.avail_out===0||S===c.Z_STREAM_END||y.avail_in===0&&(_===c.Z_FINISH||_===c.Z_SYNC_FLUSH))&&(this.options.to==="string"?(T=o.utf8border(y.output,y.next_out),j=y.next_out-T,M=o.buf2string(y.output,T),y.next_out=j,y.avail_out=w-j,j&&a.arraySet(y.output,y.output,T,j,0),this.onData(M)):this.onData(a.shrinkBuf(y.output,y.next_out))),y.avail_in===0&&y.avail_out===0&&(O=!0)}while((y.avail_in>0||y.avail_out===0)&&S!==c.Z_STREAM_END);return S===c.Z_STREAM_END&&(_=c.Z_FINISH),_===c.Z_FINISH?(S=r.inflateEnd(this.strm),this.onEnd(S),this.ended=!0,S===c.Z_OK):(_===c.Z_SYNC_FLUSH&&(this.onEnd(c.Z_OK),y.avail_out=0),!0)},g.prototype.onData=function(x){this.chunks.push(x)},g.prototype.onEnd=function(x){x===c.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=x,this.msg=this.strm.msg};function v(x,m){var y=new g(m);if(y.push(x,!0),y.err)throw y.msg||h[y.err];return y.result}function b(x,m){return m=m||{},m.raw=!0,v(x,m)}s.Inflate=g,s.inflate=v,s.inflateRaw=b,s.ungzip=v},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,i,s){var r=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";s.assign=function(c){for(var h=Array.prototype.slice.call(arguments,1);h.length;){var d=h.shift();if(d){if(typeof d!="object")throw new TypeError(d+"must be non-object");for(var f in d)d.hasOwnProperty(f)&&(c[f]=d[f])}}return c},s.shrinkBuf=function(c,h){return c.length===h?c:c.subarray?c.subarray(0,h):(c.length=h,c)};var a={arraySet:function(c,h,d,f,p){if(h.subarray&&c.subarray){c.set(h.subarray(d,d+f),p);return}for(var g=0;g<f;g++)c[p+g]=h[d+g]},flattenChunks:function(c){var h,d,f,p,g,v;for(f=0,h=0,d=c.length;h<d;h++)f+=c[h].length;for(v=new Uint8Array(f),p=0,h=0,d=c.length;h<d;h++)g=c[h],v.set(g,p),p+=g.length;return v}},o={arraySet:function(c,h,d,f,p){for(var g=0;g<f;g++)c[p+g]=h[d+g]},flattenChunks:function(c){return[].concat.apply([],c)}};s.setTyped=function(c){c?(s.Buf8=Uint8Array,s.Buf16=Uint16Array,s.Buf32=Int32Array,s.assign(s,a)):(s.Buf8=Array,s.Buf16=Array,s.Buf32=Array,s.assign(s,o))},s.setTyped(r)},{}],42:[function(t,i,s){var r=t("./common"),a=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{o=!1}for(var c=new r.Buf8(256),h=0;h<256;h++)c[h]=h>=252?6:h>=248?5:h>=240?4:h>=224?3:h>=192?2:1;c[254]=c[254]=1,s.string2buf=function(f){var p,g,v,b,x,m=f.length,y=0;for(b=0;b<m;b++)g=f.charCodeAt(b),(g&64512)===55296&&b+1<m&&(v=f.charCodeAt(b+1),(v&64512)===56320&&(g=65536+(g-55296<<10)+(v-56320),b++)),y+=g<128?1:g<2048?2:g<65536?3:4;for(p=new r.Buf8(y),x=0,b=0;x<y;b++)g=f.charCodeAt(b),(g&64512)===55296&&b+1<m&&(v=f.charCodeAt(b+1),(v&64512)===56320&&(g=65536+(g-55296<<10)+(v-56320),b++)),g<128?p[x++]=g:g<2048?(p[x++]=192|g>>>6,p[x++]=128|g&63):g<65536?(p[x++]=224|g>>>12,p[x++]=128|g>>>6&63,p[x++]=128|g&63):(p[x++]=240|g>>>18,p[x++]=128|g>>>12&63,p[x++]=128|g>>>6&63,p[x++]=128|g&63);return p};function d(f,p){if(p<65537&&(f.subarray&&o||!f.subarray&&a))return String.fromCharCode.apply(null,r.shrinkBuf(f,p));for(var g="",v=0;v<p;v++)g+=String.fromCharCode(f[v]);return g}s.buf2binstring=function(f){return d(f,f.length)},s.binstring2buf=function(f){for(var p=new r.Buf8(f.length),g=0,v=p.length;g<v;g++)p[g]=f.charCodeAt(g);return p},s.buf2string=function(f,p){var g,v,b,x,m=p||f.length,y=new Array(m*2);for(v=0,g=0;g<m;){if(b=f[g++],b<128){y[v++]=b;continue}if(x=c[b],x>4){y[v++]=65533,g+=x-1;continue}for(b&=x===2?31:x===3?15:7;x>1&&g<m;)b=b<<6|f[g++]&63,x--;if(x>1){y[v++]=65533;continue}b<65536?y[v++]=b:(b-=65536,y[v++]=55296|b>>10&1023,y[v++]=56320|b&1023)}return d(y,v)},s.utf8border=function(f,p){var g;for(p=p||f.length,p>f.length&&(p=f.length),g=p-1;g>=0&&(f[g]&192)===128;)g--;return g<0||g===0?p:g+c[f[g]]>p?g:p}},{"./common":41}],43:[function(t,i,s){function r(a,o,c,h){for(var d=a&65535|0,f=a>>>16&65535|0,p=0;c!==0;){p=c>2e3?2e3:c,c-=p;do d=d+o[h++]|0,f=f+d|0;while(--p);d%=65521,f%=65521}return d|f<<16|0}i.exports=r},{}],44:[function(t,i,s){i.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,i,s){function r(){for(var c,h=[],d=0;d<256;d++){c=d;for(var f=0;f<8;f++)c=c&1?3988292384^c>>>1:c>>>1;h[d]=c}return h}var a=r();function o(c,h,d,f){var p=a,g=f+d;c^=-1;for(var v=f;v<g;v++)c=c>>>8^p[(c^h[v])&255];return c^-1}i.exports=o},{}],46:[function(t,i,s){var r=t("../utils/common"),a=t("./trees"),o=t("./adler32"),c=t("./crc32"),h=t("./messages"),d=0,f=1,p=3,g=4,v=5,b=0,x=1,m=-2,y=-3,w=-5,E=-1,S=1,_=2,T=3,j=4,M=0,L=2,O=8,B=9,G=15,W=8,J=29,V=256,H=V+1+J,P=30,Y=19,ge=2*H+1,ae=15,ee=3,le=258,ie=le+ee+1,Q=32,Z=42,re=69,se=73,be=91,pe=103,me=113,Ne=666,ve=1,_e=2,We=3,Ie=4,Re=3;function Ze(N,oe){return N.msg=h[oe],oe}function it(N){return(N<<1)-(N>4?9:0)}function tt(N){for(var oe=N.length;--oe>=0;)N[oe]=0}function rt(N){var oe=N.state,xe=oe.pending;xe>N.avail_out&&(xe=N.avail_out),xe!==0&&(r.arraySet(N.output,oe.pending_buf,oe.pending_out,xe,N.next_out),N.next_out+=xe,oe.pending_out+=xe,N.total_out+=xe,N.avail_out-=xe,oe.pending-=xe,oe.pending===0&&(oe.pending_out=0))}function at(N,oe){a._tr_flush_block(N,N.block_start>=0?N.block_start:-1,N.strstart-N.block_start,oe),N.block_start=N.strstart,rt(N.strm)}function ze(N,oe){N.pending_buf[N.pending++]=oe}function ft(N,oe){N.pending_buf[N.pending++]=oe>>>8&255,N.pending_buf[N.pending++]=oe&255}function Kt(N,oe,xe,I){var te=N.avail_in;return te>I&&(te=I),te===0?0:(N.avail_in-=te,r.arraySet(oe,N.input,N.next_in,te,xe),N.state.wrap===1?N.adler=o(N.adler,oe,te,xe):N.state.wrap===2&&(N.adler=c(N.adler,oe,te,xe)),N.next_in+=te,N.total_in+=te,te)}function he(N,oe){var xe=N.max_chain_length,I=N.strstart,te,ye,Ke=N.prev_length,He=N.nice_match,Ve=N.strstart>N.w_size-ie?N.strstart-(N.w_size-ie):0,At=N.window,Gr=N.w_mask,vn=N.prev,kt=N.strstart+le,In=At[I+Ke-1],ui=At[I+Ke];N.prev_length>=N.good_match&&(xe>>=2),He>N.lookahead&&(He=N.lookahead);do if(te=oe,!(At[te+Ke]!==ui||At[te+Ke-1]!==In||At[te]!==At[I]||At[++te]!==At[I+1])){I+=2,te++;do;while(At[++I]===At[++te]&&At[++I]===At[++te]&&At[++I]===At[++te]&&At[++I]===At[++te]&&At[++I]===At[++te]&&At[++I]===At[++te]&&At[++I]===At[++te]&&At[++I]===At[++te]&&I<kt);if(ye=le-(kt-I),I=kt-le,ye>Ke){if(N.match_start=oe,Ke=ye,ye>=He)break;In=At[I+Ke-1],ui=At[I+Ke]}}while((oe=vn[oe&Gr])>Ve&&--xe!==0);return Ke<=N.lookahead?Ke:N.lookahead}function X(N){var oe=N.w_size,xe,I,te,ye,Ke;do{if(ye=N.window_size-N.lookahead-N.strstart,N.strstart>=oe+(oe-ie)){r.arraySet(N.window,N.window,oe,oe,0),N.match_start-=oe,N.strstart-=oe,N.block_start-=oe,I=N.hash_size,xe=I;do te=N.head[--xe],N.head[xe]=te>=oe?te-oe:0;while(--I);I=oe,xe=I;do te=N.prev[--xe],N.prev[xe]=te>=oe?te-oe:0;while(--I);ye+=oe}if(N.strm.avail_in===0)break;if(I=Kt(N.strm,N.window,N.strstart+N.lookahead,ye),N.lookahead+=I,N.lookahead+N.insert>=ee)for(Ke=N.strstart-N.insert,N.ins_h=N.window[Ke],N.ins_h=(N.ins_h<<N.hash_shift^N.window[Ke+1])&N.hash_mask;N.insert&&(N.ins_h=(N.ins_h<<N.hash_shift^N.window[Ke+ee-1])&N.hash_mask,N.prev[Ke&N.w_mask]=N.head[N.ins_h],N.head[N.ins_h]=Ke,Ke++,N.insert--,!(N.lookahead+N.insert<ee)););}while(N.lookahead<ie&&N.strm.avail_in!==0)}function je(N,oe){var xe=65535;for(xe>N.pending_buf_size-5&&(xe=N.pending_buf_size-5);;){if(N.lookahead<=1){if(X(N),N.lookahead===0&&oe===d)return ve;if(N.lookahead===0)break}N.strstart+=N.lookahead,N.lookahead=0;var I=N.block_start+xe;if((N.strstart===0||N.strstart>=I)&&(N.lookahead=N.strstart-I,N.strstart=I,at(N,!1),N.strm.avail_out===0)||N.strstart-N.block_start>=N.w_size-ie&&(at(N,!1),N.strm.avail_out===0))return ve}return N.insert=0,oe===g?(at(N,!0),N.strm.avail_out===0?We:Ie):(N.strstart>N.block_start&&(at(N,!1),N.strm.avail_out===0),ve)}function qe(N,oe){for(var xe,I;;){if(N.lookahead<ie){if(X(N),N.lookahead<ie&&oe===d)return ve;if(N.lookahead===0)break}if(xe=0,N.lookahead>=ee&&(N.ins_h=(N.ins_h<<N.hash_shift^N.window[N.strstart+ee-1])&N.hash_mask,xe=N.prev[N.strstart&N.w_mask]=N.head[N.ins_h],N.head[N.ins_h]=N.strstart),xe!==0&&N.strstart-xe<=N.w_size-ie&&(N.match_length=he(N,xe)),N.match_length>=ee)if(I=a._tr_tally(N,N.strstart-N.match_start,N.match_length-ee),N.lookahead-=N.match_length,N.match_length<=N.max_lazy_match&&N.lookahead>=ee){N.match_length--;do N.strstart++,N.ins_h=(N.ins_h<<N.hash_shift^N.window[N.strstart+ee-1])&N.hash_mask,xe=N.prev[N.strstart&N.w_mask]=N.head[N.ins_h],N.head[N.ins_h]=N.strstart;while(--N.match_length!==0);N.strstart++}else N.strstart+=N.match_length,N.match_length=0,N.ins_h=N.window[N.strstart],N.ins_h=(N.ins_h<<N.hash_shift^N.window[N.strstart+1])&N.hash_mask;else I=a._tr_tally(N,0,N.window[N.strstart]),N.lookahead--,N.strstart++;if(I&&(at(N,!1),N.strm.avail_out===0))return ve}return N.insert=N.strstart<ee-1?N.strstart:ee-1,oe===g?(at(N,!0),N.strm.avail_out===0?We:Ie):N.last_lit&&(at(N,!1),N.strm.avail_out===0)?ve:_e}function ke(N,oe){for(var xe,I,te;;){if(N.lookahead<ie){if(X(N),N.lookahead<ie&&oe===d)return ve;if(N.lookahead===0)break}if(xe=0,N.lookahead>=ee&&(N.ins_h=(N.ins_h<<N.hash_shift^N.window[N.strstart+ee-1])&N.hash_mask,xe=N.prev[N.strstart&N.w_mask]=N.head[N.ins_h],N.head[N.ins_h]=N.strstart),N.prev_length=N.match_length,N.prev_match=N.match_start,N.match_length=ee-1,xe!==0&&N.prev_length<N.max_lazy_match&&N.strstart-xe<=N.w_size-ie&&(N.match_length=he(N,xe),N.match_length<=5&&(N.strategy===S||N.match_length===ee&&N.strstart-N.match_start>4096)&&(N.match_length=ee-1)),N.prev_length>=ee&&N.match_length<=N.prev_length){te=N.strstart+N.lookahead-ee,I=a._tr_tally(N,N.strstart-1-N.prev_match,N.prev_length-ee),N.lookahead-=N.prev_length-1,N.prev_length-=2;do++N.strstart<=te&&(N.ins_h=(N.ins_h<<N.hash_shift^N.window[N.strstart+ee-1])&N.hash_mask,xe=N.prev[N.strstart&N.w_mask]=N.head[N.ins_h],N.head[N.ins_h]=N.strstart);while(--N.prev_length!==0);if(N.match_available=0,N.match_length=ee-1,N.strstart++,I&&(at(N,!1),N.strm.avail_out===0))return ve}else if(N.match_available){if(I=a._tr_tally(N,0,N.window[N.strstart-1]),I&&at(N,!1),N.strstart++,N.lookahead--,N.strm.avail_out===0)return ve}else N.match_available=1,N.strstart++,N.lookahead--}return N.match_available&&(I=a._tr_tally(N,0,N.window[N.strstart-1]),N.match_available=0),N.insert=N.strstart<ee-1?N.strstart:ee-1,oe===g?(at(N,!0),N.strm.avail_out===0?We:Ie):N.last_lit&&(at(N,!1),N.strm.avail_out===0)?ve:_e}function Xe(N,oe){for(var xe,I,te,ye,Ke=N.window;;){if(N.lookahead<=le){if(X(N),N.lookahead<=le&&oe===d)return ve;if(N.lookahead===0)break}if(N.match_length=0,N.lookahead>=ee&&N.strstart>0&&(te=N.strstart-1,I=Ke[te],I===Ke[++te]&&I===Ke[++te]&&I===Ke[++te])){ye=N.strstart+le;do;while(I===Ke[++te]&&I===Ke[++te]&&I===Ke[++te]&&I===Ke[++te]&&I===Ke[++te]&&I===Ke[++te]&&I===Ke[++te]&&I===Ke[++te]&&te<ye);N.match_length=le-(ye-te),N.match_length>N.lookahead&&(N.match_length=N.lookahead)}if(N.match_length>=ee?(xe=a._tr_tally(N,1,N.match_length-ee),N.lookahead-=N.match_length,N.strstart+=N.match_length,N.match_length=0):(xe=a._tr_tally(N,0,N.window[N.strstart]),N.lookahead--,N.strstart++),xe&&(at(N,!1),N.strm.avail_out===0))return ve}return N.insert=0,oe===g?(at(N,!0),N.strm.avail_out===0?We:Ie):N.last_lit&&(at(N,!1),N.strm.avail_out===0)?ve:_e}function ct(N,oe){for(var xe;;){if(N.lookahead===0&&(X(N),N.lookahead===0)){if(oe===d)return ve;break}if(N.match_length=0,xe=a._tr_tally(N,0,N.window[N.strstart]),N.lookahead--,N.strstart++,xe&&(at(N,!1),N.strm.avail_out===0))return ve}return N.insert=0,oe===g?(at(N,!0),N.strm.avail_out===0?We:Ie):N.last_lit&&(at(N,!1),N.strm.avail_out===0)?ve:_e}function Pe(N,oe,xe,I,te){this.good_length=N,this.max_lazy=oe,this.nice_length=xe,this.max_chain=I,this.func=te}var Qe;Qe=[new Pe(0,0,0,0,je),new Pe(4,4,8,4,qe),new Pe(4,5,16,8,qe),new Pe(4,6,32,32,qe),new Pe(4,4,16,16,ke),new Pe(8,16,32,32,ke),new Pe(8,16,128,128,ke),new Pe(8,32,128,256,ke),new Pe(32,128,258,1024,ke),new Pe(32,258,258,4096,ke)];function dt(N){N.window_size=2*N.w_size,tt(N.head),N.max_lazy_match=Qe[N.level].max_lazy,N.good_match=Qe[N.level].good_length,N.nice_match=Qe[N.level].nice_length,N.max_chain_length=Qe[N.level].max_chain,N.strstart=0,N.block_start=0,N.lookahead=0,N.insert=0,N.match_length=N.prev_length=ee-1,N.match_available=0,N.ins_h=0}function z(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=O,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new r.Buf16(ge*2),this.dyn_dtree=new r.Buf16((2*P+1)*2),this.bl_tree=new r.Buf16((2*Y+1)*2),tt(this.dyn_ltree),tt(this.dyn_dtree),tt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new r.Buf16(ae+1),this.heap=new r.Buf16(2*H+1),tt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new r.Buf16(2*H+1),tt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Se(N){var oe;return!N||!N.state?Ze(N,m):(N.total_in=N.total_out=0,N.data_type=L,oe=N.state,oe.pending=0,oe.pending_out=0,oe.wrap<0&&(oe.wrap=-oe.wrap),oe.status=oe.wrap?Z:me,N.adler=oe.wrap===2?0:1,oe.last_flush=d,a._tr_init(oe),b)}function Te(N){var oe=Se(N);return oe===b&&dt(N.state),oe}function Fe(N,oe){return!N||!N.state||N.state.wrap!==2?m:(N.state.gzhead=oe,b)}function F(N,oe,xe,I,te,ye){if(!N)return m;var Ke=1;if(oe===E&&(oe=6),I<0?(Ke=0,I=-I):I>15&&(Ke=2,I-=16),te<1||te>B||xe!==O||I<8||I>15||oe<0||oe>9||ye<0||ye>j)return Ze(N,m);I===8&&(I=9);var He=new z;return N.state=He,He.strm=N,He.wrap=Ke,He.gzhead=null,He.w_bits=I,He.w_size=1<<He.w_bits,He.w_mask=He.w_size-1,He.hash_bits=te+7,He.hash_size=1<<He.hash_bits,He.hash_mask=He.hash_size-1,He.hash_shift=~~((He.hash_bits+ee-1)/ee),He.window=new r.Buf8(He.w_size*2),He.head=new r.Buf16(He.hash_size),He.prev=new r.Buf16(He.w_size),He.lit_bufsize=1<<te+6,He.pending_buf_size=He.lit_bufsize*4,He.pending_buf=new r.Buf8(He.pending_buf_size),He.d_buf=1*He.lit_bufsize,He.l_buf=3*He.lit_bufsize,He.level=oe,He.strategy=ye,He.method=xe,Te(N)}function K(N,oe){return F(N,oe,O,G,W,M)}function C(N,oe){var xe,I,te,ye;if(!N||!N.state||oe>v||oe<0)return N?Ze(N,m):m;if(I=N.state,!N.output||!N.input&&N.avail_in!==0||I.status===Ne&&oe!==g)return Ze(N,N.avail_out===0?w:m);if(I.strm=N,xe=I.last_flush,I.last_flush=oe,I.status===Z)if(I.wrap===2)N.adler=0,ze(I,31),ze(I,139),ze(I,8),I.gzhead?(ze(I,(I.gzhead.text?1:0)+(I.gzhead.hcrc?2:0)+(I.gzhead.extra?4:0)+(I.gzhead.name?8:0)+(I.gzhead.comment?16:0)),ze(I,I.gzhead.time&255),ze(I,I.gzhead.time>>8&255),ze(I,I.gzhead.time>>16&255),ze(I,I.gzhead.time>>24&255),ze(I,I.level===9?2:I.strategy>=_||I.level<2?4:0),ze(I,I.gzhead.os&255),I.gzhead.extra&&I.gzhead.extra.length&&(ze(I,I.gzhead.extra.length&255),ze(I,I.gzhead.extra.length>>8&255)),I.gzhead.hcrc&&(N.adler=c(N.adler,I.pending_buf,I.pending,0)),I.gzindex=0,I.status=re):(ze(I,0),ze(I,0),ze(I,0),ze(I,0),ze(I,0),ze(I,I.level===9?2:I.strategy>=_||I.level<2?4:0),ze(I,Re),I.status=me);else{var Ke=O+(I.w_bits-8<<4)<<8,He=-1;I.strategy>=_||I.level<2?He=0:I.level<6?He=1:I.level===6?He=2:He=3,Ke|=He<<6,I.strstart!==0&&(Ke|=Q),Ke+=31-Ke%31,I.status=me,ft(I,Ke),I.strstart!==0&&(ft(I,N.adler>>>16),ft(I,N.adler&65535)),N.adler=1}if(I.status===re)if(I.gzhead.extra){for(te=I.pending;I.gzindex<(I.gzhead.extra.length&65535)&&!(I.pending===I.pending_buf_size&&(I.gzhead.hcrc&&I.pending>te&&(N.adler=c(N.adler,I.pending_buf,I.pending-te,te)),rt(N),te=I.pending,I.pending===I.pending_buf_size));)ze(I,I.gzhead.extra[I.gzindex]&255),I.gzindex++;I.gzhead.hcrc&&I.pending>te&&(N.adler=c(N.adler,I.pending_buf,I.pending-te,te)),I.gzindex===I.gzhead.extra.length&&(I.gzindex=0,I.status=se)}else I.status=se;if(I.status===se)if(I.gzhead.name){te=I.pending;do{if(I.pending===I.pending_buf_size&&(I.gzhead.hcrc&&I.pending>te&&(N.adler=c(N.adler,I.pending_buf,I.pending-te,te)),rt(N),te=I.pending,I.pending===I.pending_buf_size)){ye=1;break}I.gzindex<I.gzhead.name.length?ye=I.gzhead.name.charCodeAt(I.gzindex++)&255:ye=0,ze(I,ye)}while(ye!==0);I.gzhead.hcrc&&I.pending>te&&(N.adler=c(N.adler,I.pending_buf,I.pending-te,te)),ye===0&&(I.gzindex=0,I.status=be)}else I.status=be;if(I.status===be)if(I.gzhead.comment){te=I.pending;do{if(I.pending===I.pending_buf_size&&(I.gzhead.hcrc&&I.pending>te&&(N.adler=c(N.adler,I.pending_buf,I.pending-te,te)),rt(N),te=I.pending,I.pending===I.pending_buf_size)){ye=1;break}I.gzindex<I.gzhead.comment.length?ye=I.gzhead.comment.charCodeAt(I.gzindex++)&255:ye=0,ze(I,ye)}while(ye!==0);I.gzhead.hcrc&&I.pending>te&&(N.adler=c(N.adler,I.pending_buf,I.pending-te,te)),ye===0&&(I.status=pe)}else I.status=pe;if(I.status===pe&&(I.gzhead.hcrc?(I.pending+2>I.pending_buf_size&&rt(N),I.pending+2<=I.pending_buf_size&&(ze(I,N.adler&255),ze(I,N.adler>>8&255),N.adler=0,I.status=me)):I.status=me),I.pending!==0){if(rt(N),N.avail_out===0)return I.last_flush=-1,b}else if(N.avail_in===0&&it(oe)<=it(xe)&&oe!==g)return Ze(N,w);if(I.status===Ne&&N.avail_in!==0)return Ze(N,w);if(N.avail_in!==0||I.lookahead!==0||oe!==d&&I.status!==Ne){var Ve=I.strategy===_?ct(I,oe):I.strategy===T?Xe(I,oe):Qe[I.level].func(I,oe);if((Ve===We||Ve===Ie)&&(I.status=Ne),Ve===ve||Ve===We)return N.avail_out===0&&(I.last_flush=-1),b;if(Ve===_e&&(oe===f?a._tr_align(I):oe!==v&&(a._tr_stored_block(I,0,0,!1),oe===p&&(tt(I.head),I.lookahead===0&&(I.strstart=0,I.block_start=0,I.insert=0))),rt(N),N.avail_out===0))return I.last_flush=-1,b}return oe!==g?b:I.wrap<=0?x:(I.wrap===2?(ze(I,N.adler&255),ze(I,N.adler>>8&255),ze(I,N.adler>>16&255),ze(I,N.adler>>24&255),ze(I,N.total_in&255),ze(I,N.total_in>>8&255),ze(I,N.total_in>>16&255),ze(I,N.total_in>>24&255)):(ft(I,N.adler>>>16),ft(I,N.adler&65535)),rt(N),I.wrap>0&&(I.wrap=-I.wrap),I.pending!==0?b:x)}function $(N){var oe;return!N||!N.state?m:(oe=N.state.status,oe!==Z&&oe!==re&&oe!==se&&oe!==be&&oe!==pe&&oe!==me&&oe!==Ne?Ze(N,m):(N.state=null,oe===me?Ze(N,y):b))}function fe(N,oe){var xe=oe.length,I,te,ye,Ke,He,Ve,At,Gr;if(!N||!N.state||(I=N.state,Ke=I.wrap,Ke===2||Ke===1&&I.status!==Z||I.lookahead))return m;for(Ke===1&&(N.adler=o(N.adler,oe,xe,0)),I.wrap=0,xe>=I.w_size&&(Ke===0&&(tt(I.head),I.strstart=0,I.block_start=0,I.insert=0),Gr=new r.Buf8(I.w_size),r.arraySet(Gr,oe,xe-I.w_size,I.w_size,0),oe=Gr,xe=I.w_size),He=N.avail_in,Ve=N.next_in,At=N.input,N.avail_in=xe,N.next_in=0,N.input=oe,X(I);I.lookahead>=ee;){te=I.strstart,ye=I.lookahead-(ee-1);do I.ins_h=(I.ins_h<<I.hash_shift^I.window[te+ee-1])&I.hash_mask,I.prev[te&I.w_mask]=I.head[I.ins_h],I.head[I.ins_h]=te,te++;while(--ye);I.strstart=te,I.lookahead=ee-1,X(I)}return I.strstart+=I.lookahead,I.block_start=I.strstart,I.insert=I.lookahead,I.lookahead=0,I.match_length=I.prev_length=ee-1,I.match_available=0,N.next_in=Ve,N.input=At,N.avail_in=He,I.wrap=Ke,b}s.deflateInit=K,s.deflateInit2=F,s.deflateReset=Te,s.deflateResetKeep=Se,s.deflateSetHeader=Fe,s.deflate=C,s.deflateEnd=$,s.deflateSetDictionary=fe,s.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,i,s){function r(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}i.exports=r},{}],48:[function(t,i,s){var r=30,a=12;i.exports=function(c,h){var d,f,p,g,v,b,x,m,y,w,E,S,_,T,j,M,L,O,B,G,W,J,V,H,P;d=c.state,f=c.next_in,H=c.input,p=f+(c.avail_in-5),g=c.next_out,P=c.output,v=g-(h-c.avail_out),b=g+(c.avail_out-257),x=d.dmax,m=d.wsize,y=d.whave,w=d.wnext,E=d.window,S=d.hold,_=d.bits,T=d.lencode,j=d.distcode,M=(1<<d.lenbits)-1,L=(1<<d.distbits)-1;e:do{_<15&&(S+=H[f++]<<_,_+=8,S+=H[f++]<<_,_+=8),O=T[S&M];t:for(;;){if(B=O>>>24,S>>>=B,_-=B,B=O>>>16&255,B===0)P[g++]=O&65535;else if(B&16){G=O&65535,B&=15,B&&(_<B&&(S+=H[f++]<<_,_+=8),G+=S&(1<<B)-1,S>>>=B,_-=B),_<15&&(S+=H[f++]<<_,_+=8,S+=H[f++]<<_,_+=8),O=j[S&L];n:for(;;){if(B=O>>>24,S>>>=B,_-=B,B=O>>>16&255,B&16){if(W=O&65535,B&=15,_<B&&(S+=H[f++]<<_,_+=8,_<B&&(S+=H[f++]<<_,_+=8)),W+=S&(1<<B)-1,W>x){c.msg="invalid distance too far back",d.mode=r;break e}if(S>>>=B,_-=B,B=g-v,W>B){if(B=W-B,B>y&&d.sane){c.msg="invalid distance too far back",d.mode=r;break e}if(J=0,V=E,w===0){if(J+=m-B,B<G){G-=B;do P[g++]=E[J++];while(--B);J=g-W,V=P}}else if(w<B){if(J+=m+w-B,B-=w,B<G){G-=B;do P[g++]=E[J++];while(--B);if(J=0,w<G){B=w,G-=B;do P[g++]=E[J++];while(--B);J=g-W,V=P}}}else if(J+=w-B,B<G){G-=B;do P[g++]=E[J++];while(--B);J=g-W,V=P}for(;G>2;)P[g++]=V[J++],P[g++]=V[J++],P[g++]=V[J++],G-=3;G&&(P[g++]=V[J++],G>1&&(P[g++]=V[J++]))}else{J=g-W;do P[g++]=P[J++],P[g++]=P[J++],P[g++]=P[J++],G-=3;while(G>2);G&&(P[g++]=P[J++],G>1&&(P[g++]=P[J++]))}}else if(B&64){c.msg="invalid distance code",d.mode=r;break e}else{O=j[(O&65535)+(S&(1<<B)-1)];continue n}break}}else if(B&64)if(B&32){d.mode=a;break e}else{c.msg="invalid literal/length code",d.mode=r;break e}else{O=T[(O&65535)+(S&(1<<B)-1)];continue t}break}}while(f<p&&g<b);G=_>>3,f-=G,_-=G<<3,S&=(1<<_)-1,c.next_in=f,c.next_out=g,c.avail_in=f<p?5+(p-f):5-(f-p),c.avail_out=g<b?257+(b-g):257-(g-b),d.hold=S,d.bits=_}},{}],49:[function(t,i,s){var r=t("../utils/common"),a=t("./adler32"),o=t("./crc32"),c=t("./inffast"),h=t("./inftrees"),d=0,f=1,p=2,g=4,v=5,b=6,x=0,m=1,y=2,w=-2,E=-3,S=-4,_=-5,T=8,j=1,M=2,L=3,O=4,B=5,G=6,W=7,J=8,V=9,H=10,P=11,Y=12,ge=13,ae=14,ee=15,le=16,ie=17,Q=18,Z=19,re=20,se=21,be=22,pe=23,me=24,Ne=25,ve=26,_e=27,We=28,Ie=29,Re=30,Ze=31,it=32,tt=852,rt=592,at=15,ze=at;function ft(F){return(F>>>24&255)+(F>>>8&65280)+((F&65280)<<8)+((F&255)<<24)}function Kt(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function he(F){var K;return!F||!F.state?w:(K=F.state,F.total_in=F.total_out=K.total=0,F.msg="",K.wrap&&(F.adler=K.wrap&1),K.mode=j,K.last=0,K.havedict=0,K.dmax=32768,K.head=null,K.hold=0,K.bits=0,K.lencode=K.lendyn=new r.Buf32(tt),K.distcode=K.distdyn=new r.Buf32(rt),K.sane=1,K.back=-1,x)}function X(F){var K;return!F||!F.state?w:(K=F.state,K.wsize=0,K.whave=0,K.wnext=0,he(F))}function je(F,K){var C,$;return!F||!F.state||($=F.state,K<0?(C=0,K=-K):(C=(K>>4)+1,K<48&&(K&=15)),K&&(K<8||K>15))?w:($.window!==null&&$.wbits!==K&&($.window=null),$.wrap=C,$.wbits=K,X(F))}function qe(F,K){var C,$;return F?($=new Kt,F.state=$,$.window=null,C=je(F,K),C!==x&&(F.state=null),C):w}function ke(F){return qe(F,ze)}var Xe=!0,ct,Pe;function Qe(F){if(Xe){var K;for(ct=new r.Buf32(512),Pe=new r.Buf32(32),K=0;K<144;)F.lens[K++]=8;for(;K<256;)F.lens[K++]=9;for(;K<280;)F.lens[K++]=7;for(;K<288;)F.lens[K++]=8;for(h(f,F.lens,0,288,ct,0,F.work,{bits:9}),K=0;K<32;)F.lens[K++]=5;h(p,F.lens,0,32,Pe,0,F.work,{bits:5}),Xe=!1}F.lencode=ct,F.lenbits=9,F.distcode=Pe,F.distbits=5}function dt(F,K,C,$){var fe,N=F.state;return N.window===null&&(N.wsize=1<<N.wbits,N.wnext=0,N.whave=0,N.window=new r.Buf8(N.wsize)),$>=N.wsize?(r.arraySet(N.window,K,C-N.wsize,N.wsize,0),N.wnext=0,N.whave=N.wsize):(fe=N.wsize-N.wnext,fe>$&&(fe=$),r.arraySet(N.window,K,C-$,fe,N.wnext),$-=fe,$?(r.arraySet(N.window,K,C-$,$,0),N.wnext=$,N.whave=N.wsize):(N.wnext+=fe,N.wnext===N.wsize&&(N.wnext=0),N.whave<N.wsize&&(N.whave+=fe))),0}function z(F,K){var C,$,fe,N,oe,xe,I,te,ye,Ke,He,Ve,At,Gr,vn=0,kt,In,ui,zi,ud,hd,kn,os,ti=new r.Buf8(4),Wr,dr,Ny=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!F||!F.state||!F.output||!F.input&&F.avail_in!==0)return w;C=F.state,C.mode===Y&&(C.mode=ge),oe=F.next_out,fe=F.output,I=F.avail_out,N=F.next_in,$=F.input,xe=F.avail_in,te=C.hold,ye=C.bits,Ke=xe,He=I,os=x;e:for(;;)switch(C.mode){case j:if(C.wrap===0){C.mode=ge;break}for(;ye<16;){if(xe===0)break e;xe--,te+=$[N++]<<ye,ye+=8}if(C.wrap&2&&te===35615){C.check=0,ti[0]=te&255,ti[1]=te>>>8&255,C.check=o(C.check,ti,2,0),te=0,ye=0,C.mode=M;break}if(C.flags=0,C.head&&(C.head.done=!1),!(C.wrap&1)||(((te&255)<<8)+(te>>8))%31){F.msg="incorrect header check",C.mode=Re;break}if((te&15)!==T){F.msg="unknown compression method",C.mode=Re;break}if(te>>>=4,ye-=4,kn=(te&15)+8,C.wbits===0)C.wbits=kn;else if(kn>C.wbits){F.msg="invalid window size",C.mode=Re;break}C.dmax=1<<kn,F.adler=C.check=1,C.mode=te&512?H:Y,te=0,ye=0;break;case M:for(;ye<16;){if(xe===0)break e;xe--,te+=$[N++]<<ye,ye+=8}if(C.flags=te,(C.flags&255)!==T){F.msg="unknown compression method",C.mode=Re;break}if(C.flags&57344){F.msg="unknown header flags set",C.mode=Re;break}C.head&&(C.head.text=te>>8&1),C.flags&512&&(ti[0]=te&255,ti[1]=te>>>8&255,C.check=o(C.check,ti,2,0)),te=0,ye=0,C.mode=L;case L:for(;ye<32;){if(xe===0)break e;xe--,te+=$[N++]<<ye,ye+=8}C.head&&(C.head.time=te),C.flags&512&&(ti[0]=te&255,ti[1]=te>>>8&255,ti[2]=te>>>16&255,ti[3]=te>>>24&255,C.check=o(C.check,ti,4,0)),te=0,ye=0,C.mode=O;case O:for(;ye<16;){if(xe===0)break e;xe--,te+=$[N++]<<ye,ye+=8}C.head&&(C.head.xflags=te&255,C.head.os=te>>8),C.flags&512&&(ti[0]=te&255,ti[1]=te>>>8&255,C.check=o(C.check,ti,2,0)),te=0,ye=0,C.mode=B;case B:if(C.flags&1024){for(;ye<16;){if(xe===0)break e;xe--,te+=$[N++]<<ye,ye+=8}C.length=te,C.head&&(C.head.extra_len=te),C.flags&512&&(ti[0]=te&255,ti[1]=te>>>8&255,C.check=o(C.check,ti,2,0)),te=0,ye=0}else C.head&&(C.head.extra=null);C.mode=G;case G:if(C.flags&1024&&(Ve=C.length,Ve>xe&&(Ve=xe),Ve&&(C.head&&(kn=C.head.extra_len-C.length,C.head.extra||(C.head.extra=new Array(C.head.extra_len)),r.arraySet(C.head.extra,$,N,Ve,kn)),C.flags&512&&(C.check=o(C.check,$,Ve,N)),xe-=Ve,N+=Ve,C.length-=Ve),C.length))break e;C.length=0,C.mode=W;case W:if(C.flags&2048){if(xe===0)break e;Ve=0;do kn=$[N+Ve++],C.head&&kn&&C.length<65536&&(C.head.name+=String.fromCharCode(kn));while(kn&&Ve<xe);if(C.flags&512&&(C.check=o(C.check,$,Ve,N)),xe-=Ve,N+=Ve,kn)break e}else C.head&&(C.head.name=null);C.length=0,C.mode=J;case J:if(C.flags&4096){if(xe===0)break e;Ve=0;do kn=$[N+Ve++],C.head&&kn&&C.length<65536&&(C.head.comment+=String.fromCharCode(kn));while(kn&&Ve<xe);if(C.flags&512&&(C.check=o(C.check,$,Ve,N)),xe-=Ve,N+=Ve,kn)break e}else C.head&&(C.head.comment=null);C.mode=V;case V:if(C.flags&512){for(;ye<16;){if(xe===0)break e;xe--,te+=$[N++]<<ye,ye+=8}if(te!==(C.check&65535)){F.msg="header crc mismatch",C.mode=Re;break}te=0,ye=0}C.head&&(C.head.hcrc=C.flags>>9&1,C.head.done=!0),F.adler=C.check=0,C.mode=Y;break;case H:for(;ye<32;){if(xe===0)break e;xe--,te+=$[N++]<<ye,ye+=8}F.adler=C.check=ft(te),te=0,ye=0,C.mode=P;case P:if(C.havedict===0)return F.next_out=oe,F.avail_out=I,F.next_in=N,F.avail_in=xe,C.hold=te,C.bits=ye,y;F.adler=C.check=1,C.mode=Y;case Y:if(K===v||K===b)break e;case ge:if(C.last){te>>>=ye&7,ye-=ye&7,C.mode=_e;break}for(;ye<3;){if(xe===0)break e;xe--,te+=$[N++]<<ye,ye+=8}switch(C.last=te&1,te>>>=1,ye-=1,te&3){case 0:C.mode=ae;break;case 1:if(Qe(C),C.mode=re,K===b){te>>>=2,ye-=2;break e}break;case 2:C.mode=ie;break;case 3:F.msg="invalid block type",C.mode=Re}te>>>=2,ye-=2;break;case ae:for(te>>>=ye&7,ye-=ye&7;ye<32;){if(xe===0)break e;xe--,te+=$[N++]<<ye,ye+=8}if((te&65535)!==(te>>>16^65535)){F.msg="invalid stored block lengths",C.mode=Re;break}if(C.length=te&65535,te=0,ye=0,C.mode=ee,K===b)break e;case ee:C.mode=le;case le:if(Ve=C.length,Ve){if(Ve>xe&&(Ve=xe),Ve>I&&(Ve=I),Ve===0)break e;r.arraySet(fe,$,N,Ve,oe),xe-=Ve,N+=Ve,I-=Ve,oe+=Ve,C.length-=Ve;break}C.mode=Y;break;case ie:for(;ye<14;){if(xe===0)break e;xe--,te+=$[N++]<<ye,ye+=8}if(C.nlen=(te&31)+257,te>>>=5,ye-=5,C.ndist=(te&31)+1,te>>>=5,ye-=5,C.ncode=(te&15)+4,te>>>=4,ye-=4,C.nlen>286||C.ndist>30){F.msg="too many length or distance symbols",C.mode=Re;break}C.have=0,C.mode=Q;case Q:for(;C.have<C.ncode;){for(;ye<3;){if(xe===0)break e;xe--,te+=$[N++]<<ye,ye+=8}C.lens[Ny[C.have++]]=te&7,te>>>=3,ye-=3}for(;C.have<19;)C.lens[Ny[C.have++]]=0;if(C.lencode=C.lendyn,C.lenbits=7,Wr={bits:C.lenbits},os=h(d,C.lens,0,19,C.lencode,0,C.work,Wr),C.lenbits=Wr.bits,os){F.msg="invalid code lengths set",C.mode=Re;break}C.have=0,C.mode=Z;case Z:for(;C.have<C.nlen+C.ndist;){for(;vn=C.lencode[te&(1<<C.lenbits)-1],kt=vn>>>24,In=vn>>>16&255,ui=vn&65535,!(kt<=ye);){if(xe===0)break e;xe--,te+=$[N++]<<ye,ye+=8}if(ui<16)te>>>=kt,ye-=kt,C.lens[C.have++]=ui;else{if(ui===16){for(dr=kt+2;ye<dr;){if(xe===0)break e;xe--,te+=$[N++]<<ye,ye+=8}if(te>>>=kt,ye-=kt,C.have===0){F.msg="invalid bit length repeat",C.mode=Re;break}kn=C.lens[C.have-1],Ve=3+(te&3),te>>>=2,ye-=2}else if(ui===17){for(dr=kt+3;ye<dr;){if(xe===0)break e;xe--,te+=$[N++]<<ye,ye+=8}te>>>=kt,ye-=kt,kn=0,Ve=3+(te&7),te>>>=3,ye-=3}else{for(dr=kt+7;ye<dr;){if(xe===0)break e;xe--,te+=$[N++]<<ye,ye+=8}te>>>=kt,ye-=kt,kn=0,Ve=11+(te&127),te>>>=7,ye-=7}if(C.have+Ve>C.nlen+C.ndist){F.msg="invalid bit length repeat",C.mode=Re;break}for(;Ve--;)C.lens[C.have++]=kn}}if(C.mode===Re)break;if(C.lens[256]===0){F.msg="invalid code -- missing end-of-block",C.mode=Re;break}if(C.lenbits=9,Wr={bits:C.lenbits},os=h(f,C.lens,0,C.nlen,C.lencode,0,C.work,Wr),C.lenbits=Wr.bits,os){F.msg="invalid literal/lengths set",C.mode=Re;break}if(C.distbits=6,C.distcode=C.distdyn,Wr={bits:C.distbits},os=h(p,C.lens,C.nlen,C.ndist,C.distcode,0,C.work,Wr),C.distbits=Wr.bits,os){F.msg="invalid distances set",C.mode=Re;break}if(C.mode=re,K===b)break e;case re:C.mode=se;case se:if(xe>=6&&I>=258){F.next_out=oe,F.avail_out=I,F.next_in=N,F.avail_in=xe,C.hold=te,C.bits=ye,c(F,He),oe=F.next_out,fe=F.output,I=F.avail_out,N=F.next_in,$=F.input,xe=F.avail_in,te=C.hold,ye=C.bits,C.mode===Y&&(C.back=-1);break}for(C.back=0;vn=C.lencode[te&(1<<C.lenbits)-1],kt=vn>>>24,In=vn>>>16&255,ui=vn&65535,!(kt<=ye);){if(xe===0)break e;xe--,te+=$[N++]<<ye,ye+=8}if(In&&!(In&240)){for(zi=kt,ud=In,hd=ui;vn=C.lencode[hd+((te&(1<<zi+ud)-1)>>zi)],kt=vn>>>24,In=vn>>>16&255,ui=vn&65535,!(zi+kt<=ye);){if(xe===0)break e;xe--,te+=$[N++]<<ye,ye+=8}te>>>=zi,ye-=zi,C.back+=zi}if(te>>>=kt,ye-=kt,C.back+=kt,C.length=ui,In===0){C.mode=ve;break}if(In&32){C.back=-1,C.mode=Y;break}if(In&64){F.msg="invalid literal/length code",C.mode=Re;break}C.extra=In&15,C.mode=be;case be:if(C.extra){for(dr=C.extra;ye<dr;){if(xe===0)break e;xe--,te+=$[N++]<<ye,ye+=8}C.length+=te&(1<<C.extra)-1,te>>>=C.extra,ye-=C.extra,C.back+=C.extra}C.was=C.length,C.mode=pe;case pe:for(;vn=C.distcode[te&(1<<C.distbits)-1],kt=vn>>>24,In=vn>>>16&255,ui=vn&65535,!(kt<=ye);){if(xe===0)break e;xe--,te+=$[N++]<<ye,ye+=8}if(!(In&240)){for(zi=kt,ud=In,hd=ui;vn=C.distcode[hd+((te&(1<<zi+ud)-1)>>zi)],kt=vn>>>24,In=vn>>>16&255,ui=vn&65535,!(zi+kt<=ye);){if(xe===0)break e;xe--,te+=$[N++]<<ye,ye+=8}te>>>=zi,ye-=zi,C.back+=zi}if(te>>>=kt,ye-=kt,C.back+=kt,In&64){F.msg="invalid distance code",C.mode=Re;break}C.offset=ui,C.extra=In&15,C.mode=me;case me:if(C.extra){for(dr=C.extra;ye<dr;){if(xe===0)break e;xe--,te+=$[N++]<<ye,ye+=8}C.offset+=te&(1<<C.extra)-1,te>>>=C.extra,ye-=C.extra,C.back+=C.extra}if(C.offset>C.dmax){F.msg="invalid distance too far back",C.mode=Re;break}C.mode=Ne;case Ne:if(I===0)break e;if(Ve=He-I,C.offset>Ve){if(Ve=C.offset-Ve,Ve>C.whave&&C.sane){F.msg="invalid distance too far back",C.mode=Re;break}Ve>C.wnext?(Ve-=C.wnext,At=C.wsize-Ve):At=C.wnext-Ve,Ve>C.length&&(Ve=C.length),Gr=C.window}else Gr=fe,At=oe-C.offset,Ve=C.length;Ve>I&&(Ve=I),I-=Ve,C.length-=Ve;do fe[oe++]=Gr[At++];while(--Ve);C.length===0&&(C.mode=se);break;case ve:if(I===0)break e;fe[oe++]=C.length,I--,C.mode=se;break;case _e:if(C.wrap){for(;ye<32;){if(xe===0)break e;xe--,te|=$[N++]<<ye,ye+=8}if(He-=I,F.total_out+=He,C.total+=He,He&&(F.adler=C.check=C.flags?o(C.check,fe,He,oe-He):a(C.check,fe,He,oe-He)),He=I,(C.flags?te:ft(te))!==C.check){F.msg="incorrect data check",C.mode=Re;break}te=0,ye=0}C.mode=We;case We:if(C.wrap&&C.flags){for(;ye<32;){if(xe===0)break e;xe--,te+=$[N++]<<ye,ye+=8}if(te!==(C.total&4294967295)){F.msg="incorrect length check",C.mode=Re;break}te=0,ye=0}C.mode=Ie;case Ie:os=m;break e;case Re:os=E;break e;case Ze:return S;case it:default:return w}return F.next_out=oe,F.avail_out=I,F.next_in=N,F.avail_in=xe,C.hold=te,C.bits=ye,(C.wsize||He!==F.avail_out&&C.mode<Re&&(C.mode<_e||K!==g))&&dt(F,F.output,F.next_out,He-F.avail_out),Ke-=F.avail_in,He-=F.avail_out,F.total_in+=Ke,F.total_out+=He,C.total+=He,C.wrap&&He&&(F.adler=C.check=C.flags?o(C.check,fe,He,F.next_out-He):a(C.check,fe,He,F.next_out-He)),F.data_type=C.bits+(C.last?64:0)+(C.mode===Y?128:0)+(C.mode===re||C.mode===ee?256:0),(Ke===0&&He===0||K===g)&&os===x&&(os=_),os}function Se(F){if(!F||!F.state)return w;var K=F.state;return K.window&&(K.window=null),F.state=null,x}function Te(F,K){var C;return!F||!F.state||(C=F.state,!(C.wrap&2))?w:(C.head=K,K.done=!1,x)}function Fe(F,K){var C=K.length,$,fe,N;return!F||!F.state||($=F.state,$.wrap!==0&&$.mode!==P)?w:$.mode===P&&(fe=1,fe=a(fe,K,C,0),fe!==$.check)?E:(N=dt(F,K,C,C),N?($.mode=Ze,S):($.havedict=1,x))}s.inflateReset=X,s.inflateReset2=je,s.inflateResetKeep=he,s.inflateInit=ke,s.inflateInit2=qe,s.inflate=z,s.inflateEnd=Se,s.inflateGetHeader=Te,s.inflateSetDictionary=Fe,s.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,i,s){var r=t("../utils/common"),a=15,o=852,c=592,h=0,d=1,f=2,p=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],g=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],v=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],b=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];i.exports=function(m,y,w,E,S,_,T,j){var M=j.bits,L=0,O=0,B=0,G=0,W=0,J=0,V=0,H=0,P=0,Y=0,ge,ae,ee,le,ie,Q=null,Z=0,re,se=new r.Buf16(a+1),be=new r.Buf16(a+1),pe=null,me=0,Ne,ve,_e;for(L=0;L<=a;L++)se[L]=0;for(O=0;O<E;O++)se[y[w+O]]++;for(W=M,G=a;G>=1&&se[G]===0;G--);if(W>G&&(W=G),G===0)return S[_++]=1<<24|64<<16|0,S[_++]=1<<24|64<<16|0,j.bits=1,0;for(B=1;B<G&&se[B]===0;B++);for(W<B&&(W=B),H=1,L=1;L<=a;L++)if(H<<=1,H-=se[L],H<0)return-1;if(H>0&&(m===h||G!==1))return-1;for(be[1]=0,L=1;L<a;L++)be[L+1]=be[L]+se[L];for(O=0;O<E;O++)y[w+O]!==0&&(T[be[y[w+O]]++]=O);if(m===h?(Q=pe=T,re=19):m===d?(Q=p,Z-=257,pe=g,me-=257,re=256):(Q=v,pe=b,re=-1),Y=0,O=0,L=B,ie=_,J=W,V=0,ee=-1,P=1<<W,le=P-1,m===d&&P>o||m===f&&P>c)return 1;for(;;){Ne=L-V,T[O]<re?(ve=0,_e=T[O]):T[O]>re?(ve=pe[me+T[O]],_e=Q[Z+T[O]]):(ve=96,_e=0),ge=1<<L-V,ae=1<<J,B=ae;do ae-=ge,S[ie+(Y>>V)+ae]=Ne<<24|ve<<16|_e|0;while(ae!==0);for(ge=1<<L-1;Y&ge;)ge>>=1;if(ge!==0?(Y&=ge-1,Y+=ge):Y=0,O++,--se[L]===0){if(L===G)break;L=y[w+T[O]]}if(L>W&&(Y&le)!==ee){for(V===0&&(V=W),ie+=B,J=L-V,H=1<<J;J+V<G&&(H-=se[J+V],!(H<=0));)J++,H<<=1;if(P+=1<<J,m===d&&P>o||m===f&&P>c)return 1;ee=Y&le,S[ee]=W<<24|J<<16|ie-_|0}}return Y!==0&&(S[ie+Y]=L-V<<24|64<<16|0),j.bits=W,0}},{"../utils/common":41}],51:[function(t,i,s){i.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,i,s){var r=t("../utils/common"),a=4,o=0,c=1,h=2;function d(z){for(var Se=z.length;--Se>=0;)z[Se]=0}var f=0,p=1,g=2,v=3,b=258,x=29,m=256,y=m+1+x,w=30,E=19,S=2*y+1,_=15,T=16,j=7,M=256,L=16,O=17,B=18,G=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],W=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],J=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],V=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],H=512,P=new Array((y+2)*2);d(P);var Y=new Array(w*2);d(Y);var ge=new Array(H);d(ge);var ae=new Array(b-v+1);d(ae);var ee=new Array(x);d(ee);var le=new Array(w);d(le);function ie(z,Se,Te,Fe,F){this.static_tree=z,this.extra_bits=Se,this.extra_base=Te,this.elems=Fe,this.max_length=F,this.has_stree=z&&z.length}var Q,Z,re;function se(z,Se){this.dyn_tree=z,this.max_code=0,this.stat_desc=Se}function be(z){return z<256?ge[z]:ge[256+(z>>>7)]}function pe(z,Se){z.pending_buf[z.pending++]=Se&255,z.pending_buf[z.pending++]=Se>>>8&255}function me(z,Se,Te){z.bi_valid>T-Te?(z.bi_buf|=Se<<z.bi_valid&65535,pe(z,z.bi_buf),z.bi_buf=Se>>T-z.bi_valid,z.bi_valid+=Te-T):(z.bi_buf|=Se<<z.bi_valid&65535,z.bi_valid+=Te)}function Ne(z,Se,Te){me(z,Te[Se*2],Te[Se*2+1])}function ve(z,Se){var Te=0;do Te|=z&1,z>>>=1,Te<<=1;while(--Se>0);return Te>>>1}function _e(z){z.bi_valid===16?(pe(z,z.bi_buf),z.bi_buf=0,z.bi_valid=0):z.bi_valid>=8&&(z.pending_buf[z.pending++]=z.bi_buf&255,z.bi_buf>>=8,z.bi_valid-=8)}function We(z,Se){var Te=Se.dyn_tree,Fe=Se.max_code,F=Se.stat_desc.static_tree,K=Se.stat_desc.has_stree,C=Se.stat_desc.extra_bits,$=Se.stat_desc.extra_base,fe=Se.stat_desc.max_length,N,oe,xe,I,te,ye,Ke=0;for(I=0;I<=_;I++)z.bl_count[I]=0;for(Te[z.heap[z.heap_max]*2+1]=0,N=z.heap_max+1;N<S;N++)oe=z.heap[N],I=Te[Te[oe*2+1]*2+1]+1,I>fe&&(I=fe,Ke++),Te[oe*2+1]=I,!(oe>Fe)&&(z.bl_count[I]++,te=0,oe>=$&&(te=C[oe-$]),ye=Te[oe*2],z.opt_len+=ye*(I+te),K&&(z.static_len+=ye*(F[oe*2+1]+te)));if(Ke!==0){do{for(I=fe-1;z.bl_count[I]===0;)I--;z.bl_count[I]--,z.bl_count[I+1]+=2,z.bl_count[fe]--,Ke-=2}while(Ke>0);for(I=fe;I!==0;I--)for(oe=z.bl_count[I];oe!==0;)xe=z.heap[--N],!(xe>Fe)&&(Te[xe*2+1]!==I&&(z.opt_len+=(I-Te[xe*2+1])*Te[xe*2],Te[xe*2+1]=I),oe--)}}function Ie(z,Se,Te){var Fe=new Array(_+1),F=0,K,C;for(K=1;K<=_;K++)Fe[K]=F=F+Te[K-1]<<1;for(C=0;C<=Se;C++){var $=z[C*2+1];$!==0&&(z[C*2]=ve(Fe[$]++,$))}}function Re(){var z,Se,Te,Fe,F,K=new Array(_+1);for(Te=0,Fe=0;Fe<x-1;Fe++)for(ee[Fe]=Te,z=0;z<1<<G[Fe];z++)ae[Te++]=Fe;for(ae[Te-1]=Fe,F=0,Fe=0;Fe<16;Fe++)for(le[Fe]=F,z=0;z<1<<W[Fe];z++)ge[F++]=Fe;for(F>>=7;Fe<w;Fe++)for(le[Fe]=F<<7,z=0;z<1<<W[Fe]-7;z++)ge[256+F++]=Fe;for(Se=0;Se<=_;Se++)K[Se]=0;for(z=0;z<=143;)P[z*2+1]=8,z++,K[8]++;for(;z<=255;)P[z*2+1]=9,z++,K[9]++;for(;z<=279;)P[z*2+1]=7,z++,K[7]++;for(;z<=287;)P[z*2+1]=8,z++,K[8]++;for(Ie(P,y+1,K),z=0;z<w;z++)Y[z*2+1]=5,Y[z*2]=ve(z,5);Q=new ie(P,G,m+1,y,_),Z=new ie(Y,W,0,w,_),re=new ie(new Array(0),J,0,E,j)}function Ze(z){var Se;for(Se=0;Se<y;Se++)z.dyn_ltree[Se*2]=0;for(Se=0;Se<w;Se++)z.dyn_dtree[Se*2]=0;for(Se=0;Se<E;Se++)z.bl_tree[Se*2]=0;z.dyn_ltree[M*2]=1,z.opt_len=z.static_len=0,z.last_lit=z.matches=0}function it(z){z.bi_valid>8?pe(z,z.bi_buf):z.bi_valid>0&&(z.pending_buf[z.pending++]=z.bi_buf),z.bi_buf=0,z.bi_valid=0}function tt(z,Se,Te,Fe){it(z),pe(z,Te),pe(z,~Te),r.arraySet(z.pending_buf,z.window,Se,Te,z.pending),z.pending+=Te}function rt(z,Se,Te,Fe){var F=Se*2,K=Te*2;return z[F]<z[K]||z[F]===z[K]&&Fe[Se]<=Fe[Te]}function at(z,Se,Te){for(var Fe=z.heap[Te],F=Te<<1;F<=z.heap_len&&(F<z.heap_len&&rt(Se,z.heap[F+1],z.heap[F],z.depth)&&F++,!rt(Se,Fe,z.heap[F],z.depth));)z.heap[Te]=z.heap[F],Te=F,F<<=1;z.heap[Te]=Fe}function ze(z,Se,Te){var Fe,F,K=0,C,$;if(z.last_lit!==0)do Fe=z.pending_buf[z.d_buf+K*2]<<8|z.pending_buf[z.d_buf+K*2+1],F=z.pending_buf[z.l_buf+K],K++,Fe===0?Ne(z,F,Se):(C=ae[F],Ne(z,C+m+1,Se),$=G[C],$!==0&&(F-=ee[C],me(z,F,$)),Fe--,C=be(Fe),Ne(z,C,Te),$=W[C],$!==0&&(Fe-=le[C],me(z,Fe,$)));while(K<z.last_lit);Ne(z,M,Se)}function ft(z,Se){var Te=Se.dyn_tree,Fe=Se.stat_desc.static_tree,F=Se.stat_desc.has_stree,K=Se.stat_desc.elems,C,$,fe=-1,N;for(z.heap_len=0,z.heap_max=S,C=0;C<K;C++)Te[C*2]!==0?(z.heap[++z.heap_len]=fe=C,z.depth[C]=0):Te[C*2+1]=0;for(;z.heap_len<2;)N=z.heap[++z.heap_len]=fe<2?++fe:0,Te[N*2]=1,z.depth[N]=0,z.opt_len--,F&&(z.static_len-=Fe[N*2+1]);for(Se.max_code=fe,C=z.heap_len>>1;C>=1;C--)at(z,Te,C);N=K;do C=z.heap[1],z.heap[1]=z.heap[z.heap_len--],at(z,Te,1),$=z.heap[1],z.heap[--z.heap_max]=C,z.heap[--z.heap_max]=$,Te[N*2]=Te[C*2]+Te[$*2],z.depth[N]=(z.depth[C]>=z.depth[$]?z.depth[C]:z.depth[$])+1,Te[C*2+1]=Te[$*2+1]=N,z.heap[1]=N++,at(z,Te,1);while(z.heap_len>=2);z.heap[--z.heap_max]=z.heap[1],We(z,Se),Ie(Te,fe,z.bl_count)}function Kt(z,Se,Te){var Fe,F=-1,K,C=Se[0*2+1],$=0,fe=7,N=4;for(C===0&&(fe=138,N=3),Se[(Te+1)*2+1]=65535,Fe=0;Fe<=Te;Fe++)K=C,C=Se[(Fe+1)*2+1],!(++$<fe&&K===C)&&($<N?z.bl_tree[K*2]+=$:K!==0?(K!==F&&z.bl_tree[K*2]++,z.bl_tree[L*2]++):$<=10?z.bl_tree[O*2]++:z.bl_tree[B*2]++,$=0,F=K,C===0?(fe=138,N=3):K===C?(fe=6,N=3):(fe=7,N=4))}function he(z,Se,Te){var Fe,F=-1,K,C=Se[0*2+1],$=0,fe=7,N=4;for(C===0&&(fe=138,N=3),Fe=0;Fe<=Te;Fe++)if(K=C,C=Se[(Fe+1)*2+1],!(++$<fe&&K===C)){if($<N)do Ne(z,K,z.bl_tree);while(--$!==0);else K!==0?(K!==F&&(Ne(z,K,z.bl_tree),$--),Ne(z,L,z.bl_tree),me(z,$-3,2)):$<=10?(Ne(z,O,z.bl_tree),me(z,$-3,3)):(Ne(z,B,z.bl_tree),me(z,$-11,7));$=0,F=K,C===0?(fe=138,N=3):K===C?(fe=6,N=3):(fe=7,N=4)}}function X(z){var Se;for(Kt(z,z.dyn_ltree,z.l_desc.max_code),Kt(z,z.dyn_dtree,z.d_desc.max_code),ft(z,z.bl_desc),Se=E-1;Se>=3&&z.bl_tree[V[Se]*2+1]===0;Se--);return z.opt_len+=3*(Se+1)+5+5+4,Se}function je(z,Se,Te,Fe){var F;for(me(z,Se-257,5),me(z,Te-1,5),me(z,Fe-4,4),F=0;F<Fe;F++)me(z,z.bl_tree[V[F]*2+1],3);he(z,z.dyn_ltree,Se-1),he(z,z.dyn_dtree,Te-1)}function qe(z){var Se=4093624447,Te;for(Te=0;Te<=31;Te++,Se>>>=1)if(Se&1&&z.dyn_ltree[Te*2]!==0)return o;if(z.dyn_ltree[9*2]!==0||z.dyn_ltree[10*2]!==0||z.dyn_ltree[13*2]!==0)return c;for(Te=32;Te<m;Te++)if(z.dyn_ltree[Te*2]!==0)return c;return o}var ke=!1;function Xe(z){ke||(Re(),ke=!0),z.l_desc=new se(z.dyn_ltree,Q),z.d_desc=new se(z.dyn_dtree,Z),z.bl_desc=new se(z.bl_tree,re),z.bi_buf=0,z.bi_valid=0,Ze(z)}function ct(z,Se,Te,Fe){me(z,(f<<1)+(Fe?1:0),3),tt(z,Se,Te)}function Pe(z){me(z,p<<1,3),Ne(z,M,P),_e(z)}function Qe(z,Se,Te,Fe){var F,K,C=0;z.level>0?(z.strm.data_type===h&&(z.strm.data_type=qe(z)),ft(z,z.l_desc),ft(z,z.d_desc),C=X(z),F=z.opt_len+3+7>>>3,K=z.static_len+3+7>>>3,K<=F&&(F=K)):F=K=Te+5,Te+4<=F&&Se!==-1?ct(z,Se,Te,Fe):z.strategy===a||K===F?(me(z,(p<<1)+(Fe?1:0),3),ze(z,P,Y)):(me(z,(g<<1)+(Fe?1:0),3),je(z,z.l_desc.max_code+1,z.d_desc.max_code+1,C+1),ze(z,z.dyn_ltree,z.dyn_dtree)),Ze(z),Fe&&it(z)}function dt(z,Se,Te){return z.pending_buf[z.d_buf+z.last_lit*2]=Se>>>8&255,z.pending_buf[z.d_buf+z.last_lit*2+1]=Se&255,z.pending_buf[z.l_buf+z.last_lit]=Te&255,z.last_lit++,Se===0?z.dyn_ltree[Te*2]++:(z.matches++,Se--,z.dyn_ltree[(ae[Te]+m+1)*2]++,z.dyn_dtree[be(Se)*2]++),z.last_lit===z.lit_bufsize-1}s._tr_init=Xe,s._tr_stored_block=ct,s._tr_flush_block=Qe,s._tr_tally=dt,s._tr_align=Pe},{"../utils/common":41}],53:[function(t,i,s){function r(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}i.exports=r},{}],54:[function(t,i,s){(function(r){(function(a,o){if(a.setImmediate)return;var c=1,h={},d=!1,f=a.document,p;function g(j){typeof j!="function"&&(j=new Function(""+j));for(var M=new Array(arguments.length-1),L=0;L<M.length;L++)M[L]=arguments[L+1];var O={callback:j,args:M};return h[c]=O,p(c),c++}function v(j){delete h[j]}function b(j){var M=j.callback,L=j.args;switch(L.length){case 0:M();break;case 1:M(L[0]);break;case 2:M(L[0],L[1]);break;case 3:M(L[0],L[1],L[2]);break;default:M.apply(o,L);break}}function x(j){if(d)setTimeout(x,0,j);else{var M=h[j];if(M){d=!0;try{b(M)}finally{v(j),d=!1}}}}function m(){p=function(j){process.nextTick(function(){x(j)})}}function y(){if(a.postMessage&&!a.importScripts){var j=!0,M=a.onmessage;return a.onmessage=function(){j=!1},a.postMessage("","*"),a.onmessage=M,j}}function w(){var j="setImmediate$"+Math.random()+"$",M=function(L){L.source===a&&typeof L.data=="string"&&L.data.indexOf(j)===0&&x(+L.data.slice(j.length))};a.addEventListener?a.addEventListener("message",M,!1):a.attachEvent("onmessage",M),p=function(L){a.postMessage(j+L,"*")}}function E(){var j=new MessageChannel;j.port1.onmessage=function(M){var L=M.data;x(L)},p=function(M){j.port2.postMessage(M)}}function S(){var j=f.documentElement;p=function(M){var L=f.createElement("script");L.onreadystatechange=function(){x(M),L.onreadystatechange=null,j.removeChild(L),L=null},j.appendChild(L)}}function _(){p=function(j){setTimeout(x,0,j)}}var T=Object.getPrototypeOf&&Object.getPrototypeOf(a);T=T&&T.setTimeout?T:a,{}.toString.call(a.process)==="[object process]"?m():y()?w():a.MessageChannel?E():f&&"onreadystatechange"in f.createElement("script")?S():_(),T.setImmediate=g,T.clearImmediate=v})(typeof self>"u"?typeof r>"u"?this:r:self)}).call(this,typeof zr<"u"?zr:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(Z4);var kV=Z4.exports;const TV=ed(kV);class DV{constructor(){this.zip=void 0,this.urlCache={},this.checkRequirements()}checkRequirements(){try{this.zip=new TV}catch{throw new Error("JSZip lib not loaded")}}open(e,t){return this.zip.loadAsync(e,{base64:t})}openUrl(e,t){return Jm(e,"binary").then((function(i){return this.zip.loadAsync(i,{base64:t})}).bind(this))}request(e,t){var i=new Dt,s,r=new kl(e);return t||(t=r.extension),t=="blob"?s=this.getBlob(e):s=this.getText(e),s?s.then((function(a){let o=this.handleResponse(a,t);i.resolve(o)}).bind(this)):i.reject({message:"File not found in the epub: "+e,stack:new Error().stack}),i.promise}handleResponse(e,t){var i;return t=="json"?i=JSON.parse(e):Qm(t)?i=io(e,"text/xml"):t=="xhtml"?i=io(e,"application/xhtml+xml"):t=="html"||t=="htm"?i=io(e,"text/html"):i=e,i}getBlob(e,t){var i=window.decodeURIComponent(e.substr(1)),s=this.zip.file(i);if(s)return t=t||gf.lookup(s.name),s.async("uint8array").then(function(r){return new Blob([r],{type:t})})}getText(e,t){var i=window.decodeURIComponent(e.substr(1)),s=this.zip.file(i);if(s)return s.async("string").then(function(r){return r})}getBase64(e,t){var i=window.decodeURIComponent(e.substr(1)),s=this.zip.file(i);if(s)return t=t||gf.lookup(s.name),s.async("base64").then(function(r){return"data:"+t+";base64,"+r})}createUrl(e,t){var i=new Dt,s=window.URL||window.webkitURL||window.mozURL,r,a,o=t&&t.base64;return e in this.urlCache?(i.resolve(this.urlCache[e]),i.promise):(o?(a=this.getBase64(e),a&&a.then((function(c){this.urlCache[e]=c,i.resolve(c)}).bind(this))):(a=this.getBlob(e),a&&a.then((function(c){r=s.createObjectURL(c),this.urlCache[e]=r,i.resolve(r)}).bind(this))),a||i.reject({message:"File not found in the epub: "+e,stack:new Error().stack}),i.promise)}revokeUrl(e){var t=window.URL||window.webkitURL||window.mozURL,i=this.urlCache[e];i&&t.revokeObjectURL(i)}destroy(){var e=window.URL||window.webkitURL||window.mozURL;for(let t in this.urlCache)e.revokeObjectURL(t);this.zip=void 0,this.urlCache={}}}var Q4={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/(function(n,e){(function(t){n.exports=t()})(function(){return function t(i,s,r){function a(h,d){if(!s[h]){if(!i[h]){var f=typeof $c=="function"&&$c;if(!d&&f)return f(h,!0);if(o)return o(h,!0);var p=new Error("Cannot find module '"+h+"'");throw p.code="MODULE_NOT_FOUND",p}var g=s[h]={exports:{}};i[h][0].call(g.exports,function(v){var b=i[h][1][v];return a(b||v)},g,g.exports,t,i,s,r)}return s[h].exports}for(var o=typeof $c=="function"&&$c,c=0;c<r.length;c++)a(r[c]);return a}({1:[function(t,i,s){(function(r){var a=r.MutationObserver||r.WebKitMutationObserver,o;if(a){var c=0,h=new a(v),d=r.document.createTextNode("");h.observe(d,{characterData:!0}),o=function(){d.data=c=++c%2}}else if(!r.setImmediate&&typeof r.MessageChannel<"u"){var f=new r.MessageChannel;f.port1.onmessage=v,o=function(){f.port2.postMessage(0)}}else"document"in r&&"onreadystatechange"in r.document.createElement("script")?o=function(){var x=r.document.createElement("script");x.onreadystatechange=function(){v(),x.onreadystatechange=null,x.parentNode.removeChild(x),x=null},r.document.documentElement.appendChild(x)}:o=function(){setTimeout(v,0)};var p,g=[];function v(){p=!0;for(var x,m,y=g.length;y;){for(m=g,g=[],x=-1;++x<y;)m[x]();y=g.length}p=!1}i.exports=b;function b(x){g.push(x)===1&&!p&&o()}}).call(this,typeof zr<"u"?zr:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(t,i,s){var r=t(1);function a(){}var o={},c=["REJECTED"],h=["FULFILLED"],d=["PENDING"];i.exports=f;function f(S){if(typeof S!="function")throw new TypeError("resolver must be a function");this.state=d,this.queue=[],this.outcome=void 0,S!==a&&b(this,S)}f.prototype.catch=function(S){return this.then(null,S)},f.prototype.then=function(S,_){if(typeof S!="function"&&this.state===h||typeof _!="function"&&this.state===c)return this;var T=new this.constructor(a);if(this.state!==d){var j=this.state===h?S:_;g(T,j,this.outcome)}else this.queue.push(new p(T,S,_));return T};function p(S,_,T){this.promise=S,typeof _=="function"&&(this.onFulfilled=_,this.callFulfilled=this.otherCallFulfilled),typeof T=="function"&&(this.onRejected=T,this.callRejected=this.otherCallRejected)}p.prototype.callFulfilled=function(S){o.resolve(this.promise,S)},p.prototype.otherCallFulfilled=function(S){g(this.promise,this.onFulfilled,S)},p.prototype.callRejected=function(S){o.reject(this.promise,S)},p.prototype.otherCallRejected=function(S){g(this.promise,this.onRejected,S)};function g(S,_,T){r(function(){var j;try{j=_(T)}catch(M){return o.reject(S,M)}j===S?o.reject(S,new TypeError("Cannot resolve promise with itself")):o.resolve(S,j)})}o.resolve=function(S,_){var T=x(v,_);if(T.status==="error")return o.reject(S,T.value);var j=T.value;if(j)b(S,j);else{S.state=h,S.outcome=_;for(var M=-1,L=S.queue.length;++M<L;)S.queue[M].callFulfilled(_)}return S},o.reject=function(S,_){S.state=c,S.outcome=_;for(var T=-1,j=S.queue.length;++T<j;)S.queue[T].callRejected(_);return S};function v(S){var _=S&&S.then;if(S&&(typeof S=="object"||typeof S=="function")&&typeof _=="function")return function(){_.apply(S,arguments)}}function b(S,_){var T=!1;function j(B){T||(T=!0,o.reject(S,B))}function M(B){T||(T=!0,o.resolve(S,B))}function L(){_(M,j)}var O=x(L);O.status==="error"&&j(O.value)}function x(S,_){var T={};try{T.value=S(_),T.status="success"}catch(j){T.status="error",T.value=j}return T}f.resolve=m;function m(S){return S instanceof this?S:o.resolve(new this(a),S)}f.reject=y;function y(S){var _=new this(a);return o.reject(_,S)}f.all=w;function w(S){var _=this;if(Object.prototype.toString.call(S)!=="[object Array]")return this.reject(new TypeError("must be an array"));var T=S.length,j=!1;if(!T)return this.resolve([]);for(var M=new Array(T),L=0,O=-1,B=new this(a);++O<T;)G(S[O],O);return B;function G(W,J){_.resolve(W).then(V,function(H){j||(j=!0,o.reject(B,H))});function V(H){M[J]=H,++L===T&&!j&&(j=!0,o.resolve(B,M))}}}f.race=E;function E(S){var _=this;if(Object.prototype.toString.call(S)!=="[object Array]")return this.reject(new TypeError("must be an array"));var T=S.length,j=!1;if(!T)return this.resolve([]);for(var M=-1,L=new this(a);++M<T;)O(S[M]);return L;function O(B){_.resolve(B).then(function(G){j||(j=!0,o.resolve(L,G))},function(G){j||(j=!0,o.reject(L,G))})}}},{1:1}],3:[function(t,i,s){(function(r){typeof r.Promise!="function"&&(r.Promise=t(2))}).call(this,typeof zr<"u"?zr:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(t,i,s){var r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(U){return typeof U}:function(U){return U&&typeof Symbol=="function"&&U.constructor===Symbol&&U!==Symbol.prototype?"symbol":typeof U};function a(U,ne){if(!(U instanceof ne))throw new TypeError("Cannot call a class as a function")}function o(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var c=o();function h(){try{if(!c||!c.open)return!1;var U=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),ne=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!U||ne)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function d(U,ne){U=U||[],ne=ne||{};try{return new Blob(U,ne)}catch(ce){if(ce.name!=="TypeError")throw ce;for(var q=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,ue=new q,de=0;de<U.length;de+=1)ue.append(U[de]);return ue.getBlob(ne.type)}}typeof Promise>"u"&&t(3);var f=Promise;function p(U,ne){ne&&U.then(function(q){ne(null,q)},function(q){ne(q)})}function g(U,ne,q){typeof ne=="function"&&U.then(ne),typeof q=="function"&&U.catch(q)}function v(U){return typeof U!="string"&&(console.warn(U+" used as a key, but it is not a string."),U=String(U)),U}function b(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var x="local-forage-detect-blob-support",m=void 0,y={},w=Object.prototype.toString,E="readonly",S="readwrite";function _(U){for(var ne=U.length,q=new ArrayBuffer(ne),ue=new Uint8Array(q),de=0;de<ne;de++)ue[de]=U.charCodeAt(de);return q}function T(U){return new f(function(ne){var q=U.transaction(x,S),ue=d([""]);q.objectStore(x).put(ue,"key"),q.onabort=function(de){de.preventDefault(),de.stopPropagation(),ne(!1)},q.oncomplete=function(){var de=navigator.userAgent.match(/Chrome\/(\d+)/),ce=navigator.userAgent.match(/Edge\//);ne(ce||!de||parseInt(de[1],10)>=43)}}).catch(function(){return!1})}function j(U){return typeof m=="boolean"?f.resolve(m):T(U).then(function(ne){return m=ne,m})}function M(U){var ne=y[U.name],q={};q.promise=new f(function(ue,de){q.resolve=ue,q.reject=de}),ne.deferredOperations.push(q),ne.dbReady?ne.dbReady=ne.dbReady.then(function(){return q.promise}):ne.dbReady=q.promise}function L(U){var ne=y[U.name],q=ne.deferredOperations.pop();if(q)return q.resolve(),q.promise}function O(U,ne){var q=y[U.name],ue=q.deferredOperations.pop();if(ue)return ue.reject(ne),ue.promise}function B(U,ne){return new f(function(q,ue){if(y[U.name]=y[U.name]||ee(),U.db)if(ne)M(U),U.db.close();else return q(U.db);var de=[U.name];ne&&de.push(U.version);var ce=c.open.apply(c,de);ne&&(ce.onupgradeneeded=function(Ee){var De=ce.result;try{De.createObjectStore(U.storeName),Ee.oldVersion<=1&&De.createObjectStore(x)}catch(Le){if(Le.name==="ConstraintError")console.warn('The database "'+U.name+'" has been upgraded from version '+Ee.oldVersion+" to version "+Ee.newVersion+', but the storage "'+U.storeName+'" already exists.');else throw Le}}),ce.onerror=function(Ee){Ee.preventDefault(),ue(ce.error)},ce.onsuccess=function(){var Ee=ce.result;Ee.onversionchange=function(De){De.target.close()},q(Ee),L(U)}})}function G(U){return B(U,!1)}function W(U){return B(U,!0)}function J(U,ne){if(!U.db)return!0;var q=!U.db.objectStoreNames.contains(U.storeName),ue=U.version<U.db.version,de=U.version>U.db.version;if(ue&&(U.version!==ne&&console.warn('The database "'+U.name+`" can't be downgraded from version `+U.db.version+" to version "+U.version+"."),U.version=U.db.version),de||q){if(q){var ce=U.db.version+1;ce>U.version&&(U.version=ce)}return!0}return!1}function V(U){return new f(function(ne,q){var ue=new FileReader;ue.onerror=q,ue.onloadend=function(de){var ce=btoa(de.target.result||"");ne({__local_forage_encoded_blob:!0,data:ce,type:U.type})},ue.readAsBinaryString(U)})}function H(U){var ne=_(atob(U.data));return d([ne],{type:U.type})}function P(U){return U&&U.__local_forage_encoded_blob}function Y(U){var ne=this,q=ne._initReady().then(function(){var ue=y[ne._dbInfo.name];if(ue&&ue.dbReady)return ue.dbReady});return g(q,U,U),q}function ge(U){M(U);for(var ne=y[U.name],q=ne.forages,ue=0;ue<q.length;ue++){var de=q[ue];de._dbInfo.db&&(de._dbInfo.db.close(),de._dbInfo.db=null)}return U.db=null,G(U).then(function(ce){return U.db=ce,J(U)?W(U):ce}).then(function(ce){U.db=ne.db=ce;for(var Ee=0;Ee<q.length;Ee++)q[Ee]._dbInfo.db=ce}).catch(function(ce){throw O(U,ce),ce})}function ae(U,ne,q,ue){ue===void 0&&(ue=1);try{var de=U.db.transaction(U.storeName,ne);q(null,de)}catch(ce){if(ue>0&&(!U.db||ce.name==="InvalidStateError"||ce.name==="NotFoundError"))return f.resolve().then(function(){if(!U.db||ce.name==="NotFoundError"&&!U.db.objectStoreNames.contains(U.storeName)&&U.version<=U.db.version)return U.db&&(U.version=U.db.version+1),W(U)}).then(function(){return ge(U).then(function(){ae(U,ne,q,ue-1)})}).catch(q);q(ce)}}function ee(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function le(U){var ne=this,q={db:null};if(U)for(var ue in U)q[ue]=U[ue];var de=y[q.name];de||(de=ee(),y[q.name]=de),de.forages.push(ne),ne._initReady||(ne._initReady=ne.ready,ne.ready=Y);var ce=[];function Ee(){return f.resolve()}for(var De=0;De<de.forages.length;De++){var Le=de.forages[De];Le!==ne&&ce.push(Le._initReady().catch(Ee))}var Me=de.forages.slice(0);return f.all(ce).then(function(){return q.db=de.db,G(q)}).then(function(Oe){return q.db=Oe,J(q,ne._defaultConfig.version)?W(q):Oe}).then(function(Oe){q.db=de.db=Oe,ne._dbInfo=q;for(var et=0;et<Me.length;et++){var wt=Me[et];wt!==ne&&(wt._dbInfo.db=q.db,wt._dbInfo.version=q.version)}})}function ie(U,ne){var q=this;U=v(U);var ue=new f(function(de,ce){q.ready().then(function(){ae(q._dbInfo,E,function(Ee,De){if(Ee)return ce(Ee);try{var Le=De.objectStore(q._dbInfo.storeName),Me=Le.get(U);Me.onsuccess=function(){var Oe=Me.result;Oe===void 0&&(Oe=null),P(Oe)&&(Oe=H(Oe)),de(Oe)},Me.onerror=function(){ce(Me.error)}}catch(Oe){ce(Oe)}})}).catch(ce)});return p(ue,ne),ue}function Q(U,ne){var q=this,ue=new f(function(de,ce){q.ready().then(function(){ae(q._dbInfo,E,function(Ee,De){if(Ee)return ce(Ee);try{var Le=De.objectStore(q._dbInfo.storeName),Me=Le.openCursor(),Oe=1;Me.onsuccess=function(){var et=Me.result;if(et){var wt=et.value;P(wt)&&(wt=H(wt));var Ut=U(wt,et.key,Oe++);Ut!==void 0?de(Ut):et.continue()}else de()},Me.onerror=function(){ce(Me.error)}}catch(et){ce(et)}})}).catch(ce)});return p(ue,ne),ue}function Z(U,ne,q){var ue=this;U=v(U);var de=new f(function(ce,Ee){var De;ue.ready().then(function(){return De=ue._dbInfo,w.call(ne)==="[object Blob]"?j(De.db).then(function(Le){return Le?ne:V(ne)}):ne}).then(function(Le){ae(ue._dbInfo,S,function(Me,Oe){if(Me)return Ee(Me);try{var et=Oe.objectStore(ue._dbInfo.storeName);Le===null&&(Le=void 0);var wt=et.put(Le,U);Oe.oncomplete=function(){Le===void 0&&(Le=null),ce(Le)},Oe.onabort=Oe.onerror=function(){var Ut=wt.error?wt.error:wt.transaction.error;Ee(Ut)}}catch(Ut){Ee(Ut)}})}).catch(Ee)});return p(de,q),de}function re(U,ne){var q=this;U=v(U);var ue=new f(function(de,ce){q.ready().then(function(){ae(q._dbInfo,S,function(Ee,De){if(Ee)return ce(Ee);try{var Le=De.objectStore(q._dbInfo.storeName),Me=Le.delete(U);De.oncomplete=function(){de()},De.onerror=function(){ce(Me.error)},De.onabort=function(){var Oe=Me.error?Me.error:Me.transaction.error;ce(Oe)}}catch(Oe){ce(Oe)}})}).catch(ce)});return p(ue,ne),ue}function se(U){var ne=this,q=new f(function(ue,de){ne.ready().then(function(){ae(ne._dbInfo,S,function(ce,Ee){if(ce)return de(ce);try{var De=Ee.objectStore(ne._dbInfo.storeName),Le=De.clear();Ee.oncomplete=function(){ue()},Ee.onabort=Ee.onerror=function(){var Me=Le.error?Le.error:Le.transaction.error;de(Me)}}catch(Me){de(Me)}})}).catch(de)});return p(q,U),q}function be(U){var ne=this,q=new f(function(ue,de){ne.ready().then(function(){ae(ne._dbInfo,E,function(ce,Ee){if(ce)return de(ce);try{var De=Ee.objectStore(ne._dbInfo.storeName),Le=De.count();Le.onsuccess=function(){ue(Le.result)},Le.onerror=function(){de(Le.error)}}catch(Me){de(Me)}})}).catch(de)});return p(q,U),q}function pe(U,ne){var q=this,ue=new f(function(de,ce){if(U<0){de(null);return}q.ready().then(function(){ae(q._dbInfo,E,function(Ee,De){if(Ee)return ce(Ee);try{var Le=De.objectStore(q._dbInfo.storeName),Me=!1,Oe=Le.openKeyCursor();Oe.onsuccess=function(){var et=Oe.result;if(!et){de(null);return}U===0||Me?de(et.key):(Me=!0,et.advance(U))},Oe.onerror=function(){ce(Oe.error)}}catch(et){ce(et)}})}).catch(ce)});return p(ue,ne),ue}function me(U){var ne=this,q=new f(function(ue,de){ne.ready().then(function(){ae(ne._dbInfo,E,function(ce,Ee){if(ce)return de(ce);try{var De=Ee.objectStore(ne._dbInfo.storeName),Le=De.openKeyCursor(),Me=[];Le.onsuccess=function(){var Oe=Le.result;if(!Oe){ue(Me);return}Me.push(Oe.key),Oe.continue()},Le.onerror=function(){de(Le.error)}}catch(Oe){de(Oe)}})}).catch(de)});return p(q,U),q}function Ne(U,ne){ne=b.apply(this,arguments);var q=this.config();U=typeof U!="function"&&U||{},U.name||(U.name=U.name||q.name,U.storeName=U.storeName||q.storeName);var ue=this,de;if(!U.name)de=f.reject("Invalid arguments");else{var ce=U.name===q.name&&ue._dbInfo.db,Ee=ce?f.resolve(ue._dbInfo.db):G(U).then(function(De){var Le=y[U.name],Me=Le.forages;Le.db=De;for(var Oe=0;Oe<Me.length;Oe++)Me[Oe]._dbInfo.db=De;return De});U.storeName?de=Ee.then(function(De){if(De.objectStoreNames.contains(U.storeName)){var Le=De.version+1;M(U);var Me=y[U.name],Oe=Me.forages;De.close();for(var et=0;et<Oe.length;et++){var wt=Oe[et];wt._dbInfo.db=null,wt._dbInfo.version=Le}var Ut=new f(function($t,Gn){var Bn=c.open(U.name,Le);Bn.onerror=function(fr){var Eg=Bn.result;Eg.close(),Gn(fr)},Bn.onupgradeneeded=function(){var fr=Bn.result;fr.deleteObjectStore(U.storeName)},Bn.onsuccess=function(){var fr=Bn.result;fr.close(),$t(fr)}});return Ut.then(function($t){Me.db=$t;for(var Gn=0;Gn<Oe.length;Gn++){var Bn=Oe[Gn];Bn._dbInfo.db=$t,L(Bn._dbInfo)}}).catch(function($t){throw(O(U,$t)||f.resolve()).catch(function(){}),$t})}}):de=Ee.then(function(De){M(U);var Le=y[U.name],Me=Le.forages;De.close();for(var Oe=0;Oe<Me.length;Oe++){var et=Me[Oe];et._dbInfo.db=null}var wt=new f(function(Ut,$t){var Gn=c.deleteDatabase(U.name);Gn.onerror=function(){var Bn=Gn.result;Bn&&Bn.close(),$t(Gn.error)},Gn.onblocked=function(){console.warn('dropInstance blocked for database "'+U.name+'" until all open connections are closed')},Gn.onsuccess=function(){var Bn=Gn.result;Bn&&Bn.close(),Ut(Bn)}});return wt.then(function(Ut){Le.db=Ut;for(var $t=0;$t<Me.length;$t++){var Gn=Me[$t];L(Gn._dbInfo)}}).catch(function(Ut){throw(O(U,Ut)||f.resolve()).catch(function(){}),Ut})})}return p(de,ne),de}var ve={_driver:"asyncStorage",_initStorage:le,_support:h(),iterate:Q,getItem:ie,setItem:Z,removeItem:re,clear:se,length:be,key:pe,keys:me,dropInstance:Ne};function _e(){return typeof openDatabase=="function"}var We="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ie="~~local_forage_type~",Re=/^~~local_forage_type~([^~]+)~/,Ze="__lfsc__:",it=Ze.length,tt="arbf",rt="blob",at="si08",ze="ui08",ft="uic8",Kt="si16",he="si32",X="ur16",je="ui32",qe="fl32",ke="fl64",Xe=it+tt.length,ct=Object.prototype.toString;function Pe(U){var ne=U.length*.75,q=U.length,ue,de=0,ce,Ee,De,Le;U[U.length-1]==="="&&(ne--,U[U.length-2]==="="&&ne--);var Me=new ArrayBuffer(ne),Oe=new Uint8Array(Me);for(ue=0;ue<q;ue+=4)ce=We.indexOf(U[ue]),Ee=We.indexOf(U[ue+1]),De=We.indexOf(U[ue+2]),Le=We.indexOf(U[ue+3]),Oe[de++]=ce<<2|Ee>>4,Oe[de++]=(Ee&15)<<4|De>>2,Oe[de++]=(De&3)<<6|Le&63;return Me}function Qe(U){var ne=new Uint8Array(U),q="",ue;for(ue=0;ue<ne.length;ue+=3)q+=We[ne[ue]>>2],q+=We[(ne[ue]&3)<<4|ne[ue+1]>>4],q+=We[(ne[ue+1]&15)<<2|ne[ue+2]>>6],q+=We[ne[ue+2]&63];return ne.length%3===2?q=q.substring(0,q.length-1)+"=":ne.length%3===1&&(q=q.substring(0,q.length-2)+"=="),q}function dt(U,ne){var q="";if(U&&(q=ct.call(U)),U&&(q==="[object ArrayBuffer]"||U.buffer&&ct.call(U.buffer)==="[object ArrayBuffer]")){var ue,de=Ze;U instanceof ArrayBuffer?(ue=U,de+=tt):(ue=U.buffer,q==="[object Int8Array]"?de+=at:q==="[object Uint8Array]"?de+=ze:q==="[object Uint8ClampedArray]"?de+=ft:q==="[object Int16Array]"?de+=Kt:q==="[object Uint16Array]"?de+=X:q==="[object Int32Array]"?de+=he:q==="[object Uint32Array]"?de+=je:q==="[object Float32Array]"?de+=qe:q==="[object Float64Array]"?de+=ke:ne(new Error("Failed to get type for BinaryArray"))),ne(de+Qe(ue))}else if(q==="[object Blob]"){var ce=new FileReader;ce.onload=function(){var Ee=Ie+U.type+"~"+Qe(this.result);ne(Ze+rt+Ee)},ce.readAsArrayBuffer(U)}else try{ne(JSON.stringify(U))}catch(Ee){console.error("Couldn't convert value into a JSON string: ",U),ne(null,Ee)}}function z(U){if(U.substring(0,it)!==Ze)return JSON.parse(U);var ne=U.substring(Xe),q=U.substring(it,Xe),ue;if(q===rt&&Re.test(ne)){var de=ne.match(Re);ue=de[1],ne=ne.substring(de[0].length)}var ce=Pe(ne);switch(q){case tt:return ce;case rt:return d([ce],{type:ue});case at:return new Int8Array(ce);case ze:return new Uint8Array(ce);case ft:return new Uint8ClampedArray(ce);case Kt:return new Int16Array(ce);case X:return new Uint16Array(ce);case he:return new Int32Array(ce);case je:return new Uint32Array(ce);case qe:return new Float32Array(ce);case ke:return new Float64Array(ce);default:throw new Error("Unkown type: "+q)}}var Se={serialize:dt,deserialize:z,stringToBuffer:Pe,bufferToString:Qe};function Te(U,ne,q,ue){U.executeSql("CREATE TABLE IF NOT EXISTS "+ne.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],q,ue)}function Fe(U){var ne=this,q={db:null};if(U)for(var ue in U)q[ue]=typeof U[ue]!="string"?U[ue].toString():U[ue];var de=new f(function(ce,Ee){try{q.db=openDatabase(q.name,String(q.version),q.description,q.size)}catch(De){return Ee(De)}q.db.transaction(function(De){Te(De,q,function(){ne._dbInfo=q,ce()},function(Le,Me){Ee(Me)})},Ee)});return q.serializer=Se,de}function F(U,ne,q,ue,de,ce){U.executeSql(q,ue,de,function(Ee,De){De.code===De.SYNTAX_ERR?Ee.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[ne.storeName],function(Le,Me){Me.rows.length?ce(Le,De):Te(Le,ne,function(){Le.executeSql(q,ue,de,ce)},ce)},ce):ce(Ee,De)},ce)}function K(U,ne){var q=this;U=v(U);var ue=new f(function(de,ce){q.ready().then(function(){var Ee=q._dbInfo;Ee.db.transaction(function(De){F(De,Ee,"SELECT * FROM "+Ee.storeName+" WHERE key = ? LIMIT 1",[U],function(Le,Me){var Oe=Me.rows.length?Me.rows.item(0).value:null;Oe&&(Oe=Ee.serializer.deserialize(Oe)),de(Oe)},function(Le,Me){ce(Me)})})}).catch(ce)});return p(ue,ne),ue}function C(U,ne){var q=this,ue=new f(function(de,ce){q.ready().then(function(){var Ee=q._dbInfo;Ee.db.transaction(function(De){F(De,Ee,"SELECT * FROM "+Ee.storeName,[],function(Le,Me){for(var Oe=Me.rows,et=Oe.length,wt=0;wt<et;wt++){var Ut=Oe.item(wt),$t=Ut.value;if($t&&($t=Ee.serializer.deserialize($t)),$t=U($t,Ut.key,wt+1),$t!==void 0){de($t);return}}de()},function(Le,Me){ce(Me)})})}).catch(ce)});return p(ue,ne),ue}function $(U,ne,q,ue){var de=this;U=v(U);var ce=new f(function(Ee,De){de.ready().then(function(){ne===void 0&&(ne=null);var Le=ne,Me=de._dbInfo;Me.serializer.serialize(ne,function(Oe,et){et?De(et):Me.db.transaction(function(wt){F(wt,Me,"INSERT OR REPLACE INTO "+Me.storeName+" (key, value) VALUES (?, ?)",[U,Oe],function(){Ee(Le)},function(Ut,$t){De($t)})},function(wt){if(wt.code===wt.QUOTA_ERR){if(ue>0){Ee($.apply(de,[U,Le,q,ue-1]));return}De(wt)}})})}).catch(De)});return p(ce,q),ce}function fe(U,ne,q){return $.apply(this,[U,ne,q,1])}function N(U,ne){var q=this;U=v(U);var ue=new f(function(de,ce){q.ready().then(function(){var Ee=q._dbInfo;Ee.db.transaction(function(De){F(De,Ee,"DELETE FROM "+Ee.storeName+" WHERE key = ?",[U],function(){de()},function(Le,Me){ce(Me)})})}).catch(ce)});return p(ue,ne),ue}function oe(U){var ne=this,q=new f(function(ue,de){ne.ready().then(function(){var ce=ne._dbInfo;ce.db.transaction(function(Ee){F(Ee,ce,"DELETE FROM "+ce.storeName,[],function(){ue()},function(De,Le){de(Le)})})}).catch(de)});return p(q,U),q}function xe(U){var ne=this,q=new f(function(ue,de){ne.ready().then(function(){var ce=ne._dbInfo;ce.db.transaction(function(Ee){F(Ee,ce,"SELECT COUNT(key) as c FROM "+ce.storeName,[],function(De,Le){var Me=Le.rows.item(0).c;ue(Me)},function(De,Le){de(Le)})})}).catch(de)});return p(q,U),q}function I(U,ne){var q=this,ue=new f(function(de,ce){q.ready().then(function(){var Ee=q._dbInfo;Ee.db.transaction(function(De){F(De,Ee,"SELECT key FROM "+Ee.storeName+" WHERE id = ? LIMIT 1",[U+1],function(Le,Me){var Oe=Me.rows.length?Me.rows.item(0).key:null;de(Oe)},function(Le,Me){ce(Me)})})}).catch(ce)});return p(ue,ne),ue}function te(U){var ne=this,q=new f(function(ue,de){ne.ready().then(function(){var ce=ne._dbInfo;ce.db.transaction(function(Ee){F(Ee,ce,"SELECT key FROM "+ce.storeName,[],function(De,Le){for(var Me=[],Oe=0;Oe<Le.rows.length;Oe++)Me.push(Le.rows.item(Oe).key);ue(Me)},function(De,Le){de(Le)})})}).catch(de)});return p(q,U),q}function ye(U){return new f(function(ne,q){U.transaction(function(ue){ue.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(de,ce){for(var Ee=[],De=0;De<ce.rows.length;De++)Ee.push(ce.rows.item(De).name);ne({db:U,storeNames:Ee})},function(de,ce){q(ce)})},function(ue){q(ue)})})}function Ke(U,ne){ne=b.apply(this,arguments);var q=this.config();U=typeof U!="function"&&U||{},U.name||(U.name=U.name||q.name,U.storeName=U.storeName||q.storeName);var ue=this,de;return U.name?de=new f(function(ce){var Ee;U.name===q.name?Ee=ue._dbInfo.db:Ee=openDatabase(U.name,"","",0),U.storeName?ce({db:Ee,storeNames:[U.storeName]}):ce(ye(Ee))}).then(function(ce){return new f(function(Ee,De){ce.db.transaction(function(Le){function Me(Ut){return new f(function($t,Gn){Le.executeSql("DROP TABLE IF EXISTS "+Ut,[],function(){$t()},function(Bn,fr){Gn(fr)})})}for(var Oe=[],et=0,wt=ce.storeNames.length;et<wt;et++)Oe.push(Me(ce.storeNames[et]));f.all(Oe).then(function(){Ee()}).catch(function(Ut){De(Ut)})},function(Le){De(Le)})})}):de=f.reject("Invalid arguments"),p(de,ne),de}var He={_driver:"webSQLStorage",_initStorage:Fe,_support:_e(),iterate:C,getItem:K,setItem:fe,removeItem:N,clear:oe,length:xe,key:I,keys:te,dropInstance:Ke};function Ve(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function At(U,ne){var q=U.name+"/";return U.storeName!==ne.storeName&&(q+=U.storeName+"/"),q}function Gr(){var U="_localforage_support_test";try{return localStorage.setItem(U,!0),localStorage.removeItem(U),!1}catch{return!0}}function vn(){return!Gr()||localStorage.length>0}function kt(U){var ne=this,q={};if(U)for(var ue in U)q[ue]=U[ue];return q.keyPrefix=At(U,ne._defaultConfig),vn()?(ne._dbInfo=q,q.serializer=Se,f.resolve()):f.reject()}function In(U){var ne=this,q=ne.ready().then(function(){for(var ue=ne._dbInfo.keyPrefix,de=localStorage.length-1;de>=0;de--){var ce=localStorage.key(de);ce.indexOf(ue)===0&&localStorage.removeItem(ce)}});return p(q,U),q}function ui(U,ne){var q=this;U=v(U);var ue=q.ready().then(function(){var de=q._dbInfo,ce=localStorage.getItem(de.keyPrefix+U);return ce&&(ce=de.serializer.deserialize(ce)),ce});return p(ue,ne),ue}function zi(U,ne){var q=this,ue=q.ready().then(function(){for(var de=q._dbInfo,ce=de.keyPrefix,Ee=ce.length,De=localStorage.length,Le=1,Me=0;Me<De;Me++){var Oe=localStorage.key(Me);if(Oe.indexOf(ce)===0){var et=localStorage.getItem(Oe);if(et&&(et=de.serializer.deserialize(et)),et=U(et,Oe.substring(Ee),Le++),et!==void 0)return et}}});return p(ue,ne),ue}function ud(U,ne){var q=this,ue=q.ready().then(function(){var de=q._dbInfo,ce;try{ce=localStorage.key(U)}catch{ce=null}return ce&&(ce=ce.substring(de.keyPrefix.length)),ce});return p(ue,ne),ue}function hd(U){var ne=this,q=ne.ready().then(function(){for(var ue=ne._dbInfo,de=localStorage.length,ce=[],Ee=0;Ee<de;Ee++){var De=localStorage.key(Ee);De.indexOf(ue.keyPrefix)===0&&ce.push(De.substring(ue.keyPrefix.length))}return ce});return p(q,U),q}function kn(U){var ne=this,q=ne.keys().then(function(ue){return ue.length});return p(q,U),q}function os(U,ne){var q=this;U=v(U);var ue=q.ready().then(function(){var de=q._dbInfo;localStorage.removeItem(de.keyPrefix+U)});return p(ue,ne),ue}function ti(U,ne,q){var ue=this;U=v(U);var de=ue.ready().then(function(){ne===void 0&&(ne=null);var ce=ne;return new f(function(Ee,De){var Le=ue._dbInfo;Le.serializer.serialize(ne,function(Me,Oe){if(Oe)De(Oe);else try{localStorage.setItem(Le.keyPrefix+U,Me),Ee(ce)}catch(et){(et.name==="QuotaExceededError"||et.name==="NS_ERROR_DOM_QUOTA_REACHED")&&De(et),De(et)}})})});return p(de,q),de}function Wr(U,ne){if(ne=b.apply(this,arguments),U=typeof U!="function"&&U||{},!U.name){var q=this.config();U.name=U.name||q.name,U.storeName=U.storeName||q.storeName}var ue=this,de;return U.name?de=new f(function(ce){U.storeName?ce(At(U,ue._defaultConfig)):ce(U.name+"/")}).then(function(ce){for(var Ee=localStorage.length-1;Ee>=0;Ee--){var De=localStorage.key(Ee);De.indexOf(ce)===0&&localStorage.removeItem(De)}}):de=f.reject("Invalid arguments"),p(de,ne),de}var dr={_driver:"localStorageWrapper",_initStorage:kt,_support:Ve(),iterate:zi,getItem:ui,setItem:ti,removeItem:os,clear:In,length:kn,key:ud,keys:hd,dropInstance:Wr},Ny=function(ne,q){return ne===q||typeof ne=="number"&&typeof q=="number"&&isNaN(ne)&&isNaN(q)},DO=function(ne,q){for(var ue=ne.length,de=0;de<ue;){if(Ny(ne[de],q))return!0;de++}return!1},IN=Array.isArray||function(U){return Object.prototype.toString.call(U)==="[object Array]"},Ag={},BN={},dd={INDEXEDDB:ve,WEBSQL:He,LOCALSTORAGE:dr},jO=[dd.INDEXEDDB._driver,dd.WEBSQL._driver,dd.LOCALSTORAGE._driver],_y=["dropInstance"],_w=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(_y),RO={description:"",driver:jO.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function LO(U,ne){U[ne]=function(){var q=arguments;return U.ready().then(function(){return U[ne].apply(U,q)})}}function kw(){for(var U=1;U<arguments.length;U++){var ne=arguments[U];if(ne)for(var q in ne)ne.hasOwnProperty(q)&&(IN(ne[q])?arguments[0][q]=ne[q].slice():arguments[0][q]=ne[q])}return arguments[0]}var MO=function(){function U(ne){a(this,U);for(var q in dd)if(dd.hasOwnProperty(q)){var ue=dd[q],de=ue._driver;this[q]=de,Ag[de]||this.defineDriver(ue)}this._defaultConfig=kw({},RO),this._config=kw({},this._defaultConfig,ne),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return U.prototype.config=function(q){if((typeof q>"u"?"undefined":r(q))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var ue in q){if(ue==="storeName"&&(q[ue]=q[ue].replace(/\W/g,"_")),ue==="version"&&typeof q[ue]!="number")return new Error("Database version must be a number.");this._config[ue]=q[ue]}return"driver"in q&&q.driver?this.setDriver(this._config.driver):!0}else return typeof q=="string"?this._config[q]:this._config},U.prototype.defineDriver=function(q,ue,de){var ce=new f(function(Ee,De){try{var Le=q._driver,Me=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!q._driver){De(Me);return}for(var Oe=_w.concat("_initStorage"),et=0,wt=Oe.length;et<wt;et++){var Ut=Oe[et],$t=!DO(_y,Ut);if(($t||q[Ut])&&typeof q[Ut]!="function"){De(Me);return}}var Gn=function(){for(var Eg=function(IO){return function(){var BO=new Error("Method "+IO+" is not implemented by the current driver"),zN=f.reject(BO);return p(zN,arguments[arguments.length-1]),zN}},Tw=0,PO=_y.length;Tw<PO;Tw++){var Dw=_y[Tw];q[Dw]||(q[Dw]=Eg(Dw))}};Gn();var Bn=function(Eg){Ag[Le]&&console.info("Redefining LocalForage driver: "+Le),Ag[Le]=q,BN[Le]=Eg,Ee()};"_support"in q?q._support&&typeof q._support=="function"?q._support().then(Bn,De):Bn(!!q._support):Bn(!0)}catch(fr){De(fr)}});return g(ce,ue,de),ce},U.prototype.driver=function(){return this._driver||null},U.prototype.getDriver=function(q,ue,de){var ce=Ag[q]?f.resolve(Ag[q]):f.reject(new Error("Driver not found."));return g(ce,ue,de),ce},U.prototype.getSerializer=function(q){var ue=f.resolve(Se);return g(ue,q),ue},U.prototype.ready=function(q){var ue=this,de=ue._driverSet.then(function(){return ue._ready===null&&(ue._ready=ue._initDriver()),ue._ready});return g(de,q,q),de},U.prototype.setDriver=function(q,ue,de){var ce=this;IN(q)||(q=[q]);var Ee=this._getSupportedDrivers(q);function De(){ce._config.driver=ce.driver()}function Le(et){return ce._extend(et),De(),ce._ready=ce._initStorage(ce._config),ce._ready}function Me(et){return function(){var wt=0;function Ut(){for(;wt<et.length;){var $t=et[wt];return wt++,ce._dbInfo=null,ce._ready=null,ce.getDriver($t).then(Le).catch(Ut)}De();var Gn=new Error("No available storage method found.");return ce._driverSet=f.reject(Gn),ce._driverSet}return Ut()}}var Oe=this._driverSet!==null?this._driverSet.catch(function(){return f.resolve()}):f.resolve();return this._driverSet=Oe.then(function(){var et=Ee[0];return ce._dbInfo=null,ce._ready=null,ce.getDriver(et).then(function(wt){ce._driver=wt._driver,De(),ce._wrapLibraryMethodsWithReady(),ce._initDriver=Me(Ee)})}).catch(function(){De();var et=new Error("No available storage method found.");return ce._driverSet=f.reject(et),ce._driverSet}),g(this._driverSet,ue,de),this._driverSet},U.prototype.supports=function(q){return!!BN[q]},U.prototype._extend=function(q){kw(this,q)},U.prototype._getSupportedDrivers=function(q){for(var ue=[],de=0,ce=q.length;de<ce;de++){var Ee=q[de];this.supports(Ee)&&ue.push(Ee)}return ue},U.prototype._wrapLibraryMethodsWithReady=function(){for(var q=0,ue=_w.length;q<ue;q++)LO(this,_w[q])},U.prototype.createInstance=function(q){return new U(q)},U}(),OO=new MO;i.exports=OO},{3:3}]},{},[4])(4)})})(Q4);var jV=Q4.exports;const qT=ed(jV);class J4{constructor(e,t,i){this.urlCache={},this.storage=void 0,this.name=e,this.requester=t||Jm,this.resolver=i,this.online=!0,this.checkRequirements(),this.addListeners()}checkRequirements(){try{let e;typeof qT>"u"&&(e=qT),this.storage=e.createInstance({name:this.name})}catch{throw new Error("localForage lib not loaded")}}addListeners(){this._status=this.status.bind(this),window.addEventListener("online",this._status),window.addEventListener("offline",this._status)}removeListeners(){window.removeEventListener("online",this._status),window.removeEventListener("offline",this._status),this._status=void 0}status(e){let t=navigator.onLine;this.online=t,t?this.emit("online",this):this.emit("offline",this)}add(e,t){let i=e.resources.map(s=>{let{href:r}=s,a=this.resolver(r),o=window.encodeURIComponent(a);return this.storage.getItem(o).then(c=>!c||t?this.requester(a,"binary").then(h=>this.storage.setItem(o,h)):c)});return Promise.all(i)}put(e,t,i){let s=window.encodeURIComponent(e);return this.storage.getItem(s).then(r=>r||this.requester(e,"binary",t,i).then(a=>this.storage.setItem(s,a)))}request(e,t,i,s){return this.online?this.requester(e,t,i,s).then(r=>(this.put(e),r)):this.retrieve(e,t)}retrieve(e,t){new Dt;var i,s=new kl(e);return t||(t=s.extension),t=="blob"?i=this.getBlob(e):i=this.getText(e),i.then(r=>{var a=new Dt,o;return r?(o=this.handleResponse(r,t),a.resolve(o)):a.reject({message:"File not found in storage: "+e,stack:new Error().stack}),a.promise})}handleResponse(e,t){var i;return t=="json"?i=JSON.parse(e):Qm(t)?i=io(e,"text/xml"):t=="xhtml"?i=io(e,"application/xhtml+xml"):t=="html"||t=="htm"?i=io(e,"text/html"):i=e,i}getBlob(e,t){let i=window.encodeURIComponent(e);return this.storage.getItem(i).then(function(s){if(s)return t=t||gf.lookup(e),new Blob([s],{type:t})})}getText(e,t){let i=window.encodeURIComponent(e);return t=t||gf.lookup(e),this.storage.getItem(i).then(function(s){var r=new Dt,a=new FileReader,o;if(s)return o=new Blob([s],{type:t}),a.addEventListener("loadend",()=>{r.resolve(a.result)}),a.readAsText(o,t),r.promise})}getBase64(e,t){let i=window.encodeURIComponent(e);return t=t||gf.lookup(e),this.storage.getItem(i).then(s=>{var r=new Dt,a=new FileReader,o;if(s)return o=new Blob([s],{type:t}),a.addEventListener("loadend",()=>{r.resolve(a.result)}),a.readAsDataURL(o,t),r.promise})}createUrl(e,t){var i=new Dt,s=window.URL||window.webkitURL||window.mozURL,r,a,o=t&&t.base64;return e in this.urlCache?(i.resolve(this.urlCache[e]),i.promise):(o?(a=this.getBase64(e),a&&a.then((function(c){this.urlCache[e]=c,i.resolve(c)}).bind(this))):(a=this.getBlob(e),a&&a.then((function(c){r=s.createObjectURL(c),this.urlCache[e]=r,i.resolve(r)}).bind(this))),a||i.reject({message:"File not found in storage: "+e,stack:new Error().stack}),i.promise)}revokeUrl(e){var t=window.URL||window.webkitURL||window.mozURL,i=this.urlCache[e];i&&t.revokeObjectURL(i)}destroy(){var e=window.URL||window.webkitURL||window.mozURL;for(let t in this.urlCache)e.revokeObjectURL(t);this.urlCache={},this.removeListeners()}}uo(J4.prototype);class O2{constructor(e){this.interactive="",this.fixedLayout="",this.openToSpread="",this.orientationLock="",e&&this.parse(e)}parse(e){if(!e)return this;const t=ln(e,"display_options");return t?(_l(t,"option").forEach(s=>{let r="";switch(s.childNodes.length&&(r=s.childNodes[0].nodeValue),s.attributes.name.value){case"interactive":this.interactive=r;break;case"fixed-layout":this.fixedLayout=r;break;case"open-to-spread":this.openToSpread=r;break;case"orientation-lock":this.orientationLock=r;break}}),this):this}destroy(){this.interactive=void 0,this.fixedLayout=void 0,this.openToSpread=void 0,this.orientationLock=void 0}}const VT="META-INF/container.xml",RV="META-INF/com.apple.ibooks.display-options.xml",Xr={BINARY:"binary",BASE64:"base64",EPUB:"epub",OPF:"opf",MANIFEST:"json",DIRECTORY:"directory"};class bN{constructor(e,t){typeof t>"u"&&typeof e!="string"&&!(e instanceof Blob)&&!(e instanceof ArrayBuffer)&&(t=e,e=void 0),this.settings=Ii(this.settings||{},{requestMethod:void 0,requestCredentials:void 0,requestHeaders:void 0,encoding:void 0,replacements:void 0,canonical:void 0,openAs:void 0,store:void 0}),Ii(this.settings,t),this.opening=new Dt,this.opened=this.opening.promise,this.isOpen=!1,this.loading={manifest:new Dt,spine:new Dt,metadata:new Dt,cover:new Dt,navigation:new Dt,pageList:new Dt,resources:new Dt,displayOptions:new Dt},this.loaded={manifest:this.loading.manifest.promise,spine:this.loading.spine.promise,metadata:this.loading.metadata.promise,cover:this.loading.cover.promise,navigation:this.loading.navigation.promise,pageList:this.loading.pageList.promise,resources:this.loading.resources.promise,displayOptions:this.loading.displayOptions.promise},this.ready=Promise.all([this.loaded.manifest,this.loaded.spine,this.loaded.metadata,this.loaded.cover,this.loaded.navigation,this.loaded.resources,this.loaded.displayOptions]),this.isRendered=!1,this.request=this.settings.requestMethod||Jm,this.spine=new Z$,this.locations=new O4(this.spine,this.load.bind(this)),this.navigation=void 0,this.pageList=void 0,this.url=void 0,this.path=void 0,this.archived=!1,this.archive=void 0,this.storage=void 0,this.resources=void 0,this.rendition=void 0,this.container=void 0,this.packaging=void 0,this.displayOptions=void 0,this.settings.store&&this.store(this.settings.store),e&&this.open(e,this.settings.openAs).catch(i=>{var s=new Error("Cannot load book at "+e);this.emit(Ue.BOOK.OPEN_FAILED,s)})}open(e,t){var i,s=t||this.determineType(e);return s===Xr.BINARY?(this.archived=!0,this.url=new Qr("/",""),i=this.openEpub(e)):s===Xr.BASE64?(this.archived=!0,this.url=new Qr("/",""),i=this.openEpub(e,s)):s===Xr.EPUB?(this.archived=!0,this.url=new Qr("/",""),i=this.request(e,"binary",this.settings.requestCredentials,this.settings.requestHeaders).then(this.openEpub.bind(this))):s==Xr.OPF?(this.url=new Qr(e),i=this.openPackaging(this.url.Path.toString())):s==Xr.MANIFEST?(this.url=new Qr(e),i=this.openManifest(this.url.Path.toString())):(this.url=new Qr(e),i=this.openContainer(VT).then(this.openPackaging.bind(this))),i}openEpub(e,t){return this.unarchive(e,t||this.settings.encoding).then(()=>this.openContainer(VT)).then(i=>this.openPackaging(i))}openContainer(e){return this.load(e).then(t=>(this.container=new Q$(t),this.resolve(this.container.packagePath)))}openPackaging(e){return this.path=new kl(e),this.load(e).then(t=>(this.packaging=new PT(t),this.unpack(this.packaging)))}openManifest(e){return this.path=new kl(e),this.load(e).then(t=>(this.packaging=new PT,this.packaging.load(t),this.unpack(this.packaging)))}load(e){var t=this.resolve(e);return this.archived?this.archive.request(t):this.request(t,null,this.settings.requestCredentials,this.settings.requestHeaders)}resolve(e,t){if(e){var i=e,s=e.indexOf("://")>-1;return s?e:(this.path&&(i=this.path.resolve(e)),t!=!1&&this.url&&(i=this.url.resolve(i)),i)}}canonical(e){var t=e;return e?(this.settings.canonical?t=this.settings.canonical(e):t=this.resolve(e,!0),t):""}determineType(e){var t,i,s;if(this.settings.encoding==="base64")return Xr.BASE64;if(typeof e!="string")return Xr.BINARY;if(t=new Qr(e),i=t.path(),s=i.extension,s&&(s=s.replace(/\?.*$/,"")),!s)return Xr.DIRECTORY;if(s==="epub")return Xr.EPUB;if(s==="opf")return Xr.OPF;if(s==="json")return Xr.MANIFEST}unpack(e){this.package=e,this.packaging.metadata.layout===""?this.load(this.url.resolve(RV)).then(t=>{this.displayOptions=new O2(t),this.loading.displayOptions.resolve(this.displayOptions)}).catch(t=>{this.displayOptions=new O2,this.loading.displayOptions.resolve(this.displayOptions)}):(this.displayOptions=new O2,this.loading.displayOptions.resolve(this.displayOptions)),this.spine.unpack(this.packaging,this.resolve.bind(this),this.canonical.bind(this)),this.resources=new nq(this.packaging.manifest,{archive:this.archive,resolver:this.resolve.bind(this),request:this.request.bind(this),replacements:this.settings.replacements||(this.archived?"blobUrl":"base64")}),this.loadNavigation(this.packaging).then(()=>{this.loading.navigation.resolve(this.navigation)}),this.packaging.coverPath&&(this.cover=this.resolve(this.packaging.coverPath)),this.loading.manifest.resolve(this.packaging.manifest),this.loading.metadata.resolve(this.packaging.metadata),this.loading.spine.resolve(this.spine),this.loading.cover.resolve(this.cover),this.loading.resources.resolve(this.resources),this.loading.pageList.resolve(this.pageList),this.isOpen=!0,this.archived||this.settings.replacements&&this.settings.replacements!="none"?this.replacements().then(()=>{this.loaded.displayOptions.then(()=>{this.opening.resolve(this)})}).catch(t=>{console.error(t)}):this.loaded.displayOptions.then(()=>{this.opening.resolve(this)})}loadNavigation(e){let t=e.navPath||e.ncxPath,i=e.toc;return i?new Promise((s,r)=>{this.navigation=new R2(i),e.pageList&&(this.pageList=new L2(e.pageList)),s(this.navigation)}):t?this.load(t,"xml").then(s=>(this.navigation=new R2(s),this.pageList=new L2(s),this.navigation)):new Promise((s,r)=>{this.navigation=new R2,this.pageList=new L2,s(this.navigation)})}section(e){return this.spine.get(e)}renderTo(e,t){return this.rendition=new vN(this,t),this.rendition.attachTo(e),this.rendition}setRequestCredentials(e){this.settings.requestCredentials=e}setRequestHeaders(e){this.settings.requestHeaders=e}unarchive(e,t){return this.archive=new DV,this.archive.open(e,t)}store(e){let t=this.settings.replacements&&this.settings.replacements!=="none",i=this.url,s=this.settings.requestMethod||Jm.bind(this);return this.storage=new J4(e,s,this.resolve.bind(this)),this.request=this.storage.request.bind(this.storage),this.opened.then(()=>{this.archived&&(this.storage.requester=this.archive.request.bind(this.archive));let r=(a,o)=>{o.output=this.resources.substitute(a,o.url)};this.resources.settings.replacements=t||"blobUrl",this.resources.replacements().then(()=>this.resources.replaceCss()),this.storage.on("offline",()=>{this.url=new Qr("/",""),this.spine.hooks.serialize.register(r)}),this.storage.on("online",()=>{this.url=i,this.spine.hooks.serialize.deregister(r)})}),this.storage}coverUrl(){return this.loaded.cover.then(()=>this.cover?this.archived?this.archive.createUrl(this.cover):this.cover:null)}replacements(){return this.spine.hooks.serialize.register((e,t)=>{t.output=this.resources.substitute(e,t.url)}),this.resources.replacements().then(()=>this.resources.replaceCss())}getRange(e){var t=new jt(e),i=this.spine.get(t.spinePos),s=this.load.bind(this);return i?i.load(s).then(function(r){var a=t.toRange(i.document);return a}):new Promise((r,a)=>{a("CFI could not be found")})}key(e){var t=e||this.packaging.metadata.identifier||this.url.filename;return`epubjs:${hw}:${t}`}destroy(){this.opened=void 0,this.loading=void 0,this.loaded=void 0,this.ready=void 0,this.isOpen=!1,this.isRendered=!1,this.spine&&this.spine.destroy(),this.locations&&this.locations.destroy(),this.pageList&&this.pageList.destroy(),this.archive&&this.archive.destroy(),this.resources&&this.resources.destroy(),this.container&&this.container.destroy(),this.packaging&&this.packaging.destroy(),this.rendition&&this.rendition.destroy(),this.displayOptions&&this.displayOptions.destroy(),this.spine=void 0,this.locations=void 0,this.pageList=void 0,this.archive=void 0,this.resources=void 0,this.container=void 0,this.packaging=void 0,this.rendition=void 0,this.navigation=void 0,this.url=void 0,this.path=void 0,this.archived=!1}}uo(bN.prototype);function od(n,e){return new bN(n,e)}od.VERSION=hw;typeof global<"u"&&(global.EPUBJS_VERSION=hw);od.Book=bN;od.Rendition=vN;od.Contents=mN;od.CFI=jt;od.utils=$$;const P2=[{name:"yellow",value:"#fbbf24"},{name:"blue",value:"#3b82f6"},{name:"green",value:"#22c55e"},{name:"red",value:"#ef4444"}],LV={dark:{color:"#e5e5e5",background:"#0f0f0f"},light:{color:"#1a1a1a",background:"#ffffff"},sepia:{color:"#5b4636",background:"#f4ecd8"}},GT="z-reader-book-typography-style";function WT(n,e){var r,a,o;const t=ow[e.font],i=String(e.lineHeight);let s=n.getElementById(GT);s||(s=n.createElement("style"),s.id=GT,(r=n.head)==null||r.appendChild(s)),s.textContent=`
    html, body {
      font-family: ${t} !important;
      line-height: ${i} !important;
    }
    body *:not(pre):not(code):not(kbd):not(samp) {
      font-family: ${t} !important;
    }
    body p, body li, body blockquote, body dd, body dt, body h1, body h2, body h3, body h4, body h5, body h6 {
      line-height: ${i} !important;
    }
  `,(a=n.body)==null||a.style.setProperty("font-family",t,"important"),(o=n.body)==null||o.style.setProperty("line-height",i,"important")}function eL(n,e=0){return n.map(t=>{var i;return{id:t.id,label:t.label.trim(),href:t.href,level:e,children:(i=t.subitems)!=null&&i.length?eL(t.subitems,e+1):void 0}})}const MV=A.forwardRef(function({bookId:e,filePath:t,highlights:i,onHighlightsChange:s,onTocLoaded:r,onProgressChange:a,onLocationChange:o,settings:c,initialLocation:h},d){const f=A.useRef(null),p=A.useRef(null),g=A.useRef(null),v=A.useRef(c);v.current=c;const b=A.useRef(!1),x=A.useRef([]),m=A.useRef(i);m.current=i;const[y,w]=A.useState(null);A.useImperativeHandle(d,()=>({navigateTo(M){var L;(L=g.current)==null||L.display(M)},navigateToHighlight(M){var L;(L=g.current)==null||L.display(M)}}));const E=A.useCallback((M,L)=>{const O=LV[L.theme];M.themes.override("color",O.color),M.themes.override("background",O.background),M.themes.fontSize(L.fontSize+"px"),M.themes.font(ow[L.font]),M.themes.override("line-height",String(L.lineHeight),!0);const B=M.getContents(),G=Array.isArray(B)?B:B?[B]:[];for(const W of G){const J=W==null?void 0:W.document;J&&WT(J,L)}},[]),S=A.useCallback(()=>{var M,L,O,B,G;try{const W=g.current,J=((M=W==null?void 0:W.getContents)==null?void 0:M.call(W))??[];for(const V of J)(B=(O=(L=V.window)==null?void 0:L.getSelection)==null?void 0:O.call(L))==null||B.removeAllRanges();(G=window.getSelection())==null||G.removeAllRanges()}catch{}},[]),_=A.useCallback(M=>{for(const L of x.current)try{M.annotations.remove(L,"epub-highlight")}catch{}x.current=[]},[]),T=A.useCallback((M,L)=>{var B;const O=[];for(const G of L){if(!G.anchorPath)continue;const W=((B=P2.find(J=>J.name===G.color))==null?void 0:B.value)??P2[0].value;try{M.annotations.highlight(G.anchorPath,{},void 0,"epub-highlight",{fill:W,"fill-opacity":"0.3","mix-blend-mode":"multiply"}),O.push(G.anchorPath)}catch{}}x.current=O},[]);A.useEffect(()=>{if(!f.current)return;let M=!1,L=null,O=null;async function B(){const G=await window.electronAPI.bookReadFile(e);if(M||!G||!f.current)return;const W=od(G);L=W,p.current=W;const J=W.renderTo(f.current,{flow:"scrolled",width:"100%",height:"100%"});O=J,g.current=J;const V=P=>{const Y=P==null?void 0:P.document;Y&&WT(Y,v.current)};J.hooks.content.register(V),E(J,c);const H=h||void 0;J.display(H),W.loaded.navigation.then(P=>{r(eL(P.toc))}).catch(()=>{r([])}),W.ready.then(()=>{b.current||(b.current=!0,W.locations.generate(1600))}),J.on("relocated",P=>{P!=null&&P.start&&(a(P.start.percentage),o(P.start.cfi))}),J.on("selected",P=>{var Y,ge,ae;try{const ee=J.getRange(P),le=(ee==null?void 0:ee.toString())??"";if(!le.trim())return;if(m.current.some(Ne=>Ne.anchorPath===P)){S(),w(null);return}const Q=ee.getBoundingClientRect(),Z=(Y=f.current)==null?void 0:Y.getBoundingClientRect();if(!Q||!Z)return;const re=((ge=ee.startContainer)==null?void 0:ge.ownerDocument)??null,se=(ae=re==null?void 0:re.defaultView)==null?void 0:ae.frameElement,be=se==null?void 0:se.getBoundingClientRect(),pe=be?be.left+Q.left+Q.width/2:Q.left+Q.width/2,me=be?be.top+Q.top:Q.top;w({x:pe-Z.left,y:me-Z.top-8,cfiRange:P,text:le})}catch{}}),J.on("markClicked",(P,Y)=>{var ee;const ge=typeof P=="string"&&P||(Y==null?void 0:Y.cfiRange)||((ee=Y==null?void 0:Y.annotation)==null?void 0:ee.cfiRange)||null;if(!ge)return;const ae=m.current.find(le=>le.anchorPath===ge);ae&&window.dispatchEvent(new CustomEvent("book-reader:highlight-click",{detail:{bookId:e,highlightId:ae.id}}))}),_(J),T(J,m.current)}return B().catch(()=>{r([])}),()=>{M=!0,O&&O.destroy(),L&&L.destroy(),p.current=null,g.current=null,x.current=[],b.current=!1}},[t,e,h,o,a,r,E,T,_,S]),A.useEffect(()=>{g.current&&E(g.current,c)},[c,E]),A.useEffect(()=>{const M=g.current;M&&(_(M),T(M,i))},[i,T,_]),A.useEffect(()=>{const M=L=>{var O,B;L.key==="ArrowLeft"&&((O=g.current)==null||O.prev()),L.key==="ArrowRight"&&((B=g.current)==null||B.next())};return document.addEventListener("keydown",M),()=>document.removeEventListener("keydown",M)},[]),A.useEffect(()=>{if(!y)return;const M=()=>w(null);return document.addEventListener("mousedown",M),()=>document.removeEventListener("mousedown",M)},[y]);const j=A.useCallback(async M=>{if(!y||!g.current)return;const{cfiRange:L,text:O}=y,B=m.current.find(G=>G.anchorPath===L);if(w(null),S(),B){if(B.color!==M)try{const G=await window.electronAPI.highlightUpdate({id:B.id,color:M});s(m.current.map(W=>W.id===B.id?G:W))}catch{}return}try{const G=await window.electronAPI.bookHighlightCreate({bookId:e,text:O,anchorPath:L,color:M});s([...m.current,G])}catch{}},[y,e,s,S]);return l.jsxs("div",{className:"relative w-full h-full overflow-hidden",children:[l.jsx("div",{ref:f,className:"w-full h-full"}),y&&l.jsx("div",{className:"absolute z-50 flex items-center gap-1.5 px-2 py-1.5 bg-[#1a1a1a] border border-white/10 rounded-lg shadow-xl",style:{left:y.x,top:y.y,transform:"translate(-50%, -100%)"},onMouseDown:M=>M.stopPropagation(),children:P2.map(M=>l.jsx("button",{onClick:()=>j(M.name),className:"w-5 h-5 rounded-full border border-white/20 hover:scale-110 transition-transform cursor-pointer",style:{backgroundColor:M.value},title:M.name},M.name))})]})}),ns=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),hA=[.001,0,0,.001,0,0],I2=1.35,Zs={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Hl={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},t0="pdfjs_internal_editor_",gt={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},Tt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},OV={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},dA={TRIANGLES:1,LATTICE:2},ii={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Cv={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Yn={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Md={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},gw={ERRORS:0,WARNINGS:1,INFOS:5},n0={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Bg={moveTo:0,lineTo:1,curveTo:2,quadraticCurveTo:3,closePath:4},PV={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let mw=gw.WARNINGS;function IV(n){Number.isInteger(n)&&(mw=n)}function BV(){return mw}function xw(n){mw>=gw.INFOS&&console.info(`Info: ${n}`)}function ut(n){mw>=gw.WARNINGS&&console.warn(`Warning: ${n}`)}function zt(n){throw new Error(n)}function It(n,e){n||zt(e)}function zV(n){switch(n==null?void 0:n.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function tL(n,e=null,t=null){if(!n)return null;if(t&&typeof n=="string"){if(t.addDefaultProtocol&&n.startsWith("www.")){const s=n.match(/\./g);(s==null?void 0:s.length)>=2&&(n=`http://${n}`)}if(t.tryConvertEncoding)try{n=VV(n)}catch{}}const i=e?URL.parse(n,e):URL.parse(n);return zV(i)?i:null}function nL(n,e,t=!1){const i=URL.parse(n);return i?(i.hash=e,i.href):t&&tL(n,"http://example.com")?n.split("#",1)[0]+`${e?`#${e}`:""}`:""}function ht(n,e,t,i=!1){return Object.defineProperty(n,e,{value:t,enumerable:!i,configurable:!0,writable:!1}),t}const ld=function(){function e(t,i){this.message=t,this.name=i}return e.prototype=new Error,e.constructor=e,e}();class YT extends ld{constructor(e,t){super(e,"PasswordException"),this.code=t}}class B2 extends ld{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class fA extends ld{constructor(e){super(e,"InvalidPDFException")}}class e1 extends ld{constructor(e,t,i){super(e,"ResponseException"),this.status=t,this.missing=i}}class FV extends ld{constructor(e){super(e,"FormatError")}}class au extends ld{constructor(e){super(e,"AbortException")}}function UV(n){(typeof n!="object"||(n==null?void 0:n.length)===void 0)&&zt("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const i=[];for(let s=0;s<e;s+=t){const r=Math.min(s+t,e),a=n.subarray(s,r);i.push(String.fromCharCode.apply(null,a))}return i.join("")}function yw(n){typeof n!="string"&&zt("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let i=0;i<e;++i)t[i]=n.charCodeAt(i)&255;return t}function HV(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function $V(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function qV(){try{return new Function(""),!0}catch{return!1}}class li{static get isLittleEndian(){return ht(this,"isLittleEndian",$V())}static get isEvalSupported(){return ht(this,"isEvalSupported",qV())}static get isOffscreenCanvasSupported(){return ht(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return ht(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get isFloat16ArraySupported(){return ht(this,"isFloat16ArraySupported",typeof Float16Array<"u")}static get isSanitizerSupported(){return ht(this,"isSanitizerSupported",typeof Sanitizer<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return ht(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){var e,t;return ht(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const z2=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));var ml,Nv,pA;class $e{static makeHexColor(e,t,i){return`#${z2[e]}${z2[t]}${z2[i]}`}static domMatrixToTransform(e){return[e.a,e.b,e.c,e.d,e.e,e.f]}static scaleMinMax(e,t){let i;e[0]?(e[0]<0&&(i=t[0],t[0]=t[2],t[2]=i),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(i=t[1],t[1]=t[3],t[3]=i),t[1]*=e[3],t[3]*=e[3]):(i=t[0],t[0]=t[1],t[1]=i,i=t[2],t[2]=t[3],t[3]=i,e[1]<0&&(i=t[1],t[1]=t[3],t[3]=i),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(i=t[0],t[0]=t[2],t[2]=i),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static multiplyByDOMMatrix(e,t){return[e[0]*t.a+e[2]*t.b,e[1]*t.a+e[3]*t.b,e[0]*t.c+e[2]*t.d,e[1]*t.c+e[3]*t.d,e[0]*t.e+e[2]*t.f+e[4],e[1]*t.e+e[3]*t.f+e[5]]}static applyTransform(e,t,i=0){const s=e[i],r=e[i+1];e[i]=s*t[0]+r*t[2]+t[4],e[i+1]=s*t[1]+r*t[3]+t[5]}static applyTransformToBezier(e,t,i=0){const s=t[0],r=t[1],a=t[2],o=t[3],c=t[4],h=t[5];for(let d=0;d<6;d+=2){const f=e[i+d],p=e[i+d+1];e[i+d]=f*s+p*a+c,e[i+d+1]=f*r+p*o+h}}static applyInverseTransform(e,t){const i=e[0],s=e[1],r=t[0]*t[3]-t[1]*t[2];e[0]=(i*t[3]-s*t[2]+t[2]*t[5]-t[4]*t[3])/r,e[1]=(-i*t[1]+s*t[0]+t[4]*t[1]-t[5]*t[0])/r}static axialAlignedBoundingBox(e,t,i){const s=t[0],r=t[1],a=t[2],o=t[3],c=t[4],h=t[5],d=e[0],f=e[1],p=e[2],g=e[3];let v=s*d+c,b=v,x=s*p+c,m=x,y=o*f+h,w=y,E=o*g+h,S=E;if(r!==0||a!==0){const _=r*d,T=r*p,j=a*f,M=a*g;v+=j,m+=j,x+=M,b+=M,y+=_,S+=_,E+=T,w+=T}i[0]=Math.min(i[0],v,x,b,m),i[1]=Math.min(i[1],y,E,w,S),i[2]=Math.max(i[2],v,x,b,m),i[3]=Math.max(i[3],y,E,w,S)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const i=e[0],s=e[1],r=e[2],a=e[3],o=i**2+s**2,c=i*r+s*a,h=r**2+a**2,d=(o+h)/2,f=Math.sqrt(d**2-(o*h-c**2));t[0]=Math.sqrt(d+f||1),t[1]=Math.sqrt(d-f||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const i=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),s=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(i>s)return null;const r=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),a=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return r>a?null:[i,r,s,a]}static pointBoundingBox(e,t,i){i[0]=Math.min(i[0],e),i[1]=Math.min(i[1],t),i[2]=Math.max(i[2],e),i[3]=Math.max(i[3],t)}static rectBoundingBox(e,t,i,s,r){r[0]=Math.min(r[0],e,i),r[1]=Math.min(r[1],t,s),r[2]=Math.max(r[2],e,i),r[3]=Math.max(r[3],t,s)}static bezierBoundingBox(e,t,i,s,r,a,o,c,h){h[0]=Math.min(h[0],e,o),h[1]=Math.min(h[1],t,c),h[2]=Math.max(h[2],e,o),h[3]=Math.max(h[3],t,c),R(this,ml,pA).call(this,e,i,r,o,t,s,a,c,3*(-e+3*(i-r)+o),6*(e-2*i+r),3*(i-e),h),R(this,ml,pA).call(this,e,i,r,o,t,s,a,c,3*(-t+3*(s-a)+c),6*(t-2*s+a),3*(s-t),h)}}ml=new WeakSet,Nv=function(e,t,i,s,r,a,o,c,h,d){if(h<=0||h>=1)return;const f=1-h,p=h*h,g=p*h,v=f*(f*(f*e+3*h*t)+3*p*i)+g*s,b=f*(f*(f*r+3*h*a)+3*p*o)+g*c;d[0]=Math.min(d[0],v),d[1]=Math.min(d[1],b),d[2]=Math.max(d[2],v),d[3]=Math.max(d[3],b)},pA=function(e,t,i,s,r,a,o,c,h,d,f,p){if(Math.abs(h)<1e-12){Math.abs(d)>=1e-12&&R(this,ml,Nv).call(this,e,t,i,s,r,a,o,c,-f/d,p);return}const g=d**2-4*f*h;if(g<0)return;const v=Math.sqrt(g),b=2*h;R(this,ml,Nv).call(this,e,t,i,s,r,a,o,c,(-d+v)/b,p),R(this,ml,Nv).call(this,e,t,i,s,r,a,o,c,(-d-v)/b,p)},D($e,ml);function VV(n){return decodeURIComponent(escape(n))}let F2=null,XT=null;function GV(n){return F2||(F2=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,XT=new Map([["ï¬…","Å¿t"]])),n.replaceAll(F2,(e,t,i)=>t?t.normalize("NFKC"):XT.get(i))}function iL(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),UV(n)}const tf="pdfjs_internal_id_";function WV(n,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[i,s,...r]=t;if(!n(i)&&!Number.isInteger(i)||!e(s))return!1;const a=r.length;let o=!0;switch(s.name){case"XYZ":if(a<2||a>3)return!1;break;case"Fit":case"FitB":return a===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(a>1)return!1;break;case"FitR":if(a!==4)return!1;o=!1;break;default:return!1}for(const c of r)if(!(typeof c=="number"||o&&c===null))return!1;return!0}function Ti(n,e,t){return Math.min(Math.max(n,e),t)}typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(n){return n.reduce((e,t)=>e+t,0)});class i0{static textContent(e){const t=[],i={items:t,styles:Object.create(null)};function s(r){var c;if(!r)return;let a=null;const o=r.name;if(o==="#text")a=r.value;else if(i0.shouldBuildText(o))(c=r==null?void 0:r.attributes)!=null&&c.textContent?a=r.attributes.textContent:r.value&&(a=r.value);else return;if(a!==null&&t.push({str:a}),!!r.children)for(const h of r.children)s(h)}return s(e),i}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}class sL{static setupStorage(e,t,i,s,r){const a=s.getValue(t,{value:null});switch(i.name){case"textarea":if(a.value!==null&&(e.textContent=a.value),r==="print")break;e.addEventListener("input",o=>{s.setValue(t,{value:o.target.value})});break;case"input":if(i.attributes.type==="radio"||i.attributes.type==="checkbox"){if(a.value===i.attributes.xfaOn?e.setAttribute("checked",!0):a.value===i.attributes.xfaOff&&e.removeAttribute("checked"),r==="print")break;e.addEventListener("change",o=>{s.setValue(t,{value:o.target.checked?o.target.getAttribute("xfaOn"):o.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&e.setAttribute("value",a.value),r==="print")break;e.addEventListener("input",o=>{s.setValue(t,{value:o.target.value})})}break;case"select":if(a.value!==null){e.setAttribute("value",a.value);for(const o of i.children)o.attributes.value===a.value?o.attributes.selected=!0:o.attributes.hasOwnProperty("selected")&&delete o.attributes.selected}e.addEventListener("input",o=>{const c=o.target.options,h=c.selectedIndex===-1?"":c[c.selectedIndex].value;s.setValue(t,{value:h})});break}}static setAttributes({html:e,element:t,storage:i=null,intent:s,linkService:r}){const{attributes:a}=t,o=e instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${s}`);for(const[c,h]of Object.entries(a))if(h!=null)switch(c){case"class":h.length&&e.setAttribute(c,h.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",h);break;case"style":Object.assign(e.style,h);break;case"textContent":e.textContent=h;break;default:(!o||c!=="href"&&c!=="newWindow")&&e.setAttribute(c,h)}o&&r.addLinkAttributes(e,a.href,a.newWindow),i&&a.dataId&&this.setupStorage(e,a.dataId,t,i)}static render(e){var f,p;const t=e.annotationStorage,i=e.linkService,s=e.xfaHtml,r=e.intent||"display",a=document.createElement(s.name);s.attributes&&this.setAttributes({html:a,element:s,intent:r,linkService:i});const o=r!=="richText",c=e.div;if(c.append(a),e.viewport){const g=`matrix(${e.viewport.transform.join(",")})`;c.style.transform=g}o&&c.setAttribute("class","xfaLayer xfaFont");const h=[];if(s.children.length===0){if(s.value){const g=document.createTextNode(s.value);a.append(g),o&&i0.shouldBuildText(s.name)&&h.push(g)}return{textDivs:h}}const d=[[s,-1,a]];for(;d.length>0;){const[g,v,b]=d.at(-1);if(v+1===g.children.length){d.pop();continue}const x=g.children[++d.at(-1)[1]];if(x===null)continue;const{name:m}=x;if(m==="#text"){const w=document.createTextNode(x.value);h.push(w),b.append(w);continue}const y=(f=x==null?void 0:x.attributes)!=null&&f.xmlns?document.createElementNS(x.attributes.xmlns,m):document.createElement(m);if(b.append(y),x.attributes&&this.setAttributes({html:y,element:x,storage:t,intent:r,linkService:i}),((p=x.children)==null?void 0:p.length)>0)d.push([x,-1,y]);else if(x.value){const w=document.createTextNode(x.value);o&&i0.shouldBuildText(m)&&h.push(w),y.append(w)}}for(const g of c.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))g.setAttribute("readOnly",!0);return{textDivs:h}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const xo="http://www.w3.org/2000/svg",Au=class Au{};we(Au,"CSS",96),we(Au,"PDF",72),we(Au,"PDF_TO_CSS_UNITS",Au.CSS/Au.PDF);let ou=Au;async function wy(n,e="text"){if(Yg(n,document.baseURI)){const t=await fetch(n);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,i)=>{const s=new XMLHttpRequest;s.open("GET",n,!0),s.responseType=e,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){if(s.status===200||s.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(s.response);return}t(s.responseText);return}i(new Error(s.statusText))}},s.send(null)})}class Sy{constructor({viewBox:e,userUnit:t,scale:i,rotation:s,offsetX:r=0,offsetY:a=0,dontFlip:o=!1}){this.viewBox=e,this.userUnit=t,this.scale=i,this.rotation=s,this.offsetX=r,this.offsetY=a,i*=t;const c=(e[2]+e[0])/2,h=(e[3]+e[1])/2;let d,f,p,g;switch(s%=360,s<0&&(s+=360),s){case 180:d=-1,f=0,p=0,g=1;break;case 90:d=0,f=1,p=1,g=0;break;case 270:d=0,f=-1,p=-1,g=0;break;case 0:d=1,f=0,p=0,g=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}o&&(p=-p,g=-g);let v,b,x,m;d===0?(v=Math.abs(h-e[1])*i+r,b=Math.abs(c-e[0])*i+a,x=(e[3]-e[1])*i,m=(e[2]-e[0])*i):(v=Math.abs(c-e[0])*i+r,b=Math.abs(h-e[1])*i+a,x=(e[2]-e[0])*i,m=(e[3]-e[1])*i),this.transform=[d*i,f*i,p*i,g*i,v-d*i*c-p*i*h,b-f*i*c-g*i*h],this.width=x,this.height=m}get rawDims(){const e=this.viewBox;return ht(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:i=this.offsetX,offsetY:s=this.offsetY,dontFlip:r=!1}={}){return new Sy({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:i,offsetY:s,dontFlip:r})}convertToViewportPoint(e,t){const i=[e,t];return $e.applyTransform(i,this.transform),i}convertToViewportRectangle(e){const t=[e[0],e[1]];$e.applyTransform(t,this.transform);const i=[e[2],e[3]];return $e.applyTransform(i,this.transform),[t[0],t[1],i[0],i[1]]}convertToPdfPoint(e,t){const i=[e,t];return $e.applyInverseTransform(i,this.transform),i}}class vw extends ld{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function bw(n){const e=n.length;let t=0;for(;t<e&&n[t].trim()==="";)t++;return n.substring(t,t+5).toLowerCase()==="data:"}function wN(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function YV(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function XV(n,e="document.pdf"){if(typeof n!="string")return e;if(bw(n))return ut('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const i=(o=>{try{return new URL(o)}catch{try{return new URL(decodeURIComponent(o))}catch{try{return new URL(o,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(o),"https://foo.bar")}catch{return null}}}}})(n);if(!i)return e;const s=o=>{try{let c=decodeURIComponent(o);return c.includes("/")?(c=c.split("/").at(-1),c.test(/^\.pdf$/i)?c:o):c}catch{return o}},r=/\.pdf$/i,a=i.pathname.split("/").at(-1);if(r.test(a))return s(a);if(i.searchParams.size>0){const o=Array.from(i.searchParams.values()).reverse();for(const h of o)if(r.test(h))return s(h);const c=Array.from(i.searchParams.keys()).reverse();for(const h of c)if(r.test(h))return s(h)}if(i.hash){const c=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(i.hash);if(c)return s(c[0])}return e}class KT{constructor(){we(this,"started",Object.create(null));we(this,"times",[])}time(e){e in this.started&&ut(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||ut(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:i}of this.times)t=Math.max(i.length,t);for(const{name:i,start:s,end:r}of this.times)e.push(`${i.padEnd(t)} ${r-s}ms
`);return e.join("")}}function Yg(n,e){const t=e?URL.parse(n,e):URL.parse(n);return(t==null?void 0:t.protocol)==="http:"||(t==null?void 0:t.protocol)==="https:"}function Vr(n){n.preventDefault()}function On(n){n.preventDefault(),n.stopPropagation()}function KV(n){console.log("Deprecated API usage: "+n)}var a0;class t1{static toDateObject(e){if(e instanceof Date)return e;if(!e||typeof e!="string")return null;u(this,a0)||k(this,a0,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=u(this,a0).exec(e);if(!t)return null;const i=parseInt(t[1],10);let s=parseInt(t[2],10);s=s>=1&&s<=12?s-1:0;let r=parseInt(t[3],10);r=r>=1&&r<=31?r:1;let a=parseInt(t[4],10);a=a>=0&&a<=23?a:0;let o=parseInt(t[5],10);o=o>=0&&o<=59?o:0;let c=parseInt(t[6],10);c=c>=0&&c<=59?c:0;const h=t[7]||"Z";let d=parseInt(t[8],10);d=d>=0&&d<=23?d:0;let f=parseInt(t[9],10)||0;return f=f>=0&&f<=59?f:0,h==="-"?(a+=d,o+=f):h==="+"&&(a-=d,o-=f),new Date(Date.UTC(i,s,r,a,o,c))}}a0=new WeakMap,D(t1,a0);function ZV(n,{scale:e=1,rotation:t=0}){const{width:i,height:s}=n.attributes.style,r=[0,0,parseInt(i),parseInt(s)];return new Sy({viewBox:r,userUnit:1,scale:e,rotation:t})}function Ay(n){if(n.startsWith("#")){const e=parseInt(n.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(e=>parseInt(e)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(ut(`Not a valid color format: "${n}"`),[0,0,0])}function QV(n){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of n.keys()){e.style.color=t;const i=window.getComputedStyle(e).color;n.set(t,Ay(i))}e.remove()}function Nn(n){const{a:e,b:t,c:i,d:s,e:r,f:a}=n.getTransform();return[e,t,i,s,r,a]}function Ca(n){const{a:e,b:t,c:i,d:s,e:r,f:a}=n.getTransform().invertSelf();return[e,t,i,s,r,a]}function Zh(n,e,t=!1,i=!0){if(e instanceof Sy){const{pageWidth:s,pageHeight:r}=e.rawDims,{style:a}=n,o=li.isCSSRoundSupported,c=`var(--total-scale-factor) * ${s}px`,h=`var(--total-scale-factor) * ${r}px`,d=o?`round(down, ${c}, var(--scale-round-x))`:`calc(${c})`,f=o?`round(down, ${h}, var(--scale-round-y))`:`calc(${h})`;!t||e.rotation%180===0?(a.width=d,a.height=f):(a.width=f,a.height=d)}i&&n.setAttribute("data-main-rotation",e.rotation)}class ro{constructor(){const{pixelRatio:e}=ro;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,i,s,r=-1){let a=1/0,o=1/0,c=1/0;i=ro.capPixels(i,r),i>0&&(a=Math.sqrt(i/(e*t))),s!==-1&&(o=s/e,c=s/t);const h=Math.min(a,o,c);return this.sx>h||this.sy>h?(this.sx=h,this.sy=h,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const i=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,i):i}return e}}const gA=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class JV{static get isDarkMode(){var e;return ht(this,"isDarkMode",!!((e=window==null?void 0:window.matchMedia)!=null&&e.call(window,"(prefers-color-scheme: dark)").matches))}}class eG{static get commentForegroundColor(){const e=document.createElement("span");e.classList.add("comment","sidebar");const{style:t}=e;t.width=t.height="0",t.display="none",t.color="var(--comment-fg-color)",document.body.append(e);const{color:i}=window.getComputedStyle(e);return e.remove(),ht(this,"commentForegroundColor",Ay(i))}}function tG(n,e,t,i){i=Math.min(Math.max(i??1,0),1);const s=255*(1-i);return n=Math.round(n*i+s),e=Math.round(e*i+s),t=Math.round(t*i+s),[n,e,t]}function ZT(n,e){const t=n[0]/255,i=n[1]/255,s=n[2]/255,r=Math.max(t,i,s),a=Math.min(t,i,s),o=(r+a)/2;if(r===a)e[0]=e[1]=0;else{const c=r-a;switch(e[1]=o<.5?c/(r+a):c/(2-r-a),r){case t:e[0]=((i-s)/c+(i<s?6:0))*60;break;case i:e[0]=((s-t)/c+2)*60;break;case s:e[0]=((t-i)/c+4)*60;break}}e[2]=o}function mA(n,e){const t=n[0],i=n[1],s=n[2],r=(1-Math.abs(2*s-1))*i,a=r*(1-Math.abs(t/60%2-1)),o=s-r/2;switch(Math.floor(t/60)){case 0:e[0]=r+o,e[1]=a+o,e[2]=o;break;case 1:e[0]=a+o,e[1]=r+o,e[2]=o;break;case 2:e[0]=o,e[1]=r+o,e[2]=a+o;break;case 3:e[0]=o,e[1]=a+o,e[2]=r+o;break;case 4:e[0]=a+o,e[1]=o,e[2]=r+o;break;case 5:case 6:e[0]=r+o,e[1]=o,e[2]=a+o;break}}function QT(n){return n<=.03928?n/12.92:((n+.055)/1.055)**2.4}function JT(n,e,t){mA(n,t),t.map(QT);const i=.2126*t[0]+.7152*t[1]+.0722*t[2];mA(e,t),t.map(QT);const s=.2126*t[0]+.7152*t[1]+.0722*t[2];return i>s?(i+.05)/(s+.05):(s+.05)/(i+.05)}const eD=new Map;function nG(n,e){const t=n[0]+n[1]*256+n[2]*65536+e[0]*16777216+e[1]*4294967296+e[2]*1099511627776;let i=eD.get(t);if(i)return i;const s=new Float32Array(9),r=s.subarray(0,3),a=s.subarray(3,6);ZT(n,a);const o=s.subarray(6,9);ZT(e,o);const c=o[2]<.5,h=c?12:4.5;if(a[2]=c?Math.sqrt(a[2]):1-Math.sqrt(1-a[2]),JT(a,o,r)<h){let d,f;c?(d=a[2],f=1):(d=0,f=a[2]);const p=.005;for(;f-d>p;){const g=a[2]=(d+f)/2;c===JT(a,o,r)<h?d=g:f=g}a[2]=c?f:d}return mA(a,r),i=$e.makeHexColor(Math.round(r[0]*255),Math.round(r[1]*255),Math.round(r[2]*255)),eD.set(t,i),i}function rL({html:n,dir:e,className:t},i){const s=document.createDocumentFragment();if(typeof n=="string"){const r=document.createElement("p");r.dir=e||"auto";const a=n.split(/(?:\r\n?|\n)/);for(let o=0,c=a.length;o<c;++o){const h=a[o];r.append(document.createTextNode(h)),o<c-1&&r.append(document.createElement("br"))}s.append(r)}else sL.render({xfaHtml:n,div:s,intent:"richText"});s.firstElementChild.classList.add("richText",t),i.append(s)}function aL(n){const e=new Path2D;if(!n)return e;for(let t=0,i=n.length;t<i;)switch(n[t++]){case Bg.moveTo:e.moveTo(n[t++],n[t++]);break;case Bg.lineTo:e.lineTo(n[t++],n[t++]);break;case Bg.curveTo:e.bezierCurveTo(n[t++],n[t++],n[t++],n[t++],n[t++],n[t++]);break;case Bg.quadraticCurveTo:e.quadraticCurveTo(n[t++],n[t++],n[t++],n[t++]);break;case Bg.closePath:e.closePath();break;default:ut(`Unrecognized drawing path operator: ${n[t-1]}`);break}return e}var Ao,Jr,xf,$l,Nu,lg,oL,lL;const Lt=class Lt{constructor(){D(this,lg)}get pagesNumber(){return u(Lt,$l)}set pagesNumber(e){u(Lt,$l)!==e&&(k(Lt,$l,e),e===0&&(k(Lt,Jr,null),k(Lt,Ao,null)))}addListener(e){u(Lt,Nu).push(e)}removeListener(e){const t=u(Lt,Nu).indexOf(e);t>=0&&u(Lt,Nu).splice(t,1)}movePages(e,t,i){R(this,lg,lL).call(this,!0);const s=u(Lt,Jr),r=u(Lt,Ao);u(Lt,xf).set(r);const a=t.length,o=new Uint32Array(a);let c=0;for(let g=0;g<a;g++){const v=t[g]-1;o[g]=s[v],v<i&&(c+=1)}const h=u(Lt,$l);let d=i-c;const f=h-a;d=Ti(d,0,f);for(let g=0,v=0;g<h;g++)e.has(g+1)||(s[v++]=s[g]);s.copyWithin(d+a,d,f),s.set(o,d);let p=!1;for(let g=0,v=h;g<v;g++){const b=s[g];p||(p=b!==g+1),r[b-1]=g+1}R(this,lg,oL).call(this),p||(this.pagesNumber=0)}hasBeenAltered(){return u(Lt,Jr)!==null}getPageMappingForSaving(){return{pageIndices:u(Lt,Ao)?u(Lt,Ao).map(e=>e-1):null}}getPrevPageNumber(e){return u(Lt,xf)[u(Lt,Jr)[e-1]-1]}getPageNumber(e){var t;return((t=u(Lt,Ao))==null?void 0:t[e-1])??e}getPageId(e){var t;return((t=u(Lt,Jr))==null?void 0:t[e-1])??e}static get instance(){return ht(this,"instance",new Lt)}getMapping(){return u(Lt,Jr).subarray(0,this.pagesNumber)}};Ao=new WeakMap,Jr=new WeakMap,xf=new WeakMap,$l=new WeakMap,Nu=new WeakMap,lg=new WeakSet,oL=function(){for(const e of u(Lt,Nu))e()},lL=function(e){if(u(Lt,Jr))return;const t=u(Lt,$l),i=new Uint32Array(3*t),s=k(Lt,Jr,i.subarray(0,t)),r=k(Lt,Ao,i.subarray(t,2*t));if(e)for(let a=0;a<t;a++)s[a]=r[a]=a+1;k(Lt,xf,i.subarray(2*t))},D(Lt,Ao,null),D(Lt,Jr,null),D(Lt,xf,null),D(Lt,$l,0),D(Lt,Nu,[]);let s0=Lt;var ql,Vl,xr,yr,o0,Gl,yf,vf,l0,f1,cL,Mi,uL,hL,Od,Xg;const bo=class bo{constructor(e){D(this,Mi);D(this,ql,null);D(this,Vl,null);D(this,xr);D(this,yr,null);D(this,o0,null);D(this,Gl,null);D(this,yf,null);D(this,vf,null);k(this,xr,e),u(bo,l0)||k(bo,l0,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const e=k(this,ql,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=u(this,xr)._uiManager._signal;t instanceof AbortSignal&&!t.aborted&&(e.addEventListener("contextmenu",Vr,{signal:t}),e.addEventListener("pointerdown",R(bo,f1,cL),{signal:t}));const i=k(this,yr,document.createElement("div"));i.className="buttons",e.append(i);const s=u(this,xr).toolbarPosition;if(s){const{style:r}=e,a=u(this,xr)._uiManager.direction==="ltr"?1-s[0]:s[0];r.insetInlineEnd=`${100*a}%`,r.top=`calc(${100*s[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return u(this,ql)}hide(){var e;u(this,ql).classList.add("hidden"),(e=u(this,Vl))==null||e.hideDropdown()}show(){var e,t;u(this,ql).classList.remove("hidden"),(e=u(this,o0))==null||e.shown(),(t=u(this,Gl))==null||t.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=u(this,xr),i=document.createElement("button");i.classList.add("basic","deleteButton"),i.tabIndex=0,i.setAttribute("data-l10n-id",u(bo,l0)[e]),R(this,Mi,Od).call(this,i)&&i.addEventListener("click",s=>{t.delete()},{signal:t._signal}),u(this,yr).append(i)}async addAltText(e){const t=await e.render();R(this,Mi,Od).call(this,t),u(this,yr).append(t,u(this,Mi,Xg)),k(this,o0,e)}addComment(e,t=null){if(u(this,Gl))return;const i=e.renderForToolbar();if(!i)return;R(this,Mi,Od).call(this,i);const s=k(this,yf,u(this,Mi,Xg));t?(u(this,yr).insertBefore(i,t),u(this,yr).insertBefore(s,t)):u(this,yr).append(i,s),k(this,Gl,e),e.toolbar=this}addColorPicker(e){if(u(this,Vl))return;k(this,Vl,e);const t=e.renderButton();R(this,Mi,Od).call(this,t),u(this,yr).append(t,u(this,Mi,Xg))}async addEditSignatureButton(e){const t=k(this,vf,await e.renderEditButton(u(this,xr)));R(this,Mi,Od).call(this,t),u(this,yr).append(t,u(this,Mi,Xg))}removeButton(e){var t,i;switch(e){case"comment":(t=u(this,Gl))==null||t.removeToolbarCommentButton(),k(this,Gl,null),(i=u(this,yf))==null||i.remove(),k(this,yf,null);break}}async addButton(e,t){switch(e){case"colorPicker":t&&this.addColorPicker(t);break;case"altText":t&&await this.addAltText(t);break;case"editSignature":t&&await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break;case"comment":t&&this.addComment(t);break}}async addButtonBefore(e,t,i){if(!t&&e==="comment")return;const s=u(this,yr).querySelector(i);s&&e==="comment"&&this.addComment(t,s)}updateEditSignatureButton(e){u(this,vf)&&(u(this,vf).title=e)}remove(){var e;u(this,ql).remove(),(e=u(this,Vl))==null||e.destroy(),k(this,Vl,null)}};ql=new WeakMap,Vl=new WeakMap,xr=new WeakMap,yr=new WeakMap,o0=new WeakMap,Gl=new WeakMap,yf=new WeakMap,vf=new WeakMap,l0=new WeakMap,f1=new WeakSet,cL=function(e){e.stopPropagation()},Mi=new WeakSet,uL=function(e){u(this,xr)._focusEventsAllowed=!1,On(e)},hL=function(e){u(this,xr)._focusEventsAllowed=!0,On(e)},Od=function(e){const t=u(this,xr)._uiManager._signal;return!(t instanceof AbortSignal)||t.aborted?!1:(e.addEventListener("focusin",R(this,Mi,uL).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",R(this,Mi,hL).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",Vr,{signal:t}),!0)},Xg=function(){const e=document.createElement("div");return e.className="divider",e},D(bo,f1),D(bo,l0,null);let xA=bo;var c0,_u,Eo,Tl,dL,fL,yA;class iG{constructor(e){D(this,Tl);D(this,c0,null);D(this,_u,null);D(this,Eo);k(this,Eo,e)}show(e,t,i){const[s,r]=R(this,Tl,fL).call(this,t,i),{style:a}=u(this,_u)||k(this,_u,R(this,Tl,dL).call(this));e.append(u(this,_u)),a.insetInlineEnd=`${100*s}%`,a.top=`calc(${100*r}% + var(--editor-toolbar-vert-offset))`}hide(){u(this,_u).remove()}}c0=new WeakMap,_u=new WeakMap,Eo=new WeakMap,Tl=new WeakSet,dL=function(){const e=k(this,_u,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar");const t=u(this,Eo)._signal;t instanceof AbortSignal&&!t.aborted&&e.addEventListener("contextmenu",Vr,{signal:t});const i=k(this,c0,document.createElement("div"));return i.className="buttons",e.append(i),u(this,Eo).hasCommentManager()&&R(this,Tl,yA).call(this,"commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{u(this,Eo).commentSelection("floating_button")}),R(this,Tl,yA).call(this,"highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{u(this,Eo).highlightSelection("floating_button")}),e},fL=function(e,t){let i=0,s=0;for(const r of e){const a=r.y+r.height;if(a<i)continue;const o=r.x+(t?r.width:0);if(a>i){s=o,i=a;continue}t?o>s&&(s=o):o<s&&(s=o)}return[t?1-s:s,i]},yA=function(e,t,i,s){const r=document.createElement("button");r.classList.add("basic",e),r.tabIndex=0,r.setAttribute("data-l10n-id",t);const a=document.createElement("span");r.append(a),a.className="visuallyHidden",a.setAttribute("data-l10n-id",i);const o=u(this,Eo)._signal;o instanceof AbortSignal&&!o.aborted&&(r.addEventListener("contextmenu",Vr,{signal:o}),r.addEventListener("click",s,{signal:o})),u(this,c0).append(r)};function pL(n,e,t){for(const i of t)e.addEventListener(i,n[i].bind(n))}var ku,Tu,bf,Du;const Zt=class Zt{static initializeAndAddPointerId(e){(u(Zt,Tu)||k(Zt,Tu,new Set)).add(e)}static setPointer(e,t){u(Zt,ku)||k(Zt,ku,t),u(Zt,Du)??k(Zt,Du,e)}static setTimeStamp(e){k(Zt,bf,e)}static isSamePointerId(e){return u(Zt,ku)===e}static isSamePointerIdOrRemove(e){var t;return u(Zt,ku)===e?!0:((t=u(Zt,Tu))==null||t.delete(e),!1)}static isSamePointerType(e){return u(Zt,Du)===e}static isInitializedAndDifferentPointerType(e){return u(Zt,Du)!==null&&!Zt.isSamePointerType(e)}static isSameTimeStamp(e){return u(Zt,bf)===e}static isUsingMultiplePointers(){var e;return((e=u(Zt,Tu))==null?void 0:e.size)>=1}static clearPointerType(){k(Zt,Du,null)}static clearPointerIds(){k(Zt,ku,NaN),k(Zt,Tu,null)}static clearTimeStamp(){k(Zt,bf,NaN)}};ku=new WeakMap,Tu=new WeakMap,bf=new WeakMap,Du=new WeakMap,D(Zt,ku,NaN),D(Zt,Tu,null),D(Zt,bf,NaN),D(Zt,Du,null);let Ui=Zt;var p1;class sG{constructor(){D(this,p1,0)}get id(){return`${t0}${ni(this,p1)._++}`}}p1=new WeakMap;var wf,u0,Hi,Sf,_v;const jN=class jN{constructor(){D(this,Sf);D(this,wf,iL());D(this,u0,0);D(this,Hi,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',i=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),s=new Image;s.src=e;const r=s.decode().then(()=>(i.drawImage(s,0,0,1,1,0,0,1,3),new Uint32Array(i.getImageData(0,0,1,1).data.buffer)[0]===0));return ht(this,"_isSVGFittingCanvas",r)}async getFromFile(e){const{lastModified:t,name:i,size:s,type:r}=e;return R(this,Sf,_v).call(this,`${t}_${i}_${s}_${r}`,e)}async getFromUrl(e){return R(this,Sf,_v).call(this,e,e)}async getFromBlob(e,t){const i=await t;return R(this,Sf,_v).call(this,e,i)}async getFromId(e){u(this,Hi)||k(this,Hi,new Map);const t=u(this,Hi).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:i}=t;return delete t.blobPromise,this.getFromBlob(t.id,i)}return this.getFromUrl(t.url)}getFromCanvas(e,t){u(this,Hi)||k(this,Hi,new Map);let i=u(this,Hi).get(e);if(i!=null&&i.bitmap)return i.refCounter+=1,i;const s=new OffscreenCanvas(t.width,t.height);return s.getContext("2d").drawImage(t,0,0),i={bitmap:s.transferToImageBitmap(),id:`image_${u(this,wf)}_${ni(this,u0)._++}`,refCounter:1,isSvg:!1},u(this,Hi).set(e,i),u(this,Hi).set(i.id,i),i}getSvgUrl(e){const t=u(this,Hi).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var s;u(this,Hi)||k(this,Hi,new Map);const t=u(this,Hi).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:i}=t;if(!t.url&&!t.file){const r=new OffscreenCanvas(i.width,i.height);r.getContext("bitmaprenderer").transferFromImageBitmap(i),t.blobPromise=r.convertToBlob()}(s=i.close)==null||s.call(i),t.bitmap=null}isValidId(e){return e.startsWith(`image_${u(this,wf)}_`)}};wf=new WeakMap,u0=new WeakMap,Hi=new WeakMap,Sf=new WeakSet,_v=async function(e,t){u(this,Hi)||k(this,Hi,new Map);let i=u(this,Hi).get(e);if(i===null)return null;if(i!=null&&i.bitmap)return i.refCounter+=1,i;try{i||(i={bitmap:null,id:`image_${u(this,wf)}_${ni(this,u0)._++}`,refCounter:0,isSvg:!1});let s;if(typeof t=="string"?(i.url=t,s=await wy(t,"blob")):t instanceof File?s=i.file=t:t instanceof Blob&&(s=t),s.type==="image/svg+xml"){const r=jN._isSVGFittingCanvas,a=new FileReader,o=new Image,c=new Promise((h,d)=>{o.onload=()=>{i.bitmap=o,i.isSvg=!0,h()},a.onload=async()=>{const f=i.svgUrl=a.result;o.src=await r?`${f}#svgView(preserveAspectRatio(none))`:f},o.onerror=a.onerror=d});a.readAsDataURL(s),await c}else i.bitmap=await createImageBitmap(s);i.refCounter=1}catch(s){ut(s),i=null}return u(this,Hi).set(e,i),i&&u(this,Hi).set(i.id,i),i};let vA=jN;var zn,Wl,h0,En;class rG{constructor(e=128){D(this,zn,[]);D(this,Wl,!1);D(this,h0);D(this,En,-1);k(this,h0,e)}add({cmd:e,undo:t,post:i,mustExec:s,type:r=NaN,overwriteIfSameType:a=!1,keepUndo:o=!1}){if(s&&e(),u(this,Wl))return;const c={cmd:e,undo:t,post:i,type:r};if(u(this,En)===-1){u(this,zn).length>0&&(u(this,zn).length=0),k(this,En,0),u(this,zn).push(c);return}if(a&&u(this,zn)[u(this,En)].type===r){o&&(c.undo=u(this,zn)[u(this,En)].undo),u(this,zn)[u(this,En)]=c;return}const h=u(this,En)+1;h===u(this,h0)?u(this,zn).splice(0,1):(k(this,En,h),h<u(this,zn).length&&u(this,zn).splice(h)),u(this,zn).push(c)}undo(){if(u(this,En)===-1)return;k(this,Wl,!0);const{undo:e,post:t}=u(this,zn)[u(this,En)];e(),t==null||t(),k(this,Wl,!1),k(this,En,u(this,En)-1)}redo(){if(u(this,En)<u(this,zn).length-1){k(this,En,u(this,En)+1),k(this,Wl,!0);const{cmd:e,post:t}=u(this,zn)[u(this,En)];e(),t==null||t(),k(this,Wl,!1)}}hasSomethingToUndo(){return u(this,En)!==-1}hasSomethingToRedo(){return u(this,En)<u(this,zn).length-1}cleanType(e){if(u(this,En)!==-1){for(let t=u(this,En);t>=0;t--)if(u(this,zn)[t].type!==e){u(this,zn).splice(t+1,u(this,En)-t),k(this,En,t);return}u(this,zn).length=0,k(this,En,-1)}}destroy(){k(this,zn,null)}}zn=new WeakMap,Wl=new WeakMap,h0=new WeakMap,En=new WeakMap;var g1,gL;class Ey{constructor(e){D(this,g1);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=li.platform;for(const[i,s,r={}]of e)for(const a of i){const o=a.startsWith("mac+");t&&o?(this.callbacks.set(a.slice(4),{callback:s,options:r}),this.allKeys.add(a.split("+").at(-1))):!t&&!o&&(this.callbacks.set(a,{callback:s,options:r}),this.allKeys.add(a.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const i=this.callbacks.get(R(this,g1,gL).call(this,t));if(!i)return;const{callback:s,options:{bubbles:r=!1,args:a=[],checker:o=null}}=i;o&&!o(e,t)||(s.bind(e,...a,t)(),r||On(t))}}g1=new WeakSet,gL=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const m1=class m1{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return QV(e),ht(this,"_colors",e)}convert(e){const t=Ay(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[i,s]of this._colors)if(s.every((r,a)=>r===t[a]))return m1._colorsMapping.get(i);return t}getHexCode(e){const t=this._colors.get(e);return t?$e.makeHexColor(...t):e}};we(m1,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let bA=m1;var Af,Rs,Ef,Cn,Fn,Cf,vr,Nf,br,$i,Yl,Xl,_f,Kl,ka,wr,ju,d0,f0,kf,p0,Ta,Zl,Tf,Ql,Da,x1,Jl,Df,g0,ec,Ru,jf,tc,m0,Xn,qt,Co,nc,ic,x0,Rf,y0,sc,ja,No,v0,b0,Sr,Be,kv,wA,mL,xL,Kg,yL,vL,bL,SA,wL,SL,AL,EL,Ki,yo,CL,NL,AA,_L,Zg,EA;const sf=class sf{constructor(e,t,i,s,r,a,o,c,h,d,f,p,g,v,b,x){D(this,Be);D(this,Af,new AbortController);D(this,Rs,null);D(this,Ef,null);D(this,Cn,new Map);D(this,Fn,new Map);D(this,Cf,null);D(this,vr,null);D(this,Nf,null);D(this,br,new rG);D(this,$i,null);D(this,Yl,null);D(this,Xl,null);D(this,_f,0);D(this,Kl,new Set);D(this,ka,null);D(this,wr,null);D(this,ju,new Set);we(this,"_editorUndoBar",null);D(this,d0,!1);D(this,f0,!1);D(this,kf,!1);D(this,p0,null);D(this,Ta,null);D(this,Zl,null);D(this,Tf,null);D(this,Ql,!1);D(this,Da,null);D(this,x1,new sG);D(this,Jl,!1);D(this,Df,!1);D(this,g0,!1);D(this,ec,null);D(this,Ru,null);D(this,jf,null);D(this,tc,null);D(this,m0,null);D(this,Xn,gt.NONE);D(this,qt,new Set);D(this,Co,null);D(this,nc,null);D(this,ic,null);D(this,x0,null);D(this,Rf,null);D(this,y0,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});D(this,sc,[0,0]);D(this,ja,null);D(this,No,null);D(this,v0,null);D(this,b0,null);D(this,Sr,null);const m=this._signal=u(this,Af).signal;k(this,No,e),k(this,v0,t),k(this,b0,i),k(this,Cf,s),k(this,$i,r),k(this,nc,a),k(this,Rf,c),this._eventBus=o,o._on("editingaction",this.onEditingAction.bind(this),{signal:m}),o._on("pagechanging",this.onPageChanging.bind(this),{signal:m}),o._on("scalechanging",this.onScaleChanging.bind(this),{signal:m}),o._on("rotationchanging",this.onRotationChanging.bind(this),{signal:m}),o._on("setpreference",this.onSetPreference.bind(this),{signal:m}),o._on("switchannotationeditorparams",y=>this.updateParams(y.type,y.value),{signal:m}),o._on("pagesedited",this.onPagesEdited.bind(this),{signal:m}),window.addEventListener("pointerdown",()=>{k(this,Df,!0)},{capture:!0,signal:m}),window.addEventListener("pointerup",()=>{k(this,Df,!1)},{capture:!0,signal:m}),R(this,Be,yL).call(this),R(this,Be,EL).call(this),R(this,Be,SA).call(this),k(this,vr,c.annotationStorage),k(this,p0,c.filterFactory),k(this,ic,h),k(this,Tf,d||null),k(this,d0,f),k(this,f0,p),k(this,kf,g),k(this,m0,v||null),this.viewParameters={realScale:ou.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=b||null,this._supportsPinchToZoom=x!==!1,r==null||r.setSidebarUiManager(this)}static get _keyboardManager(){const e=sf.prototype,t=a=>u(a,No).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),i=(a,{target:o})=>{if(o instanceof HTMLInputElement){const{type:c}=o;return c!=="text"&&c!=="number"}return!0},s=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return ht(this,"_keyboardManager",new Ey([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],e.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:i}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&u(a,No).contains(o)&&!a.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&u(a,No).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-s,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[s,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-s],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,s],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:t}]]))}destroy(){var e,t,i,s,r,a,o,c,h;(e=u(this,Sr))==null||e.resolve(),k(this,Sr,null),(t=u(this,Af))==null||t.abort(),k(this,Af,null),this._signal=null;for(const d of u(this,Fn).values())d.destroy();u(this,Fn).clear(),u(this,Cn).clear(),u(this,ju).clear(),(i=u(this,tc))==null||i.clear(),k(this,Rs,null),u(this,qt).clear(),u(this,br).destroy(),(s=u(this,Cf))==null||s.destroy(),(r=u(this,$i))==null||r.destroy(),(a=u(this,nc))==null||a.destroy(),(o=u(this,Da))==null||o.hide(),k(this,Da,null),(c=u(this,jf))==null||c.destroy(),k(this,jf,null),k(this,Ef,null),u(this,Ta)&&(clearTimeout(u(this,Ta)),k(this,Ta,null)),u(this,ja)&&(clearTimeout(u(this,ja)),k(this,ja,null)),(h=this._editorUndoBar)==null||h.destroy(),k(this,Rf,null)}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return u(this,m0)}get useNewAltTextFlow(){return u(this,f0)}get useNewAltTextWhenAddingImage(){return u(this,kf)}get hcmFilter(){return ht(this,"hcmFilter",u(this,ic)?u(this,p0).addHCMFilter(u(this,ic).foreground,u(this,ic).background):"none")}get direction(){return ht(this,"direction",getComputedStyle(u(this,No)).direction)}get _highlightColors(){return ht(this,"_highlightColors",u(this,Tf)?new Map(u(this,Tf).split(",").map(e=>(e=e.split("=").map(t=>t.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColors(){const{_highlightColors:e}=this;if(!e)return ht(this,"highlightColors",null);const t=new Map,i=!!u(this,ic);for(const[s,r]of e){const a=s.endsWith("_HCM");if(i&&a){t.set(s.replace("_HCM",""),r);continue}!i&&!a&&t.set(s,r)}return ht(this,"highlightColors",t)}get highlightColorNames(){return ht(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}getNonHCMColor(e){if(!this._highlightColors)return e;const t=this.highlightColorNames.get(e);return this._highlightColors.get(t)||e}getNonHCMColorName(e){return this.highlightColorNames.get(e)||e}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),k(this,Xl,e)}setMainHighlightColorPicker(e){k(this,jf,e)}editAltText(e,t=!1){var i;(i=u(this,Cf))==null||i.editAltText(this,e,t)}hasCommentManager(){return!!u(this,$i)}editComment(e,t,i,s){var r;(r=u(this,$i))==null||r.showDialog(this,e,t,i,s)}selectComment(e,t){const i=u(this,Fn).get(e),s=i==null?void 0:i.getEditorByUID(t);s==null||s.toggleComment(!0,!0)}updateComment(e){var t;(t=u(this,$i))==null||t.updateComment(e.getData())}updatePopupColor(e){var t;(t=u(this,$i))==null||t.updatePopupColor(e)}removeComment(e){var t;(t=u(this,$i))==null||t.removeComments([e.uid])}deleteComment(e,t){const i=()=>{e.comment=t},s=()=>{var r;(r=this._editorUndoBar)==null||r.show(i,"comment"),this.toggleComment(null),e.comment=null};this.addCommands({cmd:s,undo:i,mustExec:!0})}toggleComment(e,t,i=void 0){var s;(s=u(this,$i))==null||s.toggleCommentPopup(e,t,i)}makeCommentColor(e,t){var i;return e&&((i=u(this,$i))==null?void 0:i.makeCommentColor(e,t))||null}getCommentDialogElement(){var e;return((e=u(this,$i))==null?void 0:e.dialogElement)||null}async waitForEditorsRendered(e){if(u(this,Fn).has(e-1))return;const{resolve:t,promise:i}=Promise.withResolvers(),s=r=>{r.pageNumber===e&&(this._eventBus._off("editorsrendered",s),t())};this._eventBus.on("editorsrendered",s),await i}getSignature(e){var t;(t=u(this,nc))==null||t.getSignature({uiManager:this,editor:e})}get signatureManager(){return u(this,nc)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":k(this,kf,t);break}}onPagesEdited({pagesMapper:e}){for(const s of u(this,Cn).values())s.updatePageIndex(e.getPrevPageNumber(s.pageIndex+1)-1);const t=u(this,Fn),i=k(this,Fn,new Map);for(const[s,r]of t){const a=e.getPrevPageNumber(s+1)-1;if(a===-1){r.destroy();continue}i.set(a,r),r.updatePageIndex(a)}}onPageChanging({pageNumber:e}){k(this,_f,e-1)}focusMainContainer(){u(this,No).focus()}findParent(e,t){for(const i of u(this,Fn).values()){const{x:s,y:r,width:a,height:o}=i.div.getBoundingClientRect();if(e>=s&&e<=s+a&&t>=r&&t<=r+o)return i}return null}disableUserSelect(e=!1){u(this,v0).classList.toggle("noUserSelect",e)}addShouldRescale(e){u(this,ju).add(e)}removeShouldRescale(e){u(this,ju).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*ou.PDF_TO_CSS_UNITS;for(const i of u(this,ju))i.onScaleChanging();(t=u(this,Xl))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e="",t=!1){const i=document.getSelection();if(!i||i.isCollapsed)return;const{anchorNode:s,anchorOffset:r,focusNode:a,focusOffset:o}=i,c=i.toString(),d=R(this,Be,kv).call(this,i).closest(".textLayer"),f=this.getSelectionBoxes(d);if(!f)return;i.empty();const p=R(this,Be,wA).call(this,d),g=u(this,Xn)===gt.NONE,v=()=>{const b=p==null?void 0:p.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:f,anchorNode:s,anchorOffset:r,focusNode:a,focusOffset:o,text:c});g&&this.showAllEditors("highlight",!0,!0),t&&(b==null||b.editComment())};if(g){this.switchToMode(gt.HIGHLIGHT,v);return}v()}commentSelection(e=""){this.highlightSelection(e,!0)}getAndRemoveDataFromAnnotationStorage(e){if(!u(this,vr))return null;const t=`${t0}${e}`,i=u(this,vr).getRawValue(t);return i&&u(this,vr).remove(t),i}addToAnnotationStorage(e){!e.isEmpty()&&u(this,vr)&&!u(this,vr).has(e.id)&&u(this,vr).setValue(e.id,e)}a11yAlert(e,t=null){const i=u(this,b0);i&&(i.setAttribute("data-l10n-id",e),t?i.setAttribute("data-l10n-args",JSON.stringify(t)):i.removeAttribute("data-l10n-args"))}blur(){if(this.isShiftKeyDown=!1,u(this,Ql)&&(k(this,Ql,!1),R(this,Be,Kg).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of u(this,qt))if(t.div.contains(e)){k(this,Ru,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!u(this,Ru))return;const[e,t]=u(this,Ru);k(this,Ru,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){R(this,Be,SA).call(this),this.setEditingState(!0)}removeEditListeners(){R(this,Be,wL).call(this),this.setEditingState(!1)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const i of u(this,wr))if(i.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const i of u(this,wr))if(i.isHandlingMimeForPasting(t.type)){i.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var i;if(e.preventDefault(),(i=u(this,Rs))==null||i.commitOrRemove(),!this.hasSelection)return;const t=[];for(const s of u(this,qt)){const r=s.serialize(!0);r&&t.push(r)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const r of t.items)for(const a of u(this,wr))if(a.isHandlingMimeForPasting(r.type)){a.paste(r,this.currentLayer);return}let i=t.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(r){ut(`paste: "${r.message}".`);return}if(!Array.isArray(i))return;this.unselectAll();const s=this.currentLayer;try{const r=[];for(const c of i){const h=await s.deserialize(c);if(!h)return;r.push(h)}const a=()=>{for(const c of r)R(this,Be,AA).call(this,c);R(this,Be,EA).call(this,r)},o=()=>{for(const c of r)c.remove()};this.addCommands({cmd:a,undo:o,mustExec:!0})}catch(r){ut(`paste: "${r.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),u(this,Xn)!==gt.NONE&&!this.isEditorHandlingKeyboard&&sf._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,u(this,Ql)&&(k(this,Ql,!1),R(this,Be,Kg).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}setEditingState(e){e?(R(this,Be,vL).call(this),R(this,Be,SL).call(this),R(this,Be,Ki).call(this,{isEditing:u(this,Xn)!==gt.NONE,isEmpty:R(this,Be,Zg).call(this),hasSomethingToUndo:u(this,br).hasSomethingToUndo(),hasSomethingToRedo:u(this,br).hasSomethingToRedo(),hasSelectedEditor:!1})):(R(this,Be,bL).call(this),R(this,Be,AL).call(this),R(this,Be,Ki).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!u(this,wr)){k(this,wr,e);for(const t of u(this,wr))R(this,Be,yo).call(this,t.defaultPropertiesToUpdate)}}getId(){return u(this,x1).id}get currentLayer(){return u(this,Fn).get(u(this,_f))}getLayer(e){return u(this,Fn).get(e)}get currentPageIndex(){return u(this,_f)}addLayer(e){u(this,Fn).set(e.pageIndex,e),u(this,Jl)?e.enable():e.disable()}removeLayer(e){u(this,Fn).delete(e.pageIndex)}async updateMode(e,t=null,i=!1,s=!1,r=!1,a=!1){var o,c,h,d,f,p;if(u(this,Xn)!==e&&!(u(this,Sr)&&(await u(this,Sr).promise,!u(this,Sr)))){if(k(this,Sr,Promise.withResolvers()),(o=u(this,Xl))==null||o.commitOrRemove(),u(this,Xn)===gt.POPUP&&((c=u(this,$i))==null||c.hideSidebar()),(h=u(this,$i))==null||h.destroyPopup(),k(this,Xn,e),e===gt.NONE){this.setEditingState(!1),R(this,Be,NL).call(this);for(const g of u(this,Cn).values())g.hideStandaloneCommentButton();(d=this._editorUndoBar)==null||d.hide(),this.toggleComment(null),u(this,Sr).resolve();return}for(const g of u(this,Cn).values())g.addStandaloneCommentButton();e===gt.SIGNATURE&&await((f=u(this,nc))==null?void 0:f.loadSignatures()),i&&Ui.clearPointerType(),this.setEditingState(!0),await R(this,Be,CL).call(this),this.unselectAll();for(const g of u(this,Fn).values())g.updateMode(e);if(e===gt.POPUP){u(this,Ef)||k(this,Ef,await u(this,Rf).getAnnotationsByType(new Set(u(this,wr).map(b=>b._editorType))));const g=new Set,v=[];for(const b of u(this,Cn).values()){const{annotationElementId:x,hasComment:m,deleted:y}=b;x&&g.add(x),m&&!y&&v.push(b.getData())}for(const b of u(this,Ef)){const{id:x,popupRef:m,contentsObj:y}=b;m&&(y!=null&&y.str)&&!g.has(x)&&!u(this,Kl).has(x)&&v.push(b)}(p=u(this,$i))==null||p.showSidebar(v)}if(!t){s&&this.addNewEditorFromKeyboard(),u(this,Sr).resolve();return}for(const g of u(this,Cn).values())g.uid===t?(this.setSelected(g),a?g.editComment():r?g.enterInEditMode():g.focus()):g.unselect();u(this,Sr).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==u(this,Xn)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){if(u(this,wr)){switch(e){case Tt.CREATE:this.currentLayer.addNewEditor(t);return;case Tt.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(u(this,x0)||k(this,x0,new Map)).set(e,t),this.showAllEditors("highlight",t);break}if(this.hasSelection)for(const i of u(this,qt))i.updateParams(e,t);else for(const i of u(this,wr))i.updateDefaultParams(e,t)}}showAllEditors(e,t,i=!1){var r;for(const a of u(this,Cn).values())a.editorType===e&&a.show(t);(((r=u(this,x0))==null?void 0:r.get(Tt.HIGHLIGHT_SHOW_ALL))??!0)!==t&&R(this,Be,yo).call(this,[[Tt.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(u(this,g0)!==e){k(this,g0,e);for(const t of u(this,Fn).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}*getEditors(e){for(const t of u(this,Cn).values())t.pageIndex===e&&(yield t)}getEditor(e){return u(this,Cn).get(e)}addEditor(e){u(this,Cn).set(e.id,e)}removeEditor(e){var t,i;e.div.contains(document.activeElement)&&(u(this,Ta)&&clearTimeout(u(this,Ta)),k(this,Ta,setTimeout(()=>{this.focusMainContainer(),k(this,Ta,null)},0))),u(this,Cn).delete(e.id),e.annotationElementId&&((t=u(this,tc))==null||t.delete(e.annotationElementId)),this.unselect(e),(!e.annotationElementId||!u(this,Kl).has(e.annotationElementId))&&((i=u(this,vr))==null||i.remove(e.id))}addDeletedAnnotationElement(e){u(this,Kl).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return u(this,Kl).has(e)}removeDeletedAnnotationElement(e){u(this,Kl).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){u(this,Rs)!==e&&(k(this,Rs,e),e&&R(this,Be,yo).call(this,e.propertiesToUpdate))}updateUI(e){u(this,Be,_L)===e&&R(this,Be,yo).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){R(this,Be,yo).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(u(this,qt).has(e)){u(this,qt).delete(e),e.unselect(),R(this,Be,Ki).call(this,{hasSelectedEditor:this.hasSelection});return}u(this,qt).add(e),e.select(),R(this,Be,yo).call(this,e.propertiesToUpdate),R(this,Be,Ki).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;this.updateToolbar({mode:e.mode,editId:e.uid}),(t=u(this,Xl))==null||t.commitOrRemove();for(const i of u(this,qt))i!==e&&i.unselect();u(this,qt).clear(),u(this,qt).add(e),e.select(),R(this,Be,yo).call(this,e.propertiesToUpdate),R(this,Be,Ki).call(this,{hasSelectedEditor:!0})}isSelected(e){return u(this,qt).has(e)}get firstSelectedEditor(){return u(this,qt).values().next().value}unselect(e){e.unselect(),u(this,qt).delete(e),R(this,Be,Ki).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return u(this,qt).size!==0}get isEnterHandled(){return u(this,qt).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;u(this,br).undo(),R(this,Be,Ki).call(this,{hasSomethingToUndo:u(this,br).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:R(this,Be,Zg).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){u(this,br).redo(),R(this,Be,Ki).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:u(this,br).hasSomethingToRedo(),isEmpty:R(this,Be,Zg).call(this)})}addCommands(e){u(this,br).add(e),R(this,Be,Ki).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:R(this,Be,Zg).call(this)})}cleanUndoStack(e){u(this,br).cleanType(e)}delete(){var r;this.commitOrRemove();const e=(r=this.currentLayer)==null?void 0:r.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...u(this,qt)],i=()=>{var a;(a=this._editorUndoBar)==null||a.show(s,t.length===1?t[0].editorType:t.length);for(const o of t)o.remove()},s=()=>{for(const a of t)R(this,Be,AA).call(this,a)};this.addCommands({cmd:i,undo:s,mustExec:!0})}commitOrRemove(){var e;(e=u(this,Rs))==null||e.commitOrRemove()}hasSomethingToControl(){return u(this,Rs)||this.hasSelection}selectAll(){for(const e of u(this,qt))e.commit();R(this,Be,EA).call(this,u(this,Cn).values())}unselectAll(){var e;if(!(u(this,Rs)&&(u(this,Rs).commitOrRemove(),u(this,Xn)!==gt.NONE))&&!((e=u(this,Xl))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of u(this,qt))t.unselect();u(this,qt).clear(),R(this,Be,Ki).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;u(this,sc)[0]+=e,u(this,sc)[1]+=t;const[s,r]=u(this,sc),a=[...u(this,qt)],o=1e3;u(this,ja)&&clearTimeout(u(this,ja)),k(this,ja,setTimeout(()=>{k(this,ja,null),u(this,sc)[0]=u(this,sc)[1]=0,this.addCommands({cmd:()=>{for(const c of a)u(this,Cn).has(c.id)&&(c.translateInPage(s,r),c.translationDone())},undo:()=>{for(const c of a)u(this,Cn).has(c.id)&&(c.translateInPage(-s,-r),c.translationDone())},mustExec:!1})},o));for(const c of a)c.translateInPage(e,t),c.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),k(this,ka,new Map);for(const e of u(this,qt))u(this,ka).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!u(this,ka))return!1;this.disableUserSelect(!1);const e=u(this,ka);k(this,ka,null);let t=!1;for(const[{x:s,y:r,pageIndex:a},o]of e)o.newX=s,o.newY=r,o.newPageIndex=a,t||(t=s!==o.savedX||r!==o.savedY||a!==o.savedPageIndex);if(!t)return!1;const i=(s,r,a,o)=>{if(u(this,Cn).has(s.id)){const c=u(this,Fn).get(o);c?s._setParentAndPosition(c,r,a):(s.pageIndex=o,s.x=r,s.y=a)}};return this.addCommands({cmd:()=>{for(const[s,{newX:r,newY:a,newPageIndex:o}]of e)i(s,r,a,o)},undo:()=>{for(const[s,{savedX:r,savedY:a,savedPageIndex:o}]of e)i(s,r,a,o)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(u(this,ka))for(const i of u(this,ka).keys())i.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||u(this,qt).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return u(this,Rs)===e}getActive(){return u(this,Rs)}getMode(){return u(this,Xn)}isEditingMode(){return u(this,Xn)!==gt.NONE}get imageManager(){return ht(this,"imageManager",new vA)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let h=0,d=t.rangeCount;h<d;h++)if(!e.contains(t.getRangeAt(h).commonAncestorContainer))return null;const{x:i,y:s,width:r,height:a}=e.getBoundingClientRect();let o;switch(e.getAttribute("data-main-rotation")){case"90":o=(h,d,f,p)=>({x:(d-s)/a,y:1-(h+f-i)/r,width:p/a,height:f/r});break;case"180":o=(h,d,f,p)=>({x:1-(h+f-i)/r,y:1-(d+p-s)/a,width:f/r,height:p/a});break;case"270":o=(h,d,f,p)=>({x:1-(d+p-s)/a,y:(h-i)/r,width:p/a,height:f/r});break;default:o=(h,d,f,p)=>({x:(h-i)/r,y:(d-s)/a,width:f/r,height:p/a});break}const c=[];for(let h=0,d=t.rangeCount;h<d;h++){const f=t.getRangeAt(h);if(!f.collapsed)for(const{x:p,y:g,width:v,height:b}of f.getClientRects())v===0||b===0||c.push(o(p,g,v,b))}return c.length===0?null:c}addChangedExistingAnnotation({annotationElementId:e,id:t}){(u(this,Nf)||k(this,Nf,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=u(this,Nf))==null||t.delete(e)}renderAnnotationElement(e){var s;const t=(s=u(this,Nf))==null?void 0:s.get(e.data.id);if(!t)return;const i=u(this,vr).getRawValue(t);i&&(u(this,Xn)===gt.NONE&&!i.hasBeenModified||i.renderAnnotationElement(e))}setMissingCanvas(e,t,i){var r;const s=(r=u(this,tc))==null?void 0:r.get(e);s&&(s.setCanvas(t,i),u(this,tc).delete(e))}addMissingCanvas(e,t){(u(this,tc)||k(this,tc,new Map)).set(e,t)}};Af=new WeakMap,Rs=new WeakMap,Ef=new WeakMap,Cn=new WeakMap,Fn=new WeakMap,Cf=new WeakMap,vr=new WeakMap,Nf=new WeakMap,br=new WeakMap,$i=new WeakMap,Yl=new WeakMap,Xl=new WeakMap,_f=new WeakMap,Kl=new WeakMap,ka=new WeakMap,wr=new WeakMap,ju=new WeakMap,d0=new WeakMap,f0=new WeakMap,kf=new WeakMap,p0=new WeakMap,Ta=new WeakMap,Zl=new WeakMap,Tf=new WeakMap,Ql=new WeakMap,Da=new WeakMap,x1=new WeakMap,Jl=new WeakMap,Df=new WeakMap,g0=new WeakMap,ec=new WeakMap,Ru=new WeakMap,jf=new WeakMap,tc=new WeakMap,m0=new WeakMap,Xn=new WeakMap,qt=new WeakMap,Co=new WeakMap,nc=new WeakMap,ic=new WeakMap,x0=new WeakMap,Rf=new WeakMap,y0=new WeakMap,sc=new WeakMap,ja=new WeakMap,No=new WeakMap,v0=new WeakMap,b0=new WeakMap,Sr=new WeakMap,Be=new WeakSet,kv=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},wA=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const i of u(this,Fn).values())if(i.hasTextLayer(e))return i;return null},mL=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const i=R(this,Be,kv).call(this,e).closest(".textLayer"),s=this.getSelectionBoxes(i);s&&(u(this,Da)||k(this,Da,new iG(this)),u(this,Da).show(i,s,this.direction==="ltr"))},xL=function(){var r,a,o;const e=document.getSelection();if(!e||e.isCollapsed){u(this,Co)&&((r=u(this,Da))==null||r.hide(),k(this,Co,null),R(this,Be,Ki).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===u(this,Co))return;const s=R(this,Be,kv).call(this,e).closest(".textLayer");if(!s){u(this,Co)&&((a=u(this,Da))==null||a.hide(),k(this,Co,null),R(this,Be,Ki).call(this,{hasSelectedText:!1}));return}if((o=u(this,Da))==null||o.hide(),k(this,Co,t),R(this,Be,Ki).call(this,{hasSelectedText:!0}),!(u(this,Xn)!==gt.HIGHLIGHT&&u(this,Xn)!==gt.NONE)&&(u(this,Xn)===gt.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),k(this,Ql,this.isShiftKeyDown),!this.isShiftKeyDown)){const c=u(this,Xn)===gt.HIGHLIGHT?R(this,Be,wA).call(this,s):null;if(c==null||c.toggleDrawing(),u(this,Df)){const h=new AbortController,d=this.combinedSignal(h),f=p=>{p.type==="pointerup"&&p.button!==0||(h.abort(),c==null||c.toggleDrawing(!0),p.type==="pointerup"&&R(this,Be,Kg).call(this,"main_toolbar"))};window.addEventListener("pointerup",f,{signal:d}),window.addEventListener("blur",f,{signal:d})}else c==null||c.toggleDrawing(!0),R(this,Be,Kg).call(this,"main_toolbar")}},Kg=function(e=""){u(this,Xn)===gt.HIGHLIGHT?this.highlightSelection(e):u(this,d0)&&R(this,Be,mL).call(this)},yL=function(){document.addEventListener("selectionchange",R(this,Be,xL).bind(this),{signal:this._signal})},vL=function(){if(u(this,Zl))return;k(this,Zl,new AbortController);const e=this.combinedSignal(u(this,Zl));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},bL=function(){var e;(e=u(this,Zl))==null||e.abort(),k(this,Zl,null)},SA=function(){if(u(this,ec))return;k(this,ec,new AbortController);const e=this.combinedSignal(u(this,ec));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},wL=function(){var e;(e=u(this,ec))==null||e.abort(),k(this,ec,null)},SL=function(){if(u(this,Yl))return;k(this,Yl,new AbortController);const e=this.combinedSignal(u(this,Yl));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},AL=function(){var e;(e=u(this,Yl))==null||e.abort(),k(this,Yl,null)},EL=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},Ki=function(e){Object.entries(e).some(([i,s])=>u(this,y0)[i]!==s)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(u(this,y0),e)}),u(this,Xn)===gt.HIGHLIGHT&&e.hasSelectedEditor===!1&&R(this,Be,yo).call(this,[[Tt.HIGHLIGHT_FREE,!0]]))},yo=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},CL=async function(){if(!u(this,Jl)){k(this,Jl,!0);const e=[];for(const t of u(this,Fn).values())e.push(t.enable());await Promise.all(e);for(const t of u(this,Cn).values())t.enable()}},NL=function(){if(this.unselectAll(),u(this,Jl)){k(this,Jl,!1);for(const e of u(this,Fn).values())e.disable();for(const e of u(this,Cn).values())e.disable()}},AA=function(e){const t=u(this,Fn).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},_L=function(){let e=null;for(e of u(this,qt));return e},Zg=function(){if(u(this,Cn).size===0)return!0;if(u(this,Cn).size===1)for(const e of u(this,Cn).values())return e.isEmpty();return!1},EA=function(e){for(const t of u(this,qt))t.unselect();u(this,qt).clear();for(const t of e)t.isEmpty()||(u(this,qt).add(t),t.select());R(this,Be,Ki).call(this,{hasSelectedEditor:this.hasSelection})},we(sf,"TRANSLATE_SMALL",1),we(sf,"TRANSLATE_BIG",10);let Qh=sf;var hi,Ra,ea,Lf,La,Ls,Mf,Ma,ds,_o,Lu,Oa,rc,pa,Qg,Tv;const Zi=class Zi{constructor(e){D(this,pa);D(this,hi,null);D(this,Ra,!1);D(this,ea,null);D(this,Lf,null);D(this,La,null);D(this,Ls,null);D(this,Mf,!1);D(this,Ma,null);D(this,ds,null);D(this,_o,null);D(this,Lu,null);D(this,Oa,!1);k(this,ds,e),k(this,Oa,e._uiManager.useNewAltTextFlow),u(Zi,rc)||k(Zi,rc,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){Zi._l10n??(Zi._l10n=e)}async render(){const e=k(this,ea,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=k(this,Lf,document.createElement("span"));e.append(t),u(this,Oa)?(e.classList.add("new"),e.setAttribute("data-l10n-id",u(Zi,rc).missing),t.setAttribute("data-l10n-id",u(Zi,rc)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const i=u(this,ds)._uiManager._signal;e.addEventListener("contextmenu",Vr,{signal:i}),e.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:i});const s=r=>{r.preventDefault(),u(this,ds)._uiManager.editAltText(u(this,ds)),u(this,Oa)&&u(this,ds)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:u(this,pa,Qg)}})};return e.addEventListener("click",s,{capture:!0,signal:i}),e.addEventListener("keydown",r=>{r.target===e&&r.key==="Enter"&&(k(this,Mf,!0),s(r))},{signal:i}),await R(this,pa,Tv).call(this),e}finish(){u(this,ea)&&(u(this,ea).focus({focusVisible:u(this,Mf)}),k(this,Mf,!1))}isEmpty(){return u(this,Oa)?u(this,hi)===null:!u(this,hi)&&!u(this,Ra)}hasData(){return u(this,Oa)?u(this,hi)!==null||!!u(this,_o):this.isEmpty()}get guessedText(){return u(this,_o)}async setGuessedText(e){u(this,hi)===null&&(k(this,_o,e),k(this,Lu,await Zi._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),R(this,pa,Tv).call(this))}toggleAltTextBadge(e=!1){var t;if(!u(this,Oa)||u(this,hi)){(t=u(this,Ma))==null||t.remove(),k(this,Ma,null);return}if(!u(this,Ma)){const i=k(this,Ma,document.createElement("div"));i.className="noAltTextBadge",u(this,ds).div.append(i)}u(this,Ma).classList.toggle("hidden",!e)}serialize(e){let t=u(this,hi);return!e&&u(this,_o)===t&&(t=u(this,Lu)),{altText:t,decorative:u(this,Ra),guessedText:u(this,_o),textWithDisclaimer:u(this,Lu)}}get data(){return{altText:u(this,hi),decorative:u(this,Ra)}}set data({altText:e,decorative:t,guessedText:i,textWithDisclaimer:s,cancel:r=!1}){i&&(k(this,_o,i),k(this,Lu,s)),!(u(this,hi)===e&&u(this,Ra)===t)&&(r||(k(this,hi,e),k(this,Ra,t)),R(this,pa,Tv).call(this))}toggle(e=!1){u(this,ea)&&(!e&&u(this,Ls)&&(clearTimeout(u(this,Ls)),k(this,Ls,null)),u(this,ea).disabled=!e)}shown(){u(this,ds)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:u(this,pa,Qg)}})}destroy(){var e,t;(e=u(this,ea))==null||e.remove(),k(this,ea,null),k(this,Lf,null),k(this,La,null),(t=u(this,Ma))==null||t.remove(),k(this,Ma,null)}};hi=new WeakMap,Ra=new WeakMap,ea=new WeakMap,Lf=new WeakMap,La=new WeakMap,Ls=new WeakMap,Mf=new WeakMap,Ma=new WeakMap,ds=new WeakMap,_o=new WeakMap,Lu=new WeakMap,Oa=new WeakMap,rc=new WeakMap,pa=new WeakSet,Qg=function(){return u(this,hi)&&"added"||u(this,hi)===null&&this.guessedText&&"review"||"missing"},Tv=async function(){var s,r,a;const e=u(this,ea);if(!e)return;if(u(this,Oa)){if(e.classList.toggle("done",!!u(this,hi)),e.setAttribute("data-l10n-id",u(Zi,rc)[u(this,pa,Qg)]),(s=u(this,Lf))==null||s.setAttribute("data-l10n-id",u(Zi,rc)[`${u(this,pa,Qg)}-label`]),!u(this,hi)){(r=u(this,La))==null||r.remove();return}}else{if(!u(this,hi)&&!u(this,Ra)){e.classList.remove("done"),(a=u(this,La))==null||a.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=u(this,La);if(!t){k(this,La,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${u(this,ds).id}`;const o=100,c=u(this,ds)._uiManager._signal;c.addEventListener("abort",()=>{clearTimeout(u(this,Ls)),k(this,Ls,null)},{once:!0}),e.addEventListener("mouseenter",()=>{k(this,Ls,setTimeout(()=>{k(this,Ls,null),u(this,La).classList.add("show"),u(this,ds)._reportTelemetry({action:"alt_text_tooltip"})},o))},{signal:c}),e.addEventListener("mouseleave",()=>{var h;u(this,Ls)&&(clearTimeout(u(this,Ls)),k(this,Ls,null)),(h=u(this,La))==null||h.classList.remove("show")},{signal:c})}u(this,Ra)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=u(this,hi)),t.parentNode||e.append(t);const i=u(this,ds).getElementForAltText();i==null||i.setAttribute("aria-describedby",t.id)},D(Zi,rc,null),we(Zi,"_l10n",null);let n1=Zi;var Ai,Ar,Mu,hn,w0,ac,Er,oc,lc,Ou,S0,CA;class Zy{constructor(e){D(this,S0);D(this,Ai,null);D(this,Ar,null);D(this,Mu,!1);D(this,hn,null);D(this,w0,null);D(this,ac,null);D(this,Er,null);D(this,oc,null);D(this,lc,!1);D(this,Ou,null);k(this,hn,e)}renderForToolbar(){const e=k(this,Ar,document.createElement("button"));return e.className="comment",R(this,S0,CA).call(this,e,!1)}renderForStandalone(){const e=k(this,Ai,document.createElement("button"));e.className="annotationCommentButton";const t=u(this,hn).commentButtonPosition;if(t){const{style:i}=e;i.insetInlineEnd=`calc(${100*(u(this,hn)._uiManager.direction==="ltr"?1-t[0]:t[0])}% - var(--comment-button-dim))`,i.top=`calc(${100*t[1]}% - var(--comment-button-dim))`;const s=u(this,hn).commentButtonColor;s&&(i.backgroundColor=s)}return R(this,S0,CA).call(this,e,!0)}focusButton(){setTimeout(()=>{var e;(e=u(this,Ai)??u(this,Ar))==null||e.focus()},0)}onUpdatedColor(){if(!u(this,Ai))return;const e=u(this,hn).commentButtonColor;e&&(u(this,Ai).style.backgroundColor=e),u(this,hn)._uiManager.updatePopupColor(u(this,hn))}get commentButtonWidth(){var e;return(((e=u(this,Ai))==null?void 0:e.getBoundingClientRect().width)??0)/u(this,hn).parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(u(this,Ou))return u(this,Ou);if(!u(this,Ai))return null;const{x:e,y:t,height:i}=u(this,Ai).getBoundingClientRect(),{x:s,y:r,width:a,height:o}=u(this,hn).parent.boundingClientRect;return[(e-s)/a,(t+i-r)/o]}set commentPopupPositionInLayer(e){k(this,Ou,e)}hasDefaultPopupPosition(){return u(this,Ou)===null}removeStandaloneCommentButton(){var e;(e=u(this,Ai))==null||e.remove(),k(this,Ai,null)}removeToolbarCommentButton(){var e;(e=u(this,Ar))==null||e.remove(),k(this,Ar,null)}setCommentButtonStates({selected:e,hasPopup:t}){u(this,Ai)&&(u(this,Ai).classList.toggle("selected",e),u(this,Ai).ariaExpanded=t)}edit(e){const t=this.commentPopupPositionInLayer;let i,s;if(t)[i,s]=t;else{[i,s]=u(this,hn).commentButtonPosition;const{width:d,height:f,x:p,y:g}=u(this,hn);i=p+i*d,s=g+s*f}const r=u(this,hn).parent.boundingClientRect,{x:a,y:o,width:c,height:h}=r;u(this,hn)._uiManager.editComment(u(this,hn),a+i*c,o+s*h,{...e,parentDimensions:r})}finish(){u(this,Ar)&&(u(this,Ar).focus({focusVisible:u(this,Mu)}),k(this,Mu,!1))}isDeleted(){return u(this,lc)||u(this,Er)===""}isEmpty(){return u(this,Er)===null}hasBeenEdited(){return this.isDeleted()||u(this,Er)!==u(this,w0)}serialize(){return this.data}get data(){return{text:u(this,Er),richText:u(this,ac),date:u(this,oc),deleted:this.isDeleted()}}set data(e){if(e!==u(this,Er)&&k(this,ac,null),e===null){k(this,Er,""),k(this,lc,!0);return}k(this,Er,e),k(this,oc,new Date),k(this,lc,!1)}restoreData({text:e,richText:t,date:i}){k(this,Er,e),k(this,ac,t),k(this,oc,i),k(this,lc,!1)}setInitialText(e,t=null){k(this,w0,e),this.data=e,k(this,oc,null),k(this,ac,t)}shown(){}destroy(){var e,t;(e=u(this,Ar))==null||e.remove(),k(this,Ar,null),(t=u(this,Ai))==null||t.remove(),k(this,Ai,null),k(this,Er,""),k(this,ac,null),k(this,oc,null),k(this,hn,null),k(this,Mu,!1),k(this,lc,!1)}}Ai=new WeakMap,Ar=new WeakMap,Mu=new WeakMap,hn=new WeakMap,w0=new WeakMap,ac=new WeakMap,Er=new WeakMap,oc=new WeakMap,lc=new WeakMap,Ou=new WeakMap,S0=new WeakSet,CA=function(e,t){if(!u(this,hn)._uiManager.hasCommentManager())return null;e.tabIndex="0",e.ariaHasPopup="dialog",t?(e.ariaControls="commentPopup",e.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(e.ariaControlsElements=[u(this,hn)._uiManager.getCommentDialogElement()],e.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const i=u(this,hn)._uiManager._signal;if(!(i instanceof AbortSignal)||i.aborted)return e;e.addEventListener("contextmenu",Vr,{signal:i}),t&&(e.addEventListener("focusin",r=>{u(this,hn)._focusEventsAllowed=!1,On(r)},{capture:!0,signal:i}),e.addEventListener("focusout",r=>{u(this,hn)._focusEventsAllowed=!0,On(r)},{capture:!0,signal:i})),e.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:i});const s=r=>{r.preventDefault(),e===u(this,Ar)?this.edit():u(this,hn).toggleComment(!0)};return e.addEventListener("click",s,{capture:!0,signal:i}),e.addEventListener("keydown",r=>{r.target===e&&r.key==="Enter"&&(k(this,Mu,!0),s(r))},{signal:i}),e.addEventListener("pointerenter",()=>{u(this,hn).toggleComment(!1,!0)},{signal:i}),e.addEventListener("pointerleave",()=>{u(this,hn).toggleComment(!1,!1)},{signal:i}),e};var Of,Pu,A0,E0,C0,N0,_0,ko,Iu,To,Bu,Do,lu,kL,TL,DL;const RN=class RN{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:i=null,onPinchStart:s=null,onPinching:r=null,onPinchEnd:a=null,signal:o}){D(this,lu);D(this,Of);D(this,Pu,!1);D(this,A0,null);D(this,E0);D(this,C0);D(this,N0);D(this,_0);D(this,ko,null);D(this,Iu);D(this,To,null);D(this,Bu);D(this,Do,null);k(this,Of,e),k(this,A0,i),k(this,E0,t),k(this,C0,s),k(this,N0,r),k(this,_0,a),k(this,Bu,new AbortController),k(this,Iu,AbortSignal.any([o,u(this,Bu).signal])),e.addEventListener("touchstart",R(this,lu,kL).bind(this),{passive:!1,signal:u(this,Iu)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/ro.pixelRatio}destroy(){var e,t;(e=u(this,Bu))==null||e.abort(),k(this,Bu,null),(t=u(this,ko))==null||t.abort(),k(this,ko,null)}};Of=new WeakMap,Pu=new WeakMap,A0=new WeakMap,E0=new WeakMap,C0=new WeakMap,N0=new WeakMap,_0=new WeakMap,ko=new WeakMap,Iu=new WeakMap,To=new WeakMap,Bu=new WeakMap,Do=new WeakMap,lu=new WeakSet,kL=function(e){var s,r,a;if((s=u(this,E0))!=null&&s.call(this))return;if(e.touches.length===1){if(u(this,ko))return;const o=k(this,ko,new AbortController),c=AbortSignal.any([u(this,Iu),o.signal]),h=u(this,Of),d={capture:!0,signal:c,passive:!1},f=p=>{var g;p.pointerType==="touch"&&((g=u(this,ko))==null||g.abort(),k(this,ko,null))};h.addEventListener("pointerdown",p=>{p.pointerType==="touch"&&(On(p),f(p))},d),h.addEventListener("pointerup",f,d),h.addEventListener("pointercancel",f,d);return}if(!u(this,Do)){k(this,Do,new AbortController);const o=AbortSignal.any([u(this,Iu),u(this,Do).signal]),c=u(this,Of),h={signal:o,capture:!1,passive:!1};c.addEventListener("touchmove",R(this,lu,TL).bind(this),h);const d=R(this,lu,DL).bind(this);c.addEventListener("touchend",d,h),c.addEventListener("touchcancel",d,h),h.capture=!0,c.addEventListener("pointerdown",On,h),c.addEventListener("pointermove",On,h),c.addEventListener("pointercancel",On,h),c.addEventListener("pointerup",On,h),(r=u(this,C0))==null||r.call(this)}if(On(e),e.touches.length!==2||(a=u(this,A0))!=null&&a.call(this)){k(this,To,null);return}let[t,i]=e.touches;t.identifier>i.identifier&&([t,i]=[i,t]),k(this,To,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:i.screenX,touch1Y:i.screenY})},TL=function(e){var E;if(!u(this,To)||e.touches.length!==2)return;On(e);let[t,i]=e.touches;t.identifier>i.identifier&&([t,i]=[i,t]);const{screenX:s,screenY:r}=t,{screenX:a,screenY:o}=i,c=u(this,To),{touch0X:h,touch0Y:d,touch1X:f,touch1Y:p}=c,g=f-h,v=p-d,b=a-s,x=o-r,m=Math.hypot(b,x)||1,y=Math.hypot(g,v)||1;if(!u(this,Pu)&&Math.abs(y-m)<=RN.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(c.touch0X=s,c.touch0Y=r,c.touch1X=a,c.touch1Y=o,!u(this,Pu)){k(this,Pu,!0);return}const w=[(s+a)/2,(r+o)/2];(E=u(this,N0))==null||E.call(this,w,y,m)},DL=function(e){var t;e.touches.length>=2||(u(this,Do)&&(u(this,Do).abort(),k(this,Do,null),(t=u(this,_0))==null||t.call(this)),u(this,To)&&(On(e),k(this,To,null),k(this,Pu,!1)))};let i1=RN;var zu,ta,wn,Vt,jo,Pf,cc,k0,Ei,Fu,Ro,Cr,uc,T0,Uu,Ms,D0,Hu,Lo,Pa,If,Bf,Nr,$u,j0,y1,st,NA,R0,_A,Dv,jL,RL,kA,jv,TA,LL,ML,OL,DA,PL,jA,IL,BL,zL,RA,Jg;const pt=class pt{constructor(e){D(this,st);D(this,zu,null);D(this,ta,null);D(this,wn,null);D(this,Vt,null);D(this,jo,null);D(this,Pf,!1);D(this,cc,null);D(this,k0,"");D(this,Ei,null);D(this,Fu,null);D(this,Ro,null);D(this,Cr,null);D(this,uc,null);D(this,T0,"");D(this,Uu,!1);D(this,Ms,null);D(this,D0,!1);D(this,Hu,!1);D(this,Lo,!1);D(this,Pa,null);D(this,If,0);D(this,Bf,0);D(this,Nr,null);D(this,$u,null);we(this,"isSelected",!1);we(this,"_isCopy",!1);we(this,"_editToolbar",null);we(this,"_initialOptions",Object.create(null));we(this,"_initialData",null);we(this,"_isVisible",!0);we(this,"_uiManager",null);we(this,"_focusEventsAllowed",!0);D(this,j0,!1);D(this,y1,pt._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null,this.creationDate=e.creationDate||new Date,this.modificationDate=e.modificationDate||null,this.canAddComment=!0;const{rotation:t,rawDims:{pageWidth:i,pageHeight:s,pageX:r,pageY:a}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,s],this.pageTranslation=[r,a];const[o,c]=this.parentDimensions;this.x=e.x/o,this.y=e.y/c,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=pt.prototype._resizeWithKeyboard,t=Qh.TRANSLATE_SMALL,i=Qh.TRANSLATE_BIG;return ht(this,"_resizerKeyboardManager",new Ey([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,i]}],[["Escape","mac+Escape"],pt.prototype._stopResizingWithKeyboard]]))}updatePageIndex(e){this.pageIndex=e}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return ht(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new aG({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(pt._l10n??(pt._l10n=e),pt._l10nResizer||(pt._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),pt._borderLineWidth!==-1)return;const i=getComputedStyle(document.documentElement);pt._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){zt("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return u(this,j0)}set _isDraggable(e){var t;k(this,j0,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=u(this,y1)}setParent(e){var t;e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):(R(this,st,Jg).call(this),(t=u(this,Cr))==null||t.remove(),k(this,Cr,null)),this.parent=e}focusin(e){this._focusEventsAllowed&&(u(this,Uu)?k(this,Uu,!1):this.parent.setSelected(this))}focusout(e){var i;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(i=this.parent)!=null&&i.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,i,s){const[r,a]=this.parentDimensions;[i,s]=this.screenToPageTranslation(i,s),this.x=(e+i)/r,this.y=(t+s)/a,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[i,s]=this.parentDimensions;this.setAt(e*i,t*s,this.width*i,this.height*s),this._onTranslated()}translate(e,t){R(this,st,NA).call(this,this.parentDimensions,e,t)}translateInPage(e,t){u(this,Ms)||k(this,Ms,[this.x,this.y,this.width,this.height]),R(this,st,NA).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){u(this,Ms)||k(this,Ms,[this.x,this.y,this.width,this.height]);const{div:i,parentDimensions:[s,r]}=this;if(this.x+=e/s,this.y+=t/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:f,y:p}=this.div.getBoundingClientRect();this.parent.findNewParent(this,f,p)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:o}=this;const[c,h]=this.getBaseTranslation();a+=c,o+=h;const{style:d}=i;d.left=`${(100*a).toFixed(2)}%`,d.top=`${(100*o).toFixed(2)}%`,this._onTranslating(a,o),i.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!u(this,Ms)&&(u(this,Ms)[0]!==this.x||u(this,Ms)[1]!==this.y)}get _hasBeenResized(){return!!u(this,Ms)&&(u(this,Ms)[2]!==this.width||u(this,Ms)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:i}=pt,s=i/e,r=i/t;switch(this.rotation){case 90:return[-s,r];case 180:return[s,r];case 270:return[s,-r];default:return[-s,-r]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[i,s]}=this;let{x:r,y:a,width:o,height:c}=this;if(o*=i,c*=s,r*=i,a*=s,this._mustFixPosition)switch(e){case 0:r=Ti(r,0,i-o),a=Ti(a,0,s-c);break;case 90:r=Ti(r,0,i-c),a=Ti(a,o,s);break;case 180:r=Ti(r,o,i),a=Ti(a,c,s);break;case 270:r=Ti(r,c,i),a=Ti(a,0,s-o);break}this.x=r/=i,this.y=a/=s;const[h,d]=this.getBaseTranslation();r+=h,a+=d,t.left=`${(100*r).toFixed(2)}%`,t.top=`${(100*a).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var i;return R(i=pt,R0,_A).call(i,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var i;return R(i=pt,R0,_A).call(i,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,i]}=this;return[t*e,i*e]}setDims(){const{div:{style:e},width:t,height:i}=this;e.width=`${(100*t).toFixed(2)}%`,e.height=`${(100*i).toFixed(2)}%`}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=u(this,wn))==null||e.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||u(this,Hu))return this._editToolbar;this._editToolbar=new xA(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[t,i]of e)await this._editToolbar.addButton(t,i);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){var e;(e=this._editToolbar)==null||e.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){var e;(e=this._editToolbar)==null||e.removeButton("comment")}removeEditToolbar(){var e,t;(e=this._editToolbar)==null||e.remove(),this._editToolbar=null,(t=u(this,wn))==null||t.destroy()}addContainer(e){var i;const t=(i=this._editToolbar)==null?void 0:i.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return u(this,wn)||(n1.initialize(pt._l10n),k(this,wn,new n1(this)),u(this,zu)&&(u(this,wn).data=u(this,zu),k(this,zu,null))),u(this,wn)}get altTextData(){var e;return(e=u(this,wn))==null?void 0:e.data}set altTextData(e){u(this,wn)&&(u(this,wn).data=e)}get guessedAltText(){var e;return(e=u(this,wn))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=u(this,wn))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=u(this,wn))==null?void 0:t.serialize(e)}hasAltText(){return!!u(this,wn)&&!u(this,wn).isEmpty()}hasAltTextData(){var e;return((e=u(this,wn))==null?void 0:e.hasData())??!1}focusCommentButton(){var e;(e=u(this,Vt))==null||e.focusButton()}addCommentButton(){return this.canAddComment?u(this,Vt)||k(this,Vt,new Zy(this)):null}addStandaloneCommentButton(){if(this._uiManager.hasCommentManager()){if(u(this,jo)){this._uiManager.isEditingMode()&&u(this,jo).classList.remove("hidden");return}this.hasComment&&(k(this,jo,u(this,Vt).renderForStandalone()),this.div.append(u(this,jo)))}}removeStandaloneCommentButton(){u(this,Vt).removeStandaloneCommentButton(),k(this,jo,null)}hideStandaloneCommentButton(){var e;(e=u(this,jo))==null||e.classList.add("hidden")}get comment(){if(!u(this,Vt))return null;const{data:{richText:e,text:t,date:i,deleted:s}}=u(this,Vt);return{text:t,richText:e,date:i,deleted:s,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(e){u(this,Vt)||k(this,Vt,new Zy(this)),typeof e=="object"&&e!==null?u(this,Vt).restoreData(e):u(this,Vt).data=e,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:e,popupRef:t,richText:i}){if(!t||(u(this,Vt)||k(this,Vt,new Zy(this)),u(this,Vt).setInitialText(e,i),!this.annotationElementId))return;const s=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);s&&this.updateFromAnnotationLayer(s)}get hasEditedComment(){var e;return(e=u(this,Vt))==null?void 0:e.hasBeenEdited()}get hasDeletedComment(){var e;return(e=u(this,Vt))==null?void 0:e.isDeleted()}get hasComment(){return!!u(this,Vt)&&!u(this,Vt).isEmpty()&&!u(this,Vt).isDeleted()}async editComment(e){u(this,Vt)||k(this,Vt,new Zy(this)),u(this,Vt).edit(e)}toggleComment(e,t=void 0){this.hasComment&&this._uiManager.toggleComment(this,e,t)}setSelectedCommentButton(e){u(this,Vt).setSelectedButton(e)}addComment(e){if(this.hasEditedComment){const[,,,s]=e.rect,[r]=this.pageDimensions,[a]=this.pageTranslation,o=a+r+1,c=s-100,h=o+180;e.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[o,c,h,s]}}}updateFromAnnotationLayer({popup:{contents:e,deleted:t}}){u(this,Vt).data=t?null:e}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){var a;const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=u(this,Pf)?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),R(this,st,jA).call(this);const[t,i]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*i/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/i).toFixed(2)}%`);const[s,r]=this.getInitialTranslation();return this.translate(s,r),pL(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(u(this,$u)||k(this,$u,new i1({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:R(this,st,LL).bind(this),onPinching:R(this,st,ML).bind(this),onPinchEnd:R(this,st,OL).bind(this),signal:this._uiManager._signal}))),this.addStandaloneCommentButton(),(a=this._uiManager._editorUndoBar)==null||a.hide(),e}pointerdown(e){const{isMac:t}=li.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(k(this,Uu,!0),this._isDraggable){R(this,st,PL).call(this,e);return}R(this,st,DA).call(this,e)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){u(this,Pa)&&clearTimeout(u(this,Pa)),k(this,Pa,setTimeout(()=>{var e;k(this,Pa,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,i){e.changeParent(this),this.x=t,this.y=i,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,i=this.rotation){const s=this.parentScale,[r,a]=this.pageDimensions,[o,c]=this.pageTranslation,h=e/s,d=t/s,f=this.x*r,p=this.y*a,g=this.width*r,v=this.height*a;switch(i){case 0:return[f+h+o,a-p-d-v+c,f+h+g+o,a-p-d+c];case 90:return[f+d+o,a-p+h+c,f+d+v+o,a-p+h+g+c];case 180:return[f-h-g+o,a-p+d+c,f-h+o,a-p+d+v+c];case 270:return[f-d-v+o,a-p-h-g+c,f-d+o,a-p-h+c];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[i,s,r,a]=e,o=r-i,c=a-s;switch(this.rotation){case 0:return[i,t-a,o,c];case 90:return[i,t-s,c,o];case 180:return[r,t-s,o,c];case 270:return[r,t-a,c,o];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&pt._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){var e;(e=u(this,Vt))==null||e.onUpdatedColor()}getData(){const{comment:{text:e,color:t,date:i,opacity:s,deleted:r,richText:a},uid:o,pageIndex:c,creationDate:h,modificationDate:d}=this;return{id:o,pageIndex:c,rect:this.getPDFRect(),richText:a,contentsObj:{str:e},creationDate:h,modificationDate:i||d,popupRef:!r,color:t,opacity:s}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),k(this,Hu,!0),!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),k(this,Hu,!1),!0):!1}isInEditMode(){return u(this,Hu)}shouldGetKeyboardEvents(){return u(this,Lo)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:i,right:s}=this.getClientDimensions(),{innerHeight:r,innerWidth:a}=window;return t<a&&s>0&&e<r&&i>0}rebuild(){R(this,st,jA).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){var i;return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:((i=this._initialData)==null?void 0:i.popupRef)||""}}static async deserialize(e,t,i){const s=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:i,annotationElementId:e.annotationElementId,creationDate:e.creationDate,modificationDate:e.modificationDate});s.rotation=e.rotation,k(s,zu,e.accessibilityData),s._isCopy=e.isCopy||!1;const[r,a]=s.pageDimensions,[o,c,h,d]=s.getRectInCurrentCoords(e.rect,a);return s.x=o/r,s.y=c/a,s.width=h/r,s.height=d/a,s}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t,i;if((e=u(this,uc))==null||e.abort(),k(this,uc,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),u(this,Pa)&&(clearTimeout(u(this,Pa)),k(this,Pa,null)),R(this,st,Jg).call(this),this.removeEditToolbar(),u(this,Nr)){for(const s of u(this,Nr).values())clearTimeout(s);k(this,Nr,null)}this.parent=null,(t=u(this,$u))==null||t.destroy(),k(this,$u,null),(i=u(this,Cr))==null||i.remove(),k(this,Cr,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(R(this,st,jL).call(this),u(this,Ei).classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[e,t]}=this,[i,s,r,a]=this.getPDFRect();return[pt._round(i+(r-i)*e),pt._round(s+(a-s)*(1-t))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return u(this,Vt).commentPopupPositionInLayer}set commentPopupPosition(e){u(this,Vt).commentPopupPositionInLayer=e}hasDefaultPopupPosition(){return u(this,Vt).hasDefaultPopupPosition()}get commentButtonWidth(){return u(this,Vt).commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(e){var t;(t=u(this,Vt))==null||t.setCommentButtonStates(e)}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),k(this,Ro,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=u(this,Ei).children;if(!u(this,ta)){k(this,ta,Array.from(t));const a=R(this,st,IL).bind(this),o=R(this,st,BL).bind(this),c=this._uiManager._signal;for(const h of u(this,ta)){const d=h.getAttribute("data-resizer-name");h.setAttribute("role","spinbutton"),h.addEventListener("keydown",a,{signal:c}),h.addEventListener("blur",o,{signal:c}),h.addEventListener("focus",R(this,st,zL).bind(this,d),{signal:c}),h.setAttribute("data-l10n-id",pt._l10nResizer[d])}}const i=u(this,ta)[0];let s=0;for(const a of t){if(a===i)break;s++}const r=(360-this.rotation+this.parentRotation)%360/90*(u(this,ta).length/4);if(r!==s){if(r<s)for(let o=0;o<s-r;o++)u(this,Ei).append(u(this,Ei).firstElementChild);else if(r>s)for(let o=0;o<r-s;o++)u(this,Ei).firstElementChild.before(u(this,Ei).lastElementChild);let a=0;for(const o of t){const h=u(this,ta)[a++].getAttribute("data-resizer-name");o.setAttribute("data-l10n-id",pt._l10nResizer[h])}}R(this,st,RA).call(this,0),k(this,Lo,!0),u(this,Ei).firstElementChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){u(this,Lo)&&R(this,st,TA).call(this,u(this,T0),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){R(this,st,Jg).call(this),this.div.focus()}select(){var e,t,i;if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var s,r;(s=this.div)!=null&&s.classList.contains("selectedEditor")&&((r=this._editToolbar)==null||r.show())});return}(t=this._editToolbar)==null||t.show(),(i=u(this,wn))==null||i.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>{var e;return(e=this.div)==null?void 0:e.focus({preventScroll:!0})},0)}unselect(){var e,t,i,s,r;this.isSelected&&(this.isSelected=!1,(e=u(this,Ei))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(i=this.div)!=null&&i.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(s=this._editToolbar)==null||s.hide(),(r=u(this,wn))==null||r.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){e.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return u(this,D0)}set isEditing(e){k(this,D0,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){u(this,Nr)||k(this,Nr,new Map);const{action:i}=e;let s=u(this,Nr).get(i);s&&clearTimeout(s),s=setTimeout(()=>{this._reportTelemetry(e),u(this,Nr).delete(i),u(this,Nr).size===0&&k(this,Nr,null)},pt._telemetryTimeout),u(this,Nr).set(i,s);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),k(this,Pf,!1)}disable(){this.div&&(this.div.tabIndex=-1),k(this,Pf,!0)}updateFakeAnnotationElement(e){if(!u(this,Cr)&&!this.deleted){k(this,Cr,e.addFakeAnnotation(this));return}if(this.deleted){u(this,Cr).remove(),k(this,Cr,null);return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&u(this,Cr).updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const i=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),i.before(t)}return t}resetAnnotationElement(e){const{firstElementChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};zu=new WeakMap,ta=new WeakMap,wn=new WeakMap,Vt=new WeakMap,jo=new WeakMap,Pf=new WeakMap,cc=new WeakMap,k0=new WeakMap,Ei=new WeakMap,Fu=new WeakMap,Ro=new WeakMap,Cr=new WeakMap,uc=new WeakMap,T0=new WeakMap,Uu=new WeakMap,Ms=new WeakMap,D0=new WeakMap,Hu=new WeakMap,Lo=new WeakMap,Pa=new WeakMap,If=new WeakMap,Bf=new WeakMap,Nr=new WeakMap,$u=new WeakMap,j0=new WeakMap,y1=new WeakMap,st=new WeakSet,NA=function([e,t],i,s){[i,s]=this.screenToPageTranslation(i,s),this.x+=i/e,this.y+=s/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},R0=new WeakSet,_A=function(e,t,i){switch(i){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},Dv=function(e){switch(e){case 90:{const[t,i]=this.pageDimensions;return[0,-t/i,i/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,i]=this.pageDimensions;return[0,t/i,-i/t,0]}default:return[1,0,0,1]}},jL=function(){if(u(this,Ei))return;k(this,Ei,document.createElement("div")),u(this,Ei).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const i of e){const s=document.createElement("div");u(this,Ei).append(s),s.classList.add("resizer",i),s.setAttribute("data-resizer-name",i),s.addEventListener("pointerdown",R(this,st,RL).bind(this,i),{signal:t}),s.addEventListener("contextmenu",Vr,{signal:t}),s.tabIndex=-1}this.div.prepend(u(this,Ei))},RL=function(e,t){var d;t.preventDefault();const{isMac:i}=li.platform;if(t.button!==0||t.ctrlKey&&i)return;(d=u(this,wn))==null||d.toggle(!1);const s=this._isDraggable;this._isDraggable=!1,k(this,Fu,[t.screenX,t.screenY]);const r=new AbortController,a=this._uiManager.combinedSignal(r);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",R(this,st,TA).bind(this,e),{passive:!0,capture:!0,signal:a}),window.addEventListener("touchmove",On,{passive:!1,signal:a}),window.addEventListener("contextmenu",Vr,{signal:a}),k(this,Ro,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const o=this.parent.div.style.cursor,c=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const h=()=>{var f;r.abort(),this.parent.togglePointerEvents(!0),(f=u(this,wn))==null||f.toggle(!0),this._isDraggable=s,this.parent.div.style.cursor=o,this.div.style.cursor=c,R(this,st,jv).call(this)};window.addEventListener("pointerup",h,{signal:a}),window.addEventListener("blur",h,{signal:a})},kA=function(e,t,i,s){this.width=i,this.height=s,this.x=e,this.y=t,this.setDims(),this.fixAndSetPosition(),this._onResized()},jv=function(){if(!u(this,Ro))return;const{savedX:e,savedY:t,savedWidth:i,savedHeight:s}=u(this,Ro);k(this,Ro,null);const r=this.x,a=this.y,o=this.width,c=this.height;r===e&&a===t&&o===i&&c===s||this.addCommands({cmd:R(this,st,kA).bind(this,r,a,o,c),undo:R(this,st,kA).bind(this,e,t,i,s),mustExec:!0})},TA=function(e,t){const[i,s]=this.parentDimensions,r=this.x,a=this.y,o=this.width,c=this.height,h=pt.MIN_SIZE/i,d=pt.MIN_SIZE/s,f=R(this,st,Dv).call(this,this.rotation),p=(V,H)=>[f[0]*V+f[2]*H,f[1]*V+f[3]*H],g=R(this,st,Dv).call(this,360-this.rotation),v=(V,H)=>[g[0]*V+g[2]*H,g[1]*V+g[3]*H];let b,x,m=!1,y=!1;switch(e){case"topLeft":m=!0,b=(V,H)=>[0,0],x=(V,H)=>[V,H];break;case"topMiddle":b=(V,H)=>[V/2,0],x=(V,H)=>[V/2,H];break;case"topRight":m=!0,b=(V,H)=>[V,0],x=(V,H)=>[0,H];break;case"middleRight":y=!0,b=(V,H)=>[V,H/2],x=(V,H)=>[0,H/2];break;case"bottomRight":m=!0,b=(V,H)=>[V,H],x=(V,H)=>[0,0];break;case"bottomMiddle":b=(V,H)=>[V/2,H],x=(V,H)=>[V/2,0];break;case"bottomLeft":m=!0,b=(V,H)=>[0,H],x=(V,H)=>[V,0];break;case"middleLeft":y=!0,b=(V,H)=>[0,H/2],x=(V,H)=>[V,H/2];break}const w=b(o,c),E=x(o,c);let S=p(...E);const _=pt._round(r+S[0]),T=pt._round(a+S[1]);let j=1,M=1,L,O;if(t.fromKeyboard)({deltaX:L,deltaY:O}=t);else{const{screenX:V,screenY:H}=t,[P,Y]=u(this,Fu);[L,O]=this.screenToPageTranslation(V-P,H-Y),u(this,Fu)[0]=V,u(this,Fu)[1]=H}if([L,O]=v(L/i,O/s),m){const V=Math.hypot(o,c);j=M=Math.max(Math.min(Math.hypot(E[0]-w[0]-L,E[1]-w[1]-O)/V,1/o,1/c),h/o,d/c)}else y?j=Ti(Math.abs(E[0]-w[0]-L),h,1)/o:M=Ti(Math.abs(E[1]-w[1]-O),d,1)/c;const B=pt._round(o*j),G=pt._round(c*M);S=p(...x(B,G));const W=_-S[0],J=T-S[1];u(this,Ms)||k(this,Ms,[this.x,this.y,this.width,this.height]),this.width=B,this.height=G,this.x=W,this.y=J,this.setDims(),this.fixAndSetPosition(),this._onResizing()},LL=function(){var e;k(this,Ro,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=u(this,wn))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},ML=function(e,t,i){let r=.7*(i/t)+1-.7;if(r===1)return;const a=R(this,st,Dv).call(this,this.rotation),o=(_,T)=>[a[0]*_+a[2]*T,a[1]*_+a[3]*T],[c,h]=this.parentDimensions,d=this.x,f=this.y,p=this.width,g=this.height,v=pt.MIN_SIZE/c,b=pt.MIN_SIZE/h;r=Math.max(Math.min(r,1/p,1/g),v/p,b/g);const x=pt._round(p*r),m=pt._round(g*r);if(x===p&&m===g)return;u(this,Ms)||k(this,Ms,[d,f,p,g]);const y=o(p/2,g/2),w=pt._round(d+y[0]),E=pt._round(f+y[1]),S=o(x/2,m/2);this.x=w-S[0],this.y=E-S[1],this.width=x,this.height=m,this.setDims(),this.fixAndSetPosition(),this._onResizing()},OL=function(){var e;(e=u(this,wn))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),R(this,st,jv).call(this)},DA=function(e){const{isMac:t}=li.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},PL=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let i=!1;const s=new AbortController,r=this._uiManager.combinedSignal(s),a={capture:!0,passive:!1,signal:r},o=h=>{s.abort(),k(this,cc,null),k(this,Uu,!1),this._uiManager.endDragSession()||R(this,st,DA).call(this,h),i&&this._onStopDragging()};t&&(k(this,If,e.clientX),k(this,Bf,e.clientY),k(this,cc,e.pointerId),k(this,k0,e.pointerType),window.addEventListener("pointermove",h=>{i||(i=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:d,clientY:f,pointerId:p}=h;if(p!==u(this,cc)){On(h);return}const[g,v]=this.screenToPageTranslation(d-u(this,If),f-u(this,Bf));k(this,If,d),k(this,Bf,f),this._uiManager.dragSelectedEditors(g,v)},a),window.addEventListener("touchmove",On,a),window.addEventListener("pointerdown",h=>{h.pointerType===u(this,k0)&&(u(this,$u)||h.isPrimary)&&o(h),On(h)},a));const c=h=>{if(!u(this,cc)||u(this,cc)===h.pointerId){o(h);return}On(h)};window.addEventListener("pointerup",c,{signal:r}),window.addEventListener("blur",c,{signal:r})},jA=function(){if(u(this,uc)||!this.div)return;k(this,uc,new AbortController);const e=this._uiManager.combinedSignal(u(this,uc));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},IL=function(e){pt._resizerKeyboardManager.exec(this,e)},BL=function(e){var t;u(this,Lo)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==u(this,Ei)&&R(this,st,Jg).call(this)},zL=function(e){k(this,T0,u(this,Lo)?e:"")},RA=function(e){if(u(this,ta))for(const t of u(this,ta))t.tabIndex=e},Jg=function(){k(this,Lo,!1),R(this,st,RA).call(this,-1),R(this,st,jv).call(this)},D(pt,R0),we(pt,"_l10n",null),we(pt,"_l10nResizer",null),we(pt,"_borderLineWidth",-1),we(pt,"_colorManager",new bA),we(pt,"_zIndex",1),we(pt,"_telemetryTimeout",1e3);let dn=pt;class aG extends dn{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const tD=3285377520,gr=4294901760,Na=65535;class FL{constructor(e){this.h1=e?e&4294967295:tD,this.h2=e?e&4294967295:tD}update(e){let t,i;if(typeof e=="string"){t=new Uint8Array(e.length*2),i=0;for(let b=0,x=e.length;b<x;b++){const m=e.charCodeAt(b);m<=255?t[i++]=m:(t[i++]=m>>>8,t[i++]=m&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),i=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const s=i>>2,r=i-s*4,a=new Uint32Array(t.buffer,0,s);let o=0,c=0,h=this.h1,d=this.h2;const f=3432918353,p=461845907,g=f&Na,v=p&Na;for(let b=0;b<s;b++)b&1?(o=a[b],o=o*f&gr|o*g&Na,o=o<<15|o>>>17,o=o*p&gr|o*v&Na,h^=o,h=h<<13|h>>>19,h=h*5+3864292196):(c=a[b],c=c*f&gr|c*g&Na,c=c<<15|c>>>17,c=c*p&gr|c*v&Na,d^=c,d=d<<13|d>>>19,d=d*5+3864292196);switch(o=0,r){case 3:o^=t[s*4+2]<<16;case 2:o^=t[s*4+1]<<8;case 1:o^=t[s*4],o=o*f&gr|o*g&Na,o=o<<15|o>>>17,o=o*p&gr|o*v&Na,s&1?h^=o:d^=o}this.h1=h,this.h2=d}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&gr|e*36045&Na,t=t*4283543511&gr|((t<<16|e>>>16)*2950163797&gr)>>>16,e^=t>>>1,e=e*444984403&gr|e*60499&Na,t=t*3301882366&gr|((t<<16|e>>>16)*3120437893&gr)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const LA=Object.freeze({map:null,hash:"",transfer:void 0});var qu,Vu,Mo,Ci,v1,UL;class SN{constructor(){D(this,v1);D(this,qu,!1);D(this,Vu,null);D(this,Mo,null);D(this,Ci,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const i=u(this,Ci).get(e);return i===void 0?t:Object.assign(t,i)}getRawValue(e){return u(this,Ci).get(e)}remove(e){const t=u(this,Ci).get(e);if(t!==void 0&&(t instanceof dn&&u(this,Mo).delete(t.annotationElementId),u(this,Ci).delete(e),u(this,Ci).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const i of u(this,Ci).values())if(i instanceof dn)return;this.onAnnotationEditor(null)}}setValue(e,t){const i=u(this,Ci).get(e);let s=!1;if(i!==void 0)for(const[r,a]of Object.entries(t))i[r]!==a&&(s=!0,i[r]=a);else s=!0,u(this,Ci).set(e,t);s&&R(this,v1,UL).call(this),t instanceof dn&&((u(this,Mo)||k(this,Mo,new Map)).set(t.annotationElementId,t),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type))}has(e){return u(this,Ci).has(e)}get size(){return u(this,Ci).size}resetModified(){u(this,qu)&&(k(this,qu,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new HL(this)}get serializable(){if(u(this,Ci).size===0)return LA;const e=new Map,t=new FL,i=[],s=Object.create(null);let r=!1;for(const[a,o]of u(this,Ci)){const c=o instanceof dn?o.serialize(!1,s):o;o.page&&(o.pageIndex=o.page._pageIndex,delete o.page),c&&(e.set(a,c),t.update(`${a}:${JSON.stringify(c)}`),r||(r=!!c.bitmap))}if(r)for(const a of e.values())a.bitmap&&i.push(a.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:i}:LA}get editorStats(){let e=null;const t=new Map;let i=0,s=0;for(const r of u(this,Ci).values()){if(!(r instanceof dn)){r.popup&&(r.popup.deleted?s+=1:i+=1);continue}r.isCommentDeleted?s+=1:r.hasEditedComment&&(i+=1);const a=r.telemetryFinalData;if(!a)continue;const{type:o}=a;t.has(o)||t.set(o,Object.getPrototypeOf(r).constructor),e||(e=Object.create(null));const c=e[o]||(e[o]=new Map);for(const[h,d]of Object.entries(a)){if(h==="type")continue;let f=c.get(h);f||(f=new Map,c.set(h,f));const p=f.get(d)??0;f.set(d,p+1)}}if((s>0||i>0)&&(e||(e=Object.create(null)),e.comments={deleted:s,edited:i}),!e)return null;for(const[r,a]of t)e[r]=a.computeTelemetryFinalData(e[r]);return e}resetModifiedIds(){k(this,Vu,null)}updateEditor(e,t){var s;const i=(s=u(this,Mo))==null?void 0:s.get(e);return i?(i.updateFromAnnotationLayer(t),!0):!1}getEditor(e){var t;return((t=u(this,Mo))==null?void 0:t.get(e))||null}get modifiedIds(){if(u(this,Vu))return u(this,Vu);const e=[];if(u(this,Mo))for(const t of u(this,Mo).values())t.serialize()&&e.push(t.annotationElementId);return k(this,Vu,{ids:new Set(e),hash:e.join(",")})}[Symbol.iterator](){return u(this,Ci).entries()}}qu=new WeakMap,Vu=new WeakMap,Mo=new WeakMap,Ci=new WeakMap,v1=new WeakSet,UL=function(){u(this,qu)||(k(this,qu,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var L0;class HL extends SN{constructor(t){super();D(this,L0);const{map:i,hash:s,transfer:r}=t.serializable,a=structuredClone(i,r?{transfer:r}:null);k(this,L0,{map:a,hash:s,transfer:r})}get print(){zt("Should not call PrintAnnotationStorage.print")}get serializable(){return u(this,L0)}get modifiedIds(){return ht(this,"modifiedIds",{ids:new Set,hash:""})}}L0=new WeakMap;var zf;class oG{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){D(this,zf,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),u(this,zf).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:i}){if(!(!e||u(this,zf).has(e.loadedName))){if(It(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:s,src:r,style:a}=e,o=new FontFace(s,r,a);this.addNativeFontFace(o);try{await o.load(),u(this,zf).add(s),i==null||i(e)}catch{ut(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(o)}return}zt("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const i=e.createNativeFontFace();if(i){this.addNativeFontFace(i);try{await i.loaded}catch(s){throw ut(`Failed to load font '${i.family}': '${s}'.`),e.disableFontFace=!0,s}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(i=>{const s=this._queueLoadingCallback(i);this._prepareFontLoadEvent(e,s)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return ht(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return ht(this,"isSyncFontLoadingSupported",ns||li.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(It(!s.done,"completeRequest() cannot be called twice."),s.done=!0;i.length>0&&i[0].done;){const r=i.shift();setTimeout(r.callback,0)}}const{loadingRequests:i}=this,s={done:!1,complete:t,callback:e};return i.push(s),s}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return ht(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function i(E,S){return E.charCodeAt(S)<<24|E.charCodeAt(S+1)<<16|E.charCodeAt(S+2)<<8|E.charCodeAt(S+3)&255}function s(E,S,_,T){const j=E.substring(0,S),M=E.substring(S+_);return j+T+M}let r,a;const o=this._document.createElement("canvas");o.width=1,o.height=1;const c=o.getContext("2d");let h=0;function d(E,S){if(++h>30){ut("Load test font never loaded."),S();return}if(c.font="30px "+E,c.fillText(".",0,20),c.getImageData(0,0,1,1).data[3]>0){S();return}setTimeout(d.bind(null,E,S))}const f=`lt${Date.now()}${this.loadTestFontId++}`;let p=this._loadTestFont;p=s(p,976,f.length,f);const v=16,b=1482184792;let x=i(p,v);for(r=0,a=f.length-3;r<a;r+=4)x=x-b+i(f,r)|0;r<f.length&&(x=x-b+i(f+"XXX",r)|0),p=s(p,v,4,HV(x));const m=`url(data:font/opentype;base64,${btoa(p)});`,y=`@font-face {font-family:"${f}";src:${m}}`;this.insertRule(y);const w=this._document.createElement("div");w.style.visibility="hidden",w.style.width=w.style.height="10px",w.style.position="absolute",w.style.top=w.style.left="0px";for(const E of[e.loadedName,f]){const S=this._document.createElement("span");S.textContent="Hi",S.style.fontFamily=E,w.append(S)}this._document.body.append(w),d(f,()=>{w.remove(),t.complete()})}}zf=new WeakMap;var Qt;class lG{constructor(e,t=null,i,s){D(this,Qt);this.compiledGlyphs=Object.create(null),k(this,Qt,e),this._inspectFont=t,i&&Object.assign(this,i),s&&(this.charProcOperatorList=s)}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const i={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(i.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,i)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var i;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${this.data.toBase64()});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let s=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(s+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${s}src:${e}}`}return(i=this._inspectFont)==null||i.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const i=this.loadedName+"_path_"+t;let s;try{s=e.get(i)}catch(a){ut(`getPathGenerator - ignoring character: "${a}".`)}const r=aL(s==null?void 0:s.path);return this.fontExtraProperties||e.delete(i),this.compiledGlyphs[t]=r}get black(){return u(this,Qt).black}get bold(){return u(this,Qt).bold}get disableFontFace(){return u(this,Qt).disableFontFace??!1}set disableFontFace(e){ht(this,"disableFontFace",!!e)}get fontExtraProperties(){return u(this,Qt).fontExtraProperties??!1}get isInvalidPDFjsFont(){return u(this,Qt).isInvalidPDFjsFont}get isType3Font(){return u(this,Qt).isType3Font}get italic(){return u(this,Qt).italic}get missingFile(){return u(this,Qt).missingFile}get remeasure(){return u(this,Qt).remeasure}get vertical(){return u(this,Qt).vertical}get ascent(){return u(this,Qt).ascent}get defaultWidth(){return u(this,Qt).defaultWidth}get descent(){return u(this,Qt).descent}get bbox(){return u(this,Qt).bbox}set bbox(e){ht(this,"bbox",e)}get fontMatrix(){return u(this,Qt).fontMatrix}get fallbackName(){return u(this,Qt).fallbackName}get loadedName(){return u(this,Qt).loadedName}get mimetype(){return u(this,Qt).mimetype}get name(){return u(this,Qt).name}get data(){return u(this,Qt).data}clearData(){u(this,Qt).clearData()}get cssFontInfo(){return u(this,Qt).cssFontInfo}get systemFontInfo(){return u(this,Qt).systemFontInfo}get defaultVMetrics(){return u(this,Qt).defaultVMetrics}}Qt=new WeakMap;var Ff,Uf,M0,Hf,Rv;const rf=class rf{constructor(e){D(this,Hf);D(this,Ff);D(this,Uf);D(this,M0);k(this,Ff,e),k(this,Uf,new DataView(u(this,Ff))),k(this,M0,new TextDecoder)}static write(e){const t=new TextEncoder,i={};let s=0;for(const h of rf.strings){const d=t.encode(e[h]);i[h]=d,s+=4+d.length}const r=new ArrayBuffer(s),a=new Uint8Array(r),o=new DataView(r);let c=0;for(const h of rf.strings){const d=i[h],f=d.length;o.setUint32(c,f),a.set(d,c+4),c+=4+f}return It(c===r.byteLength,"CssFontInfo.write: Buffer overflow"),r}get fontFamily(){return R(this,Hf,Rv).call(this,0)}get fontWeight(){return R(this,Hf,Rv).call(this,1)}get italicAngle(){return R(this,Hf,Rv).call(this,2)}};Ff=new WeakMap,Uf=new WeakMap,M0=new WeakMap,Hf=new WeakSet,Rv=function(e){It(e<rf.strings.length,"Invalid string index");let t=0;for(let s=0;s<e;s++)t+=u(this,Uf).getUint32(t)+4;const i=u(this,Uf).getUint32(t);return u(this,M0).decode(new Uint8Array(u(this,Ff),t+4,i))},we(rf,"strings",["fontFamily","fontWeight","italicAngle"]);let s1=rf;var hc,Ia,Gu,Wu,em;const af=class af{constructor(e){D(this,Wu);D(this,hc);D(this,Ia);D(this,Gu);k(this,hc,e),k(this,Ia,new DataView(u(this,hc))),k(this,Gu,new TextDecoder)}static write(e){const t=new TextEncoder,i={};let s=0;for(const p of af.strings){const g=t.encode(e[p]);i[p]=g,s+=4+g.length}s+=4;let r,a,o=1+s;e.style&&(r=t.encode(e.style.style),a=t.encode(e.style.weight),o+=4+r.length+4+a.length);const c=new ArrayBuffer(o),h=new Uint8Array(c),d=new DataView(c);let f=0;d.setUint8(f++,e.guessFallback?1:0),d.setUint32(f,0),f+=4,s=0;for(const p of af.strings){const g=i[p],v=g.length;s+=4+v,d.setUint32(f,v),h.set(g,f+4),f+=4+v}return d.setUint32(f-s-4,s),e.style&&(d.setUint32(f,r.length),h.set(r,f+4),f+=4+r.length,d.setUint32(f,a.length),h.set(a,f+4),f+=4+a.length),It(f<=c.byteLength,"SubstitionInfo.write: Buffer overflow"),c.transferToFixedLength(f)}get guessFallback(){return u(this,Ia).getUint8(0)!==0}get css(){return R(this,Wu,em).call(this,0)}get loadedName(){return R(this,Wu,em).call(this,1)}get baseFontName(){return R(this,Wu,em).call(this,2)}get src(){return R(this,Wu,em).call(this,3)}get style(){let e=1;e+=4+u(this,Ia).getUint32(e);const t=u(this,Ia).getUint32(e),i=u(this,Gu).decode(new Uint8Array(u(this,hc),e+4,t));e+=4+t;const s=u(this,Ia).getUint32(e),r=u(this,Gu).decode(new Uint8Array(u(this,hc),e+4,s));return{style:i,weight:r}}};hc=new WeakMap,Ia=new WeakMap,Gu=new WeakMap,Wu=new WeakSet,em=function(e){It(e<af.strings.length,"Invalid string index");let t=5;for(let s=0;s<e;s++)t+=u(this,Ia).getUint32(t)+4;const i=u(this,Ia).getUint32(t);return u(this,Gu).decode(new Uint8Array(u(this,hc),t+4,i))},we(af,"strings",["css","loadedName","baseFontName","src"]);let r1=af;var $f,qf,Vf,Gf,Os,Ba,O0,Jt,Ln,Kr,Lv,tm;const xt=class xt{constructor({data:e,extra:t}){D(this,Ln);D(this,Ba);D(this,O0);D(this,Jt);k(this,Ba,e),k(this,O0,new TextDecoder),k(this,Jt,new DataView(u(this,Ba))),t&&Object.assign(this,t)}get black(){return R(this,Ln,Kr).call(this,0)}get bold(){return R(this,Ln,Kr).call(this,1)}get disableFontFace(){return R(this,Ln,Kr).call(this,2)}get fontExtraProperties(){return R(this,Ln,Kr).call(this,3)}get isInvalidPDFjsFont(){return R(this,Ln,Kr).call(this,4)}get isType3Font(){return R(this,Ln,Kr).call(this,5)}get italic(){return R(this,Ln,Kr).call(this,6)}get missingFile(){return R(this,Ln,Kr).call(this,7)}get remeasure(){return R(this,Ln,Kr).call(this,8)}get vertical(){return R(this,Ln,Kr).call(this,9)}get ascent(){return R(this,Ln,Lv).call(this,0)}get defaultWidth(){return R(this,Ln,Lv).call(this,1)}get descent(){return R(this,Ln,Lv).call(this,2)}get bbox(){let e=u(xt,qf);if(u(this,Jt).getUint8(e)===0)return;e+=1;const i=[];for(let s=0;s<4;s++)i.push(u(this,Jt).getInt16(e,!0)),e+=2;return i}get fontMatrix(){let e=u(xt,Vf);if(u(this,Jt).getUint8(e)===0)return;e+=1;const i=[];for(let s=0;s<6;s++)i.push(u(this,Jt).getFloat64(e,!0)),e+=8;return i}get defaultVMetrics(){let e=u(xt,Gf);if(u(this,Jt).getUint8(e)===0)return;e+=1;const i=[];for(let s=0;s<3;s++)i.push(u(this,Jt).getInt16(e,!0)),e+=2;return i}get fallbackName(){return R(this,Ln,tm).call(this,0)}get loadedName(){return R(this,Ln,tm).call(this,1)}get mimetype(){return R(this,Ln,tm).call(this,2)}get name(){return R(this,Ln,tm).call(this,3)}get data(){let e=u(xt,Os);const t=u(this,Jt).getUint32(e);e+=4+t;const i=u(this,Jt).getUint32(e);e+=4+i;const s=u(this,Jt).getUint32(e);e+=4+s;const r=u(this,Jt).getUint32(e);if(r!==0)return new Uint8Array(u(this,Ba),e+4,r)}clearData(){let e=u(xt,Os);const t=u(this,Jt).getUint32(e);e+=4+t;const i=u(this,Jt).getUint32(e);e+=4+i;const s=u(this,Jt).getUint32(e);e+=4+s;const r=u(this,Jt).getUint32(e);new Uint8Array(u(this,Ba),e+4,r).fill(0),u(this,Jt).setUint32(e,0)}get cssFontInfo(){let e=u(xt,Os);const t=u(this,Jt).getUint32(e);e+=4+t;const i=u(this,Jt).getUint32(e);e+=4+i;const s=u(this,Jt).getUint32(e);if(s===0)return null;const r=new Uint8Array(s);return r.set(new Uint8Array(u(this,Ba),e+4,s)),new s1(r.buffer)}get systemFontInfo(){let e=u(xt,Os);const t=u(this,Jt).getUint32(e);e+=4+t;const i=u(this,Jt).getUint32(e);if(i===0)return null;const s=new Uint8Array(i);return s.set(new Uint8Array(u(this,Ba),e+4,i)),new r1(s.buffer)}static write(e){const t=e.systemFontInfo?r1.write(e.systemFontInfo):null,i=e.cssFontInfo?s1.write(e.cssFontInfo):null,s=new TextEncoder,r={};let a=0;for(const b of xt.strings)r[b]=s.encode(e[b]),a+=4+r[b].length;const o=u(xt,Os)+4+a+4+(t?t.byteLength:0)+4+(i?i.byteLength:0)+4+(e.data?e.data.length:0),c=new ArrayBuffer(o),h=new Uint8Array(c),d=new DataView(c);let f=0;const p=xt.bools.length;let g=0,v=0;for(let b=0;b<p;b++){const x=e[xt.bools[b]];g|=(x===void 0?0:x?2:1)<<v,v+=2,(v===8||b===p-1)&&(d.setUint8(f++,g),g=0,v=0)}It(f===u(xt,$f),"FontInfo.write: Boolean properties offset mismatch");for(const b of xt.numbers)d.setFloat64(f,e[b]),f+=8;if(It(f===u(xt,qf),"FontInfo.write: Number properties offset mismatch"),e.bbox){d.setUint8(f++,4);for(const b of e.bbox)d.setInt16(f,b,!0),f+=2}else d.setUint8(f++,0),f+=2*4;if(It(f===u(xt,Vf),"FontInfo.write: BBox properties offset mismatch"),e.fontMatrix){d.setUint8(f++,6);for(const b of e.fontMatrix)d.setFloat64(f,b,!0),f+=8}else d.setUint8(f++,0),f+=8*6;if(It(f===u(xt,Gf),"FontInfo.write: FontMatrix properties offset mismatch"),e.defaultVMetrics){d.setUint8(f++,1);for(const b of e.defaultVMetrics)d.setInt16(f,b,!0),f+=2}else d.setUint8(f++,0),f+=3*2;It(f===u(xt,Os),"FontInfo.write: DefaultVMetrics properties offset mismatch"),d.setUint32(u(xt,Os),0),f+=4;for(const b of xt.strings){const x=r[b],m=x.length;d.setUint32(f,m),h.set(x,f+4),f+=4+m}if(d.setUint32(u(xt,Os),f-u(xt,Os)-4),!t)d.setUint32(f,0),f+=4;else{const b=t.byteLength;d.setUint32(f,b),It(f+4+b<=c.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),h.set(new Uint8Array(t),f+4),f+=4+b}if(!i)d.setUint32(f,0),f+=4;else{const b=i.byteLength;d.setUint32(f,b),It(f+4+b<=c.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),h.set(new Uint8Array(i),f+4),f+=4+b}return e.data===void 0?(d.setUint32(f,0),f+=4):(d.setUint32(f,e.data.length),h.set(e.data,f+4),f+=4+e.data.length),It(f<=c.byteLength,"FontInfo.write: Buffer overflow"),c.transferToFixedLength(f)}};$f=new WeakMap,qf=new WeakMap,Vf=new WeakMap,Gf=new WeakMap,Os=new WeakMap,Ba=new WeakMap,O0=new WeakMap,Jt=new WeakMap,Ln=new WeakSet,Kr=function(e){It(e<xt.bools.length,"Invalid boolean index");const t=Math.floor(e/4),i=e*2%8,s=u(this,Jt).getUint8(t)>>i&3;return s===0?void 0:s===2},Lv=function(e){return It(e<xt.numbers.length,"Invalid number index"),u(this,Jt).getFloat64(u(xt,$f)+e*8)},tm=function(e){It(e<xt.strings.length,"Invalid string index");let t=u(xt,Os)+4;for(let r=0;r<e;r++)t+=u(this,Jt).getUint32(t)+4;const i=u(this,Jt).getUint32(t),s=new Uint8Array(i);return s.set(new Uint8Array(u(this,Ba),t+4,i)),u(this,O0).decode(s)},we(xt,"bools",["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"]),we(xt,"numbers",["ascent","defaultWidth","descent"]),we(xt,"strings",["fallbackName","loadedName","mimetype","name"]),D(xt,$f,Math.ceil(xt.bools.length*2/8)),D(xt,qf,u(xt,$f)+xt.numbers.length*8),D(xt,Vf,u(xt,qf)+1+2*4),D(xt,Gf,u(xt,Vf)+1+8*6),D(xt,Os,u(xt,Gf)+1+2*3);let MA=xt;var P0,I0,B0,z0,F0,U0,H0,$0;const un=class un{constructor(e){this.buffer=e,this.view=new DataView(e),this.data=new Uint8Array(e)}static write(e){let t,i=null,s=[],r=[],a=[],o=[],c=null,h=null;switch(e[0]){case"RadialAxial":t=e[1]==="axial"?1:2,i=e[2],a=e[3],t===1?s.push(...e[4],...e[5]):s.push(e[4][0],e[4][1],e[6],e[5][0],e[5][1],e[7]);break;case"Mesh":t=3,c=e[1],s=e[2],r=e[3],o=e[4]||[],i=e[6],h=e[7];break;default:throw new Error(`Unsupported pattern type: ${e[0]}`)}const d=Math.floor(s.length/2),f=Math.floor(r.length/3),p=a.length,g=o.length;let v=0;for(const S of o)v+=1,v=Math.ceil(v/4)*4,v+=4+S.coords.length*4,v+=4+S.colors.length*4,S.verticesPerRow!==void 0&&(v+=4);const b=20+d*8+f*3+p*8+(i?16:0)+(h?3:0)+v,x=new ArrayBuffer(b),m=new DataView(x),y=new Uint8Array(x);m.setUint8(u(un,P0),t),m.setUint8(u(un,I0),i?1:0),m.setUint8(u(un,B0),h?1:0),m.setUint8(u(un,z0),c),m.setUint32(u(un,F0),d,!0),m.setUint32(u(un,U0),f,!0),m.setUint32(u(un,H0),p,!0),m.setUint32(u(un,$0),g,!0);let w=20;new Float32Array(x,w,d*2).set(s),w+=d*8,y.set(r,w),w+=f*3;for(const[S,_]of a)m.setFloat32(w,S,!0),w+=4,m.setUint32(w,parseInt(_.slice(1),16),!0),w+=4;if(i)for(const S of i)m.setFloat32(w,S,!0),w+=4;h&&(y.set(h,w),w+=3);for(let S=0;S<o.length;S++){const _=o[S];m.setUint8(w,_.type),w+=1,w=Math.ceil(w/4)*4,m.setUint32(w,_.coords.length,!0),w+=4,new Int32Array(x,w,_.coords.length).set(_.coords),w+=_.coords.length*4,m.setUint32(w,_.colors.length,!0),w+=4,new Int32Array(x,w,_.colors.length).set(_.colors),w+=_.colors.length*4,_.verticesPerRow!==void 0&&(m.setUint32(w,_.verticesPerRow,!0),w+=4)}return x}getIR(){const e=this.view,t=this.data[u(un,P0)],i=!!this.data[u(un,I0)],s=!!this.data[u(un,B0)],r=e.getUint32(u(un,F0),!0),a=e.getUint32(u(un,U0),!0),o=e.getUint32(u(un,H0),!0),c=e.getUint32(u(un,$0),!0);let h=20;const d=new Float32Array(this.buffer,h,r*2);h+=r*8;const f=new Uint8Array(this.buffer,h,a*3);h+=a*3;const p=[];for(let x=0;x<o;++x){const m=e.getFloat32(h,!0);h+=4;const y=e.getUint32(h,!0);h+=4,p.push([m,`#${y.toString(16).padStart(6,"0")}`])}let g=null;if(i){g=[];for(let x=0;x<4;++x)g.push(e.getFloat32(h,!0)),h+=4}let v=null;s&&(v=new Uint8Array(this.buffer,h,3),h+=3);const b=[];for(let x=0;x<c;++x){const m=e.getUint8(h);h+=1,h=Math.ceil(h/4)*4;const y=e.getUint32(h,!0);h+=4;const w=new Int32Array(this.buffer,h,y);h+=y*4;const E=e.getUint32(h,!0);h+=4;const S=new Int32Array(this.buffer,h,E);h+=E*4;const _={type:m,coords:w,colors:S};m===dA.LATTICE&&(_.verticesPerRow=e.getUint32(h,!0),h+=4),b.push(_)}if(t===1)return["RadialAxial","axial",g,p,Array.from(d.slice(0,2)),Array.from(d.slice(2,4)),null,null];if(t===2)return["RadialAxial","radial",g,p,[d[0],d[1]],[d[3],d[4]],d[2],d[5]];if(t===3){const x=this.data[u(un,z0)];let m=null;if(d.length>0){let y=d[0],w=d[0],E=d[1],S=d[1];for(let _=0;_<d.length;_+=2){const T=d[_],j=d[_+1];y=y>T?T:y,E=E>j?j:E,w=w<T?T:w,S=S<j?j:S}m=[y,E,w,S]}return["Mesh",x,d,f,b,m,g,v]}throw new Error(`Unsupported pattern kind: ${t}`)}};P0=new WeakMap,I0=new WeakMap,B0=new WeakMap,z0=new WeakMap,F0=new WeakMap,U0=new WeakMap,H0=new WeakMap,$0=new WeakMap,D(un,P0,0),D(un,I0,1),D(un,B0,2),D(un,z0,3),D(un,F0,4),D(un,U0,8),D(un,H0,12),D(un,$0,16);let OA=un;var Wf;class cG{constructor(e){D(this,Wf);k(this,Wf,e)}static write(e){let t,i;return li.isFloat16ArraySupported?(i=new ArrayBuffer(e.length*2),t=new Float16Array(i)):(i=new ArrayBuffer(e.length*4),t=new Float32Array(i)),t.set(e),i}get path(){return li.isFloat16ArraySupported?new Float16Array(u(this,Wf)):new Float32Array(u(this,Wf))}}Wf=new WeakMap;function uG(n){if(n instanceof URL)return n.href;if(typeof n=="string"){if(ns)return n;const e=URL.parse(n,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function hG(n){if(ns&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return yw(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n==null?void 0:n.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Qy(n){if(typeof n!="string")return null;if(n.endsWith("/"))return n;throw new Error(`Invalid factory url: "${n}" must include trailing slash.`)}const PA=n=>typeof n=="object"&&Number.isInteger(n==null?void 0:n.num)&&n.num>=0&&Number.isInteger(n==null?void 0:n.gen)&&n.gen>=0,dG=n=>typeof n=="object"&&typeof(n==null?void 0:n.name)=="string",fG=WV.bind(null,PA,dG);var Oo,b1;class pG{constructor(){D(this,Oo,new Map);D(this,b1,Promise.resolve())}postMessage(e,t){const i={data:structuredClone(e,t?{transfer:t}:null)};u(this,b1).then(()=>{for(const[s]of u(this,Oo))s.call(this,i)})}addEventListener(e,t,i=null){let s=null;if((i==null?void 0:i.signal)instanceof AbortSignal){const{signal:r}=i;if(r.aborted){ut("LoopbackPort - cannot use an `aborted` signal.");return}const a=()=>this.removeEventListener(e,t);s=()=>r.removeEventListener("abort",a),r.addEventListener("abort",a)}u(this,Oo).set(t,s)}removeEventListener(e,t){const i=u(this,Oo).get(t);i==null||i(),u(this,Oo).delete(t)}terminate(){for(const[,e]of u(this,Oo))e==null||e();u(this,Oo).clear()}}Oo=new WeakMap,b1=new WeakMap;const Jy={DATA:1,ERROR:2},Wn={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function nD(){}function us(n){if(n instanceof au||n instanceof fA||n instanceof YT||n instanceof e1||n instanceof B2)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||zt('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new au(n.message);case"InvalidPDFException":return new fA(n.message);case"PasswordException":return new YT(n.message,n.code);case"ResponseException":return new e1(n.message,n.status,n.missing);case"UnknownErrorException":return new B2(n.message,n.details)}return new B2(n.message,n.toString())}var Yf,Hr,$L,qL,VL,Mv;class nm{constructor(e,t,i){D(this,Hr);D(this,Yf,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),i.addEventListener("message",R(this,Hr,$L).bind(this),{signal:u(this,Yf).signal})}on(e,t){const i=this.actionHandler;if(i[e])throw new Error(`There is already an actionName called "${e}"`);i[e]=t}send(e,t,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},i)}sendWithPromise(e,t,i){const s=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[s]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:s,data:t},i)}catch(a){r.reject(a)}return r.promise}sendWithStream(e,t,i,s){const r=this.streamId++,a=this.sourceName,o=this.targetName,c=this.comObj;return new ReadableStream({start:h=>{const d=Promise.withResolvers();return this.streamControllers[r]={controller:h,startCall:d,pullCall:null,cancelCall:null,isClosed:!1},c.postMessage({sourceName:a,targetName:o,action:e,streamId:r,data:t,desiredSize:h.desiredSize},s),d.promise},pull:h=>{const d=Promise.withResolvers();return this.streamControllers[r].pullCall=d,c.postMessage({sourceName:a,targetName:o,stream:Wn.PULL,streamId:r,desiredSize:h.desiredSize}),d.promise},cancel:h=>{It(h instanceof Error,"cancel must have a valid reason");const d=Promise.withResolvers();return this.streamControllers[r].cancelCall=d,this.streamControllers[r].isClosed=!0,c.postMessage({sourceName:a,targetName:o,stream:Wn.CANCEL,streamId:r,reason:us(h)}),d.promise}},i)}destroy(){var e;(e=u(this,Yf))==null||e.abort(),k(this,Yf,null)}}Yf=new WeakMap,Hr=new WeakSet,$L=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){R(this,Hr,VL).call(this,e);return}if(e.callback){const i=e.callbackId,s=this.callbackCapabilities[i];if(!s)throw new Error(`Cannot resolve callback ${i}`);if(delete this.callbackCapabilities[i],e.callback===Jy.DATA)s.resolve(e.data);else if(e.callback===Jy.ERROR)s.reject(us(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const i=this.sourceName,s=e.sourceName,r=this.comObj;Promise.try(t,e.data).then(function(a){r.postMessage({sourceName:i,targetName:s,callback:Jy.DATA,callbackId:e.callbackId,data:a})},function(a){r.postMessage({sourceName:i,targetName:s,callback:Jy.ERROR,callbackId:e.callbackId,reason:us(a)})});return}if(e.streamId){R(this,Hr,qL).call(this,e);return}t(e.data)},qL=function(e){const t=e.streamId,i=this.sourceName,s=e.sourceName,r=this.comObj,a=this,o=this.actionHandler[e.action],c={enqueue(h,d=1,f){if(this.isCancelled)return;const p=this.desiredSize;this.desiredSize-=d,p>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:i,targetName:s,stream:Wn.ENQUEUE,streamId:t,chunk:h},f)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:i,targetName:s,stream:Wn.CLOSE,streamId:t}),delete a.streamSinks[t])},error(h){It(h instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,r.postMessage({sourceName:i,targetName:s,stream:Wn.ERROR,streamId:t,reason:us(h)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};c.sinkCapability.resolve(),c.ready=c.sinkCapability.promise,this.streamSinks[t]=c,Promise.try(o,e.data,c).then(function(){r.postMessage({sourceName:i,targetName:s,stream:Wn.START_COMPLETE,streamId:t,success:!0})},function(h){r.postMessage({sourceName:i,targetName:s,stream:Wn.START_COMPLETE,streamId:t,reason:us(h)})})},VL=function(e){const t=e.streamId,i=this.sourceName,s=e.sourceName,r=this.comObj,a=this.streamControllers[t],o=this.streamSinks[t];switch(e.stream){case Wn.START_COMPLETE:e.success?a.startCall.resolve():a.startCall.reject(us(e.reason));break;case Wn.PULL_COMPLETE:e.success?a.pullCall.resolve():a.pullCall.reject(us(e.reason));break;case Wn.PULL:if(!o){r.postMessage({sourceName:i,targetName:s,stream:Wn.PULL_COMPLETE,streamId:t,success:!0});break}o.desiredSize<=0&&e.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=e.desiredSize,Promise.try(o.onPull||nD).then(function(){r.postMessage({sourceName:i,targetName:s,stream:Wn.PULL_COMPLETE,streamId:t,success:!0})},function(h){r.postMessage({sourceName:i,targetName:s,stream:Wn.PULL_COMPLETE,streamId:t,reason:us(h)})});break;case Wn.ENQUEUE:if(It(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(e.chunk);break;case Wn.CLOSE:if(It(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),R(this,Hr,Mv).call(this,a,t);break;case Wn.ERROR:It(a,"error should have stream controller"),a.controller.error(us(e.reason)),R(this,Hr,Mv).call(this,a,t);break;case Wn.CANCEL_COMPLETE:e.success?a.cancelCall.resolve():a.cancelCall.reject(us(e.reason)),R(this,Hr,Mv).call(this,a,t);break;case Wn.CANCEL:if(!o)break;const c=us(e.reason);Promise.try(o.onCancel||nD,c).then(function(){r.postMessage({sourceName:i,targetName:s,stream:Wn.CANCEL_COMPLETE,streamId:t,success:!0})},function(h){r.postMessage({sourceName:i,targetName:s,stream:Wn.CANCEL_COMPLETE,streamId:t,reason:us(h)})}),o.sinkCapability.reject(c),o.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},Mv=async function(e,t){var i,s,r;await Promise.allSettled([(i=e.startCall)==null?void 0:i.promise,(s=e.pullCall)==null?void 0:s.promise,(r=e.cancelCall)==null?void 0:r.promise]),delete this.streamControllers[t]};var q0;class GL{constructor({enableHWA:e=!1}){D(this,q0,!1);k(this,q0,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(e,t);return{canvas:i,context:i.getContext("2d",{willReadFrequently:!u(this,q0)})}}reset(e,t,i){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||i<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=i}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){zt("Abstract method `_createCanvas` called.")}}q0=new WeakMap;class gG extends GL{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const i=this._document.createElement("canvas");return i.width=e,i.height=t,i}}class WL{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(i=>({cMapData:i,isCompressed:this.isCompressed})).catch(i=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){zt("Abstract method `_fetch` called.")}}class iD extends WL{async _fetch(e){const t=await wy(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):yw(t)}}class YL{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,i,s,r){return"none"}destroy(e=!1){}}var Yu,Xf,Po,Io,qi,Xu,Ku,Ge,Fi,im,Pd,Ov,Id,XL,IA,Bd,sm,rm,BA,am;class mG extends YL{constructor({docId:t,ownerDocument:i=globalThis.document}){super();D(this,Ge);D(this,Yu);D(this,Xf);D(this,Po);D(this,Io);D(this,qi);D(this,Xu);D(this,Ku,0);k(this,Io,t),k(this,qi,i)}addFilter(t){if(!t)return"none";let i=u(this,Ge,Fi).get(t);if(i)return i;const[s,r,a]=R(this,Ge,Ov).call(this,t),o=t.length===1?s:`${s}${r}${a}`;if(i=u(this,Ge,Fi).get(o),i)return u(this,Ge,Fi).set(t,i),i;const c=`g_${u(this,Io)}_transfer_map_${ni(this,Ku)._++}`,h=R(this,Ge,Id).call(this,c);u(this,Ge,Fi).set(t,h),u(this,Ge,Fi).set(o,h);const d=R(this,Ge,Bd).call(this,c);return R(this,Ge,rm).call(this,s,r,a,d),h}addHCMFilter(t,i){var v;const s=`${t}-${i}`,r="base";let a=u(this,Ge,im).get(r);if((a==null?void 0:a.key)===s||(a?((v=a.filter)==null||v.remove(),a.key=s,a.url="none",a.filter=null):(a={key:s,url:"none",filter:null},u(this,Ge,im).set(r,a)),!t||!i))return a.url;const o=R(this,Ge,am).call(this,t);t=$e.makeHexColor(...o);const c=R(this,Ge,am).call(this,i);if(i=$e.makeHexColor(...c),u(this,Ge,Pd).style.color="",t==="#000000"&&i==="#ffffff"||t===i)return a.url;const h=new Array(256);for(let b=0;b<=255;b++){const x=b/255;h[b]=x<=.03928?x/12.92:((x+.055)/1.055)**2.4}const d=h.join(","),f=`g_${u(this,Io)}_hcm_filter`,p=a.filter=R(this,Ge,Bd).call(this,f);R(this,Ge,rm).call(this,d,d,d,p),R(this,Ge,IA).call(this,p);const g=(b,x)=>{const m=o[b]/255,y=c[b]/255,w=new Array(x+1);for(let E=0;E<=x;E++)w[E]=m+E/x*(y-m);return w.join(",")};return R(this,Ge,rm).call(this,g(0,5),g(1,5),g(2,5),p),a.url=R(this,Ge,Id).call(this,f),a.url}addAlphaFilter(t){let i=u(this,Ge,Fi).get(t);if(i)return i;const[s]=R(this,Ge,Ov).call(this,[t]),r=`alpha_${s}`;if(i=u(this,Ge,Fi).get(r),i)return u(this,Ge,Fi).set(t,i),i;const a=`g_${u(this,Io)}_alpha_map_${ni(this,Ku)._++}`,o=R(this,Ge,Id).call(this,a);u(this,Ge,Fi).set(t,o),u(this,Ge,Fi).set(r,o);const c=R(this,Ge,Bd).call(this,a);return R(this,Ge,BA).call(this,s,c),o}addLuminosityFilter(t){let i=u(this,Ge,Fi).get(t||"luminosity");if(i)return i;let s,r;if(t?([s]=R(this,Ge,Ov).call(this,[t]),r=`luminosity_${s}`):r="luminosity",i=u(this,Ge,Fi).get(r),i)return u(this,Ge,Fi).set(t,i),i;const a=`g_${u(this,Io)}_luminosity_map_${ni(this,Ku)._++}`,o=R(this,Ge,Id).call(this,a);u(this,Ge,Fi).set(t,o),u(this,Ge,Fi).set(r,o);const c=R(this,Ge,Bd).call(this,a);return R(this,Ge,XL).call(this,c),t&&R(this,Ge,BA).call(this,s,c),o}addHighlightHCMFilter(t,i,s,r,a){var y;const o=`${i}-${s}-${r}-${a}`;let c=u(this,Ge,im).get(t);if((c==null?void 0:c.key)===o||(c?((y=c.filter)==null||y.remove(),c.key=o,c.url="none",c.filter=null):(c={key:o,url:"none",filter:null},u(this,Ge,im).set(t,c)),!i||!s))return c.url;const[h,d]=[i,s].map(R(this,Ge,am).bind(this));let f=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),p=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),[g,v]=[r,a].map(R(this,Ge,am).bind(this));p<f&&([f,p,g,v]=[p,f,v,g]),u(this,Ge,Pd).style.color="";const b=(w,E,S)=>{const _=new Array(256),T=(p-f)/S,j=w/255,M=(E-w)/(255*S);let L=0;for(let O=0;O<=S;O++){const B=Math.round(f+O*T),G=j+O*M;for(let W=L;W<=B;W++)_[W]=G;L=B+1}for(let O=L;O<256;O++)_[O]=_[L-1];return _.join(",")},x=`g_${u(this,Io)}_hcm_${t}_filter`,m=c.filter=R(this,Ge,Bd).call(this,x);return R(this,Ge,IA).call(this,m),R(this,Ge,rm).call(this,b(g[0],v[0],5),b(g[1],v[1],5),b(g[2],v[2],5),m),c.url=R(this,Ge,Id).call(this,x),c.url}destroy(t=!1){var i,s,r,a;t&&((i=u(this,Xu))!=null&&i.size)||((s=u(this,Po))==null||s.parentNode.parentNode.remove(),k(this,Po,null),(r=u(this,Xf))==null||r.clear(),k(this,Xf,null),(a=u(this,Xu))==null||a.clear(),k(this,Xu,null),k(this,Ku,0))}}Yu=new WeakMap,Xf=new WeakMap,Po=new WeakMap,Io=new WeakMap,qi=new WeakMap,Xu=new WeakMap,Ku=new WeakMap,Ge=new WeakSet,Fi=function(){return u(this,Xf)||k(this,Xf,new Map)},im=function(){return u(this,Xu)||k(this,Xu,new Map)},Pd=function(){if(!u(this,Po)){const t=u(this,qi).createElement("div"),{style:i}=t;i.visibility="hidden",i.contain="strict",i.width=i.height=0,i.position="absolute",i.top=i.left=0,i.zIndex=-1;const s=u(this,qi).createElementNS(xo,"svg");s.setAttribute("width",0),s.setAttribute("height",0),k(this,Po,u(this,qi).createElementNS(xo,"defs")),t.append(s),s.append(u(this,Po)),u(this,qi).body.append(t)}return u(this,Po)},Ov=function(t){if(t.length===1){const h=t[0],d=new Array(256);for(let p=0;p<256;p++)d[p]=h[p]/255;const f=d.join(",");return[f,f,f]}const[i,s,r]=t,a=new Array(256),o=new Array(256),c=new Array(256);for(let h=0;h<256;h++)a[h]=i[h]/255,o[h]=s[h]/255,c[h]=r[h]/255;return[a.join(","),o.join(","),c.join(",")]},Id=function(t){if(u(this,Yu)===void 0){k(this,Yu,"");const i=u(this,qi).URL;i!==u(this,qi).baseURI&&(bw(i)?ut('#createUrl: ignore "data:"-URL for performance reasons.'):k(this,Yu,nL(i,"")))}return`url(${u(this,Yu)}#${t})`},XL=function(t){const i=u(this,qi).createElementNS(xo,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(i)},IA=function(t){const i=u(this,qi).createElementNS(xo,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(i)},Bd=function(t){const i=u(this,qi).createElementNS(xo,"filter");return i.setAttribute("color-interpolation-filters","sRGB"),i.setAttribute("id",t),u(this,Ge,Pd).append(i),i},sm=function(t,i,s){const r=u(this,qi).createElementNS(xo,i);r.setAttribute("type","discrete"),r.setAttribute("tableValues",s),t.append(r)},rm=function(t,i,s,r){const a=u(this,qi).createElementNS(xo,"feComponentTransfer");r.append(a),R(this,Ge,sm).call(this,a,"feFuncR",t),R(this,Ge,sm).call(this,a,"feFuncG",i),R(this,Ge,sm).call(this,a,"feFuncB",s)},BA=function(t,i){const s=u(this,qi).createElementNS(xo,"feComponentTransfer");i.append(s),R(this,Ge,sm).call(this,s,"feFuncA",t)},am=function(t){return u(this,Ge,Pd).style.color=t,Ay(getComputedStyle(u(this,Ge,Pd)).getPropertyValue("color"))};class KL{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(i=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){zt("Abstract method `_fetch` called.")}}class sD extends KL{async _fetch(e){const t=await wy(e,"arraybuffer");return new Uint8Array(t)}}class ZL{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(i=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){zt("Abstract method `_fetch` called.")}}class rD extends ZL{async _fetch(e){const t=await wy(e,"arraybuffer");return new Uint8Array(t)}}ns&&ut("Please use the `legacy` build in Node.js environments.");async function AN(n){const t=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(t)}class xG extends YL{}class yG extends GL{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class vG extends WL{async _fetch(e){return AN(e)}}class bG extends KL{async _fetch(e){return AN(e)}}class wG extends ZL{async _fetch(e){return AN(e)}}const Cd="__forcedDependency",{floor:aD,ceil:oD}=Math;function ev(n,e,t,i,s,r){n[e*4+0]=Math.min(n[e*4+0],t),n[e*4+1]=Math.min(n[e*4+1],i),n[e*4+2]=Math.max(n[e*4+2],s),n[e*4+3]=Math.max(n[e*4+3],r)}const zA=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];var Kf,dc;class SG{constructor(e,t){D(this,Kf);D(this,dc);k(this,Kf,e),k(this,dc,t)}get length(){return u(this,Kf).length}isEmpty(e){return u(this,Kf)[e]===zA}minX(e){return u(this,dc)[e*4+0]/256}minY(e){return u(this,dc)[e*4+1]/256}maxX(e){return(u(this,dc)[e*4+2]+1)/256}maxY(e){return(u(this,dc)[e*4+3]+1)/256}}Kf=new WeakMap,dc=new WeakMap;const tv=(n,e)=>{if(!n)return;let t=n.get(e);return t||(t={dependencies:new Set,isRenderingOperation:!1},n.set(e,t)),t};var fs,ps,Zu,na,Qu,Bo,Gt,en,zo,gs,V0,Zf,Ju,eh,Fo,Vi,za,G0,FA;class AG{constructor(e,t,i=!1){D(this,G0);D(this,fs,{__proto__:null});D(this,ps,{__proto__:null,transform:[],moveText:[],sameLineText:[],[Cd]:[]});D(this,Zu,new Map);D(this,na,[]);D(this,Qu,[]);D(this,Bo,[[1,0,0,1,0,0]]);D(this,Gt,[-1/0,-1/0,1/0,1/0]);D(this,en,new Float64Array([1/0,1/0,-1/0,-1/0]));D(this,zo,-1);D(this,gs,new Set);D(this,V0,new Map);D(this,Zf,new Map);D(this,Ju);D(this,eh);D(this,Fo);D(this,Vi);D(this,za);k(this,Ju,e.width),k(this,eh,e.height),R(this,G0,FA).call(this,t),i&&k(this,za,new Map)}growOperationsCount(e){e>=u(this,Vi).length&&R(this,G0,FA).call(this,e,u(this,Vi))}save(e){return k(this,fs,{__proto__:u(this,fs)}),k(this,ps,{__proto__:u(this,ps),transform:{__proto__:u(this,ps).transform},moveText:{__proto__:u(this,ps).moveText},sameLineText:{__proto__:u(this,ps).sameLineText},[Cd]:{__proto__:u(this,ps)[Cd]}}),k(this,Gt,{__proto__:u(this,Gt)}),u(this,na).push(e),this}restore(e){var s;const t=Object.getPrototypeOf(u(this,fs));if(t===null)return this;k(this,fs,t),k(this,ps,Object.getPrototypeOf(u(this,ps))),k(this,Gt,Object.getPrototypeOf(u(this,Gt)));const i=u(this,na).pop();return i!==void 0&&((s=tv(u(this,za),e))==null||s.dependencies.add(i),u(this,Vi)[e]=u(this,Vi)[i]),this}recordOpenMarker(e){return u(this,na).push(e),this}getOpenMarker(){return u(this,na).length===0?null:u(this,na).at(-1)}recordCloseMarker(e){var i;const t=u(this,na).pop();return t!==void 0&&((i=tv(u(this,za),e))==null||i.dependencies.add(t),u(this,Vi)[e]=u(this,Vi)[t]),this}beginMarkedContent(e){return u(this,Qu).push(e),this}endMarkedContent(e){var i;const t=u(this,Qu).pop();return t!==void 0&&((i=tv(u(this,za),e))==null||i.dependencies.add(t),u(this,Vi)[e]=u(this,Vi)[t]),this}pushBaseTransform(e){return u(this,Bo).push($e.multiplyByDOMMatrix(u(this,Bo).at(-1),e.getTransform())),this}popBaseTransform(){return u(this,Bo).length>1&&u(this,Bo).pop(),this}recordSimpleData(e,t){return u(this,fs)[e]=t,this}recordIncrementalData(e,t){return u(this,ps)[e].push(t),this}resetIncrementalData(e,t){return u(this,ps)[e].length=0,this}recordNamedData(e,t){return u(this,Zu).set(e,t),this}recordSimpleDataFromNamed(e,t,i){u(this,fs)[e]=u(this,Zu).get(t)??i}recordFutureForcedDependency(e,t){return this.recordIncrementalData(Cd,t),this}inheritSimpleDataAsFutureForcedDependencies(e){for(const t of e)t in u(this,fs)&&this.recordFutureForcedDependency(t,u(this,fs)[t]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const e of u(this,gs))this.recordFutureForcedDependency(Cd,e);return this}resetBBox(e){return u(this,zo)!==e&&(k(this,zo,e),u(this,en)[0]=1/0,u(this,en)[1]=1/0,u(this,en)[2]=-1/0,u(this,en)[3]=-1/0),this}recordClipBox(e,t,i,s,r,a){const o=$e.multiplyByDOMMatrix(u(this,Bo).at(-1),t.getTransform()),c=[1/0,1/0,-1/0,-1/0];$e.axialAlignedBoundingBox([i,r,s,a],o,c);const h=$e.intersect(u(this,Gt),c);return h?(u(this,Gt)[0]=h[0],u(this,Gt)[1]=h[1],u(this,Gt)[2]=h[2],u(this,Gt)[3]=h[3]):(u(this,Gt)[0]=u(this,Gt)[1]=1/0,u(this,Gt)[2]=u(this,Gt)[3]=-1/0),this}recordBBox(e,t,i,s,r,a){const o=u(this,Gt);if(o[0]===1/0)return this;const c=$e.multiplyByDOMMatrix(u(this,Bo).at(-1),t.getTransform());if(o[0]===-1/0)return $e.axialAlignedBoundingBox([i,r,s,a],c,u(this,en)),this;const h=[1/0,1/0,-1/0,-1/0];return $e.axialAlignedBoundingBox([i,r,s,a],c,h),u(this,en)[0]=Math.min(u(this,en)[0],Math.max(h[0],o[0])),u(this,en)[1]=Math.min(u(this,en)[1],Math.max(h[1],o[1])),u(this,en)[2]=Math.max(u(this,en)[2],Math.min(h[2],o[2])),u(this,en)[3]=Math.max(u(this,en)[3],Math.min(h[3],o[3])),this}recordCharacterBBox(e,t,i,s=1,r=0,a=0,o){const c=i.bbox;let h,d;if(c&&(h=c[2]!==c[0]&&c[3]!==c[1]&&u(this,Zf).get(i),h!==!1&&(d=[0,0,0,0],$e.axialAlignedBoundingBox(c,i.fontMatrix,d),(s!==1||r!==0||a!==0)&&$e.scaleMinMax([s,0,0,-s,r,a],d),h)))return this.recordBBox(e,t,d[0],d[2],d[1],d[3]);if(!o)return this.recordFullPageBBox(e);const f=o();return c&&d&&h===void 0&&(h=d[0]<=r-f.actualBoundingBoxLeft&&d[2]>=r+f.actualBoundingBoxRight&&d[1]<=a-f.actualBoundingBoxAscent&&d[3]>=a+f.actualBoundingBoxDescent,u(this,Zf).set(i,h),h)?this.recordBBox(e,t,d[0],d[2],d[1],d[3]):this.recordBBox(e,t,r-f.actualBoundingBoxLeft,r+f.actualBoundingBoxRight,a-f.actualBoundingBoxAscent,a+f.actualBoundingBoxDescent)}recordFullPageBBox(e){return u(this,en)[0]=Math.max(0,u(this,Gt)[0]),u(this,en)[1]=Math.max(0,u(this,Gt)[1]),u(this,en)[2]=Math.min(u(this,Ju),u(this,Gt)[2]),u(this,en)[3]=Math.min(u(this,eh),u(this,Gt)[3]),this}getSimpleIndex(e){return u(this,fs)[e]}recordDependencies(e,t){const i=u(this,gs),s=u(this,fs),r=u(this,ps);for(const a of t)a in u(this,fs)?i.add(s[a]):a in r&&r[a].forEach(i.add,i);return this}recordNamedDependency(e,t){return u(this,Zu).has(t)&&u(this,gs).add(u(this,Zu).get(t)),this}recordOperation(e,t=!1){if(this.recordDependencies(e,[Cd]),u(this,za)){const i=tv(u(this,za),e),{dependencies:s}=i;u(this,gs).forEach(s.add,s),u(this,na).forEach(s.add,s),u(this,Qu).forEach(s.add,s),s.delete(e),i.isRenderingOperation=!0}if(u(this,zo)===e){const i=aD(u(this,en)[0]*256/u(this,Ju)),s=aD(u(this,en)[1]*256/u(this,eh)),r=oD(u(this,en)[2]*256/u(this,Ju)),a=oD(u(this,en)[3]*256/u(this,eh));ev(u(this,Fo),e,i,s,r,a);for(const o of u(this,gs))o!==e&&ev(u(this,Fo),o,i,s,r,a);for(const o of u(this,na))o!==e&&ev(u(this,Fo),o,i,s,r,a);for(const o of u(this,Qu))o!==e&&ev(u(this,Fo),o,i,s,r,a);t||(u(this,gs).clear(),k(this,zo,-1))}return this}recordShowTextOperation(e,t=!1){const i=Array.from(u(this,gs));this.recordOperation(e,t),this.recordIncrementalData("sameLineText",e);for(const s of i)this.recordIncrementalData("sameLineText",s);return this}bboxToClipBoxDropOperation(e,t=!1){return u(this,zo)===e&&(k(this,zo,-1),u(this,Gt)[0]=Math.max(u(this,Gt)[0],u(this,en)[0]),u(this,Gt)[1]=Math.max(u(this,Gt)[1],u(this,en)[1]),u(this,Gt)[2]=Math.min(u(this,Gt)[2],u(this,en)[2]),u(this,Gt)[3]=Math.min(u(this,Gt)[3],u(this,en)[3]),t||u(this,gs).clear()),this}_takePendingDependencies(){const e=u(this,gs);return k(this,gs,new Set),e}_extractOperation(e){const t=u(this,V0).get(e);return u(this,V0).delete(e),t}_pushPendingDependencies(e){for(const t of e)u(this,gs).add(t)}take(){return u(this,Zf).clear(),new SG(u(this,Vi),u(this,Fo))}takeDebugMetadata(){return u(this,za)}}fs=new WeakMap,ps=new WeakMap,Zu=new WeakMap,na=new WeakMap,Qu=new WeakMap,Bo=new WeakMap,Gt=new WeakMap,en=new WeakMap,zo=new WeakMap,gs=new WeakMap,V0=new WeakMap,Zf=new WeakMap,Ju=new WeakMap,eh=new WeakMap,Fo=new WeakMap,Vi=new WeakMap,za=new WeakMap,G0=new WeakSet,FA=function(e,t){const i=new ArrayBuffer(e*4);k(this,Fo,new Uint8ClampedArray(i)),k(this,Vi,new Uint32Array(i)),t&&t.length>0?(u(this,Vi).set(t),u(this,Vi).fill(zA,t.length)):u(this,Vi).fill(zA)};var an,Dn,ia,Qf,Jf;const LN=class LN{constructor(e,t,i){D(this,an);D(this,Dn);D(this,ia);D(this,Qf,0);D(this,Jf,0);if(e instanceof LN&&u(e,ia)===!!i)return e;k(this,an,e),k(this,Dn,t),k(this,ia,!!i)}growOperationsCount(){throw new Error("Unreachable")}save(e){return ni(this,Jf)._++,u(this,an).save(u(this,Dn)),this}restore(e){return u(this,Jf)>0&&(u(this,an).restore(u(this,Dn)),ni(this,Jf)._--),this}recordOpenMarker(e){return ni(this,Qf)._++,this}getOpenMarker(){return u(this,Qf)>0?u(this,Dn):u(this,an).getOpenMarker()}recordCloseMarker(e){return ni(this,Qf)._--,this}beginMarkedContent(e){return this}endMarkedContent(e){return this}pushBaseTransform(e){return u(this,an).pushBaseTransform(e),this}popBaseTransform(){return u(this,an).popBaseTransform(),this}recordSimpleData(e,t){return u(this,an).recordSimpleData(e,u(this,Dn)),this}recordIncrementalData(e,t){return u(this,an).recordIncrementalData(e,u(this,Dn)),this}resetIncrementalData(e,t){return u(this,an).resetIncrementalData(e,u(this,Dn)),this}recordNamedData(e,t){return this}recordSimpleDataFromNamed(e,t,i){return u(this,an).recordSimpleDataFromNamed(e,t,u(this,Dn)),this}recordFutureForcedDependency(e,t){return u(this,an).recordFutureForcedDependency(e,u(this,Dn)),this}inheritSimpleDataAsFutureForcedDependencies(e){return u(this,an).inheritSimpleDataAsFutureForcedDependencies(e),this}inheritPendingDependenciesAsFutureForcedDependencies(){return u(this,an).inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(e){return u(this,ia)||u(this,an).resetBBox(u(this,Dn)),this}recordClipBox(e,t,i,s,r,a){return u(this,ia)||u(this,an).recordClipBox(u(this,Dn),t,i,s,r,a),this}recordBBox(e,t,i,s,r,a){return u(this,ia)||u(this,an).recordBBox(u(this,Dn),t,i,s,r,a),this}recordCharacterBBox(e,t,i,s,r,a,o){return u(this,ia)||u(this,an).recordCharacterBBox(u(this,Dn),t,i,s,r,a,o),this}recordFullPageBBox(e){return u(this,ia)||u(this,an).recordFullPageBBox(u(this,Dn)),this}getSimpleIndex(e){return u(this,an).getSimpleIndex(e)}recordDependencies(e,t){return u(this,an).recordDependencies(u(this,Dn),t),this}recordNamedDependency(e,t){return u(this,an).recordNamedDependency(u(this,Dn),t),this}recordOperation(e){return u(this,an).recordOperation(u(this,Dn),!0),this}recordShowTextOperation(e){return u(this,an).recordShowTextOperation(u(this,Dn),!0),this}bboxToClipBoxDropOperation(e){return u(this,ia)||u(this,an).bboxToClipBoxDropOperation(u(this,Dn),!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}};an=new WeakMap,Dn=new WeakMap,ia=new WeakMap,Qf=new WeakMap,Jf=new WeakMap;let a1=LN;const mr={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},Di={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function UA(n,e){if(!e)return;const t=e[2]-e[0],i=e[3]-e[1],s=new Path2D;s.rect(e[0],e[1],t,i),n.clip(s)}class EN{isModifyingCurrentTransform(){return!1}getPattern(){zt("Abstract method `getPattern` called.")}}class EG extends EN{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}isOriginBased(){return this._p0[0]===0&&this._p0[1]===0&&(!this.isRadial()||this._p1[0]===0&&this._p1[1]===0)}isRadial(){return this._type==="radial"}_createGradient(e,t=null){let i,s=this._p0,r=this._p1;if(t&&(s=s.slice(),r=r.slice(),$e.applyTransform(s,t),$e.applyTransform(r,t)),this._type==="axial")i=e.createLinearGradient(s[0],s[1],r[0],r[1]);else if(this._type==="radial"){let a=this._r0,o=this._r1;if(t){const c=new Float32Array(2);$e.singularValueDecompose2dScale(t,c),a*=c[0],o*=c[0]}i=e.createRadialGradient(s[0],s[1],a,r[0],r[1],o)}for(const a of this._colorStops)i.addColorStop(a[0],a[1]);return i}getPattern(e,t,i,s){let r;if(s===Di.STROKE||s===Di.FILL){if(this.isOriginBased()){let p=$e.transform(i,t.baseTransform);this.matrix&&(p=$e.transform(p,this.matrix));const g=.001,v=Math.hypot(p[0],p[1]),b=Math.hypot(p[2],p[3]),x=(p[0]*p[2]+p[1]*p[3])/(v*b);if(Math.abs(x)<g)if(this.isRadial()){if(Math.abs(v-b)<g)return this._createGradient(e,p)}else return this._createGradient(e,p)}const a=t.current.getClippedPathBoundingBox(s,Nn(e))||[0,0,0,0],o=Math.ceil(a[2]-a[0])||1,c=Math.ceil(a[3]-a[1])||1,h=t.cachedCanvases.getCanvas("pattern",o,c),d=h.context;d.clearRect(0,0,d.canvas.width,d.canvas.height),d.beginPath(),d.rect(0,0,d.canvas.width,d.canvas.height),d.translate(-a[0],-a[1]),i=$e.transform(i,[1,0,0,1,a[0],a[1]]),d.transform(...t.baseTransform),this.matrix&&d.transform(...this.matrix),UA(d,this._bbox),d.fillStyle=this._createGradient(d),d.fill(),r=e.createPattern(h.canvas,"no-repeat");const f=new DOMMatrix(i);r.setTransform(f)}else UA(e,this._bbox),r=this._createGradient(e);return r}}function U2(n,e,t,i,s,r,a,o){const c=e.coords,h=e.colors,d=n.data,f=n.width*4;let p;c[t+1]>c[i+1]&&(p=t,t=i,i=p,p=r,r=a,a=p),c[i+1]>c[s+1]&&(p=i,i=s,s=p,p=a,a=o,o=p),c[t+1]>c[i+1]&&(p=t,t=i,i=p,p=r,r=a,a=p);const g=(c[t]+e.offsetX)*e.scaleX,v=(c[t+1]+e.offsetY)*e.scaleY,b=(c[i]+e.offsetX)*e.scaleX,x=(c[i+1]+e.offsetY)*e.scaleY,m=(c[s]+e.offsetX)*e.scaleX,y=(c[s+1]+e.offsetY)*e.scaleY;if(v>=y)return;const w=h[r],E=h[r+1],S=h[r+2],_=h[a],T=h[a+1],j=h[a+2],M=h[o],L=h[o+1],O=h[o+2],B=Math.round(v),G=Math.round(y);let W,J,V,H,P,Y,ge,ae;for(let ee=B;ee<=G;ee++){if(ee<x){const re=ee<v?0:(v-ee)/(v-x);W=g-(g-b)*re,J=w-(w-_)*re,V=E-(E-T)*re,H=S-(S-j)*re}else{let re;ee>y?re=1:x===y?re=0:re=(x-ee)/(x-y),W=b-(b-m)*re,J=_-(_-M)*re,V=T-(T-L)*re,H=j-(j-O)*re}let le;ee<v?le=0:ee>y?le=1:le=(v-ee)/(v-y),P=g-(g-m)*le,Y=w-(w-M)*le,ge=E-(E-L)*le,ae=S-(S-O)*le;const ie=Math.round(Math.min(W,P)),Q=Math.round(Math.max(W,P));let Z=f*ee+ie*4;for(let re=ie;re<=Q;re++)le=(W-re)/(W-P),le<0?le=0:le>1&&(le=1),d[Z++]=J-(J-Y)*le|0,d[Z++]=V-(V-ge)*le|0,d[Z++]=H-(H-ae)*le|0,d[Z++]=255}}function CG(n,e,t){const i=e.coords,s=e.colors;let r,a;switch(e.type){case dA.LATTICE:const o=e.verticesPerRow,c=Math.floor(i.length/o)-1,h=o-1;for(r=0;r<c;r++){let d=r*o;for(let f=0;f<h;f++,d++)U2(n,t,i[d],i[d+1],i[d+o],s[d],s[d+1],s[d+o]),U2(n,t,i[d+o+1],i[d+1],i[d+o],s[d+o+1],s[d+1],s[d+o])}break;case dA.TRIANGLES:for(r=0,a=i.length;r<a;r+=3)U2(n,t,i[r],i[r+1],i[r+2],s[r],s[r+1],s[r+2]);break;default:throw new Error("illegal figure")}}class NG extends EN{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,i){const o=Math.floor(this._bounds[0]),c=Math.floor(this._bounds[1]),h=Math.ceil(this._bounds[2])-o,d=Math.ceil(this._bounds[3])-c,f=Math.min(Math.ceil(Math.abs(h*e[0]*1.1)),3e3),p=Math.min(Math.ceil(Math.abs(d*e[1]*1.1)),3e3),g=h/f,v=d/p,b={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-c,scaleX:1/g,scaleY:1/v},x=f+2*2,m=p+2*2,y=i.getCanvas("mesh",x,m),w=y.context,E=w.createImageData(f,p);if(t){const _=E.data;for(let T=0,j=_.length;T<j;T+=4)_[T]=t[0],_[T+1]=t[1],_[T+2]=t[2],_[T+3]=255}for(const _ of this._figures)CG(E,_,b);return w.putImageData(E,2,2),{canvas:y.canvas,offsetX:o-2*g,offsetY:c-2*v,scaleX:g,scaleY:v}}isModifyingCurrentTransform(){return!0}getPattern(e,t,i,s){UA(e,this._bbox);const r=new Float32Array(2);if(s===Di.SHADING)$e.singularValueDecompose2dScale(Nn(e),r);else if(this.matrix){$e.singularValueDecompose2dScale(this.matrix,r);const[o,c]=r;$e.singularValueDecompose2dScale(t.baseTransform,r),r[0]*=o,r[1]*=c}else $e.singularValueDecompose2dScale(t.baseTransform,r);const a=this._createMeshCanvas(r,s===Di.SHADING?null:this._background,t.cachedCanvases);return s!==Di.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(a.offsetX,a.offsetY),e.scale(a.scaleX,a.scaleY),e.createPattern(a.canvas,"no-repeat")}}class _G extends EN{getPattern(){return"hotpink"}}function kG(n){switch(n[0]){case"RadialAxial":return new EG(n);case"Mesh":return new NG(n);case"Dummy":return new _G}throw new Error(`Unknown IR type: ${n[0]}`)}const lD={COLORED:1,UNCOLORED:2},w1=class w1{constructor(e,t,i,s){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=i,this.baseTransform=s}createPatternCanvas(e,t){var Y,ge;const{bbox:i,operatorList:s,paintType:r,tilingType:a,color:o,canvasGraphicsFactory:c}=this;let{xstep:h,ystep:d}=this;h=Math.abs(h),d=Math.abs(d),xw("TilingType: "+a);const f=i[0],p=i[1],g=i[2],v=i[3],b=g-f,x=v-p,m=new Float32Array(2);$e.singularValueDecompose2dScale(this.matrix,m);const[y,w]=m;$e.singularValueDecompose2dScale(this.baseTransform,m);const E=y*m[0],S=w*m[1];let _=b,T=x,j=!1,M=!1;const L=Math.ceil(h*E),O=Math.ceil(d*S),B=Math.ceil(b*E),G=Math.ceil(x*S);L>=B?_=h:j=!0,O>=G?T=d:M=!0;const W=this.getSizeAndScale(_,this.ctx.canvas.width,E),J=this.getSizeAndScale(T,this.ctx.canvas.height,S),V=e.cachedCanvases.getCanvas("pattern",W.size,J.size),H=V.context,P=c.createCanvasGraphics(H,t);if(P.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(P,r,o),H.translate(-W.scale*f,-J.scale*p),P.transform(0,W.scale,0,0,J.scale,0,0),H.save(),(Y=P.dependencyTracker)==null||Y.save(),this.clipBbox(P,f,p,g,v),P.baseTransform=Nn(P.ctx),P.executeOperatorList(s),P.endDrawing(),(ge=P.dependencyTracker)==null||ge.restore(),H.restore(),j||M){const ae=V.canvas;j&&(_=h),M&&(T=d);const ee=this.getSizeAndScale(_,this.ctx.canvas.width,E),le=this.getSizeAndScale(T,this.ctx.canvas.height,S),ie=ee.size,Q=le.size,Z=e.cachedCanvases.getCanvas("pattern-workaround",ie,Q),re=Z.context,se=j?Math.floor(b/h):0,be=M?Math.floor(x/d):0;for(let pe=0;pe<=se;pe++)for(let me=0;me<=be;me++)re.drawImage(ae,ie*pe,Q*me,ie,Q,0,0,ie,Q);return{canvas:Z.canvas,scaleX:ee.scale,scaleY:le.scale,offsetX:f,offsetY:p}}return{canvas:V.canvas,scaleX:W.scale,scaleY:J.scale,offsetX:f,offsetY:p}}getSizeAndScale(e,t,i){const s=Math.max(w1.MAX_PATTERN_SIZE,t);let r=Math.ceil(e*i);return r>=s?r=s:i=r/e,{scale:i,size:r}}clipBbox(e,t,i,s,r){const a=s-t,o=r-i;e.ctx.rect(t,i,a,o),$e.axialAlignedBoundingBox([t,i,s,r],Nn(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,i){const s=e.ctx,r=e.current;switch(t){case lD.COLORED:const{fillStyle:a,strokeStyle:o}=this.ctx;s.fillStyle=r.fillColor=a,s.strokeStyle=r.strokeColor=o;break;case lD.UNCOLORED:s.fillStyle=s.strokeStyle=i,r.fillColor=r.strokeColor=i;break;default:throw new FV(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,i,s,r){let a=i;s!==Di.SHADING&&(a=$e.transform(a,t.baseTransform),this.matrix&&(a=$e.transform(a,this.matrix)));const o=this.createPatternCanvas(t,r);let c=new DOMMatrix(a);c=c.translate(o.offsetX,o.offsetY),c=c.scale(1/o.scaleX,1/o.scaleY);const h=e.createPattern(o.canvas,"repeat");return h.setTransform(c),h}};we(w1,"MAX_PATTERN_SIZE",3e3);let HA=w1;function TG({src:n,srcPos:e=0,dest:t,width:i,height:s,nonBlackColor:r=4294967295,inverseDecode:a=!1}){const o=li.isLittleEndian?4278190080:255,[c,h]=a?[r,o]:[o,r],d=i>>3,f=i&7,p=n.length;t=new Uint32Array(t.buffer);let g=0;for(let v=0;v<s;v++){for(const x=e+d;e<x;e++){const m=e<p?n[e]:255;t[g++]=m&128?h:c,t[g++]=m&64?h:c,t[g++]=m&32?h:c,t[g++]=m&16?h:c,t[g++]=m&8?h:c,t[g++]=m&4?h:c,t[g++]=m&2?h:c,t[g++]=m&1?h:c}if(f===0)continue;const b=e<p?n[e++]:255;for(let x=0;x<f;x++)t[g++]=b&1<<7-x?h:c}return{srcPos:e,destPos:g}}const cD=16,uD=100,DG=15,hD=10,Ss=16,H2=new DOMMatrix,Js=new Float32Array(2),nf=new Float32Array([1/0,1/0,-1/0,-1/0]);function jG(n,e){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){e.save(),this.__originalSave()},n.restore=function(){e.restore(),this.__originalRestore()},n.translate=function(t,i){e.translate(t,i),this.__originalTranslate(t,i)},n.scale=function(t,i){e.scale(t,i),this.__originalScale(t,i)},n.transform=function(t,i,s,r,a,o){e.transform(t,i,s,r,a,o),this.__originalTransform(t,i,s,r,a,o)},n.setTransform=function(t,i,s,r,a,o){e.setTransform(t,i,s,r,a,o),this.__originalSetTransform(t,i,s,r,a,o)},n.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},n.rotate=function(t){e.rotate(t),this.__originalRotate(t)},n.clip=function(t){e.clip(t),this.__originalClip(t)},n.moveTo=function(t,i){e.moveTo(t,i),this.__originalMoveTo(t,i)},n.lineTo=function(t,i){e.lineTo(t,i),this.__originalLineTo(t,i)},n.bezierCurveTo=function(t,i,s,r,a,o){e.bezierCurveTo(t,i,s,r,a,o),this.__originalBezierCurveTo(t,i,s,r,a,o)},n.rect=function(t,i,s,r){e.rect(t,i,s,r),this.__originalRect(t,i,s,r)},n.closePath=function(){e.closePath(),this.__originalClosePath()},n.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class RG{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,i){let s;return this.cache[e]!==void 0?(s=this.cache[e],this.canvasFactory.reset(s,t,i)):(s=this.canvasFactory.create(t,i),this.cache[e]=s),s}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function nv(n,e,t,i,s,r,a,o,c,h){const[d,f,p,g,v,b]=Nn(n);if(f===0&&p===0){const y=a*d+v,w=Math.round(y),E=o*g+b,S=Math.round(E),_=(a+c)*d+v,T=Math.abs(Math.round(_)-w)||1,j=(o+h)*g+b,M=Math.abs(Math.round(j)-S)||1;return n.setTransform(Math.sign(d),0,0,Math.sign(g),w,S),n.drawImage(e,t,i,s,r,0,0,T,M),n.setTransform(d,f,p,g,v,b),[T,M]}if(d===0&&g===0){const y=o*p+v,w=Math.round(y),E=a*f+b,S=Math.round(E),_=(o+h)*p+v,T=Math.abs(Math.round(_)-w)||1,j=(a+c)*f+b,M=Math.abs(Math.round(j)-S)||1;return n.setTransform(0,Math.sign(f),Math.sign(p),0,w,S),n.drawImage(e,t,i,s,r,0,0,M,T),n.setTransform(d,f,p,g,v,b),[M,T]}n.drawImage(e,t,i,s,r,a,o,c,h);const x=Math.hypot(d,f),m=Math.hypot(p,g);return[x*c,m*h]}class dD{constructor(e,t,i){we(this,"alphaIsShape",!1);we(this,"fontSize",0);we(this,"fontSizeScale",1);we(this,"textMatrix",null);we(this,"textMatrixScale",1);we(this,"fontMatrix",hA);we(this,"leading",0);we(this,"x",0);we(this,"y",0);we(this,"lineX",0);we(this,"lineY",0);we(this,"charSpacing",0);we(this,"wordSpacing",0);we(this,"textHScale",1);we(this,"textRenderingMode",ii.FILL);we(this,"textRise",0);we(this,"fillColor","#000000");we(this,"strokeColor","#000000");we(this,"patternFill",!1);we(this,"patternStroke",!1);we(this,"fillAlpha",1);we(this,"strokeAlpha",1);we(this,"lineWidth",1);we(this,"activeSMask",null);we(this,"transferMaps","none");i==null||i(this),this.clipBox=new Float32Array([0,0,e,t]),this.minMax=nf.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=Di.FILL,t=null){const i=this.minMax.slice();if(e===Di.STROKE){t||zt("Stroke bounding box must include transform."),$e.singularValueDecompose2dScale(t,Js);const s=Js[0]*this.lineWidth/2,r=Js[1]*this.lineWidth/2;i[0]-=s,i[1]-=r,i[2]+=s,i[3]+=r}return i}updateClipFromPath(){const e=$e.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(nf,0)}getClippedPathBoundingBox(e=Di.FILL,t=null){return $e.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function fD(n,e){if(e instanceof ImageData){n.putImageData(e,0,0);return}const t=e.height,i=e.width,s=t%Ss,r=(t-s)/Ss,a=s===0?r:r+1,o=n.createImageData(i,Ss);let c=0,h;const d=e.data,f=o.data;let p,g,v,b;if(e.kind===Cv.GRAYSCALE_1BPP){const x=d.byteLength,m=new Uint32Array(f.buffer,0,f.byteLength>>2),y=m.length,w=i+7>>3,E=4294967295,S=li.isLittleEndian?4278190080:255;for(p=0;p<a;p++){for(v=p<r?Ss:s,h=0,g=0;g<v;g++){const _=x-c;let T=0;const j=_>w?i:_*8-7,M=j&-8;let L=0,O=0;for(;T<M;T+=8)O=d[c++],m[h++]=O&128?E:S,m[h++]=O&64?E:S,m[h++]=O&32?E:S,m[h++]=O&16?E:S,m[h++]=O&8?E:S,m[h++]=O&4?E:S,m[h++]=O&2?E:S,m[h++]=O&1?E:S;for(;T<j;T++)L===0&&(O=d[c++],L=128),m[h++]=O&L?E:S,L>>=1}for(;h<y;)m[h++]=0;n.putImageData(o,0,p*Ss)}}else if(e.kind===Cv.RGBA_32BPP){for(g=0,b=i*Ss*4,p=0;p<r;p++)f.set(d.subarray(c,c+b)),c+=b,n.putImageData(o,0,g),g+=Ss;p<a&&(b=i*s*4,f.set(d.subarray(c,c+b)),n.putImageData(o,0,g))}else if(e.kind===Cv.RGB_24BPP)for(v=Ss,b=i*v,p=0;p<a;p++){for(p>=r&&(v=s,b=i*v),h=0,g=b;g--;)f[h++]=d[c++],f[h++]=d[c++],f[h++]=d[c++],f[h++]=255;n.putImageData(o,0,p*Ss)}else throw new Error(`bad image kind: ${e.kind}`)}function pD(n,e){if(e.bitmap){n.drawImage(e.bitmap,0,0);return}const t=e.height,i=e.width,s=t%Ss,r=(t-s)/Ss,a=s===0?r:r+1,o=n.createImageData(i,Ss);let c=0;const h=e.data,d=o.data;for(let f=0;f<a;f++){const p=f<r?Ss:s;({srcPos:c}=TG({src:h,srcPos:c,dest:d,width:i,height:p,nonBlackColor:0})),n.putImageData(o,0,f*Ss)}}function zg(n,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of t)n[i]!==void 0&&(e[i]=n[i]);n.setLineDash!==void 0&&(e.setLineDash(n.getLineDash()),e.lineDashOffset=n.lineDashOffset)}function iv(n){n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0);const{filter:e}=n;e!=="none"&&e!==""&&(n.filter="none")}function gD(n,e){if(e)return!0;$e.singularValueDecompose2dScale(n,Js);const t=Math.fround(ro.pixelRatio*ou.PDF_TO_CSS_UNITS);return Js[0]<=t&&Js[1]<=t}const LG=["butt","round","square"],MG=["miter","round","bevel"],OG={},mD={};var ba,$A,qA,VA;const MN=class MN{constructor(e,t,i,s,r,{optionalContentConfig:a,markedContentStack:o=null},c,h,d){D(this,ba);this.ctx=e,this.current=new dD(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=i,this.canvasFactory=s,this.filterFactory=r,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=a,this.cachedCanvases=new RG(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=c,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=h,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=d??null}getObject(e,t,i=null){var s;return typeof t=="string"?((s=this.dependencyTracker)==null||s.recordNamedDependency(e,t),t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t)):i}beginDrawing({transform:e,viewport:t,transparency:i=!1,background:s=null}){const r=this.ctx.canvas.width,a=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=s||"#ffffff",this.ctx.fillRect(0,0,r,a),this.ctx.fillStyle=o,i){const c=this.cachedCanvases.getCanvas("transparent",r,a);this.compositeCtx=this.ctx,this.transparentCanvas=c.canvas,this.ctx=c.context,this.ctx.save(),this.ctx.transform(...Nn(this.compositeCtx))}this.ctx.save(),iv(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=Nn(this.ctx)}executeOperatorList(e,t,i,s,r){var m;const a=e.argsArray,o=e.fnArray;let c=t||0;const h=a.length;if(h===c)return c;const d=h-c>hD&&typeof i=="function",f=d?Date.now()+DG:0;let p=0;const g=this.commonObjs,v=this.objs;let b,x;for(;;){if(s!==void 0&&c===s.nextBreakPoint)return s.breakIt(c,i),c;if(!r||r(c))if(b=o[c],x=a[c]??null,b!==n0.dependency)x===null?this[b](c):this[b](c,...x);else for(const y of x){(m=this.dependencyTracker)==null||m.recordNamedData(y,c);const w=y.startsWith("g_")?g:v;if(!w.has(y))return w.get(y,i),c}if(c++,c===h)return c;if(d&&++p>hD){if(Date.now()>f)return i(),c;p=0}}}endDrawing(){R(this,ba,$A).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),R(this,ba,qA).call(this)}_scaleImage(e,t){const i=e.width??e.displayWidth,s=e.height??e.displayHeight;let r=Math.max(Math.hypot(t[0],t[1]),1),a=Math.max(Math.hypot(t[2],t[3]),1),o=i,c=s,h="prescale1",d,f;for(;r>2&&o>1||a>2&&c>1;){let p=o,g=c;r>2&&o>1&&(p=o>=16384?Math.floor(o/2)-1||1:Math.ceil(o/2),r/=o/p),a>2&&c>1&&(g=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c)/2,a/=c/g),d=this.cachedCanvases.getCanvas(h,p,g),f=d.context,f.clearRect(0,0,p,g),f.drawImage(e,0,0,o,c,0,0,p,g),e=d.canvas,o=p,c=g,h=h==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:o,paintHeight:c}}_createMaskCanvas(e,t){var L,O;const i=this.ctx,{width:s,height:r}=t,a=this.current.fillColor,o=this.current.patternFill,c=Nn(i);let h,d,f,p;if((t.bitmap||t.data)&&t.count>1){const B=t.bitmap||t.data.buffer;d=JSON.stringify(o?c:[c.slice(0,4),a]),h=this._cachedBitmapsMap.get(B),h||(h=new Map,this._cachedBitmapsMap.set(B,h));const G=h.get(d);if(G&&!o){const W=Math.round(Math.min(c[0],c[2])+c[4]),J=Math.round(Math.min(c[1],c[3])+c[5]);return(L=this.dependencyTracker)==null||L.recordDependencies(e,mr.transformAndFill),{canvas:G,offsetX:W,offsetY:J}}f=G}f||(p=this.cachedCanvases.getCanvas("maskCanvas",s,r),pD(p.context,t));let g=$e.transform(c,[1/s,0,0,-1/r,0,0]);g=$e.transform(g,[1,0,0,1,0,-r]);const v=nf.slice();$e.axialAlignedBoundingBox([0,0,s,r],g,v);const[b,x,m,y]=v,w=Math.round(m-b)||1,E=Math.round(y-x)||1,S=this.cachedCanvases.getCanvas("fillCanvas",w,E),_=S.context,T=b,j=x;_.translate(-T,-j),_.transform(...g),f||(f=this._scaleImage(p.canvas,Ca(_)),f=f.img,h&&o&&h.set(d,f)),_.imageSmoothingEnabled=gD(Nn(_),t.interpolate),nv(_,f,0,0,f.width,f.height,0,0,s,r),_.globalCompositeOperation="source-in";const M=$e.transform(Ca(_),[1,0,0,1,-T,-j]);return _.fillStyle=o?a.getPattern(i,this,M,Di.FILL,e):a,_.fillRect(0,0,s,r),h&&!o&&(this.cachedCanvases.delete("fillCanvas"),h.set(d,S.canvas)),(O=this.dependencyTracker)==null||O.recordDependencies(e,mr.transformAndFill),{canvas:S.canvas,offsetX:Math.round(T),offsetY:Math.round(j)}}setLineWidth(e,t){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("lineWidth",e),t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(e,t){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("lineCap",e),this.ctx.lineCap=LG[t]}setLineJoin(e,t){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("lineJoin",e),this.ctx.lineJoin=MG[t]}setMiterLimit(e,t){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("miterLimit",e),this.ctx.miterLimit=t}setDash(e,t,i){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("dash",e);const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(t),s.lineDashOffset=i)}setRenderingIntent(e,t){}setFlatness(e,t){}setGState(e,t){var i,s,r,a,o;for(const[c,h]of t)switch(c){case"LW":this.setLineWidth(e,h);break;case"LC":this.setLineCap(e,h);break;case"LJ":this.setLineJoin(e,h);break;case"ML":this.setMiterLimit(e,h);break;case"D":this.setDash(e,h[0],h[1]);break;case"RI":this.setRenderingIntent(e,h);break;case"FL":this.setFlatness(e,h);break;case"Font":this.setFont(e,h[0],h[1]);break;case"CA":(i=this.dependencyTracker)==null||i.recordSimpleData("strokeAlpha",e),this.current.strokeAlpha=h;break;case"ca":(s=this.dependencyTracker)==null||s.recordSimpleData("fillAlpha",e),this.ctx.globalAlpha=this.current.fillAlpha=h;break;case"BM":(r=this.dependencyTracker)==null||r.recordSimpleData("globalCompositeOperation",e),this.ctx.globalCompositeOperation=h;break;case"SMask":(a=this.dependencyTracker)==null||a.recordSimpleData("SMask",e),this.current.activeSMask=h?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":(o=this.dependencyTracker)==null||o.recordSimpleData("filter",e),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(h);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(e){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,i=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,r=this.cachedCanvases.getCanvas(s,t,i);this.suspendedCtx=this.ctx;const a=this.ctx=r.context;a.setTransform(this.suspendedCtx.getTransform()),zg(this.suspendedCtx,a),jG(a,this.suspendedCtx),this.setGState(e,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),zg(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,i=this.suspendedCtx;this.composeSMask(i,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,i,s){const r=s[0],a=s[1],o=s[2]-r,c=s[3]-a;o===0||c===0||(this.genericComposeSMask(t.context,i,o,c,t.subtype,t.backdrop,t.transferMap,r,a,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(i.canvas,0,0),e.restore())}genericComposeSMask(e,t,i,s,r,a,o,c,h,d,f){let p=e.canvas,g=c-d,v=h-f;if(a)if(g<0||v<0||g+i>p.width||v+s>p.height){const x=this.cachedCanvases.getCanvas("maskExtension",i,s),m=x.context;m.drawImage(p,-g,-v),m.globalCompositeOperation="destination-atop",m.fillStyle=a,m.fillRect(0,0,i,s),m.globalCompositeOperation="source-over",p=x.canvas,g=v=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const x=new Path2D;x.rect(g,v,i,s),e.clip(x),e.globalCompositeOperation="destination-atop",e.fillStyle=a,e.fillRect(g,v,i,s),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),r==="Alpha"&&o?t.filter=this.filterFactory.addAlphaFilter(o):r==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(o));const b=new Path2D;b.rect(c,h,i,s),t.clip(b),t.globalCompositeOperation="destination-in",t.drawImage(p,g,v,i,s,c,h,i,s),t.restore()}save(e){var i;this.inSMaskMode&&zg(this.ctx,this.suspendedCtx),this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone(),(i=this.dependencyTracker)==null||i.save(e)}restore(e){var t;if((t=this.dependencyTracker)==null||t.restore(e),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&zg(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,i,s,r,a,o){var c;(c=this.dependencyTracker)==null||c.recordIncrementalData("transform",e),this.ctx.transform(t,i,s,r,a,o),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,i,s){let[r]=i;if(!s){r||(r=i[0]=new Path2D),this[t](e,r);return}if(this.dependencyTracker!==null){const a=t===n0.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(e).recordBBox(e,this.ctx,s[0]-a,s[2]+a,s[1]-a,s[3]+a).recordDependencies(e,["transform"])}r instanceof Path2D||(r=i[0]=aL(r)),$e.axialAlignedBoundingBox(s,Nn(this.ctx),this.current.minMax),this[t](e,r),this._pathStartIdx=e}closePath(e){this.ctx.closePath()}stroke(e,t,i=!0){var a;const s=this.ctx,r=this.current.strokeColor;if(s.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof r=="object"&&(r!=null&&r.getPattern)){const o=r.isModifyingCurrentTransform()?s.getTransform():null;if(s.save(),s.strokeStyle=r.getPattern(s,this,Ca(s),Di.STROKE,e),o){const c=new Path2D;c.addPath(t,s.getTransform().invertSelf().multiplySelf(o)),t=c}this.rescaleAndStroke(t,!1),s.restore()}else this.rescaleAndStroke(t,!0);(a=this.dependencyTracker)==null||a.recordDependencies(e,mr.stroke),i&&this.consumePath(e,t,this.current.getClippedPathBoundingBox(Di.STROKE,Nn(this.ctx))),s.globalAlpha=this.current.fillAlpha}closeStroke(e,t){this.stroke(e,t)}fill(e,t,i=!0){var h,d,f;const s=this.ctx,r=this.current.fillColor,a=this.current.patternFill;let o=!1;if(a){const p=r.isModifyingCurrentTransform()?s.getTransform():null;if((h=this.dependencyTracker)==null||h.save(e),s.save(),s.fillStyle=r.getPattern(s,this,Ca(s),Di.FILL,e),p){const g=new Path2D;g.addPath(t,s.getTransform().invertSelf().multiplySelf(p)),t=g}o=!0}const c=this.current.getClippedPathBoundingBox();this.contentVisible&&c!==null&&(this.pendingEOFill?(s.fill(t,"evenodd"),this.pendingEOFill=!1):s.fill(t)),(d=this.dependencyTracker)==null||d.recordDependencies(e,mr.fill),o&&(s.restore(),(f=this.dependencyTracker)==null||f.restore(e)),i&&this.consumePath(e,t,c)}eoFill(e,t){this.pendingEOFill=!0,this.fill(e,t)}fillStroke(e,t){this.fill(e,t,!1),this.stroke(e,t,!1),this.consumePath(e,t)}eoFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}closeFillStroke(e,t){this.fillStroke(e,t)}closeEOFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}endPath(e,t){this.consumePath(e,t)}rawFillPath(e,t){var i;this.ctx.fill(t),(i=this.dependencyTracker)==null||i.recordDependencies(e,mr.rawFillPath).recordOperation(e)}clip(e){var t;(t=this.dependencyTracker)==null||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=OG}eoClip(e){var t;(t=this.dependencyTracker)==null||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=mD}beginText(e){var t;this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,(t=this.dependencyTracker)==null||t.recordOpenMarker(e).resetIncrementalData("sameLineText").resetIncrementalData("moveText",e)}endText(e){const t=this.pendingTextPaths,i=this.ctx;if(this.dependencyTracker){const{dependencyTracker:s}=this;t!==void 0&&s.recordFutureForcedDependency("textClip",s.getOpenMarker()).recordFutureForcedDependency("textClip",e),s.recordCloseMarker(e)}if(t!==void 0){const s=new Path2D,r=i.getTransform().invertSelf();for(const{transform:a,x:o,y:c,fontSize:h,path:d}of t)d&&s.addPath(d,new DOMMatrix(a).preMultiplySelf(r).translate(o,c).scale(h,-h));i.clip(s)}delete this.pendingTextPaths}setCharSpacing(e,t){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("charSpacing",e),this.current.charSpacing=t}setWordSpacing(e,t){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("wordSpacing",e),this.current.wordSpacing=t}setHScale(e,t){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("hScale",e),this.current.textHScale=t/100}setLeading(e,t){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("leading",e),this.current.leading=-t}setFont(e,t,i){var f,p;(f=this.dependencyTracker)==null||f.recordSimpleData("font",e).recordSimpleDataFromNamed("fontObj",t,e);const s=this.commonObjs.get(t),r=this.current;if(!s)throw new Error(`Can't find font for ${t}`);if(r.fontMatrix=s.fontMatrix||hA,(r.fontMatrix[0]===0||r.fontMatrix[3]===0)&&ut("Invalid font matrix for font "+t),i<0?(i=-i,r.fontDirection=-1):r.fontDirection=1,this.current.font=s,this.current.fontSize=i,s.isType3Font)return;const a=s.loadedName||"sans-serif",o=((p=s.systemFontInfo)==null?void 0:p.css)||`"${a}", ${s.fallbackName}`;let c="normal";s.black?c="900":s.bold&&(c="bold");const h=s.italic?"italic":"normal";let d=i;i<cD?d=cD:i>uD&&(d=uD),this.current.fontSizeScale=i/d,this.ctx.font=`${h} ${c} ${d}px ${o}`}setTextRenderingMode(e,t){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("textRenderingMode",e),this.current.textRenderingMode=t}setTextRise(e,t){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("textRise",e),this.current.textRise=t}moveText(e,t,i){var s;(s=this.dependencyTracker)==null||s.resetIncrementalData("sameLineText").recordIncrementalData("moveText",e),this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=i}setLeadingMoveText(e,t,i){this.setLeading(e,-i),this.moveText(e,t,i)}setTextMatrix(e,t){var s;(s=this.dependencyTracker)==null||s.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",e);const{current:i}=this;i.textMatrix=t,i.textMatrixScale=Math.hypot(t[0],t[1]),i.x=i.lineX=0,i.y=i.lineY=0}nextLine(e){var t;this.moveText(e,0,this.current.leading),(t=this.dependencyTracker)==null||t.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??e)}paintChar(e,t,i,s,r,a){var m,y,w,E;const o=this.ctx,c=this.current,h=c.font,d=c.textRenderingMode,f=c.fontSize/c.fontSizeScale,p=d&ii.FILL_STROKE_MASK,g=!!(d&ii.ADD_TO_PATH_FLAG),v=c.patternFill&&!h.missingFile,b=c.patternStroke&&!h.missingFile;let x;if((h.disableFontFace||g||v||b)&&!h.missingFile&&(x=h.getPathGenerator(this.commonObjs,t)),x&&(h.disableFontFace||v||b)){o.save(),o.translate(i,s),o.scale(f,-f),(m=this.dependencyTracker)==null||m.recordCharacterBBox(e,o,h);let S;if(p===ii.FILL||p===ii.FILL_STROKE)if(r){S=o.getTransform(),o.setTransform(...r);const _=R(this,ba,VA).call(this,x,S,r);o.fill(_)}else o.fill(x);if(p===ii.STROKE||p===ii.FILL_STROKE)if(a){S||(S=o.getTransform()),o.setTransform(...a);const{a:_,b:T,c:j,d:M}=S,L=$e.inverseTransform(a),O=$e.transform([_,T,j,M,0,0],L);$e.singularValueDecompose2dScale(O,Js),o.lineWidth*=Math.max(Js[0],Js[1])/f,o.stroke(R(this,ba,VA).call(this,x,S,a))}else o.lineWidth/=f,o.stroke(x);o.restore()}else(p===ii.FILL||p===ii.FILL_STROKE)&&(o.fillText(t,i,s),(y=this.dependencyTracker)==null||y.recordCharacterBBox(e,o,h,f,i,s,()=>o.measureText(t))),(p===ii.STROKE||p===ii.FILL_STROKE)&&(this.dependencyTracker&&((w=this.dependencyTracker)==null||w.recordCharacterBBox(e,o,h,f,i,s,()=>o.measureText(t)).recordDependencies(e,mr.stroke)),o.strokeText(t,i,s));g&&((this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:Nn(o),x:i,y:s,fontSize:f,path:x}),(E=this.dependencyTracker)==null||E.recordCharacterBBox(e,o,h,f,i,s))}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let i=!1;for(let s=3;s<t.length;s+=4)if(t[s]>0&&t[s]<255){i=!0;break}return ht(this,"isFontSubpixelAAEnabled",i)}showText(e,t){var O,B,G,W;this.dependencyTracker&&(this.dependencyTracker.recordDependencies(e,mr.showText).resetBBox(e),this.current.textRenderingMode&ii.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",e).inheritPendingDependenciesAsFutureForcedDependencies());const i=this.current,s=i.font;if(s.isType3Font){this.showType3Text(e,t),(O=this.dependencyTracker)==null||O.recordShowTextOperation(e);return}const r=i.fontSize;if(r===0){(B=this.dependencyTracker)==null||B.recordOperation(e);return}const a=this.ctx,o=i.fontSizeScale,c=i.charSpacing,h=i.wordSpacing,d=i.fontDirection,f=i.textHScale*d,p=t.length,g=s.vertical,v=g?1:-1,b=s.defaultVMetrics,x=r*i.fontMatrix[0],m=i.textRenderingMode===ii.FILL&&!s.disableFontFace&&!i.patternFill;a.save(),i.textMatrix&&a.transform(...i.textMatrix),a.translate(i.x,i.y+i.textRise),d>0?a.scale(f,-1):a.scale(f,1);let y,w;const E=i.textRenderingMode&ii.FILL_STROKE_MASK,S=E===ii.FILL||E===ii.FILL_STROKE,_=E===ii.STROKE||E===ii.FILL_STROKE;if(S&&i.patternFill){a.save();const J=i.fillColor.getPattern(a,this,Ca(a),Di.FILL,e);y=Nn(a),a.restore(),a.fillStyle=J}if(_&&i.patternStroke){a.save();const J=i.strokeColor.getPattern(a,this,Ca(a),Di.STROKE,e);w=Nn(a),a.restore(),a.strokeStyle=J}let T=i.lineWidth;const j=i.textMatrixScale;if(j===0||T===0?_&&(T=this.getSinglePixelWidth()):T/=j,o!==1&&(a.scale(o,o),T/=o),a.lineWidth=T,s.isInvalidPDFjsFont){const J=[];let V=0;for(const P of t)J.push(P.unicode),V+=P.width;const H=J.join("");if(a.fillText(H,0,0),this.dependencyTracker!==null){const P=a.measureText(H);this.dependencyTracker.recordBBox(e,this.ctx,-P.actualBoundingBoxLeft,P.actualBoundingBoxRight,-P.actualBoundingBoxAscent,P.actualBoundingBoxDescent).recordShowTextOperation(e)}i.x+=V*x*f,a.restore(),this.compose();return}let M=0,L;for(L=0;L<p;++L){const J=t[L];if(typeof J=="number"){M+=v*J*r/1e3;continue}let V=!1;const H=(J.isSpace?h:0)+c,P=J.fontChar,Y=J.accent;let ge,ae,ee=J.width;if(g){const Q=J.vmetric||b,Z=-(J.vmetric?Q[1]:ee*.5)*x,re=Q[2]*x;ee=Q?-Q[0]:ee,ge=Z/o,ae=(M+re)/o}else ge=M/o,ae=0;let le;if(s.remeasure&&ee>0){le=a.measureText(P);const Q=le.width*1e3/r*o;if(ee<Q&&this.isFontSubpixelAAEnabled){const Z=ee/Q;V=!0,a.save(),a.scale(Z,1),ge/=Z}else ee!==Q&&(ge+=(ee-Q)/2e3*r/o)}if(this.contentVisible&&(J.isInFont||s.missingFile)){if(m&&!Y)a.fillText(P,ge,ae),(G=this.dependencyTracker)==null||G.recordCharacterBBox(e,a,le?{bbox:null}:s,r/o,ge,ae,()=>le??a.measureText(P));else if(this.paintChar(e,P,ge,ae,y,w),Y){const Q=ge+r*Y.offset.x/o,Z=ae-r*Y.offset.y/o;this.paintChar(e,Y.fontChar,Q,Z,y,w)}}const ie=g?ee*x-H*d:ee*x+H*d;M+=ie,V&&a.restore()}g?i.y-=M:i.x+=M*f,a.restore(),this.compose(),(W=this.dependencyTracker)==null||W.recordShowTextOperation(e)}showType3Text(e,t){const i=this.ctx,s=this.current,r=s.font,a=s.fontSize,o=s.fontDirection,c=r.vertical?1:-1,h=s.charSpacing,d=s.wordSpacing,f=s.textHScale*o,p=s.fontMatrix||hA,g=t.length,v=s.textRenderingMode===ii.INVISIBLE;let b,x,m,y;if(v||a===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,i.save(),s.textMatrix&&i.transform(...s.textMatrix),i.translate(s.x,s.y+s.textRise),i.scale(f,o);const w=this.dependencyTracker;for(this.dependencyTracker=w?new a1(w,e):null,b=0;b<g;++b){if(x=t[b],typeof x=="number"){y=c*x*a/1e3,this.ctx.translate(y,0),s.x+=y*f;continue}const E=(x.isSpace?d:0)+h,S=r.charProcOperatorList[x.operatorListId];S?this.contentVisible&&(this.save(),i.scale(a,a),i.transform(...p),this.executeOperatorList(S),this.restore()):ut(`Type3 character "${x.operatorListId}" is not available.`);const _=[x.width,0];$e.applyTransform(_,p),m=_[0]*a+E,i.translate(m,0),s.x+=m*f}i.restore(),w&&(this.dependencyTracker=w)}setCharWidth(e,t,i){}setCharWidthAndBounds(e,t,i,s,r,a,o){var h;const c=new Path2D;c.rect(s,r,a-s,o-r),this.ctx.clip(c),(h=this.dependencyTracker)==null||h.recordBBox(e,this.ctx,s,a,r,o).recordClipBox(e,this.ctx,s,a,r,o),this.endPath(e)}getColorN_Pattern(e,t){let i;if(t[0]==="TilingPattern"){const s=this.baseTransform||Nn(this.ctx),r={createCanvasGraphics:(a,o)=>new MN(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new a1(this.dependencyTracker,o,!0):null)};i=new HA(t,this.ctx,r,s)}else i=this._getPattern(e,t[1],t[2]);return i}setStrokeColorN(e,...t){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("strokeColor",e),this.current.strokeColor=this.getColorN_Pattern(e,t),this.current.patternStroke=!0}setFillColorN(e,...t){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("fillColor",e),this.current.fillColor=this.getColorN_Pattern(e,t),this.current.patternFill=!0}setStrokeRGBColor(e,t){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(e){var t;(t=this.dependencyTracker)==null||t.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(e){var t;(t=this.dependencyTracker)==null||t.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t,i=null){let s;return this.cachedPatterns.has(t)?s=this.cachedPatterns.get(t):(s=kG(this.getObject(e,t)),this.cachedPatterns.set(t,s)),i&&(s.matrix=i),s}shadingFill(e,t){var a;if(!this.contentVisible)return;const i=this.ctx;this.save(e);const s=this._getPattern(e,t);i.fillStyle=s.getPattern(i,this,Ca(i),Di.SHADING,e);const r=Ca(i);if(r){const{width:o,height:c}=i.canvas,h=nf.slice();$e.axialAlignedBoundingBox([0,0,o,c],r,h);const[d,f,p,g]=h;this.ctx.fillRect(d,f,p-d,g-f)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);(a=this.dependencyTracker)==null||a.resetBBox(e).recordFullPageBBox(e).recordDependencies(e,mr.transform).recordDependencies(e,mr.fill).recordOperation(e),this.compose(this.current.getClippedPathBoundingBox()),this.restore(e)}beginInlineImage(){zt("Should not call beginInlineImage")}beginImageData(){zt("Should not call beginImageData")}paintFormXObjectBegin(e,t,i){var s;if(this.contentVisible&&(this.save(e),this.baseTransformStack.push(this.baseTransform),t&&this.transform(e,...t),this.baseTransform=Nn(this.ctx),i)){$e.axialAlignedBoundingBox(i,this.baseTransform,this.current.minMax);const[r,a,o,c]=i,h=new Path2D;h.rect(r,a,o-r,c-a),this.ctx.clip(h),(s=this.dependencyTracker)==null||s.recordClipBox(e,this.ctx,r,o,a,c),this.endPath(e)}}paintFormXObjectEnd(e){this.contentVisible&&(this.restore(e),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e,t){var w;if(!this.contentVisible)return;this.save(e),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const i=this.ctx;t.isolated||xw("TODO: Support non-isolated groups."),t.knockout&&ut("Knockout groups not supported.");const s=Nn(i);if(t.matrix&&i.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let r=nf.slice();$e.axialAlignedBoundingBox(t.bbox,Nn(i),r);const a=[0,0,i.canvas.width,i.canvas.height];r=$e.intersect(r,a)||[0,0,0,0];const o=Math.floor(r[0]),c=Math.floor(r[1]),h=Math.max(Math.ceil(r[2])-o,1),d=Math.max(Math.ceil(r[3])-c,1);this.current.startNewPathAndClipBox([0,0,h,d]);let f="groupAt"+this.groupLevel;t.smask&&(f+="_smask_"+this.smaskCounter++%2);const p=this.cachedCanvases.getCanvas(f,h,d),g=p.context;g.translate(-o,-c),g.transform(...s);let v=new Path2D;const[b,x,m,y]=t.bbox;if(v.rect(b,x,m-b,y-x),t.matrix){const E=new Path2D;E.addPath(v,new DOMMatrix(t.matrix)),v=E}g.clip(v),t.smask&&this.smaskStack.push({canvas:p.canvas,context:g,offsetX:o,offsetY:c,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}),(!t.smask||this.dependencyTracker)&&(i.setTransform(1,0,0,1,0,0),i.translate(o,c),i.save()),zg(i,g),this.ctx=g,(w=this.dependencyTracker)==null||w.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(i),this.setGState(e,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(i),this.groupLevel++}endGroup(e,t){var r;if(!this.contentVisible)return;this.groupLevel--;const i=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,(r=this.dependencyTracker)==null||r.popBaseTransform(),t.smask)this.tempSMask=this.smaskStack.pop(),this.restore(e),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const a=Nn(this.ctx);this.restore(e),this.ctx.save(),this.ctx.setTransform(...a);const o=nf.slice();$e.axialAlignedBoundingBox([0,0,i.canvas.width,i.canvas.height],a,o),this.ctx.drawImage(i.canvas,0,0),this.ctx.restore(),this.compose(o)}}beginAnnotation(e,t,i,s,r,a){if(R(this,ba,$A).call(this),iv(this.ctx),this.ctx.save(),this.save(e),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),i){const o=i[2]-i[0],c=i[3]-i[1];if(a&&this.annotationCanvasMap){s=s.slice(),s[4]-=i[0],s[5]-=i[1],i=i.slice(),i[0]=i[1]=0,i[2]=o,i[3]=c,$e.singularValueDecompose2dScale(Nn(this.ctx),Js);const{viewportScale:h}=this,d=Math.ceil(o*this.outputScaleX*h),f=Math.ceil(c*this.outputScaleY*h);this.annotationCanvas=this.canvasFactory.create(d,f);const{canvas:p,context:g}=this.annotationCanvas;this.annotationCanvasMap.set(t,p),this.annotationCanvas.savedCtx=this.ctx,this.ctx=g,this.ctx.save(),this.ctx.setTransform(Js[0],0,0,-Js[1],0,c*Js[1]),iv(this.ctx)}else{iv(this.ctx),this.endPath(e);const h=new Path2D;h.rect(i[0],i[1],o,c),this.ctx.clip(h)}}this.current=new dD(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(e,...s),this.transform(e,...r)}endAnnotation(e){this.annotationCanvas&&(this.ctx.restore(),R(this,ba,qA).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e,t){var o;if(!this.contentVisible)return;const i=t.count;t=this.getObject(e,t.data,t),t.count=i;const s=this.ctx,r=this._createMaskCanvas(e,t),a=r.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(a,r.offsetX,r.offsetY),(o=this.dependencyTracker)==null||o.resetBBox(e).recordBBox(e,this.ctx,r.offsetX,r.offsetX+a.width,r.offsetY,r.offsetY+a.height).recordOperation(e),s.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,i,s=0,r=0,a,o){var f,p,g;if(!this.contentVisible)return;t=this.getObject(e,t.data,t);const c=this.ctx;c.save();const h=Nn(c);c.transform(i,s,r,a,0,0);const d=this._createMaskCanvas(e,t);c.setTransform(1,0,0,1,d.offsetX-h[4],d.offsetY-h[5]),(f=this.dependencyTracker)==null||f.resetBBox(e);for(let v=0,b=o.length;v<b;v+=2){const x=$e.transform(h,[i,s,r,a,o[v],o[v+1]]);c.drawImage(d.canvas,x[4],x[5]),(p=this.dependencyTracker)==null||p.recordBBox(e,this.ctx,x[4],x[4]+d.canvas.width,x[5],x[5]+d.canvas.height)}c.restore(),this.compose(),(g=this.dependencyTracker)==null||g.recordOperation(e)}paintImageMaskXObjectGroup(e,t){var a,o,c;if(!this.contentVisible)return;const i=this.ctx,s=this.current.fillColor,r=this.current.patternFill;(a=this.dependencyTracker)==null||a.resetBBox(e).recordDependencies(e,mr.transformAndFill);for(const h of t){const{data:d,width:f,height:p,transform:g}=h,v=this.cachedCanvases.getCanvas("maskCanvas",f,p),b=v.context;b.save();const x=this.getObject(e,d,h);pD(b,x),b.globalCompositeOperation="source-in",b.fillStyle=r?s.getPattern(b,this,Ca(i),Di.FILL,e):s,b.fillRect(0,0,f,p),b.restore(),i.save(),i.transform(...g),i.scale(1,-1),nv(i,v.canvas,0,0,f,p,0,-1,1,1),(o=this.dependencyTracker)==null||o.recordBBox(e,i,0,f,0,p),i.restore()}this.compose(),(c=this.dependencyTracker)==null||c.recordOperation(e)}paintImageXObject(e,t){if(!this.contentVisible)return;const i=this.getObject(e,t);if(!i){ut("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e,i)}paintImageXObjectRepeat(e,t,i,s,r){if(!this.contentVisible)return;const a=this.getObject(e,t);if(!a){ut("Dependent image isn't ready yet");return}const o=a.width,c=a.height,h=[];for(let d=0,f=r.length;d<f;d+=2)h.push({transform:[i,0,0,s,r[d],r[d+1]],x:0,y:0,w:o,h:c});this.paintInlineImageXObjectGroup(e,a,h)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:i,height:s}=e,r=this.cachedCanvases.getCanvas("inlineImage",i,s),a=r.context;return a.filter=this.current.transferMaps,a.drawImage(t,0,0),a.filter="none",r.canvas}paintInlineImageXObject(e,t){var h;if(!this.contentVisible)return;const i=t.width,s=t.height,r=this.ctx;this.save(e);const{filter:a}=r;a!=="none"&&a!==""&&(r.filter="none"),r.scale(1/i,-1/s);let o;if(t.bitmap)o=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)o=t;else{const f=this.cachedCanvases.getCanvas("inlineImage",i,s).context;fD(f,t),o=this.applyTransferMapsToCanvas(f)}const c=this._scaleImage(o,Ca(r));r.imageSmoothingEnabled=gD(Nn(r),t.interpolate),(h=this.dependencyTracker)==null||h.resetBBox(e).recordBBox(e,r,0,i,-s,0).recordDependencies(e,mr.imageXObject).recordOperation(e),nv(r,c.img,0,0,c.paintWidth,c.paintHeight,0,-s,i,s),this.compose(),this.restore(e)}paintInlineImageXObjectGroup(e,t,i){var a,o,c;if(!this.contentVisible)return;const s=this.ctx;let r;if(t.bitmap)r=t.bitmap;else{const h=t.width,d=t.height,p=this.cachedCanvases.getCanvas("inlineImage",h,d).context;fD(p,t),r=this.applyTransferMapsToCanvas(p)}(a=this.dependencyTracker)==null||a.resetBBox(e);for(const h of i)s.save(),s.transform(...h.transform),s.scale(1,-1),nv(s,r,h.x,h.y,h.w,h.h,0,-1,1,1),(o=this.dependencyTracker)==null||o.recordBBox(e,s,0,1,-1,0),s.restore();(c=this.dependencyTracker)==null||c.recordOperation(e),this.compose()}paintSolidColorImageMask(e){var t;this.contentVisible&&((t=this.dependencyTracker)==null||t.resetBBox(e).recordBBox(e,this.ctx,0,1,0,1).recordDependencies(e,mr.fill).recordOperation(e),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e,t){}markPointProps(e,t,i){}beginMarkedContent(e,t){var i;(i=this.dependencyTracker)==null||i.beginMarkedContent(e),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t,i){var s;(s=this.dependencyTracker)==null||s.beginMarkedContent(e),t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(i)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(e){var t;(t=this.dependencyTracker)==null||t.endMarkedContent(e),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(e){}endCompat(e){}consumePath(e,t,i){var a,o;const s=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(i);const r=this.ctx;this.pendingClip?(s||(this.pendingClip===mD?r.clip(t,"evenodd"):r.clip(t)),this.pendingClip=null,(a=this.dependencyTracker)==null||a.bboxToClipBoxDropOperation(e).recordFutureForcedDependency("clipPath",e)):(o=this.dependencyTracker)==null||o.recordOperation(e),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=Nn(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),i=Math.hypot(e[0],e[2]),s=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(i,s)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:i,c:s,d:r}=this.ctx.getTransform();let a,o;if(i===0&&s===0){const c=Math.abs(t),h=Math.abs(r);if(c===h)if(e===0)a=o=1/c;else{const d=c*e;a=o=d<1?1/d:1}else if(e===0)a=1/c,o=1/h;else{const d=c*e,f=h*e;a=d<1?1/d:1,o=f<1?1/f:1}}else{const c=Math.abs(t*r-i*s),h=Math.hypot(t,i),d=Math.hypot(s,r);if(e===0)a=d/c,o=h/c;else{const f=e*c;a=d>f?d/f:1,o=h>f?h/f:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:i,current:{lineWidth:s}}=this,[r,a]=this.getScaleForStroking();if(r===a){i.lineWidth=(s||1)*r,i.stroke(e);return}const o=i.getLineDash();t&&i.save(),i.scale(r,a),H2.a=1/r,H2.d=1/a;const c=new Path2D;if(c.addPath(e,H2),o.length>0){const h=Math.max(r,a);i.setLineDash(o.map(d=>d/h)),i.lineDashOffset/=h}i.lineWidth=s||1,i.stroke(c),t&&i.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};ba=new WeakSet,$A=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},qA=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},VA=function(e,t,i){const s=new Path2D;return s.addPath(e,new DOMMatrix(i).invertSelf().multiplySelf(t)),s};let mf=MN;for(const n in n0)mf.prototype[n]!==void 0&&(mf.prototype[n0[n]]=mf.prototype[n]);var W0,Y0;class fa{static get workerPort(){return u(this,W0)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");k(this,W0,e)}static get workerSrc(){return u(this,Y0)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");k(this,Y0,e)}}W0=new WeakMap,Y0=new WeakMap,D(fa,W0,null),D(fa,Y0,"");var ep,X0;class PG{constructor({parsedData:e,rawData:t}){D(this,ep);D(this,X0);k(this,ep,e),k(this,X0,t)}getRaw(){return u(this,X0)}get(e){return u(this,ep).get(e)??null}[Symbol.iterator](){return u(this,ep).entries()}}ep=new WeakMap,X0=new WeakMap;const zd=Symbol("INTERNAL");var K0,Z0,Q0,tp;class IG{constructor(e,{name:t,intent:i,usage:s,rbGroups:r}){D(this,K0,!1);D(this,Z0,!1);D(this,Q0,!1);D(this,tp,!0);k(this,K0,!!(e&Zs.DISPLAY)),k(this,Z0,!!(e&Zs.PRINT)),this.name=t,this.intent=i,this.usage=s,this.rbGroups=r}get visible(){if(u(this,Q0))return u(this,tp);if(!u(this,tp))return!1;const{print:e,view:t}=this.usage;return u(this,K0)?(t==null?void 0:t.viewState)!=="OFF":u(this,Z0)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,i=!1){e!==zd&&zt("Internal method `_setVisible` called."),k(this,Q0,i),k(this,tp,t)}}K0=new WeakMap,Z0=new WeakMap,Q0=new WeakMap,tp=new WeakMap;var fc,tn,np,ip,J0,GA;class BG{constructor(e,t=Zs.DISPLAY){D(this,J0);D(this,fc,null);D(this,tn,new Map);D(this,np,null);D(this,ip,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,k(this,ip,e.order);for(const i of e.groups)u(this,tn).set(i.id,new IG(t,i));if(e.baseState==="OFF")for(const i of u(this,tn).values())i._setVisible(zd,!1);for(const i of e.on)u(this,tn).get(i)._setVisible(zd,!0);for(const i of e.off)u(this,tn).get(i)._setVisible(zd,!1);k(this,np,this.getHash())}}isVisible(e){if(u(this,tn).size===0)return!0;if(!e)return xw("Optional content group not defined."),!0;if(e.type==="OCG")return u(this,tn).has(e.id)?u(this,tn).get(e.id).visible:(ut(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return R(this,J0,GA).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!u(this,tn).has(t))return ut(`Optional content group not found: ${t}`),!0;if(u(this,tn).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!u(this,tn).has(t))return ut(`Optional content group not found: ${t}`),!0;if(!u(this,tn).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!u(this,tn).has(t))return ut(`Optional content group not found: ${t}`),!0;if(!u(this,tn).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!u(this,tn).has(t))return ut(`Optional content group not found: ${t}`),!0;if(u(this,tn).get(t).visible)return!1}return!0}return ut(`Unknown optional content policy ${e.policy}.`),!0}return ut(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,i=!0){var r;const s=u(this,tn).get(e);if(!s){ut(`Optional content group not found: ${e}`);return}if(i&&t&&s.rbGroups.length)for(const a of s.rbGroups)for(const o of a)o!==e&&((r=u(this,tn).get(o))==null||r._setVisible(zd,!1,!0));s._setVisible(zd,!!t,!0),k(this,fc,null)}setOCGState({state:e,preserveRB:t}){let i;for(const s of e){switch(s){case"ON":case"OFF":case"Toggle":i=s;continue}const r=u(this,tn).get(s);if(r)switch(i){case"ON":this.setVisibility(s,!0,t);break;case"OFF":this.setVisibility(s,!1,t);break;case"Toggle":this.setVisibility(s,!r.visible,t);break}}k(this,fc,null)}get hasInitialVisibility(){return u(this,np)===null||this.getHash()===u(this,np)}getOrder(){return u(this,tn).size?u(this,ip)?u(this,ip).slice():[...u(this,tn).keys()]:null}getGroup(e){return u(this,tn).get(e)||null}getHash(){if(u(this,fc)!==null)return u(this,fc);const e=new FL;for(const[t,i]of u(this,tn))e.update(`${t}:${i.visible}`);return k(this,fc,e.hexdigest())}[Symbol.iterator](){return u(this,tn).entries()}}fc=new WeakMap,tn=new WeakMap,np=new WeakMap,ip=new WeakMap,J0=new WeakSet,GA=function(e){const t=e.length;if(t<2)return!0;const i=e[0];for(let s=1;s<t;s++){const r=e[s];let a;if(Array.isArray(r))a=R(this,J0,GA).call(this,r);else if(u(this,tn).has(r))a=u(this,tn).get(r).visible;else return ut(`Optional content group not found: ${r}`),!0;switch(i){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return i==="And"};var ex,tx;class ww{constructor(e,t,i){D(this,ex,null);D(this,tx,null);we(this,"_fullReader",null);we(this,"_rangeReaders",new Set);we(this,"_source",null);this._source=e,k(this,ex,t),k(this,tx,i)}get _progressiveDataLength(){var e;return((e=this._fullReader)==null?void 0:e._loaded)??0}getFullReader(){return It(!this._fullReader,"BasePDFStream.getFullReader can only be called once."),this._fullReader=new(u(this,ex))(this)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new(u(this,tx))(this,e,t);return this._rangeReaders.add(i),i}cancelAllRequests(e){var t;(t=this._fullReader)==null||t.cancel(e);for(const i of new Set(this._rangeReaders))i.cancel(e)}}ex=new WeakMap,tx=new WeakMap;class Sw{constructor(e){we(this,"onProgress",null);we(this,"_contentLength",0);we(this,"_filename",null);we(this,"_headersCapability",Promise.withResolvers());we(this,"_isRangeSupported",!1);we(this,"_isStreamingSupported",!1);we(this,"_loaded",0);we(this,"_stream",null);this._stream=e}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){zt("Abstract method `read` called")}cancel(e){zt("Abstract method `cancel` called")}}class Aw{constructor(e,t,i){we(this,"_stream",null);this._stream=e}async read(){zt("Abstract method `read` called")}cancel(e){zt("Abstract method `cancel` called")}}function xD(n){return n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength?n.buffer:new Uint8Array(n).buffer}var nx,WA;class zG extends ww{constructor(t){super(t,FG,UG);D(this,nx);we(this,"_progressiveDone",!1);we(this,"_queuedChunks",[]);const{pdfDataRangeTransport:i}=t,{initialData:s,progressiveDone:r}=i;if((s==null?void 0:s.length)>0){const a=xD(s);this._queuedChunks.push(a)}this._progressiveDone=r,i.addRangeListener((a,o)=>{R(this,nx,WA).call(this,a,o)}),i.addProgressListener((a,o)=>{var c,h;o!==void 0&&((h=(c=this._fullReader)==null?void 0:c.onProgress)==null||h.call(c,{loaded:a,total:o}))}),i.addProgressiveReadListener(a=>{R(this,nx,WA).call(this,void 0,a)}),i.addProgressiveDoneListener(()=>{var a;(a=this._fullReader)==null||a.progressiveDone(),this._progressiveDone=!0}),i.transportReady()}getFullReader(){const t=super.getFullReader();return this._queuedChunks=null,t}getRangeReader(t,i){const s=super.getRangeReader(t,i);return s&&(s.onDone=()=>this._rangeReaders.delete(s),this._source.pdfDataRangeTransport.requestDataRange(t,i)),s}cancelAllRequests(t){super.cancelAllRequests(t),this._source.pdfDataRangeTransport.abort()}}nx=new WeakSet,WA=function(t,i){const s=xD(i);if(t===void 0)this._fullReader?this._fullReader._enqueue(s):this._queuedChunks.push(s);else{const r=this._rangeReaders.keys().find(a=>a._begin===t);It(r,"#onReceiveData - no `PDFDataTransportStreamRangeReader` instance found."),r._enqueue(s)}};class FG extends Sw{constructor(t){super(t);we(this,"_done",!1);we(this,"_queuedChunks",null);we(this,"_requests",[]);const{pdfDataRangeTransport:i,disableRange:s,disableStream:r}=t._source,{length:a,contentDispositionFilename:o}=i;this._queuedChunks=t._queuedChunks||[];for(const c of this._queuedChunks)this._loaded+=c.byteLength;this._done=t._progressiveDone,this._contentLength=a,this._isStreamingSupported=!r,this._isRangeSupported=!s,wN(o)&&(this._filename=o),this._headersCapability.resolve()}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class UG extends Aw{constructor(t,i,s){super(t,i,s);we(this,"onDone",null);we(this,"_begin",-1);we(this,"_done",!1);we(this,"_queuedChunk",null);we(this,"_requests",[]);this._begin=i}_enqueue(t){var i;if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,(i=this.onDone)==null||i.call(this)}}async read(){if(this._queuedChunk){const i=this._queuedChunk;return this._queuedChunk=null,{value:i,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){var i;this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,(i=this.onDone)==null||i.call(this)}}function HG(n){let e=!0,t=i("filename\\*","i").exec(n);if(t){t=t[1];let d=o(t);return d=unescape(d),d=c(d),d=h(d),r(d)}if(t=a(n),t){const d=h(t);return r(d)}if(t=i("filename","i").exec(n),t){t=t[1];let d=o(t);return d=h(d),r(d)}function i(d,f){return new RegExp("(?:^|;)\\s*"+d+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',f)}function s(d,f){if(d){if(!/^[\x00-\xFF]+$/.test(f))return f;try{const p=new TextDecoder(d,{fatal:!0}),g=yw(f);f=p.decode(g),e=!1}catch{}}return f}function r(d){return e&&/[\x80-\xff]/.test(d)&&(d=s("utf-8",d),e&&(d=s("iso-8859-1",d))),d}function a(d){const f=[];let p;const g=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(p=g.exec(d))!==null;){let[,b,x,m]=p;if(b=parseInt(b,10),b in f){if(b===0)break;continue}f[b]=[x,m]}const v=[];for(let b=0;b<f.length&&b in f;++b){let[x,m]=f[b];m=o(m),x&&(m=unescape(m),b===0&&(m=c(m))),v.push(m)}return v.join("")}function o(d){if(d.startsWith('"')){const f=d.slice(1).split('\\"');for(let p=0;p<f.length;++p){const g=f[p].indexOf('"');g!==-1&&(f[p]=f[p].slice(0,g),f.length=p+1),f[p]=f[p].replaceAll(/\\(.)/g,"$1")}d=f.join('"')}return d}function c(d){const f=d.indexOf("'");if(f===-1)return d;const p=d.slice(0,f),v=d.slice(f+1).replace(/^[^']*'/,"");return s(p,v)}function h(d){return!d.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(d)?d:d.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(f,p,g,v){if(g==="q"||g==="Q")return v=v.replaceAll("_"," "),v=v.replaceAll(/=([0-9a-fA-F]{2})/g,function(b,x){return String.fromCharCode(parseInt(x,16))}),s(p,v);try{v=atob(v)}catch{}return s(p,v)})}return""}function QL(n,e){const t=new Headers;if(!n||!e||typeof e!="object")return t;for(const i in e){const s=e[i];s!==void 0&&t.append(i,s)}return t}function Ew(n){var e;return((e=URL.parse(n))==null?void 0:e.origin)??null}function JL({responseHeaders:n,isHttp:e,rangeChunkSize:t,disableRange:i}){const s={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(n.get("Content-Length"),10);return!Number.isInteger(r)||(s.suggestedLength=r,r<=2*t)||i||!e||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(s.allowRangeRequests=!0),s}function eM(n){const e=n.get("Content-Disposition");if(e){let t=HG(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(wN(t))return t}return null}function Cw(n,e){return new e1(`Unexpected server response (${n}) while retrieving PDF "${e}".`,n,n===404||n===0&&e.startsWith("file:"))}function tM(n,e){if(n!==e)throw new Error(`Expected range response-origin "${n}" to match "${e}".`)}function nM(n,e,t,i){return fetch(n,{method:"GET",headers:e,signal:i.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"})}function iM(n,e){if(n!==200&&n!==206)throw Cw(n,e)}function sM(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(ut(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class $G extends ww{constructor(t){super(t,qG,VG);we(this,"_responseOrigin",null);this.isHttp=/^https?:/i.test(t.url),this.headers=QL(this.isHttp,t.httpHeaders)}}class qG extends Sw{constructor(t){super(t);we(this,"_abortController",new AbortController);we(this,"_reader",null);const{disableRange:i,disableStream:s,length:r,rangeChunkSize:a,url:o,withCredentials:c}=t._source;this._contentLength=r,this._isStreamingSupported=!s,this._isRangeSupported=!i;const h=new Headers(t.headers);nM(o,h,c,this._abortController).then(d=>{t._responseOrigin=Ew(d.url),iM(d.status,o),this._reader=d.body.getReader();const f=d.headers,{allowRangeRequests:p,suggestedLength:g}=JL({responseHeaders:f,isHttp:t.isHttp,rangeChunkSize:a,disableRange:i});this._isRangeSupported=p,this._contentLength=g||this._contentLength,this._filename=eM(f),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new au("Streaming is disabled.")),this._headersCapability.resolve()}).catch(this._headersCapability.reject)}async read(){var s;await this._headersCapability.promise;const{value:t,done:i}=await this._reader.read();return i?{value:t,done:i}:(this._loaded+=t.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:sM(t),done:!1})}cancel(t){var i;(i=this._reader)==null||i.cancel(t),this._abortController.abort()}}class VG extends Aw{constructor(t,i,s){super(t,i,s);we(this,"_abortController",new AbortController);we(this,"_readCapability",Promise.withResolvers());we(this,"_reader",null);const{url:r,withCredentials:a}=t._source,o=new Headers(t.headers);o.append("Range",`bytes=${i}-${s-1}`),nM(r,o,a,this._abortController).then(c=>{const h=Ew(c.url);tM(h,t._responseOrigin),iM(c.status,r),this._reader=c.body.getReader(),this._readCapability.resolve()}).catch(this._readCapability.reject)}async read(){await this._readCapability.promise;const{value:t,done:i}=await this._reader.read();return i?{value:t,done:i}:{value:sM(t),done:!1}}cancel(t){var i;(i=this._reader)==null||i.cancel(t),this._abortController.abort()}}const $2=200,yD=206;function GG(n){return typeof n!="string"?n:yw(n).buffer}var Fa,cg,rM,aM;class WG extends ww{constructor(t){super(t,YG,XG);D(this,cg);D(this,Fa,new WeakMap);we(this,"_responseOrigin",null);this.url=t.url,this.isHttp=/^https?:/i.test(this.url),this.headers=QL(this.isHttp,t.httpHeaders)}_request(t){const i=new XMLHttpRequest,s={validateStatus:null,onHeadersReceived:t.onHeadersReceived,onDone:t.onDone,onError:t.onError,onProgress:t.onProgress};u(this,Fa).set(i,s),i.open("GET",this.url),i.withCredentials=this._source.withCredentials;for(const[r,a]of this.headers)i.setRequestHeader(r,a);return this.isHttp&&"begin"in t&&"end"in t?(i.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),s.validateStatus=r=>r===yD||r===$2):s.validateStatus=r=>r===$2,i.responseType="arraybuffer",It(t.onError,"Expected `onError` callback to be provided."),i.onerror=()=>t.onError(i.status),i.onreadystatechange=R(this,cg,aM).bind(this,i),i.onprogress=R(this,cg,rM).bind(this,i),i.send(null),i}_abortRequest(t){u(this,Fa).has(t)&&(u(this,Fa).delete(t),t.abort())}getRangeReader(t,i){const s=super.getRangeReader(t,i);return s&&(s.onClosed=()=>this._rangeReaders.delete(s)),s}}Fa=new WeakMap,cg=new WeakSet,rM=function(t,i){var r;const s=u(this,Fa).get(t);(r=s==null?void 0:s.onProgress)==null||r.call(s,i)},aM=function(t,i){const s=u(this,Fa).get(t);if(!s||(t.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),t.readyState!==4)||!u(this,Fa).has(t))return;if(u(this,Fa).delete(t),t.status===0&&this.isHttp){s.onError(t.status);return}const r=t.status||$2;if(!s.validateStatus(r)){s.onError(t.status);return}const a=GG(t.response);if(r===yD){const o=t.getResponseHeader("Content-Range");/bytes (\d+)-(\d+)\/(\d+)/.test(o)?s.onDone(a):(ut('Missing or invalid "Content-Range" header.'),s.onError(0))}else a?s.onDone(a):s.onError(t.status)};var ao,oM,lM,cM,uM;class YG extends Sw{constructor(t){super(t);D(this,ao);we(this,"_cachedChunks",[]);we(this,"_done",!1);we(this,"_requests",[]);we(this,"_storedError",null);const{length:i}=t._source;this._contentLength=i,this._fullRequestXhr=t._request({onHeadersReceived:R(this,ao,oM).bind(this),onDone:R(this,ao,lM).bind(this),onError:R(this,ao,cM).bind(this),onProgress:R(this,ao,uM).bind(this)})}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._abortRequest(this._fullRequestXhr),this._fullRequestXhr=null}}ao=new WeakSet,oM=function(){const t=this._stream,{disableRange:i,rangeChunkSize:s}=t._source,r=this._fullRequestXhr;t._responseOrigin=Ew(r.responseURL);const a=r.getAllResponseHeaders(),o=new Headers(a?a.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(d=>{const[f,...p]=d.split(": ");return[f,p.join(": ")]}):[]),{allowRangeRequests:c,suggestedLength:h}=JL({responseHeaders:o,isHttp:t.isHttp,rangeChunkSize:s,disableRange:i});c&&(this._isRangeSupported=!0),this._contentLength=h||this._contentLength,this._filename=eM(o),this._isRangeSupported&&t._abortRequest(r),this._headersCapability.resolve()},lM=function(t){if(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._cachedChunks.push(t),this._done=!0,!(this._cachedChunks.length>0)){for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}},cM=function(t){this._storedError=Cw(t,this._stream.url),this._headersCapability.reject(this._storedError);for(const i of this._requests)i.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0},uM=function(t){var i;(i=this.onProgress)==null||i.call(this,{loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})};var Dl,hM,dM,YA;class XG extends Aw{constructor(t,i,s){super(t,i,s);D(this,Dl);we(this,"onClosed",null);we(this,"_done",!1);we(this,"_queuedChunk",null);we(this,"_requests",[]);we(this,"_storedError",null);this._requestXhr=t._request({begin:i,end:s,onHeadersReceived:R(this,Dl,hM).bind(this),onDone:R(this,Dl,dM).bind(this),onError:R(this,Dl,YA).bind(this),onProgress:null})}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const i=this._queuedChunk;return this._queuedChunk=null,{value:i,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){var i;this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._abortRequest(this._requestXhr),(i=this.onClosed)==null||i.call(this)}}Dl=new WeakSet,hM=function(){var i;const t=Ew((i=this._requestXhr)==null?void 0:i.responseURL);try{tM(t,this._stream._responseOrigin)}catch(s){this._storedError=s,R(this,Dl,YA).call(this,0)}},dM=function(t){var i;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,(i=this.onClosed)==null||i.call(this)},YA=function(t){this._storedError??(this._storedError=Cw(t,this._stream.url));for(const i of this._requests)i.reject(this._storedError);this._requests.length=0,this._queuedChunk=null};const KG=/^[a-z][a-z0-9\-+.]+:/i;function ZG(n){if(KG.test(n))return new URL(n);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(n))}function fM(n){const{Readable:e}=process.getBuiltinModule("stream");return typeof e.toWeb=="function"?e.toWeb(n):process.getBuiltinModule("module").createRequire(import.meta.url)("node-readable-to-web-readable-stream").makeDefaultReadableStreamFromNodeReadable(n)}function pM(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(ut(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class QG extends ww{constructor(e){super(e,JG,eW),this.url=ZG(e.url),It(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs.")}}class JG extends Sw{constructor(t){super(t);we(this,"_reader",null);const{disableRange:i,disableStream:s,length:r,rangeChunkSize:a}=t._source;this._contentLength=r,this._isStreamingSupported=!s,this._isRangeSupported=!i;const o=t.url,c=process.getBuiltinModule("fs");c.promises.lstat(o).then(h=>{const d=c.createReadStream(o),f=fM(d);this._reader=f.getReader();const{size:p}=h;p<=2*a&&(this._isRangeSupported=!1),this._contentLength=p,!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new au("Streaming is disabled.")),this._headersCapability.resolve()}).catch(h=>{h.code==="ENOENT"&&(h=Cw(0,o.href)),this._headersCapability.reject(h)})}async read(){var s;await this._headersCapability.promise;const{value:t,done:i}=await this._reader.read();return i?{value:t,done:i}:(this._loaded+=t.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:pM(t),done:!1})}cancel(t){var i;(i=this._reader)==null||i.cancel(t)}}class eW extends Aw{constructor(t,i,s){super(t,i,s);we(this,"_readCapability",Promise.withResolvers());we(this,"_reader",null);const r=t.url,a=process.getBuiltinModule("fs");try{const o=a.createReadStream(r,{start:i,end:s-1}),c=fM(o);this._reader=c.getReader(),this._readCapability.resolve()}catch(o){this._readCapability.reject(o)}}async read(){await this._readCapability.promise;const{value:t,done:i}=await this._reader.read();return i?{value:t,done:i}:{value:pM(t),done:!1}}cancel(t){var i;(i=this._reader)==null||i.cancel(t)}}const Fg=Symbol("INITIAL_DATA");var Ps,ix,XA;class gM{constructor(){D(this,ix);D(this,Ps,Object.create(null))}get(e,t=null){if(t){const s=R(this,ix,XA).call(this,e);return s.promise.then(()=>t(s.data)),null}const i=u(this,Ps)[e];if(!i||i.data===Fg)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return i.data}has(e){const t=u(this,Ps)[e];return!!t&&t.data!==Fg}delete(e){const t=u(this,Ps)[e];return!t||t.data===Fg?!1:(delete u(this,Ps)[e],!0)}resolve(e,t=null){const i=R(this,ix,XA).call(this,e);i.data=t,i.resolve()}clear(){var e;for(const t in u(this,Ps)){const{data:i}=u(this,Ps)[t];(e=i==null?void 0:i.bitmap)==null||e.close()}k(this,Ps,Object.create(null))}*[Symbol.iterator](){for(const e in u(this,Ps)){const{data:t}=u(this,Ps)[e];t!==Fg&&(yield[e,t])}}}Ps=new WeakMap,ix=new WeakSet,XA=function(e){var t;return(t=u(this,Ps))[e]||(t[e]={...Promise.withResolvers(),data:Fg})};const tW=1e5,vD=30;var $D,pc,ms,sx,rx,th,Uo,ax,ox,nh,lx,sp,gc,rp,cx,ap,ih,ux,hx,op,sh,dx,lp,cp,jl,mM,xM,KA,cr,Pv,ZA,yM,vM;const Si=class Si{constructor({textContentSource:e,container:t,viewport:i}){D(this,jl);D(this,pc,Promise.withResolvers());D(this,ms,null);D(this,sx,!1);D(this,rx,!!(($D=globalThis.FontInspector)!=null&&$D.enabled));D(this,th,null);D(this,Uo,null);D(this,ax,0);D(this,ox,0);D(this,nh,null);D(this,lx,null);D(this,sp,0);D(this,gc,0);D(this,rp,Object.create(null));D(this,cx,[]);D(this,ap,null);D(this,ih,[]);D(this,ux,new WeakMap);D(this,hx,null);var c;if(e instanceof ReadableStream)k(this,ap,e);else if(typeof e=="object")k(this,ap,new ReadableStream({start(h){h.enqueue(e),h.close()}}));else throw new Error('No "textContentSource" parameter specified.');k(this,ms,k(this,lx,t)),k(this,gc,i.scale*ro.pixelRatio),k(this,sp,i.rotation),k(this,Uo,{div:null,properties:null,ctx:null});const{pageWidth:s,pageHeight:r,pageX:a,pageY:o}=i.rawDims;k(this,hx,[1,0,0,-1,-a,o+r]),k(this,ox,s),k(this,ax,r),R(c=Si,cr,yM).call(c),t.style.setProperty("--min-font-size",u(Si,lp)),Zh(t,i),u(this,pc).promise.finally(()=>{u(Si,cp).delete(this),k(this,Uo,null),k(this,rp,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=li.platform;return ht(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{u(this,nh).read().then(({value:t,done:i})=>{if(i){u(this,pc).resolve();return}u(this,th)??k(this,th,t.lang),Object.assign(u(this,rp),t.styles),R(this,jl,mM).call(this,t.items),e()},u(this,pc).reject)};return k(this,nh,u(this,ap).getReader()),u(Si,cp).add(this),e(),u(this,pc).promise}update({viewport:e,onBefore:t=null}){var r;const i=e.scale*ro.pixelRatio,s=e.rotation;if(s!==u(this,sp)&&(t==null||t(),k(this,sp,s),Zh(u(this,lx),{rotation:s})),i!==u(this,gc)){t==null||t(),k(this,gc,i);const a={div:null,properties:null,ctx:R(r=Si,cr,Pv).call(r,u(this,th))};for(const o of u(this,ih))a.properties=u(this,ux).get(o),a.div=o,R(this,jl,KA).call(this,a)}}cancel(){var t;const e=new au("TextLayer task cancelled.");(t=u(this,nh))==null||t.cancel(e).catch(()=>{}),k(this,nh,null),u(this,pc).reject(e)}get textDivs(){return u(this,ih)}get textContentItemsStr(){return u(this,cx)}static cleanup(){if(!(u(this,cp).size>0)){u(this,op).clear();for(const{canvas:e}of u(this,sh).values())e.remove();u(this,sh).clear()}}};pc=new WeakMap,ms=new WeakMap,sx=new WeakMap,rx=new WeakMap,th=new WeakMap,Uo=new WeakMap,ax=new WeakMap,ox=new WeakMap,nh=new WeakMap,lx=new WeakMap,sp=new WeakMap,gc=new WeakMap,rp=new WeakMap,cx=new WeakMap,ap=new WeakMap,ih=new WeakMap,ux=new WeakMap,hx=new WeakMap,op=new WeakMap,sh=new WeakMap,dx=new WeakMap,lp=new WeakMap,cp=new WeakMap,jl=new WeakSet,mM=function(e){var s,r;if(u(this,sx))return;(r=u(this,Uo)).ctx??(r.ctx=R(s=Si,cr,Pv).call(s,u(this,th)));const t=u(this,ih),i=u(this,cx);for(const a of e){if(t.length>tW){ut("Ignoring additional textDivs for performance reasons."),k(this,sx,!0);return}if(a.str===void 0){if(a.type==="beginMarkedContentProps"||a.type==="beginMarkedContent"){const o=u(this,ms);k(this,ms,document.createElement("span")),u(this,ms).classList.add("markedContent"),a.id&&u(this,ms).setAttribute("id",`${a.id}`),a.tag==="Artifact"&&(u(this,ms).ariaHidden=!0),o.append(u(this,ms))}else a.type==="endMarkedContent"&&k(this,ms,u(this,ms).parentNode);continue}i.push(a.str),R(this,jl,xM).call(this,a)}},xM=function(e){var v;const t=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};u(this,ih).push(t);const s=$e.transform(u(this,hx),e.transform);let r=Math.atan2(s[1],s[0]);const a=u(this,rp)[e.fontName];a.vertical&&(r+=Math.PI/2);let o=u(this,rx)&&a.fontSubstitution||a.fontFamily;o=Si.fontFamilyMap.get(o)||o;const c=Math.hypot(s[2],s[3]),h=c*R(v=Si,cr,vM).call(v,o,a,u(this,th));let d,f;r===0?(d=s[4],f=s[5]-h):(d=s[4]+h*Math.sin(r),f=s[5]-h*Math.cos(r));const p=t.style;p.left=`${(100*d/u(this,ox)).toFixed(2)}%`,p.top=`${(100*f/u(this,ax)).toFixed(2)}%`,p.setProperty("--font-height",`${c.toFixed(2)}px`),p.fontFamily=o,i.fontSize=c,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,u(this,rx)&&(t.dataset.fontName=a.fontSubstitutionLoadedName||e.fontName),r!==0&&(i.angle=r*(180/Math.PI));let g=!1;if(e.str.length>1)g=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const b=Math.abs(e.transform[0]),x=Math.abs(e.transform[3]);b!==x&&Math.max(b,x)/Math.min(b,x)>1.5&&(g=!0)}if(g&&(i.canvasWidth=a.vertical?e.height:e.width),u(this,ux).set(t,i),u(this,Uo).div=t,u(this,Uo).properties=i,R(this,jl,KA).call(this,u(this,Uo)),i.hasText&&u(this,ms).append(t),i.hasEOL){const b=document.createElement("br");b.setAttribute("role","presentation"),u(this,ms).append(b)}},KA=function(e){var a;const{div:t,properties:i,ctx:s}=e,{style:r}=t;if(i.canvasWidth!==0&&i.hasText){const{fontFamily:o}=r,{canvasWidth:c,fontSize:h}=i;R(a=Si,cr,ZA).call(a,s,h*u(this,gc),o);const{width:d}=s.measureText(t.textContent);d>0&&r.setProperty("--scale-x",c*u(this,gc)/d)}i.angle!==0&&r.setProperty("--rotate",`${i.angle}deg`)},cr=new WeakSet,Pv=function(e=null){let t=u(this,sh).get(e||(e=""));if(!t){const i=document.createElement("canvas");i.className="hiddenCanvasElement",i.lang=e,document.body.append(i),t=i.getContext("2d",{alpha:!1,willReadFrequently:!0}),u(this,sh).set(e,t),u(this,dx).set(t,{size:0,family:""})}return t},ZA=function(e,t,i){const s=u(this,dx).get(e);t===s.size&&i===s.family||(e.font=`${t}px ${i}`,s.size=t,s.family=i)},yM=function(){if(u(this,lp)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),k(this,lp,e.getBoundingClientRect().height),e.remove()},vM=function(e,t,i){const s=u(this,op).get(e);if(s)return s;const r=R(this,cr,Pv).call(this,i);r.canvas.width=r.canvas.height=vD,R(this,cr,ZA).call(this,r,vD,e);const a=r.measureText(""),o=a.fontBoundingBoxAscent,c=Math.abs(a.fontBoundingBoxDescent);r.canvas.width=r.canvas.height=0;let h=.8;return o?h=o/(o+c):(li.platform.isFirefox&&ut("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?h=t.ascent:t.descent&&(h=1+t.descent)),u(this,op).set(e,h),h},D(Si,cr),D(Si,op,new Map),D(Si,sh,new Map),D(Si,dx,new WeakMap),D(Si,lp,null),D(Si,cp,new Set);let og=Si;const nW=100;function CN(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const e=new QA,{docId:t}=e,i=n.url?uG(n.url):null,s=n.data?hG(n.data):null,r=n.httpHeaders||null,a=n.withCredentials===!0,o=n.password??null,c=n.range instanceof bM?n.range:null,h=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:2**16;let d=n.worker instanceof r0?n.worker:null;const f=n.verbosity,p=typeof n.docBaseUrl=="string"&&!bw(n.docBaseUrl)?n.docBaseUrl:null,g=Qy(n.cMapUrl),v=n.cMapPacked!==!1,b=n.CMapReaderFactory||(ns?vG:iD),x=Qy(n.iccUrl),m=Qy(n.standardFontDataUrl),y=n.StandardFontDataFactory||(ns?bG:sD),w=Qy(n.wasmUrl),E=n.WasmFactory||(ns?wG:rD),S=n.stopAtErrors!==!0,_=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,T=n.isEvalSupported!==!1,j=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!ns,M=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!ns&&(li.platform.isFirefox||!globalThis.chrome),L=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,O=typeof n.disableFontFace=="boolean"?n.disableFontFace:ns,B=n.fontExtraProperties===!0,G=n.enableXfa===!0,W=n.ownerDocument||globalThis.document,J=n.disableRange===!0,V=n.disableStream===!0,H=n.disableAutoFetch===!0,P=n.pdfBug===!0,Y=n.CanvasFactory||(ns?yG:gG),ge=n.FilterFactory||(ns?xG:mG),ae=n.enableHWA===!0,ee=n.useWasm!==!1,le=c?c.length:n.length??NaN,ie=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!ns&&!O,Q=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:!!(b===iD&&y===sD&&E===rD&&g&&m&&w&&Yg(g,document.baseURI)&&Yg(m,document.baseURI)&&Yg(w,document.baseURI)),Z=null;IV(f);const re={canvasFactory:new Y({ownerDocument:W,enableHWA:ae}),filterFactory:new ge({docId:t,ownerDocument:W}),cMapReaderFactory:Q?null:new b({baseUrl:g,isCompressed:v}),standardFontDataFactory:Q?null:new y({baseUrl:m}),wasmFactory:Q?null:new E({baseUrl:w})};d||(d=r0.create({verbosity:f,port:fa.workerPort}),e._worker=d);const se={docId:t,apiVersion:"5.4.624",data:s,password:o,disableAutoFetch:H,rangeChunkSize:h,length:le,docBaseUrl:p,enableXfa:G,evaluatorOptions:{maxImageSize:_,disableFontFace:O,ignoreErrors:S,isEvalSupported:T,isOffscreenCanvasSupported:j,isImageDecoderSupported:M,canvasMaxAreaInBytes:L,fontExtraProperties:B,useSystemFonts:ie,useWasm:ee,useWorkerFetch:Q,cMapUrl:g,iccUrl:x,standardFontDataUrl:m,wasmUrl:w}},be={ownerDocument:W,pdfBug:P,styleElement:Z,enableHWA:ae,loadingParams:{disableAutoFetch:H,enableXfa:G}};return d.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const pe=d.messageHandler.sendWithPromise("GetDocRequest",se,s?[s.buffer]:null);let me;if(c)me=new zG({pdfDataRangeTransport:c,disableRange:J,disableStream:V});else if(!s){if(!i)throw new Error("getDocument - no `url` parameter provided.");const Ne=Yg(i)?$G:ns?QG:WG;me=new Ne({url:i,length:le,httpHeaders:r,withCredentials:a,rangeChunkSize:h,disableRange:J,disableStream:V})}return pe.then(Ne=>{if(e.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const ve=new nm(t,Ne,d.port),_e=new rW(ve,e,me,be,re);e._transport=_e,ve.send("Ready",null)})}).catch(e._capability.reject),e}var S1;const A1=class A1{constructor(){we(this,"_capability",Promise.withResolvers());we(this,"_transport",null);we(this,"_worker",null);we(this,"docId",`d${ni(A1,S1)._++}`);we(this,"destroyed",!1);we(this,"onPassword",null);we(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var e,t,i,s;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(r){throw(i=this._worker)!=null&&i.port&&delete this._worker._pendingDestroy,r}this._transport=null,(s=this._worker)==null||s.destroy(),this._worker=null}async getData(){return this._transport.getData()}};S1=new WeakMap,D(A1,S1,0);let QA=A1;var rh,fx,px,gx,mx;class bM{constructor(e,t,i=!1,s=null){D(this,rh,Promise.withResolvers());D(this,fx,[]);D(this,px,[]);D(this,gx,[]);D(this,mx,[]);this.length=e,this.initialData=t,this.progressiveDone=i,this.contentDispositionFilename=s}addRangeListener(e){u(this,mx).push(e)}addProgressListener(e){u(this,gx).push(e)}addProgressiveReadListener(e){u(this,px).push(e)}addProgressiveDoneListener(e){u(this,fx).push(e)}onDataRange(e,t){for(const i of u(this,mx))i(e,t)}onDataProgress(e,t){u(this,rh).promise.then(()=>{for(const i of u(this,gx))i(e,t)})}onDataProgressiveRead(e){u(this,rh).promise.then(()=>{for(const t of u(this,px))t(e)})}onDataProgressiveDone(){u(this,rh).promise.then(()=>{for(const e of u(this,fx))e()})}transportReady(){u(this,rh).resolve()}requestDataRange(e,t){zt("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}rh=new WeakMap,fx=new WeakMap,px=new WeakMap,gx=new WeakMap,mx=new WeakMap;class iW{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return ht(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(e,t){return this._transport.getAnnotationsByType(e,t)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}extractPages(e){return this._transport.extractPages(e)}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var Ho,xx,ah,om;class sW{constructor(e,t,i,s=!1){D(this,ah);D(this,Ho,!1);D(this,xx,s0.instance);this._pageIndex=e,this._pageInfo=t,this._transport=i,this._stats=s?new KT:null,this._pdfBug=s,this.commonObjs=i.commonObjs,this.objs=new gM,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}set pageNumber(e){this._pageIndex=e-1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:i=0,offsetY:s=0,dontFlip:r=!1}={}){return new Sy({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:i,offsetY:s,dontFlip:r})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return ht(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,canvas:t=e.canvas,viewport:i,intent:s="display",annotationMode:r=Hl.ENABLE,transform:a=null,background:o=null,optionalContentConfigPromise:c=null,annotationCanvasMap:h=null,pageColors:d=null,printAnnotationStorage:f=null,isEditing:p=!1,recordOperations:g=!1,operationsFilter:v=null}){var M,L,O;(M=this._stats)==null||M.time("Overall");const b=this._transport.getRenderingIntent(s,r,f,p),{renderingIntent:x,cacheKey:m}=b;k(this,Ho,!1),c||(c=this._transport.getOptionalContentConfig(x));let y=this._intentStates.get(m);y||(y=Object.create(null),this._intentStates.set(m,y)),y.streamReaderCancelTimeout&&(clearTimeout(y.streamReaderCancelTimeout),y.streamReaderCancelTimeout=null);const w=!!(x&Zs.PRINT);y.displayReadyCapability||(y.displayReadyCapability=Promise.withResolvers(),y.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(L=this._stats)==null||L.time("Page Request"),this._pumpOperatorList(b));const E=!!(this._pdfBug&&((O=globalThis.StepperManager)!=null&&O.enabled)),S=!this.recordedBBoxes&&(g||E),_=B=>{var G,W;if(y.renderTasks.delete(T),S){const J=(G=T.gfx)==null?void 0:G.dependencyTracker.take();J&&(T.stepper&&T.stepper.setOperatorBBoxes(J,T.gfx.dependencyTracker.takeDebugMetadata()),g&&(this.recordedBBoxes=J))}w&&k(this,Ho,!0),R(this,ah,om).call(this),B?(T.capability.reject(B),this._abortOperatorList({intentState:y,reason:B instanceof Error?B:new Error(B)})):T.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(W=globalThis.Stats)!=null&&W.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},T=new JA({callback:_,params:{canvas:t,canvasContext:e,dependencyTracker:S?new AG(t,y.operatorList.length,E):null,viewport:i,transform:a,background:o},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:h,operatorList:y.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!w,pdfBug:this._pdfBug,pageColors:d,enableHWA:this._transport.enableHWA,operationsFilter:v});(y.renderTasks||(y.renderTasks=new Set)).add(T);const j=T.task;return Promise.all([y.displayReadyCapability.promise,c]).then(([B,G])=>{var W;if(this.destroyed){_();return}if((W=this._stats)==null||W.time("Rendering"),!(G.renderingIntent&x))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");T.initializeGraphics({transparency:B,optionalContentConfig:G}),T.operatorListChanged()}).catch(_),j}getOperatorList({intent:e="display",annotationMode:t=Hl.ENABLE,printAnnotationStorage:i=null,isEditing:s=!1}={}){var h;function r(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(c))}const a=this._transport.getRenderingIntent(e,t,i,s,!0);let o=this._intentStates.get(a.cacheKey);o||(o=Object.create(null),this._intentStates.set(a.cacheKey,o));let c;return o.opListReadCapability||(c=Object.create(null),c.operatorListChanged=r,o.opListReadCapability=Promise.withResolvers(),(o.renderTasks||(o.renderTasks=new Set)).add(c),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(h=this._stats)==null||h.time("Page Request"),this._pumpOperatorList(a)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageId:u(this,xx).getPageId(this._pageIndex+1)-1,pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(s){return s.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>i0.textContent(i));const t=this.streamTextContent(e);return new Promise(function(i,s){function r(){a.read().then(function({value:c,done:h}){if(h){i(o);return}o.lang??(o.lang=c.lang),Object.assign(o.styles,c.styles),o.items.push(...c.items),r()},s)}const a=t.getReader(),o={items:[],styles:Object.create(null),lang:null};r()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const i of t.renderTasks)e.push(i.completed),i.cancel();return this.objs.clear(),k(this,Ho,!1),Promise.all(e)}cleanup(e=!1){k(this,Ho,!0);const t=R(this,ah,om).call(this);return e&&t&&this._stats&&(this._stats=new KT),t}_startRenderPage(e,t){var s,r;const i=this._intentStates.get(t);i&&((s=this._stats)==null||s.timeEnd("Page Request"),(r=i.displayReadyCapability)==null||r.resolve(e))}_renderPageChunk(e,t){for(let i=0,s=e.length;i<s;i++)t.operatorList.fnArray.push(e.fnArray[i]),t.operatorList.argsArray.push(e.argsArray[i]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const i of t.renderTasks)i.operatorListChanged();e.lastChunk&&R(this,ah,om).call(this)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:i,modifiedIds:s}){const{map:r,transfer:a}=i,c=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageId:u(this,xx).getPageId(this._pageIndex+1)-1,pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:r,modifiedIds:s},a).getReader(),h=this._intentStates.get(t);h.streamReader=c;const d=()=>{c.read().then(({value:f,done:p})=>{if(p){h.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(f,h),d())},f=>{if(h.streamReader=null,!this._transport.destroyed){if(h.operatorList){h.operatorList.lastChunk=!0;for(const p of h.renderTasks)p.operatorListChanged();R(this,ah,om).call(this)}if(h.displayReadyCapability)h.displayReadyCapability.reject(f);else if(h.opListReadCapability)h.opListReadCapability.reject(f);else throw f}})};d()}_abortOperatorList({intentState:e,reason:t,force:i=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!i){if(e.renderTasks.size>0)return;if(t instanceof vw){let s=nW;t.extraDelay>0&&t.extraDelay<1e3&&(s+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},s);return}}if(e.streamReader.cancel(new au(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[s,r]of this._intentStates)if(r===e){this._intentStates.delete(s);break}this.cleanup()}}}get stats(){return this._stats}}Ho=new WeakMap,xx=new WeakMap,ah=new WeakSet,om=function(){if(!u(this,Ho)||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),k(this,Ho,!1),!0};var mc,sa,$o,oh,E1,lh,ch,ss,Iv,wM,SM,lm,up,Bv;const bn=class bn{constructor({name:e=null,port:t=null,verbosity:i=BV()}={}){D(this,ss);D(this,mc,Promise.withResolvers());D(this,sa,null);D(this,$o,null);D(this,oh,null);if(this.name=e,this.destroyed=!1,this.verbosity=i,t){if(u(bn,ch).has(t))throw new Error("Cannot use more than one PDFWorker per port.");u(bn,ch).set(t,this),R(this,ss,wM).call(this,t)}else R(this,ss,SM).call(this)}get promise(){return u(this,mc).promise}get port(){return u(this,$o)}get messageHandler(){return u(this,sa)}destroy(){var e,t;this.destroyed=!0,(e=u(this,oh))==null||e.terminate(),k(this,oh,null),u(bn,ch).delete(u(this,$o)),k(this,$o,null),(t=u(this,sa))==null||t.destroy(),k(this,sa,null)}static create(e){const t=u(this,ch).get(e==null?void 0:e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new bn(e)}static get workerSrc(){if(fa.workerSrc)return fa.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return ht(this,"_setupFakeWorkerGlobal",(async()=>u(this,up,Bv)?u(this,up,Bv):(await import(this.workerSrc)).WorkerMessageHandler)())}};mc=new WeakMap,sa=new WeakMap,$o=new WeakMap,oh=new WeakMap,E1=new WeakMap,lh=new WeakMap,ch=new WeakMap,ss=new WeakSet,Iv=function(){u(this,mc).resolve(),u(this,sa).send("configure",{verbosity:this.verbosity})},wM=function(e){k(this,$o,e),k(this,sa,new nm("main","worker",e)),u(this,sa).on("ready",()=>{}),R(this,ss,Iv).call(this)},SM=function(){if(u(bn,lh)||u(bn,up,Bv)){R(this,ss,lm).call(this);return}let{workerSrc:e}=bn;try{bn._isSameOrigin(window.location,e)||(e=bn._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),i=new nm("main","worker",t),s=()=>{r.abort(),i.destroy(),t.terminate(),this.destroyed?u(this,mc).reject(new Error("Worker was destroyed")):R(this,ss,lm).call(this)},r=new AbortController;t.addEventListener("error",()=>{u(this,oh)||s()},{signal:r.signal}),i.on("test",o=>{if(r.abort(),this.destroyed||!o){s();return}k(this,sa,i),k(this,$o,t),k(this,oh,t),R(this,ss,Iv).call(this)}),i.on("ready",o=>{if(r.abort(),this.destroyed){s();return}try{a()}catch{R(this,ss,lm).call(this)}});const a=()=>{const o=new Uint8Array;i.send("test",o,[o.buffer])};a();return}catch{xw("The worker has been disabled.")}R(this,ss,lm).call(this)},lm=function(){u(bn,lh)||(ut("Setting up fake worker."),k(bn,lh,!0)),bn._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){u(this,mc).reject(new Error("Worker was destroyed"));return}const t=new pG;k(this,$o,t);const i=`fake${ni(bn,E1)._++}`,s=new nm(i+"_worker",i,t);e.setup(s,t),k(this,sa,new nm(i,i+"_worker",t)),R(this,ss,Iv).call(this)}).catch(e=>{u(this,mc).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},up=new WeakSet,Bv=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},D(bn,up),D(bn,E1,0),D(bn,lh,!1),D(bn,ch,new WeakMap),ns&&(k(bn,lh,!0),fa.workerSrc||(fa.workerSrc="./pdf.worker.mjs")),bn._isSameOrigin=(e,t)=>{const i=URL.parse(e);if(!(i!=null&&i.origin)||i.origin==="null")return!1;const s=new URL(t,i);return i.origin===s.origin},bn._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},bn.fromPort=e=>{if(KV("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return bn.create(e)};let r0=bn;var Is,qo,Vo,_r,xc,hp,Go,xs,sr,AM,cm,zv;class rW{constructor(e,t,i,s,r){D(this,sr);we(this,"downloadInfoCapability",Promise.withResolvers());D(this,Is,null);D(this,qo,new Map);D(this,Vo,null);D(this,_r,new Map);D(this,xc,new Map);D(this,hp,new Map);D(this,Go,null);D(this,xs,s0.instance);this.messageHandler=e,this.loadingTask=t,k(this,Vo,i),this.commonObjs=new gM,this.fontLoader=new oG({ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this.enableHWA=s.enableHWA,this.loadingParams=s.loadingParams,this._params=s,this.canvasFactory=r.canvasFactory,this.filterFactory=r.filterFactory,this.cMapReaderFactory=r.cMapReaderFactory,this.standardFontDataFactory=r.standardFontDataFactory,this.wasmFactory=r.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this.setupMessageHandler(),u(this,xs).addListener(R(this,sr,AM).bind(this))}get annotationStorage(){return ht(this,"annotationStorage",new SN)}getRenderingIntent(e,t=Hl.ENABLE,i=null,s=!1,r=!1){let a=Zs.DISPLAY,o=LA;switch(e){case"any":a=Zs.ANY;break;case"display":break;case"print":a=Zs.PRINT;break;default:ut(`getRenderingIntent - invalid intent: ${e}`)}const c=a&Zs.PRINT&&i instanceof HL?i:this.annotationStorage;switch(t){case Hl.DISABLE:a+=Zs.ANNOTATIONS_DISABLE;break;case Hl.ENABLE:break;case Hl.ENABLE_FORMS:a+=Zs.ANNOTATIONS_FORMS;break;case Hl.ENABLE_STORAGE:a+=Zs.ANNOTATIONS_STORAGE,o=c.serializable;break;default:ut(`getRenderingIntent - invalid annotationMode: ${t}`)}s&&(a+=Zs.IS_EDITING),r&&(a+=Zs.OPLIST);const{ids:h,hash:d}=c.modifiedIds,f=[a,o.hash,d];return{renderingIntent:a,cacheKey:f.join("_"),annotationStorageSerializable:o,modifiedIds:h}}destroy(){var i;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(i=u(this,Go))==null||i.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const s of u(this,_r).values())e.push(s._destroy());u(this,_r).clear(),u(this,xc).clear(),u(this,hp).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var s,r;this.commonObjs.clear(),this.fontLoader.clear(),u(this,qo).clear(),this.filterFactory.destroy(),og.cleanup(),(s=u(this,Vo))==null||s.cancelAllRequests(new au("Worker was terminated.")),(r=this.messageHandler)==null||r.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(i,s)=>{It(u(this,Vo),"GetReader - no `BasePDFStream` instance available."),k(this,Is,u(this,Vo).getFullReader()),u(this,Is).onProgress=r=>R(this,sr,zv).call(this,r),s.onPull=()=>{u(this,Is).read().then(function({value:r,done:a}){if(a){s.close();return}It(r instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(r),1,[r])}).catch(r=>{s.error(r)})},s.onCancel=r=>{u(this,Is).cancel(r),s.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("ReaderHeadersReady",async i=>{await u(this,Is).headersReady;const{isStreamingSupported:s,isRangeSupported:r,contentLength:a}=u(this,Is);return s&&r&&(u(this,Is).onProgress=null),{isStreamingSupported:s,isRangeSupported:r,contentLength:a}}),e.on("GetRangeReader",(i,s)=>{It(u(this,Vo),"GetRangeReader - no `BasePDFStream` instance available.");const r=u(this,Vo).getRangeReader(i.begin,i.end);if(!r){s.close();return}s.onPull=()=>{r.read().then(function({value:a,done:o}){if(o){s.close();return}It(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{s.error(a)})},s.onCancel=a=>{r.cancel(a),s.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("GetDoc",({pdfInfo:i})=>{u(this,xs).pagesNumber=i.numPages,this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,t._capability.resolve(new iW(i,this))}),e.on("DocException",i=>{t._capability.reject(us(i))}),e.on("PasswordRequest",i=>{k(this,Go,Promise.withResolvers());try{if(!t.onPassword)throw us(i);const s=r=>{r instanceof Error?u(this,Go).reject(r):u(this,Go).resolve({password:r})};t.onPassword(s,i.code)}catch(s){u(this,Go).reject(s)}return u(this,Go).promise}),e.on("DataLoaded",i=>{R(this,sr,zv).call(this,{loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),e.on("StartRenderPage",i=>{if(this.destroyed)return;u(this,_r).get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),e.on("commonobj",([i,s,r])=>{var a;if(this.destroyed||this.commonObjs.has(i))return null;switch(s){case"Font":if("error"in r){const p=r.error;ut(`Error during font loading: ${p}`),this.commonObjs.resolve(i,p);break}const o=new MA(r),c=this._params.pdfBug&&((a=globalThis.FontInspector)!=null&&a.enabled)?(p,g)=>globalThis.FontInspector.fontAdded(p,g):null,h=new lG(o,c,r.extra,r.charProcOperatorList);this.fontLoader.bind(h).catch(()=>e.sendWithPromise("FontFallback",{id:i})).finally(()=>{!h.fontExtraProperties&&h.data&&h.clearData(),this.commonObjs.resolve(i,h)});break;case"CopyLocalImage":const{imageRef:d}=r;It(d,"The imageRef must be defined.");for(const p of u(this,_r).values())for(const[,g]of p.objs)if((g==null?void 0:g.ref)===d)return g.dataLen?(this.commonObjs.resolve(i,structuredClone(g)),g.dataLen):null;break;case"FontPath":this.commonObjs.resolve(i,new cG(r));break;case"Image":this.commonObjs.resolve(i,r);break;case"Pattern":const f=new OA(r);this.commonObjs.resolve(i,f.getIR());break;default:throw new Error(`Got unknown common object type ${s}`)}return null}),e.on("obj",([i,s,r,a])=>{var c;if(this.destroyed)return;const o=u(this,_r).get(s);if(!o.objs.has(i)){if(o._intentStates.size===0){(c=a==null?void 0:a.bitmap)==null||c.close();return}switch(r){case"Image":case"Pattern":o.objs.resolve(i,a);break;default:throw new Error(`Got unknown object type ${r}`)}}}),e.on("DocProgress",i=>{this.destroyed||R(this,sr,zv).call(this,i)}),e.on("FetchBinaryData",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");const s=this[i.type];if(!s)throw new Error(`${i.type} not initialized, see the \`useWorkerFetch\` parameter.`);return s.fetch(i)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var i;this.annotationStorage.size<=0&&ut("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((i=u(this,Is))==null?void 0:i.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}extractPages(e){return this.messageHandler.sendWithPromise("ExtractPages",{pageInfos:e})}getPage(e){if(!Number.isInteger(e)||e<=0||e>u(this,xs).pagesNumber)return Promise.reject(new Error("Invalid page request."));const t=e-1,i=u(this,xs).getPageId(e)-1,s=u(this,xc).get(t);if(s)return s;const r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:i}).then(a=>{if(this.destroyed)throw new Error("Transport destroyed");a.refStr&&u(this,hp).set(a.refStr,i);const o=new sW(t,a,this,this._params.pdfBug);return u(this,_r).set(t,o),o});return u(this,xc).set(t,r),r}async getPageIndex(e){if(!PA(e))throw new Error("Invalid pageIndex request.");const t=await this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen});return u(this,xs).getPageNumber(t+1)-1}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:u(this,xs).getPageId(e+1)-1,intent:t})}getFieldObjects(){return R(this,sr,cm).call(this,"GetFieldObjects")}hasJSActions(){return R(this,sr,cm).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(e,t){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:e,pageIndexesToSkip:t})}getDocJSActions(){return R(this,sr,cm).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:u(this,xs).getPageId(e+1)-1})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:u(this,xs).getPageId(e+1)-1})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return R(this,sr,cm).call(this,"GetOptionalContentConfig").then(t=>new BG(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=u(this,qo).get(e);if(t)return t;const i=this.messageHandler.sendWithPromise(e,null).then(s=>{var r,a;return{info:s[0],metadata:s[1]?new PG(s[1]):null,contentDispositionFilename:((r=u(this,Is))==null?void 0:r.filename)??null,contentLength:((a=u(this,Is))==null?void 0:a.contentLength)??null,hasStructTree:s[2]}});return u(this,qo).set(e,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of u(this,_r).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),u(this,qo).clear(),this.filterFactory.destroy(!0),og.cleanup()}}cachedPageNumber(e){if(!PA(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`,i=u(this,hp).get(t);return i>=0?u(this,xs).getPageNumber(i+1):null}}Is=new WeakMap,qo=new WeakMap,Vo=new WeakMap,_r=new WeakMap,xc=new WeakMap,hp=new WeakMap,Go=new WeakMap,xs=new WeakMap,sr=new WeakSet,AM=function(){const e=new Map,t=new Map;for(let i=0,s=u(this,xs).pagesNumber;i<s;i++){const r=u(this,xs).getPrevPageNumber(i+1)-1,a=u(this,_r).get(r);a&&e.set(i,a);const o=u(this,xc).get(r);o&&t.set(i,o)}k(this,_r,e),k(this,xc,t)},cm=function(e,t=null){const i=u(this,qo).get(e);if(i)return i;const s=this.messageHandler.sendWithPromise(e,t);return u(this,qo).set(e,s),s},zv=function({loaded:e,total:t}){var i,s;(s=(i=this.loadingTask).onProgress)==null||s.call(i,{loaded:e,total:t,percent:Ti(Math.round(e/t*100),0,100)})};class aW{constructor(e){we(this,"_internalRenderTask",null);we(this,"onContinue",null);we(this,"onError",null);this._internalRenderTask=e}get promise(){return this._internalRenderTask.capability.promise}cancel(e=0){this._internalRenderTask.cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=this._internalRenderTask.operatorList;if(!e)return!1;const{annotationCanvasMap:t}=this._internalRenderTask;return e.form||e.canvas&&(t==null?void 0:t.size)>0}}var yc,uh;const Eu=class Eu{constructor({callback:e,params:t,objs:i,commonObjs:s,annotationCanvasMap:r,operatorList:a,pageIndex:o,canvasFactory:c,filterFactory:h,useRequestAnimationFrame:d=!1,pdfBug:f=!1,pageColors:p=null,enableHWA:g=!1,operationsFilter:v=null}){D(this,yc,null);this.callback=e,this.params=t,this.objs=i,this.commonObjs=s,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=o,this.canvasFactory=c,this.filterFactory=h,this._pdfBug=f,this.pageColors=p,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=d===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new aW(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvas,this._canvasContext=t.canvas?null:t.canvasContext,this._enableHWA=g,this._dependencyTracker=t.dependencyTracker,this._operationsFilter=v}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var c,h;if(this.cancelled)return;if(this._canvas){if(u(Eu,uh).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");u(Eu,uh).add(this._canvas)}this._pdfBug&&((c=globalThis.StepperManager)!=null&&c.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:i,transform:s,background:r,dependencyTracker:a}=this.params,o=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new mf(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors,a),this.gfx.beginDrawing({transform:s,viewport:i,transparency:e,background:r}),this.operatorListIdx=0,this.graphicsReady=!0,(h=this.graphicsReadyCallback)==null||h.call(this)}cancel(e=null,t=0){var i,s,r;this.running=!1,this.cancelled=!0,(i=this.gfx)==null||i.endDrawing(),u(this,yc)&&(window.cancelAnimationFrame(u(this,yc)),k(this,yc,null)),u(Eu,uh).delete(this._canvas),e||(e=new vw(`Rendering cancelled, page ${this._pageIndex+1}`,t)),this.callback(e),(r=(s=this.task).onError)==null||r.call(s,e)}operatorListChanged(){var e,t;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.gfx.dependencyTracker)==null||e.growOperationsCount(this.operatorList.fnArray.length),(t=this.stepper)==null||t.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?k(this,yc,window.requestAnimationFrame(()=>{k(this,yc,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),u(Eu,uh).delete(this._canvas),this.callback())))}};yc=new WeakMap,uh=new WeakMap,D(Eu,uh,new WeakSet);let JA=Eu;const oW="5.4.624",lW="384c6208b";var Bs,hh,dp,ri,yx,fp,Wo,vx,vc,ra,bx,rn,eE,tE,nE,bu,EM,Ol;const hs=class hs{constructor({editor:e=null,uiManager:t=null}){D(this,rn);D(this,Bs,null);D(this,hh,null);D(this,dp);D(this,ri,null);D(this,yx,!1);D(this,fp,!1);D(this,Wo,null);D(this,vx);D(this,vc,null);D(this,ra,null);var i,s;e?(k(this,fp,!1),k(this,Wo,e)):k(this,fp,!0),k(this,ra,(e==null?void 0:e._uiManager)||t),k(this,vx,u(this,ra)._eventBus),k(this,dp,((i=e==null?void 0:e.color)==null?void 0:i.toUpperCase())||((s=u(this,ra))==null?void 0:s.highlightColors.values().next().value)||"#FFFF98"),u(hs,bx)||k(hs,bx,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return ht(this,"_keyboardManager",new Ey([[["Escape","mac+Escape"],hs.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],hs.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],hs.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],hs.prototype._moveToPrevious],[["Home","mac+Home"],hs.prototype._moveToBeginning],[["End","mac+End"],hs.prototype._moveToEnd]]))}renderButton(){const e=k(this,Bs,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",u(this,Wo)&&(e.ariaControls=`${u(this,Wo).id}_colorpicker_dropdown`);const t=u(this,ra)._signal;e.addEventListener("click",R(this,rn,bu).bind(this),{signal:t}),e.addEventListener("keydown",R(this,rn,nE).bind(this),{signal:t});const i=k(this,hh,document.createElement("span"));return i.className="swatch",i.ariaHidden="true",i.style.backgroundColor=u(this,dp),e.append(i),e}renderMainDropdown(){const e=k(this,ri,R(this,rn,eE).call(this));return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}_colorSelectFromKeyboard(e){if(e.target===u(this,Bs)){R(this,rn,bu).call(this,e);return}const t=e.target.getAttribute("data-color");t&&R(this,rn,tE).call(this,t,e)}_moveToNext(e){var t,i;if(!u(this,rn,Ol)){R(this,rn,bu).call(this,e);return}if(e.target===u(this,Bs)){(t=u(this,ri).firstElementChild)==null||t.focus();return}(i=e.target.nextSibling)==null||i.focus()}_moveToPrevious(e){var t,i;if(e.target===((t=u(this,ri))==null?void 0:t.firstElementChild)||e.target===u(this,Bs)){u(this,rn,Ol)&&this._hideDropdownFromKeyboard();return}u(this,rn,Ol)||R(this,rn,bu).call(this,e),(i=e.target.previousSibling)==null||i.focus()}_moveToBeginning(e){var t;if(!u(this,rn,Ol)){R(this,rn,bu).call(this,e);return}(t=u(this,ri).firstElementChild)==null||t.focus()}_moveToEnd(e){var t;if(!u(this,rn,Ol)){R(this,rn,bu).call(this,e);return}(t=u(this,ri).lastElementChild)==null||t.focus()}hideDropdown(){var e,t;(e=u(this,ri))==null||e.classList.add("hidden"),u(this,Bs).ariaExpanded="false",(t=u(this,vc))==null||t.abort(),k(this,vc,null)}_hideDropdownFromKeyboard(){var e;if(!u(this,fp)){if(!u(this,rn,Ol)){(e=u(this,Wo))==null||e.unselect();return}this.hideDropdown(),u(this,Bs).focus({preventScroll:!0,focusVisible:u(this,yx)})}}updateColor(e){if(u(this,hh)&&(u(this,hh).style.backgroundColor=e),!u(this,ri))return;const t=u(this,ra).highlightColors.values();for(const i of u(this,ri).children)i.ariaSelected=t.next().value===e.toUpperCase()}destroy(){var e,t;(e=u(this,Bs))==null||e.remove(),k(this,Bs,null),k(this,hh,null),(t=u(this,ri))==null||t.remove(),k(this,ri,null)}};Bs=new WeakMap,hh=new WeakMap,dp=new WeakMap,ri=new WeakMap,yx=new WeakMap,fp=new WeakMap,Wo=new WeakMap,vx=new WeakMap,vc=new WeakMap,ra=new WeakMap,bx=new WeakMap,rn=new WeakSet,eE=function(){const e=document.createElement("div"),t=u(this,ra)._signal;e.addEventListener("contextmenu",Vr,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),u(this,Wo)&&(e.id=`${u(this,Wo).id}_colorpicker_dropdown`);for(const[i,s]of u(this,ra).highlightColors){const r=document.createElement("button");r.tabIndex="0",r.role="option",r.setAttribute("data-color",s),r.title=i,r.setAttribute("data-l10n-id",u(hs,bx)[i]);const a=document.createElement("span");r.append(a),a.className="swatch",a.style.backgroundColor=s,r.ariaSelected=s===u(this,dp),r.addEventListener("click",R(this,rn,tE).bind(this,s),{signal:t}),e.append(r)}return e.addEventListener("keydown",R(this,rn,nE).bind(this),{signal:t}),e},tE=function(e,t){t.stopPropagation(),u(this,vx).dispatch("switchannotationeditorparams",{source:this,type:Tt.HIGHLIGHT_COLOR,value:e}),this.updateColor(e)},nE=function(e){hs._keyboardManager.exec(this,e)},bu=function(e){if(u(this,rn,Ol)){this.hideDropdown();return}if(k(this,yx,e.detail===0),u(this,vc)||(k(this,vc,new AbortController),window.addEventListener("pointerdown",R(this,rn,EM).bind(this),{signal:u(this,ra).combinedSignal(u(this,vc))})),u(this,Bs).ariaExpanded="true",u(this,ri)){u(this,ri).classList.remove("hidden");return}const t=k(this,ri,R(this,rn,eE).call(this));u(this,Bs).append(t)},EM=function(e){var t;(t=u(this,ri))!=null&&t.contains(e.target)||this.hideDropdown()},Ol=function(){return u(this,ri)&&!u(this,ri).classList.contains("hidden")},D(hs,bx,null);let o1=hs;var Ua,wx,pp,Sx;const Cu=class Cu{constructor(e){D(this,Ua,null);D(this,wx,null);D(this,pp,null);k(this,wx,e),k(this,pp,e._uiManager),u(Cu,Sx)||k(Cu,Sx,Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"}))}renderButton(){if(u(this,Ua))return u(this,Ua);const{editorType:e,colorType:t,color:i}=u(this,wx),s=k(this,Ua,document.createElement("input"));return s.type="color",s.value=i||"#000000",s.className="basicColorPicker",s.tabIndex=0,s.setAttribute("data-l10n-id",u(Cu,Sx)[e]),s.addEventListener("input",()=>{u(this,pp).updateParams(t,s.value)},{signal:u(this,pp)._signal}),s}update(e){u(this,Ua)&&(u(this,Ua).value=e)}destroy(){var e;(e=u(this,Ua))==null||e.remove(),k(this,Ua,null)}hideDropdown(){}};Ua=new WeakMap,wx=new WeakMap,pp=new WeakMap,Sx=new WeakMap,D(Cu,Sx,null);let l1=Cu;function bD(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function Ug(n){return Math.max(0,Math.min(255,255*n))}class wD{static CMYK_G([e,t,i,s]){return["G",1-Math.min(1,.3*e+.59*i+.11*t+s)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=Ug(e),[e,e,e]}static G_HTML([e]){const t=bD(e);return`#${t}${t}${t}`}static RGB_G([e,t,i]){return["G",.3*e+.59*t+.11*i]}static RGB_rgb(e){return e.map(Ug)}static RGB_HTML(e){return`#${e.map(bD).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,i,s]){return["RGB",1-Math.min(1,e+s),1-Math.min(1,i+s),1-Math.min(1,t+s)]}static CMYK_rgb([e,t,i,s]){return[Ug(1-Math.min(1,e+s)),Ug(1-Math.min(1,i+s)),Ug(1-Math.min(1,t+s))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,i]){const s=1-e,r=1-t,a=1-i,o=Math.min(s,r,a);return["CMYK",s,r,a,o]}}class cW{create(e,t,i=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const s=this._createSVG("svg:svg");return s.setAttribute("version","1.1"),i||(s.setAttribute("width",`${e}px`),s.setAttribute("height",`${t}px`)),s.setAttribute("preserveAspectRatio","none"),s.setAttribute("viewBox",`0 0 ${e} ${t}`),s}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){zt("Abstract method `_createSVG` called.")}}class c1 extends cW{_createSVG(e){return document.createElementNS(xo,e)}}const uW=9,Jh=new WeakSet,hW=new Date().getTimezoneOffset()*60*1e3;class q2{static create(e){switch(e.data.annotationType){case Yn.LINK:return new NN(e);case Yn.TEXT:return new fW(e);case Yn.WIDGET:switch(e.data.fieldType){case"Tx":return new pW(e);case"Btn":return e.data.radioButton?new _M(e):e.data.checkBox?new mW(e):new xW(e);case"Ch":return new yW(e);case"Sig":return new gW(e)}return new cd(e);case Yn.POPUP:return new sE(e);case Yn.FREETEXT:return new RM(e);case Yn.LINE:return new bW(e);case Yn.SQUARE:return new wW(e);case Yn.CIRCLE:return new SW(e);case Yn.POLYLINE:return new LM(e);case Yn.CARET:return new EW(e);case Yn.INK:return new _N(e);case Yn.POLYGON:return new AW(e);case Yn.HIGHLIGHT:return new MM(e);case Yn.UNDERLINE:return new CW(e);case Yn.SQUIGGLY:return new NW(e);case Yn.STRIKEOUT:return new _W(e);case Yn.STAMP:return new OM(e);case Yn.FILEATTACHMENT:return new kW(e);default:return new _n(e)}}}var dh,gp,kr,Ax,iE;const ON=class ON{constructor(e,{isRenderable:t=!1,ignoreBorder:i=!1,createQuadrilaterals:s=!1}={}){D(this,Ax);D(this,dh,null);D(this,gp,!1);D(this,kr,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableComment=e.enableComment,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,this.hasOwnCommentButton=!1,t&&(this.contentElement=this.container=this._createContainer(i)),s&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!!(e!=null&&e.str||t!=null&&t.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return ON._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){var i;const{data:e}=this,t=(i=this.annotationStorage)==null?void 0:i.getEditor(e.id);return t?t.getData():e}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){var o;const e=(o=this.annotationStorage)==null?void 0:o.getEditor(this.data.id);if(e)return e.commentButtonPositionInPage;const{quadPoints:t,inkLists:i,rect:s}=this.data;let r=-1/0,a=-1/0;if((t==null?void 0:t.length)>=8){for(let c=0;c<t.length;c+=8)t[c+1]>a?(a=t[c+1],r=t[c+2]):t[c+1]===a&&(r=Math.max(r,t[c+2]));return[r,a]}if((i==null?void 0:i.length)>=1){for(const c of i)for(let h=0,d=c.length;h<d;h+=2)c[h+1]>a?(a=c[h+1],r=c[h]):c[h+1]===a&&(r=Math.max(r,c[h]));if(r!==1/0)return[r,a]}return s?[s[2],s[3]]:null}_normalizePoint(e){const{page:{view:t},viewport:{rawDims:{pageWidth:i,pageHeight:s,pageX:r,pageY:a}}}=this.parent;return e[1]=t[3]-e[1]+t[1],e[0]=100*(e[0]-r)/i,e[1]=100*(e[1]-a)/s,e}get commentText(){var t,i,s;const{data:e}=this;return((i=(t=this.annotationStorage.getRawValue(`${t0}${e.id}`))==null?void 0:t.popup)==null?void 0:i.contents)||((s=e.contentsObj)==null?void 0:s.str)||""}set commentText(e){const{data:t}=this,i={deleted:!e,contents:e||""};this.annotationStorage.updateEditor(t.id,{popup:i})||this.annotationStorage.setValue(`${t0}${t.id}`,{id:t.id,annotationType:t.annotationType,page:this.parent.page,popup:i,popupRef:t.popupRef,modificationDate:new Date}),e||this.removePopup()}removePopup(){var e,t;(t=((e=u(this,kr))==null?void 0:e.popup)||this.popup)==null||t.remove(),k(this,kr,this.popup=null)}updateEdited(e){var r;if(!this.container)return;e.rect&&(u(this,dh)||k(this,dh,{rect:this.data.rect.slice(0)}));const{rect:t,popup:i}=e;t&&R(this,Ax,iE).call(this,t);let s=((r=u(this,kr))==null?void 0:r.popup)||this.popup;!s&&(i!=null&&i.text)&&(this._createPopup(i),s=u(this,kr).popup),s&&(s.updateEdited(e),i!=null&&i.deleted&&(s.remove(),k(this,kr,null),this.popup=null))}resetEdited(){var e;u(this,dh)&&(R(this,Ax,iE).call(this,u(this,dh).rect),(e=u(this,kr))==null||e.popup.resetEdited(),k(this,dh,null))}_createContainer(e){const{data:t,parent:{page:i,viewport:s}}=this,r=document.createElement("section");r.setAttribute("data-annotation-id",t.id),!(this instanceof cd)&&!(this instanceof NN)&&(r.tabIndex=0);const{style:a}=r;if(a.zIndex=this.parent.zIndex,this.parent.zIndex+=2,t.alternativeText&&(r.title=t.alternativeText),t.noRotate&&r.classList.add("norotate"),!t.rect||this instanceof sE){const{rotation:b}=t;return!t.hasOwnCanvas&&b!==0&&this.setRotation(b,r),r}const{width:o,height:c}=this;if(!e&&t.borderStyle.width>0){a.borderWidth=`${t.borderStyle.width}px`;const b=t.borderStyle.horizontalCornerRadius,x=t.borderStyle.verticalCornerRadius;if(b>0||x>0){const y=`calc(${b}px * var(--total-scale-factor)) / calc(${x}px * var(--total-scale-factor))`;a.borderRadius=y}else if(this instanceof _M){const y=`calc(${o}px * var(--total-scale-factor)) / calc(${c}px * var(--total-scale-factor))`;a.borderRadius=y}switch(t.borderStyle.style){case Md.SOLID:a.borderStyle="solid";break;case Md.DASHED:a.borderStyle="dashed";break;case Md.BEVELED:ut("Unimplemented border style: beveled");break;case Md.INSET:ut("Unimplemented border style: inset");break;case Md.UNDERLINE:a.borderBottomStyle="solid";break}const m=t.borderColor||null;m?(k(this,gp,!0),a.borderColor=$e.makeHexColor(m[0]|0,m[1]|0,m[2]|0)):a.borderWidth=0}const h=$e.normalizeRect([t.rect[0],i.view[3]-t.rect[1]+i.view[1],t.rect[2],i.view[3]-t.rect[3]+i.view[1]]),{pageWidth:d,pageHeight:f,pageX:p,pageY:g}=s.rawDims;a.left=`${100*(h[0]-p)/d}%`,a.top=`${100*(h[1]-g)/f}%`;const{rotation:v}=t;return t.hasOwnCanvas||v===0?(a.width=`${100*o/d}%`,a.height=`${100*c/f}%`):this.setRotation(v,r),r}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:i,pageHeight:s}=this.parent.viewport.rawDims;let{width:r,height:a}=this;e%180!==0&&([r,a]=[a,r]),t.style.width=`${100*r/i}%`,t.style.height=`${100*a/s}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,i,s)=>{const r=s.detail[t],a=r[0],o=r.slice(1);s.target.style[i]=wD[`${a}_HTML`](o),this.annotationStorage.setValue(this.data.id,{[i]:wD[`${a}_rgb`](o)})};return ht(this,"_commonActions",{display:t=>{const{display:i}=t.detail,s=i%2===1;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:s,noPrint:i===1||i===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:i}=t.detail;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:i,noView:i})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const i=t.detail.rotation;this.setRotation(i),this.annotationStorage.setValue(this.data.id,{rotation:i})}})}_dispatchEventFromSandbox(e,t){const i=this._commonActions;for(const s of Object.keys(t.detail)){const r=e[s]||i[s];r==null||r(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const i=this._commonActions;for(const[s,r]of Object.entries(t)){const a=i[s];if(a){const o={detail:{[s]:r},target:e};a(o),delete t[s]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,i,s,r]=this.data.rect.map(b=>Math.fround(b));if(e.length===8){const[b,x,m,y]=e.subarray(2,6);if(s===b&&r===x&&t===m&&i===y)return}const{style:a}=this.container;let o;if(u(this,gp)){const{borderColor:b,borderWidth:x}=a;a.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${b}" stroke-width="${x}">`],this.container.classList.add("hasBorder")}const c=s-t,h=r-i,{svgFactory:d}=this,f=d.createElement("svg");f.classList.add("quadrilateralsContainer"),f.setAttribute("width",0),f.setAttribute("height",0),f.role="none";const p=d.createElement("defs");f.append(p);const g=d.createElement("clipPath"),v=`clippath_${this.data.id}`;g.setAttribute("id",v),g.setAttribute("clipPathUnits","objectBoundingBox"),p.append(g);for(let b=2,x=e.length;b<x;b+=8){const m=e[b],y=e[b+1],w=e[b+2],E=e[b+3],S=d.createElement("rect"),_=(w-t)/c,T=(r-y)/h,j=(m-w)/c,M=(y-E)/h;S.setAttribute("x",_),S.setAttribute("y",T),S.setAttribute("width",j),S.setAttribute("height",M),g.append(S),o==null||o.push(`<rect vector-effect="non-scaling-stroke" x="${_}" y="${T}" width="${j}" height="${M}"/>`)}u(this,gp)&&(o.push("</g></svg>')"),a.backgroundImage=o.join("")),this.container.append(f),this.container.style.clipPath=`url(#${v})`}_createPopup(e=null){const{data:t}=this;let i,s;e?(i={str:e.text},s=e.date):(i=t.contentsObj,s=t.modificationDate),k(this,kr,new sE({data:{color:t.color,titleObj:t.titleObj,modificationDate:s,contentsObj:i,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]}))}get hasPopupElement(){return!!(u(this,kr)||this.popup||this.data.popupRef)}get extraPopupElement(){return u(this,kr)}render(){zt("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const i=[];if(this._fieldObjects){const s=this._fieldObjects[e];if(s)for(const{page:r,id:a,exportValues:o}of s){if(r===-1||a===t)continue;const c=typeof o=="string"?o:null,h=document.querySelector(`[data-element-id="${a}"]`);if(h&&!Jh.has(h)){ut(`_getElementsByName - element not allowed: ${a}`);continue}i.push({id:a,exportValue:c,domElement:h})}return i}for(const s of document.getElementsByName(e)){const{exportValue:r}=s,a=s.getAttribute("data-element-id");a!==t&&Jh.has(s)&&i.push({id:a,exportValue:r,domElement:s})}return i}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var i;(i=this.linkService.eventBus)==null||i.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}};dh=new WeakMap,gp=new WeakMap,kr=new WeakMap,Ax=new WeakSet,iE=function(e){const{container:{style:t},data:{rect:i,rotation:s},parent:{viewport:{rawDims:{pageWidth:r,pageHeight:a,pageX:o,pageY:c}}}}=this;i==null||i.splice(0,4,...e),t.left=`${100*(e[0]-o)/r}%`,t.top=`${100*(a-e[3]+c)/a}%`,s===0?(t.width=`${100*(e[2]-e[0])/r}%`,t.height=`${100*(e[3]-e[1])/a}%`):this.setRotation(s)};let _n=ON;class dW extends _n{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.editor=e.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:e}=this;e.hasComment&&this._createPopup(e.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(e){this.editor.comment=e,e||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}var tr,wu,CM,NM;class NN extends _n{constructor(t,i=null){super(t,{isRenderable:!0,ignoreBorder:!!(i!=null&&i.ignoreBorder),createQuadrilaterals:!0});D(this,tr);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:i}=this,s=document.createElement("a");s.setAttribute("data-element-id",t.id);let r=!1;return t.url?(i.addLinkAttributes(s,t.url,t.newWindow),r=!0):t.action?(this._bindNamedAction(s,t.action,t.overlaidText),r=!0):t.attachment?(R(this,tr,CM).call(this,s,t.attachment,t.overlaidText,t.attachmentDest),r=!0):t.setOCGState?(R(this,tr,NM).call(this,s,t.setOCGState,t.overlaidText),r=!0):t.dest?(this._bindLink(s,t.dest,t.overlaidText),r=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,t),r=!0),t.resetForm?(this._bindResetFormAction(s,t.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(s,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&(this.contentElement=s,this.container.append(s)),this.container}_bindLink(t,i,s=""){t.href=this.linkService.getDestinationHash(i),t.onclick=()=>(i&&this.linkService.goToDestination(i),!1),(i||i==="")&&R(this,tr,wu).call(this),s&&(t.title=s)}_bindNamedAction(t,i,s=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(i),!1),s&&(t.title=s),R(this,tr,wu).call(this)}_bindJSAction(t,i){t.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(i.actions)){const a=s.get(r);a&&(t[a]=()=>{var o;return(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i.id,name:r}}),!1})}i.overlaidText&&(t.title=i.overlaidText),t.onclick||(t.onclick=()=>!1),R(this,tr,wu).call(this)}_bindResetFormAction(t,i){const s=t.onclick;if(s||(t.href=this.linkService.getAnchorUrl("")),R(this,tr,wu).call(this),!this._fieldObjects){ut('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),s||(t.onclick=()=>!1);return}t.onclick=()=>{var f;s==null||s();const{fields:r,refs:a,include:o}=i,c=[];if(r.length!==0||a.length!==0){const p=new Set(a);for(const g of r){const v=this._fieldObjects[g]||[];for(const{id:b}of v)p.add(b)}for(const g of Object.values(this._fieldObjects))for(const v of g)p.has(v.id)===o&&c.push(v)}else for(const p of Object.values(this._fieldObjects))c.push(...p);const h=this.annotationStorage,d=[];for(const p of c){const{id:g}=p;switch(d.push(g),p.type){case"text":{const b=p.defaultValue||"";h.setValue(g,{value:b});break}case"checkbox":case"radiobutton":{const b=p.defaultValue===p.exportValues;h.setValue(g,{value:b});break}case"combobox":case"listbox":{const b=p.defaultValue||"";h.setValue(g,{value:b});break}default:continue}const v=document.querySelector(`[data-element-id="${g}"]`);if(v){if(!Jh.has(v)){ut(`_bindResetFormAction - element not allowed: ${g}`);continue}}else continue;v.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((f=this.linkService.eventBus)==null||f.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:d,name:"ResetForm"}})),!1}}}tr=new WeakSet,wu=function(){this.container.setAttribute("data-internal-link","")},CM=function(t,i,s="",r=null){t.href=this.linkService.getAnchorUrl(""),i.description?t.title=i.description:s&&(t.title=s),t.onclick=()=>{var a;return(a=this.downloadManager)==null||a.openOrDownloadData(i.content,i.filename,r),!1},R(this,tr,wu).call(this)},NM=function(t,i,s=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(i),!1),s&&(t.title=s),R(this,tr,wu).call(this)};class fW extends _n{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(e),this.container}}class cd extends _n{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return li.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,i,s,r){i.includes("mouse")?e.addEventListener(i,a=>{var o;(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:r(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):e.addEventListener(i,a=>{var o;if(i==="blur"){if(!t.focused||!a.relatedTarget)return;t.focused=!1}else if(i==="focus"){if(t.focused)return;t.focused=!0}r&&((o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:r(a)}}))})}_setEventListeners(e,t,i,s){var r,a,o;for(const[c,h]of i)(h==="Action"||(r=this.data.actions)!=null&&r[h])&&((h==="Focus"||h==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,c,h,s),h==="Focus"&&!((a=this.data.actions)!=null&&a.Blur)?this._setEventListener(e,t,"blur","Blur",null):h==="Blur"&&!((o=this.data.actions)!=null&&o.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":$e.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:i}=this.data.defaultAppearanceData,s=this.data.defaultAppearanceData.fontSize||uW,r=e.style;let a;const o=2,c=h=>Math.round(10*h)/10;if(this.data.multiLine){const h=Math.abs(this.data.rect[3]-this.data.rect[1]-o),d=Math.round(h/(I2*s))||1,f=h/d;a=Math.min(s,c(f/I2))}else{const h=Math.abs(this.data.rect[3]-this.data.rect[1]-o);a=Math.min(s,c(h/I2))}r.fontSize=`calc(${a}px * var(--total-scale-factor))`,r.color=$e.makeHexColor(i[0],i[1],i[2]),this.data.textAlignment!==null&&(r.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class pW extends cd{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,i,s){const r=this.annotationStorage;for(const a of this._getElementsByName(e.name,e.id))a.domElement&&(a.domElement[t]=i),r.setValue(a.id,{[s]:i})}render(){var s,r;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const a=e.getValue(t,{value:this.data.fieldValue});let o=a.value||"";const c=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;c&&o.length>c&&(o=o.slice(0,c));let h=a.formattedValue||((s=this.data.textContent)==null?void 0:s.join(`
`))||null;h&&this.data.comb&&(h=h.replaceAll(/\s+/g,""));const d={userValue:o,formattedValue:h,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=h??o,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type=this.data.password?"password":"text",i.setAttribute("value",h??o),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),Jh.add(i),this.contentElement=i,i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=0;const{datetimeFormat:f,datetimeType:p,timeStep:g}=this.data,v=!!p&&this.enableScripting;f&&(i.title=f),this._setRequired(i,this.data.required),c&&(i.maxLength=c),i.addEventListener("input",x=>{e.setValue(t,{value:x.target.value}),this.setPropertyOnSiblings(i,"value",x.target.value,"value"),d.formattedValue=null}),i.addEventListener("resetform",x=>{const m=this.data.defaultFieldValue??"";i.value=d.userValue=m,d.formattedValue=null});let b=x=>{const{formattedValue:m}=d;m!=null&&(x.target.value=m),x.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",m=>{var w;if(d.focused)return;const{target:y}=m;if(v&&(y.type=p,g&&(y.step=g)),d.userValue){const E=d.userValue;if(v)if(p==="time"){const S=new Date(E),_=[S.getHours(),S.getMinutes(),S.getSeconds()];y.value=_.map(T=>T.toString().padStart(2,"0")).join(":")}else y.value=new Date(E-hW).toISOString().split(p==="date"?"T":".",1)[0];else y.value=E}d.lastCommittedValue=y.value,d.commitKey=1,(w=this.data.actions)!=null&&w.Focus||(d.focused=!0)}),i.addEventListener("updatefromsandbox",m=>{this.showElementAndHideCanvas(m.target);const y={value(w){d.userValue=w.detail.value??"",v||e.setValue(t,{value:d.userValue.toString()}),w.target.value=d.userValue},formattedValue(w){const{formattedValue:E}=w.detail;d.formattedValue=E,E!=null&&w.target!==document.activeElement&&(w.target.value=E);const S={formattedValue:E};v&&(S.value=E),e.setValue(t,S)},selRange(w){w.target.setSelectionRange(...w.detail.selRange)},charLimit:w=>{var T;const{charLimit:E}=w.detail,{target:S}=w;if(E===0){S.removeAttribute("maxLength");return}S.setAttribute("maxLength",E);let _=d.userValue;!_||_.length<=E||(_=_.slice(0,E),S.value=d.userValue=_,e.setValue(t,{value:_}),(T=this.linkService.eventBus)==null||T.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:_,willCommit:!0,commitKey:1,selStart:S.selectionStart,selEnd:S.selectionEnd}}))}};this._dispatchEventFromSandbox(y,m)}),i.addEventListener("keydown",m=>{var E;d.commitKey=1;let y=-1;if(m.key==="Escape"?y=0:m.key==="Enter"&&!this.data.multiLine?y=2:m.key==="Tab"&&(d.commitKey=3),y===-1)return;const{value:w}=m.target;d.lastCommittedValue!==w&&(d.lastCommittedValue=w,d.userValue=w,(E=this.linkService.eventBus)==null||E.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:w,willCommit:!0,commitKey:y,selStart:m.target.selectionStart,selEnd:m.target.selectionEnd}}))});const x=b;b=null,i.addEventListener("blur",m=>{var E,S;if(!d.focused||!m.relatedTarget)return;(E=this.data.actions)!=null&&E.Blur||(d.focused=!1);const{target:y}=m;let{value:w}=y;if(v){if(w&&p==="time"){const _=w.split(":").map(T=>parseInt(T,10));w=new Date(2e3,0,1,_[0],_[1],_[2]||0).valueOf(),y.step=""}else w.includes("T")||(w=`${w}T00:00`),w=new Date(w).valueOf();y.type="text"}d.userValue=w,d.lastCommittedValue!==w&&((S=this.linkService.eventBus)==null||S.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:w,willCommit:!0,commitKey:d.commitKey,selStart:m.target.selectionStart,selEnd:m.target.selectionEnd}})),x(m)}),(r=this.data.actions)!=null&&r.Keystroke&&i.addEventListener("beforeinput",m=>{var M;d.lastCommittedValue=null;const{data:y,target:w}=m,{value:E,selectionStart:S,selectionEnd:_}=w;let T=S,j=_;switch(m.inputType){case"deleteWordBackward":{const L=E.substring(0,S).match(/\w*[^\w]*$/);L&&(T-=L[0].length);break}case"deleteWordForward":{const L=E.substring(S).match(/^[^\w]*\w*/);L&&(j+=L[0].length);break}case"deleteContentBackward":S===_&&(T-=1);break;case"deleteContentForward":S===_&&(j+=1);break}m.preventDefault(),(M=this.linkService.eventBus)==null||M.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:E,change:y||"",willCommit:!1,selStart:T,selEnd:j}})}),this._setEventListeners(i,d,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],m=>m.target.value)}if(b&&i.addEventListener("blur",b),this.data.comb){const m=(this.data.rect[2]-this.data.rect[0])/c;i.classList.add("comb"),i.style.letterSpacing=`calc(${m}px * var(--total-scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class gW extends cd{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class mW extends cd{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,i=t.id;let s=e.getValue(i,{value:t.exportValue===t.fieldValue}).value;typeof s=="string"&&(s=s!=="Off",e.setValue(i,{value:s})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const r=document.createElement("input");return Jh.add(r),r.setAttribute("data-element-id",i),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="checkbox",r.name=t.fieldName,s&&r.setAttribute("checked",!0),r.setAttribute("exportValue",t.exportValue),r.tabIndex=0,r.addEventListener("change",a=>{const{name:o,checked:c}=a.target;for(const h of this._getElementsByName(o,i)){const d=c&&h.exportValue===t.exportValue;h.domElement&&(h.domElement.checked=d),e.setValue(h.id,{value:d})}e.setValue(i,{value:c})}),r.addEventListener("resetform",a=>{const o=t.defaultFieldValue||"Off";a.target.checked=o===t.exportValue}),this.enableScripting&&this.hasJSActions&&(r.addEventListener("updatefromsandbox",a=>{const o={value(c){c.target.checked=c.detail.value!=="Off",e.setValue(i,{value:c.target.checked})}};this._dispatchEventFromSandbox(o,a)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class _M extends cd{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,i=t.id;let s=e.getValue(i,{value:t.fieldValue===t.buttonValue}).value;if(typeof s=="string"&&(s=s!==t.buttonValue,e.setValue(i,{value:s})),s)for(const a of this._getElementsByName(t.fieldName,i))e.setValue(a.id,{value:!1});const r=document.createElement("input");if(Jh.add(r),r.setAttribute("data-element-id",i),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="radio",r.name=t.fieldName,s&&r.setAttribute("checked",!0),r.tabIndex=0,r.addEventListener("change",a=>{const{name:o,checked:c}=a.target;for(const h of this._getElementsByName(o,i))e.setValue(h.id,{value:!1});e.setValue(i,{value:c})}),r.addEventListener("resetform",a=>{const o=t.defaultFieldValue;a.target.checked=o!=null&&o===t.buttonValue}),this.enableScripting&&this.hasJSActions){const a=t.buttonValue;r.addEventListener("updatefromsandbox",o=>{const c={value:h=>{const d=a===h.detail.value;for(const f of this._getElementsByName(h.target.name)){const p=d&&f.id===i;f.domElement&&(f.domElement.checked=p),e.setValue(f.id,{value:p})}}};this._dispatchEventFromSandbox(c,o)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)}return this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class xW extends NN{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",i=>{this._dispatchEventFromSandbox({},i)})),e}}class yW extends cd{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,i=e.getValue(t,{value:this.data.fieldValue}),s=document.createElement("select");Jh.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,this._setRequired(s,this.data.required),s.name=this.data.fieldName,s.tabIndex=0;let r=this.data.combo&&this.data.options.length>0;this.data.combo||(s.size=this.data.options.length,this.data.multiSelect&&(s.multiple=!0)),s.addEventListener("resetform",d=>{const f=this.data.defaultFieldValue;for(const p of s.options)p.selected=p.value===f});for(const d of this.data.options){const f=document.createElement("option");f.textContent=d.displayValue,f.value=d.exportValue,i.value.includes(d.exportValue)&&(f.setAttribute("selected",!0),r=!1),s.append(f)}let a=null;if(r){const d=document.createElement("option");d.value=" ",d.setAttribute("hidden",!0),d.setAttribute("selected",!0),s.prepend(d),a=()=>{d.remove(),s.removeEventListener("input",a),a=null},s.addEventListener("input",a)}const o=d=>{const f=d?"value":"textContent",{options:p,multiple:g}=s;return g?Array.prototype.filter.call(p,v=>v.selected).map(v=>v[f]):p.selectedIndex===-1?null:p[p.selectedIndex][f]};let c=o(!1);const h=d=>{const f=d.target.options;return Array.prototype.map.call(f,p=>({displayValue:p.textContent,exportValue:p.value}))};return this.enableScripting&&this.hasJSActions?(s.addEventListener("updatefromsandbox",d=>{const f={value(p){a==null||a();const g=p.detail.value,v=new Set(Array.isArray(g)?g:[g]);for(const b of s.options)b.selected=v.has(b.value);e.setValue(t,{value:o(!0)}),c=o(!1)},multipleSelection(p){s.multiple=!0},remove(p){const g=s.options,v=p.detail.remove;g[v].selected=!1,s.remove(v),g.length>0&&Array.prototype.findIndex.call(g,x=>x.selected)===-1&&(g[0].selected=!0),e.setValue(t,{value:o(!0),items:h(p)}),c=o(!1)},clear(p){for(;s.length!==0;)s.remove(0);e.setValue(t,{value:null,items:[]}),c=o(!1)},insert(p){const{index:g,displayValue:v,exportValue:b}=p.detail.insert,x=s.children[g],m=document.createElement("option");m.textContent=v,m.value=b,x?x.before(m):s.append(m),e.setValue(t,{value:o(!0),items:h(p)}),c=o(!1)},items(p){const{items:g}=p.detail;for(;s.length!==0;)s.remove(0);for(const v of g){const{displayValue:b,exportValue:x}=v,m=document.createElement("option");m.textContent=b,m.value=x,s.append(m)}s.options.length>0&&(s.options[0].selected=!0),e.setValue(t,{value:o(!0),items:h(p)}),c=o(!1)},indices(p){const g=new Set(p.detail.indices);for(const v of p.target.options)v.selected=g.has(v.index);e.setValue(t,{value:o(!0)}),c=o(!1)},editable(p){p.target.disabled=!p.detail.editable}};this._dispatchEventFromSandbox(f,d)}),s.addEventListener("input",d=>{var g;const f=o(!0),p=o(!1);e.setValue(t,{value:f}),d.preventDefault(),(g=this.linkService.eventBus)==null||g.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:c,change:p,changeEx:f,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(s,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],d=>d.target.value)):s.addEventListener("input",function(d){e.setValue(t,{value:o(!0)})}),this.data.combo&&this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}var Ex,rE;class sE extends _n{constructor(t){const{data:i,elements:s,parent:r}=t,a=!!r._commentManager;super(t,{isRenderable:!a&&_n._hasPopupData(i)});D(this,Ex);if(this.elements=s,a&&_n._hasPopupData(i)){const o=this.popup=R(this,Ex,rE).call(this);for(const c of s)c.popup=o}else this.popup=null}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const i=this.popup=R(this,Ex,rE).call(this),s=[];for(const r of this.elements)r.popup=i,r.container.ariaHasPopup="dialog",s.push(r.data.id),r.addHighlightArea();return this.container.setAttribute("aria-controls",s.map(r=>`${tf}${r}`).join(",")),this.container}}Ex=new WeakSet,rE=function(){return new vW({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})};var zs,bc,C1,N1,mp,xp,jn,Ha,wc,fh,yp,vp,$a,Fs,Yo,Xo,Rn,Ko,Sc,Cx,Zo,bp,ph,Ac,di,Ec,bt,Fv,aE,oE,lE,Uv,cE,kM,TM,DM,jM,Hv,$v,uE;class vW{constructor({container:e,color:t,elements:i,titleObj:s,modificationDate:r,contentsObj:a,richText:o,parent:c,rect:h,parentRect:d,open:f,commentManager:p=null}){D(this,bt);D(this,zs,null);D(this,bc,R(this,bt,DM).bind(this));D(this,C1,R(this,bt,uE).bind(this));D(this,N1,R(this,bt,$v).bind(this));D(this,mp,R(this,bt,Hv).bind(this));D(this,xp,null);D(this,jn,null);D(this,Ha,null);D(this,wc,null);D(this,fh,null);D(this,yp,null);D(this,vp,null);D(this,$a,!1);D(this,Fs,null);D(this,Yo,null);D(this,Xo,null);D(this,Rn,null);D(this,Ko,null);D(this,Sc,null);D(this,Cx,null);D(this,Zo,null);D(this,bp,null);D(this,ph,null);D(this,Ac,!1);D(this,di,null);D(this,Ec,null);k(this,jn,e),k(this,bp,s),k(this,Ha,a),k(this,Zo,o),k(this,yp,c),k(this,xp,t),k(this,Cx,h),k(this,vp,d),k(this,fh,i),k(this,zs,p),k(this,di,i[0]),k(this,wc,t1.toDateObject(r)),this.trigger=i.flatMap(g=>g.getElementsToTriggerPopup()),p||(R(this,bt,Fv).call(this),u(this,jn).hidden=!0,f&&R(this,bt,Hv).call(this))}renderCommentButton(){if(u(this,Rn)){u(this,Rn).parentNode||u(this,di).container.after(u(this,Rn));return}if(u(this,Ko)||R(this,bt,aE).call(this),!u(this,Ko))return;const{signal:e}=k(this,Yo,new AbortController),t=u(this,di).hasOwnCommentButton,i=()=>{u(this,zs).toggleCommentPopup(this,!0,void 0,!t)},s=()=>{u(this,zs).toggleCommentPopup(this,!1,!0,!t)},r=()=>{u(this,zs).toggleCommentPopup(this,!1,!1)};if(t){k(this,Rn,u(this,di).container);for(const a of this.trigger)a.ariaHasPopup="dialog",a.ariaControls="commentPopup",a.addEventListener("keydown",u(this,bc),{signal:e}),a.addEventListener("click",i,{signal:e}),a.addEventListener("pointerenter",s,{signal:e}),a.addEventListener("pointerleave",r,{signal:e}),a.classList.add("popupTriggerArea")}else{const a=k(this,Rn,document.createElement("button"));a.className="annotationCommentButton";const o=u(this,di).container;a.style.zIndex=o.style.zIndex+1,a.tabIndex=0,a.ariaHasPopup="dialog",a.ariaControls="commentPopup",a.setAttribute("data-l10n-id","pdfjs-show-comment-button"),R(this,bt,lE).call(this),R(this,bt,oE).call(this),a.addEventListener("keydown",u(this,bc),{signal:e}),a.addEventListener("click",i,{signal:e}),a.addEventListener("pointerenter",s,{signal:e}),a.addEventListener("pointerleave",r,{signal:e}),o.after(a)}}get commentButtonColor(){const{color:e,opacity:t}=u(this,di).commentData;return e?u(this,yp)._commentManager.makeCommentColor(e,t):null}focusCommentButton(){setTimeout(()=>{var e;(e=u(this,Rn))==null||e.focus()},0)}getData(){const{richText:e,color:t,opacity:i,creationDate:s,modificationDate:r}=u(this,di).commentData;return{contentsObj:{str:this.comment},richText:e,color:t,opacity:i,creationDate:s,modificationDate:r}}get elementBeforePopup(){return u(this,Rn)}get comment(){return u(this,Ec)||k(this,Ec,u(this,di).commentText),u(this,Ec)}set comment(e){e!==this.comment&&(u(this,di).commentText=k(this,Ec,e))}focus(){var e;(e=u(this,di).container)==null||e.focus()}get parentBoundingClientRect(){return u(this,di).layer.getBoundingClientRect()}setCommentButtonStates({selected:e,hasPopup:t}){u(this,Rn)&&(u(this,Rn).classList.toggle("selected",e),u(this,Rn).ariaExpanded=t)}setSelectedCommentButton(e){u(this,Rn).classList.toggle("selected",e)}get commentPopupPosition(){if(u(this,Sc))return u(this,Sc);const{x:e,y:t,height:i}=u(this,Rn).getBoundingClientRect(),{x:s,y:r,width:a,height:o}=u(this,di).layer.getBoundingClientRect();return[(e-s)/a,(t+i-r)/o]}set commentPopupPosition(e){k(this,Sc,e)}hasDefaultPopupPosition(){return u(this,Sc)===null}get commentButtonPosition(){return u(this,Ko)}get commentButtonWidth(){return u(this,Rn).getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(e){const[t,i]=u(this,Sc)||this.commentButtonPosition.map(h=>h/100),s=this.parentBoundingClientRect,{x:r,y:a,width:o,height:c}=s;u(this,zs).showDialog(null,this,r+t*o,a+i*c,{...e,parentDimensions:s})}render(){var i,s;if(u(this,Fs))return;const e=k(this,Fs,document.createElement("div"));if(e.className="popup",u(this,xp)){const r=e.style.outlineColor=$e.makeHexColor(...u(this,xp));e.style.backgroundColor=`color-mix(in srgb, ${r} 30%, white)`}const t=document.createElement("span");if(t.className="header",(i=u(this,bp))!=null&&i.str){const r=document.createElement("span");r.className="title",t.append(r),{dir:r.dir,str:r.textContent}=u(this,bp)}if(e.append(t),u(this,wc)){const r=document.createElement("time");r.className="popupDate",r.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),r.setAttribute("data-l10n-args",JSON.stringify({dateObj:u(this,wc).valueOf()})),r.dateTime=u(this,wc).toISOString(),t.append(r)}rL({html:u(this,bt,Uv)||u(this,Ha).str,dir:(s=u(this,Ha))==null?void 0:s.dir,className:"popupContent"},e),u(this,jn).append(e)}updateEdited({rect:e,popup:t,deleted:i}){var s;if(u(this,zs)){i?(this.remove(),k(this,Ec,null)):t&&(t.deleted?this.remove():(R(this,bt,lE).call(this),k(this,Ec,t.text))),e&&(k(this,Ko,null),R(this,bt,aE).call(this),R(this,bt,oE).call(this));return}if(i||t!=null&&t.deleted){this.remove();return}R(this,bt,Fv).call(this),u(this,ph)||k(this,ph,{contentsObj:u(this,Ha),richText:u(this,Zo)}),e&&k(this,Xo,null),t&&t.text&&(k(this,Zo,R(this,bt,TM).call(this,t.text)),k(this,wc,t1.toDateObject(t.date)),k(this,Ha,null)),(s=u(this,Fs))==null||s.remove(),k(this,Fs,null)}resetEdited(){var e;u(this,ph)&&({contentsObj:ni(this,Ha)._,richText:ni(this,Zo)._}=u(this,ph),k(this,ph,null),(e=u(this,Fs))==null||e.remove(),k(this,Fs,null),k(this,Xo,null))}remove(){var e,t,i;if((e=u(this,Yo))==null||e.abort(),k(this,Yo,null),(t=u(this,Fs))==null||t.remove(),k(this,Fs,null),k(this,Ac,!1),k(this,$a,!1),(i=u(this,Rn))==null||i.remove(),k(this,Rn,null),this.trigger)for(const s of this.trigger)s.classList.remove("popupTriggerArea")}forceHide(){k(this,Ac,this.isVisible),u(this,Ac)&&(u(this,jn).hidden=!0)}maybeShow(){u(this,zs)||(R(this,bt,Fv).call(this),u(this,Ac)&&(u(this,Fs)||R(this,bt,$v).call(this),k(this,Ac,!1),u(this,jn).hidden=!1))}get isVisible(){return u(this,zs)?!1:u(this,jn).hidden===!1}}zs=new WeakMap,bc=new WeakMap,C1=new WeakMap,N1=new WeakMap,mp=new WeakMap,xp=new WeakMap,jn=new WeakMap,Ha=new WeakMap,wc=new WeakMap,fh=new WeakMap,yp=new WeakMap,vp=new WeakMap,$a=new WeakMap,Fs=new WeakMap,Yo=new WeakMap,Xo=new WeakMap,Rn=new WeakMap,Ko=new WeakMap,Sc=new WeakMap,Cx=new WeakMap,Zo=new WeakMap,bp=new WeakMap,ph=new WeakMap,Ac=new WeakMap,di=new WeakMap,Ec=new WeakMap,bt=new WeakSet,Fv=function(){var t;if(u(this,Yo))return;k(this,Yo,new AbortController);const{signal:e}=u(this,Yo);for(const i of this.trigger)i.addEventListener("click",u(this,mp),{signal:e}),i.addEventListener("pointerenter",u(this,N1),{signal:e}),i.addEventListener("pointerleave",u(this,C1),{signal:e}),i.classList.add("popupTriggerArea");for(const i of u(this,fh))(t=i.container)==null||t.addEventListener("keydown",u(this,bc),{signal:e})},aE=function(){const e=u(this,fh).find(t=>t.hasCommentButton);e&&k(this,Ko,e._normalizePoint(e.commentButtonPosition))},oE=function(){if(u(this,di).extraPopupElement&&!u(this,di).editor)return;u(this,Rn)||this.renderCommentButton();const[e,t]=u(this,Ko),{style:i}=u(this,Rn);i.left=`calc(${e}%)`,i.top=`calc(${t}% - var(--comment-button-dim))`},lE=function(){u(this,di).extraPopupElement||(u(this,Rn)||this.renderCommentButton(),u(this,Rn).style.backgroundColor=this.commentButtonColor||"")},Uv=function(){const e=u(this,Zo),t=u(this,Ha);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&u(this,Zo).html||null},cE=function(){var e,t,i;return((i=(t=(e=u(this,bt,Uv))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:i.fontSize)||0},kM=function(){var e,t,i;return((i=(t=(e=u(this,bt,Uv))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:i.color)||null},TM=function(e){const t=[],i={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},s={style:{color:u(this,bt,kM),fontSize:u(this,bt,cE)?`calc(${u(this,bt,cE)}px * var(--total-scale-factor))`:""}};for(const r of e.split(`
`))t.push({name:"span",value:r,attributes:s});return i},DM=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&u(this,$a))&&R(this,bt,Hv).call(this)},jM=function(){if(u(this,Xo)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:i,pageX:s,pageY:r}}}=u(this,yp);let a=!!u(this,vp),o=a?u(this,vp):u(this,Cx);for(const v of u(this,fh))if(!o||$e.intersect(v.data.rect,o)!==null){o=v.data.rect,a=!0;break}const c=$e.normalizeRect([o[0],e[3]-o[1]+e[1],o[2],e[3]-o[3]+e[1]]),d=a?o[2]-o[0]+5:0,f=c[0]+d,p=c[1];k(this,Xo,[100*(f-s)/t,100*(p-r)/i]);const{style:g}=u(this,jn);g.left=`${u(this,Xo)[0]}%`,g.top=`${u(this,Xo)[1]}%`},Hv=function(){if(u(this,zs)){u(this,zs).toggleCommentPopup(this,!1);return}k(this,$a,!u(this,$a)),u(this,$a)?(R(this,bt,$v).call(this),u(this,jn).addEventListener("click",u(this,mp)),u(this,jn).addEventListener("keydown",u(this,bc))):(R(this,bt,uE).call(this),u(this,jn).removeEventListener("click",u(this,mp)),u(this,jn).removeEventListener("keydown",u(this,bc)))},$v=function(){u(this,Fs)||this.render(),this.isVisible?u(this,$a)&&u(this,jn).classList.add("focused"):(R(this,bt,jM).call(this),u(this,jn).hidden=!1,u(this,jn).style.zIndex=parseInt(u(this,jn).style.zIndex)+1e3)},uE=function(){u(this,jn).classList.remove("focused"),!(u(this,$a)||!this.isVisible)&&(u(this,jn).hidden=!0,u(this,jn).style.zIndex=parseInt(u(this,jn).style.zIndex)-1e3)};class RM extends _n{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=gt.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=this.contentElement=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const i=document.createElement("span");i.textContent=t,e.append(i)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}var Nx;class bW extends _n{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});D(this,Nx,null)}render(){this.container.classList.add("lineAnnotation");const{data:t,width:i,height:s}=this,r=this.svgFactory.create(i,s,!0),a=k(this,Nx,this.svgFactory.createElement("svg:line"));return a.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),a.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),a.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),a.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),a.setAttribute("stroke-width",t.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return u(this,Nx)}addHighlightArea(){this.container.classList.add("highlightArea")}}Nx=new WeakMap;var _x;class wW extends _n{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});D(this,_x,null)}render(){this.container.classList.add("squareAnnotation");const{data:t,width:i,height:s}=this,r=this.svgFactory.create(i,s,!0),a=t.borderStyle.width,o=k(this,_x,this.svgFactory.createElement("svg:rect"));return o.setAttribute("x",a/2),o.setAttribute("y",a/2),o.setAttribute("width",i-a),o.setAttribute("height",s-a),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return u(this,_x)}addHighlightArea(){this.container.classList.add("highlightArea")}}_x=new WeakMap;var kx;class SW extends _n{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});D(this,kx,null)}render(){this.container.classList.add("circleAnnotation");const{data:t,width:i,height:s}=this,r=this.svgFactory.create(i,s,!0),a=t.borderStyle.width,o=k(this,kx,this.svgFactory.createElement("svg:ellipse"));return o.setAttribute("cx",i/2),o.setAttribute("cy",s/2),o.setAttribute("rx",i/2-a/2),o.setAttribute("ry",s/2-a/2),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return u(this,kx)}addHighlightArea(){this.container.classList.add("highlightArea")}}kx=new WeakMap;var Tx;class LM extends _n{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});D(this,Tx,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:i,borderStyle:s,popupRef:r},width:a,height:o}=this;if(!i)return this.container;const c=this.svgFactory.create(a,o,!0);let h=[];for(let f=0,p=i.length;f<p;f+=2){const g=i[f]-t[0],v=t[3]-i[f+1];h.push(`${g},${v}`)}h=h.join(" ");const d=k(this,Tx,this.svgFactory.createElement(this.svgElementName));return d.setAttribute("points",h),d.setAttribute("stroke-width",s.width||1),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),c.append(d),this.container.append(c),!r&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return u(this,Tx)}addHighlightArea(){this.container.classList.add("highlightArea")}}Tx=new WeakMap;class AW extends LM{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class EW extends _n{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}var Dx,gh,jx,hE;class _N extends _n{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});D(this,jx);D(this,Dx,null);D(this,gh,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?gt.HIGHLIGHT:gt.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:i,inkLists:s,borderStyle:r,popupRef:a}}=this,{transform:o,width:c,height:h}=R(this,jx,hE).call(this,i,t),d=this.svgFactory.create(c,h,!0),f=k(this,Dx,this.svgFactory.createElement("svg:g"));d.append(f),f.setAttribute("stroke-width",r.width||1),f.setAttribute("stroke-linecap","round"),f.setAttribute("stroke-linejoin","round"),f.setAttribute("stroke-miterlimit",10),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),f.setAttribute("transform",o);for(let p=0,g=s.length;p<g;p++){const v=this.svgFactory.createElement(this.svgElementName);u(this,gh).push(v),v.setAttribute("points",s[p].join(",")),f.append(v)}return!a&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(d),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:i,points:s,rect:r}=t,a=u(this,Dx);if(i>=0&&a.setAttribute("stroke-width",i||1),s)for(let o=0,c=u(this,gh).length;o<c;o++)u(this,gh)[o].setAttribute("points",s[o].join(","));if(r){const{transform:o,width:c,height:h}=R(this,jx,hE).call(this,this.data.rotation,r);a.parentElement.setAttribute("viewBox",`0 0 ${c} ${h}`),a.setAttribute("transform",o)}}getElementsToTriggerPopup(){return u(this,gh)}addHighlightArea(){this.container.classList.add("highlightArea")}}Dx=new WeakMap,gh=new WeakMap,jx=new WeakSet,hE=function(t,i){switch(t){case 90:return{transform:`rotate(90) translate(${-i[0]},${i[1]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};case 180:return{transform:`rotate(180) translate(${-i[2]},${i[1]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]};case 270:return{transform:`rotate(270) translate(${-i[2]},${i[3]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};default:return{transform:`translate(${-i[0]},${i[3]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]}}};class MM extends _n{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=gt.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const i=document.createElement("mark");i.classList.add("overlaidText"),i.textContent=e,this.container.append(i)}return this.container}}class CW extends _n{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),e){const i=document.createElement("u");i.classList.add("overlaidText"),i.textContent=e,this.container.append(i)}return this.container}}class NW extends _n{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),e){const i=document.createElement("u");i.classList.add("overlaidText"),i.textContent=e,this.container.append(i)}return this.container}}class _W extends _n{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),e){const i=document.createElement("s");i.classList.add("overlaidText"),i.textContent=e,this.container.append(i)}return this.container}}class OM extends _n{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=gt.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}var Rx,Lx,dE;class kW extends _n{constructor(t){var s;super(t,{isRenderable:!0});D(this,Lx);D(this,Rx,null);const{file:i}=this.data;this.filename=i.filename,this.content=i.content,(s=this.linkService.eventBus)==null||s.dispatch("fileattachmentannotation",{source:this,...i})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:i}=this;let s;i.hasAppearance||i.fillAlpha===0?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(i.name)?"paperclip":"pushpin"}.svg`,i.fillAlpha&&i.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(i.fillAlpha*100)}%);`)),s.addEventListener("dblclick",R(this,Lx,dE).bind(this)),k(this,Rx,s);const{isMac:r}=li.platform;return t.addEventListener("keydown",a=>{a.key==="Enter"&&(r?a.metaKey:a.ctrlKey)&&R(this,Lx,dE).call(this)}),!i.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):s.classList.add("popupTriggerArea"),t.append(s),t}getElementsToTriggerPopup(){return u(this,Rx)}addHighlightArea(){this.container.classList.add("highlightArea")}}Rx=new WeakMap,Lx=new WeakSet,dE=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var mh,xh,wp,Cc,Mx,yh,Us,Ox,xl,qv,pE;const PN=class PN{constructor({div:e,accessibilityManager:t,annotationCanvasMap:i,annotationEditorUIManager:s,page:r,viewport:a,structTreeLayer:o,commentManager:c,linkService:h,annotationStorage:d}){D(this,xl);D(this,mh,null);D(this,xh,null);D(this,wp,null);D(this,Cc,new Map);D(this,Mx,null);D(this,yh,null);D(this,Us,[]);D(this,Ox,!1);this.div=e,k(this,mh,t),k(this,xh,i),k(this,Mx,o||null),k(this,yh,h||null),k(this,wp,d||new SN),this.page=r,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=s,this._commentManager=c||null}hasEditableAnnotations(){return u(this,Cc).size>0}async render(e){var o;const{annotations:t}=e,i=this.div;Zh(i,this.viewport);const s=new Map,r=[],a={data:null,layer:i,linkService:u(this,yh),downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new c1,annotationStorage:u(this,wp),enableComment:e.enableComment===!0,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const c of t){if(c.noHTML)continue;const h=c.annotationType===Yn.POPUP;if(h){const p=s.get(c.id);if(!p)continue;if(!this._commentManager){r.push(c);continue}a.elements=p}else if(c.rect[2]===c.rect[0]||c.rect[3]===c.rect[1])continue;a.data=c;const d=q2.create(a);if(!d.isRenderable)continue;if(!h&&(u(this,Us).push(d),c.popupRef)){const p=s.get(c.popupRef);p?p.push(d):s.set(c.popupRef,[d])}const f=d.render();c.hidden&&(f.style.visibility="hidden"),d._isEditable&&(u(this,Cc).set(d.data.id,d),(o=this._annotationEditorUIManager)==null||o.renderAnnotationElement(d))}await R(this,xl,qv).call(this);for(const c of r){const h=a.elements=s.get(c.id);a.data=c;const d=q2.create(a);if(!d.isRenderable)continue;const f=d.render();d.contentElement.id=`${tf}${c.id}`,c.hidden&&(f.style.visibility="hidden"),h.at(-1).container.after(f)}R(this,xl,pE).call(this)}async addLinkAnnotations(e){const t={data:null,layer:this.div,linkService:u(this,yh),svgFactory:new c1,parent:this};for(const i of e){i.borderStyle||(i.borderStyle=PN._defaultBorderStyle),t.data=i;const s=q2.create(t);s.isRenderable&&(s.render(),s.contentElement.id=`${tf}${i.id}`,u(this,Us).push(s))}await R(this,xl,qv).call(this)}update({viewport:e}){const t=this.div;this.viewport=e,Zh(t,{rotation:e.rotation}),R(this,xl,pE).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(u(this,Cc).values())}getEditableAnnotation(e){return u(this,Cc).get(e)}addFakeAnnotation(e){const{div:t}=this,{id:i,rotation:s}=e,r=new dW({data:{id:i,rect:e.getPDFRect(),rotation:s},editor:e,layer:t,parent:this,enableComment:!!this._commentManager,linkService:u(this,yh),annotationStorage:u(this,wp)});return r.render(),r.contentElement.id=`${tf}${i}`,r.createOrUpdatePopup(),u(this,Us).push(r),r}removeAnnotation(e){var s;const t=u(this,Us).findIndex(r=>r.data.id===e);if(t<0)return;const[i]=u(this,Us).splice(t,1);(s=u(this,mh))==null||s.removePointerInTextLayer(i.contentElement)}updateFakeAnnotations(e){if(e.length!==0){for(const t of e)t.updateFakeAnnotationElement(this);R(this,xl,qv).call(this)}}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}static get _defaultBorderStyle(){return ht(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:Md.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}};mh=new WeakMap,xh=new WeakMap,wp=new WeakMap,Cc=new WeakMap,Mx=new WeakMap,yh=new WeakMap,Us=new WeakMap,Ox=new WeakMap,xl=new WeakSet,qv=async function(){var i,s,r;if(u(this,Us).length===0)return;this.div.replaceChildren();const e=[];if(!u(this,Ox)){k(this,Ox,!0);for(const{contentElement:a,data:{id:o}}of u(this,Us)){const c=a.id=`${tf}${o}`;e.push((i=u(this,Mx))==null?void 0:i.getAriaAttributes(c).then(h=>{if(h)for(const[d,f]of h)a.setAttribute(d,f)}))}}u(this,Us).sort(({data:{rect:[a,o,c,h]}},{data:{rect:[d,f,p,g]}})=>{if(a===c&&o===h)return 1;if(d===p&&f===g)return-1;const v=h,b=o,x=(o+h)/2,m=g,y=f,w=(f+g)/2;if(x>=m&&w<=b)return-1;if(w>=v&&x<=y)return 1;const E=(a+c)/2,S=(d+p)/2;return E-S});const t=document.createDocumentFragment();for(const a of u(this,Us))t.append(a.container),this._commentManager?(r=((s=a.extraPopupElement)==null?void 0:s.popup)||a.popup)==null||r.renderCommentButton():a.extraPopupElement&&t.append(a.extraPopupElement.render());if(this.div.append(t),await Promise.all(e),u(this,mh))for(const a of u(this,Us))u(this,mh).addPointerInTextLayer(a.contentElement,!1)},pE=function(){var t;if(!u(this,xh))return;const e=this.div;for(const[i,s]of u(this,xh)){const r=e.querySelector(`[data-annotation-id="${i}"]`);if(!r)continue;s.className="annotationContent";const{firstChild:a}=r;a?a.nodeName==="CANVAS"?a.replaceWith(s):a.classList.contains("annotationContent")?a.after(s):a.before(s):r.append(s);const o=u(this,Cc).get(i);o&&(o._hasNoCanvas?((t=this._annotationEditorUIManager)==null||t.setMissingCanvas(i,r.id,s),o._hasNoCanvas=!1):o.canvas=s)}u(this,xh).clear()};let fE=PN;const sv=/\r\n?|\n/g;var Hs,Px,vh,$s,ei,PM,IM,BM,Vv,yl,Gv,Wv,zM,mE,FM;const gn=class gn extends dn{constructor(t){super({...t,name:"freeTextEditor"});D(this,ei);D(this,Hs,"");D(this,Px,`${this.id}-editor`);D(this,vh,null);D(this,$s);we(this,"_colorPicker",null);this.color=t.color||gn._defaultColor||dn._defaultLineColor,k(this,$s,t.fontSize||gn._defaultFontSize),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static get _keyboardManager(){const t=gn.prototype,i=a=>a.isEmpty(),s=Qh.TRANSLATE_SMALL,r=Qh.TRANSLATE_BIG;return ht(this,"_keyboardManager",new Ey([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:i}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[s,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[r,0],checker:i}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:i}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,s],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,r],checker:i}]]))}static initialize(t,i){dn.initialize(t,i);const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,i){switch(t){case Tt.FREETEXT_SIZE:gn._defaultFontSize=i;break;case Tt.FREETEXT_COLOR:gn._defaultColor=i;break}}updateParams(t,i){switch(t){case Tt.FREETEXT_SIZE:R(this,ei,PM).call(this,i);break;case Tt.FREETEXT_COLOR:R(this,ei,IM).call(this,i);break}}static get defaultPropertiesToUpdate(){return[[Tt.FREETEXT_SIZE,gn._defaultFontSize],[Tt.FREETEXT_COLOR,gn._defaultColor||dn._defaultLineColor]]}get propertiesToUpdate(){return[[Tt.FREETEXT_SIZE,u(this,$s)],[Tt.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new l1(this)),[["colorPicker",this._colorPicker]]}get colorType(){return Tt.FREETEXT_COLOR}onUpdatedColor(){var t;this.editorDiv.style.color=this.color,(t=this._colorPicker)==null||t.update(this.color),super.onUpdatedColor()}_translateEmpty(t,i){this._uiManager.translateSelectedEditors(t,i,!0)}getInitialTranslation(){const t=this.parentScale;return[-gn._internalPadding*t,-(gn._internalPadding+u(this,$s))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),k(this,vh,new AbortController);const t=this._uiManager.combinedSignal(u(this,vh));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){var t;return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",u(this,Px)),this._isDraggable=!0,(t=u(this,vh))==null||t.abort(),k(this,vh,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var i;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(i=this._initialOptions)!=null&&i.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=u(this,Hs),i=k(this,Hs,R(this,ei,BM).call(this).trimEnd());if(t===i)return;const s=r=>{if(k(this,Hs,r),!r){this.remove();return}R(this,ei,Wv).call(this),this._uiManager.rebuild(this),R(this,ei,Vv).call(this)};this.addCommands({cmd:()=>{s(i)},undo:()=>{s(t)},mustExec:!1}),R(this,ei,Vv).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){gn._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,i;(this._isCopy||this.annotationElementId)&&(t=this.x,i=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",u(this,Px)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${u(this,$s)}px * var(--total-scale-factor))`,s.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[r,a]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[c,h]=this.getInitialTranslation();[c,h]=this.pageTranslationToScreen(c,h);const[d,f]=this.pageDimensions,[p,g]=this.pageTranslation;let v,b;switch(this.rotation){case 0:v=t+(o[0]-p)/d,b=i+this.height-(o[1]-g)/f;break;case 90:v=t+(o[0]-p)/d,b=i-(o[1]-g)/f,[c,h]=[h,-c];break;case 180:v=t-this.width+(o[0]-p)/d,b=i-(o[1]-g)/f,[c,h]=[-c,-h];break;case 270:v=t+(o[0]-p-this.height*f)/d,b=i+(o[1]-g-this.width*d)/f,[c,h]=[-h,c];break}this.setAt(v*r,b*a,c,h)}else this._moveAfterPaste(t,i);R(this,ei,Wv).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var v,b,x;const i=t.clipboardData||window.clipboardData,{types:s}=i;if(s.length===1&&s[0]==="text/plain")return;t.preventDefault();const r=R(v=gn,yl,mE).call(v,i.getData("text")||"").replaceAll(sv,`
`);if(!r)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const o=a.getRangeAt(0);if(!r.includes(`
`)){o.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:c,startOffset:h}=o,d=[],f=[];if(c.nodeType===Node.TEXT_NODE){const m=c.parentElement;if(f.push(c.nodeValue.slice(h).replaceAll(sv,"")),m!==this.editorDiv){let y=d;for(const w of this.editorDiv.childNodes){if(w===m){y=f;continue}y.push(R(b=gn,yl,Gv).call(b,w))}}d.push(c.nodeValue.slice(0,h).replaceAll(sv,""))}else if(c===this.editorDiv){let m=d,y=0;for(const w of this.editorDiv.childNodes)y++===h&&(m=f),m.push(R(x=gn,yl,Gv).call(x,w))}k(this,Hs,`${d.join(`
`)}${r}${f.join(`
`)}`),R(this,ei,Wv).call(this);const p=new Range;let g=Math.sumPrecise(d.map(m=>m.length));for(const{firstChild:m}of this.editorDiv.childNodes)if(m.nodeType===Node.TEXT_NODE){const y=m.nodeValue.length;if(g<=y){p.setStart(m,g),p.setEnd(m,g);break}g-=y}a.removeAllRanges(),a.addRange(p)}get contentDiv(){return this.editorDiv}getPDFRect(){const t=gn._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,i,s){var o;let r=null;if(t instanceof RM){const{data:{defaultAppearanceData:{fontSize:c,fontColor:h},rect:d,rotation:f,id:p,popupRef:g,richText:v,contentsObj:b,creationDate:x,modificationDate:m},textContent:y,textPosition:w,parent:{page:{pageNumber:E}}}=t;if(!y||y.length===0)return null;r=t={annotationType:gt.FREETEXT,color:Array.from(h),fontSize:c,value:y.join(`
`),position:w,pageIndex:E-1,rect:d.slice(0),rotation:f,annotationElementId:p,id:p,deleted:!1,popupRef:g,comment:(b==null?void 0:b.str)||null,richText:v,creationDate:x,modificationDate:m}}const a=await super.deserialize(t,i,s);return k(a,$s,t.fontSize),a.color=$e.makeHexColor(...t.color),k(a,Hs,R(o=gn,yl,mE).call(o,t.value)),a._initialData=r,t.comment&&a.setCommentData(t),a}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=dn._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),s=Object.assign(super.serialize(t),{color:i,fontSize:u(this,$s),value:R(this,ei,zM).call(this)});return this.addComment(s),t?(s.isCopy=!0,s):this.annotationElementId&&!R(this,ei,FM).call(this,s)?null:(s.id=this.annotationElementId,s)}renderAnnotationElement(t){const i=super.renderAnnotationElement(t);if(!i)return null;const{style:s}=i;s.fontSize=`calc(${u(this,$s)}px * var(--total-scale-factor))`,s.color=this.color,i.replaceChildren();for(const r of u(this,Hs).split(`
`)){const a=document.createElement("div");a.append(r?document.createTextNode(r):document.createElement("br")),i.append(a)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:u(this,Hs)}}),i}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};Hs=new WeakMap,Px=new WeakMap,vh=new WeakMap,$s=new WeakMap,ei=new WeakSet,PM=function(t){const i=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--total-scale-factor))`,this.translate(0,-(r-u(this,$s))*this.parentScale),k(this,$s,r),R(this,ei,Vv).call(this)},s=u(this,$s);this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Tt.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},IM=function(t){const i=r=>{this.color=r,this.onUpdatedColor()},s=this.color;this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Tt.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},BM=function(){var s;const t=[];this.editorDiv.normalize();let i=null;for(const r of this.editorDiv.childNodes)(i==null?void 0:i.nodeType)===Node.TEXT_NODE&&r.nodeName==="BR"||(t.push(R(s=gn,yl,Gv).call(s,r)),i=r);return t.join(`
`)},Vv=function(){const[t,i]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:r,div:a}=this,o=a.style.display,c=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",r.div.append(this.div),s=a.getBoundingClientRect(),a.remove(),a.style.display=o,a.classList.toggle("hidden",c)}this.rotation%180===this.parentRotation%180?(this.width=s.width/t,this.height=s.height/i):(this.width=s.height/t,this.height=s.width/i),this.fixAndSetPosition()},yl=new WeakSet,Gv=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(sv,"")},Wv=function(){if(this.editorDiv.replaceChildren(),!!u(this,Hs))for(const t of u(this,Hs).split(`
`)){const i=document.createElement("div");i.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(i)}},zM=function(){return u(this,Hs).replaceAll("Â "," ")},mE=function(t){return t.replaceAll(" ","Â ")},FM=function(t){const{value:i,fontSize:s,color:r,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==i||t.fontSize!==s||t.color.some((o,c)=>o!==r[c])||t.pageIndex!==a},D(gn,yl),we(gn,"_freeTextDefaultContent",""),we(gn,"_internalPadding",0),we(gn,"_defaultColor",null),we(gn,"_defaultFontSize",10),we(gn,"_type","freetext"),we(gn,"_editorType",gt.FREETEXT);let gE=gn;class Ye{toSVGPath(){zt("Abstract method `toSVGPath` must be implemented.")}get box(){zt("Abstract getter `box` must be implemented.")}serialize(e,t){zt("Abstract method `serialize` must be implemented.")}static _rescale(e,t,i,s,r,a){a||(a=new Float32Array(e.length));for(let o=0,c=e.length;o<c;o+=2)a[o]=t+e[o]*s,a[o+1]=i+e[o+1]*r;return a}static _rescaleAndSwap(e,t,i,s,r,a){a||(a=new Float32Array(e.length));for(let o=0,c=e.length;o<c;o+=2)a[o]=t+e[o+1]*s,a[o+1]=i+e[o]*r;return a}static _translate(e,t,i,s){s||(s=new Float32Array(e.length));for(let r=0,a=e.length;r<a;r+=2)s[r]=t+e[r],s[r+1]=i+e[r+1];return s}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,i,s,r){switch(r){case 90:return[1-t/i,e/s];case 180:return[1-e/i,1-t/s];case 270:return[t/i,1-e/s];default:return[e/i,t/s]}}static _normalizePagePoint(e,t,i){switch(i){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,i,s,r,a){return[(e+5*i)/6,(t+5*s)/6,(5*i+r)/6,(5*s+a)/6,(i+r)/2,(s+a)/2]}}we(Ye,"PRECISION",1e-4);var qs,aa,Sp,Ap,qa,St,bh,wh,Ix,Bx,Ep,Cp,Nc,zx,_1,k1,oi,um,UM,HM,$M,qM,VM,GM;const wo=class wo{constructor({x:e,y:t},i,s,r,a,o=0){D(this,oi);D(this,qs);D(this,aa,[]);D(this,Sp);D(this,Ap);D(this,qa,[]);D(this,St,new Float32Array(18));D(this,bh);D(this,wh);D(this,Ix);D(this,Bx);D(this,Ep);D(this,Cp);D(this,Nc,[]);k(this,qs,i),k(this,Cp,r*s),k(this,Ap,a),u(this,St).set([NaN,NaN,NaN,NaN,e,t],6),k(this,Sp,o),k(this,Bx,u(wo,zx)*s),k(this,Ix,u(wo,k1)*s),k(this,Ep,s),u(this,Nc).push(e,t)}isEmpty(){return isNaN(u(this,St)[8])}add({x:e,y:t}){var M;k(this,bh,e),k(this,wh,t);const[i,s,r,a]=u(this,qs);let[o,c,h,d]=u(this,St).subarray(8,12);const f=e-h,p=t-d,g=Math.hypot(f,p);if(g<u(this,Ix))return!1;const v=g-u(this,Bx),b=v/g,x=b*f,m=b*p;let y=o,w=c;o=h,c=d,h+=x,d+=m,(M=u(this,Nc))==null||M.push(e,t);const E=-m/v,S=x/v,_=E*u(this,Cp),T=S*u(this,Cp);return u(this,St).set(u(this,St).subarray(2,8),0),u(this,St).set([h+_,d+T],4),u(this,St).set(u(this,St).subarray(14,18),12),u(this,St).set([h-_,d-T],16),isNaN(u(this,St)[6])?(u(this,qa).length===0&&(u(this,St).set([o+_,c+T],2),u(this,qa).push(NaN,NaN,NaN,NaN,(o+_-i)/r,(c+T-s)/a),u(this,St).set([o-_,c-T],14),u(this,aa).push(NaN,NaN,NaN,NaN,(o-_-i)/r,(c-T-s)/a)),u(this,St).set([y,w,o,c,h,d],6),!this.isEmpty()):(u(this,St).set([y,w,o,c,h,d],6),Math.abs(Math.atan2(w-c,y-o)-Math.atan2(m,x))<Math.PI/2?([o,c,h,d]=u(this,St).subarray(2,6),u(this,qa).push(NaN,NaN,NaN,NaN,((o+h)/2-i)/r,((c+d)/2-s)/a),[o,c,y,w]=u(this,St).subarray(14,18),u(this,aa).push(NaN,NaN,NaN,NaN,((y+o)/2-i)/r,((w+c)/2-s)/a),!0):([y,w,o,c,h,d]=u(this,St).subarray(0,6),u(this,qa).push(((y+5*o)/6-i)/r,((w+5*c)/6-s)/a,((5*o+h)/6-i)/r,((5*c+d)/6-s)/a,((o+h)/2-i)/r,((c+d)/2-s)/a),[h,d,o,c,y,w]=u(this,St).subarray(12,18),u(this,aa).push(((y+5*o)/6-i)/r,((w+5*c)/6-s)/a,((5*o+h)/6-i)/r,((5*c+d)/6-s)/a,((o+h)/2-i)/r,((c+d)/2-s)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const e=u(this,qa),t=u(this,aa);if(isNaN(u(this,St)[6])&&!this.isEmpty())return R(this,oi,UM).call(this);const i=[];i.push(`M${e[4]} ${e[5]}`);for(let s=6;s<e.length;s+=6)isNaN(e[s])?i.push(`L${e[s+4]} ${e[s+5]}`):i.push(`C${e[s]} ${e[s+1]} ${e[s+2]} ${e[s+3]} ${e[s+4]} ${e[s+5]}`);R(this,oi,$M).call(this,i);for(let s=t.length-6;s>=6;s-=6)isNaN(t[s])?i.push(`L${t[s+4]} ${t[s+5]}`):i.push(`C${t[s]} ${t[s+1]} ${t[s+2]} ${t[s+3]} ${t[s+4]} ${t[s+5]}`);return R(this,oi,HM).call(this,i),i.join(" ")}newFreeDrawOutline(e,t,i,s,r,a){return new WM(e,t,i,s,r,a)}getOutlines(){var f;const e=u(this,qa),t=u(this,aa),i=u(this,St),[s,r,a,o]=u(this,qs),c=new Float32Array((((f=u(this,Nc))==null?void 0:f.length)??0)+2);for(let p=0,g=c.length-2;p<g;p+=2)c[p]=(u(this,Nc)[p]-s)/a,c[p+1]=(u(this,Nc)[p+1]-r)/o;if(c[c.length-2]=(u(this,bh)-s)/a,c[c.length-1]=(u(this,wh)-r)/o,isNaN(i[6])&&!this.isEmpty())return R(this,oi,qM).call(this,c);const h=new Float32Array(u(this,qa).length+24+u(this,aa).length);let d=e.length;for(let p=0;p<d;p+=2){if(isNaN(e[p])){h[p]=h[p+1]=NaN;continue}h[p]=e[p],h[p+1]=e[p+1]}d=R(this,oi,GM).call(this,h,d);for(let p=t.length-6;p>=6;p-=6)for(let g=0;g<6;g+=2){if(isNaN(t[p+g])){h[d]=h[d+1]=NaN,d+=2;continue}h[d]=t[p+g],h[d+1]=t[p+g+1],d+=2}return R(this,oi,VM).call(this,h,d),this.newFreeDrawOutline(h,c,u(this,qs),u(this,Ep),u(this,Sp),u(this,Ap))}};qs=new WeakMap,aa=new WeakMap,Sp=new WeakMap,Ap=new WeakMap,qa=new WeakMap,St=new WeakMap,bh=new WeakMap,wh=new WeakMap,Ix=new WeakMap,Bx=new WeakMap,Ep=new WeakMap,Cp=new WeakMap,Nc=new WeakMap,zx=new WeakMap,_1=new WeakMap,k1=new WeakMap,oi=new WeakSet,um=function(){const e=u(this,St).subarray(4,6),t=u(this,St).subarray(16,18),[i,s,r,a]=u(this,qs);return[(u(this,bh)+(e[0]-t[0])/2-i)/r,(u(this,wh)+(e[1]-t[1])/2-s)/a,(u(this,bh)+(t[0]-e[0])/2-i)/r,(u(this,wh)+(t[1]-e[1])/2-s)/a]},UM=function(){const[e,t,i,s]=u(this,qs),[r,a,o,c]=R(this,oi,um).call(this);return`M${(u(this,St)[2]-e)/i} ${(u(this,St)[3]-t)/s} L${(u(this,St)[4]-e)/i} ${(u(this,St)[5]-t)/s} L${r} ${a} L${o} ${c} L${(u(this,St)[16]-e)/i} ${(u(this,St)[17]-t)/s} L${(u(this,St)[14]-e)/i} ${(u(this,St)[15]-t)/s} Z`},HM=function(e){const t=u(this,aa);e.push(`L${t[4]} ${t[5]} Z`)},$M=function(e){const[t,i,s,r]=u(this,qs),a=u(this,St).subarray(4,6),o=u(this,St).subarray(16,18),[c,h,d,f]=R(this,oi,um).call(this);e.push(`L${(a[0]-t)/s} ${(a[1]-i)/r} L${c} ${h} L${d} ${f} L${(o[0]-t)/s} ${(o[1]-i)/r}`)},qM=function(e){const t=u(this,St),[i,s,r,a]=u(this,qs),[o,c,h,d]=R(this,oi,um).call(this),f=new Float32Array(36);return f.set([NaN,NaN,NaN,NaN,(t[2]-i)/r,(t[3]-s)/a,NaN,NaN,NaN,NaN,(t[4]-i)/r,(t[5]-s)/a,NaN,NaN,NaN,NaN,o,c,NaN,NaN,NaN,NaN,h,d,NaN,NaN,NaN,NaN,(t[16]-i)/r,(t[17]-s)/a,NaN,NaN,NaN,NaN,(t[14]-i)/r,(t[15]-s)/a],0),this.newFreeDrawOutline(f,e,u(this,qs),u(this,Ep),u(this,Sp),u(this,Ap))},VM=function(e,t){const i=u(this,aa);return e.set([NaN,NaN,NaN,NaN,i[4],i[5]],t),t+=6},GM=function(e,t){const i=u(this,St).subarray(4,6),s=u(this,St).subarray(16,18),[r,a,o,c]=u(this,qs),[h,d,f,p]=R(this,oi,um).call(this);return e.set([NaN,NaN,NaN,NaN,(i[0]-r)/o,(i[1]-a)/c,NaN,NaN,NaN,NaN,h,d,NaN,NaN,NaN,NaN,f,p,NaN,NaN,NaN,NaN,(s[0]-r)/o,(s[1]-a)/c],t),t+=24},D(wo,zx,8),D(wo,_1,2),D(wo,k1,u(wo,zx)+u(wo,_1));let u1=wo;var Np,Sh,Qo,Fx,Vs,Ux,Un,T1,YM;class WM extends Ye{constructor(t,i,s,r,a,o){super();D(this,T1);D(this,Np);D(this,Sh,new Float32Array(4));D(this,Qo);D(this,Fx);D(this,Vs);D(this,Ux);D(this,Un);k(this,Un,t),k(this,Vs,i),k(this,Np,s),k(this,Ux,r),k(this,Qo,a),k(this,Fx,o),this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],R(this,T1,YM).call(this,o);const[c,h,d,f]=u(this,Sh);for(let p=0,g=t.length;p<g;p+=2)t[p]=(t[p]-c)/d,t[p+1]=(t[p+1]-h)/f;for(let p=0,g=i.length;p<g;p+=2)i[p]=(i[p]-c)/d,i[p+1]=(i[p+1]-h)/f}toSVGPath(){const t=[`M${u(this,Un)[4]} ${u(this,Un)[5]}`];for(let i=6,s=u(this,Un).length;i<s;i+=6){if(isNaN(u(this,Un)[i])){t.push(`L${u(this,Un)[i+4]} ${u(this,Un)[i+5]}`);continue}t.push(`C${u(this,Un)[i]} ${u(this,Un)[i+1]} ${u(this,Un)[i+2]} ${u(this,Un)[i+3]} ${u(this,Un)[i+4]} ${u(this,Un)[i+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,i,s,r],a){const o=s-t,c=r-i;let h,d;switch(a){case 0:h=Ye._rescale(u(this,Un),t,r,o,-c),d=Ye._rescale(u(this,Vs),t,r,o,-c);break;case 90:h=Ye._rescaleAndSwap(u(this,Un),t,i,o,c),d=Ye._rescaleAndSwap(u(this,Vs),t,i,o,c);break;case 180:h=Ye._rescale(u(this,Un),s,i,-o,c),d=Ye._rescale(u(this,Vs),s,i,-o,c);break;case 270:h=Ye._rescaleAndSwap(u(this,Un),s,r,-o,-c),d=Ye._rescaleAndSwap(u(this,Vs),s,r,-o,-c);break}return{outline:Array.from(h),points:[Array.from(d)]}}get box(){return u(this,Sh)}newOutliner(t,i,s,r,a,o=0){return new u1(t,i,s,r,a,o)}getNewOutline(t,i){const[s,r,a,o]=u(this,Sh),[c,h,d,f]=u(this,Np),p=a*d,g=o*f,v=s*d+c,b=r*f+h,x=this.newOutliner({x:u(this,Vs)[0]*p+v,y:u(this,Vs)[1]*g+b},u(this,Np),u(this,Ux),t,u(this,Fx),i??u(this,Qo));for(let m=2;m<u(this,Vs).length;m+=2)x.add({x:u(this,Vs)[m]*p+v,y:u(this,Vs)[m+1]*g+b});return x.getOutlines()}}Np=new WeakMap,Sh=new WeakMap,Qo=new WeakMap,Fx=new WeakMap,Vs=new WeakMap,Ux=new WeakMap,Un=new WeakMap,T1=new WeakSet,YM=function(t){const i=u(this,Un);let s=i[4],r=i[5];const a=[s,r,s,r];let o=s,c=r,h=s,d=r;const f=t?Math.max:Math.min,p=new Float32Array(4);for(let v=6,b=i.length;v<b;v+=6){const x=i[v+4],m=i[v+5];isNaN(i[v])?($e.pointBoundingBox(x,m,a),c>m?(o=x,c=m):c===m&&(o=f(o,x)),d<m?(h=x,d=m):d===m&&(h=f(h,x))):(p[0]=p[1]=1/0,p[2]=p[3]=-1/0,$e.bezierBoundingBox(s,r,...i.slice(v,v+6),p),$e.rectBoundingBox(p[0],p[1],p[2],p[3],a),c>p[1]?(o=p[0],c=p[1]):c===p[1]&&(o=f(o,p[0])),d<p[3]?(h=p[2],d=p[3]):d===p[3]&&(h=f(h,p[2]))),s=x,r=m}const g=u(this,Sh);g[0]=a[0]-u(this,Qo),g[1]=a[1]-u(this,Qo),g[2]=a[2]-a[0]+2*u(this,Qo),g[3]=a[3]-a[1]+2*u(this,Qo),this.firstPoint=[o,c],this.lastPoint=[h,d]};var Hx,$x,qx,_c,oa,rs,XM,Yv,KM,ZM,yE;class xE{constructor(e,t=0,i=0,s=!0){D(this,rs);D(this,Hx);D(this,$x);D(this,qx);D(this,_c,[]);D(this,oa,[]);const r=[1/0,1/0,-1/0,-1/0],a=10**-4;for(const{x:b,y:x,width:m,height:y}of e){const w=Math.floor((b-t)/a)*a,E=Math.ceil((b+m+t)/a)*a,S=Math.floor((x-t)/a)*a,_=Math.ceil((x+y+t)/a)*a,T=[w,S,_,!0],j=[E,S,_,!1];u(this,_c).push(T,j),$e.rectBoundingBox(w,S,E,_,r)}const o=r[2]-r[0]+2*i,c=r[3]-r[1]+2*i,h=r[0]-i,d=r[1]-i;let f=s?-1/0:1/0,p=1/0;const g=u(this,_c).at(s?-1:-2),v=[g[0],g[2]];for(const b of u(this,_c)){const[x,m,y,w]=b;!w&&s?m<p?(p=m,f=x):m===p&&(f=Math.max(f,x)):w&&!s&&(m<p?(p=m,f=x):m===p&&(f=Math.min(f,x))),b[0]=(x-h)/o,b[1]=(m-d)/c,b[2]=(y-d)/c}k(this,Hx,new Float32Array([h,d,o,c])),k(this,$x,[f,p]),k(this,qx,v)}getOutlines(){u(this,_c).sort((t,i)=>t[0]-i[0]||t[1]-i[1]||t[2]-i[2]);const e=[];for(const t of u(this,_c))t[3]?(e.push(...R(this,rs,yE).call(this,t)),R(this,rs,KM).call(this,t)):(R(this,rs,ZM).call(this,t),e.push(...R(this,rs,yE).call(this,t)));return R(this,rs,XM).call(this,e)}}Hx=new WeakMap,$x=new WeakMap,qx=new WeakMap,_c=new WeakMap,oa=new WeakMap,rs=new WeakSet,XM=function(e){const t=[],i=new Set;for(const a of e){const[o,c,h]=a;t.push([o,c,a],[o,h,a])}t.sort((a,o)=>a[1]-o[1]||a[0]-o[0]);for(let a=0,o=t.length;a<o;a+=2){const c=t[a][2],h=t[a+1][2];c.push(h),h.push(c),i.add(c),i.add(h)}const s=[];let r;for(;i.size>0;){const a=i.values().next().value;let[o,c,h,d,f]=a;i.delete(a);let p=o,g=c;for(r=[o,h],s.push(r);;){let v;if(i.has(d))v=d;else if(i.has(f))v=f;else break;i.delete(v),[o,c,h,d,f]=v,p!==o&&(r.push(p,g,o,g===c?c:h),p=o),g=g===c?h:c}r.push(p,g)}return new TW(s,u(this,Hx),u(this,$x),u(this,qx))},Yv=function(e){const t=u(this,oa);let i=0,s=t.length-1;for(;i<=s;){const r=i+s>>1,a=t[r][0];if(a===e)return r;a<e?i=r+1:s=r-1}return s+1},KM=function([,e,t]){const i=R(this,rs,Yv).call(this,e);u(this,oa).splice(i,0,[e,t])},ZM=function([,e,t]){const i=R(this,rs,Yv).call(this,e);for(let s=i;s<u(this,oa).length;s++){const[r,a]=u(this,oa)[s];if(r!==e)break;if(r===e&&a===t){u(this,oa).splice(s,1);return}}for(let s=i-1;s>=0;s--){const[r,a]=u(this,oa)[s];if(r!==e)break;if(r===e&&a===t){u(this,oa).splice(s,1);return}}},yE=function(e){const[t,i,s]=e,r=[[t,i,s]],a=R(this,rs,Yv).call(this,s);for(let o=0;o<a;o++){const[c,h]=u(this,oa)[o];for(let d=0,f=r.length;d<f;d++){const[,p,g]=r[d];if(!(h<=p||g<=c)){if(p>=c){if(g>h)r[d][1]=h;else{if(f===1)return[];r.splice(d,1),d--,f--}continue}r[d][2]=c,g>h&&r.push([t,h,g])}}}return r};var Vx,_p;class TW extends Ye{constructor(t,i,s,r){super();D(this,Vx);D(this,_p);k(this,_p,t),k(this,Vx,i),this.firstPoint=s,this.lastPoint=r}toSVGPath(){const t=[];for(const i of u(this,_p)){let[s,r]=i;t.push(`M${s} ${r}`);for(let a=2;a<i.length;a+=2){const o=i[a],c=i[a+1];o===s?(t.push(`V${c}`),r=c):c===r&&(t.push(`H${o}`),s=o)}t.push("Z")}return t.join(" ")}serialize([t,i,s,r],a){const o=[],c=s-t,h=r-i;for(const d of u(this,_p)){const f=new Array(d.length);for(let p=0;p<d.length;p+=2)f[p]=t+d[p]*c,f[p+1]=r-d[p+1]*h;o.push(f)}return o}get box(){return u(this,Vx)}get classNamesForOutlining(){return["highlightOutline"]}}Vx=new WeakMap,_p=new WeakMap;class vE extends u1{newFreeDrawOutline(e,t,i,s,r,a){return new DW(e,t,i,s,r,a)}}class DW extends WM{newOutliner(e,t,i,s,r,a=0){return new vE(e,t,i,s,r,a)}}var kp,Gx,Jo,Ah,Wx,ys,Yx,Xx,Eh,Gs,Ws,Ni,Tp,Dp,Gi,jp,Tr,Kx,vt,bE,Xv,QM,JM,eO,wE,Su,Br,Fd,tO,Kv,Zv,nO,iO,sO,rO,aO;const Pt=class Pt extends dn{constructor(t){super({...t,name:"highlightEditor"});D(this,vt);D(this,kp,null);D(this,Gx,0);D(this,Jo);D(this,Ah,null);D(this,Wx,null);D(this,ys,null);D(this,Yx,null);D(this,Xx,0);D(this,Eh,null);D(this,Gs,null);D(this,Ws,null);D(this,Ni,!1);D(this,Tp,null);D(this,Dp,null);D(this,Gi,null);D(this,jp,"");D(this,Tr);D(this,Kx,"");this.color=t.color||Pt._defaultColor,k(this,Tr,t.thickness||Pt._defaultThickness),this.opacity=t.opacity||Pt._defaultOpacity,k(this,Jo,t.boxes||null),k(this,Kx,t.methodOfCreation||""),k(this,jp,t.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(k(this,Ni,!0),R(this,vt,Xv).call(this,t),R(this,vt,Su).call(this)):u(this,Jo)&&(k(this,kp,t.anchorNode),k(this,Gx,t.anchorOffset),k(this,Yx,t.focusNode),k(this,Xx,t.focusOffset),R(this,vt,bE).call(this),R(this,vt,Su).call(this),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}static get _keyboardManager(){const t=Pt.prototype;return ht(this,"_keyboardManager",new Ey([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:u(this,Ni)?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:u(this,Tr),methodOfCreation:u(this,Kx)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,i){var s;dn.initialize(t,i),Pt._defaultColor||(Pt._defaultColor=((s=i.highlightColors)==null?void 0:s.values().next().value)||"#fff066")}static updateDefaultParams(t,i){switch(t){case Tt.HIGHLIGHT_COLOR:Pt._defaultColor=i;break;case Tt.HIGHLIGHT_THICKNESS:Pt._defaultThickness=i;break}}translateInPage(t,i){}get toolbarPosition(){return u(this,Dp)}get commentButtonPosition(){return u(this,Tp)}updateParams(t,i){switch(t){case Tt.HIGHLIGHT_COLOR:R(this,vt,QM).call(this,i);break;case Tt.HIGHLIGHT_THICKNESS:R(this,vt,JM).call(this,i);break}}static get defaultPropertiesToUpdate(){return[[Tt.HIGHLIGHT_COLOR,Pt._defaultColor],[Tt.HIGHLIGHT_THICKNESS,Pt._defaultThickness]]}get propertiesToUpdate(){return[[Tt.HIGHLIGHT_COLOR,this.color||Pt._defaultColor],[Tt.HIGHLIGHT_THICKNESS,u(this,Tr)||Pt._defaultThickness],[Tt.HIGHLIGHT_FREE,u(this,Ni)]]}onUpdatedColor(){var t,i;(t=this.parent)==null||t.drawLayer.updateProperties(u(this,Ws),{root:{fill:this.color,"fill-opacity":this.opacity}}),(i=u(this,Wx))==null||i.updateColor(this.color),super.onUpdatedColor()}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",k(this,Wx,new o1({editor:this}))]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(R(this,vt,Zv).call(this))}getBaseTranslation(){return[0,0]}getRect(t,i){return super.getRect(t,i,R(this,vt,Zv).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){R(this,vt,wE).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(R(this,vt,Su).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var s;let i=!1;this.parent&&!t?R(this,vt,wE).call(this):t&&(R(this,vt,Su).call(this,t),i=!this.parent&&((s=this.div)==null?void 0:s.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),i&&this.select()}rotate(t){var r,a,o;const{drawLayer:i}=this.parent;let s;u(this,Ni)?(t=(t-this.rotation+360)%360,s=R(r=Pt,Br,Fd).call(r,u(this,Gs).box,t)):s=R(a=Pt,Br,Fd).call(a,[this.x,this.y,this.width,this.height],t),i.updateProperties(u(this,Ws),{bbox:s,root:{"data-main-rotation":t}}),i.updateProperties(u(this,Gi),{bbox:R(o=Pt,Br,Fd).call(o,u(this,ys).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();u(this,jp)&&(t.setAttribute("aria-label",u(this,jp)),t.setAttribute("role","mark")),u(this,Ni)?t.classList.add("free"):this.div.addEventListener("keydown",R(this,vt,tO).bind(this),{signal:this._uiManager._signal});const i=k(this,Eh,document.createElement("div"));return t.append(i),i.setAttribute("aria-hidden","true"),i.className="internal",i.style.clipPath=u(this,Ah),this.setDims(),pL(this,u(this,Eh),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(u(this,Gi),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(u(this,Gi),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:R(this,vt,Kv).call(this,!0);break;case 1:case 3:R(this,vt,Kv).call(this,!1);break}}select(){var t;super.select(),u(this,Gi)&&((t=this.parent)==null||t.drawLayer.updateProperties(u(this,Gi),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),u(this,Gi)&&((t=this.parent)==null||t.drawLayer.updateProperties(u(this,Gi),{rootClass:{selected:!1}}),u(this,Ni)||R(this,vt,Kv).call(this,!1))}get _mustFixPosition(){return!u(this,Ni)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(u(this,Ws),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(u(this,Gi),{rootClass:{hidden:!t}}))}static startHighlighting(t,i,{target:s,x:r,y:a}){const{x:o,y:c,width:h,height:d}=s.getBoundingClientRect(),f=new AbortController,p=t.combinedSignal(f),g=v=>{f.abort(),R(this,Br,rO).call(this,t,v)};window.addEventListener("blur",g,{signal:p}),window.addEventListener("pointerup",g,{signal:p}),window.addEventListener("pointerdown",On,{capture:!0,passive:!1,signal:p}),window.addEventListener("contextmenu",Vr,{signal:p}),s.addEventListener("pointermove",R(this,Br,sO).bind(this,t),{signal:p}),this._freeHighlight=new vE({x:r,y:a},[o,c,h,d],t.scale,this._defaultThickness/2,i,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,i,s){var b,x,m,y;let r=null;if(t instanceof MM){const{data:{quadPoints:w,rect:E,rotation:S,id:_,color:T,opacity:j,popupRef:M,richText:L,contentsObj:O,creationDate:B,modificationDate:G},parent:{page:{pageNumber:W}}}=t;r=t={annotationType:gt.HIGHLIGHT,color:Array.from(T),opacity:j,quadPoints:w,boxes:null,pageIndex:W-1,rect:E.slice(0),rotation:S,annotationElementId:_,id:_,deleted:!1,popupRef:M,richText:L,comment:(O==null?void 0:O.str)||null,creationDate:B,modificationDate:G}}else if(t instanceof _N){const{data:{inkLists:w,rect:E,rotation:S,id:_,color:T,borderStyle:{rawWidth:j},popupRef:M,richText:L,contentsObj:O,creationDate:B,modificationDate:G},parent:{page:{pageNumber:W}}}=t;r=t={annotationType:gt.HIGHLIGHT,color:Array.from(T),thickness:j,inkLists:w,boxes:null,pageIndex:W-1,rect:E.slice(0),rotation:S,annotationElementId:_,id:_,deleted:!1,popupRef:M,richText:L,comment:(O==null?void 0:O.str)||null,creationDate:B,modificationDate:G}}const{color:a,quadPoints:o,inkLists:c,opacity:h}=t,d=await super.deserialize(t,i,s);d.color=$e.makeHexColor(...a),d.opacity=h||1,c&&k(d,Tr,t.thickness),d._initialData=r,t.comment&&d.setCommentData(t);const[f,p]=d.pageDimensions,[g,v]=d.pageTranslation;if(o){const w=k(d,Jo,[]);for(let E=0;E<o.length;E+=8)w.push({x:(o[E]-g)/f,y:1-(o[E+1]-v)/p,width:(o[E+2]-o[E])/f,height:(o[E+1]-o[E+5])/p});R(b=d,vt,bE).call(b),R(x=d,vt,Su).call(x),d.rotate(d.rotation)}else if(c){k(d,Ni,!0);const w=c[0],E={x:w[0]-g,y:p-(w[1]-v)},S=new vE(E,[0,0,f,p],1,u(d,Tr)/2,!0,.001);for(let j=0,M=w.length;j<M;j+=2)E.x=w[j]-g,E.y=p-(w[j+1]-v),S.add(E);const{id:_,clipPathId:T}=i.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:d.color,"fill-opacity":d._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:S.toSVGPath()}},!0,!0);R(m=d,vt,Xv).call(m,{highlightOutlines:S.getOutlines(),highlightId:_,clipPathId:T}),R(y=d,vt,Su).call(y),d.rotate(d.parentRotation)}return d}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const i=dn._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),s=super.serialize(t);return Object.assign(s,{color:i,opacity:this.opacity,thickness:u(this,Tr),quadPoints:R(this,vt,nO).call(this),outlines:R(this,vt,iO).call(this,s.rect)}),this.addComment(s),this.annotationElementId&&!R(this,vt,aO).call(this,s)?null:(s.id=this.annotationElementId,s)}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}};kp=new WeakMap,Gx=new WeakMap,Jo=new WeakMap,Ah=new WeakMap,Wx=new WeakMap,ys=new WeakMap,Yx=new WeakMap,Xx=new WeakMap,Eh=new WeakMap,Gs=new WeakMap,Ws=new WeakMap,Ni=new WeakMap,Tp=new WeakMap,Dp=new WeakMap,Gi=new WeakMap,jp=new WeakMap,Tr=new WeakMap,Kx=new WeakMap,vt=new WeakSet,bE=function(){const t=new xE(u(this,Jo),.001);k(this,Gs,t.getOutlines()),[this.x,this.y,this.width,this.height]=u(this,Gs).box;const i=new xE(u(this,Jo),.0025,.001,this._uiManager.direction==="ltr");k(this,ys,i.getOutlines());const{firstPoint:s}=u(this,Gs);k(this,Tp,[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height]);const{lastPoint:r}=u(this,ys);k(this,Dp,[(r[0]-this.x)/this.width,(r[1]-this.y)/this.height])},Xv=function({highlightOutlines:t,highlightId:i,clipPathId:s}){var p,g;if(k(this,Gs,t),k(this,ys,t.getNewOutline(u(this,Tr)/2+1.5,.0025)),i>=0)k(this,Ws,i),k(this,Ah,s),this.parent.drawLayer.finalizeDraw(i,{bbox:t.box,path:{d:t.toSVGPath()}}),k(this,Gi,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:u(this,ys).box,path:{d:u(this,ys).toSVGPath()}},!0));else if(this.parent){const v=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(u(this,Ws),{bbox:R(p=Pt,Br,Fd).call(p,u(this,Gs).box,(v-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(u(this,Gi),{bbox:R(g=Pt,Br,Fd).call(g,u(this,ys).box,v),path:{d:u(this,ys).toSVGPath()}})}const[a,o,c,h]=t.box;switch(this.rotation){case 0:this.x=a,this.y=o,this.width=c,this.height=h;break;case 90:{const[v,b]=this.parentDimensions;this.x=o,this.y=1-a,this.width=c*b/v,this.height=h*v/b;break}case 180:this.x=1-a,this.y=1-o,this.width=c,this.height=h;break;case 270:{const[v,b]=this.parentDimensions;this.x=1-o,this.y=a,this.width=c*b/v,this.height=h*v/b;break}}const{firstPoint:d}=t;k(this,Tp,[(d[0]-a)/c,(d[1]-o)/h]);const{lastPoint:f}=u(this,ys);k(this,Dp,[(f[0]-a)/c,(f[1]-o)/h])},QM=function(t){const i=(a,o)=>{this.color=a,this.opacity=o,this.onUpdatedColor()},s=this.color,r=this.opacity;this.addCommands({cmd:i.bind(this,t,Pt._defaultOpacity),undo:i.bind(this,s,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Tt.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)},JM=function(t){const i=u(this,Tr),s=r=>{k(this,Tr,r),R(this,vt,eO).call(this,r)};this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Tt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},eO=function(t){u(this,Ni)&&(R(this,vt,Xv).call(this,{highlightOutlines:u(this,Gs).getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims())},wE=function(){u(this,Ws)===null||!this.parent||(this.parent.drawLayer.remove(u(this,Ws)),k(this,Ws,null),this.parent.drawLayer.remove(u(this,Gi)),k(this,Gi,null))},Su=function(t=this.parent){u(this,Ws)===null&&({id:ni(this,Ws)._,clipPathId:ni(this,Ah)._}=t.drawLayer.draw({bbox:u(this,Gs).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:u(this,Ni)},path:{d:u(this,Gs).toSVGPath()}},!1,!0),k(this,Gi,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:u(this,Ni)},bbox:u(this,ys).box,path:{d:u(this,ys).toSVGPath()}},u(this,Ni))),u(this,Eh)&&(u(this,Eh).style.clipPath=u(this,Ah)))},Br=new WeakSet,Fd=function([t,i,s,r],a){switch(a){case 90:return[1-i-r,t,r,s];case 180:return[1-t-s,1-i-r,s,r];case 270:return[i,1-t-s,r,s]}return[t,i,s,r]},tO=function(t){Pt._keyboardManager.exec(this,t)},Kv=function(t){if(!u(this,kp))return;const i=window.getSelection();t?i.setPosition(u(this,kp),u(this,Gx)):i.setPosition(u(this,Yx),u(this,Xx))},Zv=function(){return u(this,Ni)?this.rotation:0},nO=function(){if(u(this,Ni))return null;const[t,i]=this.pageDimensions,[s,r]=this.pageTranslation,a=u(this,Jo),o=new Float32Array(a.length*8);let c=0;for(const{x:h,y:d,width:f,height:p}of a){const g=h*t+s,v=(1-d)*i+r;o[c]=o[c+4]=g,o[c+1]=o[c+3]=v,o[c+2]=o[c+6]=g+f*t,o[c+5]=o[c+7]=v-p*i,c+=8}return o},iO=function(t){return u(this,Gs).serialize(t,R(this,vt,Zv).call(this))},sO=function(t,i){this._freeHighlight.add(i)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},rO=function(t,i){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(i,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},aO=function(t){const{color:i}=this._initialData;return this.hasEditedComment||t.color.some((s,r)=>s!==i[r])},D(Pt,Br),we(Pt,"_defaultColor",null),we(Pt,"_defaultOpacity",1),we(Pt,"_defaultThickness",12),we(Pt,"_type","highlight"),we(Pt,"_editorType",gt.HIGHLIGHT),we(Pt,"_freeHighlightId",-1),we(Pt,"_freeHighlight",null),we(Pt,"_freeHighlightClipId","");let h1=Pt;var Ch;class oO{constructor(){D(this,Ch,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,i]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,i)}updateSVGProperty(e,t){u(this,Ch)[e]=t}toSVGProperties(){const e=u(this,Ch);return k(this,Ch,Object.create(null)),{root:e}}reset(){k(this,Ch,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){zt("Not implemented")}}Ch=new WeakMap;var Ys,Rp,fi,Nh,_h,Mt,SE,AE,EE,hm,lO,Qv,dm,Ud;const Nt=class Nt extends dn{constructor(t){super(t);D(this,Mt);D(this,Ys,null);D(this,Rp);we(this,"_colorPicker",null);we(this,"_drawId",null);k(this,Rp,t.mustBeCommitted||!1),this._addOutlines(t)}onUpdatedColor(){var t;(t=this._colorPicker)==null||t.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(R(this,Mt,SE).call(this,t),R(this,Mt,hm).call(this))}static _mergeSVGProperties(t,i){const s=new Set(Object.keys(t));for(const[r,a]of Object.entries(i))s.has(r)?Object.assign(t[r],a):t[r]=a;return t}static getDefaultDrawingOptions(t){zt("Not implemented")}static get typesMap(){zt("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,i){const s=this.typesMap.get(t);s&&this._defaultDrawingOptions.updateProperty(s,i),this._currentParent&&(u(Nt,fi).updateProperty(s,i),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,i){const s=this.constructor.typesMap.get(t);s&&this._updateProperty(t,s,i)}static get defaultPropertiesToUpdate(){const t=[],i=this._defaultDrawingOptions;for(const[s,r]of this.typesMap)t.push([s,i[r]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:i}=this;for(const[s,r]of this.constructor.typesMap)t.push([s,i[r]]);return t}_updateProperty(t,i,s){const r=this._drawingOptions,a=r[i],o=c=>{var d;r.updateProperty(i,c);const h=u(this,Ys).updateProperty(i,c);h&&R(this,Mt,dm).call(this,h),(d=this.parent)==null||d.drawLayer.updateProperties(this._drawId,r.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:o.bind(this,s),undo:o.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Nt._mergeSVGProperties(u(this,Ys).getPathResizingSVGProperties(R(this,Mt,Qv).call(this)),{bbox:R(this,Mt,Ud).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Nt._mergeSVGProperties(u(this,Ys).getPathResizedSVGProperties(R(this,Mt,Qv).call(this)),{bbox:R(this,Mt,Ud).call(this)}))}_onTranslating(t,i){var s;(s=this.parent)==null||s.drawLayer.updateProperties(this._drawId,{bbox:R(this,Mt,Ud).call(this)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Nt._mergeSVGProperties(u(this,Ys).getPathTranslatedSVGProperties(R(this,Mt,Qv).call(this),this.parentDimensions),{bbox:R(this,Mt,Ud).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,u(this,Rp)&&(k(this,Rp,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){R(this,Mt,EE).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(R(this,Mt,hm).call(this),R(this,Mt,dm).call(this,u(this,Ys).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var s;let i=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),R(this,Mt,EE).call(this)):t&&(this._uiManager.addShouldRescale(this),R(this,Mt,hm).call(this,t),i=!this.parent&&((s=this.div)==null?void 0:s.classList.contains("selectedEditor"))),super.setParent(t),i&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Nt._mergeSVGProperties({bbox:R(this,Mt,Ud).call(this)},u(this,Ys).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&R(this,Mt,dm).call(this,u(this,Ys).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,i;this._isCopy&&(t=this.x,i=this.y);const s=super.render();s.classList.add("draw");const r=document.createElement("div");return s.append(r),r.setAttribute("aria-hidden","true"),r.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,i),s}static createDrawerInstance(t,i,s,r,a){zt("Not implemented")}static startDrawing(t,i,s,r){var x;const{target:a,offsetX:o,offsetY:c,pointerId:h,pointerType:d}=r;if(Ui.isInitializedAndDifferentPointerType(d))return;const{viewport:{rotation:f}}=t,{width:p,height:g}=a.getBoundingClientRect(),v=k(Nt,Nh,new AbortController),b=t.combinedSignal(v);if(Ui.setPointer(d,h),window.addEventListener("pointerup",m=>{Ui.isSamePointerIdOrRemove(m.pointerId)&&this._endDraw(m)},{signal:b}),window.addEventListener("pointercancel",m=>{Ui.isSamePointerIdOrRemove(m.pointerId)&&this._currentParent.endDrawingSession()},{signal:b}),window.addEventListener("pointerdown",m=>{Ui.isSamePointerType(m.pointerType)&&(Ui.initializeAndAddPointerId(m.pointerId),u(Nt,fi).isCancellable()&&(u(Nt,fi).removeLastElement(),u(Nt,fi).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:b}),window.addEventListener("contextmenu",Vr,{signal:b}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:b}),a.addEventListener("touchmove",m=>{Ui.isSameTimeStamp(m.timeStamp)&&On(m)},{signal:b}),t.toggleDrawing(),(x=i._editorUndoBar)==null||x.hide(),u(Nt,fi)){t.drawLayer.updateProperties(this._currentDrawId,u(Nt,fi).startNew(o,c,p,g,f));return}i.updateUIForDefaultProperties(this),k(Nt,fi,this.createDrawerInstance(o,c,p,g,f)),k(Nt,_h,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(u(Nt,_h).toSVGProperties(),u(Nt,fi).defaultSVGProperties),!0,!1)}static _drawMove(t){if(Ui.isSameTimeStamp(t.timeStamp),!u(Nt,fi))return;const{offsetX:i,offsetY:s,pointerId:r}=t;if(Ui.isSamePointerId(r)){if(Ui.isUsingMultiplePointers()){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,u(Nt,fi).add(i,s)),Ui.setTimeStamp(t.timeStamp),On(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,k(Nt,fi,null),k(Nt,_h,null),Ui.clearTimeStamp()),u(Nt,Nh)&&(u(Nt,Nh).abort(),k(Nt,Nh,null),Ui.clearPointerIds())}static _endDraw(t){const i=this._currentParent;if(i){if(i.toggleDrawing(!0),this._cleanup(!1),(t==null?void 0:t.target)===i.div&&i.drawLayer.updateProperties(this._currentDrawId,u(Nt,fi).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const s=u(Nt,fi),r=this._currentDrawId,a=s.getLastElement();i.addCommands({cmd:()=>{i.drawLayer.updateProperties(r,s.setLastElement(a))},undo:()=>{i.drawLayer.updateProperties(r,s.removeLastElement())},mustExec:!1,type:Tt.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const i=this._currentParent;if(!i)return null;if(i.toggleDrawing(!0),i.cleanUndoStack(Tt.DRAW_STEP),!u(Nt,fi).isEmpty()){const{pageDimensions:[s,r],scale:a}=i,o=i.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:u(Nt,fi).getOutlines(s*a,r*a,a,this._INNER_MARGIN),drawingOptions:u(Nt,_h),mustBeCommitted:!t});return this._cleanup(!0),o}return i.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,i,s,r,a,o){zt("Not implemented")}static async deserialize(t,i,s){var f,p;const{rawDims:{pageWidth:r,pageHeight:a,pageX:o,pageY:c}}=i.viewport,h=this.deserializeDraw(o,c,r,a,this._INNER_MARGIN,t),d=await super.deserialize(t,i,s);return d.createDrawingOptions(t),R(f=d,Mt,SE).call(f,{drawOutlines:h}),R(p=d,Mt,hm).call(p),d.onScaleChanging(),d.rotate(),d}serializeDraw(t){const[i,s]=this.pageTranslation,[r,a]=this.pageDimensions;return u(this,Ys).serialize([i,s,r,a],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}};Ys=new WeakMap,Rp=new WeakMap,fi=new WeakMap,Nh=new WeakMap,_h=new WeakMap,Mt=new WeakSet,SE=function({drawOutlines:t,drawId:i,drawingOptions:s}){k(this,Ys,t),this._drawingOptions||(this._drawingOptions=s),this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),i>=0?(this._drawId=i,this.parent.drawLayer.finalizeDraw(i,t.defaultProperties)):this._drawId=R(this,Mt,AE).call(this,t,this.parent),R(this,Mt,dm).call(this,t.box)},AE=function(t,i){const{id:s}=i.drawLayer.draw(Nt._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return s},EE=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},hm=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=R(this,Mt,AE).call(this,u(this,Ys),t)}},lO=function([t,i,s,r]){const{parentDimensions:[a,o],rotation:c}=this;switch(c){case 90:return[i,1-t,s*(o/a),r*(a/o)];case 180:return[1-t,1-i,s,r];case 270:return[1-i,t,s*(o/a),r*(a/o)];default:return[t,i,s,r]}},Qv=function(){const{x:t,y:i,width:s,height:r,parentDimensions:[a,o],rotation:c}=this;switch(c){case 90:return[1-i,t,s*(a/o),r*(o/a)];case 180:return[1-t,1-i,s,r];case 270:return[i,1-t,s*(a/o),r*(o/a)];default:return[t,i,s,r]}},dm=function(t){[this.x,this.y,this.width,this.height]=R(this,Mt,lO).call(this,t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()},Ud=function(){const{x:t,y:i,width:s,height:r,rotation:a,parentRotation:o,parentDimensions:[c,h]}=this;switch((a*4+o)/90){case 1:return[1-i-r,t,r,s];case 2:return[1-t-s,1-i-r,s,r];case 3:return[i,1-t-s,r,s];case 4:return[t,i-s*(c/h),r*(h/c),s*(c/h)];case 5:return[1-i,t,s*(c/h),r*(h/c)];case 6:return[1-t-r*(h/c),1-i,r*(h/c),s*(c/h)];case 7:return[i-s*(c/h),1-t-r*(h/c),s*(c/h),r*(h/c)];case 8:return[t-s,i-r,s,r];case 9:return[1-i,t-s,r,s];case 10:return[1-t,1-i,s,r];case 11:return[i-r,1-t,r,s];case 12:return[t-r*(h/c),i,r*(h/c),s*(c/h)];case 13:return[1-i-s*(c/h),t-r*(h/c),s*(c/h),r*(h/c)];case 14:return[1-t,1-i-s*(c/h),r*(h/c),s*(c/h)];case 15:return[i,1-t,s*(c/h),r*(h/c)];default:return[t,i,s,r]}},we(Nt,"_currentDrawId",-1),we(Nt,"_currentParent",null),D(Nt,fi,null),D(Nt,Nh,null),D(Nt,_h,null),we(Nt,"_INNER_MARGIN",3);let d1=Nt;var Va,pi,gi,kh,Lp,Qi,_i,Dr,Th,Dh,jh,Mp,Jv;class jW{constructor(e,t,i,s,r,a){D(this,Mp);D(this,Va,new Float64Array(6));D(this,pi);D(this,gi);D(this,kh);D(this,Lp);D(this,Qi);D(this,_i,"");D(this,Dr,0);D(this,Th,new Cy);D(this,Dh);D(this,jh);k(this,Dh,i),k(this,jh,s),k(this,kh,r),k(this,Lp,a),[e,t]=R(this,Mp,Jv).call(this,e,t);const o=k(this,pi,[NaN,NaN,NaN,NaN,e,t]);k(this,Qi,[e,t]),k(this,gi,[{line:o,points:u(this,Qi)}]),u(this,Va).set(o,0)}updateProperty(e,t){e==="stroke-width"&&k(this,Lp,t)}isEmpty(){return!u(this,gi)||u(this,gi).length===0}isCancellable(){return u(this,Qi).length<=10}add(e,t){[e,t]=R(this,Mp,Jv).call(this,e,t);const[i,s,r,a]=u(this,Va).subarray(2,6),o=e-r,c=t-a;return Math.hypot(u(this,Dh)*o,u(this,jh)*c)<=2?null:(u(this,Qi).push(e,t),isNaN(i)?(u(this,Va).set([r,a,e,t],2),u(this,pi).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(u(this,Va)[0])&&u(this,pi).splice(6,6),u(this,Va).set([i,s,r,a,e,t],0),u(this,pi).push(...Ye.createBezierPoints(i,s,r,a,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const i=this.add(e,t);return i||(u(this,Qi).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,i,s,r){k(this,Dh,i),k(this,jh,s),k(this,kh,r),[e,t]=R(this,Mp,Jv).call(this,e,t);const a=k(this,pi,[NaN,NaN,NaN,NaN,e,t]);k(this,Qi,[e,t]);const o=u(this,gi).at(-1);return o&&(o.line=new Float32Array(o.line),o.points=new Float32Array(o.points)),u(this,gi).push({line:a,points:u(this,Qi)}),u(this,Va).set(a,0),k(this,Dr,0),this.toSVGPath(),null}getLastElement(){return u(this,gi).at(-1)}setLastElement(e){return u(this,gi)?(u(this,gi).push(e),k(this,pi,e.line),k(this,Qi,e.points),k(this,Dr,0),{path:{d:this.toSVGPath()}}):u(this,Th).setLastElement(e)}removeLastElement(){if(!u(this,gi))return u(this,Th).removeLastElement();u(this,gi).pop(),k(this,_i,"");for(let e=0,t=u(this,gi).length;e<t;e++){const{line:i,points:s}=u(this,gi)[e];k(this,pi,i),k(this,Qi,s),k(this,Dr,0),this.toSVGPath()}return{path:{d:u(this,_i)}}}toSVGPath(){const e=Ye.svgRound(u(this,pi)[4]),t=Ye.svgRound(u(this,pi)[5]);if(u(this,Qi).length===2)return k(this,_i,`${u(this,_i)} M ${e} ${t} Z`),u(this,_i);if(u(this,Qi).length<=6){const s=u(this,_i).lastIndexOf("M");k(this,_i,`${u(this,_i).slice(0,s)} M ${e} ${t}`),k(this,Dr,6)}if(u(this,Qi).length===4){const s=Ye.svgRound(u(this,pi)[10]),r=Ye.svgRound(u(this,pi)[11]);return k(this,_i,`${u(this,_i)} L ${s} ${r}`),k(this,Dr,12),u(this,_i)}const i=[];u(this,Dr)===0&&(i.push(`M ${e} ${t}`),k(this,Dr,6));for(let s=u(this,Dr),r=u(this,pi).length;s<r;s+=6){const[a,o,c,h,d,f]=u(this,pi).slice(s,s+6).map(Ye.svgRound);i.push(`C${a} ${o} ${c} ${h} ${d} ${f}`)}return k(this,_i,u(this,_i)+i.join(" ")),k(this,Dr,u(this,pi).length),u(this,_i)}getOutlines(e,t,i,s){const r=u(this,gi).at(-1);return r.line=new Float32Array(r.line),r.points=new Float32Array(r.points),u(this,Th).build(u(this,gi),e,t,i,u(this,kh),u(this,Lp),s),k(this,Va,null),k(this,pi,null),k(this,gi,null),k(this,_i,null),u(this,Th)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}Va=new WeakMap,pi=new WeakMap,gi=new WeakMap,kh=new WeakMap,Lp=new WeakMap,Qi=new WeakMap,_i=new WeakMap,Dr=new WeakMap,Th=new WeakMap,Dh=new WeakMap,jh=new WeakMap,Mp=new WeakSet,Jv=function(e,t){return Ye._normalizePoint(e,t,u(this,Dh),u(this,jh),u(this,kh))};var Ji,Zx,Qx,Xs,Ga,Wa,Op,Pp,Rh,ji,vo,cO,uO,hO;class Cy extends Ye{constructor(){super(...arguments);D(this,ji);D(this,Ji);D(this,Zx,0);D(this,Qx);D(this,Xs);D(this,Ga);D(this,Wa);D(this,Op);D(this,Pp);D(this,Rh)}build(t,i,s,r,a,o,c){k(this,Ga,i),k(this,Wa,s),k(this,Op,r),k(this,Pp,a),k(this,Rh,o),k(this,Qx,c??0),k(this,Xs,t),R(this,ji,uO).call(this)}get thickness(){return u(this,Rh)}setLastElement(t){return u(this,Xs).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return u(this,Xs).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:i}of u(this,Xs)){if(t.push(`M${Ye.svgRound(i[4])} ${Ye.svgRound(i[5])}`),i.length===6){t.push("Z");continue}if(i.length===12&&isNaN(i[6])){t.push(`L${Ye.svgRound(i[10])} ${Ye.svgRound(i[11])}`);continue}for(let s=6,r=i.length;s<r;s+=6){const[a,o,c,h,d,f]=i.subarray(s,s+6).map(Ye.svgRound);t.push(`C${a} ${o} ${c} ${h} ${d} ${f}`)}}return t.join("")}serialize([t,i,s,r],a){const o=[],c=[],[h,d,f,p]=R(this,ji,cO).call(this);let g,v,b,x,m,y,w,E,S;switch(u(this,Pp)){case 0:S=Ye._rescale,g=t,v=i+r,b=s,x=-r,m=t+h*s,y=i+(1-d-p)*r,w=t+(h+f)*s,E=i+(1-d)*r;break;case 90:S=Ye._rescaleAndSwap,g=t,v=i,b=s,x=r,m=t+d*s,y=i+h*r,w=t+(d+p)*s,E=i+(h+f)*r;break;case 180:S=Ye._rescale,g=t+s,v=i,b=-s,x=r,m=t+(1-h-f)*s,y=i+d*r,w=t+(1-h)*s,E=i+(d+p)*r;break;case 270:S=Ye._rescaleAndSwap,g=t+s,v=i+r,b=-s,x=-r,m=t+(1-d-p)*s,y=i+(1-h-f)*r,w=t+(1-d)*s,E=i+(1-h)*r;break}for(const{line:_,points:T}of u(this,Xs))o.push(S(_,g,v,b,x,a?new Array(_.length):null)),c.push(S(T,g,v,b,x,a?new Array(T.length):null));return{lines:o,points:c,rect:[m,y,w,E]}}static deserialize(t,i,s,r,a,{paths:{lines:o,points:c},rotation:h,thickness:d}){const f=[];let p,g,v,b,x;switch(h){case 0:x=Ye._rescale,p=-t/s,g=i/r+1,v=1/s,b=-1/r;break;case 90:x=Ye._rescaleAndSwap,p=-i/r,g=-t/s,v=1/r,b=1/s;break;case 180:x=Ye._rescale,p=t/s+1,g=-i/r,v=-1/s,b=1/r;break;case 270:x=Ye._rescaleAndSwap,p=i/r+1,g=t/s+1,v=-1/r,b=-1/s;break}if(!o){o=[];for(const y of c){const w=y.length;if(w===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,y[0],y[1]]));continue}if(w===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,y[0],y[1],NaN,NaN,NaN,NaN,y[2],y[3]]));continue}const E=new Float32Array(3*(w-2));o.push(E);let[S,_,T,j]=y.subarray(0,4);E.set([NaN,NaN,NaN,NaN,S,_],0);for(let M=4;M<w;M+=2){const L=y[M],O=y[M+1];E.set(Ye.createBezierPoints(S,_,T,j,L,O),(M-2)*3),[S,_,T,j]=[T,j,L,O]}}}for(let y=0,w=o.length;y<w;y++)f.push({line:x(o[y].map(E=>E??NaN),p,g,v,b),points:x(c[y].map(E=>E??NaN),p,g,v,b)});const m=new this.prototype.constructor;return m.build(f,s,r,1,h,d,a),m}get box(){return u(this,Ji)}updateProperty(t,i){return t==="stroke-width"?R(this,ji,hO).call(this,i):null}updateParentDimensions([t,i],s){const[r,a]=R(this,ji,vo).call(this);k(this,Ga,t),k(this,Wa,i),k(this,Op,s);const[o,c]=R(this,ji,vo).call(this),h=o-r,d=c-a,f=u(this,Ji);return f[0]-=h,f[1]-=d,f[2]+=2*h,f[3]+=2*d,f}updateRotation(t){return k(this,Zx,t),{path:{transform:this.rotationTransform}}}get viewBox(){return u(this,Ji).map(Ye.svgRound).join(" ")}get defaultProperties(){const[t,i]=u(this,Ji);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Ye.svgRound(t)} ${Ye.svgRound(i)}`}}}get rotationTransform(){const[,,t,i]=u(this,Ji);let s=0,r=0,a=0,o=0,c=0,h=0;switch(u(this,Zx)){case 90:r=i/t,a=-t/i,c=t;break;case 180:s=-1,o=-1,c=t,h=i;break;case 270:r=-i/t,a=t/i,h=i;break;default:return""}return`matrix(${s} ${r} ${a} ${o} ${Ye.svgRound(c)} ${Ye.svgRound(h)})`}getPathResizingSVGProperties([t,i,s,r]){const[a,o]=R(this,ji,vo).call(this),[c,h,d,f]=u(this,Ji);if(Math.abs(d-a)<=Ye.PRECISION||Math.abs(f-o)<=Ye.PRECISION){const x=t+s/2-(c+d/2),m=i+r/2-(h+f/2);return{path:{"transform-origin":`${Ye.svgRound(t)} ${Ye.svgRound(i)}`,transform:`${this.rotationTransform} translate(${x} ${m})`}}}const p=(s-2*a)/(d-2*a),g=(r-2*o)/(f-2*o),v=d/s,b=f/r;return{path:{"transform-origin":`${Ye.svgRound(c)} ${Ye.svgRound(h)}`,transform:`${this.rotationTransform} scale(${v} ${b}) translate(${Ye.svgRound(a)} ${Ye.svgRound(o)}) scale(${p} ${g}) translate(${Ye.svgRound(-a)} ${Ye.svgRound(-o)})`}}}getPathResizedSVGProperties([t,i,s,r]){const[a,o]=R(this,ji,vo).call(this),c=u(this,Ji),[h,d,f,p]=c;if(c[0]=t,c[1]=i,c[2]=s,c[3]=r,Math.abs(f-a)<=Ye.PRECISION||Math.abs(p-o)<=Ye.PRECISION){const m=t+s/2-(h+f/2),y=i+r/2-(d+p/2);for(const{line:w,points:E}of u(this,Xs))Ye._translate(w,m,y,w),Ye._translate(E,m,y,E);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Ye.svgRound(t)} ${Ye.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const g=(s-2*a)/(f-2*a),v=(r-2*o)/(p-2*o),b=-g*(h+a)+t+a,x=-v*(d+o)+i+o;if(g!==1||v!==1||b!==0||x!==0)for(const{line:m,points:y}of u(this,Xs))Ye._rescale(m,b,x,g,v,m),Ye._rescale(y,b,x,g,v,y);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Ye.svgRound(t)} ${Ye.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,i],s){const[r,a]=s,o=u(this,Ji),c=t-o[0],h=i-o[1];if(u(this,Ga)===r&&u(this,Wa)===a)for(const{line:d,points:f}of u(this,Xs))Ye._translate(d,c,h,d),Ye._translate(f,c,h,f);else{const d=u(this,Ga)/r,f=u(this,Wa)/a;k(this,Ga,r),k(this,Wa,a);for(const{line:p,points:g}of u(this,Xs))Ye._rescale(p,c,h,d,f,p),Ye._rescale(g,c,h,d,f,g);o[2]*=d,o[3]*=f}return o[0]=t,o[1]=i,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${Ye.svgRound(t)} ${Ye.svgRound(i)}`}}}get defaultSVGProperties(){const t=u(this,Ji);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${Ye.svgRound(t[0])} ${Ye.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}Ji=new WeakMap,Zx=new WeakMap,Qx=new WeakMap,Xs=new WeakMap,Ga=new WeakMap,Wa=new WeakMap,Op=new WeakMap,Pp=new WeakMap,Rh=new WeakMap,ji=new WeakSet,vo=function(t=u(this,Rh)){const i=u(this,Qx)+t/2*u(this,Op);return u(this,Pp)%180===0?[i/u(this,Ga),i/u(this,Wa)]:[i/u(this,Wa),i/u(this,Ga)]},cO=function(){const[t,i,s,r]=u(this,Ji),[a,o]=R(this,ji,vo).call(this,0);return[t+a,i+o,s-2*a,r-2*o]},uO=function(){const t=k(this,Ji,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:r}of u(this,Xs)){if(r.length<=12){for(let c=4,h=r.length;c<h;c+=6)$e.pointBoundingBox(r[c],r[c+1],t);continue}let a=r[4],o=r[5];for(let c=6,h=r.length;c<h;c+=6){const[d,f,p,g,v,b]=r.subarray(c,c+6);$e.bezierBoundingBox(a,o,d,f,p,g,v,b,t),a=v,o=b}}const[i,s]=R(this,ji,vo).call(this);t[0]=Ti(t[0]-i,0,1),t[1]=Ti(t[1]-s,0,1),t[2]=Ti(t[2]+i,0,1),t[3]=Ti(t[3]+s,0,1),t[2]-=t[0],t[3]-=t[1]},hO=function(t){const[i,s]=R(this,ji,vo).call(this);k(this,Rh,t);const[r,a]=R(this,ji,vo).call(this),[o,c]=[r-i,a-s],h=u(this,Ji);return h[0]-=o,h[1]-=c,h[2]+=2*o,h[3]+=2*c,h};class Nw extends oO{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:dn._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??(t=this["stroke-width"]),t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new Nw(this._viewParameters);return e.updateAll(this),e}}var D1,dO;const of=class of extends d1{constructor(t){super({...t,name:"inkEditor"});D(this,D1);this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,i){dn.initialize(t,i),this._defaultDrawingOptions=new Nw(i.viewParameters)}static getDefaultDrawingOptions(t){const i=this._defaultDrawingOptions.clone();return i.updateProperties(t),i}static get supportMultipleDrawings(){return!0}static get typesMap(){return ht(this,"typesMap",new Map([[Tt.INK_THICKNESS,"stroke-width"],[Tt.INK_COLOR,"stroke"],[Tt.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,i,s,r,a){return new jW(t,i,s,r,a,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,i,s,r,a,o){return Cy.deserialize(t,i,s,r,a,o)}static async deserialize(t,i,s){let r=null;if(t instanceof _N){const{data:{inkLists:o,rect:c,rotation:h,id:d,color:f,opacity:p,borderStyle:{rawWidth:g},popupRef:v,richText:b,contentsObj:x,creationDate:m,modificationDate:y},parent:{page:{pageNumber:w}}}=t;r=t={annotationType:gt.INK,color:Array.from(f),thickness:g,opacity:p,paths:{points:o},boxes:null,pageIndex:w-1,rect:c.slice(0),rotation:h,annotationElementId:d,id:d,deleted:!1,popupRef:v,richText:b,comment:(x==null?void 0:x.str)||null,creationDate:m,modificationDate:y}}const a=await super.deserialize(t,i,s);return a._initialData=r,t.comment&&a.setCommentData(t),a}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new l1(this)),[["colorPicker",this._colorPicker]]}get colorType(){return Tt.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:i,parent:s}=this;i.updateSVGProperty("stroke-width"),s.drawLayer.updateProperties(t,i.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:i,opacity:s}){this._drawingOptions=of.getDefaultDrawingOptions({stroke:$e.makeHexColor(...t),"stroke-width":i,"stroke-opacity":s})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:i,points:s}=this.serializeDraw(t),{_drawingOptions:{stroke:r,"stroke-opacity":a,"stroke-width":o}}=this,c=Object.assign(super.serialize(t),{color:dn._colorManager.convert(r),opacity:a,thickness:o,paths:{lines:i,points:s}});return this.addComment(c),t?(c.isCopy=!0,c):this.annotationElementId&&!R(this,D1,dO).call(this,c)?null:(c.id=this.annotationElementId,c)}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:i,rect:s}=this.serializeDraw(!1);return t.updateEdited({rect:s,thickness:this._drawingOptions["stroke-width"],points:i,popup:this.comment}),null}};D1=new WeakSet,dO=function(t){const{color:i,thickness:s,opacity:r,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((o,c)=>o!==i[c])||t.thickness!==s||t.opacity!==r||t.pageIndex!==a},we(of,"_type","ink"),we(of,"_editorType",gt.INK),we(of,"_defaultDrawingOptions",null);let CE=of;class NE extends Cy{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const rv=8,Hg=3;var Lh,Ht,_E,la,fO,pO,kE,eb,gO,mO,xO,TE,DE,yO;class al{static extractContoursFromText(e,{fontFamily:t,fontStyle:i,fontWeight:s},r,a,o,c){let h=new OffscreenCanvas(1,1),d=h.getContext("2d",{alpha:!1});const f=200,p=d.font=`${i} ${s} ${f}px ${t}`,{actualBoundingBoxLeft:g,actualBoundingBoxRight:v,actualBoundingBoxAscent:b,actualBoundingBoxDescent:x,fontBoundingBoxAscent:m,fontBoundingBoxDescent:y,width:w}=d.measureText(e),E=1.5,S=Math.ceil(Math.max(Math.abs(g)+Math.abs(v)||0,w)*E),_=Math.ceil(Math.max(Math.abs(b)+Math.abs(x)||f,Math.abs(m)+Math.abs(y)||f)*E);h=new OffscreenCanvas(S,_),d=h.getContext("2d",{alpha:!0,willReadFrequently:!0}),d.font=p,d.filter="grayscale(1)",d.fillStyle="white",d.fillRect(0,0,S,_),d.fillStyle="black",d.fillText(e,S*(E-1)/2,_*(3-E)/2);const T=R(this,Ht,TE).call(this,d.getImageData(0,0,S,_).data),j=R(this,Ht,xO).call(this,T),M=R(this,Ht,DE).call(this,j),L=R(this,Ht,kE).call(this,T,S,_,M);return this.processDrawnLines({lines:{curves:L,width:S,height:_},pageWidth:r,pageHeight:a,rotation:o,innerMargin:c,mustSmooth:!0,areContours:!0})}static process(e,t,i,s,r){const[a,o,c]=R(this,Ht,yO).call(this,e),[h,d]=R(this,Ht,mO).call(this,a,o,c,Math.hypot(o,c)*u(this,Lh).sigmaSFactor,u(this,Lh).sigmaR,u(this,Lh).kernelSize),f=R(this,Ht,DE).call(this,d),p=R(this,Ht,kE).call(this,h,o,c,f);return this.processDrawnLines({lines:{curves:p,width:o,height:c},pageWidth:t,pageHeight:i,rotation:s,innerMargin:r,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:i,rotation:s,innerMargin:r,mustSmooth:a,areContours:o}){s%180!==0&&([t,i]=[i,t]);const{curves:c,width:h,height:d}=e,f=e.thickness??0,p=[],g=Math.min(t/h,i/d),v=g/t,b=g/i,x=[];for(const{points:y}of c){const w=a?R(this,Ht,gO).call(this,y):y;if(!w)continue;x.push(w);const E=w.length,S=new Float32Array(E),_=new Float32Array(3*(E===2?2:E-2));if(p.push({line:_,points:S}),E===2){S[0]=w[0]*v,S[1]=w[1]*b,_.set([NaN,NaN,NaN,NaN,S[0],S[1]],0);continue}let[T,j,M,L]=w;T*=v,j*=b,M*=v,L*=b,S.set([T,j,M,L],0),_.set([NaN,NaN,NaN,NaN,T,j],0);for(let O=4;O<E;O+=2){const B=S[O]=w[O]*v,G=S[O+1]=w[O+1]*b;_.set(Ye.createBezierPoints(T,j,M,L,B,G),(O-2)*3),[T,j,M,L]=[M,L,B,G]}}if(p.length===0)return null;const m=o?new NE:new Cy;return m.build(p,t,i,1,s,o?0:f,r),{outline:m,newCurves:x,areContours:o,thickness:f,width:h,height:d}}static async compressSignature({outlines:e,areContours:t,thickness:i,width:s,height:r}){let a=1/0,o=-1/0,c=0;for(const w of e){c+=w.length;for(let E=2,S=w.length;E<S;E++){const _=w[E]-w[E-2];a=Math.min(a,_),o=Math.max(o,_)}}let h;a>=-128&&o<=127?h=Int8Array:a>=-32768&&o<=32767?h=Int16Array:h=Int32Array;const d=e.length,f=rv+Hg*d,p=new Uint32Array(f);let g=0;p[g++]=f*Uint32Array.BYTES_PER_ELEMENT+(c-2*d)*h.BYTES_PER_ELEMENT,p[g++]=0,p[g++]=s,p[g++]=r,p[g++]=t?0:1,p[g++]=Math.max(0,Math.floor(i??0)),p[g++]=d,p[g++]=h.BYTES_PER_ELEMENT;for(const w of e)p[g++]=w.length-2,p[g++]=w[0],p[g++]=w[1];const v=new CompressionStream("deflate-raw"),b=v.writable.getWriter();await b.ready,b.write(p);const x=h.prototype.constructor;for(const w of e){const E=new x(w.length-2);for(let S=2,_=w.length;S<_;S++)E[S-2]=w[S]-w[S-2];b.write(E)}b.close();const m=await new Response(v.readable).arrayBuffer();return new Uint8Array(m).toBase64()}static async decompressSignature(e){try{const t=Uint8Array.fromBase64(e),{readable:i,writable:s}=new DecompressionStream("deflate-raw"),r=s.getWriter();await r.ready,r.write(t).then(async()=>{await r.ready,await r.close()}).catch(()=>{});let a=null,o=0;for await(const w of i)a||(a=new Uint8Array(new Uint32Array(w.buffer,0,4)[0])),a.set(w,o),o+=w.length;const c=new Uint32Array(a.buffer,0,a.length>>2),h=c[1];if(h!==0)throw new Error(`Invalid version: ${h}`);const d=c[2],f=c[3],p=c[4]===0,g=c[5],v=c[6],b=c[7],x=[],m=(rv+Hg*v)*Uint32Array.BYTES_PER_ELEMENT;let y;switch(b){case Int8Array.BYTES_PER_ELEMENT:y=new Int8Array(a.buffer,m);break;case Int16Array.BYTES_PER_ELEMENT:y=new Int16Array(a.buffer,m);break;case Int32Array.BYTES_PER_ELEMENT:y=new Int32Array(a.buffer,m);break}o=0;for(let w=0;w<v;w++){const E=c[Hg*w+rv],S=new Float32Array(E+2);x.push(S);for(let _=0;_<Hg-1;_++)S[_]=c[Hg*w+rv+_+1];for(let _=0;_<E;_++)S[_+2]=S[_]+y[o++]}return{areContours:p,thickness:g,outlines:x,width:d,height:f}}catch(t){return ut(`decompressSignature: ${t}`),null}}}Lh=new WeakMap,Ht=new WeakSet,_E=function(e,t,i,s){return i-=e,s-=t,i===0?s>0?0:4:i===1?s+6:2-s},la=new WeakMap,fO=function(e,t,i,s,r,a,o){const c=R(this,Ht,_E).call(this,i,s,r,a);for(let h=0;h<8;h++){const d=(-h+c-o+16)%8,f=u(this,la)[2*d],p=u(this,la)[2*d+1];if(e[(i+f)*t+(s+p)]!==0)return d}return-1},pO=function(e,t,i,s,r,a,o){const c=R(this,Ht,_E).call(this,i,s,r,a);for(let h=0;h<8;h++){const d=(h+c+o+16)%8,f=u(this,la)[2*d],p=u(this,la)[2*d+1];if(e[(i+f)*t+(s+p)]!==0)return d}return-1},kE=function(e,t,i,s){const r=e.length,a=new Int32Array(r);for(let d=0;d<r;d++)a[d]=e[d]<=s?1:0;for(let d=1;d<i-1;d++)a[d*t]=a[d*t+t-1]=0;for(let d=0;d<t;d++)a[d]=a[t*i-1-d]=0;let o=1,c;const h=[];for(let d=1;d<i-1;d++){c=1;for(let f=1;f<t-1;f++){const p=d*t+f,g=a[p];if(g===0)continue;let v=d,b=f;if(g===1&&a[p-1]===0)o+=1,b-=1;else if(g>=1&&a[p+1]===0)o+=1,b+=1,g>1&&(c=g);else{g!==1&&(c=Math.abs(g));continue}const x=[f,d],m=b===f+1,y={isHole:m,points:x,id:o,parent:0};h.push(y);let w;for(const O of h)if(O.id===c){w=O;break}w?w.isHole?y.parent=m?w.parent:c:y.parent=m?c:w.parent:y.parent=m?c:0;const E=R(this,Ht,fO).call(this,a,t,d,f,v,b,0);if(E===-1){a[p]=-o,a[p]!==1&&(c=Math.abs(a[p]));continue}let S=u(this,la)[2*E],_=u(this,la)[2*E+1];const T=d+S,j=f+_;v=T,b=j;let M=d,L=f;for(;;){const O=R(this,Ht,pO).call(this,a,t,M,L,v,b,1);S=u(this,la)[2*O],_=u(this,la)[2*O+1];const B=M+S,G=L+_;x.push(G,B);const W=M*t+L;if(a[W+1]===0?a[W]=-o:a[W]===1&&(a[W]=o),B===d&&G===f&&M===T&&L===j){a[p]!==1&&(c=Math.abs(a[p]));break}else v=M,b=L,M=B,L=G}}}return h},eb=function(e,t,i,s){if(i-t<=4){for(let T=t;T<i-2;T+=2)s.push(e[T],e[T+1]);return}const r=e[t],a=e[t+1],o=e[i-4]-r,c=e[i-3]-a,h=Math.hypot(o,c),d=o/h,f=c/h,p=d*a-f*r,g=c/o,v=1/h,b=Math.atan(g),x=Math.cos(b),m=Math.sin(b),y=v*(Math.abs(x)+Math.abs(m)),w=v*(1-y+y**2),E=Math.max(Math.atan(Math.abs(m+x)*w),Math.atan(Math.abs(m-x)*w));let S=0,_=t;for(let T=t+2;T<i-2;T+=2){const j=Math.abs(p-d*e[T+1]+f*e[T]);j>S&&(_=T,S=j)}S>(h*E)**2?(R(this,Ht,eb).call(this,e,t,_+2,s),R(this,Ht,eb).call(this,e,_,i,s)):s.push(r,a)},gO=function(e){const t=[],i=e.length;return R(this,Ht,eb).call(this,e,0,i,t),t.push(e[i-2],e[i-1]),t.length<=4?null:t},mO=function(e,t,i,s,r,a){const o=new Float32Array(a**2),c=-2*s**2,h=a>>1;for(let b=0;b<a;b++){const x=(b-h)**2;for(let m=0;m<a;m++)o[b*a+m]=Math.exp((x+(m-h)**2)/c)}const d=new Float32Array(256),f=-2*r**2;for(let b=0;b<256;b++)d[b]=Math.exp(b**2/f);const p=e.length,g=new Uint8Array(p),v=new Uint32Array(256);for(let b=0;b<i;b++)for(let x=0;x<t;x++){const m=b*t+x,y=e[m];let w=0,E=0;for(let _=0;_<a;_++){const T=b+_-h;if(!(T<0||T>=i))for(let j=0;j<a;j++){const M=x+j-h;if(M<0||M>=t)continue;const L=e[T*t+M],O=o[_*a+j]*d[Math.abs(L-y)];w+=L*O,E+=O}}const S=g[m]=Math.round(w/E);v[S]++}return[g,v]},xO=function(e){const t=new Uint32Array(256);for(const i of e)t[i]++;return t},TE=function(e){const t=e.length,i=new Uint8ClampedArray(t>>2);let s=-1/0,r=1/0;for(let o=0,c=i.length;o<c;o++){const h=i[o]=e[o<<2];s=Math.max(s,h),r=Math.min(r,h)}const a=255/(s-r);for(let o=0,c=i.length;o<c;o++)i[o]=(i[o]-r)*a;return i},DE=function(e){let t,i=-1/0,s=-1/0;const r=e.findIndex(c=>c!==0);let a=r,o=r;for(t=r;t<256;t++){const c=e[t];c>i&&(t-a>s&&(s=t-a,o=t-1),i=c,a=t)}for(t=o-1;t>=0&&!(e[t]>e[t+1]);t--);return t},yO=function(e){const t=e,{width:i,height:s}=e,{maxDim:r}=u(this,Lh);let a=i,o=s;if(i>r||s>r){let p=i,g=s,v=Math.log2(Math.max(i,s)/r);const b=Math.floor(v);v=v===b?b-1:b;for(let m=0;m<v;m++){a=Math.ceil(p/2),o=Math.ceil(g/2);const y=new OffscreenCanvas(a,o);y.getContext("2d").drawImage(e,0,0,p,g,0,0,a,o),p=a,g=o,e!==t&&e.close(),e=y.transferToImageBitmap()}const x=Math.min(r/a,r/o);a=Math.round(a*x),o=Math.round(o*x)}const h=new OffscreenCanvas(a,o).getContext("2d",{willReadFrequently:!0});h.fillStyle="white",h.fillRect(0,0,a,o),h.filter="grayscale(1)",h.drawImage(e,0,0,e.width,e.height,0,0,a,o);const d=h.getImageData(0,0,a,o).data;return[R(this,Ht,TE).call(this,d),a,o]},D(al,Ht),D(al,Lh,{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}),D(al,la,new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]));class kN extends oO{constructor(){super(),super.updateProperties({fill:dn._defaultLineColor,"stroke-width":0})}clone(){const e=new kN;return e.updateAll(this),e}}class TN extends Nw{constructor(e){super(e),super.updateProperties({stroke:dn._defaultLineColor,"stroke-width":1})}clone(){const e=new TN(this._viewParameters);return e.updateAll(this),e}}var kc,Ya,Tc,Mh;const js=class js extends d1{constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"});D(this,kc,!1);D(this,Ya,null);D(this,Tc,null);D(this,Mh,null);this._willKeepAspectRatio=!0,k(this,Tc,t.signatureData||null),k(this,Ya,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,i){dn.initialize(t,i),this._defaultDrawingOptions=new kN,this._defaultDrawnSignatureOptions=new TN(i.viewParameters)}static getDefaultDrawingOptions(t){const i=this._defaultDrawingOptions.clone();return i.updateProperties(t),i}static get supportMultipleDrawings(){return!1}static get typesMap(){return ht(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!u(this,Ya)}}static computeTelemetryFinalData(t){const i=t.get("hasDescription");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,i;const{_isCopy:s}=this;if(s&&(this._isCopy=!1,t=this.x,i=this.y),super.render(),this._drawId===null)if(u(this,Tc)){const{lines:r,mustSmooth:a,areContours:o,description:c,uuid:h,heightInPage:d}=u(this,Tc),{rawDims:{pageWidth:f,pageHeight:p},rotation:g}=this.parent.viewport,v=al.processDrawnLines({lines:r,pageWidth:f,pageHeight:p,rotation:g,innerMargin:js._INNER_MARGIN,mustSmooth:a,areContours:o});this.addSignature(v,d,c,h)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:u(this,Ya)||""}));return s&&(this._isCopy=!0,this._moveAfterPaste(t,i)),this.div}setUuid(t){k(this,Mh,t),this.addEditToolbar()}getUuid(){return u(this,Mh)}get description(){return u(this,Ya)}set description(t){k(this,Ya,t),this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(i=>{i==null||i.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:i,thickness:s,width:r,height:a}=u(this,Tc),o=Math.max(r,a),c=al.processDrawnLines({lines:{curves:t.map(h=>({points:h})),thickness:s,width:r,height:a},pageWidth:o,pageHeight:o,rotation:0,innerMargin:0,mustSmooth:!1,areContours:i});return{areContours:i,outline:c.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,i,s,r){const{x:a,y:o}=this,{outline:c}=k(this,Tc,t);k(this,kc,c instanceof NE),this.description=s;let h;u(this,kc)?h=js.getDefaultDrawingOptions():(h=js._defaultDrawnSignatureOptions.clone(),h.updateProperties({"stroke-width":c.thickness})),this._addOutlines({drawOutlines:c,drawingOptions:h});const[,d]=this.pageDimensions;let f=i/d;f=f>=1?.5:f,this.width*=f/this.height,this.width>=1&&(f*=.9/this.width,this.width=.9),this.height=f,this.setDims(),this.x=a,this.y=o,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(r),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!r,hasDescription:!!s}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:i,pageHeight:s},rotation:r}=this.parent.viewport;return al.process(t,i,s,r,js._INNER_MARGIN)}getFromText(t,i){const{rawDims:{pageWidth:s,pageHeight:r},rotation:a}=this.parent.viewport;return al.extractContoursFromText(t,i,s,r,a,js._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:i,pageHeight:s},rotation:r}=this.parent.viewport;return al.processDrawnLines({lines:t,pageWidth:i,pageHeight:s,rotation:r,innerMargin:js._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:i}){t?this._drawingOptions=js.getDefaultDrawingOptions():(this._drawingOptions=js._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":i}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:i,points:s}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":r}}=this,a=Object.assign(super.serialize(t),{isSignature:!0,areContours:u(this,kc),color:[0,0,0],thickness:u(this,kc)?0:r});return this.addComment(a),t?(a.paths={lines:i,points:s},a.uuid=u(this,Mh),a.isCopy=!0):a.lines=i,u(this,Ya)&&(a.accessibilityData={type:"Figure",alt:u(this,Ya)}),a}static deserializeDraw(t,i,s,r,a,o){return o.areContours?NE.deserialize(t,i,s,r,a,o):Cy.deserialize(t,i,s,r,a,o)}static async deserialize(t,i,s){var a;const r=await super.deserialize(t,i,s);return k(r,kc,t.areContours),r.description=((a=t.accessibilityData)==null?void 0:a.alt)||"",k(r,Mh,t.uuid),r}};kc=new WeakMap,Ya=new WeakMap,Tc=new WeakMap,Mh=new WeakMap,we(js,"_type","signature"),we(js,"_editorType",gt.SIGNATURE),we(js,"_defaultDrawingOptions",null);let jE=js;var Sn,mi,Dc,el,jc,Ip,tl,Oh,Xa,Ks,Bp,Ot,fm,pm,tb,nb,ib,LE,sb,vO;class RE extends dn{constructor(t){super({...t,name:"stampEditor"});D(this,Ot);D(this,Sn,null);D(this,mi,null);D(this,Dc,null);D(this,el,null);D(this,jc,null);D(this,Ip,"");D(this,tl,null);D(this,Oh,!1);D(this,Xa,null);D(this,Ks,!1);D(this,Bp,!1);k(this,el,t.bitmapUrl),k(this,jc,t.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,i){dn.initialize(t,i)}static isHandlingMimeForPasting(t){return gA.includes(t)}static paste(t,i){i.pasteEditor({mode:gt.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const i=t.get("hasAltText");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}async mlGuessAltText(t=null,i=!0){if(this.hasAltTextData())return null;const{mlManager:s}=this._uiManager;if(!s)throw new Error("No ML.");if(!await s.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:a,height:o}=t||this.copyCanvas(null,null,!0).imageData,c=await s.guess({name:"altText",request:{data:r,width:a,height:o,channels:r.length/(a*o)}});if(!c)throw new Error("No response from the AI service.");if(c.error)throw new Error("Error from the AI service.");if(c.cancel)return null;if(!c.output)throw new Error("No valid response from the AI service.");const h=c.output;return await this.setGuessedAltText(h),i&&!this.hasAltTextData()&&(this.altTextData={alt:h,decorative:!1}),h}remove(){var t;u(this,mi)&&(k(this,Sn,null),this._uiManager.imageManager.deleteId(u(this,mi)),(t=u(this,tl))==null||t.remove(),k(this,tl,null),u(this,Xa)&&(clearTimeout(u(this,Xa)),k(this,Xa,null))),super.remove()}rebuild(){if(!this.parent){u(this,mi)&&R(this,Ot,tb).call(this);return}super.rebuild(),this.div!==null&&(u(this,mi)&&u(this,tl)===null&&R(this,Ot,tb).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(u(this,Dc)||u(this,Sn)||u(this,el)||u(this,jc)||u(this,mi)||u(this,Oh))}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,i;return this._isCopy&&(t=this.x,i=this.y),super.render(),this.div.hidden=!0,this.createAltText(),u(this,Oh)||(u(this,Sn)?R(this,Ot,nb).call(this):R(this,Ot,tb).call(this)),this._isCopy&&this._moveAfterPaste(t,i),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,i){const{id:s,bitmap:r}=this._uiManager.imageManager.getFromCanvas(t,i);i.remove(),s&&this._uiManager.imageManager.isValidId(s)&&(k(this,mi,s),r&&k(this,Sn,r),k(this,Oh,!1),R(this,Ot,nb).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;u(this,Xa)!==null&&clearTimeout(u(this,Xa)),k(this,Xa,setTimeout(()=>{k(this,Xa,null),R(this,Ot,LE).call(this)},200))}copyCanvas(t,i,s=!1){t||(t=224);const{width:r,height:a}=u(this,Sn),o=new ro;let c=u(this,Sn),h=r,d=a,f=null;if(i){if(r>i||a>i){const T=Math.min(i/r,i/a);h=Math.floor(r*T),d=Math.floor(a*T)}f=document.createElement("canvas");const g=f.width=Math.ceil(h*o.sx),v=f.height=Math.ceil(d*o.sy);u(this,Ks)||(c=R(this,Ot,ib).call(this,g,v));const b=f.getContext("2d");b.filter=this._uiManager.hcmFilter;let x="white",m="#cfcfd8";this._uiManager.hcmFilter!=="none"?m="black":JV.isDarkMode&&(x="#8f8f9d",m="#42414d");const y=15,w=y*o.sx,E=y*o.sy,S=new OffscreenCanvas(w*2,E*2),_=S.getContext("2d");_.fillStyle=x,_.fillRect(0,0,w*2,E*2),_.fillStyle=m,_.fillRect(0,0,w,E),_.fillRect(w,E,w,E),b.fillStyle=b.createPattern(S,"repeat"),b.fillRect(0,0,g,v),b.drawImage(c,0,0,c.width,c.height,0,0,g,v)}let p=null;if(s){let g,v;if(o.symmetric&&c.width<t&&c.height<t)g=c.width,v=c.height;else if(c=u(this,Sn),r>t||a>t){const m=Math.min(t/r,t/a);g=Math.floor(r*m),v=Math.floor(a*m),u(this,Ks)||(c=R(this,Ot,ib).call(this,g,v))}const x=new OffscreenCanvas(g,v).getContext("2d",{willReadFrequently:!0});x.drawImage(c,0,0,c.width,c.height,0,0,g,v),p={width:g,height:v,data:x.getImageData(0,0,g,v).data}}return{canvas:f,width:h,height:d,imageData:p}}static async deserialize(t,i,s){var x;let r=null,a=!1;if(t instanceof OM){const{data:{rect:m,rotation:y,id:w,structParent:E,popupRef:S,richText:_,contentsObj:T,creationDate:j,modificationDate:M},container:L,parent:{page:{pageNumber:O}},canvas:B}=t;let G,W;B?(delete t.canvas,{id:G,bitmap:W}=s.imageManager.getFromCanvas(L.id,B),B.remove()):(a=!0,t._hasNoCanvas=!0);const J=((x=await i._structTree.getAriaAttributes(`${tf}${w}`))==null?void 0:x.get("aria-label"))||"";r=t={annotationType:gt.STAMP,bitmapId:G,bitmap:W,pageIndex:O-1,rect:m.slice(0),rotation:y,annotationElementId:w,id:w,deleted:!1,accessibilityData:{decorative:!1,altText:J},isSvg:!1,structParent:E,popupRef:S,richText:_,comment:(T==null?void 0:T.str)||null,creationDate:j,modificationDate:M}}const o=await super.deserialize(t,i,s),{rect:c,bitmap:h,bitmapUrl:d,bitmapId:f,isSvg:p,accessibilityData:g}=t;a?(s.addMissingCanvas(t.id,o),k(o,Oh,!0)):f&&s.imageManager.isValidId(f)?(k(o,mi,f),h&&k(o,Sn,h)):k(o,el,d),k(o,Ks,p);const[v,b]=o.pageDimensions;return o.width=(c[2]-c[0])/v,o.height=(c[3]-c[1])/b,g&&(o.altTextData=g),o._initialData=r,t.comment&&o.setCommentData(t),k(o,Bp,!!r),o}serialize(t=!1,i=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=Object.assign(super.serialize(t),{bitmapId:u(this,mi),isSvg:u(this,Ks)});if(this.addComment(s),t)return s.bitmapUrl=R(this,Ot,sb).call(this,!0),s.accessibilityData=this.serializeAltText(!0),s.isCopy=!0,s;const{decorative:r,altText:a}=this.serializeAltText(!1);if(!r&&a&&(s.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const c=R(this,Ot,vO).call(this,s);return c.isSame?null:(c.isSameAltText?delete s.accessibilityData:s.accessibilityData.structParent=this._initialData.structParent??-1,s.id=this.annotationElementId,delete s.bitmapId,s)}if(i===null)return s;i.stamps||(i.stamps=new Map);const o=u(this,Ks)?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(!i.stamps.has(u(this,mi)))i.stamps.set(u(this,mi),{area:o,serialized:s}),s.bitmap=R(this,Ot,sb).call(this,!1);else if(u(this,Ks)){const c=i.stamps.get(u(this,mi));o>c.area&&(c.area=o,c.serialized.bitmap.close(),c.serialized.bitmap=R(this,Ot,sb).call(this,!1))}return s}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}Sn=new WeakMap,mi=new WeakMap,Dc=new WeakMap,el=new WeakMap,jc=new WeakMap,Ip=new WeakMap,tl=new WeakMap,Oh=new WeakMap,Xa=new WeakMap,Ks=new WeakMap,Bp=new WeakMap,Ot=new WeakSet,fm=function(t,i=!1){if(!t){this.remove();return}k(this,Sn,t.bitmap),i||(k(this,mi,t.id),k(this,Ks,t.isSvg)),t.file&&k(this,Ip,t.file.name),R(this,Ot,nb).call(this)},pm=function(){if(k(this,Dc,null),this._uiManager.enableWaiting(!1),!!u(this,tl)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&u(this,Sn)){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&u(this,Sn)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},tb=function(){if(u(this,mi)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(u(this,mi)).then(s=>R(this,Ot,fm).call(this,s,!0)).finally(()=>R(this,Ot,pm).call(this));return}if(u(this,el)){const s=u(this,el);k(this,el,null),this._uiManager.enableWaiting(!0),k(this,Dc,this._uiManager.imageManager.getFromUrl(s).then(r=>R(this,Ot,fm).call(this,r)).finally(()=>R(this,Ot,pm).call(this)));return}if(u(this,jc)){const s=u(this,jc);k(this,jc,null),this._uiManager.enableWaiting(!0),k(this,Dc,this._uiManager.imageManager.getFromFile(s).then(r=>R(this,Ot,fm).call(this,r)).finally(()=>R(this,Ot,pm).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=gA.join(",");const i=this._uiManager._signal;k(this,Dc,new Promise(s=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),R(this,Ot,fm).call(this,r)}s()},{signal:i}),t.addEventListener("cancel",()=>{this.remove(),s()},{signal:i})}).finally(()=>R(this,Ot,pm).call(this))),t.click()},nb=function(){var h;const{div:t}=this;let{width:i,height:s}=u(this,Sn);const[r,a]=this.pageDimensions,o=.75;if(this.width)i=this.width*r,s=this.height*a;else if(i>o*r||s>o*a){const d=Math.min(o*r/i,o*a/s);i*=d,s*=d}this._uiManager.enableWaiting(!1);const c=k(this,tl,document.createElement("canvas"));c.setAttribute("role","img"),this.addContainer(c),this.width=i/r,this.height=s/a,this.setDims(),(h=this._initialOptions)!=null&&h.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),R(this,Ot,LE).call(this),u(this,Bp)||(this.parent.addUndoableEditor(this),k(this,Bp,!0)),this._reportTelemetry({action:"inserted_image"}),u(this,Ip)&&this.div.setAttribute("aria-description",u(this,Ip)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")},ib=function(t,i){const{width:s,height:r}=u(this,Sn);let a=s,o=r,c=u(this,Sn);for(;a>2*t||o>2*i;){const h=a,d=o;a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),o>2*i&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const f=new OffscreenCanvas(a,o);f.getContext("2d").drawImage(c,0,0,h,d,0,0,a,o),c=f.transferToImageBitmap()}return c},LE=function(){const[t,i]=this.parentDimensions,{width:s,height:r}=this,a=new ro,o=Math.ceil(s*t*a.sx),c=Math.ceil(r*i*a.sy),h=u(this,tl);if(!h||h.width===o&&h.height===c)return;h.width=o,h.height=c;const d=u(this,Ks)?u(this,Sn):R(this,Ot,ib).call(this,o,c),f=h.getContext("2d");f.filter=this._uiManager.hcmFilter,f.drawImage(d,0,0,d.width,d.height,0,0,o,c)},sb=function(t){if(t){if(u(this,Ks)){const r=this._uiManager.imageManager.getSvgUrl(u(this,mi));if(r)return r}const i=document.createElement("canvas");return{width:i.width,height:i.height}=u(this,Sn),i.getContext("2d").drawImage(u(this,Sn),0,0),i.toDataURL()}if(u(this,Ks)){const[i,s]=this.pageDimensions,r=Math.round(this.width*i*ou.PDF_TO_CSS_UNITS),a=Math.round(this.height*s*ou.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(r,a);return o.getContext("2d").drawImage(u(this,Sn),0,0,u(this,Sn).width,u(this,Sn).height,0,0,r,a),o.transferToImageBitmap()}return structuredClone(u(this,Sn))},vO=function(t){var o;const{pageIndex:i,accessibilityData:{altText:s}}=this._initialData,r=t.pageIndex===i,a=(((o=t.accessibilityData)==null?void 0:o.alt)||"")===s;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&r&&a,isSameAltText:a}},we(RE,"_type","stamp"),we(RE,"_editorType",gt.STAMP);var Ph,zp,Rc,Lc,nl,vs,Mc,Fp,Up,ca,il,xi,sl,Oc,Hp,Je,Pc,on,OE,bO,_a,PE,IE,rb;const Zr=class Zr{constructor({uiManager:e,pageIndex:t,div:i,structTreeLayer:s,accessibilityManager:r,annotationLayer:a,drawLayer:o,textLayer:c,viewport:h,l10n:d}){D(this,on);D(this,Ph);D(this,zp,!1);D(this,Rc,null);D(this,Lc,null);D(this,nl,null);D(this,vs,new Map);D(this,Mc,!1);D(this,Fp,!1);D(this,Up,!1);D(this,ca,null);D(this,il,null);D(this,xi,null);D(this,sl,null);D(this,Oc,null);D(this,Hp,-1);D(this,Je);const f=[...u(Zr,Pc).values()];if(!Zr._initialized){Zr._initialized=!0;for(const p of f)p.initialize(d,e)}e.registerEditorTypes(f),k(this,Je,e),this.pageIndex=t,this.div=i,k(this,Ph,r),k(this,Rc,a),this.viewport=h,k(this,xi,c),this.drawLayer=o,this._structTree=s,u(this,Je).addLayer(this)}updatePageIndex(e){this.pageIndex=e}get isEmpty(){return u(this,vs).size===0}get isInvisible(){return this.isEmpty&&u(this,Je).getMode()===gt.NONE}updateToolbar(e){u(this,Je).updateToolbar(e)}updateMode(e=u(this,Je).getMode()){switch(R(this,on,rb).call(this),e){case gt.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case gt.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case gt.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;if(t.toggle("nonEditing",!1),e===gt.POPUP)t.toggle("commentEditing",!0);else{t.toggle("commentEditing",!1);for(const i of u(Zr,Pc).values())t.toggle(`${i._type}Editing`,e===i._editorType)}this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=u(this,xi))==null?void 0:t.div)}setEditingState(e){u(this,Je).setEditingState(e)}addCommands(e){u(this,Je).addCommands(e)}cleanUndoStack(e){u(this,Je).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=u(this,Rc))==null||t.togglePointerEvents(e)}async enable(){var i;k(this,Up,!0),this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),(i=u(this,Oc))==null||i.abort(),k(this,Oc,null);const e=new Set;for(const s of u(this,on,OE))s.enableEditing(),s.show(!0),s.annotationElementId&&(u(this,Je).removeChangedExistingAnnotation(s),e.add(s.annotationElementId));const t=u(this,Rc);if(t)for(const s of t.getEditableAnnotations()){if(s.hide(),u(this,Je).isDeletedAnnotationElement(s.data.id)||e.has(s.data.id))continue;const r=await this.deserialize(s);r&&(this.addOrRebuild(r),r.enableEditing())}k(this,Up,!1),u(this,Je)._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){var s;if(k(this,Fp,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),u(this,xi)&&!u(this,Oc)){k(this,Oc,new AbortController);const r=u(this,Je).combinedSignal(u(this,Oc));u(this,xi).div.addEventListener("pointerdown",a=>{const{clientX:c,clientY:h,timeStamp:d}=a,f=u(this,Hp);if(d-f>500){k(this,Hp,d);return}k(this,Hp,-1);const{classList:p}=this.div;p.toggle("getElements",!0);const g=document.elementsFromPoint(c,h);if(p.toggle("getElements",!1),!this.div.contains(g[0]))return;let v;const b=new RegExp(`^${t0}[0-9]+$`);for(const m of g)if(b.test(m.id)){v=m.id;break}if(!v)return;const x=u(this,vs).get(v);(x==null?void 0:x.annotationElementId)===null&&(a.stopPropagation(),a.preventDefault(),x.dblclick(a))},{signal:r,capture:!0})}const e=u(this,Rc),t=[];if(e){const r=new Map,a=new Map;for(const c of u(this,on,OE)){if(c.disableEditing(),!c.annotationElementId){t.push(c);continue}if(c.serialize()!==null){r.set(c.annotationElementId,c);continue}else a.set(c.annotationElementId,c);(s=this.getEditableAnnotation(c.annotationElementId))==null||s.show(),c.remove()}const o=e.getEditableAnnotations();for(const c of o){const{id:h}=c.data;if(u(this,Je).isDeletedAnnotationElement(h)){c.updateEdited({deleted:!0});continue}let d=a.get(h);if(d){d.resetAnnotationElement(c),d.show(!1),c.show();continue}d=r.get(h),d&&(u(this,Je).addChangedExistingAnnotation(d),d.renderAnnotationElement(c)&&d.show(!1)),c.show()}}R(this,on,rb).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:i}=this.div;for(const r of u(Zr,Pc).values())i.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),e==null||e.updateFakeAnnotations(t),k(this,Fp,!1)}getEditableAnnotation(e){var t;return((t=u(this,Rc))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){u(this,Je).getActive()!==e&&u(this,Je).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=u(this,xi))!=null&&e.div&&!u(this,sl)){k(this,sl,new AbortController);const t=u(this,Je).combinedSignal(u(this,sl));u(this,xi).div.addEventListener("pointerdown",R(this,on,bO).bind(this),{signal:t}),u(this,xi).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=u(this,xi))!=null&&e.div&&u(this,sl)&&(u(this,sl).abort(),k(this,sl,null),u(this,xi).div.classList.remove("highlighting"))}enableClick(){if(u(this,Lc))return;k(this,Lc,new AbortController);const e=u(this,Je).combinedSignal(u(this,Lc));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=u(this,Lc))==null||e.abort(),k(this,Lc,null)}attach(e){u(this,vs).set(e.id,e);const{annotationElementId:t}=e;t&&u(this,Je).isDeletedAnnotationElement(t)&&u(this,Je).removeDeletedAnnotationElement(e)}detach(e){var t;u(this,vs).delete(e.id),(t=u(this,Ph))==null||t.removePointerInTextLayer(e.contentDiv),!u(this,Fp)&&e.annotationElementId&&u(this,Je).addDeletedAnnotationElement(e)}remove(e){this.detach(e),u(this,Je).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(u(this,Je).addDeletedAnnotationElement(e),dn.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),u(this,Je).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!u(this,Up)),u(this,Je).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var i;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!u(this,nl)&&(e._focusEventsAllowed=!1,k(this,nl,setTimeout(()=>{k(this,nl,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:u(this,Je)._signal}),t.focus())},0))),e._structTreeParentId=(i=u(this,Ph))==null?void 0:i.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),i=()=>{e.remove()};this.addCommands({cmd:t,undo:i,mustExec:!1})}getEditorByUID(e){for(const t of u(this,vs).values())if(t.uid===e)return t;return null}getNextId(){return u(this,Je).getId()}combinedSignal(e){return u(this,Je).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=u(this,on,_a))==null?void 0:e.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await u(this,Je).updateMode(e.mode);const{offsetX:i,offsetY:s}=R(this,on,IE).call(this),r=this.getNextId(),a=R(this,on,PE).call(this,{parent:this,id:r,x:i,y:s,uiManager:u(this,Je),isCentered:!0,...t});a&&this.add(a)}async deserialize(e){var t;return await((t=u(Zr,Pc).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,u(this,Je)))||null}createAndAddNewEditor(e,t,i={}){const s=this.getNextId(),r=R(this,on,PE).call(this,{parent:this,id:s,x:e.offsetX,y:e.offsetY,uiManager:u(this,Je),isCentered:t,...i});return r&&this.add(r),r}get boundingClientRect(){return this.div.getBoundingClientRect()}addNewEditor(e={}){this.createAndAddNewEditor(R(this,on,IE).call(this),!0,e)}setSelected(e){u(this,Je).setSelected(e)}toggleSelected(e){u(this,Je).toggleSelected(e)}unselect(e){u(this,Je).unselect(e)}pointerup(e){var s;const{isMac:t}=li.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!u(this,Mc)||(k(this,Mc,!1),(s=u(this,on,_a))!=null&&s.isDrawer&&u(this,on,_a).supportMultipleDrawings))return;if(!u(this,zp)){k(this,zp,!0);return}const i=u(this,Je).getMode();if(i===gt.STAMP||i===gt.SIGNATURE){u(this,Je).unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){var s;if(u(this,Je).getMode()===gt.HIGHLIGHT&&this.enableTextSelection(),u(this,Mc)){k(this,Mc,!1);return}const{isMac:t}=li.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(k(this,Mc,!0),(s=u(this,on,_a))!=null&&s.isDrawer){this.startDrawingSession(e);return}const i=u(this,Je).getActive();k(this,zp,!i||i.isEmpty())}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),u(this,ca)){u(this,on,_a).startDrawing(this,u(this,Je),!1,e);return}u(this,Je).setCurrentDrawingSession(this),k(this,ca,new AbortController);const t=u(this,Je).combinedSignal(u(this,ca));this.div.addEventListener("blur",({relatedTarget:i})=>{i&&!this.div.contains(i)&&(k(this,il,null),this.commitOrRemove())},{signal:t}),u(this,on,_a).startDrawing(this,u(this,Je),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&k(this,il,t);return}u(this,il)&&setTimeout(()=>{var t;(t=u(this,il))==null||t.focus(),k(this,il,null)},0)}endDrawingSession(e=!1){return u(this,ca)?(u(this,Je).setCurrentDrawingSession(null),u(this,ca).abort(),k(this,ca,null),k(this,il,null),u(this,on,_a).endDrawing(e)):null}findNewParent(e,t,i){const s=u(this,Je).findParent(t,i);return s===null||s===this?!1:(s.changeParent(e),!0)}commitOrRemove(){return u(this,ca)?(this.endDrawingSession(),!0):!1}onScaleChanging(){u(this,ca)&&u(this,on,_a).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=u(this,Je).getActive())==null?void 0:e.parent)===this&&(u(this,Je).commitOrRemove(),u(this,Je).setActiveEditor(null)),u(this,nl)&&(clearTimeout(u(this,nl)),k(this,nl,null));for(const i of u(this,vs).values())(t=u(this,Ph))==null||t.removePointerInTextLayer(i.contentDiv),i.setParent(null),i.isAttachedToDOM=!1,i.div.remove();this.div=null,u(this,vs).clear(),u(this,Je).removeLayer(this)}render({viewport:e}){this.viewport=e,Zh(this.div,e);for(const t of u(this,Je).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){u(this,Je).commitOrRemove(),R(this,on,rb).call(this);const t=this.viewport.rotation,i=e.rotation;if(this.viewport=e,Zh(this.div,{rotation:i}),t!==i)for(const s of u(this,vs).values())s.rotate(i)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return u(this,Je).viewParameters.realScale}};Ph=new WeakMap,zp=new WeakMap,Rc=new WeakMap,Lc=new WeakMap,nl=new WeakMap,vs=new WeakMap,Mc=new WeakMap,Fp=new WeakMap,Up=new WeakMap,ca=new WeakMap,il=new WeakMap,xi=new WeakMap,sl=new WeakMap,Oc=new WeakMap,Hp=new WeakMap,Je=new WeakMap,Pc=new WeakMap,on=new WeakSet,OE=function(){return u(this,vs).size!==0?u(this,vs).values():u(this,Je).getEditors(this.pageIndex)},bO=function(e){u(this,Je).unselectAll();const{target:t}=e;if(t===u(this,xi).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&u(this,xi).div.contains(t)){const{isMac:i}=li.platform;if(e.button!==0||e.ctrlKey&&i)return;u(this,Je).showAllEditors("highlight",!0,!0),u(this,xi).div.classList.add("free"),this.toggleDrawing(),h1.startHighlighting(this,u(this,Je).direction==="ltr",{target:u(this,xi).div,x:e.x,y:e.y}),u(this,xi).div.addEventListener("pointerup",()=>{u(this,xi).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:u(this,Je)._signal}),e.preventDefault()}},_a=function(){return u(Zr,Pc).get(u(this,Je).getMode())},PE=function(e){const t=u(this,on,_a);return t?new t.prototype.constructor(e):null},IE=function(){const{x:e,y:t,width:i,height:s}=this.boundingClientRect,r=Math.max(0,e),a=Math.max(0,t),o=Math.min(window.innerWidth,e+i),c=Math.min(window.innerHeight,t+s),h=(r+o)/2-e,d=(a+c)/2-t,[f,p]=this.viewport.rotation%180===0?[h,d]:[d,h];return{offsetX:f,offsetY:p}},rb=function(){for(const e of u(this,vs).values())e.isEmpty()&&e.remove()},we(Zr,"_initialized",!1),D(Zr,Pc,new Map([gE,CE,RE,h1,jE].map(e=>[e._editorType,e])));let ME=Zr;var ua,es,Ih,Jx,j1,wO,oo,zE,SO,FE;const si=class si{constructor(){D(this,oo);D(this,ua,null);D(this,es,new Map);D(this,Ih,new Map)}setParent(e){if(!u(this,ua)){k(this,ua,e);return}if(u(this,ua)!==e){if(u(this,es).size>0)for(const t of u(this,es).values())t.remove(),e.append(t);k(this,ua,e)}}static get _svgFactory(){return ht(this,"_svgFactory",new c1)}draw(e,t=!1,i=!1){const s=ni(si,Jx)._++,r=R(this,oo,zE).call(this),a=si._svgFactory.createElement("defs");r.append(a);const o=si._svgFactory.createElement("path");a.append(o);const c=`path_${s}`;o.setAttribute("id",c),o.setAttribute("vector-effect","non-scaling-stroke"),t&&u(this,Ih).set(s,o);const h=i?R(this,oo,SO).call(this,a,c):null,d=si._svgFactory.createElement("use");return r.append(d),d.setAttribute("href",`#${c}`),this.updateProperties(r,e),u(this,es).set(s,r),{id:s,clipPathId:`url(#${h})`}}drawOutline(e,t){const i=ni(si,Jx)._++,s=R(this,oo,zE).call(this),r=si._svgFactory.createElement("defs");s.append(r);const a=si._svgFactory.createElement("path");r.append(a);const o=`path_${i}`;a.setAttribute("id",o),a.setAttribute("vector-effect","non-scaling-stroke");let c;if(t){const f=si._svgFactory.createElement("mask");r.append(f),c=`mask_${i}`,f.setAttribute("id",c),f.setAttribute("maskUnits","objectBoundingBox");const p=si._svgFactory.createElement("rect");f.append(p),p.setAttribute("width","1"),p.setAttribute("height","1"),p.setAttribute("fill","white");const g=si._svgFactory.createElement("use");f.append(g),g.setAttribute("href",`#${o}`),g.setAttribute("stroke","none"),g.setAttribute("fill","black"),g.setAttribute("fill-rule","nonzero"),g.classList.add("mask")}const h=si._svgFactory.createElement("use");s.append(h),h.setAttribute("href",`#${o}`),c&&h.setAttribute("mask",`url(#${c})`);const d=h.cloneNode();return s.append(d),h.classList.add("mainOutline"),d.classList.add("secondaryOutline"),this.updateProperties(s,e),u(this,es).set(i,s),i}finalizeDraw(e,t){u(this,Ih).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var c;if(!t)return;const{root:i,bbox:s,rootClass:r,path:a}=t,o=typeof e=="number"?u(this,es).get(e):e;if(o){if(i&&R(this,oo,FE).call(this,o,i),s&&R(c=si,j1,wO).call(c,o,s),r){const{classList:h}=o;for(const[d,f]of Object.entries(r))h.toggle(d,f)}if(a){const d=o.firstElementChild.firstElementChild;R(this,oo,FE).call(this,d,a)}}}updateParent(e,t){if(t===this)return;const i=u(this,es).get(e);i&&(u(t,ua).append(i),u(this,es).delete(e),u(t,es).set(e,i))}remove(e){u(this,Ih).delete(e),u(this,ua)!==null&&(u(this,es).get(e).remove(),u(this,es).delete(e))}destroy(){k(this,ua,null);for(const e of u(this,es).values())e.remove();u(this,es).clear(),u(this,Ih).clear()}};ua=new WeakMap,es=new WeakMap,Ih=new WeakMap,Jx=new WeakMap,j1=new WeakSet,wO=function(e,[t,i,s,r]){const{style:a}=e;a.top=`${100*i}%`,a.left=`${100*t}%`,a.width=`${100*s}%`,a.height=`${100*r}%`},oo=new WeakSet,zE=function(){const e=si._svgFactory.create(1,1,!0);return u(this,ua).append(e),e.setAttribute("aria-hidden",!0),e},SO=function(e,t){const i=si._svgFactory.createElement("clipPath");e.append(i);const s=`clip_${t}`;i.setAttribute("id",s),i.setAttribute("clipPathUnits","objectBoundingBox");const r=si._svgFactory.createElement("use");return i.append(r),r.setAttribute("href",`#${t}`),r.classList.add("clip"),s},FE=function(e,t){for(const[i,s]of Object.entries(t))s===null?e.removeAttribute(i):e.setAttribute(i,s)},D(si,j1),D(si,Jx,0);let BE=si;globalThis._pdfjsTestingUtils={HighlightOutliner:xE};globalThis.pdfjsLib={AbortException:au,AnnotationEditorLayer:ME,AnnotationEditorParamsType:Tt,AnnotationEditorType:gt,AnnotationEditorUIManager:Qh,AnnotationLayer:fE,AnnotationMode:Hl,AnnotationType:Yn,applyOpacity:tG,build:lW,ColorPicker:o1,createValidAbsoluteUrl:tL,CSSConstants:eG,DOMSVGFactory:c1,DrawLayer:BE,FeatureTest:li,fetchData:wy,findContrastColor:nG,getDocument:CN,getFilenameFromUrl:YV,getPdfFilenameFromUrl:XV,getRGB:Ay,getUuid:iL,getXfaPageViewport:ZV,GlobalWorkerOptions:fa,ImageKind:Cv,InvalidPDFException:fA,isDataScheme:bw,isPdfFile:wN,isValidExplicitDest:fG,MathClamp:Ti,noContextMenu:Vr,normalizeUnicode:GV,OPS:n0,OutputScale:ro,PagesMapper:s0,PasswordResponses:PV,PDFDataRangeTransport:bM,PDFDateString:t1,PDFWorker:r0,PermissionFlag:OV,PixelsPerInch:ou,RenderingCancelledException:vw,renderRichText:rL,ResponseException:e1,setLayerDimensions:Zh,shadow:ht,SignatureExtractor:al,stopEvent:On,SupportedImageMimeTypes:gA,TextLayer:og,TouchManager:i1,updateUrlHash:nL,Util:$e,VerbosityLevel:gw,version:oW,XfaLayer:sL};const AO="/assets/pdf.worker-BA9kU3Pw.mjs";fa.workerSrc=AO;const UE=[{name:"yellow",bg:"rgba(250, 204, 21, 0.4)",css:"#facc15"},{name:"green",bg:"rgba(74, 222, 128, 0.4)",css:"#4ade80"},{name:"blue",bg:"rgba(96, 165, 250, 0.4)",css:"#60a5fa"},{name:"pink",bg:"rgba(244, 114, 182, 0.4)",css:"#f472b6"},{name:"purple",bg:"rgba(192, 132, 252, 0.4)",css:"#c084fc"}],SD={dark:"#1a1a1a",light:"#ffffff",sepia:"#f4ecd8"},AD=2,RW=.6,LW=2.5,MW=.002;function ED(n){const e=n.match(/^page:(\d+)/);return e?parseInt(e[1],10):null}function V2(n){const e=n.match(/^page:(\d+):(\d+)-(\d+)$/);return e?{page:parseInt(e[1],10),start:parseInt(e[2],10),end:parseInt(e[3],10)}:null}async function EO(n,e,t,i){if(!e)return[];const s=[];for(const r of e){let a=1;try{if(typeof r.dest=="string"){const c=await n.getDestination(r.dest);c&&c[0]&&(a=await n.getPageIndex(c[0])+1)}else Array.isArray(r.dest)&&r.dest[0]&&(a=await n.getPageIndex(r.dest[0])+1)}catch{}const o=r.items?await EO(n,r.items,t+1,i):void 0;s.push({id:`toc-${i.id++}`,label:r.title,href:`page:${a}`,level:t,children:o&&o.length>0?o:void 0})}return s}function OW(n){const e=UE.find(t=>t.name===n||t.css===n);return e?e.bg:UE[0].bg}function PW(n,e,t){return Math.min(t,Math.max(e,n))}function G2(n,e){n.style.fontFamily=ow[e.font],n.style.lineHeight=String(e.lineHeight)}const IW=A.forwardRef(function({bookId:e,filePath:t,highlights:i,onHighlightClick:s,onHighlightsChange:r,onTocLoaded:a,onProgressChange:o,onLocationChange:c,settings:h,initialLocation:d},f){const p=A.useRef(null),g=A.useRef(null),v=A.useRef(new Map),b=A.useRef(new Map),x=A.useRef(new Map),m=A.useRef(new Map),y=A.useRef(new Map),w=A.useRef(0),E=A.useRef(1),S=A.useRef(!1),_=A.useRef(null),T=A.useRef(i);T.current=i;const[j,M]=A.useState({visible:!1,x:0,y:0,text:"",pageNumber:0,startOffset:0,endOffset:0}),[L,O]=A.useState(1),B=A.useCallback(Z=>{const re=h.fontSize/16;return Z*re*L},[h.fontSize,L]),G=A.useCallback((Z,re)=>{const se=Z.getViewport({scale:1}),pe=(re-80)/se.width;return B(pe)},[B]),W=A.useCallback(Z=>{const re=x.current.get(Z);if(!re)return;re.querySelectorAll("mark[data-highlight-id]").forEach(Ne=>Ne.replaceWith(...Ne.childNodes));const se=T.current.filter(Ne=>{const ve=Ne.anchorPath?V2(Ne.anchorPath):null;return ve&&ve.page===Z});if(se.length===0)return;const be=re.querySelectorAll("span");let pe=0;const me=[];be.forEach(Ne=>{const ve=Ne.textContent??"";me.push({span:Ne,start:pe,end:pe+ve.length}),pe+=ve.length});for(const Ne of se){const ve=V2(Ne.anchorPath);if(!ve)continue;const{start:_e,end:We}=ve,Ie=OW(Ne.color);for(const{span:Re,start:Ze,end:it}of me){if(We<=Ze||_e>=it)continue;const tt=Math.max(0,_e-Ze),rt=Math.min(it-Ze,We-Ze),at=Re.textContent??"";if(tt===0&&rt===at.length){const ze=document.createElement("mark");ze.dataset.highlightId=Ne.id,ze.style.backgroundColor=Ie,ze.style.borderRadius="2px",ze.style.color="transparent",Re.replaceChildren(ze),ze.textContent=at}else{const ze=document.createDocumentFragment();tt>0&&ze.appendChild(document.createTextNode(at.slice(0,tt)));const ft=document.createElement("mark");ft.dataset.highlightId=Ne.id,ft.style.backgroundColor=Ie,ft.style.borderRadius="2px",ft.style.color="transparent",ft.textContent=at.slice(tt,rt),ze.appendChild(ft),rt<at.length&&ze.appendChild(document.createTextNode(at.slice(rt))),Re.replaceChildren(ze)}}}},[]),J=A.useCallback(async Z=>{const re=g.current,se=p.current;if(!re||!se)return;const be=m.current.get(Z);if(!(be!=null&&be.rendered||be!=null&&be.rendering)){m.current.set(Z,{rendered:!1,rendering:!0});try{const pe=await re.getPage(Z),me=se.clientWidth,Ne=G(pe,me),ve=window.devicePixelRatio||1,_e=pe.getViewport({scale:Ne}),We=v.current.get(Z),Ie=b.current.get(Z),Re=x.current.get(Z);if(!We||!Ie||!Re)return;We.style.width=`${_e.width}px`,We.style.height=`${_e.height}px`,Ie.width=_e.width*ve,Ie.height=_e.height*ve,Ie.style.width=`${_e.width}px`,Ie.style.height=`${_e.height}px`;const Ze=Ie.getContext("2d");Ze.setTransform(ve,0,0,ve,0,0);const it=y.current.get(Z);it&&it.cancel();const tt=pe.render({canvas:Ie,canvasContext:Ze,viewport:_e});y.current.set(Z,tt),await tt.promise,Re.innerHTML="",Re.style.width=`${_e.width}px`,Re.style.height=`${_e.height}px`,G2(Re,h);const rt=await pe.getTextContent();await new og({textContentSource:rt,container:Re,viewport:_e}).render(),m.current.set(Z,{rendered:!0,rendering:!1}),y.current.delete(Z),W(Z)}catch(pe){if(pe instanceof vw)return;console.error(`æ¸²æŸ“é¡µé¢ ${Z} å¤±è´¥:`,pe),m.current.set(Z,{rendered:!1,rendering:!1})}}},[G,W,h]),V=A.useCallback(Z=>{const re=y.current.get(Z);re&&(re.cancel(),y.current.delete(Z));const se=b.current.get(Z);if(se){const pe=se.getContext("2d");pe==null||pe.clearRect(0,0,se.width,se.height)}const be=x.current.get(Z);be&&(be.innerHTML=""),m.current.set(Z,{rendered:!1,rendering:!1})},[]),H=A.useCallback(()=>{const Z=p.current;if(!Z||w.current===0)return;const{scrollTop:re,scrollHeight:se,clientHeight:be}=Z,pe=se>be?re/(se-be):0;o(Math.min(1,Math.max(0,pe)));let me=1;const Ne=Z.getBoundingClientRect(),ve=Ne.top+Ne.height/2;for(const[_e,We]of v.current){const Ie=We.getBoundingClientRect();if(Ie.top<=ve&&Ie.bottom>=ve){me=_e;break}}E.current!==me&&(E.current=me,c(`page:${me}`))},[o,c]),P=A.useCallback(async Z=>{try{const re=await Z.getOutline();if(!re||re.length===0){a([]);return}const be=await EO(Z,re,0,{id:0});a(be)}catch{a([])}},[a]),Y=A.useCallback(Z=>{const re=p.current,se=v.current.get(Z);!re||!se||se.scrollIntoView({behavior:"smooth",block:"start"})},[]);A.useImperativeHandle(f,()=>({navigateTo:Z=>{const re=ED(Z);re&&Y(re)},navigateToHighlight:Z=>{const re=V2(Z);re&&Y(re.page)}}),[Y]),A.useEffect(()=>{let Z=!1,re=null;async function se(){const be=await window.electronAPI.bookReadFile(e);if(!be)return;if(re=await CN({data:new Uint8Array(be)}).promise,Z){re.destroy();return}g.current=re,w.current=re.numPages;const me=p.current;if(!me)return;me.innerHTML="",v.current.clear(),b.current.clear(),x.current.clear(),m.current.clear();for(let ve=1;ve<=re.numPages;ve++){const _e=document.createElement("div");_e.className="pdf-page-wrapper",_e.style.position="relative",_e.style.margin="0 auto 16px auto",_e.style.overflow="hidden",_e.dataset.pageNumber=String(ve);const We=await re.getPage(ve),Ie=me.clientWidth,Re=G(We,Ie),Ze=We.getViewport({scale:Re});_e.style.width=`${Ze.width}px`,_e.style.height=`${Ze.height}px`;const it=document.createElement("canvas");it.style.display="block",_e.appendChild(it);const tt=document.createElement("div");tt.className="pdf-text-layer",G2(tt,h),_e.appendChild(tt);const rt=document.createElement("div");rt.className="pdf-page-label",rt.textContent=String(ve),_e.appendChild(rt),me.appendChild(_e),v.current.set(ve,_e),b.current.set(ve,it),x.current.set(ve,tt),m.current.set(ve,{rendered:!1,rendering:!1})}_.current&&_.current.disconnect();const Ne=new IntersectionObserver(ve=>{for(const _e of ve){const We=parseInt(_e.target.dataset.pageNumber??"0",10);if(We!==0)if(_e.isIntersecting)for(let Ie=Math.max(1,We-AD);Ie<=Math.min(w.current,We+AD);Ie++)J(Ie);else{const Ie=m.current.get(We);if(Ie!=null&&Ie.rendered){const Re=v.current.get(We);if(Re){const Ze=Re.getBoundingClientRect(),it=me.getBoundingClientRect();Math.abs(Ze.top-it.top)>it.height*3&&V(We)}}}}},{root:me,rootMargin:"200% 0px"});_.current=Ne;for(const[,ve]of v.current)Ne.observe(ve);if(P(re),d&&!S.current){S.current=!0;const ve=ED(d);ve&&requestAnimationFrame(()=>Y(ve))}}return se(),()=>{Z=!0,_.current&&(_.current.disconnect(),_.current=null);for(const[,be]of y.current)be.cancel();y.current.clear(),re&&re.destroy(),g.current=null}},[e,t]),A.useEffect(()=>{if(g.current)for(const[Z]of m.current){const re=m.current.get(Z);re!=null&&re.rendered&&(V(Z),J(Z))}},[h.fontSize,h.theme,V,J]),A.useEffect(()=>{for(const[,Z]of x.current)G2(Z,h)},[h.font,h.lineHeight]),A.useEffect(()=>{for(const[Z]of m.current){const re=m.current.get(Z);re!=null&&re.rendered&&W(Z)}},[i,W]),A.useEffect(()=>{const Z=p.current;if(Z)return Z.addEventListener("scroll",H,{passive:!0}),()=>Z.removeEventListener("scroll",H)},[H]);const ge=A.useCallback(Z=>{Z.ctrlKey&&(Z.preventDefault(),O(re=>{const se=re*Math.exp(-Z.deltaY*MW);return PW(se,RW,LW)}))},[]);A.useEffect(()=>{const Z=p.current;if(Z)return Z.addEventListener("wheel",ge,{passive:!1}),()=>Z.removeEventListener("wheel",ge)},[ge]);const ae=A.useCallback(()=>{var tt;const Z=window.getSelection();if(!Z||Z.isCollapsed||!Z.rangeCount)return;const re=Z.getRangeAt(0),se=Z.toString().trim();if(!se)return;let be=null,pe=0,me=re.startContainer;for(;me;){if(me instanceof HTMLElement&&me.classList.contains("pdf-text-layer")){be=me;const rt=me.parentElement;pe=parseInt((rt==null?void 0:rt.dataset.pageNumber)??"0",10);break}me=me.parentNode}if(!be||pe===0)return;const Ne=be.querySelectorAll("span");let ve=0,_e=0,We=0,Ie=!1,Re=!1;for(const rt of Ne){const at=rt.textContent??"",ze=document.createTreeWalker(rt,NodeFilter.SHOW_TEXT);let ft,Kt=0;for(;ft=ze.nextNode();){const he=ft.length;if(!Ie&&re.startContainer===ft&&(_e=ve+Kt+re.startOffset,Ie=!0),!Re&&re.endContainer===ft&&(We=ve+Kt+re.endOffset,Re=!0),Kt+=he,Ie&&Re)break}if((!Ie||!Re)&&(!Ie&&re.startContainer===rt&&(_e=ve,Ie=!0),!Re&&re.endContainer===rt&&(We=ve+at.length,Re=!0)),ve+=at.length,Ie&&Re)break}if(!Ie||!Re||_e>=We)return;const Ze=re.getBoundingClientRect(),it=(tt=p.current)==null?void 0:tt.getBoundingClientRect();it&&M({visible:!0,x:Ze.left+Ze.width/2-it.left,y:Ze.top-it.top-8,text:se,pageNumber:pe,startOffset:_e,endOffset:We})},[]),ee=A.useCallback(async Z=>{var be;if(!j.text||j.pageNumber===0)return;const re=`page:${j.pageNumber}:${j.startOffset}-${j.endOffset}`,se=await window.electronAPI.bookHighlightCreate({bookId:e,text:j.text,color:Z,anchorPath:re,startOffset:j.startOffset,endOffset:j.endOffset,paragraphIndex:j.pageNumber});r([...T.current,se]),M(pe=>({...pe,visible:!1})),(be=window.getSelection())==null||be.removeAllRanges()},[j,e,r]),le=A.useCallback(()=>{M(Z=>({...Z,visible:!1}))},[]),ie=A.useCallback(Z=>{const re=Z.target,se=re==null?void 0:re.closest("mark[data-highlight-id]");if(!se)return;const be=se.dataset.highlightId;be&&(Z.preventDefault(),Z.stopPropagation(),s==null||s(be))},[s]);A.useEffect(()=>{if(!j.visible)return;const Z=re=>{re.target.closest(".pdf-highlight-toolbar")||le()};return document.addEventListener("mousedown",Z),()=>document.removeEventListener("mousedown",Z)},[j.visible,le]),A.useEffect(()=>{const Z=p.current;if(!Z)return;const re=se=>{switch(se.key){case"PageDown":se.preventDefault(),Z.scrollBy({top:Z.clientHeight*.9,behavior:"smooth"});break;case"PageUp":se.preventDefault(),Z.scrollBy({top:-Z.clientHeight*.9,behavior:"smooth"});break;case"ArrowDown":se.preventDefault(),Z.scrollBy({top:80,behavior:"smooth"});break;case"ArrowUp":se.preventDefault(),Z.scrollBy({top:-80,behavior:"smooth"});break}};return Z.addEventListener("keydown",re),()=>Z.removeEventListener("keydown",re)},[]);const Q=SD[h.theme]||SD.dark;return l.jsxs("div",{className:"relative w-full h-full",style:{backgroundColor:Q},children:[l.jsx("div",{ref:p,className:"w-full h-full overflow-y-auto outline-none py-4",tabIndex:0,onMouseUp:ae,onClick:ie,style:{backgroundColor:Q}}),j.visible&&l.jsx(BW,{x:j.x,y:j.y,containerRef:p,onSelectColor:ee})]})});function BW({x:n,y:e,containerRef:t,onSelectColor:i}){const s=A.useRef(null),[r,a]=A.useState({left:n,top:e});return A.useEffect(()=>{const o=s.current,c=t.current;if(!o||!c)return;const h=o.offsetWidth,d=c.clientWidth;let f=n-h/2;f=Math.max(8,Math.min(f,d-h-8));const p=Math.max(8,e-o.offsetHeight);a({left:f,top:p})},[n,e,t]),l.jsx("div",{ref:s,className:"pdf-highlight-toolbar absolute z-50 flex items-center gap-1 px-2 py-1.5 rounded-lg shadow-xl border border-white/10",style:{left:`${r.left}px`,top:`${r.top}px`,backgroundColor:"rgba(30, 30, 30, 0.95)",backdropFilter:"blur(8px)"},children:UE.map(o=>l.jsx("button",{onClick:()=>i(o.name),className:"w-6 h-6 rounded-full border-2 border-transparent hover:border-white/40 transition-colors cursor-pointer",style:{backgroundColor:o.css},title:o.name},o.name))})}fa.workerSrc=AO;const HE=[{name:"yellow",bg:"rgba(250, 204, 21, 0.4)",css:"#facc15"},{name:"green",bg:"rgba(74, 222, 128, 0.4)",css:"#4ade80"},{name:"blue",bg:"rgba(96, 165, 250, 0.4)",css:"#60a5fa"},{name:"pink",bg:"rgba(244, 114, 182, 0.4)",css:"#f472b6"},{name:"purple",bg:"rgba(192, 132, 252, 0.4)",css:"#c084fc"}],CD={dark:"#1a1a1a",light:"#ffffff",sepia:"#f4ecd8"};function ND(n){const e=n.match(/^page:(\d+)/);return e?parseInt(e[1],10):null}function _D(n){const e=n.match(/^page:(\d+):(\d+)-(\d+)$/);return e?{page:parseInt(e[1],10),start:parseInt(e[2],10),end:parseInt(e[3],10)}:null}function zW(n){const e=HE.find(t=>t.name===n||t.css===n);return e?e.bg:HE[0].bg}function kD(n){const e=n.toUpperCase();return e.includes("BOLD")||e.includes("HEAVY")||e.includes("BLACK")}function TD(n){const e=n.toUpperCase();return e.includes("ITALIC")||e.includes("OBLIQUE")}function FW(n){const e=new Map;for(const s of n){if(!s.str.trim())continue;const r=Math.round(s.height*10)/10;e.set(r,(e.get(r)??0)+s.str.length)}let t=12,i=0;for(const[s,r]of e)r>i&&(i=r,t=s);return t}function UW(n,e,t){if(e<=0)return 0;const i=n/e;return i>=1.8?1:i>=1.4?2:i>=1.15?3:t&&i>=1.05?4:0}async function HW(n){const e=[];try{const t=await n.getOperatorList(),s=n.getViewport({scale:1}).height;for(let r=0;r<t.fnArray.length;r++){if(t.fnArray[r]!==85&&t.fnArray[r]!==82)continue;const a=t.argsArray[r][0];if(a)try{const o=await new Promise((h,d)=>{const f=(p,g)=>{try{p.get(a,v=>{v?h(v):g?f(g):d(new Error("no data"))})}catch{g?f(g):d(new Error("not found"))}};f(n.objs,n.commonObjs)});if(o.width<50||o.height<50)continue;let c=s/2;for(let h=r-1;h>=Math.max(0,r-5);h--)if(t.fnArray[h]===12){const d=t.argsArray[h];d&&d.length>=6&&(c=s-d[5]-Math.abs(d[3]));break}if(o.data){const h=document.createElement("canvas");h.width=o.width,h.height=o.height;const d=h.getContext("2d"),f=new ImageData(new Uint8ClampedArray(o.data),o.width,o.height);d.putImageData(f,0,0);const p=h.toDataURL("image/png");e.push({y:c,dataUrl:p,width:o.width,height:o.height})}}catch{}}}catch{}return e}async function $W(n,e){const t=await n.getPage(e),i=await t.getTextContent(),r=t.getViewport({scale:1}).height,a=[];for(const m of i.items){if(!("str"in m))continue;const y=m,w=r-y.transform[5],E=y.height||Math.abs(y.transform[3]);a.push({str:y.str,height:E,y:w,fontName:y.fontName||""})}if(a.length===0)return{pageNum:e,blocks:[]};const o=FW(a),c=[];for(const m of a){const y=Math.round(m.y),w=c[c.length-1];w&&Math.abs(w.y-y)<3?(w.text+=m.str,m.height>w.fontSize&&(w.fontSize=m.height,w.bold=kD(m.fontName),w.italic=TD(m.fontName))):c.push({y,text:m.str,fontSize:m.height,bold:kD(m.fontName),italic:TD(m.fontName)})}const h=await HW(t),d=[];let f="",p=0,g=!1,v=0;const b=()=>{f&&(d.push({type:"paragraph",text:f,offset:p-f.length,bold:g}),f="",g=!1)},x=m=>{for(;v<h.length&&h[v].y<=m;)b(),d.push({type:"image",dataUrl:h[v].dataUrl,width:h[v].width,height:h[v].height}),v++};for(const m of c){const y=m.text.trim();if(y===""){b();continue}x(m.y);const w=UW(m.fontSize,o,m.bold);if(w>0){b(),d.push({type:"heading",level:w,text:y,offset:p}),p+=y.length;continue}f?f+=" "+y:(f=y,g=m.bold),p+=y.length+(f.length>y.length?1:0)}for(b();v<h.length;)d.push({type:"image",dataUrl:h[v].dataUrl,width:h[v].width,height:h[v].height}),v++;return{pageNum:e,blocks:d}}function DD(n){const e=[];let t=0;for(const i of n)for(let s=0;s<i.blocks.length;s++){const r=i.blocks[s];r.type==="heading"&&e.push({id:`heading-${t++}`,label:r.text,href:`page:${i.pageNum}:heading:${s}`,level:r.level-1})}return e}async function CO(n,e,t,i){if(!e)return[];const s=[];for(const r of e){let a=1;try{if(typeof r.dest=="string"){const c=await n.getDestination(r.dest);c&&c[0]&&(a=await n.getPageIndex(c[0])+1)}else Array.isArray(r.dest)&&r.dest[0]&&(a=await n.getPageIndex(r.dest[0])+1)}catch{}const o=r.items?await CO(n,r.items,t+1,i):void 0;s.push({id:`toc-${i.id++}`,label:r.title,href:`page:${a}`,level:t,children:o&&o.length>0?o:void 0})}return s}const qW=A.forwardRef(function({bookId:e,highlights:t,onHighlightClick:i,onHighlightsChange:s,onTocLoaded:r,onProgressChange:a,onLocationChange:o,settings:c,initialLocation:h},d){const f=A.useRef(null),p=A.useRef(null),g=A.useRef(0),v=A.useRef(1),b=A.useRef(!1),x=A.useRef(t);x.current=t;const[m,y]=A.useState([]),[w,E]=A.useState(!0),[S,_]=A.useState({visible:!1,x:0,y:0,text:"",pageNumber:0,startOffset:0,endOffset:0}),T=A.useCallback(H=>{var Y;const P=(Y=f.current)==null?void 0:Y.querySelector(`[data-page="${H}"]`);P&&P.scrollIntoView({behavior:"smooth",block:"start"})},[]),j=A.useCallback(H=>{var Y;const P=(Y=f.current)==null?void 0:Y.querySelector(`[data-heading-id="${H}"]`);P&&P.scrollIntoView({behavior:"smooth",block:"start"})},[]);A.useImperativeHandle(d,()=>({navigateTo:H=>{const P=H.match(/^page:(\d+):heading:(\d+)$/);if(P){const ge=`p${P[1]}-h${P[2]}`;j(ge);return}const Y=ND(H);Y&&T(Y)},navigateToHighlight:H=>{const P=_D(H);P&&T(P.page)}}),[T,j]),A.useEffect(()=>{let H=!1,P=null;async function Y(){E(!0);const ge=await window.electronAPI.bookReadFile(e);if(!ge||H)return;if(P=await CN({data:new Uint8Array(ge)}).promise,H){P.destroy();return}p.current=P,g.current=P.numPages;const ee=[];for(let le=1;le<=P.numPages;le++){const ie=await $W(P,le);if(H)return;ee.push(ie)}y(ee),E(!1);try{const le=await P.getOutline();if(le&&le.length>0){const Q=await CO(P,le,0,{id:0});H||r(Q)}else{const ie=DD(ee);H||r(ie)}}catch{const le=DD(ee);H||r(le)}if(h&&!b.current){b.current=!0;const le=ND(h);le&&requestAnimationFrame(()=>T(le))}}return Y(),()=>{H=!0,P&&P.destroy(),p.current=null}},[e]);const M=A.useCallback(()=>{const H=f.current;if(!H||g.current===0)return;const{scrollTop:P,scrollHeight:Y,clientHeight:ge}=H,ae=Y>ge?P/(Y-ge):0;a(Math.min(1,Math.max(0,ae)));const ee=H.getBoundingClientRect(),le=ee.top+ee.height/2,ie=H.querySelectorAll("[data-page]");let Q=1;for(const Z of ie){const re=Z.getBoundingClientRect();if(re.top<=le&&re.bottom>=le){Q=parseInt(Z.dataset.page??"1",10);break}}v.current!==Q&&(v.current=Q,o(`page:${Q}`))},[a,o]);A.useEffect(()=>{const H=f.current;if(H)return H.addEventListener("scroll",M,{passive:!0}),()=>H.removeEventListener("scroll",M)},[M]);const L=A.useCallback(()=>{const H=f.current;if(H){H.querySelectorAll("mark[data-highlight-id]").forEach(P=>{const Y=P.parentNode;if(Y){for(;P.firstChild;)Y.insertBefore(P.firstChild,P);Y.removeChild(P),Y.normalize()}});for(const P of x.current){if(!P.anchorPath)continue;const Y=_D(P.anchorPath);if(!Y)continue;const ge=H.querySelector(`[data-page="${Y.page}"]`);if(!ge)continue;const ae=ge.querySelectorAll("[data-offset]"),ee=zW(P.color);for(const le of ae){const ie=parseInt(le.dataset.offset??"0",10),Q=le.textContent??"",Z=ie+Q.length;if(Y.end<=ie||Y.start>=Z)continue;const re=Math.max(0,Y.start-ie),se=Math.min(Q.length,Y.end-ie);if(re===0&&se===Q.length){const be=document.createElement("mark");be.dataset.highlightId=P.id,be.style.backgroundColor=ee,be.style.borderRadius="2px",be.style.cursor="pointer",be.textContent=Q,le.replaceChildren(be)}else{const be=document.createDocumentFragment();re>0&&be.appendChild(document.createTextNode(Q.slice(0,re)));const pe=document.createElement("mark");pe.dataset.highlightId=P.id,pe.style.backgroundColor=ee,pe.style.borderRadius="2px",pe.style.cursor="pointer",pe.textContent=Q.slice(re,se),be.appendChild(pe),se<Q.length&&be.appendChild(document.createTextNode(Q.slice(se))),le.replaceChildren(be)}}}}},[]);A.useEffect(()=>{!w&&m.length>0&&requestAnimationFrame(()=>L())},[w,m,t,L]);const O=A.useCallback(()=>{const H=window.getSelection();if(!H||H.isCollapsed||!H.rangeCount)return;const P=H.getRangeAt(0),Y=H.toString().trim();if(!Y)return;const ge=f.current;if(!ge)return;let ae=null,ee=P.startContainer;for(;ee&&ee!==ge;){if(ee instanceof HTMLElement&&ee.dataset.page){ae=ee;break}ee=ee.parentNode}if(!ae)return;const le=parseInt(ae.dataset.page??"0",10);if(le===0)return;const ie=ae.querySelectorAll("[data-offset]");let Q=0,Z=0,re=!1,se=!1;for(const me of ie){const Ne=parseInt(me.dataset.offset??"0",10),ve=document.createTreeWalker(me,NodeFilter.SHOW_TEXT);let _e,We=0;for(;(_e=ve.nextNode())&&(!re&&P.startContainer===_e&&(Q=Ne+We+P.startOffset,re=!0),!se&&P.endContainer===_e&&(Z=Ne+We+P.endOffset,se=!0),We+=_e.length,!(re&&se)););if(re&&se)break}if(!re||!se||Q>=Z)return;const be=P.getBoundingClientRect(),pe=ge.getBoundingClientRect();_({visible:!0,x:be.left+be.width/2-pe.left,y:be.top-pe.top-8,text:Y,pageNumber:le,startOffset:Q,endOffset:Z})},[]),B=A.useCallback(async H=>{var ge;if(!S.text||S.pageNumber===0)return;const P=`page:${S.pageNumber}:${S.startOffset}-${S.endOffset}`,Y=await window.electronAPI.bookHighlightCreate({bookId:e,text:S.text,color:H,anchorPath:P,startOffset:S.startOffset,endOffset:S.endOffset,paragraphIndex:S.pageNumber});s([...x.current,Y]),_(ae=>({...ae,visible:!1})),(ge=window.getSelection())==null||ge.removeAllRanges()},[S,e,s]),G=A.useCallback(()=>{_(H=>({...H,visible:!1}))},[]);A.useEffect(()=>{if(!S.visible)return;const H=P=>{P.target.closest(".pdf-highlight-toolbar")||G()};return document.addEventListener("mousedown",H),()=>document.removeEventListener("mousedown",H)},[S.visible,G]);const W=A.useCallback(H=>{const Y=H.target.closest("mark[data-highlight-id]");Y!=null&&Y.dataset.highlightId&&(H.preventDefault(),H.stopPropagation(),i==null||i(Y.dataset.highlightId))},[i]),J=A.useCallback((H,P,Y)=>{if(H.type==="image")return l.jsx("figure",{className:"my-4",children:l.jsx("img",{src:H.dataUrl,alt:"",style:{maxWidth:"100%",height:"auto",borderRadius:"8px"}})},`img-${P}-${Y}`);if(H.type==="heading"){const ae=`p${P}-h${Y}`,ee=`h${H.level}`;return l.jsx(ee,{"data-heading-id":ae,children:l.jsx("span",{"data-offset":H.offset,children:H.text})},`h-${P}-${Y}`)}const ge=H.bold?l.jsx("strong",{children:l.jsx("span",{"data-offset":H.offset,children:H.text})}):l.jsx("span",{"data-offset":H.offset,children:H.text});return l.jsx("p",{children:ge},`p-${P}-${Y}`)},[]),V=CD[c.theme]||CD.dark;return l.jsxs("div",{className:"relative w-full h-full",style:{backgroundColor:V},children:[l.jsx("div",{ref:f,className:"w-full h-full overflow-y-auto outline-none",style:{backgroundColor:V},onMouseUp:O,onClick:W,tabIndex:0,children:w?l.jsx("div",{className:"flex items-center justify-center h-full",children:l.jsx("span",{className:"text-sm text-gray-500",children:"æ­£åœ¨æå–æ–‡æœ¬â€¦"})}):l.jsx("div",{className:"mx-auto max-w-[680px] px-8 py-10 article-content",style:{fontFamily:ow[c.font],fontSize:`${c.fontSize}px`,lineHeight:c.lineHeight},children:m.map(H=>l.jsxs("div",{"data-page":H.pageNum,children:[H.pageNum>1&&l.jsxs("div",{className:"flex items-center gap-3 my-8 select-none",children:[l.jsx("div",{className:"flex-1 border-t border-current opacity-10"}),l.jsxs("span",{className:"text-[11px] opacity-30",children:["Page ",H.pageNum]}),l.jsx("div",{className:"flex-1 border-t border-current opacity-10"})]}),H.blocks.map((P,Y)=>J(P,H.pageNum,Y))]},H.pageNum))})}),S.visible&&l.jsx("div",{className:"pdf-highlight-toolbar absolute z-50 flex items-center gap-1 px-2 py-1.5 rounded-lg shadow-xl border border-white/10",style:{left:`${S.x}px`,top:`${S.y}px`,transform:"translate(-50%, -100%)",backgroundColor:"rgba(30, 30, 30, 0.95)",backdropFilter:"blur(8px)"},children:HE.map(H=>l.jsx("button",{onClick:()=>B(H.name),className:"w-6 h-6 rounded-full border-2 border-transparent hover:border-white/40 transition-colors cursor-pointer",style:{backgroundColor:H.css},title:H.name},H.name))})]})});function VW({bookId:n,onClose:e}){const[t,i]=A.useState(null),[s,r]=A.useState(!0),[a,o]=A.useState([]),[c,h]=A.useState([]),[d,f]=A.useState(()=>localStorage.getItem("book-reader-toc-collapsed")==="true"),[p,g]=A.useState(()=>localStorage.getItem("book-reader-detail-collapsed")==="true"),[v,b]=A.useState(!1),[x,m]=A.useState(()=>localStorage.getItem("z-reader-pdf-view-mode")||"pdf"),[y,w]=A.useState(DH),[E,S]=A.useState(0),[_,T]=A.useState("info"),[j,M]=A.useState(null),[L,O]=A.useState(0),B=A.useRef(null);A.useEffect(()=>{let Y=!1;async function ge(){r(!0);try{const ae=await window.electronAPI.bookGet(n);if(Y)return;i(ae),ae&&S(ae.readProgress??0)}catch{}finally{Y||r(!1)}}return ge(),()=>{Y=!0}},[n]);const G=A.useCallback(Y=>{var ge;(ge=B.current)==null||ge.navigateTo(Y.href)},[]),W=A.useCallback(Y=>{var ae;const ge=a.find(ee=>ee.id===Y);ge!=null&&ge.anchorPath&&((ae=B.current)==null||ae.navigateToHighlight(ge.anchorPath)),p&&(g(!1),localStorage.setItem("book-reader-detail-collapsed","false")),T("notebook"),M(Y),O(ee=>ee+1)},[a,p]);A.useEffect(()=>{let Y=!1;return window.electronAPI.bookHighlightList(n).then(ge=>{Y||o(ge)}),()=>{Y=!0}},[n]),A.useEffect(()=>{const Y=ge=>{const ee=ge.detail;!ee||ee.bookId!==n||W(ee.highlightId)};return window.addEventListener("book-reader:highlight-click",Y),()=>window.removeEventListener("book-reader:highlight-click",Y)},[n,W]);const J=A.useCallback(async Y=>{await window.electronAPI.highlightDelete(Y),o(ge=>ge.filter(ae=>ae.id!==Y))},[]),V=A.useCallback(Y=>{S(Y),window.electronAPI.bookUpdate({id:n,readProgress:Y})},[n]),H=A.useCallback(Y=>{window.electronAPI.bookUpdate({id:n,currentLocation:Y})},[n]),P=y.theme==="light"?"reader-theme-light":y.theme==="sepia"?"reader-theme-sepia":"reader-theme-dark";return l.jsxs("div",{className:`flex flex-1 h-full overflow-hidden ${P}`,children:[l.jsxs("div",{className:`shrink-0 flex flex-col border-r border-[#262626] bg-[#141414] transition-all duration-200 overflow-hidden ${d?"w-0 border-r-0":"w-[220px]"}`,children:[l.jsxs("div",{className:"shrink-0 flex items-center justify-between px-4 h-12 border-b border-[#262626]",children:[l.jsx("button",{onClick:e,className:"p-1.5 rounded hover:bg-white/10 transition-colors cursor-pointer text-gray-400 hover:text-white",title:"è¿”å›žåˆ—è¡¨",children:l.jsx(ng,{className:"w-4 h-4"})}),l.jsx("h2",{className:"text-[13px] font-semibold text-white tracking-wide",children:"Contents"}),l.jsx("div",{className:"w-6"})]}),l.jsx(EH,{items:c,onNavigate:G,loading:s})]}),l.jsxs("div",{className:"relative flex-1 flex flex-col overflow-hidden",children:[l.jsxs("div",{className:"shrink-0 flex items-center justify-between px-6 h-12 border-b border-[#262626]",children:[l.jsxs("div",{className:"flex items-center gap-1.5 text-[12px] min-w-0 truncate",children:[l.jsx("button",{onClick:()=>f(Y=>{const ge=!Y;return localStorage.setItem("book-reader-toc-collapsed",String(ge)),ge}),className:"p-1 rounded hover:bg-white/10 transition-colors cursor-pointer text-gray-400 hover:text-white shrink-0",title:d?"å±•å¼€ç›®å½•":"æ”¶èµ·ç›®å½•",children:d?l.jsx(WC,{className:"w-4 h-4"}):l.jsx(J1,{className:"w-4 h-4"})}),l.jsx("span",{className:"text-gray-400 truncate",children:(t==null?void 0:t.title)??"åŠ è½½ä¸­â€¦"})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[(t==null?void 0:t.fileType)==="pdf"&&l.jsx("button",{onClick:()=>{const Y=x==="pdf"?"text":"pdf";m(Y),localStorage.setItem("z-reader-pdf-view-mode",Y)},className:"p-1.5 rounded hover:bg-white/10 transition-colors cursor-pointer text-gray-400 hover:text-white",title:x==="pdf"?"åˆ‡æ¢åˆ°æ–‡æœ¬è§†å›¾":"åˆ‡æ¢åˆ° PDF è§†å›¾",children:x==="pdf"?l.jsx(El,{className:"w-4 h-4"}):l.jsx(qr,{className:"w-4 h-4"})}),l.jsx("button",{onClick:()=>b(!v),className:"p-1.5 rounded hover:bg-white/10 transition-colors cursor-pointer text-gray-400 hover:text-white",title:"æŽ’ç‰ˆè®¾ç½®",children:l.jsx(Bb,{className:"w-4 h-4"})}),l.jsx("button",{onClick:()=>g(Y=>{const ge=!Y;return localStorage.setItem("book-reader-detail-collapsed",String(ge)),ge}),className:"p-1.5 rounded hover:bg-white/10 transition-colors cursor-pointer text-gray-400 hover:text-white",title:p?"å±•å¼€è¯¦æƒ…":"æ”¶èµ·è¯¦æƒ…",children:p?l.jsx(tw,{className:"w-4 h-4"}):l.jsx(ew,{className:"w-4 h-4"})})]})]}),l.jsx(RH,{open:v,onClose:()=>b(!1),settings:y,onSettingsChange:w}),l.jsx("div",{className:"shrink-0 h-[2px] bg-white/5",children:l.jsx("div",{className:"h-full bg-blue-500 transition-[width] duration-300",style:{width:`${Math.round(E*100)}%`}})}),l.jsx("div",{className:"flex-1 overflow-hidden",children:s?l.jsxs("div",{className:"flex flex-col items-center justify-center h-full gap-3",children:[l.jsx(nt,{className:"w-6 h-6 text-gray-500 animate-spin"}),l.jsx("span",{className:"text-sm text-gray-500",children:"åŠ è½½ä¸­â€¦"})]}):t?t.fileType==="pdf"&&x==="text"?l.jsx(qW,{ref:B,bookId:n,filePath:t.filePath,highlights:a,onHighlightClick:W,onHighlightsChange:o,onTocLoaded:h,onProgressChange:V,onLocationChange:H,settings:y,initialLocation:t.currentLocation}):t.fileType==="pdf"?l.jsx(IW,{ref:B,bookId:n,filePath:t.filePath,highlights:a,onHighlightClick:W,onHighlightsChange:o,onTocLoaded:h,onProgressChange:V,onLocationChange:H,settings:y,initialLocation:t.currentLocation}):l.jsx(MV,{ref:B,bookId:n,filePath:t.filePath,highlights:a,onHighlightsChange:o,onTocLoaded:h,onProgressChange:V,onLocationChange:H,settings:y,initialLocation:t.currentLocation}):l.jsx("div",{className:"flex items-center justify-center h-full text-sm text-gray-500",children:"ä¹¦ç±ä¸å­˜åœ¨"})})]}),l.jsx("div",{className:`shrink-0 h-full overflow-hidden ${p?"w-0":""}`,children:l.jsx(NH,{book:t,readProgress:E,highlights:a,activeTab:_,onTabChange:T,focusedHighlightId:j,focusSignal:L,onHighlightsChange:o,onDeleteHighlight:J,onHighlightClick:W})})]})}const GW=A.forwardRef(function({videoId:e,videoUrl:t,onTimeUpdate:i,onReady:s,onDuration:r},a){const o=A.useRef(null),c=A.useRef(null),h=A.useRef(null),[d,f]=A.useState([]),[p,g]=A.useState(null),[v,b]=A.useState(null),[x,m]=A.useState(!1),[y,w]=A.useState(!0),[E,S]=A.useState(null),[_,T]=A.useState(!1),[j,M]=A.useState(!1),L=!!t&&!e,O=v!=null&&!v.hasAudio;A.useImperativeHandle(a,()=>({seekTo:P=>{o.current&&(o.current.currentTime=P),O&&c.current&&(c.current.currentTime=P)}}),[O]);const B=A.useCallback(async()=>{if(!e){w(!1),S("è§†é¢‘ä¸å¯ç”¨");return}w(!0),S(null),f([]),g(null),b(null),T(!1);try{const P=await window.electronAPI.youtubeGetStreamUrl(e);if(P&&P.formats.length>0){f(P.formats),g(P.bestAudio);const Y=P.formats.find(ge=>ge.hasAudio)??P.formats[0];b(Y)}else await window.electronAPI.youtubeAuthStatus()?S("æ— æ³•èŽ·å–è§†é¢‘æµï¼Œè¯·ç¨åŽé‡è¯•"):T(!0)}catch{S("èŽ·å–è§†é¢‘æµå¤±è´¥")}w(!1)},[e]);A.useEffect(()=>{if(L){w(!1),S(null),T(!1);return}let P=!1;return(async()=>await B())(),()=>{P=!0}},[B,L]);const G=A.useCallback(async()=>{M(!0);try{await window.electronAPI.youtubeLogin()&&await B()}catch{S("ç™»å½•å¤±è´¥")}M(!1)},[B]);A.useEffect(()=>{const P=o.current,Y=c.current;if(!P||!Y||!O)return;const ge=()=>{Y.play().catch(()=>{})},ae=()=>{Y.pause()},ee=()=>{Y.currentTime=P.currentTime};return P.addEventListener("play",ge),P.addEventListener("pause",ae),P.addEventListener("seeked",ee),()=>{P.removeEventListener("play",ge),P.removeEventListener("pause",ae),P.removeEventListener("seeked",ee)}},[O,v]),A.useEffect(()=>{if(!O){h.current&&(clearInterval(h.current),h.current=null);return}return h.current=setInterval(()=>{const P=o.current,Y=c.current;if(!P||!Y)return;Math.abs(P.currentTime-Y.currentTime)>.3&&(Y.currentTime=P.currentTime)},3e3),()=>{h.current&&(clearInterval(h.current),h.current=null)}},[O]);const W=A.useCallback(P=>{const Y=o.current,ge=(Y==null?void 0:Y.currentTime)??0,ae=Y?!Y.paused:!1;b(P),m(!1),requestAnimationFrame(()=>{const ee=o.current;if(ee){const ie=()=>{ee.currentTime=ge,ae&&ee.play().catch(()=>{}),ee.removeEventListener("canplay",ie)};ee.addEventListener("canplay",ie)}const le=c.current;if(le&&!P.hasAudio){const ie=()=>{le.currentTime=ge,le.removeEventListener("canplay",ie)};le.addEventListener("canplay",ie)}})},[]),J=A.useCallback(()=>{const P=o.current;P&&(s==null||s(),P.duration&&P.duration>0&&(r==null||r(P.duration)))},[s,r]),V=A.useCallback(()=>{const P=o.current;P&&(i==null||i(P.currentTime))},[i]),H=A.useCallback(()=>{const P=o.current;P&&P.duration&&P.duration>0&&(r==null||r(P.duration))},[r]);return A.useEffect(()=>{if(!x)return;const P=()=>m(!1),Y=requestAnimationFrame(()=>{document.addEventListener("click",P)});return()=>{cancelAnimationFrame(Y),document.removeEventListener("click",P)}},[x]),y?l.jsx("div",{className:"relative w-full bg-black rounded-lg flex items-center justify-center",style:{paddingBottom:"56.25%"},children:l.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:l.jsx("div",{className:"text-zinc-400 text-sm",children:"åŠ è½½è§†é¢‘ä¸­..."})})}):L&&t?l.jsx("div",{className:"relative w-full group",style:{paddingBottom:"56.25%"},children:l.jsx("video",{ref:o,src:t,className:"absolute inset-0 w-full h-full rounded-lg bg-black",controls:!0,onLoadedMetadata:J,onTimeUpdate:V,onDurationChange:H})}):_?l.jsx("div",{className:"relative w-full bg-black rounded-lg flex items-center justify-center",style:{paddingBottom:"56.25%"},children:l.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center gap-3",children:[l.jsx("div",{className:"text-zinc-400 text-sm",children:"éœ€è¦ç™»å½• YouTube æ‰èƒ½æ’­æ”¾è§†é¢‘"}),l.jsx("button",{onClick:G,disabled:j,className:"px-4 py-2 bg-red-600 hover:bg-red-700 disabled:bg-zinc-600 text-white text-sm rounded-md transition-colors",children:j?"ç™»å½•ä¸­...":"ç™»å½• YouTube"})]})}):E||!v?l.jsx("div",{className:"relative w-full bg-black rounded-lg flex items-center justify-center",style:{paddingBottom:"56.25%"},children:l.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center gap-3",children:[l.jsx("div",{className:"text-zinc-400 text-sm",children:E??"è§†é¢‘ä¸å¯ç”¨"}),l.jsx("button",{onClick:G,disabled:j,className:"px-3 py-1.5 bg-zinc-700 hover:bg-zinc-600 disabled:bg-zinc-800 text-zinc-300 text-xs rounded transition-colors",children:j?"ç™»å½•ä¸­...":"é‡æ–°ç™»å½• YouTube"})]})}):l.jsxs("div",{className:"relative w-full group",style:{paddingBottom:"56.25%"},children:[l.jsx("video",{ref:o,src:v.url,className:"absolute inset-0 w-full h-full rounded-lg bg-black",controls:!0,onLoadedMetadata:J,onTimeUpdate:V,onDurationChange:H}),O&&p&&l.jsx("audio",{ref:c,src:p.url,preload:"auto"}),d.length>1&&l.jsxs("div",{className:"absolute bottom-12 right-3 z-10",children:[x&&l.jsx("div",{className:"mb-1 bg-black/90 rounded-md py-1 min-w-[100px] shadow-lg",onClick:P=>P.stopPropagation(),children:d.map(P=>l.jsx("button",{onClick:()=>W(P),className:`w-full px-3 py-1.5 text-left text-xs transition-colors ${P.itag===v.itag?"text-blue-400 bg-white/10":"text-white hover:bg-white/10"}`,children:P.qualityLabel},P.itag))}),l.jsx("button",{onClick:P=>{P.stopPropagation(),m(Y=>!Y)},className:"px-2 py-1 bg-black/70 hover:bg-black/90 text-white text-xs rounded transition-colors opacity-0 group-hover:opacity-100",children:v.qualityLabel})]})]})});function WW(n){if(!(n!=null&&n.startsWith("transcript:")))return null;const t=n.slice(11).split("-");if(t.length!==2)return null;const i=parseInt(t[0],10),s=parseInt(t[1],10);return isNaN(i)||isNaN(s)?null:{startSegIdx:i,endSegIdx:s}}function YW(n,e,t){const i=[];for(const a of t){const o=WW(a.anchorPath);if(!o)continue;const{startSegIdx:c,endSegIdx:h}=o;if(n<c||n>h)continue;let d=0,f=e.length;n===c&&(d=a.startOffset??0),n===h&&(f=a.endOffset??e.length),d=Math.max(0,Math.min(d,e.length)),f=Math.max(d,Math.min(f,e.length)),d<f&&i.push({start:d,end:f,highlightId:a.id,color:a.color})}if(i.length===0)return[{text:e,highlightId:null,color:""}];i.sort((a,o)=>a.start-o.start||a.end-o.end);const s=[];let r=0;for(const a of i){r<a.start&&s.push({text:e.slice(r,a.start),highlightId:null,color:""});const o=Math.max(r,a.start);o<a.end&&s.push({text:e.slice(o,a.end),highlightId:a.highlightId,color:a.color}),r=Math.max(r,a.end)}return r<e.length&&s.push({text:e.slice(r),highlightId:null,color:""}),s}function XW(n){const e=Math.floor(n/60),t=Math.floor(n%60);return`${e}:${String(t).padStart(2,"0")}`}const jD="rgba(251,191,36,0.25)",KW="rgba(251,191,36,0.40)";function NO({segments:n,currentTime:e,onSegmentClick:t,loading:i,highlights:s=[],onCreateHighlight:r,onDeleteHighlight:a,onUpdateHighlight:o,highlightTagsMap:c={},scrollToSegment:h,speakerMap:d={},onSpeakerRename:f}){const[p,g]=A.useState(!0),v=A.useRef(null),b=A.useRef(new Map),x=A.useRef(!1),m=A.useRef(null),y=A.useRef(null),w=A.useRef(null),[E,S]=A.useState(null),[_,T]=A.useState(null),[j,M]=A.useState(null),[L,O]=A.useState(null),B=A.useMemo(()=>s.filter(ae=>{var ee;return(ee=ae.anchorPath)==null?void 0:ee.startsWith("transcript:")}),[s]),G=A.useMemo(()=>{for(let ae=n.length-1;ae>=0;ae--)if(e>=n[ae].start)return ae;return-1},[n,e]);A.useEffect(()=>{if(!p||G<0)return;const ae=b.current.get(G);ae&&ae.scrollIntoView({behavior:"smooth",block:"center"})},[p,G]),A.useEffect(()=>{if(h==null||h<0)return;const ae=b.current.get(h);ae&&(g(!1),ae.scrollIntoView({behavior:"smooth",block:"center"}),ae.classList.add("highlight-flash"),setTimeout(()=>ae.classList.remove("highlight-flash"),1500))},[h]);const W=A.useCallback(()=>{p&&(g(!1),x.current=!0),m.current&&clearTimeout(m.current),m.current=setTimeout(()=>{x.current=!1},150)},[p]),J=A.useCallback(()=>{g(!0)},[]),V=A.useCallback(ae=>{t(ae)},[t]),H=A.useCallback((ae,ee)=>{ee?b.current.set(ae,ee):b.current.delete(ae)},[]),P=A.useCallback(ae=>{setTimeout(()=>{const ee=window.getSelection();if(!w.current)return;if(ee&&!ee.isCollapsed){if(!ee.toString().trim()||!w.current.contains(ee.anchorNode)||!w.current.contains(ee.focusNode))return;const re=ee.getRangeAt(0).getBoundingClientRect();S({mode:"selection",x:re.left+re.width/2,y:re.top-10});return}const ie=ae.target.closest("mark[data-highlight-id]");if(ie){const Q=ie.dataset.highlightId;if(Q){const Z=ie.getBoundingClientRect();S({mode:"highlight",highlightId:Q,x:Z.left+Z.width/2,y:Z.top-10})}return}S(null)},10)},[]),Y=A.useCallback(()=>{const ae=window.getSelection();if(!ae||ae.isCollapsed||!w.current||!r)return;const ee=ae.toString().trim();if(!ee)return;const le=Ie=>{var Ze;let Re=Ie.nodeType===Node.TEXT_NODE?Ie.parentElement:Ie;for(;Re&&Re!==w.current;){if(((Ze=Re.dataset)==null?void 0:Ze.segIdx)!=null)return parseInt(Re.dataset.segIdx,10);Re=Re.parentElement}return-1},ie=le(ae.anchorNode),Q=le(ae.focusNode);if(ie<0||Q<0)return;let Z=Math.min(ie,Q),re=Math.max(ie,Q);const se=ae.getRangeAt(0),be=w.current.querySelector(`[data-seg-idx="${Z}"]`),pe=w.current.querySelector(`[data-seg-idx="${re}"]`);if(!be||!pe)return;const me=(Ie,Re,Ze)=>{const it=document.createRange();return it.setStart(Ie,0),it.setEnd(Re,Ze),it.toString().length};let Ne,ve;Ne=me(be,se.startContainer,se.startOffset),ve=me(pe,se.endContainer,se.endOffset);const _e=`transcript:${Z}-${re}`;B.some(Ie=>Ie.anchorPath===_e&&Ie.startOffset===Ne&&Ie.endOffset===ve)||(r({text:ee,paragraphIndex:Z,startOffset:Ne,endOffset:ve,anchorPath:_e}),ae.removeAllRanges(),S(null))},[r,B]),ge=A.useCallback(ae=>{a==null||a(ae),S(null)},[a]);return A.useEffect(()=>{const ae=ee=>{var ie;if((ie=y.current)!=null&&ie.contains(ee.target))return;const le=ee.target;le.closest("mark[data-highlight-id]")||le.closest(".transcript-note-editor, .transcript-tag-picker, .transcript-speaker-editor")||(S(null),T(null),M(null))};return document.addEventListener("mousedown",ae),()=>document.removeEventListener("mousedown",ae)},[]),i?l.jsxs("div",{className:"flex items-center justify-center py-12",children:[l.jsx(nt,{size:20,className:"animate-spin text-gray-500"}),l.jsx("span",{className:"ml-2 text-sm text-gray-500",children:"åŠ è½½å­—å¹•ä¸­..."})]}):n.length===0?l.jsx("div",{className:"flex items-center justify-center py-12",children:l.jsx("span",{className:"text-sm text-gray-500",children:"æš‚æ— å­—å¹•"})}):l.jsxs("div",{className:"relative flex flex-col h-full",ref:w,children:[l.jsx("div",{ref:v,className:"flex-1 overflow-y-auto px-6 py-4",onWheel:W,onMouseUp:P,children:n.map((ae,ee)=>{const le=ee===G,ie=ee<G,Q=YW(ee,ae.text,B),Z=ee>0?n[ee-1].speakerId:void 0,re=ae.speakerId!=null&&ae.speakerId!==Z;return l.jsxs("div",{ref:se=>H(ee,se),className:`
                flex gap-3 py-2 px-3 rounded-md cursor-pointer transition-colors duration-200
                hover:bg-white/5
                ${le?"bg-blue-500/10":""}
                ${re?"mt-3":""}
              `,children:[l.jsx("div",{className:"flex flex-col items-center shrink-0 w-1 mt-1.5",children:l.jsx("div",{className:`
                    w-[2px] h-full rounded-full transition-colors duration-200
                    ${le?"bg-blue-500 animate-pulse":ie?"bg-blue-500/40":"bg-white/10"}
                  `})}),l.jsx("span",{className:`
                  text-[11px] font-mono shrink-0 w-10 pt-1 tabular-nums
                  ${le?"text-blue-400":"text-gray-600"}
                `,onClick:se=>{se.stopPropagation(),V(ae.start)},children:XW(ae.start)}),l.jsxs("span",{"data-seg-idx":ee,className:`
                  text-[13px] leading-relaxed flex-1 select-text
                  ${le?"text-white font-medium":ie?"text-gray-500":"text-gray-300"}
                `,onClick:se=>{const be=window.getSelection();be&&!be.isCollapsed||se.target.closest("mark[data-highlight-id]")||V(ae.start)},children:[re&&l.jsxs("span",{className:"inline-flex items-center gap-1 text-[11px] font-bold text-blue-400/80 bg-blue-400/10 rounded px-1.5 py-0.5 mr-2 align-middle select-none cursor-pointer hover:bg-blue-400/20 transition-colors group uppercase tracking-tight",onClick:se=>{se.stopPropagation();const be=ae.speakerId??0;O({speakerId:be,name:d[String(be)]||""})},title:"ç‚¹å‡»ä¿®æ”¹è¯´è¯äººåç§°",children:[d[String(ae.speakerId??0)]||`Speaker ${(ae.speakerId??0)+1}`,l.jsx(YC,{size:10,className:"opacity-0 group-hover:opacity-60 transition-opacity"})]}),Q.map((se,be)=>se.highlightId?l.jsx("mark",{"data-highlight-id":se.highlightId,className:"rounded-sm cursor-pointer transition-colors",style:{backgroundColor:jD,color:"inherit",padding:"1px 0"},onMouseEnter:pe=>{pe.currentTarget.style.backgroundColor=KW},onMouseLeave:pe=>{pe.currentTarget.style.backgroundColor=jD},children:se.text},be):l.jsx("span",{children:se.text},be))]})]},ee)})}),!p&&l.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 z-10",children:l.jsxs("button",{onClick:J,className:"flex items-center gap-2 px-4 py-2 bg-[#1a1a1a] border border-white/10 rounded-full shadow-lg text-sm text-gray-300 hover:text-white hover:border-white/20 transition-colors cursor-pointer",children:[l.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500 animate-pulse"}),"è‡ªç”±æµè§ˆæ¨¡å¼ Â· ç‚¹å‡»å›žåˆ°å­—å¹•åŒæ­¥"]})}),E&&l.jsx("div",{ref:y,className:"fixed z-[9999] flex items-center gap-0.5 px-1.5 py-1 bg-[#2a2a2a] rounded-full shadow-xl border border-white/10",style:{left:E.x,top:E.y,transform:"translate(-50%, -100%)"},children:E.mode==="selection"?l.jsx("button",{onClick:Y,className:"w-7 h-7 flex items-center justify-center rounded-full bg-amber-500/20 hover:bg-amber-500/30 transition-colors cursor-pointer",title:"é«˜äº®",children:l.jsx(py,{className:"w-3.5 h-3.5 text-amber-400"})}):l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:()=>E.highlightId&&ge(E.highlightId),className:"w-7 h-7 flex items-center justify-center rounded-full bg-[#4a3a1a] hover:bg-[#5a4520] transition-colors cursor-pointer",title:"åˆ é™¤é«˜äº®",children:l.jsx(Vn,{className:"w-3.5 h-3.5 text-amber-400"})}),l.jsx("button",{onClick:()=>{if(E.highlightId){const ae=B.find(ee=>ee.id===E.highlightId);T({highlightId:E.highlightId,text:(ae==null?void 0:ae.note)||""}),S(null)}},className:"w-7 h-7 flex items-center justify-center rounded-full hover:bg-white/10 transition-colors cursor-pointer text-gray-400 hover:text-white",title:"æ·»åŠ ç¬”è®°",children:l.jsx(xR,{className:"w-3.5 h-3.5"})}),l.jsx("button",{onClick:()=>{E.highlightId&&(M(E.highlightId),S(null))},className:"w-7 h-7 flex items-center justify-center rounded-full hover:bg-white/10 transition-colors cursor-pointer text-gray-400 hover:text-white",title:"æ·»åŠ æ ‡ç­¾",children:l.jsx(sw,{className:"w-3.5 h-3.5"})})]})}),_&&l.jsxs("div",{className:"transcript-note-editor absolute z-[9999] bg-[#2a2a2a] rounded-lg shadow-xl border border-white/10 p-3 w-[280px]",style:{left:"50%",top:"50%",transform:"translate(-50%, -50%)"},children:[l.jsx("textarea",{autoFocus:!0,value:_.text,onChange:ae=>T({..._,text:ae.target.value}),onKeyDown:ae=>{ae.key==="Enter"&&!ae.shiftKey&&(ae.preventDefault(),o==null||o(_.highlightId,_.text),T(null)),ae.key==="Escape"&&T(null)},className:"w-full text-[13px] text-gray-300 bg-white/5 border border-white/10 rounded px-2 py-1.5 resize-none outline-none focus:border-blue-500/50",rows:3,placeholder:"æ·»åŠ ç¬”è®°â€¦"}),l.jsxs("div",{className:"flex justify-end gap-2 mt-2",children:[l.jsx("button",{onClick:()=>T(null),className:"px-2 py-1 text-xs text-gray-400 hover:text-white transition-colors cursor-pointer",children:"å–æ¶ˆ"}),l.jsx("button",{onClick:()=>{o==null||o(_.highlightId,_.text),T(null)},className:"px-2 py-1 text-xs text-blue-400 hover:text-blue-300 transition-colors cursor-pointer",children:"ä¿å­˜"})]})]}),j&&l.jsxs("div",{className:"transcript-tag-picker absolute z-[9999] bg-[#2a2a2a] rounded-lg shadow-xl border border-white/10 p-3 w-[280px]",style:{left:"50%",top:"50%",transform:"translate(-50%, -50%)"},children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("span",{className:"text-xs font-medium text-gray-400",children:"é«˜äº®æ ‡ç­¾"}),l.jsx("button",{onClick:()=>M(null),className:"p-0.5 rounded hover:bg-white/10 text-gray-500 hover:text-white transition-colors cursor-pointer",children:l.jsx(Vn,{className:"w-3 h-3"})})]}),l.jsx(ZW,{highlightId:j,currentTags:c[j]||[],onClose:()=>M(null)})]}),L&&l.jsxs("div",{className:"transcript-speaker-editor absolute z-[9999] bg-[#2a2a2a] rounded-lg shadow-xl border border-white/10 p-3 w-[260px]",style:{left:"50%",top:"50%",transform:"translate(-50%, -50%)"},children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsxs("span",{className:"text-xs font-medium text-gray-400",children:["ä¿®æ”¹è¯´è¯äºº ",L.speakerId+1," çš„åç§°"]}),l.jsx("button",{onClick:()=>O(null),className:"p-0.5 rounded hover:bg-white/10 text-gray-500 hover:text-white transition-colors cursor-pointer",children:l.jsx(Vn,{className:"w-3 h-3"})})]}),l.jsx("input",{autoFocus:!0,type:"text",value:L.name,onChange:ae=>O({...L,name:ae.target.value}),onKeyDown:ae=>{ae.key==="Enter"&&(ae.preventDefault(),f==null||f(L.speakerId,L.name),O(null)),ae.key==="Escape"&&O(null)},className:"w-full text-[13px] text-gray-300 bg-white/5 border border-white/10 rounded px-2 py-1.5 outline-none focus:border-teal-500/50",placeholder:`è¯´è¯äºº ${L.speakerId+1}`}),l.jsxs("div",{className:"flex justify-end gap-2 mt-2",children:[l.jsx("button",{onClick:()=>O(null),className:"px-2 py-1 text-xs text-gray-400 hover:text-white transition-colors cursor-pointer",children:"å–æ¶ˆ"}),l.jsx("button",{onClick:()=>{f==null||f(L.speakerId,L.name),O(null)},className:"px-2 py-1 text-xs text-teal-400 hover:text-teal-300 transition-colors cursor-pointer",children:"ä¿å­˜"})]})]}),l.jsx("style",{children:`
        .highlight-flash {
          animation: transcript-flash 1.5s ease;
        }
        @keyframes transcript-flash {
          0%, 100% { background-color: transparent; }
          25% { background-color: rgba(59,130,246,0.2); }
          50% { background-color: transparent; }
          75% { background-color: rgba(59,130,246,0.15); }
        }
      `})]})}function ZW({highlightId:n,currentTags:e,onClose:t}){const[i,s]=A.useState([]),[r,a]=A.useState(()=>new Set(e.map(c=>c.id)));A.useEffect(()=>{window.electronAPI.tagList().then(s)},[]);const o=async c=>{r.has(c)?(await window.electronAPI.highlightTagRemove(n,c),a(h=>{const d=new Set(h);return d.delete(c),d})):(await window.electronAPI.highlightTagAdd(n,c),a(h=>new Set(h).add(c)))};return l.jsxs("div",{className:"flex flex-col gap-1 max-h-[200px] overflow-y-auto",children:[i.map(c=>l.jsx("button",{onClick:()=>o(c.id),className:`
            text-left px-2 py-1 rounded text-xs transition-colors cursor-pointer
            ${r.has(c.id)?"bg-blue-500/20 text-blue-400":"text-gray-400 hover:bg-white/5 hover:text-gray-300"}
          `,children:c.name},c.id)),i.length===0&&l.jsx("span",{className:"text-[11px] text-gray-600 px-2 py-1",children:"æš‚æ— æ ‡ç­¾"})]})}function QW(n){if(!(n!=null&&n.startsWith("transcript:")))return null;const e=n.slice(11).split("-"),t=parseInt(e[0],10);return isNaN(t)?null:t}function JW(n){const e=n.asrTaskStatus==="pending"||n.asrTaskStatus==="running";return!n.transcriptLoading&&n.segmentsCount===0&&!e}const eY="åŽå°è½¬å†™ä¸­ï¼Œå¯é€€å‡ºé¡µé¢";function tY({articleId:n,onClose:e}){const[t,i]=A.useState(null),[s,r]=A.useState(!0),[a,o]=A.useState(!1),[c,h]=A.useState(null),[d,f]=A.useState([]),[p,g]=A.useState(!1),[v,b]=A.useState(null),[x,m]=A.useState(null),[y,w]=A.useState(0),[E,S]=A.useState(()=>localStorage.getItem("video-reader-detail-collapsed")==="true"),[_,T]=A.useState([]),[j,M]=A.useState({}),[L,O]=A.useState(null),B=A.useRef(0),G=A.useRef(null),W=A.useRef(null),J=A.useRef(0);A.useEffect(()=>{let pe=!1;return r(!0),window.electronAPI.articleGet(n).then(me=>{!pe&&me&&(i(me),me.duration&&(J.current=me.duration),r(!1))}).catch(()=>{pe||r(!1)}),()=>{pe=!0}},[n]),A.useEffect(()=>{let pe=!1,me=null;return(async()=>{if(!t){h(null),o(!1);return}if(t.videoId){h(null),o(!1);return}if(!t.url){h(null),o(!1);return}if(!t.url.startsWith("file://")){h(t.url),o(!1);return}o(!0);try{const ve=await window.electronAPI.articleReadLocalMedia(n);if(!ve){pe||h(null);return}me=URL.createObjectURL(new Blob([ve.data],{type:ve.mime||"video/mp4"})),pe||h(me)}catch(ve){console.error("è¯»å–æœ¬åœ°è§†é¢‘å¤±è´¥:",ve),pe||h(null)}finally{pe||o(!1)}})(),()=>{pe=!0,me&&URL.revokeObjectURL(me)}},[n,t==null?void 0:t.videoId,t==null?void 0:t.url]),A.useEffect(()=>{let pe=!1;return(async()=>{var Ne,ve;g(!0),f([]);try{const _e=await window.electronAPI.transcriptGet(n);if((Ne=_e==null?void 0:_e.segments)!=null&&Ne.length){pe||f(_e.segments);return}if(!(t!=null&&t.videoId))return;const We=await window.electronAPI.transcriptFetch(n);!pe&&((ve=We==null?void 0:We.segments)!=null&&ve.length)&&f(We.segments)}catch(_e){console.error("åŠ è½½å­—å¹•å¤±è´¥:",_e)}finally{pe||g(!1)}})(),()=>{pe=!0}},[n,t==null?void 0:t.videoId]),A.useEffect(()=>{let pe=!1;window.electronAPI.appTaskList().then(Ne=>{if(pe)return;const ve=Ne.find(_e=>_e.articleId===n&&_e.type==="asr-standard"&&(_e.status==="pending"||_e.status==="running"));b(ve??null)}).catch(Ne=>{console.error("åŠ è½½åŽå°è½¬å†™ä»»åŠ¡å¤±è´¥:",Ne)});const me=window.electronAPI.appTaskOnUpdated(Ne=>{Ne.articleId!==n||Ne.type!=="asr-standard"||(b(Ne),Ne.status==="completed"&&window.electronAPI.transcriptGet(n).then(ve=>{var _e;(_e=ve==null?void 0:ve.segments)!=null&&_e.length&&f(ve.segments)}).catch(ve=>{console.error("è¯»å–è½¬å†™ç»“æžœå¤±è´¥:",ve)}),Ne.status==="failed"&&m(Ne.error||"è½¬å†™å¤±è´¥"))});return()=>{pe=!0,me()}},[n]),A.useEffect(()=>{let pe=!1;return window.electronAPI.highlightList(n).then(me=>{if(!pe&&(T(me),me.length>0)){const Ne=me.map(ve=>ve.id);window.electronAPI.highlightTagsBatch(Ne).then(ve=>{pe||M(ve)})}}),()=>{pe=!0}},[n]);const V=A.useCallback(async pe=>{const me=await window.electronAPI.highlightCreate({articleId:n,text:pe.text,color:"yellow",paragraphIndex:pe.paragraphIndex,startOffset:pe.startOffset,endOffset:pe.endOffset,anchorPath:pe.anchorPath});T(Ne=>[...Ne,me])},[n]),H=A.useCallback(async pe=>{await window.electronAPI.highlightDelete(pe),T(me=>me.filter(Ne=>Ne.id!==pe)),M(me=>{const Ne={...me};return delete Ne[pe],Ne})},[]),P=A.useCallback(async(pe,me)=>{const Ne=await window.electronAPI.highlightUpdate({id:pe,note:me});T(ve=>ve.map(_e=>_e.id===pe?Ne:_e))},[]),Y=A.useCallback(pe=>{const me=_.find(ve=>ve.id===pe);if(!me)return;const Ne=QW(me.anchorPath);Ne!=null&&(B.current+=1,O(Ne+B.current*.001))},[_]),ge=A.useCallback(pe=>{w(pe),!W.current&&(W.current=setTimeout(()=>{W.current=null;const me=J.current;if(me>0){const Ne=Math.min(pe/me,1);window.electronAPI.articleUpdate({id:n,readProgress:Ne}).catch(console.error)}},1e4))},[n]),ae=A.useCallback(pe=>{J.current=pe,t&&!t.duration&&i(me=>me&&{...me,duration:pe})},[t]),ee=A.useCallback(pe=>{var me;(me=G.current)==null||me.seekTo(pe)},[]),le=A.useCallback(async()=>{m(null);try{const pe=await window.electronAPI.appTaskCreate({type:"asr-standard",articleId:n,title:`è½¬å†™: ${(t==null?void 0:t.title)||"è§†é¢‘"}`});b(pe)}catch(pe){console.error("åˆ›å»ºè§†é¢‘è½¬å†™ä»»åŠ¡å¤±è´¥:",pe),m(pe instanceof Error?pe.message:String(pe))}},[n,t==null?void 0:t.title]),ie=A.useCallback(()=>{const pe=J.current;if(pe>0&&y>0){const me=Math.min(y/pe,1);window.electronAPI.articleUpdate({id:n,readProgress:me}).catch(console.error)}W.current&&clearTimeout(W.current),e()},[n,y,e]),Q=A.useCallback(()=>{S(pe=>{const me=!pe;return localStorage.setItem("video-reader-detail-collapsed",String(me)),me})},[]);if(A.useEffect(()=>{const pe=me=>{me.key==="Escape"&&(me.preventDefault(),ie())};return document.addEventListener("keydown",pe),()=>document.removeEventListener("keydown",pe)},[ie]),s||!t||a)return l.jsx("div",{className:"flex items-center justify-center h-full bg-[#0f0f0f]",children:l.jsx(nt,{size:24,className:"animate-spin text-gray-500"})});const Z=L!=null?Math.floor(L):null,re=(v==null?void 0:v.status)??null,se=re==="pending"||re==="running",be=JW({transcriptLoading:p,segmentsCount:d.length,asrTaskStatus:re});return l.jsxs("div",{className:"flex flex-col h-full bg-[#0f0f0f]",children:[l.jsxs("div",{className:"flex items-center gap-3 px-4 py-2 border-b border-[#262626] shrink-0",children:[l.jsx("button",{onClick:ie,className:"p-1.5 rounded-md hover:bg-white/10 text-gray-400 hover:text-white transition-colors cursor-pointer",title:"è¿”å›ž",children:l.jsx(ng,{size:18})}),l.jsx("h1",{className:"text-sm font-medium text-gray-200 truncate flex-1",children:t.title}),l.jsx("button",{onClick:Q,className:"p-1.5 rounded-md hover:bg-white/10 text-gray-400 hover:text-white transition-colors cursor-pointer",title:E?"æ˜¾ç¤ºè¯¦æƒ…é¢æ¿":"éšè—è¯¦æƒ…é¢æ¿",children:E?l.jsx(tw,{size:18}):l.jsx(ew,{size:18})})]}),l.jsxs("div",{className:"flex flex-1 min-h-0",children:[l.jsxs("div",{className:"flex-1 flex flex-col min-w-0 overflow-hidden",children:[l.jsx("div",{className:"shrink-0 px-6 pt-4",children:l.jsx(GW,{ref:G,videoId:t.videoId??void 0,videoUrl:t.videoId?void 0:c??void 0,onTimeUpdate:ge,onDuration:ae})}),l.jsx("div",{className:"flex-1 min-h-0 mt-2",children:be?l.jsx("div",{className:"h-full flex items-center justify-center px-6",children:l.jsxs("div",{className:"w-full max-w-lg rounded-lg border border-white/10 bg-[#151515] p-5 text-center",children:[l.jsx("div",{className:"text-sm text-gray-300 mb-2",children:"æš‚æ— å¯ç”¨å­—å¹•"}),l.jsx("p",{className:"text-xs text-gray-500 mb-4",children:"ä½ å¯ä»¥ä½¿ç”¨è¯­éŸ³è¯†åˆ«ç”Ÿæˆå­—å¹•ï¼Œå®ŒæˆåŽä¼šæ˜¾ç¤ºåœ¨è¿™é‡Œã€‚"}),l.jsxs("button",{onClick:le,className:"inline-flex items-center gap-2 px-4 py-2 rounded-md bg-blue-600 hover:bg-blue-700 text-white text-sm transition-colors cursor-pointer",children:[l.jsx(ul,{size:16}),"å¼€å§‹è½¬å†™"]}),x&&l.jsx("div",{className:"mt-3 text-xs text-red-400",children:x})]})}):se&&d.length===0?l.jsxs("div",{className:"flex flex-col items-center justify-center py-12 gap-2 text-sm",children:[l.jsxs("div",{className:"flex items-center gap-2 text-gray-400",children:[l.jsx(nt,{size:18,className:"animate-spin"}),l.jsx("span",{children:"è§†é¢‘è½¬å†™ä¸­..."})]}),l.jsx("div",{className:"text-xs text-gray-500",children:eY})]}):l.jsx(NO,{segments:d,currentTime:y,onSegmentClick:ee,loading:p,highlights:_,onCreateHighlight:V,onDeleteHighlight:H,onUpdateHighlight:P,highlightTagsMap:j,scrollToSegment:Z})})]}),l.jsx(ZC,{articleId:n,collapsed:E,externalHighlights:_,onExternalDeleteHighlight:H,onHighlightClick:Y})]})]})}const W2=[.5,.75,1,1.25,1.5,1.75,2,2.5,3],Y2=15,X2=30;function RD(n){if(!isFinite(n)||n<0)return"0:00";const e=Math.floor(n/3600),t=Math.floor(n%3600/60),i=Math.floor(n%60);return e>0?`${e}:${String(t).padStart(2,"0")}:${String(i).padStart(2,"0")}`:`${t}:${String(i).padStart(2,"0")}`}const nY=A.forwardRef(function({audioUrl:e,title:t,showName:i,artworkUrl:s,initialTime:r,onTimeUpdate:a,onDuration:o,onEnded:c,onDownload:h,downloaded:d},f){const p=A.useRef(null),g=A.useRef(null),v=A.useRef(!1),[b,x]=A.useState(!1),[m,y]=A.useState(!0),[w,E]=A.useState(0),[S,_]=A.useState(0),[T,j]=A.useState(1),[M,L]=A.useState(1),[O,B]=A.useState(!1);A.useImperativeHandle(f,()=>({seekTo:Q=>{const Z=p.current;Z&&(Z.currentTime=Q)},play:()=>{var Q;(Q=p.current)==null||Q.play().catch(()=>{})},pause:()=>{var Q;(Q=p.current)==null||Q.pause()}}),[]);const G=A.useCallback(()=>{const Q=p.current;Q&&(y(!1),_(Q.duration),o==null||o(Q.duration),!v.current&&r&&r>0&&(Q.currentTime=r,v.current=!0))},[r,o]),W=A.useCallback(()=>{const Q=p.current;Q&&(E(Q.currentTime),a==null||a(Q.currentTime))},[a]),J=A.useCallback(()=>{x(!1),c==null||c()},[c]),V=A.useCallback(()=>{const Q=p.current;!Q||!Q.duration||(_(Q.duration),o==null||o(Q.duration))},[o]),H=A.useCallback(()=>{const Q=p.current;Q&&(Q.paused?Q.play().catch(()=>{}):Q.pause())},[]),P=A.useCallback(()=>{const Q=p.current;Q&&(Q.currentTime=Math.max(0,Q.currentTime-Y2))},[]),Y=A.useCallback(()=>{const Q=p.current;Q&&(Q.currentTime=Math.min(Q.duration,Q.currentTime+X2))},[]),ge=A.useCallback(()=>{j(Q=>{const Z=W2.indexOf(Q),re=W2[(Z+1)%W2.length];return p.current&&(p.current.playbackRate=re),re})},[]),ae=A.useCallback(()=>{const Q=p.current;Q&&(Q.muted=!Q.muted,B(Q.muted))},[]),ee=A.useCallback(Q=>{const Z=parseFloat(Q.target.value);L(Z),p.current&&(p.current.volume=Z,p.current.muted=Z===0,B(Z===0))},[]),le=A.useCallback(Q=>{const Z=g.current,re=p.current;if(!Z||!re||!S)return;const se=Z.getBoundingClientRect(),be=Math.max(0,Math.min(1,(Q.clientX-se.left)/se.width));re.currentTime=be*S},[S]);A.useEffect(()=>{const Q=p.current;if(!Q)return;const Z=()=>x(!0),re=()=>x(!1);return Q.addEventListener("play",Z),Q.addEventListener("pause",re),()=>{Q.removeEventListener("play",Z),Q.removeEventListener("pause",re)}},[]),A.useEffect(()=>{const Q=Z=>{const re=Z.target.tagName;re==="INPUT"||re==="TEXTAREA"||(Z.key===" "&&!Z.metaKey&&!Z.ctrlKey&&(Z.preventDefault(),H()),Z.key==="ArrowLeft"&&(Z.preventDefault(),P()),Z.key==="ArrowRight"&&(Z.preventDefault(),Y()))};return document.addEventListener("keydown",Q),()=>document.removeEventListener("keydown",Q)},[H,P,Y]);const ie=S>0?w/S*100:0;return l.jsxs("div",{className:"flex flex-col gap-3 bg-[#141414] rounded-lg p-4 border border-[#262626]",children:[l.jsx("audio",{ref:p,src:e,preload:"auto",onLoadedMetadata:G,onTimeUpdate:W,onEnded:J,onDurationChange:V,onCanPlay:()=>y(!1),onWaiting:()=>y(!0)}),(t||i)&&l.jsxs("div",{className:"flex items-center gap-3",children:[s&&l.jsx("img",{src:s,alt:"",className:"w-12 h-12 rounded-md object-cover shrink-0 border border-white/5"}),l.jsxs("div",{className:"flex-1 min-w-0",children:[t&&l.jsx("div",{className:"text-[13px] font-medium text-gray-200 truncate leading-snug",children:t}),i&&l.jsx("div",{className:"text-[11px] text-gray-500 truncate mt-0.5",children:i})]})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("span",{className:"text-[11px] text-gray-500 w-10 text-right tabular-nums shrink-0 font-mono",children:RD(w)}),l.jsx("div",{ref:g,className:"flex-1 h-1 bg-white/10 rounded-full cursor-pointer group relative",onClick:le,children:l.jsx("div",{className:"h-full bg-blue-500 rounded-full transition-[width] duration-100 relative",style:{width:`${ie}%`},children:l.jsx("div",{className:"absolute right-[-6px] top-1/2 -translate-y-1/2 w-3 h-3 bg-blue-400 rounded-full opacity-0 group-hover:opacity-100 transition-opacity shadow-lg"})})}),l.jsx("span",{className:"text-[11px] text-gray-500 w-10 tabular-nums shrink-0 font-mono",children:RD(S)})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-1 w-28 shrink-0",children:[l.jsxs("button",{onClick:ge,className:"px-2 py-1 text-[11px] font-bold text-gray-500 hover:text-gray-300 bg-white/5 hover:bg-white/10 rounded transition-colors cursor-pointer min-w-[36px] text-center",title:"æ’­æ”¾é€Ÿåº¦",children:[T,"x"]}),h&&l.jsx("button",{onClick:h,className:`p-1.5 rounded transition-colors cursor-pointer ${d?"text-green-500 hover:text-green-400":"text-gray-500 hover:text-gray-300 hover:bg-white/5"}`,title:d?"å·²ä¸‹è½½":"ä¸‹è½½",children:l.jsx(xa,{size:16})})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("button",{onClick:P,className:"p-1.5 text-gray-500 hover:text-gray-300 transition-colors cursor-pointer relative",title:`åŽé€€ ${Y2} ç§’`,children:[l.jsx(XC,{size:20}),l.jsx("span",{className:"absolute inset-0 flex items-center justify-center text-[8px] font-bold mt-[1px]",children:Y2})]}),l.jsx("button",{onClick:H,disabled:m&&!b,className:"w-10 h-10 flex items-center justify-center rounded-full bg-blue-600 text-white hover:bg-blue-500 disabled:bg-gray-700 disabled:text-gray-500 transition-colors cursor-pointer shadow-lg shadow-blue-900/20",title:b?"æš‚åœ":"æ’­æ”¾",children:m&&!b?l.jsx(nt,{size:20,className:"animate-spin"}):b?l.jsx(Z8,{size:20,fill:"currentColor"}):l.jsx(sU,{size:20,className:"ml-0.5",fill:"currentColor"})}),l.jsxs("button",{onClick:Y,className:"p-1.5 text-gray-500 hover:text-gray-300 transition-colors cursor-pointer relative",title:`å‰è¿› ${X2} ç§’`,children:[l.jsx(dU,{size:20}),l.jsx("span",{className:"absolute inset-0 flex items-center justify-center text-[8px] font-bold mt-[1px]",children:X2})]})]}),l.jsxs("div",{className:"flex items-center justify-end gap-2 w-28 shrink-0",children:[l.jsx("button",{onClick:ae,className:"p-1.5 text-gray-500 hover:text-gray-300 transition-colors cursor-pointer",title:O?"å–æ¶ˆé™éŸ³":"é™éŸ³",children:O||M===0?l.jsx(QU,{size:16}):l.jsx(KU,{size:16})}),l.jsx("div",{className:"flex items-center",children:l.jsx("input",{type:"range",min:"0",max:"1",step:"0.05",value:O?0:M,onChange:ee,className:"w-16 h-1 accent-blue-500 cursor-pointer opacity-60 hover:opacity-100 transition-opacity"})})]})]})]})}),_O=/^\s*(?:[-*â€¢]\s*)?(?:\[(\d{1,2}[:ï¼š]\d{2}(?:[:ï¼š]\d{2})?)\]|(\d{1,2}[:ï¼š]\d{2}(?:[:ï¼š]\d{2})?))(?:\s*[-â€“â€”:ï¼š]\s*|\s+)?(.*)$/,iY=/^\s*(?:[-*â€¢]\s*)?(?:\[(\d{1,2}[:ï¼š]\d{2}(?:[:ï¼š]\d{2})?)\]|(\d{1,2}[:ï¼š]\d{2}(?:[:ï¼š]\d{2})?))(?:\s*[-â€“â€”:ï¼š]\s*|\s+)?/;function kO(n){const t=n.replaceAll("ï¼š",":").split(":");if(t.length!==2&&t.length!==3)return null;const i=t.map(o=>Number(o));if(i.some(o=>!Number.isInteger(o)||o<0))return null;if(t.length===2){const[o,c]=i;return c>=60?null:o*60+c}const[s,r,a]=i;return r>=60||a>=60?null:s*3600+r*60+a}function sY(n){const e=n.match(_O);if(!e)return null;const t=e[1]??e[2];return t?kO(t):null}function TO(n){const e=n.match(_O);if(!e)return null;const t=e[1]??e[2];if(!t)return null;const i=kO(t);return i==null?null:{seconds:i,label:t.replaceAll("ï¼š",":"),content:(e[3]??"").trim()}}function rY(n){const t=n.ownerDocument.createTreeWalker(n,NodeFilter.SHOW_TEXT);let i=null;for(;t.nextNode();){const s=t.currentNode;if((s.nodeValue??"").trim().length!==0){i=s;break}}i&&(i.nodeValue=(i.nodeValue??"").replace(iY,""))}function aY(n){if(!n)return n;const t=new DOMParser().parseFromString(n,"text/html"),i="p, li, h1, h2, h3, h4, h5, h6",s=t.body.querySelectorAll(i);let r=0;for(const a of s){const o=(a.textContent??"").trim(),c=TO(o);!c||Array.from(a.querySelectorAll(i)).find(d=>sY((d.textContent??"").trim())!=null)||(rY(a),a.setAttribute("data-podcast-ts",String(c.seconds)),a.setAttribute("data-podcast-ts-label",c.label),a.setAttribute("data-podcast-ts-id",`podcast-ts-${r}`),a.classList.add("podcast-timestamp-line"),r+=1)}return t.body.innerHTML}function oY(n){return n?n.split(/\r?\n/).map(e=>{const t=TO(e);return t?{text:e,seconds:t.seconds,timestampLabel:t.label,content:t.content}:{text:e,seconds:null,timestampLabel:null,content:e}}):[]}function lY(n){if(!n)return[];const i=new DOMParser().parseFromString(n,"text/html").querySelectorAll("[data-podcast-ts]"),s=[];return i.forEach((r,a)=>{const o=Number(r.getAttribute("data-podcast-ts"));if(!Number.isFinite(o))return;const c=r.getAttribute("data-podcast-ts-label")??"",h=r.getAttribute("data-podcast-ts-id")??`podcast-ts-${a}`,d=(r.textContent??"").trim()||c;s.push({id:h,seconds:o,label:c,title:d})}),s}function cY(n){if(!(n!=null&&n.startsWith("transcript:")))return null;const e=n.slice(11).split("-"),t=parseInt(e[0],10);return isNaN(t)?null:t}function uY({articleId:n,onClose:e}){var Fe;const[t,i]=A.useState(null),[s,r]=A.useState(!0),[a,o]=A.useState(!1),[c,h]=A.useState(null),[d,f]=A.useState(null),[p,g]=A.useState(0),[v,b]=A.useState(()=>localStorage.getItem("podcast-reader-detail-collapsed")==="true"),[x,m]=A.useState(()=>localStorage.getItem("podcast-reader-outline-collapsed")==="true"),[y,w]=A.useState(!1),[E,S]=A.useState("about"),[_,T]=A.useState([]),[j,M]=A.useState({}),[L,O]=A.useState("loading"),[B,G]=A.useState([]),[W,J]=A.useState({}),[V,H]=A.useState({chunkIndex:0,totalChunks:1,overallProgress:0}),[P,Y]=A.useState(null),[ge,ae]=A.useState(null),[ee,le]=A.useState(!1),[ie,Q]=A.useState(null),Z=A.useRef(0),re=A.useRef(null),se=A.useRef(null),be=A.useRef(null),pe=A.useRef(0),me=A.useRef(0);me.current=B.length,A.useEffect(()=>{let F=!1;return r(!0),window.electronAPI.articleGet(n).then(async K=>{if(F||!K){F||r(!1);return}if(i(K),K.audioDuration?pe.current=K.audioDuration:K.duration&&(pe.current=K.duration),r(!1),K.feedId)try{const $=(await window.electronAPI.feedList()).find(fe=>fe.id===K.feedId);$!=null&&$.title&&!F&&f($.title)}catch{}try{(await window.electronAPI.downloadList()).find(fe=>fe.articleId===n&&fe.status==="ready")&&!F&&w(!0)}catch{}}).catch(()=>{F||r(!1)}),()=>{F=!0}},[n]),A.useEffect(()=>{let F=!1,K=null;return(async()=>{if(!(t!=null&&t.audioUrl)){h(null),o(!1);return}if(!t.audioUrl.startsWith("file://")){h(t.audioUrl),o(!1);return}o(!0);try{const $=await window.electronAPI.articleReadLocalMedia(n);if(!$){F||h(null);return}K=URL.createObjectURL(new Blob([$.data],{type:$.mime||"audio/mpeg"})),F||h(K)}catch($){console.error("è¯»å–æœ¬åœ°éŸ³é¢‘å¤±è´¥:",$),F||h(null)}finally{F||o(!1)}})(),()=>{F=!0,K&&URL.revokeObjectURL(K)}},[n,t==null?void 0:t.audioUrl]),A.useEffect(()=>{let F=!1;return window.electronAPI.highlightList(n).then(K=>{if(!F&&(T(K),K.length>0)){const C=K.map($=>$.id);window.electronAPI.highlightTagsBatch(C).then($=>{F||M($)})}}),()=>{F=!0}},[n]),A.useEffect(()=>{let F=!1;async function K(){try{const N=await window.electronAPI.transcriptGet(n);if(N&&N.segments.length>0&&!F){G(N.segments),N.speakerMap&&J(N.speakerMap),O("complete");return}}catch{}if(F)return;try{const oe=(await window.electronAPI.appTaskList()).find(xe=>xe.articleId===n&&xe.type==="asr-standard"&&(xe.status==="pending"||xe.status==="running"));if(oe&&!F){ae(oe),O("background-running");return}}catch{}if(F)return;let C;try{C=await window.electronAPI.settingsGet()}catch{F||O("not-configured");return}const $=C.asrProvider||"volcengine";if(!($==="volcengine"?!!(C.volcAsrAppKey&&C.volcAsrAccessKey):$==="tencent"?!!(C.tencentAsrAppId&&C.tencentAsrSecretId&&C.tencentAsrSecretKey):!1)){F||O("not-configured");return}try{(await window.electronAPI.downloadList()).find(xe=>xe.articleId===n&&xe.status==="ready")&&!F&&w(!0)}catch{}F||O("ready")}return K(),()=>{F=!0}},[n]),A.useEffect(()=>{const F=window.electronAPI.asrOnProgress(fe=>{fe.articleId===n&&H({chunkIndex:fe.chunkIndex,totalChunks:fe.totalChunks,overallProgress:fe.overallProgress})}),K=window.electronAPI.asrOnSegment(fe=>{fe.articleId===n&&G(fe.segments)}),C=window.electronAPI.asrOnComplete(fe=>{fe.articleId===n&&(G(fe.segments),O("complete"))}),$=window.electronAPI.asrOnError(fe=>{fe.articleId===n&&(Y(fe.error),me.current>0?O("complete"):O("ready"))});return()=>{F(),K(),C(),$()}},[n]),A.useEffect(()=>window.electronAPI.appTaskOnUpdated(K=>{K.articleId!==n||K.type!=="asr-standard"||(ae(K),K.status==="completed"?window.electronAPI.transcriptGet(n).then(C=>{C&&C.segments.length>0&&G(C.segments),O("complete")}).catch(()=>O("complete")):(K.status==="failed"||K.status==="cancelled")&&(O("ready"),K.error&&Y(K.error)))}),[n]);const Ne=A.useCallback(async()=>{Y(null),G([]),O("transcribing"),H({chunkIndex:0,totalChunks:1,overallProgress:0});try{await window.electronAPI.asrStart(n)}catch(F){console.error("ASR start failed:",F),Y(F instanceof Error?F.message:String(F)),O("ready")}},[n]),ve=A.useCallback(async()=>{Y(null);try{const F=await window.electronAPI.appTaskCreate({type:"asr-standard",articleId:n,title:`è½¬å†™: ${(t==null?void 0:t.title)||"æ’­å®¢"}`});ae(F),O("background-running")}catch(F){console.error("Background ASR start failed:",F),Y(F instanceof Error?F.message:String(F))}},[n,t==null?void 0:t.title]),_e=A.useCallback(async()=>{try{await window.electronAPI.asrCancel(n)}catch{}B.length>0?O("complete"):O("ready")},[n,B.length]),We=A.useCallback(()=>{confirm("é‡æ–°è½¬å†™å°†è¦†ç›–å½“å‰çš„è½¬å†™ç»“æžœï¼Œæ˜¯å¦ç»§ç»­ï¼Ÿ")&&Ne()},[Ne]),Ie=A.useCallback(F=>{g(F),!be.current&&(be.current=setTimeout(()=>{be.current=null;const K=pe.current;if(K>0){const C=Math.min(F/K,1),$={id:n,readProgress:C};C>=.9&&($.readStatus="seen"),window.electronAPI.articleUpdate($).catch(console.error)}},1e4))},[n]),Re=A.useCallback(F=>{pe.current=F,t&&!t.audioDuration&&!t.duration&&i(K=>K&&{...K,audioDuration:F,duration:F})},[t]),Ze=A.useCallback(()=>{window.electronAPI.articleUpdate({id:n,readProgress:1,readStatus:"seen"}).catch(console.error)},[n]),it=A.useCallback(async()=>{try{await window.electronAPI.downloadStart(n),O("downloading")}catch(F){console.error("Download failed:",F)}},[n]);A.useEffect(()=>{if(L!=="downloading")return;let F=!1;const K=async()=>{try{const fe=(await window.electronAPI.downloadList()).find(N=>N.articleId===n);if(F)return;(fe==null?void 0:fe.status)==="ready"?(w(!0),O("ready")):(fe==null?void 0:fe.status)==="failed"&&O("not-downloaded")}catch{}};K();const C=setInterval(K,2e3);return()=>{F=!0,clearInterval(C)}},[L,n]);const tt=A.useCallback(F=>{var K;(K=re.current)==null||K.seekTo(F)},[]),rt=A.useCallback(F=>{var fe;const K=F.target;if(!(K instanceof Element)||K.closest("a"))return;const C=K.closest("[data-podcast-ts]");if(!C)return;const $=Number(C.getAttribute("data-podcast-ts"));Number.isFinite($)&&((fe=re.current)==null||fe.seekTo($))},[]),at=A.useCallback(F=>{const K=se.current;if(!K)return!1;const C=K.querySelector(`[data-podcast-ts-id="${F}"]`);return C?(C.scrollIntoView({behavior:"smooth",block:"center"}),C.classList.add("podcast-timestamp-focus-flash"),window.setTimeout(()=>C.classList.remove("podcast-timestamp-focus-flash"),1200),!0):!1},[]),ze=A.useCallback(F=>{var K;(K=re.current)==null||K.seekTo(F.seconds),E==="about"&&at(F.id)},[E,at]),ft=A.useCallback(async F=>{const K=await window.electronAPI.highlightCreate({articleId:n,text:F.text,color:"yellow",paragraphIndex:F.paragraphIndex,startOffset:F.startOffset,endOffset:F.endOffset,anchorPath:F.anchorPath});T(C=>[...C,K])},[n]),Kt=A.useCallback(async F=>{await window.electronAPI.highlightDelete(F),T(K=>K.filter(C=>C.id!==F)),M(K=>{const C={...K};return delete C[F],C})},[]),he=A.useCallback(async(F,K)=>{const C=await window.electronAPI.highlightUpdate({id:F,note:K});T($=>$.map(fe=>fe.id===F?C:fe))},[]),X=A.useCallback(F=>{var $;const K=_.find(fe=>fe.id===F);if(!K)return;const C=cY(K.anchorPath);C!=null&&(Z.current+=1,Q(C+Z.current*.001),B[C]&&(($=re.current)==null||$.seekTo(B[C].start)))},[_,B]),je=A.useCallback(async()=>{if(!ee){le(!0);try{const F=await window.electronAPI.aiSummarize({articleId:n});i(K=>K&&{...K,summary:F.summary})}catch(F){console.error("[PodcastReader] AI æ‘˜è¦ç”Ÿæˆå¤±è´¥:",F)}finally{le(!1)}}},[n,ee]),qe=A.useCallback(()=>{const F=pe.current;if(F>0&&p>0){const K=Math.min(p/F,1),C={id:n,readProgress:K};K>=.9&&(C.readStatus="seen"),window.electronAPI.articleUpdate(C).catch(console.error)}be.current&&clearTimeout(be.current),e()},[n,p,e]),ke=A.useCallback(()=>{b(F=>{const K=!F;return localStorage.setItem("podcast-reader-detail-collapsed",String(K)),K})},[]);A.useEffect(()=>{const F=K=>{const C=K.target;if(!(C&&(C.tagName==="INPUT"||C.tagName==="TEXTAREA"||C.isContentEditable))){if(K.key==="Escape"){K.preventDefault(),qe();return}K.key==="["&&(K.preventDefault(),m($=>{const fe=!$;return localStorage.setItem("podcast-reader-outline-collapsed",String(fe)),fe})),K.key==="]"&&(K.preventDefault(),ke())}};return document.addEventListener("keydown",F),()=>document.removeEventListener("keydown",F)},[qe,ke]);const Xe=A.useMemo(()=>t!=null&&t.content?aY(t.content):null,[t==null?void 0:t.content]),ct=A.useMemo(()=>oY(t==null?void 0:t.contentText),[t==null?void 0:t.contentText]),Pe=A.useMemo(()=>{if(Xe)return lY(Xe);const F=[];return ct.forEach((K,C)=>{K.seconds!=null&&F.push({id:`podcast-text-ts-${C}`,seconds:K.seconds,label:K.timestampLabel??"",title:K.content||K.text||K.timestampLabel||`ç‰‡æ®µ ${F.length+1}`})}),F},[Xe,ct]),Qe=A.useMemo(()=>{for(let F=Pe.length-1;F>=0;F--)if(p>=Pe[F].seconds)return F;return-1},[Pe,p]),dt=l.jsxs("div",{className:`shrink-0 flex flex-col border-r border-[#262626] bg-[#141414] transition-all duration-200 overflow-hidden ${x||Pe.length===0?"w-0 border-r-0":"w-[220px]"}`,children:[l.jsxs("div",{className:"shrink-0 flex items-center justify-between px-4 h-12 border-b border-[#262626]",children:[l.jsx("button",{onClick:qe,className:"p-1.5 rounded hover:bg-white/10 transition-colors cursor-pointer text-gray-400 hover:text-white",title:"è¿”å›žåˆ—è¡¨",children:l.jsx(ng,{className:"w-4 h-4"})}),l.jsx("h2",{className:"text-[13px] font-semibold text-white tracking-wide",children:"æ—¶é—´è½´"}),l.jsx("div",{className:"w-6"})]}),l.jsx("div",{className:"flex-1 overflow-y-auto p-2",children:Pe.length>0?l.jsx("ul",{className:"space-y-0.5",children:Pe.map((F,K)=>l.jsx("li",{children:l.jsxs("button",{type:"button",onClick:()=>ze(F),className:`w-full flex items-start gap-2 text-left rounded-md px-3 py-2 transition-colors cursor-pointer ${K===Qe?"bg-blue-500/15 border border-blue-500/35":"border border-transparent hover:bg-white/5"}`,children:[l.jsx("span",{className:"text-[11px] font-mono text-blue-300 tabular-nums shrink-0 mt-0.5 min-w-[42px]",children:F.label}),l.jsx("span",{className:"text-[13px] leading-5 text-gray-300 line-clamp-2",children:F.title})]})},F.id))}):l.jsx("div",{className:"px-3 py-4 text-[13px] text-gray-500",children:"æš‚æ— æ—¶é—´æˆ³"})})]});if(s||!t||a)return l.jsx("div",{className:"flex items-center justify-center h-full bg-[#0f0f0f]",children:l.jsx(nt,{size:24,className:"animate-spin text-gray-500"})});const z=c??((Fe=t.audioUrl)!=null&&Fe.startsWith("file://")?null:t.audioUrl);if(!z)return l.jsxs("div",{className:"flex flex-col items-center justify-center h-full bg-[#0f0f0f] gap-3",children:[l.jsx("div",{className:"text-gray-500 text-sm",children:"è¯¥é›†æ— å¯ç”¨éŸ³é¢‘"}),l.jsx("button",{onClick:qe,className:"px-4 py-2 text-sm text-gray-300 bg-white/10 hover:bg-white/15 rounded-md transition-colors cursor-pointer",children:"è¿”å›ž"})]});const Se=t.readProgress>0&&pe.current>0?t.readProgress*pe.current:t.readProgress>0&&t.audioDuration?t.readProgress*t.audioDuration:0,Te=ie!=null?Math.floor(ie):null;return l.jsxs("div",{className:"flex h-full bg-[#0f0f0f]",children:[dt,l.jsxs("div",{className:"flex-1 flex flex-col min-w-0 overflow-hidden",children:[l.jsxs("div",{className:"shrink-0 flex items-center justify-between px-6 h-12 border-b border-[#262626]",children:[l.jsxs("div",{className:"flex items-center gap-1.5 text-[12px] min-w-0 truncate",children:[(x||Pe.length===0)&&l.jsx("button",{onClick:qe,className:"p-1 rounded hover:bg-white/10 transition-colors cursor-pointer text-gray-400 hover:text-white shrink-0",title:"è¿”å›žåˆ—è¡¨",children:l.jsx(ng,{className:"w-4 h-4"})}),l.jsx("button",{onClick:()=>m(F=>{const K=!F;return localStorage.setItem("podcast-reader-outline-collapsed",String(K)),K}),className:"p-1 rounded hover:bg-white/10 transition-colors cursor-pointer text-gray-400 hover:text-white shrink-0",title:x?"å±•å¼€æ—¶é—´è½´ï¼ˆ[ï¼‰":"æ”¶èµ·æ—¶é—´è½´ï¼ˆ[ï¼‰",children:x?l.jsx(WC,{className:"w-4 h-4"}):l.jsx(J1,{className:"w-4 h-4"})}),d&&l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"text-gray-500 truncate",children:d}),l.jsx("span",{className:"text-gray-600",children:">"})]}),l.jsx("span",{className:"text-gray-400 truncate",children:t.title??"åŠ è½½ä¸­â€¦"})]}),l.jsx("div",{className:"flex items-center gap-1",children:l.jsx("button",{onClick:ke,className:"p-1.5 rounded hover:bg-white/10 transition-colors cursor-pointer text-gray-400 hover:text-white",title:v?"å±•å¼€è¯¦æƒ…ï¼ˆ]ï¼‰":"æ”¶èµ·è¯¦æƒ…ï¼ˆ]ï¼‰",children:v?l.jsx(tw,{className:"w-4 h-4"}):l.jsx(ew,{className:"w-4 h-4"})})})]}),l.jsx("div",{className:"shrink-0 px-6 pt-4",children:l.jsx(nY,{ref:re,audioUrl:z,title:t.title??void 0,showName:d??void 0,artworkUrl:t.thumbnail??void 0,initialTime:Se,onTimeUpdate:Ie,onDuration:Re,onEnded:Ze,onDownload:it,downloaded:y})}),l.jsxs("div",{className:"flex-1 min-h-0 flex flex-col mt-3",children:[l.jsx("div",{className:"shrink-0 flex items-center border-b border-white/5 px-6",children:l.jsx("div",{className:"flex",children:[{key:"about",label:"ç®€ä»‹",icon:l.jsx(El,{size:14})},{key:"summary",label:"æ‘˜è¦",icon:l.jsx(Jc,{size:14})},{key:"transcript",label:"è½¬å†™",icon:l.jsx(ul,{size:14})}].map(F=>l.jsxs("button",{onClick:()=>S(F.key),className:`flex items-center gap-1.5 px-4 py-2 text-xs font-medium border-b-2 transition-colors cursor-pointer ${E===F.key?"border-blue-500 text-white":"border-transparent text-gray-500 hover:text-gray-300"}`,children:[F.icon,F.label]},F.key))})}),E==="about"&&l.jsxs("div",{ref:se,className:"flex-1 min-h-0 overflow-y-auto px-6 pb-8 pt-4",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[d&&l.jsx("span",{className:"text-xs text-gray-500",children:d}),t.publishedAt&&l.jsxs(l.Fragment,{children:[d&&l.jsx("span",{className:"text-xs text-gray-600",children:"Â·"}),l.jsx("span",{className:"text-xs text-gray-500",children:new Date(t.publishedAt).toLocaleDateString()})]}),t.episodeNumber!=null&&l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"text-xs text-gray-600",children:"Â·"}),l.jsxs("span",{className:"text-xs text-gray-500",children:[t.seasonNumber!=null?`S${t.seasonNumber} `:"","E",t.episodeNumber]})]}),t.audioDuration!=null&&l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"text-xs text-gray-600",children:"Â·"}),l.jsx("span",{className:"text-xs text-gray-500",children:LD(t.audioDuration)})]})]}),t.content&&l.jsx("div",{className:`podcast-show-notes prose prose-invert prose-sm max-w-none text-gray-300
                        prose-headings:text-gray-200 prose-a:text-blue-400 prose-a:no-underline hover:prose-a:underline
                        prose-strong:text-gray-200 prose-code:text-gray-300 prose-code:bg-white/5 prose-code:rounded prose-code:px-1`,onClick:rt,dangerouslySetInnerHTML:{__html:Xe??""}}),!t.content&&ct.length>0&&l.jsx("div",{className:"text-sm text-gray-400 leading-relaxed",children:ct.map((F,K)=>F.seconds==null?l.jsx("div",{className:"whitespace-pre-wrap",children:F.text||"Â "},`${K}-${F.text.slice(0,24)}`):l.jsxs("button",{type:"button","data-podcast-ts-id":`podcast-text-ts-${K}`,onClick:()=>{var C;F.seconds!=null&&((C=re.current)==null||C.seekTo(F.seconds))},className:"podcast-text-timestamp-line w-full text-left",children:[l.jsx("span",{className:"podcast-text-timestamp-badge",children:F.timestampLabel??""}),l.jsx("span",{className:"podcast-text-timestamp-content whitespace-pre-wrap",children:F.content||F.text})]},`${K}-${F.text.slice(0,24)}`))})]}),E==="summary"&&l.jsx("div",{className:"flex-1 min-h-0 overflow-y-auto px-6 pb-8 pt-4",children:ee?l.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-gray-500",children:[l.jsx(nt,{size:32,className:"mb-3 animate-spin text-teal-400"}),l.jsx("p",{className:"text-sm",children:"æ­£åœ¨ç”Ÿæˆæ‘˜è¦..."}),l.jsx("p",{className:"text-xs mt-1 text-gray-600",children:"åŸºäºŽè½¬å†™å…¨æ–‡åˆ†æžä¸­"})]}):t.summary?l.jsxs("div",{children:[l.jsx("div",{className:"text-sm text-gray-300 leading-relaxed whitespace-pre-wrap",children:t.summary}),l.jsx("div",{className:"mt-6 flex justify-end",children:l.jsxs("button",{onClick:je,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs text-gray-400 hover:text-gray-200 bg-white/5 hover:bg-white/10 rounded-md transition-colors cursor-pointer",children:[l.jsx(va,{size:12}),"é‡æ–°ç”Ÿæˆ"]})})]}):B.length>0?l.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-gray-500",children:[l.jsx(Jc,{size:32,className:"mb-3 opacity-40"}),l.jsx("p",{className:"text-sm mb-4",children:"å·²æœ‰è½¬å†™å†…å®¹ï¼Œå¯ç”Ÿæˆ AI æ‘˜è¦"}),l.jsxs("button",{onClick:je,className:"flex items-center gap-2 px-4 py-2 text-sm text-white bg-teal-600 hover:bg-teal-500 rounded-lg transition-colors cursor-pointer",children:[l.jsx(Jc,{size:14}),"åŸºäºŽè½¬å†™å†…å®¹ç”Ÿæˆæ‘˜è¦"]})]}):l.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-gray-500",children:[l.jsx(ul,{size:32,className:"mb-3 opacity-40"}),l.jsx("p",{className:"text-sm",children:"è¯·å…ˆå®Œæˆè½¬å†™åŽå†ç”Ÿæˆæ‘˜è¦"}),l.jsx("p",{className:"text-xs mt-1 text-gray-600",children:'åˆ‡æ¢åˆ°"è½¬å†™"æ ‡ç­¾å¼€å§‹è½¬å†™'})]})}),E==="transcript"&&l.jsxs("div",{className:"flex-1 min-h-0 flex flex-col",children:[L==="transcribing"&&l.jsxs("div",{className:"shrink-0 px-6 pt-3 pb-2",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(nt,{size:14,className:"animate-spin text-teal-400"}),l.jsxs("span",{className:"text-xs text-gray-400",children:[V.totalChunks>1?`åˆ†å— ${V.chunkIndex+1}/${V.totalChunks} Â· `:"",Math.round(V.overallProgress*100),"% å®Œæˆ"]})]}),l.jsxs("button",{onClick:_e,className:"flex items-center gap-1 px-2 py-1 text-xs text-gray-400 hover:text-red-400 transition-colors cursor-pointer",children:[l.jsx(ru,{size:12}),"å–æ¶ˆ"]})]}),l.jsx("div",{className:"w-full h-1 bg-white/5 rounded-full overflow-hidden",children:l.jsx("div",{className:"h-full bg-teal-500 rounded-full transition-all duration-300",style:{width:`${V.overallProgress*100}%`}})})]}),L==="complete"&&l.jsx("div",{className:"shrink-0 px-6 pt-3 pb-1 flex justify-end",children:l.jsxs("button",{onClick:We,className:"flex items-center gap-1 px-2 py-1 text-[11px] text-gray-500 hover:text-gray-300 transition-colors cursor-pointer",children:[l.jsx(va,{size:11}),"é‡æ–°è½¬å†™"]})}),P&&l.jsx("div",{className:"shrink-0 mx-6 mt-2 px-3 py-2 bg-red-500/10 border border-red-500/20 rounded-md",children:l.jsx("p",{className:"text-xs text-red-400",children:P})}),L==="complete"||L==="transcribing"&&B.length>0?l.jsx("div",{className:"flex-1 min-h-0",children:l.jsx(NO,{segments:B,currentTime:p,onSegmentClick:tt,highlights:_,onCreateHighlight:ft,onDeleteHighlight:Kt,onUpdateHighlight:he,highlightTagsMap:j,scrollToSegment:Te,speakerMap:W,onSpeakerRename:async(F,K)=>{await window.electronAPI.transcriptUpdateSpeaker(n,F,K),J(C=>{const $={...C};return K.trim()?$[String(F)]=K.trim():delete $[String(F)],$})}})}):l.jsxs("div",{className:"flex-1 min-h-0 flex items-center justify-center",children:[L==="loading"&&l.jsxs("div",{className:"flex flex-col items-center gap-3 text-gray-500",children:[l.jsx(nt,{size:24,className:"animate-spin"}),l.jsx("p",{className:"text-sm",children:"åŠ è½½ä¸­..."})]}),L==="not-configured"&&l.jsxs("div",{className:"flex flex-col items-center gap-3 text-gray-500 max-w-xs text-center",children:[l.jsx(iw,{size:32,className:"opacity-40"}),l.jsx("p",{className:"text-sm",children:"éœ€è¦é…ç½®è¯­éŸ³è¯†åˆ«æœåŠ¡"}),l.jsx("p",{className:"text-xs text-gray-600",children:"è¯·åœ¨è®¾ç½®ä¸­é€‰æ‹©è¯­éŸ³è¯†åˆ«æœåŠ¡ï¼ˆç«å±±å¼•æ“Žæˆ–è…¾è®¯äº‘ï¼‰å¹¶é…ç½®å‡­æ®"})]}),L==="not-downloaded"&&l.jsxs("div",{className:"flex flex-col items-center gap-3 text-gray-500 max-w-xs text-center",children:[l.jsx(xa,{size:32,className:"opacity-40"}),l.jsx("p",{className:"text-sm",children:"è¯·å…ˆä¸‹è½½éŸ³é¢‘"}),l.jsx("p",{className:"text-xs text-gray-600 mb-2",children:"åŽå°è½¬å†™å°†è‡ªåŠ¨ä¸‹è½½éŸ³é¢‘å¹¶åœ¨åŽå°å®Œæˆ"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("button",{onClick:ve,className:"flex items-center gap-1.5 px-4 py-2 bg-teal-600 hover:bg-teal-700 text-white text-sm rounded-md transition-colors cursor-pointer",children:[l.jsx(jm,{size:14}),"åŽå°è½¬å†™"]}),l.jsxs("button",{onClick:it,className:"flex items-center gap-1.5 px-3 py-2 bg-white/10 hover:bg-white/15 text-gray-300 text-sm rounded-md transition-colors cursor-pointer",children:[l.jsx(xa,{size:14}),"ä¸‹è½½éŸ³é¢‘"]})]})]}),L==="downloading"&&l.jsxs("div",{className:"flex flex-col items-center gap-3 text-gray-500 max-w-xs text-center",children:[l.jsx(nt,{size:32,className:"animate-spin text-teal-400"}),l.jsx("p",{className:"text-sm",children:"æ­£åœ¨ä¸‹è½½éŸ³é¢‘..."}),l.jsx("p",{className:"text-xs text-gray-600",children:"ä¸‹è½½å®ŒæˆåŽå¯ä½¿ç”¨å®žæ—¶è½¬å†™"})]}),L==="ready"&&l.jsxs("div",{className:"flex flex-col items-center gap-3 text-gray-500 max-w-xs text-center",children:[l.jsx(ul,{size:32,className:"opacity-40"}),l.jsx("p",{className:"text-sm",children:"éŸ³é¢‘è½¬å†™ä¸ºæ–‡å­—"}),t.audioDuration!=null&&l.jsxs("p",{className:"text-xs text-gray-600",children:["éŸ³é¢‘æ—¶é•¿ ",LD(t.audioDuration)]}),l.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[l.jsxs("button",{onClick:ve,className:"flex items-center gap-1.5 px-4 py-2 bg-teal-600 hover:bg-teal-700 text-white text-sm rounded-md transition-colors cursor-pointer",children:[l.jsx(jm,{size:14}),"åŽå°è½¬å†™"]}),y&&l.jsxs("button",{onClick:Ne,className:"flex items-center gap-1.5 px-3 py-2 bg-white/10 hover:bg-white/15 text-gray-300 text-sm rounded-md transition-colors cursor-pointer",children:[l.jsx(ul,{size:14}),"å®žæ—¶è½¬å†™"]})]}),l.jsx("p",{className:"text-[11px] text-gray-600 mt-1",children:y?"åŽå°è½¬å†™é€Ÿåº¦æ›´å¿«ï¼Œå®žæ—¶è½¬å†™å¯è¾¹è½¬è¾¹çœ‹":"åŽå°è½¬å†™å°†è‡ªåŠ¨ä¸‹è½½éŸ³é¢‘ï¼Œå¯ç¦»å¼€é¡µé¢ç­‰å¾…å®Œæˆ"})]}),L==="background-running"&&l.jsxs("div",{className:"flex flex-col items-center gap-3 text-gray-500 max-w-xs text-center",children:[l.jsx(jm,{size:32,className:"text-teal-400 opacity-70"}),l.jsx("p",{className:"text-sm text-gray-300",children:"åŽå°è½¬å†™è¿›è¡Œä¸­"}),ge&&l.jsxs(l.Fragment,{children:[ge.progress>0&&l.jsx("div",{className:"w-48 h-1 bg-white/5 rounded-full overflow-hidden",children:l.jsx("div",{className:"h-full bg-teal-500 rounded-full transition-all duration-500",style:{width:`${Math.round(ge.progress*100)}%`}})}),l.jsx("p",{className:"text-xs text-gray-500",children:ge.detail||"ç­‰å¾…å¤„ç†..."})]}),l.jsx("p",{className:"text-[11px] text-gray-600 mt-1",children:"å¯ç¦»å¼€æ­¤é¡µé¢ï¼Œå®ŒæˆåŽå°†æ”¶åˆ°é€šçŸ¥"})]}),L==="transcribing"&&B.length===0&&l.jsxs("div",{className:"flex flex-col items-center gap-3 text-gray-500",children:[l.jsx(nt,{size:24,className:"animate-spin text-teal-400"}),l.jsx("p",{className:"text-sm",children:"æ­£åœ¨å¤„ç†éŸ³é¢‘..."}),l.jsx("p",{className:"text-xs text-gray-600",children:"è½¬å†™ç»“æžœå°†å®žæ—¶æ˜¾ç¤º"})]})]})]})]})]}),l.jsx(ZC,{articleId:n,collapsed:v,externalHighlights:_,onExternalDeleteHighlight:Kt,onHighlightClick:X})]})}function LD(n){const e=Math.floor(n/3600),t=Math.floor(n%3600/60);return e>0?`${e}h ${t}m`:`${t}m`}function MD(n){if(n===null||n===0)return"0 B";const e=["B","KB","MB","GB"],t=Math.floor(Math.log(n)/Math.log(1024));return`${(n/Math.pow(1024,t)).toFixed(1)} ${e[t]}`}function hY(n){const e=new Date(n),i=new Date().getTime()-e.getTime(),s=Math.floor(i/(1e3*60*60*24));return s===0?"Today":s===1?"Yesterday":s<7?`${s} days ago`:e.toLocaleDateString("en-US",{month:"short",day:"numeric"})}const OD={queued:{icon:l.jsx(xa,{size:14}),label:"Queued",color:"text-gray-400"},downloading:{icon:l.jsx(nt,{size:14,className:"animate-spin"}),label:"Downloading",color:"text-blue-400"},ready:{icon:l.jsx(Xh,{size:14}),label:"Ready",color:"text-green-400"},failed:{icon:l.jsx(ru,{size:14}),label:"Failed",color:"text-red-400"}};function dY({open:n,onClose:e}){const{t}=Bi(),[i,s]=A.useState([]),[r,a]=A.useState(!1),o=A.useCallback(async()=>{a(!0);try{const f=await window.electronAPI.downloadList();s(f)}catch(f){console.error("Failed to load downloads:",f)}finally{a(!1)}},[]);A.useEffect(()=>{n&&o()},[n,o]),A.useEffect(()=>{if(!n||!i.some(g=>g.status==="queued"||g.status==="downloading"))return;const p=setInterval(o,3e3);return()=>clearInterval(p)},[n,i,o]),A.useEffect(()=>{if(!n)return;const f=p=>{p.key==="Escape"&&(p.stopImmediatePropagation(),e())};return document.addEventListener("keydown",f),()=>document.removeEventListener("keydown",f)},[n,e]);const c=async f=>{try{await window.electronAPI.downloadCancel(f),o()}catch(p){console.error("Failed to cancel download:",p)}},h=async f=>{try{await window.electronAPI.downloadStart(f.articleId),o()}catch(p){console.error("Failed to retry download:",p)}};if(!n)return null;const d=i.filter(f=>f.status==="ready").reduce((f,p)=>f+(p.bytes||0),0);return l.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[l.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:e}),l.jsxs("div",{className:"relative w-full max-w-lg bg-[#1a1a1a] border border-white/10 rounded-lg shadow-2xl",children:[l.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-white/10",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("h2",{className:"text-lg font-semibold text-white",children:t("downloads.title")}),l.jsxs("span",{className:"flex items-center gap-1.5 text-xs text-gray-500",children:[l.jsx(hR,{size:12}),MD(d)]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:()=>window.electronAPI.downloadOpenDir(),className:"p-1 rounded hover:bg-white/10 text-gray-400 hover:text-white transition-colors",title:"åœ¨ Finder ä¸­æ‰“å¼€ä¸‹è½½ç›®å½•",children:l.jsx(cR,{size:16})}),l.jsx("button",{onClick:o,className:"p-1 rounded hover:bg-white/10 text-gray-400 hover:text-white transition-colors",title:"åˆ·æ–°",children:l.jsx(va,{size:16,className:r?"animate-spin":""})}),l.jsx("button",{onClick:e,className:"p-1 rounded hover:bg-white/10 text-gray-400 hover:text-white transition-colors",children:l.jsx(Vn,{size:20})})]})]}),l.jsx("div",{className:"max-h-[400px] overflow-y-auto",children:i.length===0?l.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-gray-500",children:[l.jsx(xa,{size:32,className:"mb-3 opacity-50"}),l.jsx("p",{className:"text-sm",children:t("downloads.noDownloads")}),l.jsx("p",{className:"text-xs mt-1",children:"Click download in podcast player to start offline caching"})]}):l.jsx("div",{className:"divide-y divide-white/5",children:i.map(f=>{const p=OD[f.status]||OD.queued;return l.jsxs("div",{className:"flex items-center gap-3 px-6 py-3 hover:bg-white/[0.03] transition-colors",children:[l.jsx("span",{className:`shrink-0 ${p.color}`,children:p.icon}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("p",{className:"text-sm text-gray-200 truncate",children:f.articleId}),l.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mt-0.5",children:[l.jsx("span",{className:p.color,children:p.label}),f.bytes&&l.jsx("span",{children:MD(f.bytes)}),l.jsx("span",{children:hY(f.addedAt)})]})]}),l.jsxs("div",{className:"shrink-0 flex items-center gap-1",children:[(f.status==="queued"||f.status==="downloading")&&l.jsx("button",{onClick:()=>c(f.id),className:"p-1.5 rounded hover:bg-white/10 text-gray-400 hover:text-red-400 transition-colors",title:"å–æ¶ˆä¸‹è½½",children:l.jsx(ru,{size:14})}),f.status==="failed"&&l.jsx("button",{onClick:()=>h(f),className:"p-1.5 rounded hover:bg-white/10 text-gray-400 hover:text-blue-400 transition-colors",title:"é‡è¯•",children:l.jsx(va,{size:14})}),f.status==="ready"&&l.jsx("button",{onClick:()=>c(f.id),className:"p-1.5 rounded hover:bg-white/10 text-gray-400 hover:text-red-400 transition-colors",title:"åˆ é™¤ä¸‹è½½",children:l.jsx(Wi,{size:14})})]})]},f.id)})})})]})]})}function PD(n){return n<1e3?`${n}ms`:`${(n/1e3).toFixed(1)}s`}function $E(n){if(!n)return null;try{return JSON.parse(n)}catch{return null}}const ID={summarize:"text-blue-400 bg-blue-900/30",translate:"text-green-400 bg-green-900/30",auto_tag:"text-yellow-400 bg-yellow-900/30",extract_topics:"text-purple-400 bg-purple-900/30",chat:"text-cyan-400 bg-cyan-900/30"},fY={llm_call:"text-blue-400 bg-blue-900/30",tool_call:"text-purple-400 bg-purple-900/30",error:"text-red-400 bg-red-900/30"},pY=["summarize","translate","auto_tag","extract_topics","chat"];function BD({data:n,label:e,maxLines:t=8}){const{t:i}=Bi(),[s,r]=A.useState(!1),[a,o]=A.useState(!1);if(n==null)return null;const c=typeof n=="string"?n:JSON.stringify(n,null,2),h=c.split(`
`),d=h.length>t,f=s||!d?c:h.slice(0,t).join(`
`)+`
...`,p=async()=>{await navigator.clipboard.writeText(c),o(!0),setTimeout(()=>o(!1),1500)};return l.jsxs("div",{className:"mt-2",children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsx("span",{className:"text-[11px] text-gray-500 font-medium",children:e}),l.jsx("button",{onClick:p,className:"flex items-center gap-1 text-[10px] text-gray-500 hover:text-gray-300 transition-colors cursor-pointer",children:a?l.jsxs(l.Fragment,{children:[l.jsx(yg,{className:"w-3 h-3 text-green-400"}),l.jsx("span",{className:"text-green-400",children:i("ai.copied")})]}):l.jsxs(l.Fragment,{children:[l.jsx(bg,{className:"w-3 h-3"}),l.jsx("span",{children:i("ai.copyJson")})]})})]}),l.jsx("pre",{className:"text-[11px] leading-[1.5] bg-black/30 border border-white/5 rounded-md p-2 overflow-x-auto text-gray-400 max-h-64 overflow-y-auto",children:f}),d&&l.jsx("button",{onClick:()=>r(!s),className:"mt-1 text-[10px] text-blue-400 hover:text-blue-300 cursor-pointer",children:s?i("ai.collapse"):`${i("ai.viewDetails")} (${h.length} lines)`})]})}function gY({tracesJson:n}){const{t:e}=Bi(),t=$E(n);return!t||!t.steps||t.steps.length===0?l.jsx("p",{className:"text-[11px] text-gray-600 italic mt-2",children:e("ai.noTraces")}):l.jsxs("div",{className:"mt-2 space-y-1.5",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsxs("span",{className:"text-[11px] text-gray-500 font-medium",children:[e("ai.traceDetails")," (",t.steps.length," ",e("ai.steps"),")"]}),t.totalDurationMs!=null&&l.jsx("span",{className:"text-[10px] text-gray-600",children:PD(t.totalDurationMs)})]}),t.steps.map((i,s)=>l.jsxs("div",{className:"bg-black/20 border border-white/5 rounded-md p-2",children:[l.jsxs("div",{className:"flex items-center gap-2 text-[11px]",children:[l.jsx("span",{className:"shrink-0 text-gray-500 w-4",children:s+1}),l.jsx("span",{className:`shrink-0 px-1.5 py-0.5 rounded text-[10px] font-medium ${fY[i.type]||"text-gray-400 bg-gray-800"}`,children:i.type}),l.jsx("span",{className:"text-gray-500",children:PD(i.durationMs)}),l.jsxs("span",{className:"text-gray-500",children:[i.tokenCount," tokens"]})]}),i.error&&l.jsxs("div",{className:"mt-1 flex items-center gap-1 text-[11px] text-red-400",children:[l.jsx(vg,{className:"w-3 h-3"}),l.jsx("span",{children:i.error})]}),i.input&&l.jsx("div",{className:"mt-1",children:l.jsx("pre",{className:"text-[10px] leading-[1.4] text-gray-500 overflow-x-auto max-h-20 overflow-y-auto",children:i.input.length>300?i.input.slice(0,300)+"...":i.input})}),i.output&&l.jsx("div",{className:"mt-1 border-t border-white/5 pt-1",children:l.jsx("pre",{className:"text-[10px] leading-[1.4] text-gray-400 overflow-x-auto max-h-20 overflow-y-auto",children:i.output.length>300?i.output.slice(0,300)+"...":i.output})})]},s))]})}function mY({logId:n}){const{t:e}=Bi(),[t,i]=A.useState(null),[s,r]=A.useState(!0);if(A.useEffect(()=>{r(!0),window.electronAPI.aiTaskLogDetail(n).then(c=>i(c)).catch(()=>i(null)).finally(()=>r(!1))},[n]),s)return l.jsxs("div",{className:"flex items-center gap-2 py-3 text-gray-500",children:[l.jsx(nt,{className:"w-3.5 h-3.5 animate-spin"}),l.jsx("span",{className:"text-[11px]",children:e("ai.generating")})]});if(!t)return l.jsx("p",{className:"text-[11px] text-gray-600 py-2",children:e("ai.noTraces")});const a=$E(t.inputJson),o=$E(t.outputJson);return l.jsxs("div",{className:"pt-2 pb-1 border-t border-white/5",children:[t.errorText&&l.jsxs("div",{className:"flex items-center gap-1.5 mb-2 px-2 py-1.5 bg-red-900/20 border border-red-500/20 rounded-md",children:[l.jsx(vg,{className:"w-3.5 h-3.5 text-red-400 shrink-0"}),l.jsx("span",{className:"text-[11px] text-red-400",children:t.errorText})]}),a!=null?l.jsx(BD,{data:a,label:e("ai.input")}):null,o!=null?l.jsx(BD,{data:o,label:e("ai.output")}):null,l.jsx(gY,{tracesJson:t.tracesJson})]})}function xY(){const{t:n}=Bi(),[e,t]=A.useState([]),[i,s]=A.useState(!0),[r,a]=A.useState(null),[o,c]=A.useState("all");A.useEffect(()=>{s(!0),window.electronAPI.aiTaskLogs(50).then(v=>t(v)).catch(()=>t([])).finally(()=>s(!1))},[]);const h=A.useMemo(()=>{const v=e.length,b=e.reduce((m,y)=>m+y.tokenCount,0),x=e.reduce((m,y)=>m+y.costUsd,0);return{totalCalls:v,totalTokens:b,totalCost:x}},[e]),d=A.useMemo(()=>{const v={};for(const b of e)v[b.taskType]||(v[b.taskType]={count:0,tokens:0}),v[b.taskType].count++,v[b.taskType].tokens+=b.tokenCount;return v},[e]),f=A.useMemo(()=>{const v=new Set(e.map(b=>b.taskType));return pY.filter(b=>v.has(b))},[e]),p=A.useMemo(()=>o==="all"?e:e.filter(v=>v.taskType===o),[e,o]),g=A.useCallback(v=>{a(b=>b===v?null:v)},[]);return i?l.jsx("div",{className:"flex items-center justify-center py-8",children:l.jsx(nt,{className:"w-5 h-5 animate-spin text-gray-500"})}):l.jsxs("section",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(bU,{size:16,className:"text-purple-400"}),l.jsx("h3",{className:"text-sm font-medium text-white",children:n("ai.debugPanel")})]}),l.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[l.jsxs("div",{className:"bg-[#111] border border-white/5 rounded-lg px-3 py-2.5",children:[l.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[l.jsx(dR,{className:"w-3 h-3 text-blue-400"}),l.jsx("span",{className:"text-[10px] text-gray-500",children:n("ai.totalCalls")})]}),l.jsx("p",{className:"text-lg font-semibold text-white",children:h.totalCalls})]}),l.jsxs("div",{className:"bg-[#111] border border-white/5 rounded-lg px-3 py-2.5",children:[l.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[l.jsx(t9,{className:"w-3 h-3 text-yellow-400"}),l.jsx("span",{className:"text-[10px] text-gray-500",children:n("ai.totalTokens")})]}),l.jsx("p",{className:"text-lg font-semibold text-white",children:h.totalTokens.toLocaleString()})]}),l.jsxs("div",{className:"bg-[#111] border border-white/5 rounded-lg px-3 py-2.5",children:[l.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[l.jsx(GF,{className:"w-3 h-3 text-green-400"}),l.jsx("span",{className:"text-[10px] text-gray-500",children:n("ai.totalCost")})]}),l.jsxs("p",{className:"text-lg font-semibold text-white",children:["$",h.totalCost.toFixed(4)]})]})]}),Object.keys(d).length>0&&l.jsx("div",{className:"flex flex-wrap gap-1.5",children:Object.entries(d).map(([v,b])=>l.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded text-[10px] font-medium ${ID[v]||"text-gray-400 bg-gray-800"}`,children:[v,l.jsxs("span",{className:"opacity-60",children:["x",b.count]}),l.jsxs("span",{className:"opacity-60",children:[b.tokens.toLocaleString(),"t"]})]},v))}),f.length>1&&l.jsxs("div",{className:"flex gap-1 overflow-x-auto pb-1",children:[l.jsx("button",{onClick:()=>c("all"),className:`shrink-0 px-2.5 py-1 rounded text-[11px] font-medium transition-colors cursor-pointer ${o==="all"?"bg-white/10 text-white":"text-gray-500 hover:text-gray-300 hover:bg-white/5"}`,children:n("ai.filterAll")}),f.map(v=>l.jsx("button",{onClick:()=>c(v),className:`shrink-0 px-2.5 py-1 rounded text-[11px] font-medium transition-colors cursor-pointer ${o===v?"bg-white/10 text-white":"text-gray-500 hover:text-gray-300 hover:bg-white/5"}`,children:v},v))]}),p.length===0?l.jsx("p",{className:"text-xs text-gray-500 py-4 text-center",children:n("ai.noLogs")}):l.jsx("div",{className:"space-y-1 max-h-80 overflow-y-auto",children:p.map(v=>{const b=r===v.id;return l.jsxs("div",{className:"bg-[#111] border border-white/5 rounded-md overflow-hidden",children:[l.jsxs("button",{onClick:()=>g(v.id),className:"w-full flex items-center justify-between px-3 py-2 text-xs hover:bg-white/[0.03] transition-colors cursor-pointer",children:[l.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[b?l.jsx(dy,{className:"w-3 h-3 text-gray-500 shrink-0"}):l.jsx(Q1,{className:"w-3 h-3 text-gray-500 shrink-0"}),l.jsx("span",{className:`shrink-0 px-1.5 py-0.5 rounded text-[10px] font-medium ${ID[v.taskType]||"text-gray-400 bg-gray-800"}`,children:v.taskType}),l.jsx("span",{className:`shrink-0 px-1.5 py-0.5 rounded text-[10px] font-medium ${v.status==="completed"?"bg-green-900/40 text-green-400":v.status==="failed"?"bg-red-900/40 text-red-400":"bg-yellow-900/40 text-yellow-400"}`,children:v.status})]}),l.jsxs("div",{className:"flex items-center gap-3 shrink-0 text-gray-500",children:[l.jsxs("span",{children:[v.tokenCount," tokens"]}),l.jsxs("span",{children:["$",v.costUsd.toFixed(4)]}),l.jsx("span",{children:new Date(v.createdAt).toLocaleString(void 0,{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]}),b&&l.jsx("div",{className:"px-3 pb-3",children:l.jsx(mY,{logId:v.id})})]},v.id)})})]})}const yY=[{id:"general"},{id:"content"},{id:"asr"},{id:"ai"},{id:"sync"}];function DN(n,e){if(n==="general")return[{id:"language"},{id:"reading"}];if(n==="content")return[{id:"podcast"},{id:"rsshub"},{id:"download"}];if(n==="asr"){const t=e.asrProvider||"volcengine";return[{id:"asr-provider"},{id:t==="tencent"?"asr-credentials-tencent":"asr-credentials-volcengine"}]}return n==="sync"?[{id:"sync-general"}]:[{id:"ai-models"},{id:"ai-prompts"},{id:"ai-debug"}]}function zD(n,e){return DN(n,e)[0].id}function vY(n,e,t){return DN(n,t).some(i=>i.id===e)}function bY(){return{containerClass:"w-[clamp(620px,74vw,860px)] max-w-[calc(100vw-32px)] max-h-[80vh]",bodyClass:"h-[clamp(380px,62vh,560px)]",sidebarClass:"w-40"}}const wY={general:"é€šç”¨",content:"å†…å®¹æº",asr:"è¯­éŸ³è¯†åˆ«",ai:"AI",sync:"åŒæ­¥"},SY={general:iw,content:nw,asr:ul,ai:VC,sync:jm},AY={language:"è¯­è¨€",reading:"é˜…è¯»",podcast:"æ’­å®¢è®¾ç½®",rsshub:"RSSHub",download:"ä¸‹è½½","asr-provider":"æœåŠ¡æä¾›å•†","asr-credentials-volcengine":"ç«å±±å¼•æ“Žå‡­æ®","asr-credentials-tencent":"è…¾è®¯äº‘å‡­æ®","ai-models":"æ¨¡åž‹ä¸Žå¯†é’¥","ai-prompts":"å¿«æ·æç¤ºè¯","ai-debug":"è°ƒè¯•é¢æ¿","sync-general":"iCloud åŒæ­¥"};function EY({open:n,onClose:e}){const{t}=Bi(),[i,s]=A.useState({}),[r,a]=A.useState(!1),[o,c]=A.useState(!1),[h,d]=A.useState(!1),[f,p]=A.useState("general"),[g,v]=A.useState("language"),[b,x]=A.useState({provider:"openrouter",apiKey:"",models:{fast:"",smart:"",cheap:""}}),[m,y]=A.useState(!1),[w,E]=A.useState(!1),[S,_]=A.useState(!1),[T,j]=A.useState([]),[M,L]=A.useState(!1),[O,B]=A.useState(!1),[G,W]=A.useState(""),[J,V]=A.useState(""),[H,P]=A.useState(!0),[Y,ge]=A.useState(null),[ae,ee]=A.useState(""),[le,ie]=A.useState(""),[Q,Z]=A.useState(null),[re,se]=A.useState(null),[be,pe]=A.useState(!1),{showToast:me}=Sa();A.useEffect(()=>{n&&(a(!0),d(!1),y(!1),_(!1),p("general"),v("language"),ge(null),ee(""),ie(""),W(""),V(""),P(!0),L(!0),Promise.all([window.electronAPI.settingsGet(),window.electronAPI.aiSettingsGet().catch(()=>null),window.electronAPI.aiPromptPresetList().catch(()=>[]),window.electronAPI.syncGetStatus().catch(()=>null)]).then(([C,$,fe,N])=>{s(C),$&&x($),j(fe),N&&se(N)}).catch(C=>console.error("Failed to load settings:",C)).finally(()=>{a(!1),L(!1)}))},[n]),A.useEffect(()=>{if(!n)return;const C=$=>{$.key==="Escape"&&($.stopImmediatePropagation(),e())};return document.addEventListener("keydown",C),()=>document.removeEventListener("keydown",C)},[n,e]),A.useEffect(()=>{n&&(vY(f,g,i)||v(zD(f,i)))},[n,f,g,i.asrProvider]);const Ne=DN(f,i),ve=bY(),_e=(C,$)=>{s(fe=>({...fe,[C]:$})),d(!0)},We=async()=>{c(!0);try{const C=await window.electronAPI.settingsSet(i);s(C),d(!1),me(t("preferences.settingsSaved"))}catch(C){console.error("Failed to save settings:",C),me(t("preferences.saveFailed"))}finally{c(!1)}},Ie=A.useCallback((C,$)=>{x(fe=>({...fe,[C]:$})),y(!0)},[]),Re=A.useCallback((C,$)=>{x(fe=>({...fe,models:{...fe.models,[C]:$}})),y(!0)},[]),Ze=async()=>{E(!0);try{await window.electronAPI.aiSettingsSet(b),y(!1),me(t("ai.saved"))}catch(C){console.error("Failed to save AI settings:",C),me(t("preferences.saveFailed"))}finally{E(!1)}},it=A.useCallback(async()=>{L(!0);try{const C=await window.electronAPI.aiPromptPresetList();j(C)}catch(C){console.error("Failed to load prompt presets:",C),me("åŠ è½½å¿«æ·æç¤ºè¯å¤±è´¥")}finally{L(!1)}},[me]),tt=A.useCallback(async C=>{await window.electronAPI.aiPromptPresetReorder(C.map(($,fe)=>({id:$.id,displayOrder:fe})))},[]),rt=A.useCallback(async()=>{const C=G.trim(),$=J.trim();if(!C||!$){me("è¯·å¡«å†™æ ‡é¢˜å’Œæç¤ºè¯å†…å®¹");return}B(!0);try{const fe=await window.electronAPI.aiPromptPresetCreate({title:C,prompt:$,enabled:H,targets:["chat"]}),N=[...T,fe];j(N),await tt(N),W(""),V(""),P(!0)}catch(fe){console.error("Failed to create prompt preset:",fe),me("åˆ›å»ºæç¤ºè¯å¤±è´¥"),await it()}finally{B(!1)}},[G,J,H,T,tt,it,me]),at=A.useCallback(async C=>{const $=T,fe=$.filter(N=>N.id!==C);j(fe);try{await window.electronAPI.aiPromptPresetDelete(C),await tt(fe)}catch(N){console.error("Failed to delete prompt preset:",N),me("åˆ é™¤æç¤ºè¯å¤±è´¥"),j($)}},[tt,T,me]),ze=A.useCallback(async(C,$)=>{const fe=T,N=fe.map(oe=>oe.id===C.id?{...oe,enabled:$}:oe);j(N);try{await window.electronAPI.aiPromptPresetUpdate({id:C.id,enabled:$})}catch(oe){console.error("Failed to toggle prompt preset:",oe),me("æ›´æ–°æç¤ºè¯å¤±è´¥"),j(fe)}},[T,me]),ft=A.useCallback(async(C,$,fe)=>{const N=fe?Array.from(new Set([...C.targets,$])):C.targets.filter(I=>I!==$);if(N.length===0){me("è‡³å°‘ä¿ç•™ä¸€ä¸ªç›®æ ‡åœºæ™¯");return}const oe=T,xe=oe.map(I=>I.id===C.id?{...I,targets:N}:I);j(xe);try{await window.electronAPI.aiPromptPresetUpdate({id:C.id,targets:N})}catch(I){console.error("Failed to update prompt preset targets:",I),me("æ›´æ–°ç›®æ ‡åœºæ™¯å¤±è´¥"),j(oe)}},[T,me]),Kt=A.useCallback(C=>{ge(C.id),ee(C.title),ie(C.prompt)},[]),he=A.useCallback(async()=>{if(!Y)return;const C=ae.trim(),$=le.trim();if(!C||!$){me("è¯·å¡«å†™æ ‡é¢˜å’Œæç¤ºè¯å†…å®¹");return}const fe=T,N=fe.map(oe=>oe.id===Y?{...oe,title:C,prompt:$}:oe);j(N);try{await window.electronAPI.aiPromptPresetUpdate({id:Y,title:C,prompt:$}),ge(null),ee(""),ie("")}catch(oe){console.error("Failed to save prompt preset:",oe),me("ä¿å­˜æç¤ºè¯å¤±è´¥"),j(fe)}},[le,Y,ae,T,me]),X=A.useCallback(async C=>{if(!Q||Q===C)return;const $=T,fe=$.findIndex(I=>I.id===Q),N=$.findIndex(I=>I.id===C);if(fe<0||N<0)return;const oe=[...$],[xe]=oe.splice(fe,1);oe.splice(N,0,xe),j(oe),Z(null);try{await tt(oe)}catch(I){console.error("Failed to reorder prompt presets:",I),me("æŽ’åºä¿å­˜å¤±è´¥"),j($)}},[Q,tt,T,me]),je=A.useCallback(async()=>{B(!0);try{const C=await window.electronAPI.aiPromptPresetResetBuiltins();j(C),me("é»˜è®¤æç¤ºè¯å·²è¡¥é½")}catch(C){console.error("Failed to reset built-in prompt presets:",C),me("æ¢å¤é»˜è®¤æç¤ºè¯å¤±è´¥")}finally{B(!1)}},[me]),qe=C=>{p(C),v(zD(C,i))},ke=()=>l.jsxs("section",{children:[l.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[l.jsx(ad,{size:16,className:"text-cyan-400"}),l.jsx("h3",{className:"text-sm font-medium text-white",children:"è¯­è¨€"})]}),l.jsx("div",{className:"space-y-4",children:l.jsxs("div",{children:[l.jsx("label",{htmlFor:"language-select",className:"block text-xs font-medium text-gray-400 mb-1.5",children:"é€‰æ‹©è¯­è¨€"}),l.jsx("select",{id:"language-select",value:i.language||"zh",onChange:C=>{const $=C.target.value;_e("language",$),lj($)},className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent",children:fI.map(C=>l.jsxs("option",{value:C.code,children:[C.nativeName," (",C.name,")"]},C.code))}),l.jsx("p",{className:"text-[11px] text-gray-600 mt-1",children:"æ›´æ”¹è¯­è¨€åŽï¼Œéƒ¨åˆ†ç•Œé¢å°†ç«‹å³æ›´æ–°ã€‚"})]})})]}),Xe=()=>l.jsxs("section",{children:[l.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[l.jsx(qr,{size:16,className:"text-green-400"}),l.jsx("h3",{className:"text-sm font-medium text-white",children:"é˜…è¯»"})]}),l.jsx("div",{className:"space-y-4",children:l.jsxs("div",{children:[l.jsx("label",{htmlFor:"reading-threshold",className:"block text-xs font-medium text-gray-400 mb-1.5",children:"çŸ­é˜…è¯» / é•¿é˜…è¯»åˆ†ç•Œæ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰"}),l.jsx("input",{id:"reading-threshold",type:"number",min:1,max:120,value:i.readingThreshold??10,onChange:C=>{const $=parseInt(C.target.value,10);!isNaN($)&&$>0&&_e("readingThreshold",$)},className:"w-32 px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent"}),l.jsx("p",{className:"text-[11px] text-gray-600 mt-1",children:"é˜…è¯»æ—¶é•¿ â‰¤ è¯¥å€¼ä¸ºçŸ­é˜…è¯»ï¼Œ> è¯¥å€¼ä¸ºé•¿é˜…è¯»ã€‚é»˜è®¤ 10 åˆ†é’Ÿã€‚"})]})})]}),ct=()=>l.jsxs("section",{children:[l.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[l.jsx(nw,{size:16,className:"text-blue-400"}),l.jsx("h3",{className:"text-sm font-medium text-white",children:"æ’­å®¢è®¾ç½®"})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"pi-key",className:"block text-xs font-medium text-gray-400 mb-1.5",children:"Podcast Index API Key"}),l.jsx("input",{id:"pi-key",type:"text",value:i.podcastIndexApiKey||"",onChange:C=>_e("podcastIndexApiKey",C.target.value||void 0),placeholder:"å¯é€‰ - å¯ç”¨ Podcast Index æœç´¢",className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"pi-secret",className:"block text-xs font-medium text-gray-400 mb-1.5",children:"Podcast Index API Secret"}),l.jsx("input",{id:"pi-secret",type:"password",value:i.podcastIndexApiSecret||"",onChange:C=>_e("podcastIndexApiSecret",C.target.value||void 0),placeholder:"å¯é€‰ - é…åˆ API Key ä½¿ç”¨",className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.jsxs("p",{className:"text-[11px] text-gray-600 leading-relaxed",children:["åœ¨ ",l.jsx("span",{className:"text-gray-400",children:"podcastindex.org"})," å…è´¹æ³¨å†Œå³å¯èŽ·å– API å¯†é’¥ï¼Œå¯ç”¨ Podcast Index ä½œä¸ºè¡¥å……æœç´¢æºã€‚"]})]})]}),Pe=()=>l.jsxs("section",{children:[l.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[l.jsx(GC,{size:16,className:"text-orange-400"}),l.jsx("h3",{className:"text-sm font-medium text-white",children:"RSSHub è®¾ç½®"})]}),l.jsx("div",{className:"space-y-4",children:l.jsxs("div",{children:[l.jsx("label",{htmlFor:"rsshub-url",className:"block text-xs font-medium text-gray-400 mb-1.5",children:"RSSHub å®žä¾‹åœ°å€"}),l.jsx("input",{id:"rsshub-url",type:"text",value:i.rsshubBaseUrl||"",onChange:C=>_e("rsshubBaseUrl",C.target.value||void 0),placeholder:"https://rsshub.example.com",className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),l.jsx("p",{className:"text-[11px] text-gray-600 mt-1",children:"é…ç½®è‡ªå»º RSSHub å®žä¾‹åœ°å€ï¼Œå¯ç”¨å‘çŽ°é¡µé¢çš„åˆ†ç±»æµè§ˆå’Œè·¯ç”±æœç´¢åŠŸèƒ½ã€‚"})]})})]}),Qe=()=>l.jsxs("section",{children:[l.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[l.jsx(hR,{size:16,className:"text-green-400"}),l.jsx("h3",{className:"text-sm font-medium text-white",children:"ä¸‹è½½è®¾ç½®"})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"dl-dir",className:"block text-xs font-medium text-gray-400 mb-1.5",children:"ä¸‹è½½ç›®å½•"}),l.jsx("input",{id:"dl-dir",type:"text",value:i.downloadDirectory||"",onChange:C=>_e("downloadDirectory",C.target.value||void 0),placeholder:"é»˜è®¤: åº”ç”¨æ•°æ®ç›®å½•/podcasts",className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"dl-cap",className:"block text-xs font-medium text-gray-400 mb-1.5",children:"å­˜å‚¨å®¹é‡é™åˆ¶ (MB)"}),l.jsx("input",{id:"dl-cap",type:"number",min:100,step:100,value:i.downloadCapacityMb??5120,onChange:C=>_e("downloadCapacityMb",parseInt(C.target.value,10)||5120),className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),l.jsx("p",{className:"text-[11px] text-gray-600 mt-1",children:"è¶…è¿‡é™åˆ¶æ—¶è‡ªåŠ¨æ¸…ç†æœ€æ—©çš„å·²ä¸‹è½½æ–‡ä»¶ã€‚é»˜è®¤ 5120 MB (5 GB)ã€‚"})]})]})]}),dt=()=>l.jsxs("section",{children:[l.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[l.jsx(ul,{size:16,className:"text-teal-400"}),l.jsx("h3",{className:"text-sm font-medium text-white",children:"è¯­éŸ³è¯†åˆ«æœåŠ¡"})]}),l.jsx("div",{className:"space-y-4",children:l.jsxs("div",{children:[l.jsx("label",{htmlFor:"asr-provider",className:"block text-xs font-medium text-gray-400 mb-1.5",children:"æœåŠ¡æä¾›å•†"}),l.jsxs("select",{id:"asr-provider",value:i.asrProvider||"volcengine",onChange:C=>_e("asrProvider",C.target.value),className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent",children:[l.jsx("option",{value:"volcengine",children:"ç«å±±å¼•æ“Ž"}),l.jsx("option",{value:"tencent",children:"è…¾è®¯äº‘"})]}),l.jsx("p",{className:"text-[11px] text-gray-600 mt-1",children:"åˆ‡æ¢åŽå°†è‡ªåŠ¨å±•ç¤ºå¯¹åº”æœåŠ¡çš„å‡­æ®é…ç½®ã€‚"})]})})]}),z=()=>l.jsx("section",{children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"volc-asr-app-key",className:"block text-xs font-medium text-gray-400 mb-1.5",children:"App Key"}),l.jsx("input",{id:"volc-asr-app-key",type:"text",value:i.volcAsrAppKey||"",onChange:C=>_e("volcAsrAppKey",C.target.value||void 0),placeholder:"æŽ§åˆ¶å°èŽ·å–çš„ APP ID",className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"volc-asr-access-key",className:"block text-xs font-medium text-gray-400 mb-1.5",children:"Access Token"}),l.jsx("input",{id:"volc-asr-access-key",type:"password",value:i.volcAsrAccessKey||"",onChange:C=>_e("volcAsrAccessKey",C.target.value||void 0),placeholder:"æŽ§åˆ¶å°èŽ·å–çš„ Access Token",className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent"})]}),l.jsxs("p",{className:"text-[11px] text-gray-600 leading-relaxed",children:["åœ¨ ",l.jsx("span",{className:"text-gray-400",children:"console.volcengine.com"})," å¼€é€šè±†åŒ…è¯­éŸ³è¯†åˆ«æœåŠ¡ï¼ŒèŽ·å– App Key å’Œ Access Tokenã€‚"]})]})}),Se=()=>l.jsx("section",{children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"tencent-asr-app-id",className:"block text-xs font-medium text-gray-400 mb-1.5",children:"AppID"}),l.jsx("input",{id:"tencent-asr-app-id",type:"text",value:i.tencentAsrAppId||"",onChange:C=>_e("tencentAsrAppId",C.target.value||void 0),placeholder:"è…¾è®¯äº‘è´¦å· AppID",className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"tencent-asr-secret-id",className:"block text-xs font-medium text-gray-400 mb-1.5",children:"SecretId"}),l.jsx("input",{id:"tencent-asr-secret-id",type:"text",value:i.tencentAsrSecretId||"",onChange:C=>_e("tencentAsrSecretId",C.target.value||void 0),placeholder:"API å¯†é’¥ SecretId",className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"tencent-asr-secret-key",className:"block text-xs font-medium text-gray-400 mb-1.5",children:"SecretKey"}),l.jsx("input",{id:"tencent-asr-secret-key",type:"password",value:i.tencentAsrSecretKey||"",onChange:C=>_e("tencentAsrSecretKey",C.target.value||void 0),placeholder:"API å¯†é’¥ SecretKey",className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent"})]}),l.jsxs("p",{className:"text-[11px] text-gray-600 leading-relaxed",children:["åœ¨ ",l.jsx("span",{className:"text-gray-400",children:"console.cloud.tencent.com"})," å¼€é€šè¯­éŸ³è¯†åˆ«æœåŠ¡ï¼ŒèŽ·å– AppID å’Œ API å¯†é’¥ã€‚ä½¿ç”¨æžé€Ÿç‰ˆå¼•æ“Žï¼Œè½¬å†™é€Ÿåº¦æžå¿«ã€‚"]})]})}),Te=()=>l.jsxs("section",{children:[l.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[l.jsx(VC,{size:16,className:"text-purple-400"}),l.jsx("h3",{className:"text-sm font-medium text-white",children:t("ai.settings")})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"ai-provider",className:"block text-xs font-medium text-gray-400 mb-1.5",children:t("ai.provider")}),l.jsxs("select",{id:"ai-provider",value:b.provider,onChange:C=>Ie("provider",C.target.value),className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[l.jsx("option",{value:"openrouter",children:"OpenRouter"}),l.jsx("option",{value:"minimax",children:"MiniMax"})]})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"ai-api-key",className:"block text-xs font-medium text-gray-400 mb-1.5",children:t("ai.apiKey")}),l.jsxs("div",{className:"relative",children:[l.jsx("input",{id:"ai-api-key",type:S?"text":"password",value:b.apiKey,onChange:C=>Ie("apiKey",C.target.value),placeholder:t("ai.apiKeyPlaceholder"),className:"w-full px-3 py-2 pr-10 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),l.jsx("button",{type:"button",onClick:()=>_(C=>!C),className:"absolute right-2 top-1/2 -translate-y-1/2 p-1 rounded hover:bg-white/10 text-gray-400 hover:text-white transition-colors",tabIndex:-1,children:S?l.jsx(ZF,{size:14}):l.jsx(lR,{size:14})})]})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"ai-model-fast",className:"block text-xs font-medium text-gray-400 mb-1.5",children:t("ai.modelFast")}),l.jsx("input",{id:"ai-model-fast",type:"text",value:b.models.fast,onChange:C=>Re("fast",C.target.value),placeholder:b.provider==="openrouter"?"google/gemini-flash-1.5":"abab6.5s-chat",className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"ai-model-smart",className:"block text-xs font-medium text-gray-400 mb-1.5",children:t("ai.modelSmart")}),l.jsx("input",{id:"ai-model-smart",type:"text",value:b.models.smart,onChange:C=>Re("smart",C.target.value),placeholder:b.provider==="openrouter"?"anthropic/claude-3.5-sonnet":"abab6.5-chat",className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"ai-model-cheap",className:"block text-xs font-medium text-gray-400 mb-1.5",children:t("ai.modelCheap")}),l.jsx("input",{id:"ai-model-cheap",type:"text",value:b.models.cheap,onChange:C=>Re("cheap",C.target.value),placeholder:b.provider==="openrouter"?"google/gemini-flash-1.5-8b":"abab5.5-chat",className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]})]}),Fe=()=>l.jsxs("section",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(so,{size:16,className:"text-purple-400"}),l.jsx("h3",{className:"text-sm font-medium text-white",children:"å¿«æ·æç¤ºè¯"})]}),l.jsxs("button",{onClick:je,disabled:O,className:"inline-flex items-center gap-1.5 px-2.5 py-1.5 text-[11px] rounded-md border border-white/10 bg-white/5 text-gray-300 hover:bg-white/10 hover:text-white disabled:opacity-60 disabled:cursor-not-allowed transition-colors",children:[l.jsx(XC,{size:12}),l.jsx("span",{children:"æ¢å¤é»˜è®¤æ¨¡æ¿"})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"rounded-md border border-white/10 bg-[#111] p-3 space-y-2",children:[l.jsx("div",{className:"text-xs text-gray-400 font-medium",children:"æ–°å»ºæç¤ºè¯"}),l.jsx("input",{type:"text",value:G,onChange:C=>W(C.target.value),placeholder:"æç¤ºè¯æ ‡é¢˜",className:"w-full px-3 py-2 bg-[#0a0a0a] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500"}),l.jsx("textarea",{value:J,onChange:C=>V(C.target.value),placeholder:"è¾“å…¥å®Œæ•´æç¤ºè¯å†…å®¹",rows:4,className:"w-full px-3 py-2 bg-[#0a0a0a] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500 resize-y"}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("label",{className:"inline-flex items-center gap-2 text-xs text-gray-300",children:[l.jsx("input",{type:"checkbox",checked:H,onChange:C=>P(C.target.checked),className:"accent-purple-500"}),"åœ¨ä¼šè¯ä¸­é»˜è®¤æ˜¾ç¤º"]}),l.jsxs("button",{onClick:rt,disabled:O,className:"inline-flex items-center gap-1.5 px-2.5 py-1.5 text-[11px] rounded-md bg-purple-600 text-white hover:bg-purple-700 disabled:opacity-60 disabled:cursor-not-allowed transition-colors",children:[l.jsx(ya,{size:12}),l.jsx("span",{children:"æ·»åŠ "})]})]})]}),M?l.jsx("div",{className:"flex items-center justify-center py-6",children:l.jsx(nt,{size:16,className:"animate-spin text-gray-500"})}):T.length===0?l.jsx("div",{className:"text-xs text-gray-500 py-4 text-center border border-dashed border-white/10 rounded-md",children:"æš‚æ— æç¤ºè¯ï¼Œå¯å…ˆåˆ›å»ºä¸€ä¸ªã€‚"}):l.jsx("div",{className:"space-y-2",children:T.map(C=>{const $=Y===C.id;return l.jsxs("div",{draggable:!0,onDragStart:()=>Z(C.id),onDragEnd:()=>Z(null),onDragOver:fe=>fe.preventDefault(),onDrop:()=>X(C.id),className:`rounded-md border p-3 transition-colors ${Q===C.id?"border-purple-400/60 bg-purple-500/5":"border-white/10 bg-[#111]"}`,children:[l.jsxs("div",{className:"flex items-start justify-between gap-2",children:[l.jsx("div",{className:"flex-1 min-w-0 space-y-2",children:$?l.jsxs(l.Fragment,{children:[l.jsx("input",{type:"text",value:ae,onChange:fe=>ee(fe.target.value),className:"w-full px-2.5 py-1.5 bg-[#0a0a0a] border border-white/10 rounded-md text-sm text-white focus:outline-none focus:ring-2 focus:ring-purple-500"}),l.jsx("textarea",{value:le,onChange:fe=>ie(fe.target.value),rows:4,className:"w-full px-2.5 py-1.5 bg-[#0a0a0a] border border-white/10 rounded-md text-sm text-white focus:outline-none focus:ring-2 focus:ring-purple-500 resize-y"})]}):l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"text-sm font-medium text-white",children:C.title}),l.jsx("div",{className:"text-xs text-gray-500 whitespace-pre-wrap",children:C.prompt})]})}),l.jsx("div",{className:"text-[10px] text-gray-600 whitespace-nowrap select-none",children:"æ‹–æ‹½æŽ’åº"})]}),l.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-3",children:[l.jsxs("label",{className:"inline-flex items-center gap-1.5 text-xs text-gray-300",children:[l.jsx("input",{type:"checkbox",checked:C.enabled,onChange:fe=>ze(C,fe.target.checked),className:"accent-purple-500"}),"æ˜¾ç¤º"]}),l.jsxs("label",{className:"inline-flex items-center gap-1.5 text-xs text-gray-300",children:[l.jsx("input",{type:"checkbox",checked:C.targets.includes("chat"),onChange:fe=>ft(C,"chat",fe.target.checked),className:"accent-purple-500"}),"ä¼šè¯åœºæ™¯"]}),C.isBuiltin&&l.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-blue-500/15 text-blue-300 border border-blue-500/30",children:"é»˜è®¤"}),l.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[$?l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:he,className:"text-xs px-2 py-1 rounded bg-purple-600 text-white hover:bg-purple-700 transition-colors",children:"ä¿å­˜"}),l.jsx("button",{onClick:()=>{ge(null),ee(""),ie("")},className:"text-xs px-2 py-1 rounded border border-white/10 text-gray-300 hover:bg-white/10 transition-colors",children:"å–æ¶ˆ"})]}):l.jsx("button",{onClick:()=>Kt(C),className:"text-xs px-2 py-1 rounded border border-white/10 text-gray-300 hover:bg-white/10 transition-colors",children:"ç¼–è¾‘"}),l.jsx("button",{onClick:()=>at(C.id),className:"text-xs px-2 py-1 rounded border border-red-400/40 text-red-300 hover:bg-red-500/15 transition-colors",children:"åˆ é™¤"})]})]})]},C.id)})})]})]}),F=()=>{const C=(re==null?void 0:re.icloudAvailable)??!1,$=(re==null?void 0:re.enabled)??!1;return l.jsxs("section",{children:[l.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[l.jsx(jm,{size:16,className:"text-blue-400"}),l.jsx("h3",{className:"text-sm font-medium text-white",children:"iCloud åŒæ­¥"})]}),l.jsxs("div",{className:"space-y-5",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-white",children:"å¯ç”¨ iCloud åŒæ­¥"}),l.jsx("p",{className:"text-[11px] text-gray-500 mt-0.5",children:C?"iCloud Drive å¯ç”¨":"iCloud Drive ä¸å¯ç”¨ï¼Œè¯·ç™»å½• iCloud"})]}),l.jsx("button",{disabled:!C,onClick:async()=>{try{if($)await window.electronAPI.syncDisable(),se(fe=>fe?{...fe,enabled:!1}:null);else{const fe=await window.electronAPI.syncEnable();se(fe)}}catch(fe){console.error("åŒæ­¥åˆ‡æ¢å¤±è´¥:",fe)}},className:`relative w-10 h-5 rounded-full transition-colors ${C?$?"bg-blue-500":"bg-gray-600 hover:bg-gray-500":"bg-gray-700 cursor-not-allowed"}`,children:l.jsx("span",{className:`absolute top-0.5 left-0.5 w-4 h-4 rounded-full bg-white transition-transform ${$?"translate-x-5":"translate-x-0"}`})})]}),$&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"text-[11px] text-gray-500",children:re!=null&&re.lastSyncAt?`æœ€è¿‘åŒæ­¥: ${new Date(re.lastSyncAt).toLocaleString()}`:"å°šæœªåŒæ­¥"}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("h4",{className:"text-[11px] font-medium text-gray-400 uppercase tracking-wider",children:"åŒæ­¥å†…å®¹"}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm text-white",children:"ç”µå­ä¹¦æ–‡ä»¶ (EPUB/PDF)"}),l.jsx("button",{onClick:()=>_e("syncBooks",!(i.syncBooks??!1)),className:`relative w-10 h-5 rounded-full transition-colors ${i.syncBooks??!1?"bg-blue-500":"bg-gray-600 hover:bg-gray-500"}`,children:l.jsx("span",{className:`absolute top-0.5 left-0.5 w-4 h-4 rounded-full bg-white transition-transform ${i.syncBooks??!1?"translate-x-5":"translate-x-0"}`})})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm text-white",children:"æ’­å®¢éŸ³é¢‘æ–‡ä»¶"}),l.jsx("button",{onClick:()=>_e("syncPodcasts",!(i.syncPodcasts??!1)),className:`relative w-10 h-5 rounded-full transition-colors ${i.syncPodcasts??!1?"bg-blue-500":"bg-gray-600 hover:bg-gray-500"}`,children:l.jsx("span",{className:`absolute top-0.5 left-0.5 w-4 h-4 rounded-full bg-white transition-transform ${i.syncPodcasts??!1?"translate-x-5":"translate-x-0"}`})})]})]}),l.jsxs("button",{disabled:be,onClick:async()=>{pe(!0);try{await window.electronAPI.syncNow();const fe=await window.electronAPI.syncGetStatus();se(fe)}finally{pe(!1)}},className:"flex items-center gap-2 px-3 py-1.5 bg-white/5 border border-white/10 rounded-md text-sm text-gray-300 hover:bg-white/10 hover:text-white transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[l.jsx(va,{size:14,className:be?"animate-spin":""}),l.jsx("span",{children:be?"åŒæ­¥ä¸­...":"ç«‹å³åŒæ­¥"})]})]})]})]})},K=()=>g==="language"?ke():g==="reading"?Xe():g==="podcast"?ct():g==="rsshub"?Pe():g==="download"?Qe():g==="asr-provider"?dt():g==="asr-credentials-volcengine"?z():g==="asr-credentials-tencent"?Se():g==="ai-models"?Te():g==="ai-prompts"?Fe():g==="sync-general"?F():l.jsx(xY,{});return n?l.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[l.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:e}),l.jsxs("div",{className:`relative ${ve.containerClass} bg-[#1a1a1a] border border-white/10 rounded-lg shadow-2xl overflow-hidden`,children:[l.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-white/10",children:[l.jsx("h2",{className:"text-lg font-semibold text-white",children:t("preferences.title")}),l.jsx("button",{onClick:e,className:"p-1 rounded hover:bg-white/10 text-gray-400 hover:text-white transition-colors",children:l.jsx(Vn,{size:20})})]}),r?l.jsx("div",{className:"flex items-center justify-center py-12",children:l.jsx(nt,{size:24,className:"animate-spin text-gray-500"})}):l.jsxs("div",{className:`flex ${ve.bodyClass}`,children:[l.jsx("aside",{className:`${ve.sidebarClass} border-r border-white/10 bg-[#151515] p-3 space-y-1`,children:yY.map(C=>{const $=SY[C.id],fe=C.id===f;return l.jsxs("button",{onClick:()=>qe(C.id),className:`w-full flex items-center gap-2.5 px-3 py-1.5 rounded-md text-[13px] transition-colors cursor-pointer ${fe?"bg-white/10 text-white border border-white/15 font-medium":"text-gray-400 hover:bg-white/5 hover:text-white border border-transparent"}`,children:[l.jsx($,{size:16}),l.jsx("span",{children:wY[C.id]})]},C.id)})}),l.jsxs("section",{className:"flex-1 min-w-0 flex flex-col",children:[l.jsx("div",{className:"px-5 pt-4 pb-2 border-b border-white/10",children:l.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:Ne.map(C=>{const $=C.id===g;return l.jsx("button",{onClick:()=>v(C.id),className:`px-3 py-1 rounded-md text-[11px] font-medium transition-colors cursor-pointer ${$?"bg-blue-500/20 text-blue-300 border border-blue-400/40":"bg-white/5 text-gray-400 border border-white/10 hover:text-white hover:bg-white/10"}`,children:AY[C.id]},C.id)})})}),l.jsx("div",{className:"flex-1 overflow-y-auto px-5 py-5",children:K()}),l.jsx("div",{className:"border-t border-white/10 p-4",children:f==="ai"&&g==="ai-models"?l.jsx("button",{onClick:Ze,disabled:w||!m,className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 disabled:bg-gray-700 disabled:cursor-not-allowed text-white text-sm font-medium rounded-md transition-colors",children:w?l.jsxs(l.Fragment,{children:[l.jsx(nt,{size:16,className:"animate-spin"}),l.jsx("span",{children:t("preferences.saving")})]}):l.jsxs(l.Fragment,{children:[l.jsx(Fk,{size:16}),l.jsx("span",{children:t(m?"ai.save":"ai.saved")})]})}):f==="ai"?l.jsx("div",{className:"w-full text-center text-[11px] text-gray-500 py-2",children:"æ­¤é¡µé¢æ“ä½œè‡ªåŠ¨ä¿å­˜"}):l.jsx("button",{onClick:We,disabled:o||!h,className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-700 disabled:cursor-not-allowed text-white text-sm font-medium rounded-md transition-colors",children:o?l.jsxs(l.Fragment,{children:[l.jsx(nt,{size:16,className:"animate-spin"}),l.jsx("span",{children:"ä¿å­˜ä¸­..."})]}):l.jsxs(l.Fragment,{children:[l.jsx(Fk,{size:16}),l.jsx("span",{children:"ä¿å­˜è®¾ç½®"})]})})})]})]})]})]}):null}const CY={social:l.jsx($k,{size:20}),"social-media":l.jsx($k,{size:20}),traditional:l.jsx(zk,{size:20}),"traditional-media":l.jsx(zk,{size:20}),new:l.jsx(w2,{size:20}),"new-media":l.jsx(w2,{size:20}),multimedia:l.jsx(Hk,{size:20}),blog:l.jsx(qr,{size:20}),programming:l.jsx(HF,{size:20}),university:l.jsx(uR,{size:20}),shopping:l.jsx(kU,{size:20}),gaming:l.jsx(Ik,{size:20}),game:l.jsx(Ik,{size:20}),music:l.jsx(F8,{size:20}),picture:l.jsx(SF,{size:20}),forum:l.jsx(so,{size:20}),bbs:l.jsx(so,{size:20}),finance:l.jsx(w2,{size:20}),travel:l.jsx(ad,{size:20}),design:l.jsx(w8,{size:20}),live:l.jsx(Hk,{size:20})};function NY(n){const e=n.toLowerCase();for(const[t,i]of Object.entries(CY))if(e.includes(t))return i;return l.jsx(ad,{size:20})}function _Y({categories:n,onSelect:e}){return n.length===0?l.jsxs("div",{className:"text-center py-16",children:[l.jsx("p",{className:"text-sm text-gray-500",children:"æš‚æ— åˆ†ç±»æ•°æ®"}),l.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"è¯·æ£€æŸ¥ RSSHub å®žä¾‹æ˜¯å¦å¯è®¿é—®"})]}):l.jsxs("div",{children:[l.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-4",children:"æµè§ˆåˆ†ç±»"}),l.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:n.map(t=>l.jsxs("button",{onClick:()=>e(t.name),className:"flex flex-col items-center gap-2 p-4 rounded-lg bg-[#111] border border-white/5 hover:border-white/15 hover:bg-[#161616] transition-all cursor-pointer group",children:[l.jsx("div",{className:"text-gray-500 group-hover:text-gray-300 transition-colors",children:NY(t.name)}),l.jsx("div",{className:"text-sm text-gray-300 group-hover:text-white transition-colors text-center",children:t.name}),l.jsxs("div",{className:"text-[10px] text-gray-600",children:[t.count," ä¸ªè·¯ç”±"]})]},t.name))})]})}function kY({routes:n,loading:e,onSelectRoute:t}){if(e)return l.jsxs("div",{className:"flex items-center justify-center py-16",children:[l.jsx(nt,{size:20,className:"animate-spin text-gray-500"}),l.jsx("span",{className:"ml-2 text-sm text-gray-500",children:"åŠ è½½è·¯ç”±ä¸­..."})]});const i=Object.entries(n);return i.length===0?l.jsx("div",{className:"text-center py-16",children:l.jsx("p",{className:"text-sm text-gray-500",children:"è¯¥åˆ†ç±»ä¸‹æš‚æ— è·¯ç”±"})}):l.jsx("div",{className:"flex flex-col gap-6",children:i.map(([s,r])=>l.jsxs("div",{className:"border border-white/5 rounded-lg overflow-hidden",children:[l.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 bg-[#111]",children:[l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("div",{className:"text-sm font-medium text-gray-200",children:r.name||s}),r.url&&l.jsxs("a",{href:r.url,target:"_blank",rel:"noreferrer",className:"text-[10px] text-gray-600 hover:text-gray-400 flex items-center gap-1 mt-0.5",onClick:a=>a.stopPropagation(),children:[r.url,l.jsx(fy,{size:10})]})]}),l.jsxs("span",{className:"text-[10px] text-gray-600 shrink-0",children:[Object.keys(r.routes||{}).length," ä¸ªè·¯ç”±"]})]}),l.jsx("div",{className:"divide-y divide-white/5",children:Object.entries(r.routes||{}).map(([a,o])=>l.jsxs("button",{onClick:()=>t(r.name||s,{path:a,name:o.name,example:o.example,parameters:o.parameters}),className:"w-full text-left px-4 py-3 hover:bg-white/5 transition-colors cursor-pointer",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("div",{className:"text-sm text-gray-300",children:o.name}),l.jsx("span",{className:"text-xs text-blue-500 shrink-0 ml-2",children:TY(a)?"é…ç½®å‚æ•°":"ç›´æŽ¥è®¢é˜…"})]}),o.description&&l.jsx("div",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:o.description}),o.example&&l.jsx("div",{className:"text-[10px] text-gray-700 mt-1 font-mono",children:o.example})]},a))})]},s))})}function TY(n){return/:(\w+)/.test(n)}const DY={podcast:{label:"æ’­å®¢",icon:l.jsx(lU,{size:14}),color:"text-purple-400"},rss:{label:"RSS",icon:l.jsx(hu,{size:14}),color:"text-orange-400"},rsshub:{label:"RSSHub",icon:l.jsx(pU,{size:14}),color:"text-green-400"}};function jY({results:n,loading:e,onSubscribe:t,onClear:i}){if(e)return l.jsxs("div",{className:"flex items-center justify-center py-16",children:[l.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-gray-600 border-t-blue-500"}),l.jsx("span",{className:"ml-2 text-sm text-gray-500",children:"æœç´¢ä¸­..."})]});if(n.length===0)return l.jsxs("div",{className:"text-center py-16",children:[l.jsx("p",{className:"text-sm text-gray-500 mb-2",children:"æœªæ‰¾åˆ°ç»“æžœ"}),l.jsx("p",{className:"text-xs text-gray-600",children:"è¯•è¯•å…¶ä»–å…³é”®è¯æˆ–ç›´æŽ¥è¾“å…¥ç½‘ç«™ URL"}),l.jsx("button",{onClick:i,className:"mt-4 text-xs text-blue-500 hover:text-blue-400 cursor-pointer",children:"æ¸…é™¤æœç´¢"})]});const s=n.reduce((r,a)=>((r[a.type]=r[a.type]||[]).push(a),r),{});return l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("span",{className:"text-sm text-gray-400",children:["æ‰¾åˆ° ",n.length," ä¸ªç»“æžœ"]}),l.jsxs("button",{onClick:i,className:"flex items-center gap-1 text-xs text-gray-500 hover:text-gray-300 cursor-pointer",children:[l.jsx(Vn,{size:14}),"æ¸…é™¤"]})]}),Object.entries(s).map(([r,a])=>{const o=DY[r]||{label:r,icon:l.jsx(hu,{size:14}),color:"text-gray-400"};return l.jsxs("div",{className:"mb-6",children:[l.jsxs("div",{className:`flex items-center gap-1.5 mb-3 text-xs font-medium ${o.color}`,children:[o.icon,l.jsx("span",{children:o.label}),l.jsxs("span",{className:"text-gray-600 ml-1",children:["(",a.length,")"]})]}),l.jsx("div",{className:"flex flex-col gap-1",children:a.map((c,h)=>l.jsxs("button",{onClick:()=>t(c),className:"flex items-center gap-3 p-3 rounded-md hover:bg-white/5 transition-colors text-left cursor-pointer w-full",children:[c.image?l.jsx("img",{src:c.image,alt:"",className:"w-10 h-10 rounded-md object-cover shrink-0"}):l.jsx("div",{className:"w-10 h-10 rounded-md bg-gray-800 flex items-center justify-center shrink-0",children:o.icon}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("div",{className:"text-sm text-gray-200 truncate",children:c.title}),c.description&&l.jsx("div",{className:"text-xs text-gray-500 truncate",children:c.description})]}),l.jsx("span",{className:"text-xs text-blue-500 shrink-0",children:c.feedUrl?"é¢„è§ˆ":"é…ç½®"})]},`${r}-${h}`))})]},r)})]})}function RY({feedUrl:n,suggestedTitle:e,onClose:t,onSubscribed:i}){const[s,r]=A.useState(null),[a,o]=A.useState(!0),[c,h]=A.useState(null),[d,f]=A.useState(!1),[p,g]=A.useState(""),[v,b]=A.useState(""),{showToast:x}=Sa();A.useEffect(()=>{o(!0),h(null),window.electronAPI.discoverPreview(n).then(y=>{r(y),g(y.title||e||"")}).catch(y=>{h(y instanceof Error?y.message:"é¢„è§ˆå¤±è´¥")}).finally(()=>{o(!1)})},[n,e]);const m=A.useCallback(async()=>{if(s){f(!0);try{await window.electronAPI.feedAdd({url:s.feedUrl,title:p.trim()||void 0,category:v.trim()||void 0}),x(`å·²è®¢é˜…ã€Œ${p||s.title||"Feed"}ã€`),i()}catch(y){const w=y instanceof Error?y.message:"è®¢é˜…å¤±è´¥";x(w)}finally{f(!1)}}},[s,p,v,x,i]);return A.useEffect(()=>{const y=w=>{w.key==="Escape"&&t()};return window.addEventListener("keydown",y),()=>window.removeEventListener("keydown",y)},[t]),l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60",onClick:t,children:l.jsxs("div",{className:"relative w-full max-w-md mx-4 bg-[#111] border border-white/10 rounded-lg shadow-2xl max-h-[80vh] overflow-y-auto",onClick:y=>y.stopPropagation(),children:[l.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b border-white/5",children:[l.jsx("h3",{className:"text-sm font-medium text-white",children:"è®¢é˜…é¢„è§ˆ"}),l.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-300 cursor-pointer",children:l.jsx(Vn,{size:18})})]}),l.jsxs("div",{className:"px-5 py-4",children:[a&&l.jsxs("div",{className:"flex items-center justify-center py-8",children:[l.jsx(nt,{size:20,className:"animate-spin text-gray-500"}),l.jsx("span",{className:"ml-2 text-sm text-gray-500",children:"åŠ è½½é¢„è§ˆ..."})]}),c&&l.jsxs("div",{className:"py-8 text-center",children:[l.jsx("p",{className:"text-sm text-red-400 mb-2",children:"é¢„è§ˆå¤±è´¥"}),l.jsx("p",{className:"text-xs text-gray-600",children:c})]}),s&&!a&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[s.favicon?l.jsx("img",{src:s.favicon,alt:"",className:"w-10 h-10 rounded-md object-cover shrink-0"}):l.jsx("div",{className:"w-10 h-10 rounded-md bg-gray-800 flex items-center justify-center shrink-0",children:l.jsx(hu,{size:18,className:"text-gray-600"})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("div",{className:"text-sm font-medium text-gray-200",children:s.title||"æœªçŸ¥åç§°"}),s.description&&l.jsx("div",{className:"text-xs text-gray-500 mt-0.5 line-clamp-2",children:s.description}),l.jsx("div",{className:"text-[10px] text-gray-700 mt-1 font-mono truncate",children:s.feedUrl})]})]}),s.alreadySubscribed&&l.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-green-900/20 border border-green-800/30 rounded-md mb-4",children:[l.jsx(yg,{size:14,className:"text-green-400"}),l.jsx("span",{className:"text-xs text-green-400",children:"å·²è®¢é˜…æ­¤æº"})]}),s.articles.length>0&&l.jsxs("div",{className:"mb-4",children:[l.jsx("div",{className:"text-xs text-gray-500 mb-2",children:"æœ€è¿‘æ–‡ç« "}),l.jsx("div",{className:"flex flex-col gap-1",children:s.articles.map((y,w)=>l.jsxs("div",{className:"flex items-center gap-2 py-1.5 px-2 rounded hover:bg-white/5",children:[l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("div",{className:"text-xs text-gray-300 truncate",children:y.title||"æ— æ ‡é¢˜"}),y.publishedAt&&l.jsx("div",{className:"text-[10px] text-gray-600",children:new Date(y.publishedAt).toLocaleDateString("zh-CN")})]}),y.url&&l.jsx("a",{href:y.url,target:"_blank",rel:"noreferrer",className:"text-gray-700 hover:text-gray-400 shrink-0",onClick:E=>E.stopPropagation(),children:l.jsx(fy,{size:12})})]},w))})]}),!s.alreadySubscribed&&l.jsxs("div",{className:"flex flex-col gap-3 pt-2 border-t border-white/5",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"è®¢é˜…åç§°"}),l.jsx("input",{type:"text",value:p,onChange:y=>g(y.target.value),placeholder:"ä½¿ç”¨é»˜è®¤åç§°",className:"w-full px-3 py-1.5 bg-[#0a0a0a] border border-white/10 rounded-md text-sm text-white placeholder-gray-600 focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"åˆ†ç±»"}),l.jsx("input",{type:"text",value:v,onChange:y=>b(y.target.value),placeholder:"å¯é€‰",className:"w-full px-3 py-1.5 bg-[#0a0a0a] border border-white/10 rounded-md text-sm text-white placeholder-gray-600 focus:outline-none focus:ring-1 focus:ring-blue-500"})]})]})]})]}),s&&!a&&!s.alreadySubscribed&&l.jsxs("div",{className:"flex justify-end gap-2 px-5 py-4 border-t border-white/5",children:[l.jsx("button",{onClick:t,className:"px-4 py-2 text-sm text-gray-400 hover:text-white transition-colors cursor-pointer",children:"å–æ¶ˆ"}),l.jsx("button",{onClick:m,disabled:d,className:"flex items-center gap-1.5 px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-700 text-white text-sm rounded-md transition-colors cursor-pointer",children:d?l.jsx(nt,{size:14,className:"animate-spin"}):"ç¡®è®¤è®¢é˜…"})]})]})})}function LY(n){return n?typeof n=="string"?n:n.description||"":""}function MY(n){if(!(!n||typeof n=="string"))return n.options}function OY(n){if(!(!n||typeof n=="string"))return n.default}function PY(n,e){const t=[],i=/:(\w+)(?:\{[^}]*\})?\??/g;let s;for(;(s=i.exec(n))!==null;){const r=s[0],a=s[1],o=r.endsWith("?"),c=e==null?void 0:e[a];t.push({name:a,description:LY(c),optional:o,options:MY(c),defaultValue:OY(c)})}return t}function IY(n,e){let t=n;for(const[i,s]of Object.entries(e))t=t.replace(new RegExp(`:${i}(?:\\{[^}]*\\})?\\??`,"g"),s);return t=t.replace(/\/:[\w]+(?:\{[^}]*\})?\?/g,""),t=t.replace(/\/+/g,"/").replace(/\/$/,""),t}function BY({namespace:n,route:e,onSubmit:t,onCancel:i}){const s=PY(e.path,e.parameters),[r,a]=A.useState(()=>{const p={};for(const g of s)g.defaultValue&&(p[g.name]=g.defaultValue);return p}),[o,c]=A.useState(!1),h=A.useCallback((p,g)=>{a(v=>({...v,[p]:g}))},[]),d=A.useCallback(p=>{var v;p.preventDefault();for(const b of s)if(!b.optional&&!((v=r[b.name])!=null&&v.trim()))return;c(!0);const g=IY(e.path,r);t(g),c(!1)},[s,r,e.path,t]),f=s.filter(p=>!p.optional).every(p=>{var g;return(g=r[p.name])==null?void 0:g.trim()});return l.jsxs("div",{className:"max-w-lg",children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("h3",{className:"text-lg font-medium text-white",children:e.name}),l.jsx("p",{className:"text-sm text-gray-500 mt-1",children:n}),e.example&&l.jsxs("p",{className:"text-xs text-gray-600 mt-2 font-mono",children:["ç¤ºä¾‹è·¯å¾„: ",e.example]})]}),l.jsxs("form",{onSubmit:d,className:"flex flex-col gap-4",children:[s.map(p=>l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm text-gray-300 mb-1.5",children:[p.name,p.optional&&l.jsx("span",{className:"text-gray-600 ml-1",children:"(é€‰å¡«)"})]}),p.description&&l.jsx("p",{className:"text-xs text-gray-600 mb-1.5",children:p.description}),p.options&&p.options.length>0?l.jsxs("select",{value:r[p.name]||"",onChange:g=>h(p.name,g.target.value),className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white focus:outline-none focus:ring-1 focus:ring-blue-500",children:[p.optional&&l.jsx("option",{value:"",children:"-- ä¸é€‰æ‹© --"}),p.options.map(g=>l.jsx("option",{value:g.value,children:g.label},g.value))]}):l.jsx("input",{type:"text",value:r[p.name]||"",onChange:g=>h(p.name,g.target.value),placeholder:p.defaultValue||p.name,className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-600 focus:outline-none focus:ring-1 focus:ring-blue-500"})]},p.name)),l.jsxs("div",{className:"flex gap-2 pt-2",children:[l.jsx("button",{type:"submit",disabled:!f||o,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-700 disabled:cursor-not-allowed text-white text-sm rounded-md transition-colors cursor-pointer",children:o?l.jsx(nt,{size:16,className:"animate-spin"}):"é¢„è§ˆè®¢é˜…"}),l.jsx("button",{type:"button",onClick:i,className:"px-4 py-2 bg-transparent hover:bg-white/5 text-gray-400 text-sm rounded-md transition-colors cursor-pointer",children:"å–æ¶ˆ"})]})]})]})}const zY=["xiaohongshu","twitter","instagram","telegram","youtube","bilibili","weibo","xiaoyuzhou","pixiv","pornhub","github","sspai","jike","zhihu","v2ex"],FY={xiaohongshu:"å°çº¢ä¹¦",twitter:"X (Twitter)",instagram:"Instagram",telegram:"Telegram",youtube:"YouTube",bilibili:"å“”å“©å“”å“© bilibili",weibo:"å¾®åš",xiaoyuzhou:"å°å®‡å®™",pixiv:"pixiv",pornhub:"PornHub",github:"GitHub",sspai:"å°‘æ•°æ´¾ sspai",jike:"å³åˆ»",zhihu:"çŸ¥ä¹Ž",v2ex:"V2EX"};function UY({onSelectSite:n}){const[e,t]=A.useState(null),[i,s]=A.useState(!0);A.useEffect(()=>{window.electronAPI.discoverRsshubRoutes().then(o=>{t(o)}).catch(o=>{console.error("åŠ è½½è·¯ç”±æ•°æ®å¤±è´¥:",o)}).finally(()=>{s(!1)})},[]);const r=A.useCallback(o=>{e!=null&&e[o]&&n(o,e[o])},[e,n]);if(i)return l.jsxs("div",{className:"mb-8",children:[l.jsxs("h3",{className:"text-sm font-medium text-gray-400 mb-4 flex items-center gap-1.5",children:[l.jsx(Pk,{size:14,className:"text-orange-400"}),"çƒ­é—¨ç«™ç‚¹"]}),l.jsx("div",{className:"flex items-center justify-center py-8",children:l.jsx(nt,{size:16,className:"animate-spin text-gray-600"})})]});if(!e)return null;const a=zY.filter(o=>e[o]);return a.length===0?null:l.jsxs("div",{className:"mb-8",children:[l.jsxs("h3",{className:"text-sm font-medium text-gray-400 mb-4 flex items-center gap-1.5",children:[l.jsx(Pk,{size:14,className:"text-orange-400"}),"çƒ­é—¨ç«™ç‚¹"]}),l.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-2.5",children:a.map(o=>{const c=e[o],h=Object.keys(c.routes||{}).length,d=FY[o]||c.name||o;return l.jsx("button",{onClick:()=>r(o),className:"flex items-center gap-3 px-3.5 py-3 rounded-lg bg-[#111] border border-white/5 hover:border-white/15 hover:bg-[#161616] transition-all cursor-pointer group text-left",children:l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("div",{className:"text-sm text-gray-300 group-hover:text-white transition-colors truncate",children:d}),l.jsxs("div",{className:"text-[10px] text-gray-600 mt-0.5",children:[h," routes"]})]})},o)})})]})}function HY({onFeedAdded:n}){const[e,t]=A.useState(""),[i,s]=A.useState(!1),[r,a]=A.useState(null),[o,c]=A.useState([]),[h,d]=A.useState(null),[f,p]=A.useState(null),[g,v]=A.useState(!1),[b,x]=A.useState(!1),[m,y]=A.useState(null),[w,E]=A.useState(""),[S,_]=A.useState(!1),[T,j]=A.useState(!1),[M,L]=A.useState(null),[O,B]=A.useState(),[G,W]=A.useState(null),[J,V]=A.useState([{label:"å‘çŽ°",type:"home"}]),H=A.useRef(null),{showToast:P}=Sa();A.useEffect(()=>{window.electronAPI.discoverRsshubConfig().then(se=>{y(se.baseUrl),E(se.baseUrl||"")}).catch(se=>console.error("åŠ è½½ RSSHub é…ç½®å¤±è´¥:",se))},[]),A.useEffect(()=>{m&&(v(!0),window.electronAPI.discoverRsshubCategories().then(se=>{c(se)}).catch(()=>{P("åŠ è½½ RSSHub åˆ†ç±»å¤±è´¥")}).finally(()=>{v(!1)}))},[m,P]);const Y=A.useCallback(async()=>{const se=e.trim();if(se){s(!0),a(null),d(null),p(null),V([{label:"å‘çŽ°",type:"home"}]),W(null);try{const be=await window.electronAPI.discoverSearch({query:se});a(be)}catch{P("æœç´¢å¤±è´¥"),a([])}finally{s(!1)}}},[e,P]),ge=A.useCallback(se=>{se.key==="Enter"&&(se.preventDefault(),Y())},[Y]),ae=A.useCallback(async se=>{d(se),x(!0),p(null),V([{label:"å‘çŽ°",type:"home"},{label:se,type:"category"}]),a(null);try{const be=await window.electronAPI.discoverRsshubRoutes(se);p(be)}catch{P("åŠ è½½è·¯ç”±å¤±è´¥")}finally{x(!1)}},[P]),ee=A.useCallback((se,be)=>{const pe=be.name||se;d(se),p({[se]:be}),x(!1),V([{label:"å‘çŽ°",type:"home"},{label:pe,type:"category"}]),a(null)},[]),le=A.useCallback(se=>{se.type==="home"?(d(null),p(null),a(null),W(null),V([{label:"å‘çŽ°",type:"home"}]),t("")):se.type==="category"&&h&&(W(null),V(be=>be.slice(0,2)))},[h]),ie=A.useCallback((se,be)=>{const pe=be.path.match(/:(\w+)/g);if(!pe||pe.length===0){const me=be.example||be.path;L(me),B(`${se} - ${be.name}`);return}W({namespace:se,route:be}),V(me=>[...me.filter(Ne=>Ne.type!=="namespace"),{label:be.name,type:"namespace"}])},[]),Q=A.useCallback(async()=>{const se=w.trim();if(se){j(!0);try{const be=await window.electronAPI.discoverRsshubConfig(se);y(be.baseUrl),_(!1),P("RSSHub é…ç½®å·²ä¿å­˜")}catch{P("ä¿å­˜é…ç½®å¤±è´¥")}finally{j(!1)}}},[w,P]),Z=A.useCallback(se=>{se.feedUrl?(L(se.feedUrl),B(se.title)):se.rsshubPath&&W({namespace:se.title.split(" - ")[0],route:{path:se.rsshubPath,name:se.title,example:se.rsshubPath,parameters:se.rsshubParams}})},[]),re=A.useCallback(se=>{L(se),B(G==null?void 0:G.route.name)},[G]);return l.jsxs("div",{className:"flex flex-col h-full bg-[#0a0a0a]",children:[l.jsxs("div",{className:"shrink-0 px-6 pt-6 pb-4 border-b border-white/5",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("div",{className:"flex items-center gap-1 text-sm",children:J.map((se,be)=>l.jsxs("span",{className:"flex items-center gap-1",children:[be>0&&l.jsx("span",{className:"text-gray-600",children:"/"}),l.jsx("button",{onClick:()=>le(se),className:`transition-colors cursor-pointer ${be===J.length-1?"text-white font-medium":"text-gray-500 hover:text-gray-300"}`,children:se.label})]},be))}),l.jsxs("button",{onClick:()=>_(!S),className:"flex items-center gap-1.5 px-2.5 py-1.5 text-xs text-gray-500 hover:text-gray-300 rounded-md hover:bg-white/5 transition-colors cursor-pointer",children:[l.jsx(Bb,{size:14}),l.jsx("span",{children:"RSSHub"})]})]}),S&&l.jsxs("div",{className:"mb-4 p-3 bg-[#111] border border-white/10 rounded-md",children:[l.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"RSSHub å®žä¾‹åœ°å€"}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("input",{type:"text",value:w,onChange:se=>E(se.target.value),placeholder:"https://rsshub.example.com",className:"flex-1 px-3 py-1.5 bg-[#0a0a0a] border border-white/10 rounded-md text-sm text-white placeholder-gray-600 focus:outline-none focus:ring-1 focus:ring-blue-500"}),l.jsx("button",{onClick:Q,disabled:T||!w.trim(),className:"px-3 py-1.5 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-700 disabled:cursor-not-allowed text-white text-xs rounded-md transition-colors cursor-pointer",children:T?l.jsx(nt,{size:14,className:"animate-spin"}):"ä¿å­˜"})]})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsxs("div",{className:"relative flex-1",children:[l.jsx(wg,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500"}),l.jsx("input",{ref:H,type:"text",value:e,onChange:se=>t(se.target.value),onKeyDown:ge,placeholder:"æœç´¢æ’­å®¢ã€ç½‘ç«™åç§°ï¼Œæˆ–è¾“å…¥ URL å‘çŽ° RSS...",className:"w-full pl-9 pr-3 py-2.5 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.jsx("button",{onClick:Y,disabled:!e.trim()||i,className:"px-5 py-2.5 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-700 disabled:cursor-not-allowed text-white text-sm font-medium rounded-md transition-colors cursor-pointer shrink-0",children:i?l.jsx(nt,{size:16,className:"animate-spin"}):"æœç´¢"})]})]}),l.jsxs("div",{className:"flex-1 overflow-y-auto px-6 py-4",children:[r!==null&&l.jsx(jY,{results:r,loading:i,onSubscribe:Z,onClear:()=>{a(null),t("")}}),G&&!M&&r===null&&l.jsxs("div",{children:[l.jsxs("button",{onClick:()=>{W(null),V(se=>se.filter(be=>be.type!=="namespace"))},className:"flex items-center gap-1 text-sm text-gray-500 hover:text-gray-300 mb-4 cursor-pointer",children:[l.jsx(kF,{size:16}),"è¿”å›ž"]}),l.jsx(BY,{namespace:G.namespace,route:G.route,onSubmit:re,onCancel:()=>{W(null),V(se=>se.filter(be=>be.type!=="namespace"))}})]}),r===null&&!G&&!M&&l.jsx(l.Fragment,{children:m?g?l.jsxs("div",{className:"flex items-center justify-center py-16",children:[l.jsx(nt,{size:20,className:"animate-spin text-gray-500"}),l.jsx("span",{className:"ml-2 text-sm text-gray-500",children:"åŠ è½½åˆ†ç±»ä¸­..."})]}):h&&f?l.jsx(kY,{routes:f,loading:b,onSelectRoute:ie}):l.jsxs(l.Fragment,{children:[l.jsx(UY,{onSelectSite:ee}),l.jsx(_Y,{categories:o,onSelect:ae})]}):l.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[l.jsx(Bb,{size:40,className:"text-gray-600 mb-4"}),l.jsx("p",{className:"text-gray-400 text-sm mb-2",children:"å°šæœªé…ç½® RSSHub å®žä¾‹"}),l.jsx("p",{className:"text-gray-600 text-xs mb-4",children:"é…ç½® RSSHub åœ°å€åŽå³å¯æµè§ˆå’Œæœç´¢ä¸°å¯Œçš„å†…å®¹æº"}),l.jsx("button",{onClick:()=>_(!0),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm rounded-md transition-colors cursor-pointer",children:"é…ç½® RSSHub"})]})})]}),M&&l.jsx(RY,{feedUrl:M,suggestedTitle:O,onClose:()=>{L(null),B(void 0)},onSubscribed:()=>{L(null),B(void 0),n==null||n()}})]})}const $Y={"asr-standard":l.jsx(ul,{size:14}),"asr-realtime":l.jsx(ul,{size:14}),download:l.jsx(xa,{size:14})},FD={pending:{icon:l.jsx(nt,{size:14,className:"animate-spin"}),label:"ç­‰å¾…ä¸­",color:"text-gray-400"},running:{icon:l.jsx(nt,{size:14,className:"animate-spin"}),label:"è¿›è¡Œä¸­",color:"text-teal-400"},completed:{icon:l.jsx(Xh,{size:14}),label:"å·²å®Œæˆ",color:"text-green-400"},failed:{icon:l.jsx(ru,{size:14}),label:"å¤±è´¥",color:"text-red-400"},cancelled:{icon:l.jsx(HU,{size:14}),label:"å·²å–æ¶ˆ",color:"text-yellow-400"}};function qY(n){const e=new Date(n),i=new Date().getTime()-e.getTime(),s=Math.floor(i/1e3);if(s<60)return"åˆšåˆš";const r=Math.floor(s/60);if(r<60)return`${r}åˆ†é’Ÿå‰`;const a=Math.floor(r/60);if(a<24)return`${a}å°æ—¶å‰`;const o=Math.floor(a/24);return o<7?`${o}å¤©å‰`:e.toLocaleDateString("zh-CN",{month:"short",day:"numeric"})}function VY({open:n,onClose:e,onNavigateToArticle:t}){const[i,s]=A.useState([]),[r,a]=A.useState("all"),o=async g=>{if(!(!g.articleId||!t))try{const v=await window.electronAPI.articleGet(g.articleId),b=(v==null?void 0:v.mediaType)||"article";e(),requestAnimationFrame(()=>t(g.articleId,b))}catch{e(),requestAnimationFrame(()=>t(g.articleId,"article"))}},c=A.useCallback(async()=>{try{const g=await window.electronAPI.appTaskList();s(g)}catch(g){console.error("Failed to load tasks:",g)}},[]);A.useEffect(()=>{n&&c()},[n,c]),A.useEffect(()=>n?window.electronAPI.appTaskOnUpdated(v=>{s(b=>{const x=b.findIndex(m=>m.id===v.id);if(x>=0){const m=[...b];return m[x]=v,m}return[v,...b]})}):void 0,[n]),A.useEffect(()=>{if(!n)return;const g=v=>{v.key==="Escape"&&(v.stopImmediatePropagation(),e())};return document.addEventListener("keydown",g),()=>document.removeEventListener("keydown",g)},[n,e]);const h=async g=>{try{await window.electronAPI.appTaskCancel(g),c()}catch(v){console.error("Failed to cancel task:",v)}},d=async g=>{try{await window.electronAPI.appTaskCreate({type:g.type,articleId:g.articleId,title:g.title,meta:g.meta}),c()}catch(v){console.error("Failed to retry task:",v)}};if(!n)return null;const f=i.filter(g=>r==="running"?g.status==="pending"||g.status==="running":r==="completed"?g.status==="completed"||g.status==="failed"||g.status==="cancelled":!0),p=i.filter(g=>g.status==="pending"||g.status==="running").length;return l.jsxs("div",{className:"fixed inset-0 z-50 flex",children:[l.jsx("div",{className:"flex-1 bg-black/40 backdrop-blur-sm",onClick:e}),l.jsxs("div",{className:"w-[380px] bg-[#1a1a1a] border-l border-white/10 flex flex-col shadow-2xl",children:[l.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-white/10 shrink-0",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(b2,{size:18,className:"text-gray-400"}),l.jsx("h2",{className:"text-sm font-semibold text-white",children:"ä»»åŠ¡é¢æ¿"}),p>0&&l.jsxs("span",{className:"px-1.5 py-0.5 text-[10px] bg-teal-500/20 text-teal-400 rounded-full",children:[p," è¿›è¡Œä¸­"]})]}),l.jsx("button",{onClick:e,className:"p-1 rounded hover:bg-white/10 text-gray-400 hover:text-white transition-colors cursor-pointer",children:l.jsx(Vn,{size:18})})]}),l.jsx("div",{className:"flex border-b border-white/5 px-4 shrink-0",children:[{key:"all",label:"å…¨éƒ¨"},{key:"running",label:"è¿›è¡Œä¸­"},{key:"completed",label:"å·²å®Œæˆ"}].map(g=>l.jsx("button",{onClick:()=>a(g.key),className:`px-3 py-2 text-xs font-medium border-b-2 transition-colors cursor-pointer ${r===g.key?"border-teal-500 text-white":"border-transparent text-gray-500 hover:text-gray-300"}`,children:g.label},g.key))}),l.jsx("div",{className:"flex-1 overflow-y-auto",children:f.length===0?l.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-gray-500",children:[l.jsx(b2,{size:32,className:"mb-3 opacity-40"}),l.jsx("p",{className:"text-sm",children:"æš‚æ— ä»»åŠ¡"})]}):l.jsx("div",{className:"divide-y divide-white/5",children:f.map(g=>{const v=FD[g.status]||FD.pending,b=$Y[g.type]||l.jsx(b2,{size:14});return l.jsx("div",{className:`px-4 py-3 hover:bg-white/[0.03] transition-colors ${g.articleId&&t?"cursor-pointer":""}`,onClick:()=>o(g),children:l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx("span",{className:"shrink-0 mt-0.5 text-gray-500",children:b}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("p",{className:"text-sm text-gray-200 truncate",children:g.title}),l.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[l.jsxs("span",{className:`flex items-center gap-1 text-[11px] ${v.color}`,children:[v.icon,v.label]}),l.jsx("span",{className:"text-[11px] text-gray-600",children:qY(g.updatedAt)})]}),(g.status==="running"||g.status==="pending")&&g.progress>0&&l.jsx("div",{className:"mt-2 w-full h-1 bg-white/5 rounded-full overflow-hidden",children:l.jsx("div",{className:"h-full bg-teal-500 rounded-full transition-all duration-500",style:{width:`${Math.round(g.progress*100)}%`}})}),g.detail&&l.jsx("p",{className:"text-[11px] text-gray-500 mt-1 truncate",children:g.detail}),g.error&&g.status==="failed"&&l.jsx("p",{className:"text-[11px] text-red-400/80 mt-1 truncate",children:g.error})]}),l.jsxs("div",{className:"shrink-0 flex items-center gap-1",children:[(g.status==="pending"||g.status==="running")&&l.jsx("button",{onClick:()=>h(g.id),className:"p-1 rounded hover:bg-white/10 text-gray-500 hover:text-red-400 transition-colors cursor-pointer",title:"å–æ¶ˆ",children:l.jsx(ru,{size:14})}),g.status==="failed"&&l.jsx("button",{onClick:()=>d(g),className:"p-1 rounded hover:bg-white/10 text-gray-500 hover:text-teal-400 transition-colors cursor-pointer",title:"é‡è¯•",children:l.jsx(va,{size:14})}),g.articleId&&t&&l.jsx("button",{onClick:x=>{x.stopPropagation(),o(g)},className:"p-1 rounded hover:bg-white/10 text-gray-500 hover:text-teal-400 transition-colors cursor-pointer",title:"æŸ¥çœ‹",children:l.jsx(fy,{size:14})})]})]})},g.id)})})})]})]})}const UD={success:{icon:l.jsx(Xh,{size:14}),color:"text-green-400"},error:{icon:l.jsx(ru,{size:14}),color:"text-red-400"},info:{icon:l.jsx(pR,{size:14}),color:"text-blue-400"}};function GY(n){const e=new Date(n),i=new Date().getTime()-e.getTime(),s=Math.floor(i/1e3);if(s<60)return"åˆšåˆš";const r=Math.floor(s/60);if(r<60)return`${r}åˆ†é’Ÿå‰`;const a=Math.floor(r/60);if(a<24)return`${a}å°æ—¶å‰`;const o=Math.floor(a/24);return o<7?`${o}å¤©å‰`:e.toLocaleDateString("zh-CN",{month:"short",day:"numeric"})}function WY({open:n,onClose:e,onNavigateToArticle:t}){const[i,s]=A.useState([]),r=A.useCallback(async()=>{try{const f=await window.electronAPI.notificationList();s(f)}catch(f){console.error("Failed to load notifications:",f)}},[]);A.useEffect(()=>{n&&r()},[n,r]),A.useEffect(()=>n?window.electronAPI.notificationOnNew(p=>{s(g=>[p,...g])}):void 0,[n]),A.useEffect(()=>{if(!n)return;const f=p=>{p.key==="Escape"&&(p.stopImmediatePropagation(),e())};return document.addEventListener("keydown",f),()=>document.removeEventListener("keydown",f)},[n,e]);const a=async f=>{try{await window.electronAPI.notificationRead(f),s(p=>p.map(g=>g.id===f?{...g,read:!0}:g))}catch(p){console.error("Failed to mark read:",p)}},o=async()=>{try{await window.electronAPI.notificationReadAll(),s(f=>f.map(p=>({...p,read:!0})))}catch(f){console.error("Failed to mark all read:",f)}},c=async()=>{try{await window.electronAPI.notificationClear(),s([])}catch(f){console.error("Failed to clear notifications:",f)}},h=async f=>{if(f.read||a(f.id),f.articleId&&t){let p="article";try{const g=await window.electronAPI.articleGet(f.articleId);g!=null&&g.mediaType&&(p=g.mediaType)}catch{}e(),requestAnimationFrame(()=>t(f.articleId,p))}};if(!n)return null;const d=i.filter(f=>!f.read).length;return l.jsxs("div",{className:"fixed inset-0 z-50 flex",children:[l.jsx("div",{className:"flex-1 bg-black/40 backdrop-blur-sm",onClick:e}),l.jsxs("div",{className:"w-[380px] bg-[#1a1a1a] border-l border-white/10 flex flex-col shadow-2xl",children:[l.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-white/10 shrink-0",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(KS,{size:18,className:"text-gray-400"}),l.jsx("h2",{className:"text-sm font-semibold text-white",children:"é€šçŸ¥"}),d>0&&l.jsxs("span",{className:"px-1.5 py-0.5 text-[10px] bg-blue-500/20 text-blue-400 rounded-full",children:[d," æœªè¯»"]})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[d>0&&l.jsx("button",{onClick:o,className:"p-1 rounded hover:bg-white/10 text-gray-400 hover:text-white transition-colors cursor-pointer",title:"å…¨éƒ¨å·²è¯»",children:l.jsx(yg,{size:16})}),i.length>0&&l.jsx("button",{onClick:c,className:"p-1 rounded hover:bg-white/10 text-gray-400 hover:text-red-400 transition-colors cursor-pointer",title:"æ¸…ç©º",children:l.jsx(Wi,{size:16})}),l.jsx("button",{onClick:e,className:"p-1 rounded hover:bg-white/10 text-gray-400 hover:text-white transition-colors cursor-pointer",children:l.jsx(Vn,{size:18})})]})]}),l.jsx("div",{className:"flex-1 overflow-y-auto",children:i.length===0?l.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-gray-500",children:[l.jsx(KS,{size:32,className:"mb-3 opacity-40"}),l.jsx("p",{className:"text-sm",children:"æš‚æ— é€šçŸ¥"})]}):l.jsx("div",{className:"divide-y divide-white/5",children:i.map(f=>{const p=UD[f.type]||UD.info;return l.jsx("div",{onClick:()=>h(f),className:`px-4 py-3 transition-colors cursor-pointer ${f.read?"hover:bg-white/[0.03]":"bg-white/[0.02] hover:bg-white/[0.05]"}`,children:l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx("span",{className:`shrink-0 mt-0.5 ${p.color}`,children:p.icon}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("p",{className:`text-sm truncate ${f.read?"text-gray-400":"text-gray-200"}`,children:f.title}),!f.read&&l.jsx("span",{className:"shrink-0 w-1.5 h-1.5 rounded-full bg-blue-500"})]}),f.body&&l.jsx("p",{className:"text-[11px] text-gray-500 mt-0.5 truncate",children:f.body}),l.jsx("p",{className:"text-[11px] text-gray-600 mt-1",children:GY(f.createdAt)})]})]})},f.id)})})})]})]})}function YY(n,e){const t=n.trim();if(!t||t.startsWith("#"))return null;try{const i=new URL(t,e);return i.protocol!=="http:"&&i.protocol!=="https:"?null:i.toString()}catch{return null}}function XY(n,e){let t=null;if(n instanceof Element?t=n:n instanceof Node&&(t=n.parentElement),!t)return null;const i=t.closest("a[href]");return i?YY(i.getAttribute("href")??"",e):null}function KY(){const{showToast:n}=Sa(),[e,t]=A.useState(!1),[i,s]=A.useState(null),[r,a]=A.useState("library-articles"),[o,c]=A.useState(null),[h,d]=A.useState(!1),[f,p]=A.useState(!1),[g,v]=A.useState(!1),[b,x]=A.useState(!1),[m,y]=A.useState(!1),[w,E]=A.useState(!1),[S,_]=A.useState(!1),[T,j]=A.useState(!1),[M,L]=A.useState(0),[O,B]=A.useState(null),[G,W]=A.useState(null),[J,V]=A.useState(null),[H,P]=A.useState(null),[Y,ge]=A.useState(()=>localStorage.getItem("detail-panel-collapsed")==="true"),[ae,ee]=A.useState(null),[le,ie]=A.useState(!1),[Q,Z]=A.useState(null),[re,se]=A.useState("article"),[be,pe]=A.useState(!1),[me,Ne]=A.useState(!1),ve=r.startsWith("library-")?"library":r.startsWith("feed-")||r==="feeds"||r==="wechat"?"feed":void 0,_e=r==="feed-unseen"?"unseen":r==="feed-seen"?"seen":void 0,We=r==="library-videos"?"video":r==="library-podcasts"?"podcast":r==="library-articles"?"article":void 0;A.useEffect(()=>{(async()=>{try{const X=await window.electronAPI.settingsGet();X.language&&lj(X.language)}catch(X){console.error("Failed to load language setting:",X)}})()},[]),A.useEffect(()=>window.electronAPI.notificationOnNew(X=>{const je=X.body||X.title,qe=X.type==="error"?"error":"info";n(je,qe)}),[n]),A.useEffect(()=>{const he=X=>{const je=X.target.tagName;if(!(je==="INPUT"||je==="TEXTAREA")){if((X.metaKey||X.ctrlKey)&&X.key==="k"&&(X.preventDefault(),p(qe=>!qe)),(X.metaKey||X.ctrlKey)&&X.shiftKey&&X.key==="s"){X.preventDefault(),x(!0);return}if(X.shiftKey&&(X.key==="a"||X.key==="A")){X.preventDefault(),v(!0);return}if(X.shiftKey&&(X.key==="f"||X.key==="F")&&!X.metaKey&&!X.ctrlKey){X.preventDefault(),y(!0);return}X.key==="/"&&(X.preventDefault(),y(!0)),X.key==="?"&&(X.preventDefault(),E(qe=>!qe)),X.key==="]"&&!h&&(X.preventDefault(),ge(qe=>{const ke=!qe;return localStorage.setItem("detail-panel-collapsed",String(ke)),ke})),X.key==="["&&!h&&(X.preventDefault(),t(qe=>!qe))}};return document.addEventListener("keydown",he),()=>document.removeEventListener("keydown",he)},[h]),A.useEffect(()=>{const he=X=>{if(X.defaultPrevented||X.button!==0)return;const je=XY(X.target,window.location.href);je&&(X.preventDefault(),window.electronAPI.externalOpenUrl(je))};return document.addEventListener("click",he,!0),()=>document.removeEventListener("click",he,!0)},[]);const Ie=A.useCallback(he=>{const je={inbox:"1",later:"2",archive:"3","archive-article":"e","later-article":"l","delete-article":"d","open-reader":"Enter",search:"/"}[he];je&&document.dispatchEvent(new KeyboardEvent("keydown",{key:je,bubbles:!0}))},[]),Re=A.useCallback(()=>{L(he=>he+1)},[]),Ze=A.useCallback(he=>{if(L(X=>X+1),!!he){if("fileType"in he){s(null),B(null),W(null),a("books"),ee(he.id);return}if(ee(null),s(he.id),B(null),W(null),he.mediaType==="video"){a("library-videos");return}if(he.mediaType==="podcast"){a("library-podcasts");return}a("library-articles")}},[]),it=A.useCallback(async he=>{const X=await window.electronAPI.articleGet(he);se((X==null?void 0:X.mediaType)??"article"),c(he),d(!0)},[]),tt=A.useCallback(()=>{d(!1),c(null)},[]),rt=A.useCallback(he=>{s(he),a("library-articles"),it(he)},[it]),at=A.useCallback(async he=>{try{await window.electronAPI.feedUpdate({id:he.id,title:he.title??void 0,category:he.category??void 0,fetchInterval:he.fetchInterval}),L(X=>X+1)}catch(X){console.error("Failed to update feed:",X)}},[]),ze=A.useCallback(async he=>{try{await window.electronAPI.feedDelete(he),L(X=>X+1),O===he&&(B(null),a("feeds"))}catch(X){console.error("Failed to delete feed:",X)}},[O]),ft=A.useCallback(async he=>{try{await window.electronAPI.feedFetch(he),L(X=>X+1)}catch(X){console.error("Failed to fetch feed:",X)}},[]),Kt=A.useCallback((he,X)=>{s(he),se(X||"article"),c(he),d(!0)},[]);return l.jsxs("div",{className:"flex flex-col h-screen bg-[#0f0f0f] text-gray-200 overflow-hidden",children:[l.jsx("div",{className:"h-[38px] shrink-0 drag-region flex items-center"}),!h&&!le?l.jsxs("div",{className:"flex flex-1 min-h-0",children:[l.jsx(n9,{collapsed:e,onToggleCollapse:()=>t(!e),activeView:r,onViewChange:he=>{a(he),he==="manage-feeds"&&B(null)},onAddFeed:()=>v(!0),onAddUrl:()=>x(!0),onSearch:()=>y(!0),onShortcutsHelp:()=>E(!0),onDownloads:()=>_(!0),onPreferences:()=>j(!0),onTasks:()=>pe(!0),onNotifications:()=>Ne(!0),selectedFeedId:O,onFeedSelect:he=>{B(he),a("feeds")},refreshTrigger:M,selectedTagId:G,onTagSelect:he=>{W(he),he&&a("tags")}}),r==="discover"?l.jsx(HY,{onFeedAdded:Re}):r==="manage-feeds"?l.jsxs(l.Fragment,{children:[l.jsx(pH,{onSelectFeed:P,selectedFeedId:H,onEditFeed:V,onAddFeed:()=>v(!0),refreshTrigger:M,onDeleteFeed:ze}),l.jsx(xH,{feedId:H,onEditFeed:V,onDeleteFeed:ze,onFetchFeed:ft,onOpenArticle:he=>{s(he),B(H),a("feeds")},refreshTrigger:M,collapsed:Y})]}):r==="books"?l.jsxs(l.Fragment,{children:[l.jsx(bH,{selectedBookId:ae,onSelectBook:ee,onOpenReader:he=>{Z(he),ie(!0)},refreshTrigger:M,expanded:Y}),ae?l.jsx(SH,{bookId:ae,collapsed:Y,onOpenReader:he=>{Z(he),ie(!0)},onRefresh:Re}):l.jsx(AH,{onImported:Re,collapsed:Y})]}):l.jsxs(l.Fragment,{children:[l.jsx(h9,{selectedArticleId:i,onSelectArticle:s,onOpenReader:it,refreshTrigger:M,feedId:r==="feeds"?O:void 0,isShortlisted:r==="shortlist",activeView:r,tagId:r==="tags"?G:void 0,expanded:Y,source:ve,initialTab:_e,mediaType:We,feedType:r==="wechat"?"wechat":void 0}),l.jsx(ZC,{articleId:i,collapsed:Y})]})]}):le&&Q?l.jsx("div",{className:"flex-1 min-h-0",children:l.jsx(VW,{bookId:Q,onClose:()=>{ie(!1),Z(null)}})}):re==="podcast"?l.jsx("div",{className:"flex-1 min-h-0",children:l.jsx(uY,{articleId:o,onClose:tt})}):re==="video"?l.jsx("div",{className:"flex-1 min-h-0",children:l.jsx(tY,{articleId:o,onClose:tt})}):l.jsx("div",{className:"flex-1 min-h-0",children:l.jsx(nH,{articleId:o,onClose:tt})}),l.jsx(sH,{open:f,onClose:()=>p(!1),onExecute:Ie}),l.jsx(aH,{open:g,onClose:()=>v(!1),onFeedAdded:Re}),l.jsx(lH,{open:b,onClose:()=>x(!1),onArticleSaved:Ze}),l.jsx(cH,{open:m,onClose:()=>y(!1),onSelectArticle:rt}),l.jsx(hH,{open:w,onClose:()=>E(!1)}),l.jsx(dY,{open:S,onClose:()=>_(!1)}),l.jsx(EY,{open:T,onClose:()=>j(!1)}),J&&l.jsx(fH,{feed:J,onClose:()=>V(null),onSave:at,onDelete:ze,onFetch:ft}),l.jsx(VY,{open:be,onClose:()=>pe(!1),onNavigateToArticle:Kt}),l.jsx(WY,{open:me,onClose:()=>Ne(!1),onNavigateToArticle:Kt})]})}function ZY(){return l.jsx(l9,{children:l.jsx(KY,{})})}const HD=document.getElementById("root");HD&&Gz.createRoot(HD).render(A.createElement(ZY));
