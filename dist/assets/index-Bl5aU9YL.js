var vO=Object.defineProperty;var D_=n=>{throw TypeError(n)};var xO=(n,e,t)=>e in n?vO(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var fe=(n,e,t)=>xO(n,typeof e!="symbol"?e+"":e,t),Aw=(n,e,t)=>e.has(n)||D_("Cannot "+t);var c=(n,e,t)=>(Aw(n,e,"read from private field"),t?t.call(n):e.get(n)),T=(n,e,t)=>e.has(n)?D_("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),_=(n,e,t,i)=>(Aw(n,e,"write to private field"),i?i.call(n,t):e.set(n,t),t),R=(n,e,t)=>(Aw(n,e,"access private method"),t);var en=(n,e,t,i)=>({set _(s){_(n,e,s,t)},get _(){return c(n,e,i)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();const lt=n=>typeof n=="string",mg=()=>{let n,e;const t=new Promise((i,s)=>{n=i,e=s});return t.resolve=n,t.reject=e,t},j_=n=>n==null?"":""+n,bO=(n,e,t)=>{n.forEach(i=>{e[i]&&(t[i]=e[i])})},wO=/###/g,R_=n=>n&&n.indexOf("###")>-1?n.replace(wO,"."):n,L_=n=>!n||lt(n),am=(n,e,t)=>{const i=lt(e)?e.split("."):e;let s=0;for(;s<i.length-1;){if(L_(n))return{};const r=R_(i[s]);!n[r]&&t&&(n[r]=new t),Object.prototype.hasOwnProperty.call(n,r)?n=n[r]:n={},++s}return L_(n)?{}:{obj:n,k:R_(i[s])}},M_=(n,e,t)=>{const{obj:i,k:s}=am(n,e,Object);if(i!==void 0||e.length===1){i[s]=t;return}let r=e[e.length-1],a=e.slice(0,e.length-1),o=am(n,a,Object);for(;o.obj===void 0&&a.length;)r=`${a[a.length-1]}.${r}`,a=a.slice(0,a.length-1),o=am(n,a,Object),o!=null&&o.obj&&typeof o.obj[`${o.k}.${r}`]<"u"&&(o.obj=void 0);o.obj[`${o.k}.${r}`]=t},SO=(n,e,t,i)=>{const{obj:s,k:r}=am(n,e,Object);s[r]=s[r]||[],s[r].push(t)},Qx=(n,e)=>{const{obj:t,k:i}=am(n,e);if(t&&Object.prototype.hasOwnProperty.call(t,i))return t[i]},AO=(n,e,t)=>{const i=Qx(n,t);return i!==void 0?i:Qx(e,t)},ND=(n,e,t)=>{for(const i in e)i!=="__proto__"&&i!=="constructor"&&(i in n?lt(n[i])||n[i]instanceof String||lt(e[i])||e[i]instanceof String?t&&(n[i]=e[i]):ND(n[i],e[i],t):n[i]=e[i]);return n},od=n=>n.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var EO={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const CO=n=>lt(n)?n.replace(/[&<>"'\/]/g,e=>EO[e]):n;class _O{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const t=this.regExpMap.get(e);if(t!==void 0)return t;const i=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,i),this.regExpQueue.push(e),i}}const NO=[" ",",","?","!",";"],kO=new _O(20),TO=(n,e,t)=>{e=e||"",t=t||"";const i=NO.filter(a=>e.indexOf(a)<0&&t.indexOf(a)<0);if(i.length===0)return!0;const s=kO.getRegExp(`(${i.map(a=>a==="?"?"\\?":a).join("|")})`);let r=!s.test(n);if(!r){const a=n.indexOf(t);a>0&&!s.test(n.substring(0,a))&&(r=!0)}return r},U2=(n,e,t=".")=>{if(!n)return;if(n[e])return Object.prototype.hasOwnProperty.call(n,e)?n[e]:void 0;const i=e.split(t);let s=n;for(let r=0;r<i.length;){if(!s||typeof s!="object")return;let a,o="";for(let l=r;l<i.length;++l)if(l!==r&&(o+=t),o+=i[l],a=s[o],a!==void 0){if(["string","number","boolean"].indexOf(typeof a)>-1&&l<i.length-1)continue;r+=l-r+1;break}s=a}return s},Am=n=>n==null?void 0:n.replace("_","-"),DO={type:"logger",log(n){this.output("log",n)},warn(n){this.output("warn",n)},error(n){this.output("error",n)},output(n,e){var t,i;(i=(t=console==null?void 0:console[n])==null?void 0:t.apply)==null||i.call(t,console,e)}};class Jx{constructor(e,t={}){this.init(e,t)}init(e,t={}){this.prefix=t.prefix||"i18next:",this.logger=e||DO,this.options=t,this.debug=t.debug}log(...e){return this.forward(e,"log","",!0)}warn(...e){return this.forward(e,"warn","",!0)}error(...e){return this.forward(e,"error","")}deprecate(...e){return this.forward(e,"warn","WARNING DEPRECATED: ",!0)}forward(e,t,i,s){return s&&!this.debug?null:(lt(e[0])&&(e[0]=`${i}${this.prefix} ${e[0]}`),this.logger[t](e))}create(e){return new Jx(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return e=e||this.options,e.prefix=e.prefix||this.prefix,new Jx(this.logger,e)}}var Va=new Jx;let C1=class{constructor(){this.observers={}}on(e,t){return e.split(" ").forEach(i=>{this.observers[i]||(this.observers[i]=new Map);const s=this.observers[i].get(t)||0;this.observers[i].set(t,s+1)}),this}off(e,t){if(this.observers[e]){if(!t){delete this.observers[e];return}this.observers[e].delete(t)}}emit(e,...t){this.observers[e]&&Array.from(this.observers[e].entries()).forEach(([s,r])=>{for(let a=0;a<r;a++)s(...t)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(([s,r])=>{for(let a=0;a<r;a++)s.apply(s,[e,...t])})}};class O_ extends C1{constructor(e,t={ns:["translation"],defaultNS:"translation"}){super(),this.data=e||{},this.options=t,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}getResource(e,t,i,s={}){var u,d;const r=s.keySeparator!==void 0?s.keySeparator:this.options.keySeparator,a=s.ignoreJSONStructure!==void 0?s.ignoreJSONStructure:this.options.ignoreJSONStructure;let o;e.indexOf(".")>-1?o=e.split("."):(o=[e,t],i&&(Array.isArray(i)?o.push(...i):lt(i)&&r?o.push(...i.split(r)):o.push(i)));const l=Qx(this.data,o);return!l&&!t&&!i&&e.indexOf(".")>-1&&(e=o[0],t=o[1],i=o.slice(2).join(".")),l||!a||!lt(i)?l:U2((d=(u=this.data)==null?void 0:u[e])==null?void 0:d[t],i,r)}addResource(e,t,i,s,r={silent:!1}){const a=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator;let o=[e,t];i&&(o=o.concat(a?i.split(a):i)),e.indexOf(".")>-1&&(o=e.split("."),s=t,t=o[1]),this.addNamespaces(t),M_(this.data,o,s),r.silent||this.emit("added",e,t,i,s)}addResources(e,t,i,s={silent:!1}){for(const r in i)(lt(i[r])||Array.isArray(i[r]))&&this.addResource(e,t,r,i[r],{silent:!0});s.silent||this.emit("added",e,t,i)}addResourceBundle(e,t,i,s,r,a={silent:!1,skipCopy:!1}){let o=[e,t];e.indexOf(".")>-1&&(o=e.split("."),s=i,i=t,t=o[1]),this.addNamespaces(t);let l=Qx(this.data,o)||{};a.skipCopy||(i=JSON.parse(JSON.stringify(i))),s?ND(l,i,r):l={...l,...i},M_(this.data,o,l),a.silent||this.emit("added",e,t,i)}removeResourceBundle(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}hasResourceBundle(e,t){return this.getResource(e,t)!==void 0}getResourceBundle(e,t){return t||(t=this.options.defaultNS),this.getResource(e,t)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const t=this.getDataByLanguage(e);return!!(t&&Object.keys(t)||[]).find(s=>t[s]&&Object.keys(t[s]).length>0)}toJSON(){return this.data}}var kD={processors:{},addPostProcessor(n){this.processors[n.name]=n},handle(n,e,t,i,s){return n.forEach(r=>{var a;e=((a=this.processors[r])==null?void 0:a.process(e,t,i,s))??e}),e}};const TD=Symbol("i18next/PATH_KEY");function jO(){const n=[],e=Object.create(null);let t;return e.get=(i,s)=>{var r;return(r=t==null?void 0:t.revoke)==null||r.call(t),s===TD?n:(n.push(s),t=Proxy.revocable(i,e),t.proxy)},Proxy.revocable(Object.create(null),e).proxy}function H2(n,e){const{[TD]:t}=n(jO());return t.join((e==null?void 0:e.keySeparator)??".")}const I_={},Ew=n=>!lt(n)&&typeof n!="boolean"&&typeof n!="number";class eb extends C1{constructor(e,t={}){super(),bO(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=t,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=Va.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e,t={interpolation:{}}){const i={...t};if(e==null)return!1;const s=this.resolve(e,i);if((s==null?void 0:s.res)===void 0)return!1;const r=Ew(s.res);return!(i.returnObjects===!1&&r)}extractFromKey(e,t){let i=t.nsSeparator!==void 0?t.nsSeparator:this.options.nsSeparator;i===void 0&&(i=":");const s=t.keySeparator!==void 0?t.keySeparator:this.options.keySeparator;let r=t.ns||this.options.defaultNS||[];const a=i&&e.indexOf(i)>-1,o=!this.options.userDefinedKeySeparator&&!t.keySeparator&&!this.options.userDefinedNsSeparator&&!t.nsSeparator&&!TO(e,i,s);if(a&&!o){const l=e.match(this.interpolator.nestingRegexp);if(l&&l.length>0)return{key:e,namespaces:lt(r)?[r]:r};const u=e.split(i);(i!==s||i===s&&this.options.ns.indexOf(u[0])>-1)&&(r=u.shift()),e=u.join(s)}return{key:e,namespaces:lt(r)?[r]:r}}translate(e,t,i){let s=typeof t=="object"?{...t}:t;if(typeof s!="object"&&this.options.overloadTranslationOptionHandler&&(s=this.options.overloadTranslationOptionHandler(arguments)),typeof s=="object"&&(s={...s}),s||(s={}),e==null)return"";typeof e=="function"&&(e=H2(e,{...this.options,...s})),Array.isArray(e)||(e=[String(e)]);const r=s.returnDetails!==void 0?s.returnDetails:this.options.returnDetails,a=s.keySeparator!==void 0?s.keySeparator:this.options.keySeparator,{key:o,namespaces:l}=this.extractFromKey(e[e.length-1],s),u=l[l.length-1];let d=s.nsSeparator!==void 0?s.nsSeparator:this.options.nsSeparator;d===void 0&&(d=":");const f=s.lng||this.language,p=s.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if((f==null?void 0:f.toLowerCase())==="cimode")return p?r?{res:`${u}${d}${o}`,usedKey:o,exactUsedKey:o,usedLng:f,usedNS:u,usedParams:this.getUsedParamsDetails(s)}:`${u}${d}${o}`:r?{res:o,usedKey:o,exactUsedKey:o,usedLng:f,usedNS:u,usedParams:this.getUsedParamsDetails(s)}:o;const g=this.resolve(e,s);let x=g==null?void 0:g.res;const w=(g==null?void 0:g.usedKey)||o,y=(g==null?void 0:g.exactUsedKey)||o,m=["[object Number]","[object Function]","[object RegExp]"],v=s.joinArrays!==void 0?s.joinArrays:this.options.joinArrays,b=!this.i18nFormat||this.i18nFormat.handleAsObject,A=s.count!==void 0&&!lt(s.count),S=eb.hasDefaultValue(s),C=A?this.pluralResolver.getSuffix(f,s.count,s):"",k=s.ordinal&&A?this.pluralResolver.getSuffix(f,s.count,{ordinal:!1}):"",L=A&&!s.ordinal&&s.count===0,D=L&&s[`defaultValue${this.options.pluralSeparator}zero`]||s[`defaultValue${C}`]||s[`defaultValue${k}`]||s.defaultValue;let j=x;b&&!x&&S&&(j=D);const P=Ew(j),H=Object.prototype.toString.apply(j);if(b&&j&&P&&m.indexOf(H)<0&&!(lt(v)&&Array.isArray(j))){if(!s.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const G=this.options.returnedObjectHandler?this.options.returnedObjectHandler(w,j,{...s,ns:l}):`key '${o} (${this.language})' returned an object instead of string.`;return r?(g.res=G,g.usedParams=this.getUsedParamsDetails(s),g):G}if(a){const G=Array.isArray(j),$=G?[]:{},Y=G?y:w;for(const F in j)if(Object.prototype.hasOwnProperty.call(j,F)){const M=`${Y}${a}${F}`;S&&!x?$[F]=this.translate(M,{...s,defaultValue:Ew(D)?D[F]:void 0,joinArrays:!1,ns:l}):$[F]=this.translate(M,{...s,joinArrays:!1,ns:l}),$[F]===M&&($[F]=j[F])}x=$}}else if(b&&lt(v)&&Array.isArray(x))x=x.join(v),x&&(x=this.extendTranslation(x,e,s,i));else{let G=!1,$=!1;!this.isValidLookup(x)&&S&&(G=!0,x=D),this.isValidLookup(x)||($=!0,x=o);const F=(s.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&$?void 0:x,M=S&&D!==x&&this.options.updateMissing;if($||G||M){if(this.logger.log(M?"updateKey":"missingKey",f,u,o,M?D:x),a){const ge=this.resolve(o,{...s,keySeparator:!1});ge&&ge.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let I=[];const V=this.languageUtils.getFallbackCodes(this.options.fallbackLng,s.lng||this.language);if(this.options.saveMissingTo==="fallback"&&V&&V[0])for(let ge=0;ge<V.length;ge++)I.push(V[ge]);else this.options.saveMissingTo==="all"?I=this.languageUtils.toResolveHierarchy(s.lng||this.language):I.push(s.lng||this.language);const ie=(ge,ee,me)=>{var ae;const oe=S&&me!==x?me:F;this.options.missingKeyHandler?this.options.missingKeyHandler(ge,u,ee,oe,M,s):(ae=this.backendConnector)!=null&&ae.saveMissing&&this.backendConnector.saveMissing(ge,u,ee,oe,M,s),this.emit("missingKey",ge,u,ee,x)};this.options.saveMissing&&(this.options.saveMissingPlurals&&A?I.forEach(ge=>{const ee=this.pluralResolver.getSuffixes(ge,s);L&&s[`defaultValue${this.options.pluralSeparator}zero`]&&ee.indexOf(`${this.options.pluralSeparator}zero`)<0&&ee.push(`${this.options.pluralSeparator}zero`),ee.forEach(me=>{ie([ge],o+me,s[`defaultValue${me}`]||D)})}):ie(I,o,D))}x=this.extendTranslation(x,e,s,g,i),$&&x===o&&this.options.appendNamespaceToMissingKey&&(x=`${u}${d}${o}`),($||G)&&this.options.parseMissingKeyHandler&&(x=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${u}${d}${o}`:o,G?x:void 0,s))}return r?(g.res=x,g.usedParams=this.getUsedParamsDetails(s),g):x}extendTranslation(e,t,i,s,r){var l,u;if((l=this.i18nFormat)!=null&&l.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...i},i.lng||this.language||s.usedLng,s.usedNS,s.usedKey,{resolved:s});else if(!i.skipInterpolation){i.interpolation&&this.interpolator.init({...i,interpolation:{...this.options.interpolation,...i.interpolation}});const d=lt(e)&&(((u=i==null?void 0:i.interpolation)==null?void 0:u.skipOnVariables)!==void 0?i.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let f;if(d){const g=e.match(this.interpolator.nestingRegexp);f=g&&g.length}let p=i.replace&&!lt(i.replace)?i.replace:i;if(this.options.interpolation.defaultVariables&&(p={...this.options.interpolation.defaultVariables,...p}),e=this.interpolator.interpolate(e,p,i.lng||this.language||s.usedLng,i),d){const g=e.match(this.interpolator.nestingRegexp),x=g&&g.length;f<x&&(i.nest=!1)}!i.lng&&s&&s.res&&(i.lng=this.language||s.usedLng),i.nest!==!1&&(e=this.interpolator.nest(e,(...g)=>(r==null?void 0:r[0])===g[0]&&!i.context?(this.logger.warn(`It seems you are nesting recursively key: ${g[0]} in key: ${t[0]}`),null):this.translate(...g,t),i)),i.interpolation&&this.interpolator.reset()}const a=i.postProcess||this.options.postProcess,o=lt(a)?[a]:a;return e!=null&&(o!=null&&o.length)&&i.applyPostProcessor!==!1&&(e=kD.handle(o,e,t,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...s,usedParams:this.getUsedParamsDetails(i)},...i}:i,this)),e}resolve(e,t={}){let i,s,r,a,o;return lt(e)&&(e=[e]),e.forEach(l=>{if(this.isValidLookup(i))return;const u=this.extractFromKey(l,t),d=u.key;s=d;let f=u.namespaces;this.options.fallbackNS&&(f=f.concat(this.options.fallbackNS));const p=t.count!==void 0&&!lt(t.count),g=p&&!t.ordinal&&t.count===0,x=t.context!==void 0&&(lt(t.context)||typeof t.context=="number")&&t.context!=="",w=t.lngs?t.lngs:this.languageUtils.toResolveHierarchy(t.lng||this.language,t.fallbackLng);f.forEach(y=>{var m,v;this.isValidLookup(i)||(o=y,!I_[`${w[0]}-${y}`]&&((m=this.utils)!=null&&m.hasLoadedNamespace)&&!((v=this.utils)!=null&&v.hasLoadedNamespace(o))&&(I_[`${w[0]}-${y}`]=!0,this.logger.warn(`key "${s}" for languages "${w.join(", ")}" won't get resolved as namespace "${o}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),w.forEach(b=>{var C;if(this.isValidLookup(i))return;a=b;const A=[d];if((C=this.i18nFormat)!=null&&C.addLookupKeys)this.i18nFormat.addLookupKeys(A,d,b,y,t);else{let k;p&&(k=this.pluralResolver.getSuffix(b,t.count,t));const L=`${this.options.pluralSeparator}zero`,D=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(p&&(t.ordinal&&k.indexOf(D)===0&&A.push(d+k.replace(D,this.options.pluralSeparator)),A.push(d+k),g&&A.push(d+L)),x){const j=`${d}${this.options.contextSeparator||"_"}${t.context}`;A.push(j),p&&(t.ordinal&&k.indexOf(D)===0&&A.push(j+k.replace(D,this.options.pluralSeparator)),A.push(j+k),g&&A.push(j+L))}}let S;for(;S=A.pop();)this.isValidLookup(i)||(r=S,i=this.getResource(b,y,S,t))}))})}),{res:i,usedKey:s,exactUsedKey:r,usedLng:a,usedNS:o}}isValidLookup(e){return e!==void 0&&!(!this.options.returnNull&&e===null)&&!(!this.options.returnEmptyString&&e==="")}getResource(e,t,i,s={}){var r;return(r=this.i18nFormat)!=null&&r.getResource?this.i18nFormat.getResource(e,t,i,s):this.resourceStore.getResource(e,t,i,s)}getUsedParamsDetails(e={}){const t=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],i=e.replace&&!lt(e.replace);let s=i?e.replace:e;if(i&&typeof e.count<"u"&&(s.count=e.count),this.options.interpolation.defaultVariables&&(s={...this.options.interpolation.defaultVariables,...s}),!i){s={...s};for(const r of t)delete s[r]}return s}static hasDefaultValue(e){const t="defaultValue";for(const i in e)if(Object.prototype.hasOwnProperty.call(e,i)&&t===i.substring(0,t.length)&&e[i]!==void 0)return!0;return!1}}class P_{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=Va.create("languageUtils")}getScriptPartFromCode(e){if(e=Am(e),!e||e.indexOf("-")<0)return null;const t=e.split("-");return t.length===2||(t.pop(),t[t.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(t.join("-"))}getLanguagePartFromCode(e){if(e=Am(e),!e||e.indexOf("-")<0)return e;const t=e.split("-");return this.formatLanguageCode(t[0])}formatLanguageCode(e){if(lt(e)&&e.indexOf("-")>-1){let t;try{t=Intl.getCanonicalLocales(e)[0]}catch{}return t&&this.options.lowerCaseLng&&(t=t.toLowerCase()),t||(this.options.lowerCaseLng?e.toLowerCase():e)}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let t;return e.forEach(i=>{if(t)return;const s=this.formatLanguageCode(i);(!this.options.supportedLngs||this.isSupportedCode(s))&&(t=s)}),!t&&this.options.supportedLngs&&e.forEach(i=>{if(t)return;const s=this.getScriptPartFromCode(i);if(this.isSupportedCode(s))return t=s;const r=this.getLanguagePartFromCode(i);if(this.isSupportedCode(r))return t=r;t=this.options.supportedLngs.find(a=>{if(a===r)return a;if(!(a.indexOf("-")<0&&r.indexOf("-")<0)&&(a.indexOf("-")>0&&r.indexOf("-")<0&&a.substring(0,a.indexOf("-"))===r||a.indexOf(r)===0&&r.length>1))return a})}),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t}getFallbackCodes(e,t){if(!e)return[];if(typeof e=="function"&&(e=e(t)),lt(e)&&(e=[e]),Array.isArray(e))return e;if(!t)return e.default||[];let i=e[t];return i||(i=e[this.getScriptPartFromCode(t)]),i||(i=e[this.formatLanguageCode(t)]),i||(i=e[this.getLanguagePartFromCode(t)]),i||(i=e.default),i||[]}toResolveHierarchy(e,t){const i=this.getFallbackCodes((t===!1?[]:t)||this.options.fallbackLng||[],e),s=[],r=a=>{a&&(this.isSupportedCode(a)?s.push(a):this.logger.warn(`rejecting language code not found in supportedLngs: ${a}`))};return lt(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&r(this.formatLanguageCode(e)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&r(this.getScriptPartFromCode(e)),this.options.load!=="currentOnly"&&r(this.getLanguagePartFromCode(e))):lt(e)&&r(this.formatLanguageCode(e)),i.forEach(a=>{s.indexOf(a)<0&&r(this.formatLanguageCode(a))}),s}}const B_={zero:0,one:1,two:2,few:3,many:4,other:5},F_={select:n=>n===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class RO{constructor(e,t={}){this.languageUtils=e,this.options=t,this.logger=Va.create("pluralResolver"),this.pluralRulesCache={}}clearCache(){this.pluralRulesCache={}}getRule(e,t={}){const i=Am(e==="dev"?"en":e),s=t.ordinal?"ordinal":"cardinal",r=JSON.stringify({cleanedCode:i,type:s});if(r in this.pluralRulesCache)return this.pluralRulesCache[r];let a;try{a=new Intl.PluralRules(i,{type:s})}catch{if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),F_;if(!e.match(/-|_/))return F_;const l=this.languageUtils.getLanguagePartFromCode(e);a=this.getRule(l,t)}return this.pluralRulesCache[r]=a,a}needsPlural(e,t={}){let i=this.getRule(e,t);return i||(i=this.getRule("dev",t)),(i==null?void 0:i.resolvedOptions().pluralCategories.length)>1}getPluralFormsOfKey(e,t,i={}){return this.getSuffixes(e,i).map(s=>`${t}${s}`)}getSuffixes(e,t={}){let i=this.getRule(e,t);return i||(i=this.getRule("dev",t)),i?i.resolvedOptions().pluralCategories.sort((s,r)=>B_[s]-B_[r]).map(s=>`${this.options.prepend}${t.ordinal?`ordinal${this.options.prepend}`:""}${s}`):[]}getSuffix(e,t,i={}){const s=this.getRule(e,i);return s?`${this.options.prepend}${i.ordinal?`ordinal${this.options.prepend}`:""}${s.select(t)}`:(this.logger.warn(`no plural rule found for: ${e}`),this.getSuffix("dev",t,i))}}const z_=(n,e,t,i=".",s=!0)=>{let r=AO(n,e,t);return!r&&s&&lt(t)&&(r=U2(n,t,i),r===void 0&&(r=U2(e,t,i))),r},Cw=n=>n.replace(/\$/g,"$$$$");class U_{constructor(e={}){var t;this.logger=Va.create("interpolator"),this.options=e,this.format=((t=e==null?void 0:e.interpolation)==null?void 0:t.format)||(i=>i),this.init(e)}init(e={}){e.interpolation||(e.interpolation={escapeValue:!0});const{escape:t,escapeValue:i,useRawValueToEscape:s,prefix:r,prefixEscaped:a,suffix:o,suffixEscaped:l,formatSeparator:u,unescapeSuffix:d,unescapePrefix:f,nestingPrefix:p,nestingPrefixEscaped:g,nestingSuffix:x,nestingSuffixEscaped:w,nestingOptionsSeparator:y,maxReplaces:m,alwaysFormat:v}=e.interpolation;this.escape=t!==void 0?t:CO,this.escapeValue=i!==void 0?i:!0,this.useRawValueToEscape=s!==void 0?s:!1,this.prefix=r?od(r):a||"{{",this.suffix=o?od(o):l||"}}",this.formatSeparator=u||",",this.unescapePrefix=d?"":f||"-",this.unescapeSuffix=this.unescapePrefix?"":d||"",this.nestingPrefix=p?od(p):g||od("$t("),this.nestingSuffix=x?od(x):w||od(")"),this.nestingOptionsSeparator=y||",",this.maxReplaces=m||1e3,this.alwaysFormat=v!==void 0?v:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(t,i)=>(t==null?void 0:t.source)===i?(t.lastIndex=0,t):new RegExp(i,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}((?:[^()"']+|"[^"]*"|'[^']*'|\\((?:[^()]|"[^"]*"|'[^']*')*\\))*?)${this.nestingSuffix}`)}interpolate(e,t,i,s){var g;let r,a,o;const l=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},u=x=>{if(x.indexOf(this.formatSeparator)<0){const v=z_(t,l,x,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(v,void 0,i,{...s,...t,interpolationkey:x}):v}const w=x.split(this.formatSeparator),y=w.shift().trim(),m=w.join(this.formatSeparator).trim();return this.format(z_(t,l,y,this.options.keySeparator,this.options.ignoreJSONStructure),m,i,{...s,...t,interpolationkey:y})};this.resetRegExp();const d=(s==null?void 0:s.missingInterpolationHandler)||this.options.missingInterpolationHandler,f=((g=s==null?void 0:s.interpolation)==null?void 0:g.skipOnVariables)!==void 0?s.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:x=>Cw(x)},{regex:this.regexp,safeValue:x=>this.escapeValue?Cw(this.escape(x)):Cw(x)}].forEach(x=>{for(o=0;r=x.regex.exec(e);){const w=r[1].trim();if(a=u(w),a===void 0)if(typeof d=="function"){const m=d(e,r,s);a=lt(m)?m:""}else if(s&&Object.prototype.hasOwnProperty.call(s,w))a="";else if(f){a=r[0];continue}else this.logger.warn(`missed to pass in variable ${w} for interpolating ${e}`),a="";else!lt(a)&&!this.useRawValueToEscape&&(a=j_(a));const y=x.safeValue(a);if(e=e.replace(r[0],y),f?(x.regex.lastIndex+=a.length,x.regex.lastIndex-=r[0].length):x.regex.lastIndex=0,o++,o>=this.maxReplaces)break}}),e}nest(e,t,i={}){let s,r,a;const o=(l,u)=>{const d=this.nestingOptionsSeparator;if(l.indexOf(d)<0)return l;const f=l.split(new RegExp(`${d}[ ]*{`));let p=`{${f[1]}`;l=f[0],p=this.interpolate(p,a);const g=p.match(/'/g),x=p.match(/"/g);(((g==null?void 0:g.length)??0)%2===0&&!x||x.length%2!==0)&&(p=p.replace(/'/g,'"'));try{a=JSON.parse(p),u&&(a={...u,...a})}catch(w){return this.logger.warn(`failed parsing options string in nesting for key ${l}`,w),`${l}${d}${p}`}return a.defaultValue&&a.defaultValue.indexOf(this.prefix)>-1&&delete a.defaultValue,l};for(;s=this.nestingRegexp.exec(e);){let l=[];a={...i},a=a.replace&&!lt(a.replace)?a.replace:a,a.applyPostProcessor=!1,delete a.defaultValue;const u=/{.*}/.test(s[1])?s[1].lastIndexOf("}")+1:s[1].indexOf(this.formatSeparator);if(u!==-1&&(l=s[1].slice(u).split(this.formatSeparator).map(d=>d.trim()).filter(Boolean),s[1]=s[1].slice(0,u)),r=t(o.call(this,s[1].trim(),a),a),r&&s[0]===e&&!lt(r))return r;lt(r)||(r=j_(r)),r||(this.logger.warn(`missed to resolve ${s[1]} for nesting ${e}`),r=""),l.length&&(r=l.reduce((d,f)=>this.format(d,f,i.lng,{...i,interpolationkey:s[1].trim()}),r.trim())),e=e.replace(s[0],r),this.regexp.lastIndex=0}return e}}const LO=n=>{let e=n.toLowerCase().trim();const t={};if(n.indexOf("(")>-1){const i=n.split("(");e=i[0].toLowerCase().trim();const s=i[1].substring(0,i[1].length-1);e==="currency"&&s.indexOf(":")<0?t.currency||(t.currency=s.trim()):e==="relativetime"&&s.indexOf(":")<0?t.range||(t.range=s.trim()):s.split(";").forEach(a=>{if(a){const[o,...l]=a.split(":"),u=l.join(":").trim().replace(/^'+|'+$/g,""),d=o.trim();t[d]||(t[d]=u),u==="false"&&(t[d]=!1),u==="true"&&(t[d]=!0),isNaN(u)||(t[d]=parseInt(u,10))}})}return{formatName:e,formatOptions:t}},H_=n=>{const e={};return(t,i,s)=>{let r=s;s&&s.interpolationkey&&s.formatParams&&s.formatParams[s.interpolationkey]&&s[s.interpolationkey]&&(r={...r,[s.interpolationkey]:void 0});const a=i+JSON.stringify(r);let o=e[a];return o||(o=n(Am(i),s),e[a]=o),o(t)}},MO=n=>(e,t,i)=>n(Am(t),i)(e);class OO{constructor(e={}){this.logger=Va.create("formatter"),this.options=e,this.init(e)}init(e,t={interpolation:{}}){this.formatSeparator=t.interpolation.formatSeparator||",";const i=t.cacheInBuiltFormats?H_:MO;this.formats={number:i((s,r)=>{const a=new Intl.NumberFormat(s,{...r});return o=>a.format(o)}),currency:i((s,r)=>{const a=new Intl.NumberFormat(s,{...r,style:"currency"});return o=>a.format(o)}),datetime:i((s,r)=>{const a=new Intl.DateTimeFormat(s,{...r});return o=>a.format(o)}),relativetime:i((s,r)=>{const a=new Intl.RelativeTimeFormat(s,{...r});return o=>a.format(o,r.range||"day")}),list:i((s,r)=>{const a=new Intl.ListFormat(s,{...r});return o=>a.format(o)})}}add(e,t){this.formats[e.toLowerCase().trim()]=t}addCached(e,t){this.formats[e.toLowerCase().trim()]=H_(t)}format(e,t,i,s={}){const r=t.split(this.formatSeparator);if(r.length>1&&r[0].indexOf("(")>1&&r[0].indexOf(")")<0&&r.find(o=>o.indexOf(")")>-1)){const o=r.findIndex(l=>l.indexOf(")")>-1);r[0]=[r[0],...r.splice(1,o)].join(this.formatSeparator)}return r.reduce((o,l)=>{var f;const{formatName:u,formatOptions:d}=LO(l);if(this.formats[u]){let p=o;try{const g=((f=s==null?void 0:s.formatParams)==null?void 0:f[s.interpolationkey])||{},x=g.locale||g.lng||s.locale||s.lng||i;p=this.formats[u](o,x,{...d,...s,...g})}catch(g){this.logger.warn(g)}return p}else this.logger.warn(`there was no format function for ${u}`);return o},e)}}const IO=(n,e)=>{n.pending[e]!==void 0&&(delete n.pending[e],n.pendingCount--)};class PO extends C1{constructor(e,t,i,s={}){var r,a;super(),this.backend=e,this.store=t,this.services=i,this.languageUtils=i.languageUtils,this.options=s,this.logger=Va.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=s.maxParallelReads||10,this.readingCalls=0,this.maxRetries=s.maxRetries>=0?s.maxRetries:5,this.retryTimeout=s.retryTimeout>=1?s.retryTimeout:350,this.state={},this.queue=[],(a=(r=this.backend)==null?void 0:r.init)==null||a.call(r,i,s.backend,s)}queueLoad(e,t,i,s){const r={},a={},o={},l={};return e.forEach(u=>{let d=!0;t.forEach(f=>{const p=`${u}|${f}`;!i.reload&&this.store.hasResourceBundle(u,f)?this.state[p]=2:this.state[p]<0||(this.state[p]===1?a[p]===void 0&&(a[p]=!0):(this.state[p]=1,d=!1,a[p]===void 0&&(a[p]=!0),r[p]===void 0&&(r[p]=!0),l[f]===void 0&&(l[f]=!0)))}),d||(o[u]=!0)}),(Object.keys(r).length||Object.keys(a).length)&&this.queue.push({pending:a,pendingCount:Object.keys(a).length,loaded:{},errors:[],callback:s}),{toLoad:Object.keys(r),pending:Object.keys(a),toLoadLanguages:Object.keys(o),toLoadNamespaces:Object.keys(l)}}loaded(e,t,i){const s=e.split("|"),r=s[0],a=s[1];t&&this.emit("failedLoading",r,a,t),!t&&i&&this.store.addResourceBundle(r,a,i,void 0,void 0,{skipCopy:!0}),this.state[e]=t?-1:2,t&&i&&(this.state[e]=0);const o={};this.queue.forEach(l=>{SO(l.loaded,[r],a),IO(l,e),t&&l.errors.push(t),l.pendingCount===0&&!l.done&&(Object.keys(l.loaded).forEach(u=>{o[u]||(o[u]={});const d=l.loaded[u];d.length&&d.forEach(f=>{o[u][f]===void 0&&(o[u][f]=!0)})}),l.done=!0,l.errors.length?l.callback(l.errors):l.callback())}),this.emit("loaded",o),this.queue=this.queue.filter(l=>!l.done)}read(e,t,i,s=0,r=this.retryTimeout,a){if(!e.length)return a(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:e,ns:t,fcName:i,tried:s,wait:r,callback:a});return}this.readingCalls++;const o=(u,d)=>{if(this.readingCalls--,this.waitingReads.length>0){const f=this.waitingReads.shift();this.read(f.lng,f.ns,f.fcName,f.tried,f.wait,f.callback)}if(u&&d&&s<this.maxRetries){setTimeout(()=>{this.read.call(this,e,t,i,s+1,r*2,a)},r);return}a(u,d)},l=this.backend[i].bind(this.backend);if(l.length===2){try{const u=l(e,t);u&&typeof u.then=="function"?u.then(d=>o(null,d)).catch(o):o(null,u)}catch(u){o(u)}return}return l(e,t,o)}prepareLoading(e,t,i={},s){if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),s&&s();lt(e)&&(e=this.languageUtils.toResolveHierarchy(e)),lt(t)&&(t=[t]);const r=this.queueLoad(e,t,i,s);if(!r.toLoad.length)return r.pending.length||s(),null;r.toLoad.forEach(a=>{this.loadOne(a)})}load(e,t,i){this.prepareLoading(e,t,{},i)}reload(e,t,i){this.prepareLoading(e,t,{reload:!0},i)}loadOne(e,t=""){const i=e.split("|"),s=i[0],r=i[1];this.read(s,r,"read",void 0,void 0,(a,o)=>{a&&this.logger.warn(`${t}loading namespace ${r} for language ${s} failed`,a),!a&&o&&this.logger.log(`${t}loaded namespace ${r} for language ${s}`,o),this.loaded(e,a,o)})}saveMissing(e,t,i,s,r,a={},o=()=>{}){var l,u,d,f,p;if((u=(l=this.services)==null?void 0:l.utils)!=null&&u.hasLoadedNamespace&&!((f=(d=this.services)==null?void 0:d.utils)!=null&&f.hasLoadedNamespace(t))){this.logger.warn(`did not save key "${i}" as the namespace "${t}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(i==null||i==="")){if((p=this.backend)!=null&&p.create){const g={...a,isUpdate:r},x=this.backend.create.bind(this.backend);if(x.length<6)try{let w;x.length===5?w=x(e,t,i,s,g):w=x(e,t,i,s),w&&typeof w.then=="function"?w.then(y=>o(null,y)).catch(o):o(null,w)}catch(w){o(w)}else x(e,t,i,s,o,g)}!e||!e[0]||this.store.addResource(e[0],t,i,s)}}}const _w=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:n=>{let e={};if(typeof n[1]=="object"&&(e=n[1]),lt(n[1])&&(e.defaultValue=n[1]),lt(n[2])&&(e.tDescription=n[2]),typeof n[2]=="object"||typeof n[3]=="object"){const t=n[3]||n[2];Object.keys(t).forEach(i=>{e[i]=t[i]})}return e},interpolation:{escapeValue:!0,format:n=>n,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0},cacheInBuiltFormats:!0}),$_=n=>{var e,t;return lt(n.ns)&&(n.ns=[n.ns]),lt(n.fallbackLng)&&(n.fallbackLng=[n.fallbackLng]),lt(n.fallbackNS)&&(n.fallbackNS=[n.fallbackNS]),((t=(e=n.supportedLngs)==null?void 0:e.indexOf)==null?void 0:t.call(e,"cimode"))<0&&(n.supportedLngs=n.supportedLngs.concat(["cimode"])),typeof n.initImmediate=="boolean"&&(n.initAsync=n.initImmediate),n},wv=()=>{},BO=n=>{Object.getOwnPropertyNames(Object.getPrototypeOf(n)).forEach(t=>{typeof n[t]=="function"&&(n[t]=n[t].bind(n))})};let q_=!1;const FO=n=>{var e,t,i,s,r,a,o,l,u;return!!(((i=(t=(e=n==null?void 0:n.modules)==null?void 0:e.backend)==null?void 0:t.name)==null?void 0:i.indexOf("Locize"))>0||((o=(a=(r=(s=n==null?void 0:n.modules)==null?void 0:s.backend)==null?void 0:r.constructor)==null?void 0:a.name)==null?void 0:o.indexOf("Locize"))>0||(u=(l=n==null?void 0:n.options)==null?void 0:l.backend)!=null&&u.backends&&n.options.backend.backends.some(d=>{var f,p,g;return((f=d==null?void 0:d.name)==null?void 0:f.indexOf("Locize"))>0||((g=(p=d==null?void 0:d.constructor)==null?void 0:p.name)==null?void 0:g.indexOf("Locize"))>0}))};class om extends C1{constructor(e={},t){if(super(),this.options=$_(e),this.services={},this.logger=Va,this.modules={external:[]},BO(this),t&&!this.isInitialized&&!e.isClone){if(!this.options.initAsync)return this.init(e,t),this;setTimeout(()=>{this.init(e,t)},0)}}init(e={},t){this.isInitializing=!0,typeof e=="function"&&(t=e,e={}),e.defaultNS==null&&e.ns&&(lt(e.ns)?e.defaultNS=e.ns:e.ns.indexOf("translation")<0&&(e.defaultNS=e.ns[0]));const i=_w();this.options={...i,...this.options,...$_(e)},this.options.interpolation={...i.interpolation,...this.options.interpolation},e.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=e.keySeparator),e.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=e.nsSeparator),typeof this.options.overloadTranslationOptionHandler!="function"&&(this.options.overloadTranslationOptionHandler=i.overloadTranslationOptionHandler),this.options.showSupportNotice!==!1&&!FO(this)&&!q_&&(typeof console<"u"&&typeof console.info<"u"&&console.info("ðŸŒ i18next is maintained with support from Locize â€” consider powering your project with managed localization (AI, CDN, integrations): https://locize.com ðŸ’™"),q_=!0);const s=u=>u?typeof u=="function"?new u:u:null;if(!this.options.isClone){this.modules.logger?Va.init(s(this.modules.logger),this.options):Va.init(null,this.options);let u;this.modules.formatter?u=this.modules.formatter:u=OO;const d=new P_(this.options);this.store=new O_(this.options.resources,this.options);const f=this.services;f.logger=Va,f.resourceStore=this.store,f.languageUtils=d,f.pluralResolver=new RO(d,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),this.options.interpolation.format&&this.options.interpolation.format!==i.interpolation.format&&this.logger.deprecate("init: you are still using the legacy format function, please use the new approach: https://www.i18next.com/translation-function/formatting"),u&&(!this.options.interpolation.format||this.options.interpolation.format===i.interpolation.format)&&(f.formatter=s(u),f.formatter.init&&f.formatter.init(f,this.options),this.options.interpolation.format=f.formatter.format.bind(f.formatter)),f.interpolator=new U_(this.options),f.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},f.backendConnector=new PO(s(this.modules.backend),f.resourceStore,f,this.options),f.backendConnector.on("*",(g,...x)=>{this.emit(g,...x)}),this.modules.languageDetector&&(f.languageDetector=s(this.modules.languageDetector),f.languageDetector.init&&f.languageDetector.init(f,this.options.detection,this.options)),this.modules.i18nFormat&&(f.i18nFormat=s(this.modules.i18nFormat),f.i18nFormat.init&&f.i18nFormat.init(this)),this.translator=new eb(this.services,this.options),this.translator.on("*",(g,...x)=>{this.emit(g,...x)}),this.modules.external.forEach(g=>{g.init&&g.init(this)})}if(this.format=this.options.interpolation.format,t||(t=wv),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const u=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);u.length>0&&u[0]!=="dev"&&(this.options.lng=u[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(u=>{this[u]=(...d)=>this.store[u](...d)}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(u=>{this[u]=(...d)=>(this.store[u](...d),this)});const o=mg(),l=()=>{const u=(d,f)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),o.resolve(f),t(d,f)};if(this.languages&&!this.isInitialized)return u(null,this.t.bind(this));this.changeLanguage(this.options.lng,u)};return this.options.resources||!this.options.initAsync?l():setTimeout(l,0),o}loadResources(e,t=wv){var r,a;let i=t;const s=lt(e)?e:this.language;if(typeof e=="function"&&(i=e),!this.options.resources||this.options.partialBundledLanguages){if((s==null?void 0:s.toLowerCase())==="cimode"&&(!this.options.preload||this.options.preload.length===0))return i();const o=[],l=u=>{if(!u||u==="cimode")return;this.services.languageUtils.toResolveHierarchy(u).forEach(f=>{f!=="cimode"&&o.indexOf(f)<0&&o.push(f)})};s?l(s):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(d=>l(d)),(a=(r=this.options.preload)==null?void 0:r.forEach)==null||a.call(r,u=>l(u)),this.services.backendConnector.load(o,this.options.ns,u=>{!u&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),i(u)})}else i(null)}reloadResources(e,t,i){const s=mg();return typeof e=="function"&&(i=e,e=void 0),typeof t=="function"&&(i=t,t=void 0),e||(e=this.languages),t||(t=this.options.ns),i||(i=wv),this.services.backendConnector.reload(e,t,r=>{s.resolve(),i(r)}),s}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return e.type==="backend"&&(this.modules.backend=e),(e.type==="logger"||e.log&&e.warn&&e.error)&&(this.modules.logger=e),e.type==="languageDetector"&&(this.modules.languageDetector=e),e.type==="i18nFormat"&&(this.modules.i18nFormat=e),e.type==="postProcessor"&&kD.addPostProcessor(e),e.type==="formatter"&&(this.modules.formatter=e),e.type==="3rdParty"&&this.modules.external.push(e),this}setResolvedLanguage(e){if(!(!e||!this.languages)&&!(["cimode","dev"].indexOf(e)>-1)){for(let t=0;t<this.languages.length;t++){const i=this.languages[t];if(!(["cimode","dev"].indexOf(i)>-1)&&this.store.hasLanguageSomeTranslations(i)){this.resolvedLanguage=i;break}}!this.resolvedLanguage&&this.languages.indexOf(e)<0&&this.store.hasLanguageSomeTranslations(e)&&(this.resolvedLanguage=e,this.languages.unshift(e))}}changeLanguage(e,t){this.isLanguageChangingTo=e;const i=mg();this.emit("languageChanging",e);const s=o=>{this.language=o,this.languages=this.services.languageUtils.toResolveHierarchy(o),this.resolvedLanguage=void 0,this.setResolvedLanguage(o)},r=(o,l)=>{l?this.isLanguageChangingTo===e&&(s(l),this.translator.changeLanguage(l),this.isLanguageChangingTo=void 0,this.emit("languageChanged",l),this.logger.log("languageChanged",l)):this.isLanguageChangingTo=void 0,i.resolve((...u)=>this.t(...u)),t&&t(o,(...u)=>this.t(...u))},a=o=>{var d,f;!e&&!o&&this.services.languageDetector&&(o=[]);const l=lt(o)?o:o&&o[0],u=this.store.hasLanguageSomeTranslations(l)?l:this.services.languageUtils.getBestMatchFromCodes(lt(o)?[o]:o);u&&(this.language||s(u),this.translator.language||this.translator.changeLanguage(u),(f=(d=this.services.languageDetector)==null?void 0:d.cacheUserLanguage)==null||f.call(d,u)),this.loadResources(u,p=>{r(p,u)})};return!e&&this.services.languageDetector&&!this.services.languageDetector.async?a(this.services.languageDetector.detect()):!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(a):this.services.languageDetector.detect(a):a(e),i}getFixedT(e,t,i){const s=(r,a,...o)=>{let l;typeof a!="object"?l=this.options.overloadTranslationOptionHandler([r,a].concat(o)):l={...a},l.lng=l.lng||s.lng,l.lngs=l.lngs||s.lngs,l.ns=l.ns||s.ns,l.keyPrefix!==""&&(l.keyPrefix=l.keyPrefix||i||s.keyPrefix);const u=this.options.keySeparator||".";let d;return l.keyPrefix&&Array.isArray(r)?d=r.map(f=>(typeof f=="function"&&(f=H2(f,{...this.options,...a})),`${l.keyPrefix}${u}${f}`)):(typeof r=="function"&&(r=H2(r,{...this.options,...a})),d=l.keyPrefix?`${l.keyPrefix}${u}${r}`:r),this.t(d,l)};return lt(e)?s.lng=e:s.lngs=e,s.ns=t,s.keyPrefix=i,s}t(...e){var t;return(t=this.translator)==null?void 0:t.translate(...e)}exists(...e){var t;return(t=this.translator)==null?void 0:t.exists(...e)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e,t={}){if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const i=t.lng||this.resolvedLanguage||this.languages[0],s=this.options?this.options.fallbackLng:!1,r=this.languages[this.languages.length-1];if(i.toLowerCase()==="cimode")return!0;const a=(o,l)=>{const u=this.services.backendConnector.state[`${o}|${l}`];return u===-1||u===0||u===2};if(t.precheck){const o=t.precheck(this,a);if(o!==void 0)return o}return!!(this.hasResourceBundle(i,e)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||a(i,e)&&(!s||a(r,e)))}loadNamespaces(e,t){const i=mg();return this.options.ns?(lt(e)&&(e=[e]),e.forEach(s=>{this.options.ns.indexOf(s)<0&&this.options.ns.push(s)}),this.loadResources(s=>{i.resolve(),t&&t(s)}),i):(t&&t(),Promise.resolve())}loadLanguages(e,t){const i=mg();lt(e)&&(e=[e]);const s=this.options.preload||[],r=e.filter(a=>s.indexOf(a)<0&&this.services.languageUtils.isSupportedCode(a));return r.length?(this.options.preload=s.concat(r),this.loadResources(a=>{i.resolve(),t&&t(a)}),i):(t&&t(),Promise.resolve())}dir(e){var s,r;if(e||(e=this.resolvedLanguage||(((s=this.languages)==null?void 0:s.length)>0?this.languages[0]:this.language)),!e)return"rtl";try{const a=new Intl.Locale(e);if(a&&a.getTextInfo){const o=a.getTextInfo();if(o&&o.direction)return o.direction}}catch{}const t=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],i=((r=this.services)==null?void 0:r.languageUtils)||new P_(_w());return e.toLowerCase().indexOf("-latn")>1?"ltr":t.indexOf(i.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(e={},t){const i=new om(e,t);return i.createInstance=om.createInstance,i}cloneInstance(e={},t=wv){const i=e.forkResourceStore;i&&delete e.forkResourceStore;const s={...this.options,...e,isClone:!0},r=new om(s);if((e.debug!==void 0||e.prefix!==void 0)&&(r.logger=r.logger.clone(e)),["store","services","language"].forEach(o=>{r[o]=this[o]}),r.services={...this.services},r.services.utils={hasLoadedNamespace:r.hasLoadedNamespace.bind(r)},i){const o=Object.keys(this.store.data).reduce((l,u)=>(l[u]={...this.store.data[u]},l[u]=Object.keys(l[u]).reduce((d,f)=>(d[f]={...l[u][f]},d),l[u]),l),{});r.store=new O_(o,s),r.services.resourceStore=r.store}if(e.interpolation){const l={..._w().interpolation,...this.options.interpolation,...e.interpolation},u={...s,interpolation:l};r.services.interpolator=new U_(u)}return r.translator=new eb(r.services,s),r.translator.on("*",(o,...l)=>{r.emit(o,...l)}),r.init(s,t),r.translator.options=s,r.translator.backendConnector.services.utils={hasLoadedNamespace:r.hasLoadedNamespace.bind(r)},r}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const Wn=om.createInstance();Wn.createInstance;Wn.dir;Wn.init;Wn.loadResources;Wn.reloadResources;Wn.use;Wn.changeLanguage;Wn.getFixedT;Wn.t;Wn.exists;Wn.setDefaultNamespace;Wn.hasLoadedNamespace;Wn.loadNamespaces;Wn.loadLanguages;var zr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Wh(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var DD={exports:{}},pt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var OE=Symbol.for("react.transitional.element"),zO=Symbol.for("react.portal"),UO=Symbol.for("react.fragment"),HO=Symbol.for("react.strict_mode"),$O=Symbol.for("react.profiler"),qO=Symbol.for("react.consumer"),VO=Symbol.for("react.context"),GO=Symbol.for("react.forward_ref"),YO=Symbol.for("react.suspense"),WO=Symbol.for("react.memo"),jD=Symbol.for("react.lazy"),XO=Symbol.for("react.activity"),V_=Symbol.iterator;function KO(n){return n===null||typeof n!="object"?null:(n=V_&&n[V_]||n["@@iterator"],typeof n=="function"?n:null)}var RD={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},LD=Object.assign,MD={};function sg(n,e,t){this.props=n,this.context=e,this.refs=MD,this.updater=t||RD}sg.prototype.isReactComponent={};sg.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};sg.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function OD(){}OD.prototype=sg.prototype;function IE(n,e,t){this.props=n,this.context=e,this.refs=MD,this.updater=t||RD}var PE=IE.prototype=new OD;PE.constructor=IE;LD(PE,sg.prototype);PE.isPureReactComponent=!0;var G_=Array.isArray;function $2(){}var mi={H:null,A:null,T:null,S:null},ID=Object.prototype.hasOwnProperty;function BE(n,e,t){var i=t.ref;return{$$typeof:OE,type:n,key:e,ref:i!==void 0?i:null,props:t}}function ZO(n,e){return BE(n.type,e,n.props)}function FE(n){return typeof n=="object"&&n!==null&&n.$$typeof===OE}function QO(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var Y_=/\/+/g;function Nw(n,e){return typeof n=="object"&&n!==null&&n.key!=null?QO(""+n.key):e.toString(36)}function JO(n){switch(n.status){case"fulfilled":return n.value;case"rejected":throw n.reason;default:switch(typeof n.status=="string"?n.then($2,$2):(n.status="pending",n.then(function(e){n.status==="pending"&&(n.status="fulfilled",n.value=e)},function(e){n.status==="pending"&&(n.status="rejected",n.reason=e)})),n.status){case"fulfilled":return n.value;case"rejected":throw n.reason}}throw n}function bd(n,e,t,i,s){var r=typeof n;(r==="undefined"||r==="boolean")&&(n=null);var a=!1;if(n===null)a=!0;else switch(r){case"bigint":case"string":case"number":a=!0;break;case"object":switch(n.$$typeof){case OE:case zO:a=!0;break;case jD:return a=n._init,bd(a(n._payload),e,t,i,s)}}if(a)return s=s(n),a=i===""?"."+Nw(n,0):i,G_(s)?(t="",a!=null&&(t=a.replace(Y_,"$&/")+"/"),bd(s,e,t,"",function(u){return u})):s!=null&&(FE(s)&&(s=ZO(s,t+(s.key==null||n&&n.key===s.key?"":(""+s.key).replace(Y_,"$&/")+"/")+a)),e.push(s)),1;a=0;var o=i===""?".":i+":";if(G_(n))for(var l=0;l<n.length;l++)i=n[l],r=o+Nw(i,l),a+=bd(i,e,t,r,s);else if(l=KO(n),typeof l=="function")for(n=l.call(n),l=0;!(i=n.next()).done;)i=i.value,r=o+Nw(i,l++),a+=bd(i,e,t,r,s);else if(r==="object"){if(typeof n.then=="function")return bd(JO(n),e,t,i,s);throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.")}return a}function Sv(n,e,t){if(n==null)return n;var i=[],s=0;return bd(n,i,"","",function(r){return e.call(t,r,s++)}),i}function e6(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var W_=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var e=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(e))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},t6={map:Sv,forEach:function(n,e,t){Sv(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return Sv(n,function(){e++}),e},toArray:function(n){return Sv(n,function(e){return e})||[]},only:function(n){if(!FE(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};pt.Activity=XO;pt.Children=t6;pt.Component=sg;pt.Fragment=UO;pt.Profiler=$O;pt.PureComponent=IE;pt.StrictMode=HO;pt.Suspense=YO;pt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=mi;pt.__COMPILER_RUNTIME={__proto__:null,c:function(n){return mi.H.useMemoCache(n)}};pt.cache=function(n){return function(){return n.apply(null,arguments)}};pt.cacheSignal=function(){return null};pt.cloneElement=function(n,e,t){if(n==null)throw Error("The argument must be a React element, but you passed "+n+".");var i=LD({},n.props),s=n.key;if(e!=null)for(r in e.key!==void 0&&(s=""+e.key),e)!ID.call(e,r)||r==="key"||r==="__self"||r==="__source"||r==="ref"&&e.ref===void 0||(i[r]=e[r]);var r=arguments.length-2;if(r===1)i.children=t;else if(1<r){for(var a=Array(r),o=0;o<r;o++)a[o]=arguments[o+2];i.children=a}return BE(n.type,s,i)};pt.createContext=function(n){return n={$$typeof:VO,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null},n.Provider=n,n.Consumer={$$typeof:qO,_context:n},n};pt.createElement=function(n,e,t){var i,s={},r=null;if(e!=null)for(i in e.key!==void 0&&(r=""+e.key),e)ID.call(e,i)&&i!=="key"&&i!=="__self"&&i!=="__source"&&(s[i]=e[i]);var a=arguments.length-2;if(a===1)s.children=t;else if(1<a){for(var o=Array(a),l=0;l<a;l++)o[l]=arguments[l+2];s.children=o}if(n&&n.defaultProps)for(i in a=n.defaultProps,a)s[i]===void 0&&(s[i]=a[i]);return BE(n,r,s)};pt.createRef=function(){return{current:null}};pt.forwardRef=function(n){return{$$typeof:GO,render:n}};pt.isValidElement=FE;pt.lazy=function(n){return{$$typeof:jD,_payload:{_status:-1,_result:n},_init:e6}};pt.memo=function(n,e){return{$$typeof:WO,type:n,compare:e===void 0?null:e}};pt.startTransition=function(n){var e=mi.T,t={};mi.T=t;try{var i=n(),s=mi.S;s!==null&&s(t,i),typeof i=="object"&&i!==null&&typeof i.then=="function"&&i.then($2,W_)}catch(r){W_(r)}finally{e!==null&&t.types!==null&&(e.types=t.types),mi.T=e}};pt.unstable_useCacheRefresh=function(){return mi.H.useCacheRefresh()};pt.use=function(n){return mi.H.use(n)};pt.useActionState=function(n,e,t){return mi.H.useActionState(n,e,t)};pt.useCallback=function(n,e){return mi.H.useCallback(n,e)};pt.useContext=function(n){return mi.H.useContext(n)};pt.useDebugValue=function(){};pt.useDeferredValue=function(n,e){return mi.H.useDeferredValue(n,e)};pt.useEffect=function(n,e){return mi.H.useEffect(n,e)};pt.useEffectEvent=function(n){return mi.H.useEffectEvent(n)};pt.useId=function(){return mi.H.useId()};pt.useImperativeHandle=function(n,e,t){return mi.H.useImperativeHandle(n,e,t)};pt.useInsertionEffect=function(n,e){return mi.H.useInsertionEffect(n,e)};pt.useLayoutEffect=function(n,e){return mi.H.useLayoutEffect(n,e)};pt.useMemo=function(n,e){return mi.H.useMemo(n,e)};pt.useOptimistic=function(n,e){return mi.H.useOptimistic(n,e)};pt.useReducer=function(n,e,t){return mi.H.useReducer(n,e,t)};pt.useRef=function(n){return mi.H.useRef(n)};pt.useState=function(n){return mi.H.useState(n)};pt.useSyncExternalStore=function(n,e,t){return mi.H.useSyncExternalStore(n,e,t)};pt.useTransition=function(){return mi.H.useTransition()};pt.version="19.2.4";DD.exports=pt;var E=DD.exports;const i6=Wh(E),n6=(n,e,t,i)=>{var r,a,o,l;const s=[t,{code:e,...i||{}}];if((a=(r=n==null?void 0:n.services)==null?void 0:r.logger)!=null&&a.forward)return n.services.logger.forward(s,"warn","react-i18next::",!0);Bh(s[0])&&(s[0]=`react-i18next:: ${s[0]}`),(l=(o=n==null?void 0:n.services)==null?void 0:o.logger)!=null&&l.warn?n.services.logger.warn(...s):console!=null&&console.warn&&console.warn(...s)},X_={},PD=(n,e,t,i)=>{Bh(t)&&X_[t]||(Bh(t)&&(X_[t]=new Date),n6(n,e,t,i))},BD=(n,e)=>()=>{if(n.isInitialized)e();else{const t=()=>{setTimeout(()=>{n.off("initialized",t)},0),e()};n.on("initialized",t)}},q2=(n,e,t)=>{n.loadNamespaces(e,BD(n,t))},K_=(n,e,t,i)=>{if(Bh(t)&&(t=[t]),n.options.preload&&n.options.preload.indexOf(e)>-1)return q2(n,t,i);t.forEach(s=>{n.options.ns.indexOf(s)<0&&n.options.ns.push(s)}),n.loadLanguages(e,BD(n,i))},s6=(n,e,t={})=>!e.languages||!e.languages.length?(PD(e,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:e.languages}),!0):e.hasLoadedNamespace(n,{lng:t.lng,precheck:(i,s)=>{if(t.bindI18n&&t.bindI18n.indexOf("languageChanging")>-1&&i.services.backendConnector.backend&&i.isLanguageChangingTo&&!s(i.isLanguageChangingTo,n))return!1}}),Bh=n=>typeof n=="string",r6=n=>typeof n=="object"&&n!==null,a6=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,o6={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"Â©","&#169;":"Â©","&reg;":"Â®","&#174;":"Â®","&hellip;":"â€¦","&#8230;":"â€¦","&#x2F;":"/","&#47;":"/"},l6=n=>o6[n],c6=n=>n.replace(a6,l6);let V2={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:c6,transDefaultProps:void 0};const u6=(n={})=>{V2={...V2,...n}},h6=()=>V2;let FD;const d6=n=>{FD=n},f6=()=>FD,p6={type:"3rdParty",init(n){u6(n.options.react),d6(n)}},g6=E.createContext();class m6{constructor(){this.usedNamespaces={}}addUsedNamespaces(e){e.forEach(t=>{this.usedNamespaces[t]||(this.usedNamespaces[t]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}var zD={exports:{}},UD={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pp=E;function y6(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var v6=typeof Object.is=="function"?Object.is:y6,x6=Pp.useState,b6=Pp.useEffect,w6=Pp.useLayoutEffect,S6=Pp.useDebugValue;function A6(n,e){var t=e(),i=x6({inst:{value:t,getSnapshot:e}}),s=i[0].inst,r=i[1];return w6(function(){s.value=t,s.getSnapshot=e,kw(s)&&r({inst:s})},[n,t,e]),b6(function(){return kw(s)&&r({inst:s}),n(function(){kw(s)&&r({inst:s})})},[n]),S6(t),t}function kw(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!v6(n,t)}catch{return!0}}function E6(n,e){return e()}var C6=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?E6:A6;UD.useSyncExternalStore=Pp.useSyncExternalStore!==void 0?Pp.useSyncExternalStore:C6;zD.exports=UD;var _6=zD.exports;const N6=(n,e)=>Bh(e)?e:r6(e)&&Bh(e.defaultValue)?e.defaultValue:Array.isArray(n)?n[n.length-1]:n,k6={t:N6,ready:!1},T6=()=>()=>{},Sn=(n,e={})=>{var D,j,P;const{i18n:t}=e,{i18n:i,defaultNS:s}=E.useContext(g6)||{},r=t||i||f6();r&&!r.reportNamespaces&&(r.reportNamespaces=new m6),r||PD(r,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const a=E.useMemo(()=>{var H;return{...h6(),...(H=r==null?void 0:r.options)==null?void 0:H.react,...e}},[r,e]),{useSuspense:o,keyPrefix:l}=a,u=s||((D=r==null?void 0:r.options)==null?void 0:D.defaultNS),d=Bh(u)?[u]:u||["translation"],f=E.useMemo(()=>d,d);(P=(j=r==null?void 0:r.reportNamespaces)==null?void 0:j.addUsedNamespaces)==null||P.call(j,f);const p=E.useRef(0),g=E.useCallback(H=>{if(!r)return T6;const{bindI18n:G,bindI18nStore:$}=a,Y=()=>{p.current+=1,H()};return G&&r.on(G,Y),$&&r.store.on($,Y),()=>{G&&G.split(" ").forEach(F=>r.off(F,Y)),$&&$.split(" ").forEach(F=>r.store.off(F,Y))}},[r,a]),x=E.useRef(),w=E.useCallback(()=>{if(!r)return k6;const H=!!(r.isInitialized||r.initializedStoreOnce)&&f.every(I=>s6(I,r,a)),G=e.lng||r.language,$=p.current,Y=x.current;if(Y&&Y.ready===H&&Y.lng===G&&Y.keyPrefix===l&&Y.revision===$)return Y;const M={t:r.getFixedT(G,a.nsMode==="fallback"?f:f[0],l),ready:H,lng:G,keyPrefix:l,revision:$};return x.current=M,M},[r,f,l,a,e.lng]),[y,m]=E.useState(0),{t:v,ready:b}=_6.useSyncExternalStore(g,w,w);E.useEffect(()=>{if(r&&!b&&!o){const H=()=>m(G=>G+1);e.lng?K_(r,e.lng,f,H):q2(r,f,H)}},[r,e.lng,f,b,o,y]);const A=r||{},S=E.useRef(null),C=E.useRef(),k=H=>{const G=Object.getOwnPropertyDescriptors(H);G.__original&&delete G.__original;const $=Object.create(Object.getPrototypeOf(H),G);if(!Object.prototype.hasOwnProperty.call($,"__original"))try{Object.defineProperty($,"__original",{value:H,writable:!1,enumerable:!1,configurable:!1})}catch{}return $},L=E.useMemo(()=>{const H=A,G=H==null?void 0:H.language;let $=H;H&&(S.current&&S.current.__original===H?C.current!==G?($=k(H),S.current=$,C.current=G):$=S.current:($=k(H),S.current=$,C.current=G));const Y=[v,$,b];return Y.t=v,Y.i18n=$,Y.ready=b,Y},[v,A,b,A.resolvedLanguage,A.language,A.languages]);if(r&&o&&!b)throw new Promise(H=>{const G=()=>H();e.lng?K_(r,e.lng,f,G):q2(r,f,G)});return L},{slice:D6,forEach:j6}=[];function R6(n){return j6.call(D6.call(arguments,1),e=>{if(e)for(const t in e)n[t]===void 0&&(n[t]=e[t])}),n}function L6(n){return typeof n!="string"?!1:[/<\s*script.*?>/i,/<\s*\/\s*script\s*>/i,/<\s*img.*?on\w+\s*=/i,/<\s*\w+\s*on\w+\s*=.*?>/i,/javascript\s*:/i,/vbscript\s*:/i,/expression\s*\(/i,/eval\s*\(/i,/alert\s*\(/i,/document\.cookie/i,/document\.write\s*\(/i,/window\.location/i,/innerHTML/i].some(t=>t.test(n))}const Z_=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,M6=function(n,e){const i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{path:"/"},s=encodeURIComponent(e);let r=`${n}=${s}`;if(i.maxAge>0){const a=i.maxAge-0;if(Number.isNaN(a))throw new Error("maxAge should be a Number");r+=`; Max-Age=${Math.floor(a)}`}if(i.domain){if(!Z_.test(i.domain))throw new TypeError("option domain is invalid");r+=`; Domain=${i.domain}`}if(i.path){if(!Z_.test(i.path))throw new TypeError("option path is invalid");r+=`; Path=${i.path}`}if(i.expires){if(typeof i.expires.toUTCString!="function")throw new TypeError("option expires is invalid");r+=`; Expires=${i.expires.toUTCString()}`}if(i.httpOnly&&(r+="; HttpOnly"),i.secure&&(r+="; Secure"),i.sameSite)switch(typeof i.sameSite=="string"?i.sameSite.toLowerCase():i.sameSite){case!0:r+="; SameSite=Strict";break;case"lax":r+="; SameSite=Lax";break;case"strict":r+="; SameSite=Strict";break;case"none":r+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return i.partitioned&&(r+="; Partitioned"),r},Q_={create(n,e,t,i){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/",sameSite:"strict"};t&&(s.expires=new Date,s.expires.setTime(s.expires.getTime()+t*60*1e3)),i&&(s.domain=i),document.cookie=M6(n,e,s)},read(n){const e=`${n}=`,t=document.cookie.split(";");for(let i=0;i<t.length;i++){let s=t[i];for(;s.charAt(0)===" ";)s=s.substring(1,s.length);if(s.indexOf(e)===0)return s.substring(e.length,s.length)}return null},remove(n,e){this.create(n,"",-1,e)}};var O6={name:"cookie",lookup(n){let{lookupCookie:e}=n;if(e&&typeof document<"u")return Q_.read(e)||void 0},cacheUserLanguage(n,e){let{lookupCookie:t,cookieMinutes:i,cookieDomain:s,cookieOptions:r}=e;t&&typeof document<"u"&&Q_.create(t,n,i,s,r)}},I6={name:"querystring",lookup(n){var i;let{lookupQuerystring:e}=n,t;if(typeof window<"u"){let{search:s}=window.location;!window.location.search&&((i=window.location.hash)==null?void 0:i.indexOf("?"))>-1&&(s=window.location.hash.substring(window.location.hash.indexOf("?")));const a=s.substring(1).split("&");for(let o=0;o<a.length;o++){const l=a[o].indexOf("=");l>0&&a[o].substring(0,l)===e&&(t=a[o].substring(l+1))}}return t}},P6={name:"hash",lookup(n){var s;let{lookupHash:e,lookupFromHashIndex:t}=n,i;if(typeof window<"u"){const{hash:r}=window.location;if(r&&r.length>2){const a=r.substring(1);if(e){const o=a.split("&");for(let l=0;l<o.length;l++){const u=o[l].indexOf("=");u>0&&o[l].substring(0,u)===e&&(i=o[l].substring(u+1))}}if(i)return i;if(!i&&t>-1){const o=r.match(/\/([a-zA-Z-]*)/g);return Array.isArray(o)?(s=o[typeof t=="number"?t:0])==null?void 0:s.replace("/",""):void 0}}}return i}};let ld=null;const J_=()=>{if(ld!==null)return ld;try{if(ld=typeof window<"u"&&window.localStorage!==null,!ld)return!1;const n="i18next.translate.boo";window.localStorage.setItem(n,"foo"),window.localStorage.removeItem(n)}catch{ld=!1}return ld};var B6={name:"localStorage",lookup(n){let{lookupLocalStorage:e}=n;if(e&&J_())return window.localStorage.getItem(e)||void 0},cacheUserLanguage(n,e){let{lookupLocalStorage:t}=e;t&&J_()&&window.localStorage.setItem(t,n)}};let cd=null;const eN=()=>{if(cd!==null)return cd;try{if(cd=typeof window<"u"&&window.sessionStorage!==null,!cd)return!1;const n="i18next.translate.boo";window.sessionStorage.setItem(n,"foo"),window.sessionStorage.removeItem(n)}catch{cd=!1}return cd};var F6={name:"sessionStorage",lookup(n){let{lookupSessionStorage:e}=n;if(e&&eN())return window.sessionStorage.getItem(e)||void 0},cacheUserLanguage(n,e){let{lookupSessionStorage:t}=e;t&&eN()&&window.sessionStorage.setItem(t,n)}},z6={name:"navigator",lookup(n){const e=[];if(typeof navigator<"u"){const{languages:t,userLanguage:i,language:s}=navigator;if(t)for(let r=0;r<t.length;r++)e.push(t[r]);i&&e.push(i),s&&e.push(s)}return e.length>0?e:void 0}},U6={name:"htmlTag",lookup(n){let{htmlTag:e}=n,t;const i=e||(typeof document<"u"?document.documentElement:null);return i&&typeof i.getAttribute=="function"&&(t=i.getAttribute("lang")),t}},H6={name:"path",lookup(n){var s;let{lookupFromPathIndex:e}=n;if(typeof window>"u")return;const t=window.location.pathname.match(/\/([a-zA-Z-]*)/g);return Array.isArray(t)?(s=t[typeof e=="number"?e:0])==null?void 0:s.replace("/",""):void 0}},$6={name:"subdomain",lookup(n){var s,r;let{lookupFromSubdomainIndex:e}=n;const t=typeof e=="number"?e+1:1,i=typeof window<"u"&&((r=(s=window.location)==null?void 0:s.hostname)==null?void 0:r.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i));if(i)return i[t]}};let HD=!1;try{document.cookie,HD=!0}catch{}const $D=["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"];HD||$D.splice(1,1);const q6=()=>({order:$D,lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],convertDetectedLanguage:n=>n});class qD{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.type="languageDetector",this.detectors={},this.init(e,t)}init(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{languageUtils:{}},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=e,this.options=R6(t,this.options||{},q6()),typeof this.options.convertDetectedLanguage=="string"&&this.options.convertDetectedLanguage.indexOf("15897")>-1&&(this.options.convertDetectedLanguage=s=>s.replace("-","_")),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=i,this.addDetector(O6),this.addDetector(I6),this.addDetector(B6),this.addDetector(F6),this.addDetector(z6),this.addDetector(U6),this.addDetector(H6),this.addDetector($6),this.addDetector(P6)}addDetector(e){return this.detectors[e.name]=e,this}detect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.order,t=[];return e.forEach(i=>{if(this.detectors[i]){let s=this.detectors[i].lookup(this.options);s&&typeof s=="string"&&(s=[s]),s&&(t=t.concat(s))}}),t=t.filter(i=>i!=null&&!L6(i)).map(i=>this.options.convertDetectedLanguage(i)),this.services&&this.services.languageUtils&&this.services.languageUtils.getBestMatchFromCodes?t:t.length>0?t[0]:null}cacheUserLanguage(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.options.caches;t&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(e)>-1||t.forEach(i=>{this.detectors[i]&&this.detectors[i].cacheUserLanguage(e,this.options)}))}}qD.type="languageDetector";const V6={name:"Z-Reader"},G6={library:"Library",articles:"Articles",books:"Books",emails:"Emails",pdfs:"PDFs",tweets:"Tweets",videos:"Videos",podcasts:"Podcasts",tags:"Tags",feed:"Feed",discover:"Discover",allFeeds:"All Feeds",manageFeeds:"Manage Feeds",pinned:"Pinned",shortlist:"Shortlist",trash:"Trash",search:"Search",shortcuts:"Shortcuts",downloads:"Downloads",preferences:"Preferences",profile:"Profile",saveUrl:"Save URL to Library",addFeed:"Add RSS Feed",collapse:"Collapse sidebar",expand:"Expand sidebar"},Y6={inbox:"Inbox",later:"Read Later",archive:"Archive",unseen:"Unseen",seen:"Seen",all:"All",noArticles:"No articles",loading:"Loading...",markAsRead:"Mark as read",markAsUnread:"Mark as unread",addToShortlist:"Add to shortlist",removeFromShortlist:"Remove from shortlist",archiveArticle:"Archive article",deleteArticle:"Delete",openInReader:"Open in reader",emptyFeed:"This feed has no content",emptyLibrary:"Your library is empty",emptyTag:"No articles with this tag",emptySearch:"No matching articles found",emptyShortlist:"Shortlist is empty",emptyTrash:"Trash is empty"},W6={noSelection:"Select an article to view details",publishedAt:"Published",savedAt:"Saved",author:"Author",domain:"Domain",readingTime:"Reading time",minutes:"min",words:"words",highlights:"Highlights",noHighlights:"No highlights yet",addHighlight:"Add highlight",tags:"Tags",noTags:"No tags",copyUrl:"Copy URL",openOriginal:"Open original",share:"Share",editTags:"Edit tags",editNote:"Edit note",deleteHighlight:"Delete highlight",note:"Note",noNote:"No note",addNote:"Add note"},X6={title:"Preferences",podcastSettings:"Podcast Settings",podcastIndexApiKey:"Podcast Index API Key",podcastIndexApiSecret:"Podcast Index API Secret",podcastIndexHelp:"Get free API keys at podcastindex.org to enable Podcast Index search.",rsshubSettings:"RSSHub Settings",rsshubUrl:"RSSHub Instance URL",rsshubHelp:"Configure a self-hosted RSSHub instance to enable category browsing and route search in Discover.",downloadSettings:"Download Settings",downloadDirectory:"Download Directory",downloadCapacity:"Storage Capacity Limit (MB)",downloadCapacityHelp:"Automatically delete oldest downloaded files when limit is exceeded. Default 5120 MB (5 GB).",languageSettings:"Language",selectLanguage:"Select Language",languageChangeHelp:"Some UI will update immediately after changing language.",save:"Save Settings",saving:"Saving...",settingsSaved:"Settings saved",saveFailed:"Save failed"},K6={addFeed:{title:"Add RSS Feed",url:"Feed URL",urlPlaceholder:"https://example.com/feed.xml",category:"Category (optional)",categoryPlaceholder:"e.g., Tech",add:"Add",cancel:"Cancel",adding:"Adding...",invalidUrl:"Please enter a valid feed URL",duplicateFeed:"This feed already exists",addSuccess:"Feed added successfully",addFailed:"Failed to add feed"},addUrl:{title:"Save URL to Library",url:"URL",urlPlaceholder:"https://example.com/article",titleField:"Title (optional)",titlePlaceholder:"Article title",save:"Save",cancel:"Cancel",saving:"Saving...",invalidUrl:"Please enter a valid URL",saveSuccess:"URL saved successfully",saveFailed:"Failed to save URL"},feedManage:{title:"Manage Feed",feedUrl:"Feed URL",feedTitle:"Title",category:"Category",fetchInterval:"Fetch Interval (minutes)",lastFetched:"Last Fetched",never:"Never",errorCount:"Error Count",save:"Save",delete:"Delete",fetch:"Fetch Now",cancel:"Cancel",confirmDelete:"Are you sure you want to delete this feed?",saveSuccess:"Feed updated successfully",saveFailed:"Failed to update feed",deleteSuccess:"Feed deleted",deleteFailed:"Failed to delete feed",fetchSuccess:"Fetch complete",fetchFailed:"Fetch failed"},commandPalette:{title:"Command Palette",placeholder:"Type a command or search...",noResults:"No results",goToInbox:"Go to Inbox",goToLater:"Go to Read Later",goToArchive:"Go to Archive",doSearch:"Search",addFeed:"Add Feed",saveUrl:"Save URL",openReader:"Open Reader",markRead:"Mark Read",markUnread:"Mark Unread",archive:"Archive",delete:"Delete",later:"Read Later"}},Z6={title:"Discover",search:"Search feeds, podcasts, or routes...",categories:"Categories",popularSites:"Popular Sites",preview:"Preview",subscribe:"Subscribe",alreadySubscribed:"Already subscribed",noResults:"No results found",searching:"Searching...",routes:"Routes",parameters:"Parameters",example:"Example",routeDescription:"Description",noCategories:"No categories",noRoutes:"No routes"},Q6={title:"Feed Manager",noFeeds:"No feeds yet",addFirst:"Add your first feed to get started",search:"Search feeds...",sortBy:"Sort by",sortByTitle:"By title",sortByUrl:"By URL",sortByRecentlyAdded:"Recently added",sortByRecentlyUpdated:"Recently updated",articles:"Articles",unread:"Unread",errors:"Errors"},J6={title:"Feed Details",noFeed:"Please select a feed",info:"Info",statistics:"Statistics",totalArticles:"Total Articles",unreadArticles:"Unread Articles",lastFetched:"Last Fetched",never:"Never",nextFetch:"Next Fetch",actions:"Actions",fetchNow:"Fetch Now",editFeed:"Edit Feed",deleteFeed:"Delete Feed",openArticle:"Open Article"},eI={title:"Books",upload:"Upload Book",noBooks:"No books yet",uploadFirst:"Upload your first book to get started",author:"Author",progress:"Progress",readStatus:"Status",inbox:"Inbox",later:"Read Later",archive:"Archived",delete:"Delete",open:"Open",import:"Import",importSuccess:"Book imported successfully",importFailed:"Failed to import book",deleteConfirm:"Are you sure you want to delete this book?",deleteSuccess:"Book deleted",fileSize:"File Size",format:"Format",locations:"Locations"},tI={loading:"Loading...",error:"Failed to load",retry:"Retry",openOriginal:"Open original",copyContent:"Copy content",highlight:"Highlight",addNote:"Add note",share:"Share",settings:"Reader Settings",fontSize:"Font Size",fontFamily:"Font",theme:"Theme",lineHeight:"Line Height",width:"Width",fullWidth:"Full Width",narrow:"Narrow",medium:"Medium",wide:"Wide",close:"Close",previousPage:"Previous Page",nextPage:"Next Page",page:"Page",location:"Location"},iI={title:"Video",loading:"Loading video...",play:"Play",pause:"Pause",mute:"Mute",unmute:"Unmute",fullscreen:"Fullscreen",exitFullscreen:"Exit Fullscreen",speed:"Speed",quality:"Quality",auto:"Auto"},nI={title:"Podcast",loading:"Loading podcast...",play:"Play",pause:"Pause",download:"Download",downloading:"Downloading...",downloaded:"Downloaded",duration:"Duration",episode:"Episode",season:"Season",subscribe:"Subscribe",unsubscribe:"Unsubscribe",search:"Search podcasts...",noResults:"No podcasts found"},sI={title:"PDF",loading:"Loading PDF...",page:"Page",of:"of",zoom:"Zoom",fitWidth:"Fit Width",fitPage:"Fit Page",download:"Download"},rI={title:"Search",placeholder:"Search articles...",noResults:"No articles found",results:"results",searching:"Searching...",filters:"Filters",dateRange:"Date Range",source:"Source",clearFilters:"Clear Filters"},aI={title:"Downloads",noDownloads:"No downloads",status:{queued:"Queued",downloading:"Downloading",ready:"Ready",failed:"Failed"},cancel:"Cancel",clear:"Clear",clearCompleted:"Clear Completed",clearFailed:"Clear Failed",retry:"Retry",openFile:"Open File",openFolder:"Open Folder",size:"Size",addedAt:"Added At",lastAccessed:"Last Accessed"},oI={title:"Keyboard Shortcuts",general:"General",navigation:"Navigation",article:"Article Actions",openReader:"Open article in reader",markRead:"Mark as read",markUnread:"Mark as unread",archive:"Archive article",delete:"Delete article",later:"Add to read later",shortlist:"Toggle shortlist",toggleSidebar:"Toggle sidebar",toggleDetailPanel:"Toggle detail panel",search:"Search",commandPalette:"Command palette",saveUrl:"Save URL to library",addFeed:"Add feed",shortcutsHelp:"Shortcuts Help"},lI={title:"Share Card",theme:"Theme",cardType:"Card Type",single:"Single Highlight",multi:"Multiple Highlights",summary:"Summary",quoteStyle:"Quote Style",borderLeft:"Left Border",quotationMarks:"Quotation Marks",highlightBg:"Highlight Background",minimal:"Minimal",export:"Export",copyImage:"Copy Image",downloadImage:"Download Image",copySuccess:"Copied to clipboard",downloadSuccess:"Image saved",exportFailed:"Export failed"},cI={title:"Tags",create:"Create Tag",edit:"Edit Tag",delete:"Delete Tag",name:"Tag Name",parent:"Parent Tag",noParent:"None (top-level)",confirmDelete:"Are you sure you want to delete this tag?",createSuccess:"Tag created successfully",editSuccess:"Tag updated successfully",deleteSuccess:"Tag deleted",search:"Search tags...",noTags:"No tags yet"},uI={title:"Transcript",loading:"Loading transcript...",noTranscript:"No transcript available",fetch:"Fetch Transcript",fetching:"Fetching...",fetchFailed:"Failed to fetch transcript",language:"Language",copy:"Copy",copySuccess:"Copied"},hI={loading:"Loading...",error:"Error",success:"Success",cancel:"Cancel",confirm:"Confirm",delete:"Delete",save:"Save",edit:"Edit",close:"Close",refresh:"Refresh",retry:"Retry",back:"Back",next:"Next",previous:"Previous",yes:"Yes",no:"No",ok:"OK",apply:"Apply",reset:"Reset",select:"Select",selected:"Selected",none:"None",all:"All",search:"Search",filter:"Filter",sort:"Sort",export:"Export",import:"Import",upload:"Upload",download:"Download",copy:"Copy",paste:"Paste",cut:"Cut",selectAll:"Select All",deselectAll:"Deselect All",showMore:"Show More",showLess:"Show Less",expand:"Expand",collapse:"Collapse",more:"More",less:"Less",required:"Required",optional:"Optional",enabled:"Enabled",disabled:"Disabled",active:"Active",inactive:"Inactive",public:"Public",private:"Private",shared:"Shared"},dI={justNow:"Just now",minutesAgo:"{n} minutes ago",hoursAgo:"{n} hours ago",daysAgo:"{n} days ago",weeksAgo:"{n} weeks ago",monthsAgo:"{n} months ago",yearsAgo:"{n} years ago",inMinutes:"in {n} minutes",inHours:"in {n} hours",inDays:"in {n} days",inWeeks:"in {n} weeks",inMonths:"in {n} months",inYears:"in {n} years",today:"Today",yesterday:"Yesterday",tomorrow:"Tomorrow"},fI={title:"Chat",placeholder:"Type a message...",send:"Send",newSession:"New Chat",thinking:"Thinking...",toolCalling:"Executing: {{name}}",empty:"Start chatting with AI",sessionList:"Chat History",analysisHint:"or ask your own question",analysis:{valueClarification:"Value Clarification",valueClarificationDesc:"Identify core values and conflicts",sixThinkingHats:"Six Thinking Hats",sixThinkingHatsDesc:"Analyze from six perspectives",firstPrinciples:"First Principles",firstPrinciplesDesc:"Derive from fundamental truths",socraticMethod:"Socratic Method",socraticMethodDesc:"Challenge assumptions with questions",feynmanTechnique:"Feynman Technique",feynmanTechniqueDesc:"Explain in simplest terms"},error:"An error occurred, please try again"},pI={settings:"AI Settings",provider:"AI Provider",apiKey:"API Key",apiKeyPlaceholder:"Enter your API Key",modelFast:"Fast Model",modelSmart:"Smart Model",modelCheap:"Economy Model",save:"Save",saved:"Saved",testConnection:"Test Connection",connectionOk:"Connection Successful",connectionFailed:"Connection Failed",notConfigured:"Not Configured",summarize:"AI Summary",translate:"AI Translate",autoTag:"AI Tags",generating:"Generating...",translateTo:"Translate to",taskLogs:"AI Call Logs",tokenUsage:"Token Usage",noLogs:"No call logs yet",chatComingSoon:"AI Chat coming in Phase 2",configureApiKey:"Please configure AI API Key in Preferences first",chinese:"Chinese",english:"English",japanese:"Japanese",suggestedTags:"Suggested Tags",applyTag:"Apply",errorOccurred:"Request failed, please try again later",aiActions:"AI Actions",extractTopics:"Extract Topics",topics:"Topics",debugPanel:"AI Debug Panel",callHistory:"Call History",traceDetails:"Execution Trace",costSummary:"Cost Summary",totalTokens:"Total Tokens",totalCost:"Total Cost",totalCalls:"Total Calls",duration:"Duration",input:"Input",output:"Output",steps:"Steps",noTraces:"No trace data",filterAll:"All",viewDetails:"View Details",collapse:"Collapse",copyJson:"Copy JSON",copied:"Copied",error:"Error"},gI={networkError:"Network error",serverError:"Server error",notFound:"Not found",unauthorized:"Unauthorized",forbidden:"Forbidden",badRequest:"Bad request",unknown:"Unknown error",retry:"Retry",report:"Report issue"},mI={app:V6,sidebar:G6,contentList:Y6,detailPanel:W6,preferences:X6,dialog:K6,discover:Z6,feedManager:Q6,feedDetail:J6,books:eI,reader:tI,video:iI,podcast:nI,pdf:sI,search:rI,downloads:aI,shortcuts:oI,shareCard:lI,tags:cI,transcript:uI,common:hI,time:dI,chat:fI,ai:pI,errors:gI},yI={name:"Z-Reader"},vI={library:"æ–‡åº“",articles:"æ–‡ç« ",books:"å›¾ä¹¦",emails:"é‚®ä»¶",pdfs:"PDF",tweets:"æŽ¨æ–‡",videos:"è§†é¢‘",podcasts:"æ’­å®¢",tags:"æ ‡ç­¾",feed:"è®¢é˜…æº",discover:"å‘çŽ°",allFeeds:"å…¨éƒ¨è®¢é˜…",manageFeeds:"ç®¡ç†è®¢é˜…",pinned:"å›ºå®š",shortlist:"æ”¶è—å¤¹",trash:"å›žæ”¶ç«™",search:"æœç´¢",shortcuts:"å¿«æ·é”®",downloads:"ä¸‹è½½ç®¡ç†",preferences:"åå¥½è®¾ç½®",profile:"ä¸ªäººä¸­å¿ƒ",saveUrl:"ä¿å­˜é“¾æŽ¥åˆ°æ–‡åº“",addFeed:"æ·»åŠ è®¢é˜…",collapse:"æ”¶èµ·ä¾§è¾¹æ ",expand:"å±•å¼€ä¾§è¾¹æ "},xI={inbox:"æ”¶ä»¶ç®±",later:"ç¨åŽé˜…è¯»",archive:"å½’æ¡£",unseen:"æœªè¯»",seen:"å·²è¯»",all:"å…¨éƒ¨",noArticles:"æš‚æ— æ–‡ç« ",loading:"åŠ è½½ä¸­...",markAsRead:"æ ‡è®°ä¸ºå·²è¯»",markAsUnread:"æ ‡è®°ä¸ºæœªè¯»",addToShortlist:"æ·»åŠ åˆ°æ”¶è—å¤¹",removeFromShortlist:"ä»Žæ”¶è—å¤¹ç§»é™¤",archiveArticle:"å½’æ¡£æ–‡ç« ",deleteArticle:"åˆ é™¤",openInReader:"åœ¨é˜…è¯»å™¨ä¸­æ‰“å¼€",emptyFeed:"æ­¤è®¢é˜…æš‚æ— å†…å®¹",emptyLibrary:"æ‚¨çš„æ–‡åº“ä¸ºç©º",emptyTag:"æ­¤æ ‡ç­¾æš‚æ— æ–‡ç« ",emptySearch:"æœªæ‰¾åˆ°åŒ¹é…çš„æ–‡ç« ",emptyShortlist:"æ”¶è—å¤¹ä¸ºç©º",emptyTrash:"å›žæ”¶ç«™ä¸ºç©º"},bI={noSelection:"é€‰æ‹©ä¸€ç¯‡æ–‡ç« æŸ¥çœ‹è¯¦æƒ…",publishedAt:"å‘å¸ƒæ—¶é—´",savedAt:"ä¿å­˜æ—¶é—´",author:"ä½œè€…",domain:"æ¥æº",readingTime:"é˜…è¯»æ—¶é•¿",minutes:"åˆ†é’Ÿ",words:"å­—",highlights:"é«˜äº®",noHighlights:"æš‚æ— é«˜äº®",addHighlight:"æ·»åŠ é«˜äº®",tags:"æ ‡ç­¾",noTags:"æš‚æ— æ ‡ç­¾",copyUrl:"å¤åˆ¶é“¾æŽ¥",openOriginal:"æ‰“å¼€åŽŸæ–‡",share:"åˆ†äº«",editTags:"ç¼–è¾‘æ ‡ç­¾",editNote:"ç¼–è¾‘ç¬”è®°",deleteHighlight:"åˆ é™¤é«˜äº®",note:"ç¬”è®°",noNote:"æš‚æ— ç¬”è®°",addNote:"æ·»åŠ ç¬”è®°"},wI={title:"åå¥½è®¾ç½®",podcastSettings:"æ’­å®¢è®¾ç½®",podcastIndexApiKey:"Podcast Index API Key",podcastIndexApiSecret:"Podcast Index API Secret",podcastIndexHelp:"åœ¨ podcastindex.org å…è´¹æ³¨å†ŒèŽ·å– API å¯†é’¥ï¼Œå¯ç”¨ Podcast Index ä½œä¸ºè¡¥å……æœç´¢æºã€‚",rsshubSettings:"RSSHub è®¾ç½®",rsshubUrl:"RSSHub å®žä¾‹åœ°å€",rsshubHelp:"é…ç½®è‡ªå»º RSSHub å®žä¾‹åœ°å€ï¼Œå¯ç”¨å‘çŽ°é¡µé¢çš„åˆ†ç±»æµè§ˆå’Œè·¯ç”±æœç´¢åŠŸèƒ½ã€‚",downloadSettings:"ä¸‹è½½è®¾ç½®",downloadDirectory:"ä¸‹è½½ç›®å½•",downloadCapacity:"å­˜å‚¨å®¹é‡é™åˆ¶ (MB)",downloadCapacityHelp:"è¶…è¿‡é™åˆ¶æ—¶è‡ªåŠ¨æ¸…ç†æœ€æ—©çš„å·²ä¸‹è½½æ–‡ä»¶ã€‚é»˜è®¤ 5120 MB (5 GB)ã€‚",languageSettings:"è¯­è¨€",selectLanguage:"é€‰æ‹©è¯­è¨€",languageChangeHelp:"æ›´æ”¹è¯­è¨€åŽï¼Œéƒ¨åˆ†ç•Œé¢å°†ç«‹å³æ›´æ–°ã€‚",save:"ä¿å­˜è®¾ç½®",saving:"ä¿å­˜ä¸­...",settingsSaved:"è®¾ç½®å·²ä¿å­˜",saveFailed:"ä¿å­˜å¤±è´¥"},SI={addFeed:{title:"æ·»åŠ è®¢é˜…",url:"è®¢é˜…åœ°å€",urlPlaceholder:"https://example.com/feed.xml",category:"åˆ†ç±»ï¼ˆå¯é€‰ï¼‰",categoryPlaceholder:"ä¾‹å¦‚ï¼šç§‘æŠ€",add:"æ·»åŠ ",cancel:"å–æ¶ˆ",adding:"æ·»åŠ ä¸­...",invalidUrl:"è¯·è¾“å…¥æœ‰æ•ˆçš„è®¢é˜…åœ°å€",duplicateFeed:"æ­¤è®¢é˜…å·²å­˜åœ¨",addSuccess:"è®¢é˜…æ·»åŠ æˆåŠŸ",addFailed:"æ·»åŠ è®¢é˜…å¤±è´¥"},addUrl:{title:"ä¿å­˜é“¾æŽ¥åˆ°æ–‡åº“",url:"é“¾æŽ¥åœ°å€",urlPlaceholder:"https://example.com/article",titleField:"æ ‡é¢˜ï¼ˆå¯é€‰ï¼‰",titlePlaceholder:"æ–‡ç« æ ‡é¢˜",save:"ä¿å­˜",cancel:"å–æ¶ˆ",saving:"ä¿å­˜ä¸­...",invalidUrl:"è¯·è¾“å…¥æœ‰æ•ˆçš„é“¾æŽ¥åœ°å€",saveSuccess:"é“¾æŽ¥ä¿å­˜æˆåŠŸ",saveFailed:"ä¿å­˜é“¾æŽ¥å¤±è´¥"},feedManage:{title:"ç®¡ç†è®¢é˜…",feedUrl:"è®¢é˜…åœ°å€",feedTitle:"æ ‡é¢˜",category:"åˆ†ç±»",fetchInterval:"æŠ“å–é—´éš”ï¼ˆåˆ†é’Ÿï¼‰",lastFetched:"ä¸Šæ¬¡æŠ“å–",never:"ä»Žæœª",errorCount:"é”™è¯¯æ¬¡æ•°",save:"ä¿å­˜",delete:"åˆ é™¤",fetch:"ç«‹å³æŠ“å–",cancel:"å–æ¶ˆ",confirmDelete:"ç¡®å®šè¦åˆ é™¤æ­¤è®¢é˜…å—ï¼Ÿ",saveSuccess:"è®¢é˜…æ›´æ–°æˆåŠŸ",saveFailed:"æ›´æ–°è®¢é˜…å¤±è´¥",deleteSuccess:"è®¢é˜…å·²åˆ é™¤",deleteFailed:"åˆ é™¤è®¢é˜…å¤±è´¥",fetchSuccess:"æŠ“å–å®Œæˆ",fetchFailed:"æŠ“å–å¤±è´¥"},commandPalette:{title:"å‘½ä»¤é¢æ¿",placeholder:"è¾“å…¥å‘½ä»¤æˆ–æœç´¢...",noResults:"æ— ç»“æžœ",goToInbox:"å‰å¾€æ”¶ä»¶ç®±",goToLater:"å‰å¾€ç¨åŽé˜…è¯»",goToArchive:"å‰å¾€å½’æ¡£",doSearch:"æœç´¢",addFeed:"æ·»åŠ è®¢é˜…",saveUrl:"ä¿å­˜é“¾æŽ¥",openReader:"æ‰“å¼€é˜…è¯»å™¨",markRead:"æ ‡è®°å·²è¯»",markUnread:"æ ‡è®°æœªè¯»",archive:"å½’æ¡£",delete:"åˆ é™¤",later:"ç¨åŽé˜…è¯»"}},AI={title:"å‘çŽ°",search:"æœç´¢è®¢é˜…ã€æ’­å®¢æˆ–è·¯ç”±...",categories:"åˆ†ç±»",popularSites:"çƒ­é—¨ç«™ç‚¹",preview:"é¢„è§ˆ",subscribe:"è®¢é˜…",alreadySubscribed:"å·²è®¢é˜…",noResults:"æœªæ‰¾åˆ°ç»“æžœ",searching:"æœç´¢ä¸­...",routes:"è·¯ç”±",parameters:"å‚æ•°",example:"ç¤ºä¾‹",routeDescription:"æè¿°",noCategories:"æš‚æ— åˆ†ç±»",noRoutes:"æš‚æ— è·¯ç”±"},EI={title:"è®¢é˜…ç®¡ç†",noFeeds:"æš‚æ— è®¢é˜…",addFirst:"æ·»åŠ æ‚¨çš„ç¬¬ä¸€ä¸ªè®¢é˜…å¼€å§‹ä½¿ç”¨",search:"æœç´¢è®¢é˜…...",sortBy:"æŽ’åº",sortByTitle:"æŒ‰æ ‡é¢˜",sortByUrl:"æŒ‰åœ°å€",sortByRecentlyAdded:"æœ€è¿‘æ·»åŠ ",sortByRecentlyUpdated:"æœ€è¿‘æ›´æ–°",articles:"æ–‡ç« ",unread:"æœªè¯»",errors:"é”™è¯¯"},CI={title:"è®¢é˜…è¯¦æƒ…",noFeed:"è¯·é€‰æ‹©ä¸€ä¸ªè®¢é˜…",info:"ä¿¡æ¯",statistics:"ç»Ÿè®¡",totalArticles:"æ–‡ç« æ€»æ•°",unreadArticles:"æœªè¯»æ–‡ç« ",lastFetched:"ä¸Šæ¬¡æŠ“å–",never:"ä»Žæœª",nextFetch:"ä¸‹æ¬¡æŠ“å–",actions:"æ“ä½œ",fetchNow:"ç«‹å³æŠ“å–",editFeed:"ç¼–è¾‘è®¢é˜…",deleteFeed:"åˆ é™¤è®¢é˜…",openArticle:"æ‰“å¼€æ–‡ç« "},_I={title:"å›¾ä¹¦",upload:"ä¸Šä¼ å›¾ä¹¦",noBooks:"æš‚æ— å›¾ä¹¦",uploadFirst:"ä¸Šä¼ æ‚¨çš„ç¬¬ä¸€æœ¬å›¾ä¹¦å¼€å§‹ä½¿ç”¨",author:"ä½œè€…",progress:"è¿›åº¦",readStatus:"çŠ¶æ€",inbox:"æ”¶ä»¶ç®±",later:"ç¨åŽé˜…è¯»",archive:"å·²å½’æ¡£",delete:"åˆ é™¤",open:"æ‰“å¼€",import:"å¯¼å…¥",importSuccess:"å›¾ä¹¦å¯¼å…¥æˆåŠŸ",importFailed:"å›¾ä¹¦å¯¼å…¥å¤±è´¥",deleteConfirm:"ç¡®å®šè¦åˆ é™¤è¿™æœ¬ä¹¦å—ï¼Ÿ",deleteSuccess:"å›¾ä¹¦å·²åˆ é™¤",fileSize:"æ–‡ä»¶å¤§å°",format:"æ ¼å¼",locations:"ä½ç½®"},NI={loading:"åŠ è½½ä¸­...",error:"åŠ è½½å¤±è´¥",retry:"é‡è¯•",openOriginal:"æ‰“å¼€åŽŸæ–‡",copyContent:"å¤åˆ¶å†…å®¹",highlight:"é«˜äº®",addNote:"æ·»åŠ ç¬”è®°",share:"åˆ†äº«",settings:"é˜…è¯»è®¾ç½®",fontSize:"å­—ä½“å¤§å°",fontFamily:"å­—ä½“",theme:"ä¸»é¢˜",lineHeight:"è¡Œé«˜",width:"å®½åº¦",fullWidth:"å…¨å®½",narrow:"çª„",medium:"ä¸­",wide:"å®½",close:"å…³é—­",previousPage:"ä¸Šä¸€é¡µ",nextPage:"ä¸‹ä¸€é¡µ",page:"é¡µç ",location:"ä½ç½®"},kI={title:"è§†é¢‘",loading:"åŠ è½½è§†é¢‘ä¸­...",play:"æ’­æ”¾",pause:"æš‚åœ",mute:"é™éŸ³",unmute:"å–æ¶ˆé™éŸ³",fullscreen:"å…¨å±",exitFullscreen:"é€€å‡ºå…¨å±",speed:"é€Ÿåº¦",quality:"è´¨é‡",auto:"è‡ªåŠ¨"},TI={title:"æ’­å®¢",loading:"åŠ è½½æ’­å®¢ä¸­...",play:"æ’­æ”¾",pause:"æš‚åœ",download:"ä¸‹è½½",downloading:"ä¸‹è½½ä¸­...",downloaded:"å·²ä¸‹è½½",duration:"æ—¶é•¿",episode:"é›†",season:"å­£",subscribe:"è®¢é˜…",unsubscribe:"å–æ¶ˆè®¢é˜…",search:"æœç´¢æ’­å®¢...",noResults:"æœªæ‰¾åˆ°æ’­å®¢"},DI={title:"PDF",loading:"åŠ è½½ PDF ä¸­...",page:"é¡µ",of:"/",zoom:"ç¼©æ”¾",fitWidth:"é€‚åº”å®½åº¦",fitPage:"é€‚åº”é¡µé¢",download:"ä¸‹è½½"},jI={title:"æœç´¢",placeholder:"æœç´¢æ–‡ç« ...",noResults:"æœªæ‰¾åˆ°æ–‡ç« ",results:"æ¡ç»“æžœ",searching:"æœç´¢ä¸­...",filters:"ç­›é€‰",dateRange:"æ—¥æœŸèŒƒå›´",source:"æ¥æº",clearFilters:"æ¸…é™¤ç­›é€‰"},RI={title:"ä¸‹è½½ç®¡ç†",noDownloads:"æš‚æ— ä¸‹è½½",status:{queued:"æŽ’é˜Ÿä¸­",downloading:"ä¸‹è½½ä¸­",ready:"å·²å®Œæˆ",failed:"å¤±è´¥"},cancel:"å–æ¶ˆ",clear:"æ¸…é™¤",clearCompleted:"æ¸…é™¤å·²å®Œæˆ",clearFailed:"æ¸…é™¤å¤±è´¥",retry:"é‡è¯•",openFile:"æ‰“å¼€æ–‡ä»¶",openFolder:"æ‰“å¼€æ–‡ä»¶å¤¹",size:"å¤§å°",addedAt:"æ·»åŠ æ—¶é—´",lastAccessed:"æœ€åŽè®¿é—®"},LI={title:"é”®ç›˜å¿«æ·é”®",general:"é€šç”¨",navigation:"å¯¼èˆª",article:"æ–‡ç« æ“ä½œ",openReader:"åœ¨é˜…è¯»å™¨ä¸­æ‰“å¼€æ–‡ç« ",markRead:"æ ‡è®°ä¸ºå·²è¯»",markUnread:"æ ‡è®°ä¸ºæœªè¯»",archive:"å½’æ¡£æ–‡ç« ",delete:"åˆ é™¤æ–‡ç« ",later:"æ·»åŠ åˆ°ç¨åŽé˜…è¯»",shortlist:"åˆ‡æ¢æ”¶è—",toggleSidebar:"åˆ‡æ¢ä¾§è¾¹æ ",toggleDetailPanel:"åˆ‡æ¢è¯¦æƒ…é¢æ¿",search:"æœç´¢",commandPalette:"å‘½ä»¤é¢æ¿",saveUrl:"ä¿å­˜é“¾æŽ¥åˆ°æ–‡åº“",addFeed:"æ·»åŠ è®¢é˜…",shortcutsHelp:"å¿«æ·é”®å¸®åŠ©"},MI={title:"åˆ†äº«å¡ç‰‡",theme:"ä¸»é¢˜",cardType:"å¡ç‰‡ç±»åž‹",single:"å•æ¡é«˜äº®",multi:"å¤šæ¡é«˜äº®",summary:"æ‘˜è¦",quoteStyle:"å¼•ç”¨æ ·å¼",borderLeft:"å·¦è¾¹æ¡†",quotationMarks:"å¼•å·",highlightBg:"é«˜äº®èƒŒæ™¯",minimal:"ç®€çº¦",export:"å¯¼å‡º",copyImage:"å¤åˆ¶å›¾ç‰‡",downloadImage:"ä¸‹è½½å›¾ç‰‡",copySuccess:"å·²å¤åˆ¶åˆ°å‰ªè´´æ¿",downloadSuccess:"å›¾ç‰‡å·²ä¿å­˜",exportFailed:"å¯¼å‡ºå¤±è´¥"},OI={title:"æ ‡ç­¾",create:"åˆ›å»ºæ ‡ç­¾",edit:"ç¼–è¾‘æ ‡ç­¾",delete:"åˆ é™¤æ ‡ç­¾",name:"æ ‡ç­¾åç§°",parent:"çˆ¶æ ‡ç­¾",noParent:"æ— ï¼ˆé¡¶çº§æ ‡ç­¾ï¼‰",confirmDelete:"ç¡®å®šè¦åˆ é™¤è¿™ä¸ªæ ‡ç­¾å—ï¼Ÿ",createSuccess:"æ ‡ç­¾åˆ›å»ºæˆåŠŸ",editSuccess:"æ ‡ç­¾æ›´æ–°æˆåŠŸ",deleteSuccess:"æ ‡ç­¾å·²åˆ é™¤",search:"æœç´¢æ ‡ç­¾...",noTags:"æš‚æ— æ ‡ç­¾"},II={title:"æ–‡å­—ç¨¿",loading:"åŠ è½½æ–‡å­—ç¨¿ä¸­...",noTranscript:"æš‚æ— æ–‡å­—ç¨¿",fetch:"èŽ·å–æ–‡å­—ç¨¿",fetching:"èŽ·å–ä¸­...",fetchFailed:"èŽ·å–æ–‡å­—ç¨¿å¤±è´¥",language:"è¯­è¨€",copy:"å¤åˆ¶",copySuccess:"å·²å¤åˆ¶"},PI={loading:"åŠ è½½ä¸­...",error:"é”™è¯¯",success:"æˆåŠŸ",cancel:"å–æ¶ˆ",confirm:"ç¡®è®¤",delete:"åˆ é™¤",save:"ä¿å­˜",edit:"ç¼–è¾‘",close:"å…³é—­",refresh:"åˆ·æ–°",retry:"é‡è¯•",back:"è¿”å›ž",next:"ä¸‹ä¸€æ­¥",previous:"ä¸Šä¸€æ­¥",yes:"æ˜¯",no:"å¦",ok:"ç¡®å®š",apply:"åº”ç”¨",reset:"é‡ç½®",select:"é€‰æ‹©",selected:"å·²é€‰æ‹©",none:"æ— ",all:"å…¨éƒ¨",search:"æœç´¢",filter:"ç­›é€‰",sort:"æŽ’åº",export:"å¯¼å‡º",import:"å¯¼å…¥",upload:"ä¸Šä¼ ",download:"ä¸‹è½½",copy:"å¤åˆ¶",paste:"ç²˜è´´",cut:"å‰ªåˆ‡",selectAll:"å…¨é€‰",deselectAll:"å–æ¶ˆå…¨é€‰",showMore:"æ˜¾ç¤ºæ›´å¤š",showLess:"æ˜¾ç¤ºæ›´å°‘",expand:"å±•å¼€",collapse:"æ”¶èµ·",more:"æ›´å¤š",less:"æ›´å°‘",required:"å¿…å¡«",optional:"å¯é€‰",enabled:"å¯ç”¨",disabled:"ç¦ç”¨",active:"æ´»è·ƒ",inactive:"æœªæ´»è·ƒ",public:"å…¬å¼€",private:"ç§æœ‰",shared:"å…±äº«"},BI={justNow:"åˆšåˆš",minutesAgo:"{n} åˆ†é’Ÿå‰",hoursAgo:"{n} å°æ—¶å‰",daysAgo:"{n} å¤©å‰",weeksAgo:"{n} å‘¨å‰",monthsAgo:"{n} æœˆå‰",yearsAgo:"{n} å¹´å‰",inMinutes:"{n} åˆ†é’ŸåŽ",inHours:"{n} å°æ—¶åŽ",inDays:"{n} å¤©åŽ",inWeeks:"{n} å‘¨åŽ",inMonths:"{n} æœˆåŽ",inYears:"{n} å¹´åŽ",today:"ä»Šå¤©",yesterday:"æ˜¨å¤©",tomorrow:"æ˜Žå¤©"},FI={title:"å¯¹è¯",placeholder:"è¾“å…¥æ¶ˆæ¯...",send:"å‘é€",newSession:"æ–°å¯¹è¯",thinking:"æ€è€ƒä¸­...",toolCalling:"æ­£åœ¨æ‰§è¡Œ: {{name}}",empty:"å¼€å§‹å’Œ AI èŠå¤©å§",sessionList:"å¯¹è¯åŽ†å²",analysisHint:"æˆ–ç›´æŽ¥è¾“å…¥ä½ çš„é—®é¢˜",analysis:{valueClarification:"ä»·å€¼æ¾„æ¸…",valueClarificationDesc:"è¯†åˆ«æ ¸å¿ƒä»·å€¼è§‚ä¸Žæ½œåœ¨å†²çª",sixThinkingHats:"å…­é¡¶æ€è€ƒå¸½",sixThinkingHatsDesc:"ä»Žå…­ä¸ªè§’åº¦å…¨é¢åˆ†æž",firstPrinciples:"ç¬¬ä¸€æ€§åŽŸç†",firstPrinciplesDesc:"å›žå½’åŸºæœ¬äº‹å®žé‡æ–°æŽ¨å¯¼",socraticMethod:"è‹æ ¼æ‹‰åº•æé—®",socraticMethodDesc:"å±‚å±‚è¿½é—®æŒ‘æˆ˜å‡è®¾ä¸Žé€»è¾‘",feynmanTechnique:"è´¹æ›¼æ•™å­¦æ³•",feynmanTechniqueDesc:"ç”¨æœ€ç®€å•çš„è¯­è¨€é‡æ–°è§£é‡Š"},error:"å‘ç”Ÿé”™è¯¯ï¼Œè¯·é‡è¯•"},zI={settings:"AI è®¾ç½®",provider:"AI æœåŠ¡å•†",apiKey:"API Key",apiKeyPlaceholder:"è¾“å…¥ä½ çš„ API Key",modelFast:"å¿«é€Ÿæ¨¡åž‹",modelSmart:"æ™ºèƒ½æ¨¡åž‹",modelCheap:"ç»æµŽæ¨¡åž‹",save:"ä¿å­˜",saved:"å·²ä¿å­˜",testConnection:"æµ‹è¯•è¿žæŽ¥",connectionOk:"è¿žæŽ¥æˆåŠŸ",connectionFailed:"è¿žæŽ¥å¤±è´¥",notConfigured:"æœªé…ç½®",summarize:"AI æ‘˜è¦",translate:"AI ç¿»è¯‘",autoTag:"AI æ ‡ç­¾",generating:"ç”Ÿæˆä¸­...",translateTo:"ç¿»è¯‘ä¸º",taskLogs:"AI è°ƒç”¨è®°å½•",tokenUsage:"Token ç”¨é‡",noLogs:"æš‚æ— è°ƒç”¨è®°å½•",chatComingSoon:"AI å¯¹è¯åŠŸèƒ½å°†åœ¨ Phase 2 ä¸­ä¸Šçº¿",configureApiKey:"è¯·å…ˆåœ¨åå¥½è®¾ç½®ä¸­é…ç½® AI API Key",chinese:"ä¸­æ–‡",english:"è‹±æ–‡",japanese:"æ—¥æ–‡",suggestedTags:"æŽ¨èæ ‡ç­¾",applyTag:"åº”ç”¨",errorOccurred:"è°ƒç”¨å¤±è´¥ï¼Œè¯·ç¨åŽé‡è¯•",aiActions:"AI æ“ä½œ",extractTopics:"æå–ä¸»é¢˜",topics:"ä¸»é¢˜å…³é”®è¯",debugPanel:"AI è°ƒè¯•é¢æ¿",callHistory:"è°ƒç”¨åŽ†å²",traceDetails:"æ‰§è¡Œè¿½è¸ª",costSummary:"æˆæœ¬ç»Ÿè®¡",totalTokens:"æ€» Token",totalCost:"æ€»æˆæœ¬",totalCalls:"æ€»è°ƒç”¨æ¬¡æ•°",duration:"è€—æ—¶",input:"è¾“å…¥",output:"è¾“å‡º",steps:"æ­¥éª¤",noTraces:"æ— è¿½è¸ªæ•°æ®",filterAll:"å…¨éƒ¨",viewDetails:"æŸ¥çœ‹è¯¦æƒ…",collapse:"æ”¶èµ·",copyJson:"å¤åˆ¶ JSON",copied:"å·²å¤åˆ¶",error:"é”™è¯¯"},UI={networkError:"ç½‘ç»œé”™è¯¯",serverError:"æœåŠ¡å™¨é”™è¯¯",notFound:"æœªæ‰¾åˆ°",unauthorized:"æœªæŽˆæƒ",forbidden:"ç¦æ­¢è®¿é—®",badRequest:"è¯·æ±‚é”™è¯¯",unknown:"æœªçŸ¥é”™è¯¯",retry:"é‡è¯•",report:"æŠ¥å‘Šé—®é¢˜"},HI={app:yI,sidebar:vI,contentList:xI,detailPanel:bI,preferences:wI,dialog:SI,discover:AI,feedManager:EI,feedDetail:CI,books:_I,reader:NI,video:kI,podcast:TI,pdf:DI,search:jI,downloads:RI,shortcuts:LI,shareCard:MI,tags:OI,transcript:II,common:PI,time:BI,chat:FI,ai:zI,errors:UI},$I={en:{translation:mI},zh:{translation:HI}},qI=[{code:"en",name:"English",nativeName:"English"},{code:"zh",name:"Chinese",nativeName:"ä¸­æ–‡"}];Wn.use(qD).use(p6).init({resources:$I,fallbackLng:"en",supportedLngs:["en","zh"],interpolation:{escapeValue:!1},detection:{order:["localStorage","navigator"],caches:["localStorage"],lookupLocalStorage:"z-reader-language"}});const VD=n=>{Wn.changeLanguage(n),localStorage.setItem("z-reader-language",n)};var GD={exports:{}},_1={},YD={exports:{}},WD={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(F,M){var I=F.length;F.push(M);e:for(;0<I;){var V=I-1>>>1,ie=F[V];if(0<s(ie,M))F[V]=M,F[I]=ie,I=V;else break e}}function t(F){return F.length===0?null:F[0]}function i(F){if(F.length===0)return null;var M=F[0],I=F.pop();if(I!==M){F[0]=I;e:for(var V=0,ie=F.length,ge=ie>>>1;V<ge;){var ee=2*(V+1)-1,me=F[ee],oe=ee+1,ae=F[oe];if(0>s(me,I))oe<ie&&0>s(ae,me)?(F[V]=ae,F[oe]=I,V=oe):(F[V]=me,F[ee]=I,V=ee);else if(oe<ie&&0>s(ae,I))F[V]=ae,F[oe]=I,V=oe;else break e}}return M}function s(F,M){var I=F.sortIndex-M.sortIndex;return I!==0?I:F.id-M.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var r=performance;n.unstable_now=function(){return r.now()}}else{var a=Date,o=a.now();n.unstable_now=function(){return a.now()-o}}var l=[],u=[],d=1,f=null,p=3,g=!1,x=!1,w=!1,y=!1,m=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;function A(F){for(var M=t(u);M!==null;){if(M.callback===null)i(u);else if(M.startTime<=F)i(u),M.sortIndex=M.expirationTime,e(l,M);else break;M=t(u)}}function S(F){if(w=!1,A(F),!x)if(t(l)!==null)x=!0,C||(C=!0,H());else{var M=t(u);M!==null&&Y(S,M.startTime-F)}}var C=!1,k=-1,L=5,D=-1;function j(){return y?!0:!(n.unstable_now()-D<L)}function P(){if(y=!1,C){var F=n.unstable_now();D=F;var M=!0;try{e:{x=!1,w&&(w=!1,v(k),k=-1),g=!0;var I=p;try{t:{for(A(F),f=t(l);f!==null&&!(f.expirationTime>F&&j());){var V=f.callback;if(typeof V=="function"){f.callback=null,p=f.priorityLevel;var ie=V(f.expirationTime<=F);if(F=n.unstable_now(),typeof ie=="function"){f.callback=ie,A(F),M=!0;break t}f===t(l)&&i(l),A(F)}else i(l);f=t(l)}if(f!==null)M=!0;else{var ge=t(u);ge!==null&&Y(S,ge.startTime-F),M=!1}}break e}finally{f=null,p=I,g=!1}M=void 0}}finally{M?H():C=!1}}}var H;if(typeof b=="function")H=function(){b(P)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,$=G.port2;G.port1.onmessage=P,H=function(){$.postMessage(null)}}else H=function(){m(P,0)};function Y(F,M){k=m(function(){F(n.unstable_now())},M)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(F){F.callback=null},n.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<F?Math.floor(1e3/F):5},n.unstable_getCurrentPriorityLevel=function(){return p},n.unstable_next=function(F){switch(p){case 1:case 2:case 3:var M=3;break;default:M=p}var I=p;p=M;try{return F()}finally{p=I}},n.unstable_requestPaint=function(){y=!0},n.unstable_runWithPriority=function(F,M){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var I=p;p=F;try{return M()}finally{p=I}},n.unstable_scheduleCallback=function(F,M,I){var V=n.unstable_now();switch(typeof I=="object"&&I!==null?(I=I.delay,I=typeof I=="number"&&0<I?V+I:V):I=V,F){case 1:var ie=-1;break;case 2:ie=250;break;case 5:ie=1073741823;break;case 4:ie=1e4;break;default:ie=5e3}return ie=I+ie,F={id:d++,callback:M,priorityLevel:F,startTime:I,expirationTime:ie,sortIndex:-1},I>V?(F.sortIndex=I,e(u,F),t(l)===null&&F===t(u)&&(w?(v(k),k=-1):w=!0,Y(S,I-V))):(F.sortIndex=ie,e(l,F),x||g||(x=!0,C||(C=!0,H()))),F},n.unstable_shouldYield=j,n.unstable_wrapCallback=function(F){var M=p;return function(){var I=p;p=M;try{return F.apply(this,arguments)}finally{p=I}}}})(WD);YD.exports=WD;var VI=YD.exports,XD={exports:{}},os={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var GI=E;function KD(n){var e="https://react.dev/errors/"+n;if(1<arguments.length){e+="?args[]="+encodeURIComponent(arguments[1]);for(var t=2;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t])}return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function Tl(){}var ns={d:{f:Tl,r:function(){throw Error(KD(522))},D:Tl,C:Tl,L:Tl,m:Tl,X:Tl,S:Tl,M:Tl},p:0,findDOMNode:null},YI=Symbol.for("react.portal");function WI(n,e,t){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:YI,key:i==null?null:""+i,children:n,containerInfo:e,implementation:t}}var lm=GI.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function N1(n,e){if(n==="font")return"";if(typeof e=="string")return e==="use-credentials"?e:""}os.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=ns;os.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)throw Error(KD(299));return WI(n,e,null,t)};os.flushSync=function(n){var e=lm.T,t=ns.p;try{if(lm.T=null,ns.p=2,n)return n()}finally{lm.T=e,ns.p=t,ns.d.f()}};os.preconnect=function(n,e){typeof n=="string"&&(e?(e=e.crossOrigin,e=typeof e=="string"?e==="use-credentials"?e:"":void 0):e=null,ns.d.C(n,e))};os.prefetchDNS=function(n){typeof n=="string"&&ns.d.D(n)};os.preinit=function(n,e){if(typeof n=="string"&&e&&typeof e.as=="string"){var t=e.as,i=N1(t,e.crossOrigin),s=typeof e.integrity=="string"?e.integrity:void 0,r=typeof e.fetchPriority=="string"?e.fetchPriority:void 0;t==="style"?ns.d.S(n,typeof e.precedence=="string"?e.precedence:void 0,{crossOrigin:i,integrity:s,fetchPriority:r}):t==="script"&&ns.d.X(n,{crossOrigin:i,integrity:s,fetchPriority:r,nonce:typeof e.nonce=="string"?e.nonce:void 0})}};os.preinitModule=function(n,e){if(typeof n=="string")if(typeof e=="object"&&e!==null){if(e.as==null||e.as==="script"){var t=N1(e.as,e.crossOrigin);ns.d.M(n,{crossOrigin:t,integrity:typeof e.integrity=="string"?e.integrity:void 0,nonce:typeof e.nonce=="string"?e.nonce:void 0})}}else e==null&&ns.d.M(n)};os.preload=function(n,e){if(typeof n=="string"&&typeof e=="object"&&e!==null&&typeof e.as=="string"){var t=e.as,i=N1(t,e.crossOrigin);ns.d.L(n,t,{crossOrigin:i,integrity:typeof e.integrity=="string"?e.integrity:void 0,nonce:typeof e.nonce=="string"?e.nonce:void 0,type:typeof e.type=="string"?e.type:void 0,fetchPriority:typeof e.fetchPriority=="string"?e.fetchPriority:void 0,referrerPolicy:typeof e.referrerPolicy=="string"?e.referrerPolicy:void 0,imageSrcSet:typeof e.imageSrcSet=="string"?e.imageSrcSet:void 0,imageSizes:typeof e.imageSizes=="string"?e.imageSizes:void 0,media:typeof e.media=="string"?e.media:void 0})}};os.preloadModule=function(n,e){if(typeof n=="string")if(e){var t=N1(e.as,e.crossOrigin);ns.d.m(n,{as:typeof e.as=="string"&&e.as!=="script"?e.as:void 0,crossOrigin:t,integrity:typeof e.integrity=="string"?e.integrity:void 0})}else ns.d.m(n)};os.requestFormReset=function(n){ns.d.r(n)};os.unstable_batchedUpdates=function(n,e){return n(e)};os.useFormState=function(n,e,t){return lm.H.useFormState(n,e,t)};os.useFormStatus=function(){return lm.H.useHostTransitionStatus()};os.version="19.2.4";function ZD(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(ZD)}catch(n){console.error(n)}}ZD(),XD.exports=os;var XI=XD.exports;/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ln=VI,QD=E,KI=XI;function Ee(n){var e="https://react.dev/errors/"+n;if(1<arguments.length){e+="?args[]="+encodeURIComponent(arguments[1]);for(var t=2;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t])}return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function JD(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function Vy(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function e3(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function t3(n){if(n.tag===31){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function tN(n){if(Vy(n)!==n)throw Error(Ee(188))}function ZI(n){var e=n.alternate;if(!e){if(e=Vy(n),e===null)throw Error(Ee(188));return e!==n?null:n}for(var t=n,i=e;;){var s=t.return;if(s===null)break;var r=s.alternate;if(r===null){if(i=s.return,i!==null){t=i;continue}break}if(s.child===r.child){for(r=s.child;r;){if(r===t)return tN(s),n;if(r===i)return tN(s),e;r=r.sibling}throw Error(Ee(188))}if(t.return!==i.return)t=s,i=r;else{for(var a=!1,o=s.child;o;){if(o===t){a=!0,t=s,i=r;break}if(o===i){a=!0,i=s,t=r;break}o=o.sibling}if(!a){for(o=r.child;o;){if(o===t){a=!0,t=r,i=s;break}if(o===i){a=!0,i=r,t=s;break}o=o.sibling}if(!a)throw Error(Ee(189))}}if(t.alternate!==i)throw Error(Ee(190))}if(t.tag!==3)throw Error(Ee(188));return t.stateNode.current===t?n:e}function i3(n){var e=n.tag;if(e===5||e===26||e===27||e===6)return n;for(n=n.child;n!==null;){if(e=i3(n),e!==null)return e;n=n.sibling}return null}var yi=Object.assign,QI=Symbol.for("react.element"),Av=Symbol.for("react.transitional.element"),Mg=Symbol.for("react.portal"),Id=Symbol.for("react.fragment"),n3=Symbol.for("react.strict_mode"),G2=Symbol.for("react.profiler"),s3=Symbol.for("react.consumer"),il=Symbol.for("react.context"),zE=Symbol.for("react.forward_ref"),Y2=Symbol.for("react.suspense"),W2=Symbol.for("react.suspense_list"),UE=Symbol.for("react.memo"),Rl=Symbol.for("react.lazy"),X2=Symbol.for("react.activity"),JI=Symbol.for("react.memo_cache_sentinel"),iN=Symbol.iterator;function yg(n){return n===null||typeof n!="object"?null:(n=iN&&n[iN]||n["@@iterator"],typeof n=="function"?n:null)}var eP=Symbol.for("react.client.reference");function K2(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===eP?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Id:return"Fragment";case G2:return"Profiler";case n3:return"StrictMode";case Y2:return"Suspense";case W2:return"SuspenseList";case X2:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case Mg:return"Portal";case il:return n.displayName||"Context";case s3:return(n._context.displayName||"Context")+".Consumer";case zE:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case UE:return e=n.displayName||null,e!==null?e:K2(n.type)||"Memo";case Rl:e=n._payload,n=n._init;try{return K2(n(e))}catch{}}return null}var Og=Array.isArray,ot=QD.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ut=KI.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Lh={pending:!1,data:null,method:null,action:null},Z2=[],Pd=-1;function no(n){return{current:n}}function bn(n){0>Pd||(n.current=Z2[Pd],Z2[Pd]=null,Pd--)}function di(n,e){Pd++,Z2[Pd]=n.current,n.current=e}var Xa=no(null),Em=no(null),zc=no(null),tb=no(null);function ib(n,e){switch(di(zc,e),di(Em,n),di(Xa,null),e.nodeType){case 9:case 11:n=(n=e.documentElement)&&(n=n.namespaceURI)?lk(n):0;break;default:if(n=e.tagName,e=e.namespaceURI)e=lk(e),n=Ej(e,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}bn(Xa),di(Xa,n)}function Bp(){bn(Xa),bn(Em),bn(zc)}function Q2(n){n.memoizedState!==null&&di(tb,n);var e=Xa.current,t=Ej(e,n.type);e!==t&&(di(Em,n),di(Xa,t))}function nb(n){Em.current===n&&(bn(Xa),bn(Em)),tb.current===n&&(bn(tb),Om._currentValue=Lh)}var Tw,nN;function uu(n){if(Tw===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);Tw=e&&e[1]||"",nN=-1<t.stack.indexOf(`
    at`)?" (<anonymous>)":-1<t.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Tw+n+nN}var Dw=!1;function jw(n,e){if(!n||Dw)return"";Dw=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var i={DetermineComponentFrameRoot:function(){try{if(e){var f=function(){throw Error()};if(Object.defineProperty(f.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(f,[])}catch(g){var p=g}Reflect.construct(n,[],f)}else{try{f.call()}catch(g){p=g}n.call(f.prototype)}}else{try{throw Error()}catch(g){p=g}(f=n())&&typeof f.catch=="function"&&f.catch(function(){})}}catch(g){if(g&&p&&typeof g.stack=="string")return[g.stack,p.stack]}return[null,null]}};i.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var s=Object.getOwnPropertyDescriptor(i.DetermineComponentFrameRoot,"name");s&&s.configurable&&Object.defineProperty(i.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var r=i.DetermineComponentFrameRoot(),a=r[0],o=r[1];if(a&&o){var l=a.split(`
`),u=o.split(`
`);for(s=i=0;i<l.length&&!l[i].includes("DetermineComponentFrameRoot");)i++;for(;s<u.length&&!u[s].includes("DetermineComponentFrameRoot");)s++;if(i===l.length||s===u.length)for(i=l.length-1,s=u.length-1;1<=i&&0<=s&&l[i]!==u[s];)s--;for(;1<=i&&0<=s;i--,s--)if(l[i]!==u[s]){if(i!==1||s!==1)do if(i--,s--,0>s||l[i]!==u[s]){var d=`
`+l[i].replace(" at new "," at ");return n.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",n.displayName)),d}while(1<=i&&0<=s);break}}}finally{Dw=!1,Error.prepareStackTrace=t}return(t=n?n.displayName||n.name:"")?uu(t):""}function tP(n,e){switch(n.tag){case 26:case 27:case 5:return uu(n.type);case 16:return uu("Lazy");case 13:return n.child!==e&&e!==null?uu("Suspense Fallback"):uu("Suspense");case 19:return uu("SuspenseList");case 0:case 15:return jw(n.type,!1);case 11:return jw(n.type.render,!1);case 1:return jw(n.type,!0);case 31:return uu("Activity");default:return""}}function sN(n){try{var e="",t=null;do e+=tP(n,t),t=n,n=n.return;while(n);return e}catch(i){return`
Error generating stack: `+i.message+`
`+i.stack}}var J2=Object.prototype.hasOwnProperty,HE=ln.unstable_scheduleCallback,Rw=ln.unstable_cancelCallback,iP=ln.unstable_shouldYield,nP=ln.unstable_requestPaint,ar=ln.unstable_now,sP=ln.unstable_getCurrentPriorityLevel,r3=ln.unstable_ImmediatePriority,a3=ln.unstable_UserBlockingPriority,sb=ln.unstable_NormalPriority,rP=ln.unstable_LowPriority,o3=ln.unstable_IdlePriority,aP=ln.log,oP=ln.unstable_setDisableYieldValue,Gy=null,or=null;function Lc(n){if(typeof aP=="function"&&oP(n),or&&typeof or.setStrictMode=="function")try{or.setStrictMode(Gy,n)}catch{}}var lr=Math.clz32?Math.clz32:uP,lP=Math.log,cP=Math.LN2;function uP(n){return n>>>=0,n===0?32:31-(lP(n)/cP|0)|0}var Ev=256,Cv=262144,_v=4194304;function hu(n){var e=n&42;if(e!==0)return e;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function k1(n,e,t){var i=n.pendingLanes;if(i===0)return 0;var s=0,r=n.suspendedLanes,a=n.pingedLanes;n=n.warmLanes;var o=i&134217727;return o!==0?(i=o&~r,i!==0?s=hu(i):(a&=o,a!==0?s=hu(a):t||(t=o&~n,t!==0&&(s=hu(t))))):(o=i&~r,o!==0?s=hu(o):a!==0?s=hu(a):t||(t=i&~n,t!==0&&(s=hu(t)))),s===0?0:e!==0&&e!==s&&!(e&r)&&(r=s&-s,t=e&-e,r>=t||r===32&&(t&4194048)!==0)?e:s}function Yy(n,e){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&e)===0}function hP(n,e){switch(n){case 1:case 2:case 4:case 8:case 64:return e+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function l3(){var n=_v;return _v<<=1,!(_v&62914560)&&(_v=4194304),n}function Lw(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function Wy(n,e){n.pendingLanes|=e,e!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function dP(n,e,t,i,s,r){var a=n.pendingLanes;n.pendingLanes=t,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=t,n.entangledLanes&=t,n.errorRecoveryDisabledLanes&=t,n.shellSuspendCounter=0;var o=n.entanglements,l=n.expirationTimes,u=n.hiddenUpdates;for(t=a&~t;0<t;){var d=31-lr(t),f=1<<d;o[d]=0,l[d]=-1;var p=u[d];if(p!==null)for(u[d]=null,d=0;d<p.length;d++){var g=p[d];g!==null&&(g.lane&=-536870913)}t&=~f}i!==0&&c3(n,i,0),r!==0&&s===0&&n.tag!==0&&(n.suspendedLanes|=r&~(a&~e))}function c3(n,e,t){n.pendingLanes|=e,n.suspendedLanes&=~e;var i=31-lr(e);n.entangledLanes|=e,n.entanglements[i]=n.entanglements[i]|1073741824|t&261930}function u3(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var i=31-lr(t),s=1<<i;s&e|n[i]&e&&(n[i]|=e),t&=~s}}function h3(n,e){var t=e&-e;return t=t&42?1:$E(t),t&(n.suspendedLanes|e)?0:t}function $E(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function qE(n){return n&=-n,2<n?8<n?n&134217727?32:268435456:8:2}function d3(){var n=Ut.p;return n!==0?n:(n=window.event,n===void 0?32:Oj(n.type))}function rN(n,e){var t=Ut.p;try{return Ut.p=n,e()}finally{Ut.p=t}}var nu=Math.random().toString(36).slice(2),Ln="__reactFiber$"+nu,Ns="__reactProps$"+nu,rg="__reactContainer$"+nu,eS="__reactEvents$"+nu,fP="__reactListeners$"+nu,pP="__reactHandles$"+nu,aN="__reactResources$"+nu,Xy="__reactMarker$"+nu;function VE(n){delete n[Ln],delete n[Ns],delete n[eS],delete n[fP],delete n[pP]}function Bd(n){var e=n[Ln];if(e)return e;for(var t=n.parentNode;t;){if(e=t[rg]||t[Ln]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=fk(n);n!==null;){if(t=n[Ln])return t;n=fk(n)}return e}n=t,t=n.parentNode}return null}function ag(n){if(n=n[Ln]||n[rg]){var e=n.tag;if(e===5||e===6||e===13||e===31||e===26||e===27||e===3)return n}return null}function Ig(n){var e=n.tag;if(e===5||e===26||e===27||e===6)return n.stateNode;throw Error(Ee(33))}function tf(n){var e=n[aN];return e||(e=n[aN]={hoistableStyles:new Map,hoistableScripts:new Map}),e}function xn(n){n[Xy]=!0}var f3=new Set,p3={};function Xh(n,e){Fp(n,e),Fp(n+"Capture",e)}function Fp(n,e){for(p3[n]=e,n=0;n<e.length;n++)f3.add(e[n])}var gP=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),oN={},lN={};function mP(n){return J2.call(lN,n)?!0:J2.call(oN,n)?!1:gP.test(n)?lN[n]=!0:(oN[n]=!0,!1)}function Zv(n,e,t){if(mP(e))if(t===null)n.removeAttribute(e);else{switch(typeof t){case"undefined":case"function":case"symbol":n.removeAttribute(e);return;case"boolean":var i=e.toLowerCase().slice(0,5);if(i!=="data-"&&i!=="aria-"){n.removeAttribute(e);return}}n.setAttribute(e,""+t)}}function Nv(n,e,t){if(t===null)n.removeAttribute(e);else{switch(typeof t){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(e);return}n.setAttribute(e,""+t)}}function ao(n,e,t,i){if(i===null)n.removeAttribute(t);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(t);return}n.setAttributeNS(e,t,""+i)}}function Lr(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function g3(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function yP(n,e,t){var i=Object.getOwnPropertyDescriptor(n.constructor.prototype,e);if(!n.hasOwnProperty(e)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var s=i.get,r=i.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return s.call(this)},set:function(a){t=""+a,r.call(this,a)}}),Object.defineProperty(n,e,{enumerable:i.enumerable}),{getValue:function(){return t},setValue:function(a){t=""+a},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function tS(n){if(!n._valueTracker){var e=g3(n)?"checked":"value";n._valueTracker=yP(n,e,""+n[e])}}function m3(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),i="";return n&&(i=g3(n)?n.checked?"true":"false":n.value),n=i,n!==t?(e.setValue(n),!0):!1}function rb(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var vP=/[\n"\\]/g;function Ir(n){return n.replace(vP,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function iS(n,e,t,i,s,r,a,o){n.name="",a!=null&&typeof a!="function"&&typeof a!="symbol"&&typeof a!="boolean"?n.type=a:n.removeAttribute("type"),e!=null?a==="number"?(e===0&&n.value===""||n.value!=e)&&(n.value=""+Lr(e)):n.value!==""+Lr(e)&&(n.value=""+Lr(e)):a!=="submit"&&a!=="reset"||n.removeAttribute("value"),e!=null?nS(n,a,Lr(e)):t!=null?nS(n,a,Lr(t)):i!=null&&n.removeAttribute("value"),s==null&&r!=null&&(n.defaultChecked=!!r),s!=null&&(n.checked=s&&typeof s!="function"&&typeof s!="symbol"),o!=null&&typeof o!="function"&&typeof o!="symbol"&&typeof o!="boolean"?n.name=""+Lr(o):n.removeAttribute("name")}function y3(n,e,t,i,s,r,a,o){if(r!=null&&typeof r!="function"&&typeof r!="symbol"&&typeof r!="boolean"&&(n.type=r),e!=null||t!=null){if(!(r!=="submit"&&r!=="reset"||e!=null)){tS(n);return}t=t!=null?""+Lr(t):"",e=e!=null?""+Lr(e):t,o||e===n.value||(n.value=e),n.defaultValue=e}i=i??s,i=typeof i!="function"&&typeof i!="symbol"&&!!i,n.checked=o?n.checked:!!i,n.defaultChecked=!!i,a!=null&&typeof a!="function"&&typeof a!="symbol"&&typeof a!="boolean"&&(n.name=a),tS(n)}function nS(n,e,t){e==="number"&&rb(n.ownerDocument)===n||n.defaultValue===""+t||(n.defaultValue=""+t)}function nf(n,e,t,i){if(n=n.options,e){e={};for(var s=0;s<t.length;s++)e["$"+t[s]]=!0;for(t=0;t<n.length;t++)s=e.hasOwnProperty("$"+n[t].value),n[t].selected!==s&&(n[t].selected=s),s&&i&&(n[t].defaultSelected=!0)}else{for(t=""+Lr(t),e=null,s=0;s<n.length;s++){if(n[s].value===t){n[s].selected=!0,i&&(n[s].defaultSelected=!0);return}e!==null||n[s].disabled||(e=n[s])}e!==null&&(e.selected=!0)}}function v3(n,e,t){if(e!=null&&(e=""+Lr(e),e!==n.value&&(n.value=e),t==null)){n.defaultValue!==e&&(n.defaultValue=e);return}n.defaultValue=t!=null?""+Lr(t):""}function x3(n,e,t,i){if(e==null){if(i!=null){if(t!=null)throw Error(Ee(92));if(Og(i)){if(1<i.length)throw Error(Ee(93));i=i[0]}t=i}t==null&&(t=""),e=t}t=Lr(e),n.defaultValue=t,i=n.textContent,i===t&&i!==""&&i!==null&&(n.value=i),tS(n)}function zp(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var xP=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function cN(n,e,t){var i=e.indexOf("--")===0;t==null||typeof t=="boolean"||t===""?i?n.setProperty(e,""):e==="float"?n.cssFloat="":n[e]="":i?n.setProperty(e,t):typeof t!="number"||t===0||xP.has(e)?e==="float"?n.cssFloat=t:n[e]=(""+t).trim():n[e]=t+"px"}function b3(n,e,t){if(e!=null&&typeof e!="object")throw Error(Ee(62));if(n=n.style,t!=null){for(var i in t)!t.hasOwnProperty(i)||e!=null&&e.hasOwnProperty(i)||(i.indexOf("--")===0?n.setProperty(i,""):i==="float"?n.cssFloat="":n[i]="");for(var s in e)i=e[s],e.hasOwnProperty(s)&&t[s]!==i&&cN(n,s,i)}else for(var r in e)e.hasOwnProperty(r)&&cN(n,r,e[r])}function GE(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var bP=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),wP=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Qv(n){return wP.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function nl(){}var sS=null;function YE(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Fd=null,sf=null;function uN(n){var e=ag(n);if(e&&(n=e.stateNode)){var t=n[Ns]||null;e:switch(n=e.stateNode,e.type){case"input":if(iS(n,t.value,t.defaultValue,t.defaultValue,t.checked,t.defaultChecked,t.type,t.name),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll('input[name="'+Ir(""+e)+'"][type="radio"]'),e=0;e<t.length;e++){var i=t[e];if(i!==n&&i.form===n.form){var s=i[Ns]||null;if(!s)throw Error(Ee(90));iS(i,s.value,s.defaultValue,s.defaultValue,s.checked,s.defaultChecked,s.type,s.name)}}for(e=0;e<t.length;e++)i=t[e],i.form===n.form&&m3(i)}break e;case"textarea":v3(n,t.value,t.defaultValue);break e;case"select":e=t.value,e!=null&&nf(n,!!t.multiple,e,!1)}}}var Mw=!1;function w3(n,e,t){if(Mw)return n(e,t);Mw=!0;try{var i=n(e);return i}finally{if(Mw=!1,(Fd!==null||sf!==null)&&(z1(),Fd&&(e=Fd,n=sf,sf=Fd=null,uN(e),n)))for(e=0;e<n.length;e++)uN(n[e])}}function Cm(n,e){var t=n.stateNode;if(t===null)return null;var i=t[Ns]||null;if(i===null)return null;t=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(n=n.type,i=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!i;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(Ee(231,e,typeof t));return t}var fl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),rS=!1;if(fl)try{var vg={};Object.defineProperty(vg,"passive",{get:function(){rS=!0}}),window.addEventListener("test",vg,vg),window.removeEventListener("test",vg,vg)}catch{rS=!1}var Mc=null,WE=null,Jv=null;function S3(){if(Jv)return Jv;var n,e=WE,t=e.length,i,s="value"in Mc?Mc.value:Mc.textContent,r=s.length;for(n=0;n<t&&e[n]===s[n];n++);var a=t-n;for(i=1;i<=a&&e[t-i]===s[r-i];i++);return Jv=s.slice(n,1<i?1-i:void 0)}function ex(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function kv(){return!0}function hN(){return!1}function ks(n){function e(t,i,s,r,a){this._reactName=t,this._targetInst=s,this.type=i,this.nativeEvent=r,this.target=a,this.currentTarget=null;for(var o in n)n.hasOwnProperty(o)&&(t=n[o],this[o]=t?t(r):r[o]);return this.isDefaultPrevented=(r.defaultPrevented!=null?r.defaultPrevented:r.returnValue===!1)?kv:hN,this.isPropagationStopped=hN,this}return yi(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=kv)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=kv)},persist:function(){},isPersistent:kv}),e}var Kh={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},T1=ks(Kh),Ky=yi({},Kh,{view:0,detail:0}),SP=ks(Ky),Ow,Iw,xg,D1=yi({},Ky,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:XE,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==xg&&(xg&&n.type==="mousemove"?(Ow=n.screenX-xg.screenX,Iw=n.screenY-xg.screenY):Iw=Ow=0,xg=n),Ow)},movementY:function(n){return"movementY"in n?n.movementY:Iw}}),dN=ks(D1),AP=yi({},D1,{dataTransfer:0}),EP=ks(AP),CP=yi({},Ky,{relatedTarget:0}),Pw=ks(CP),_P=yi({},Kh,{animationName:0,elapsedTime:0,pseudoElement:0}),NP=ks(_P),kP=yi({},Kh,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),TP=ks(kP),DP=yi({},Kh,{data:0}),fN=ks(DP),jP={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},RP={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},LP={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function MP(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=LP[n])?!!e[n]:!1}function XE(){return MP}var OP=yi({},Ky,{key:function(n){if(n.key){var e=jP[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=ex(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?RP[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:XE,charCode:function(n){return n.type==="keypress"?ex(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?ex(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),IP=ks(OP),PP=yi({},D1,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),pN=ks(PP),BP=yi({},Ky,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:XE}),FP=ks(BP),zP=yi({},Kh,{propertyName:0,elapsedTime:0,pseudoElement:0}),UP=ks(zP),HP=yi({},D1,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),$P=ks(HP),qP=yi({},Kh,{newState:0,oldState:0}),VP=ks(qP),GP=[9,13,27,32],KE=fl&&"CompositionEvent"in window,cm=null;fl&&"documentMode"in document&&(cm=document.documentMode);var YP=fl&&"TextEvent"in window&&!cm,A3=fl&&(!KE||cm&&8<cm&&11>=cm),gN=" ",mN=!1;function E3(n,e){switch(n){case"keyup":return GP.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function C3(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var zd=!1;function WP(n,e){switch(n){case"compositionend":return C3(e);case"keypress":return e.which!==32?null:(mN=!0,gN);case"textInput":return n=e.data,n===gN&&mN?null:n;default:return null}}function XP(n,e){if(zd)return n==="compositionend"||!KE&&E3(n,e)?(n=S3(),Jv=WE=Mc=null,zd=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return A3&&e.locale!=="ko"?null:e.data;default:return null}}var KP={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function yN(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!KP[n.type]:e==="textarea"}function _3(n,e,t,i){Fd?sf?sf.push(i):sf=[i]:Fd=i,e=Ab(e,"onChange"),0<e.length&&(t=new T1("onChange","change",null,t,i),n.push({event:t,listeners:e}))}var um=null,_m=null;function ZP(n){wj(n,0)}function j1(n){var e=Ig(n);if(m3(e))return n}function vN(n,e){if(n==="change")return e}var N3=!1;if(fl){var Bw;if(fl){var Fw="oninput"in document;if(!Fw){var xN=document.createElement("div");xN.setAttribute("oninput","return;"),Fw=typeof xN.oninput=="function"}Bw=Fw}else Bw=!1;N3=Bw&&(!document.documentMode||9<document.documentMode)}function bN(){um&&(um.detachEvent("onpropertychange",k3),_m=um=null)}function k3(n){if(n.propertyName==="value"&&j1(_m)){var e=[];_3(e,_m,n,YE(n)),w3(ZP,e)}}function QP(n,e,t){n==="focusin"?(bN(),um=e,_m=t,um.attachEvent("onpropertychange",k3)):n==="focusout"&&bN()}function JP(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return j1(_m)}function eB(n,e){if(n==="click")return j1(e)}function tB(n,e){if(n==="input"||n==="change")return j1(e)}function iB(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var hr=typeof Object.is=="function"?Object.is:iB;function Nm(n,e){if(hr(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),i=Object.keys(e);if(t.length!==i.length)return!1;for(i=0;i<t.length;i++){var s=t[i];if(!J2.call(e,s)||!hr(n[s],e[s]))return!1}return!0}function wN(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function SN(n,e){var t=wN(n);n=0;for(var i;t;){if(t.nodeType===3){if(i=n+t.textContent.length,n<=e&&i>=e)return{node:t,offset:e-n};n=i}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=wN(t)}}function T3(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?T3(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function D3(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var e=rb(n.document);e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=rb(n.document)}return e}function ZE(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}var nB=fl&&"documentMode"in document&&11>=document.documentMode,Ud=null,aS=null,hm=null,oS=!1;function AN(n,e,t){var i=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;oS||Ud==null||Ud!==rb(i)||(i=Ud,"selectionStart"in i&&ZE(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),hm&&Nm(hm,i)||(hm=i,i=Ab(aS,"onSelect"),0<i.length&&(e=new T1("onSelect","select",null,e,t),n.push({event:e,listeners:i}),e.target=Ud)))}function cu(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var Hd={animationend:cu("Animation","AnimationEnd"),animationiteration:cu("Animation","AnimationIteration"),animationstart:cu("Animation","AnimationStart"),transitionrun:cu("Transition","TransitionRun"),transitionstart:cu("Transition","TransitionStart"),transitioncancel:cu("Transition","TransitionCancel"),transitionend:cu("Transition","TransitionEnd")},zw={},j3={};fl&&(j3=document.createElement("div").style,"AnimationEvent"in window||(delete Hd.animationend.animation,delete Hd.animationiteration.animation,delete Hd.animationstart.animation),"TransitionEvent"in window||delete Hd.transitionend.transition);function Zh(n){if(zw[n])return zw[n];if(!Hd[n])return n;var e=Hd[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in j3)return zw[n]=e[t];return n}var R3=Zh("animationend"),L3=Zh("animationiteration"),M3=Zh("animationstart"),sB=Zh("transitionrun"),rB=Zh("transitionstart"),aB=Zh("transitioncancel"),O3=Zh("transitionend"),I3=new Map,lS="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");lS.push("scrollEnd");function va(n,e){I3.set(n,e),Xh(e,[n])}var ab=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var e=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(e))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},Rr=[],$d=0,QE=0;function R1(){for(var n=$d,e=QE=$d=0;e<n;){var t=Rr[e];Rr[e++]=null;var i=Rr[e];Rr[e++]=null;var s=Rr[e];Rr[e++]=null;var r=Rr[e];if(Rr[e++]=null,i!==null&&s!==null){var a=i.pending;a===null?s.next=s:(s.next=a.next,a.next=s),i.pending=s}r!==0&&P3(t,s,r)}}function L1(n,e,t,i){Rr[$d++]=n,Rr[$d++]=e,Rr[$d++]=t,Rr[$d++]=i,QE|=i,n.lanes|=i,n=n.alternate,n!==null&&(n.lanes|=i)}function JE(n,e,t,i){return L1(n,e,t,i),ob(n)}function Qh(n,e){return L1(n,null,null,e),ob(n)}function P3(n,e,t){n.lanes|=t;var i=n.alternate;i!==null&&(i.lanes|=t);for(var s=!1,r=n.return;r!==null;)r.childLanes|=t,i=r.alternate,i!==null&&(i.childLanes|=t),r.tag===22&&(n=r.stateNode,n===null||n._visibility&1||(s=!0)),n=r,r=r.return;return n.tag===3?(r=n.stateNode,s&&e!==null&&(s=31-lr(t),n=r.hiddenUpdates,i=n[s],i===null?n[s]=[e]:i.push(e),e.lane=t|536870912),r):null}function ob(n){if(50<bm)throw bm=0,TS=null,Error(Ee(185));for(var e=n.return;e!==null;)n=e,e=n.return;return n.tag===3?n.stateNode:null}var qd={};function oB(n,e,t,i){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function nr(n,e,t,i){return new oB(n,e,t,i)}function eC(n){return n=n.prototype,!(!n||!n.isReactComponent)}function al(n,e){var t=n.alternate;return t===null?(t=nr(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&65011712,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t.refCleanup=n.refCleanup,t}function B3(n,e){n.flags&=65011714;var t=n.alternate;return t===null?(n.childLanes=0,n.lanes=e,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,n.type=t.type,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n}function tx(n,e,t,i,s,r){var a=0;if(i=n,typeof n=="function")eC(n)&&(a=1);else if(typeof n=="string")a=d8(n,t,Xa.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case X2:return n=nr(31,t,e,s),n.elementType=X2,n.lanes=r,n;case Id:return Mh(t.children,s,r,e);case n3:a=8,s|=24;break;case G2:return n=nr(12,t,e,s|2),n.elementType=G2,n.lanes=r,n;case Y2:return n=nr(13,t,e,s),n.elementType=Y2,n.lanes=r,n;case W2:return n=nr(19,t,e,s),n.elementType=W2,n.lanes=r,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case il:a=10;break e;case s3:a=9;break e;case zE:a=11;break e;case UE:a=14;break e;case Rl:a=16,i=null;break e}a=29,t=Error(Ee(130,n===null?"null":typeof n,"")),i=null}return e=nr(a,t,e,s),e.elementType=n,e.type=i,e.lanes=r,e}function Mh(n,e,t,i){return n=nr(7,n,i,e),n.lanes=t,n}function Uw(n,e,t){return n=nr(6,n,null,e),n.lanes=t,n}function F3(n){var e=nr(18,null,null,0);return e.stateNode=n,e}function Hw(n,e,t){return e=nr(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}var EN=new WeakMap;function Pr(n,e){if(typeof n=="object"&&n!==null){var t=EN.get(n);return t!==void 0?t:(e={value:n,source:e,stack:sN(e)},EN.set(n,e),e)}return{value:n,source:e,stack:sN(e)}}var Vd=[],Gd=0,lb=null,km=0,Mr=[],Or=0,Kc=null,Ga=1,Ya="";function yo(n,e){Vd[Gd++]=km,Vd[Gd++]=lb,lb=n,km=e}function z3(n,e,t){Mr[Or++]=Ga,Mr[Or++]=Ya,Mr[Or++]=Kc,Kc=n;var i=Ga;n=Ya;var s=32-lr(i)-1;i&=~(1<<s),t+=1;var r=32-lr(e)+s;if(30<r){var a=s-s%5;r=(i&(1<<a)-1).toString(32),i>>=a,s-=a,Ga=1<<32-lr(e)+s|t<<s|i,Ya=r+n}else Ga=1<<r|t<<s|i,Ya=n}function tC(n){n.return!==null&&(yo(n,1),z3(n,1,0))}function iC(n){for(;n===lb;)lb=Vd[--Gd],Vd[Gd]=null,km=Vd[--Gd],Vd[Gd]=null;for(;n===Kc;)Kc=Mr[--Or],Mr[Or]=null,Ya=Mr[--Or],Mr[Or]=null,Ga=Mr[--Or],Mr[Or]=null}function U3(n,e){Mr[Or++]=Ga,Mr[Or++]=Ya,Mr[Or++]=Kc,Ga=e.id,Ya=e.overflow,Kc=n}var Mn=null,gi=null,Rt=!1,Uc=null,Br=!1,cS=Error(Ee(519));function Zc(n){var e=Error(Ee(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Tm(Pr(e,n)),cS}function CN(n){var e=n.stateNode,t=n.type,i=n.memoizedProps;switch(e[Ln]=n,e[Ns]=i,t){case"dialog":At("cancel",e),At("close",e);break;case"iframe":case"object":case"embed":At("load",e);break;case"video":case"audio":for(t=0;t<Lm.length;t++)At(Lm[t],e);break;case"source":At("error",e);break;case"img":case"image":case"link":At("error",e),At("load",e);break;case"details":At("toggle",e);break;case"input":At("invalid",e),y3(e,i.value,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name,!0);break;case"select":At("invalid",e);break;case"textarea":At("invalid",e),x3(e,i.value,i.defaultValue,i.children)}t=i.children,typeof t!="string"&&typeof t!="number"&&typeof t!="bigint"||e.textContent===""+t||i.suppressHydrationWarning===!0||Aj(e.textContent,t)?(i.popover!=null&&(At("beforetoggle",e),At("toggle",e)),i.onScroll!=null&&At("scroll",e),i.onScrollEnd!=null&&At("scrollend",e),i.onClick!=null&&(e.onclick=nl),e=!0):e=!1,e||Zc(n,!0)}function _N(n){for(Mn=n.return;Mn;)switch(Mn.tag){case 5:case 31:case 13:Br=!1;return;case 27:case 3:Br=!0;return;default:Mn=Mn.return}}function ud(n){if(n!==Mn)return!1;if(!Rt)return _N(n),Rt=!0,!1;var e=n.tag,t;if((t=e!==3&&e!==27)&&((t=e===5)&&(t=n.type,t=!(t!=="form"&&t!=="button")||MS(n.type,n.memoizedProps)),t=!t),t&&gi&&Zc(n),_N(n),e===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(Ee(317));gi=dk(n)}else if(e===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(Ee(317));gi=dk(n)}else e===27?(e=gi,su(n.type)?(n=BS,BS=null,gi=n):gi=e):gi=Mn?Hr(n.stateNode.nextSibling):null;return!0}function Fh(){gi=Mn=null,Rt=!1}function $w(){var n=Uc;return n!==null&&(Ss===null?Ss=n:Ss.push.apply(Ss,n),Uc=null),n}function Tm(n){Uc===null?Uc=[n]:Uc.push(n)}var uS=no(null),Jh=null,sl=null;function Ml(n,e,t){di(uS,e._currentValue),e._currentValue=t}function ol(n){n._currentValue=uS.current,bn(uS)}function hS(n,e,t){for(;n!==null;){var i=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),n===t)break;n=n.return}}function dS(n,e,t,i){var s=n.child;for(s!==null&&(s.return=n);s!==null;){var r=s.dependencies;if(r!==null){var a=s.child;r=r.firstContext;e:for(;r!==null;){var o=r;r=s;for(var l=0;l<e.length;l++)if(o.context===e[l]){r.lanes|=t,o=r.alternate,o!==null&&(o.lanes|=t),hS(r.return,t,n),i||(a=null);break e}r=o.next}}else if(s.tag===18){if(a=s.return,a===null)throw Error(Ee(341));a.lanes|=t,r=a.alternate,r!==null&&(r.lanes|=t),hS(a,t,n),a=null}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===n){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}}function og(n,e,t,i){n=null;for(var s=e,r=!1;s!==null;){if(!r){if(s.flags&524288)r=!0;else if(s.flags&262144)break}if(s.tag===10){var a=s.alternate;if(a===null)throw Error(Ee(387));if(a=a.memoizedProps,a!==null){var o=s.type;hr(s.pendingProps.value,a.value)||(n!==null?n.push(o):n=[o])}}else if(s===tb.current){if(a=s.alternate,a===null)throw Error(Ee(387));a.memoizedState.memoizedState!==s.memoizedState.memoizedState&&(n!==null?n.push(Om):n=[Om])}s=s.return}n!==null&&dS(e,n,t,i),e.flags|=262144}function cb(n){for(n=n.firstContext;n!==null;){if(!hr(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function zh(n){Jh=n,sl=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function In(n){return H3(Jh,n)}function Tv(n,e){return Jh===null&&zh(n),H3(n,e)}function H3(n,e){var t=e._currentValue;if(e={context:e,memoizedValue:t,next:null},sl===null){if(n===null)throw Error(Ee(308));sl=e,n.dependencies={lanes:0,firstContext:e},n.flags|=524288}else sl=sl.next=e;return t}var lB=typeof AbortController<"u"?AbortController:function(){var n=[],e=this.signal={aborted:!1,addEventListener:function(t,i){n.push(i)}};this.abort=function(){e.aborted=!0,n.forEach(function(t){return t()})}},cB=ln.unstable_scheduleCallback,uB=ln.unstable_NormalPriority,Ki={$$typeof:il,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function nC(){return{controller:new lB,data:new Map,refCount:0}}function Zy(n){n.refCount--,n.refCount===0&&cB(uB,function(){n.controller.abort()})}var dm=null,fS=0,Up=0,rf=null;function hB(n,e){if(dm===null){var t=dm=[];fS=0,Up=kC(),rf={status:"pending",value:void 0,then:function(i){t.push(i)}}}return fS++,e.then(NN,NN),e}function NN(){if(--fS===0&&dm!==null){rf!==null&&(rf.status="fulfilled");var n=dm;dm=null,Up=0,rf=null;for(var e=0;e<n.length;e++)(0,n[e])()}}function dB(n,e){var t=[],i={status:"pending",value:null,reason:null,then:function(s){t.push(s)}};return n.then(function(){i.status="fulfilled",i.value=e;for(var s=0;s<t.length;s++)(0,t[s])(e)},function(s){for(i.status="rejected",i.reason=s,s=0;s<t.length;s++)(0,t[s])(void 0)}),i}var kN=ot.S;ot.S=function(n,e){ij=ar(),typeof e=="object"&&e!==null&&typeof e.then=="function"&&hB(n,e),kN!==null&&kN(n,e)};var Oh=no(null);function sC(){var n=Oh.current;return n!==null?n:li.pooledCache}function ix(n,e){e===null?di(Oh,Oh.current):di(Oh,e.pool)}function $3(){var n=sC();return n===null?null:{parent:Ki._currentValue,pool:n}}var lg=Error(Ee(460)),rC=Error(Ee(474)),M1=Error(Ee(542)),ub={then:function(){}};function TN(n){return n=n.status,n==="fulfilled"||n==="rejected"}function q3(n,e,t){switch(t=n[t],t===void 0?n.push(e):t!==e&&(e.then(nl,nl),e=t),e.status){case"fulfilled":return e.value;case"rejected":throw n=e.reason,jN(n),n;default:if(typeof e.status=="string")e.then(nl,nl);else{if(n=li,n!==null&&100<n.shellSuspendCounter)throw Error(Ee(482));n=e,n.status="pending",n.then(function(i){if(e.status==="pending"){var s=e;s.status="fulfilled",s.value=i}},function(i){if(e.status==="pending"){var s=e;s.status="rejected",s.reason=i}})}switch(e.status){case"fulfilled":return e.value;case"rejected":throw n=e.reason,jN(n),n}throw Ih=e,lg}}function du(n){try{var e=n._init;return e(n._payload)}catch(t){throw t!==null&&typeof t=="object"&&typeof t.then=="function"?(Ih=t,lg):t}}var Ih=null;function DN(){if(Ih===null)throw Error(Ee(459));var n=Ih;return Ih=null,n}function jN(n){if(n===lg||n===M1)throw Error(Ee(483))}var af=null,Dm=0;function Dv(n){var e=Dm;return Dm+=1,af===null&&(af=[]),q3(af,n,e)}function bg(n,e){e=e.props.ref,n.ref=e!==void 0?e:null}function jv(n,e){throw e.$$typeof===QI?Error(Ee(525)):(n=Object.prototype.toString.call(e),Error(Ee(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n)))}function V3(n){function e(m,v){if(n){var b=m.deletions;b===null?(m.deletions=[v],m.flags|=16):b.push(v)}}function t(m,v){if(!n)return null;for(;v!==null;)e(m,v),v=v.sibling;return null}function i(m){for(var v=new Map;m!==null;)m.key!==null?v.set(m.key,m):v.set(m.index,m),m=m.sibling;return v}function s(m,v){return m=al(m,v),m.index=0,m.sibling=null,m}function r(m,v,b){return m.index=b,n?(b=m.alternate,b!==null?(b=b.index,b<v?(m.flags|=67108866,v):b):(m.flags|=67108866,v)):(m.flags|=1048576,v)}function a(m){return n&&m.alternate===null&&(m.flags|=67108866),m}function o(m,v,b,A){return v===null||v.tag!==6?(v=Uw(b,m.mode,A),v.return=m,v):(v=s(v,b),v.return=m,v)}function l(m,v,b,A){var S=b.type;return S===Id?d(m,v,b.props.children,A,b.key):v!==null&&(v.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Rl&&du(S)===v.type)?(v=s(v,b.props),bg(v,b),v.return=m,v):(v=tx(b.type,b.key,b.props,null,m.mode,A),bg(v,b),v.return=m,v)}function u(m,v,b,A){return v===null||v.tag!==4||v.stateNode.containerInfo!==b.containerInfo||v.stateNode.implementation!==b.implementation?(v=Hw(b,m.mode,A),v.return=m,v):(v=s(v,b.children||[]),v.return=m,v)}function d(m,v,b,A,S){return v===null||v.tag!==7?(v=Mh(b,m.mode,A,S),v.return=m,v):(v=s(v,b),v.return=m,v)}function f(m,v,b){if(typeof v=="string"&&v!==""||typeof v=="number"||typeof v=="bigint")return v=Uw(""+v,m.mode,b),v.return=m,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Av:return b=tx(v.type,v.key,v.props,null,m.mode,b),bg(b,v),b.return=m,b;case Mg:return v=Hw(v,m.mode,b),v.return=m,v;case Rl:return v=du(v),f(m,v,b)}if(Og(v)||yg(v))return v=Mh(v,m.mode,b,null),v.return=m,v;if(typeof v.then=="function")return f(m,Dv(v),b);if(v.$$typeof===il)return f(m,Tv(m,v),b);jv(m,v)}return null}function p(m,v,b,A){var S=v!==null?v.key:null;if(typeof b=="string"&&b!==""||typeof b=="number"||typeof b=="bigint")return S!==null?null:o(m,v,""+b,A);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Av:return b.key===S?l(m,v,b,A):null;case Mg:return b.key===S?u(m,v,b,A):null;case Rl:return b=du(b),p(m,v,b,A)}if(Og(b)||yg(b))return S!==null?null:d(m,v,b,A,null);if(typeof b.then=="function")return p(m,v,Dv(b),A);if(b.$$typeof===il)return p(m,v,Tv(m,b),A);jv(m,b)}return null}function g(m,v,b,A,S){if(typeof A=="string"&&A!==""||typeof A=="number"||typeof A=="bigint")return m=m.get(b)||null,o(v,m,""+A,S);if(typeof A=="object"&&A!==null){switch(A.$$typeof){case Av:return m=m.get(A.key===null?b:A.key)||null,l(v,m,A,S);case Mg:return m=m.get(A.key===null?b:A.key)||null,u(v,m,A,S);case Rl:return A=du(A),g(m,v,b,A,S)}if(Og(A)||yg(A))return m=m.get(b)||null,d(v,m,A,S,null);if(typeof A.then=="function")return g(m,v,b,Dv(A),S);if(A.$$typeof===il)return g(m,v,b,Tv(v,A),S);jv(v,A)}return null}function x(m,v,b,A){for(var S=null,C=null,k=v,L=v=0,D=null;k!==null&&L<b.length;L++){k.index>L?(D=k,k=null):D=k.sibling;var j=p(m,k,b[L],A);if(j===null){k===null&&(k=D);break}n&&k&&j.alternate===null&&e(m,k),v=r(j,v,L),C===null?S=j:C.sibling=j,C=j,k=D}if(L===b.length)return t(m,k),Rt&&yo(m,L),S;if(k===null){for(;L<b.length;L++)k=f(m,b[L],A),k!==null&&(v=r(k,v,L),C===null?S=k:C.sibling=k,C=k);return Rt&&yo(m,L),S}for(k=i(k);L<b.length;L++)D=g(k,m,L,b[L],A),D!==null&&(n&&D.alternate!==null&&k.delete(D.key===null?L:D.key),v=r(D,v,L),C===null?S=D:C.sibling=D,C=D);return n&&k.forEach(function(P){return e(m,P)}),Rt&&yo(m,L),S}function w(m,v,b,A){if(b==null)throw Error(Ee(151));for(var S=null,C=null,k=v,L=v=0,D=null,j=b.next();k!==null&&!j.done;L++,j=b.next()){k.index>L?(D=k,k=null):D=k.sibling;var P=p(m,k,j.value,A);if(P===null){k===null&&(k=D);break}n&&k&&P.alternate===null&&e(m,k),v=r(P,v,L),C===null?S=P:C.sibling=P,C=P,k=D}if(j.done)return t(m,k),Rt&&yo(m,L),S;if(k===null){for(;!j.done;L++,j=b.next())j=f(m,j.value,A),j!==null&&(v=r(j,v,L),C===null?S=j:C.sibling=j,C=j);return Rt&&yo(m,L),S}for(k=i(k);!j.done;L++,j=b.next())j=g(k,m,L,j.value,A),j!==null&&(n&&j.alternate!==null&&k.delete(j.key===null?L:j.key),v=r(j,v,L),C===null?S=j:C.sibling=j,C=j);return n&&k.forEach(function(H){return e(m,H)}),Rt&&yo(m,L),S}function y(m,v,b,A){if(typeof b=="object"&&b!==null&&b.type===Id&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case Av:e:{for(var S=b.key;v!==null;){if(v.key===S){if(S=b.type,S===Id){if(v.tag===7){t(m,v.sibling),A=s(v,b.props.children),A.return=m,m=A;break e}}else if(v.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Rl&&du(S)===v.type){t(m,v.sibling),A=s(v,b.props),bg(A,b),A.return=m,m=A;break e}t(m,v);break}else e(m,v);v=v.sibling}b.type===Id?(A=Mh(b.props.children,m.mode,A,b.key),A.return=m,m=A):(A=tx(b.type,b.key,b.props,null,m.mode,A),bg(A,b),A.return=m,m=A)}return a(m);case Mg:e:{for(S=b.key;v!==null;){if(v.key===S)if(v.tag===4&&v.stateNode.containerInfo===b.containerInfo&&v.stateNode.implementation===b.implementation){t(m,v.sibling),A=s(v,b.children||[]),A.return=m,m=A;break e}else{t(m,v);break}else e(m,v);v=v.sibling}A=Hw(b,m.mode,A),A.return=m,m=A}return a(m);case Rl:return b=du(b),y(m,v,b,A)}if(Og(b))return x(m,v,b,A);if(yg(b)){if(S=yg(b),typeof S!="function")throw Error(Ee(150));return b=S.call(b),w(m,v,b,A)}if(typeof b.then=="function")return y(m,v,Dv(b),A);if(b.$$typeof===il)return y(m,v,Tv(m,b),A);jv(m,b)}return typeof b=="string"&&b!==""||typeof b=="number"||typeof b=="bigint"?(b=""+b,v!==null&&v.tag===6?(t(m,v.sibling),A=s(v,b),A.return=m,m=A):(t(m,v),A=Uw(b,m.mode,A),A.return=m,m=A),a(m)):t(m,v)}return function(m,v,b,A){try{Dm=0;var S=y(m,v,b,A);return af=null,S}catch(k){if(k===lg||k===M1)throw k;var C=nr(29,k,null,m.mode);return C.lanes=A,C.return=m,C}finally{}}}var Uh=V3(!0),G3=V3(!1),Ll=!1;function aC(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function pS(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function Hc(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function $c(n,e,t){var i=n.updateQueue;if(i===null)return null;if(i=i.shared,Ft&2){var s=i.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),i.pending=e,e=ob(n),P3(n,null,t),e}return L1(n,i,e,t),ob(n)}function fm(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194048)!==0)){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,u3(n,t)}}function qw(n,e){var t=n.updateQueue,i=n.alternate;if(i!==null&&(i=i.updateQueue,t===i)){var s=null,r=null;if(t=t.firstBaseUpdate,t!==null){do{var a={lane:t.lane,tag:t.tag,payload:t.payload,callback:null,next:null};r===null?s=r=a:r=r.next=a,t=t.next}while(t!==null);r===null?s=r=e:r=r.next=e}else s=r=e;t={baseState:i.baseState,firstBaseUpdate:s,lastBaseUpdate:r,shared:i.shared,callbacks:i.callbacks},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}var gS=!1;function pm(){if(gS){var n=rf;if(n!==null)throw n}}function gm(n,e,t,i){gS=!1;var s=n.updateQueue;Ll=!1;var r=s.firstBaseUpdate,a=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var l=o,u=l.next;l.next=null,a===null?r=u:a.next=u,a=l;var d=n.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==a&&(o===null?d.firstBaseUpdate=u:o.next=u,d.lastBaseUpdate=l))}if(r!==null){var f=s.baseState;a=0,d=u=l=null,o=r;do{var p=o.lane&-536870913,g=p!==o.lane;if(g?(_t&p)===p:(i&p)===p){p!==0&&p===Up&&(gS=!0),d!==null&&(d=d.next={lane:0,tag:o.tag,payload:o.payload,callback:null,next:null});e:{var x=n,w=o;p=e;var y=t;switch(w.tag){case 1:if(x=w.payload,typeof x=="function"){f=x.call(y,f,p);break e}f=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=w.payload,p=typeof x=="function"?x.call(y,f,p):x,p==null)break e;f=yi({},f,p);break e;case 2:Ll=!0}}p=o.callback,p!==null&&(n.flags|=64,g&&(n.flags|=8192),g=s.callbacks,g===null?s.callbacks=[p]:g.push(p))}else g={lane:p,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(u=d=g,l=f):d=d.next=g,a|=p;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;g=o,o=g.next,g.next=null,s.lastBaseUpdate=g,s.shared.pending=null}}while(!0);d===null&&(l=f),s.baseState=l,s.firstBaseUpdate=u,s.lastBaseUpdate=d,r===null&&(s.shared.lanes=0),Jc|=a,n.lanes=a,n.memoizedState=f}}function Y3(n,e){if(typeof n!="function")throw Error(Ee(191,n));n.call(e)}function W3(n,e){var t=n.callbacks;if(t!==null)for(n.callbacks=null,n=0;n<t.length;n++)Y3(t[n],e)}var Hp=no(null),hb=no(0);function RN(n,e){n=yl,di(hb,n),di(Hp,e),yl=n|e.baseLanes}function mS(){di(hb,yl),di(Hp,Hp.current)}function oC(){yl=hb.current,bn(Hp),bn(hb)}var dr=no(null),Ur=null;function Ol(n){var e=n.alternate;di(Hi,Hi.current&1),di(dr,n),Ur===null&&(e===null||Hp.current!==null||e.memoizedState!==null)&&(Ur=n)}function yS(n){di(Hi,Hi.current),di(dr,n),Ur===null&&(Ur=n)}function X3(n){n.tag===22?(di(Hi,Hi.current),di(dr,n),Ur===null&&(Ur=n)):Il()}function Il(){di(Hi,Hi.current),di(dr,dr.current)}function tr(n){bn(dr),Ur===n&&(Ur=null),bn(Hi)}var Hi=no(0);function db(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||IS(t)||PS(t)))return e}else if(e.tag===19&&(e.memoizedProps.revealOrder==="forwards"||e.memoizedProps.revealOrder==="backwards"||e.memoizedProps.revealOrder==="unstable_legacy-backwards"||e.memoizedProps.revealOrder==="together")){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var pl=0,mt=null,ni=null,Wi=null,fb=!1,of=!1,Hh=!1,pb=0,jm=0,lf=null,fB=0;function ki(){throw Error(Ee(321))}function lC(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!hr(n[t],e[t]))return!1;return!0}function cC(n,e,t,i,s,r){return pl=r,mt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ot.H=n===null||n.memoizedState===null?_5:bC,Hh=!1,r=t(i,s),Hh=!1,of&&(r=Z3(e,t,i,s)),K3(n),r}function K3(n){ot.H=Rm;var e=ni!==null&&ni.next!==null;if(pl=0,Wi=ni=mt=null,fb=!1,jm=0,lf=null,e)throw Error(Ee(300));n===null||Zi||(n=n.dependencies,n!==null&&cb(n)&&(Zi=!0))}function Z3(n,e,t,i){mt=n;var s=0;do{if(of&&(lf=null),jm=0,of=!1,25<=s)throw Error(Ee(301));if(s+=1,Wi=ni=null,n.updateQueue!=null){var r=n.updateQueue;r.lastEffect=null,r.events=null,r.stores=null,r.memoCache!=null&&(r.memoCache.index=0)}ot.H=N5,r=e(t,i)}while(of);return r}function pB(){var n=ot.H,e=n.useState()[0];return e=typeof e.then=="function"?Qy(e):e,n=n.useState()[0],(ni!==null?ni.memoizedState:null)!==n&&(mt.flags|=1024),e}function uC(){var n=pb!==0;return pb=0,n}function hC(n,e,t){e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~t}function dC(n){if(fb){for(n=n.memoizedState;n!==null;){var e=n.queue;e!==null&&(e.pending=null),n=n.next}fb=!1}pl=0,Wi=ni=mt=null,of=!1,jm=pb=0,lf=null}function ts(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Wi===null?mt.memoizedState=Wi=n:Wi=Wi.next=n,Wi}function $i(){if(ni===null){var n=mt.alternate;n=n!==null?n.memoizedState:null}else n=ni.next;var e=Wi===null?mt.memoizedState:Wi.next;if(e!==null)Wi=e,ni=n;else{if(n===null)throw mt.alternate===null?Error(Ee(467)):Error(Ee(310));ni=n,n={memoizedState:ni.memoizedState,baseState:ni.baseState,baseQueue:ni.baseQueue,queue:ni.queue,next:null},Wi===null?mt.memoizedState=Wi=n:Wi=Wi.next=n}return Wi}function O1(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Qy(n){var e=jm;return jm+=1,lf===null&&(lf=[]),n=q3(lf,n,e),e=mt,(Wi===null?e.memoizedState:Wi.next)===null&&(e=e.alternate,ot.H=e===null||e.memoizedState===null?_5:bC),n}function I1(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return Qy(n);if(n.$$typeof===il)return In(n)}throw Error(Ee(438,String(n)))}function fC(n){var e=null,t=mt.updateQueue;if(t!==null&&(e=t.memoCache),e==null){var i=mt.alternate;i!==null&&(i=i.updateQueue,i!==null&&(i=i.memoCache,i!=null&&(e={data:i.data.map(function(s){return s.slice()}),index:0})))}if(e==null&&(e={data:[],index:0}),t===null&&(t=O1(),mt.updateQueue=t),t.memoCache=e,t=e.data[e.index],t===void 0)for(t=e.data[e.index]=Array(n),i=0;i<n;i++)t[i]=JI;return e.index++,t}function gl(n,e){return typeof e=="function"?e(n):e}function nx(n){var e=$i();return pC(e,ni,n)}function pC(n,e,t){var i=n.queue;if(i===null)throw Error(Ee(311));i.lastRenderedReducer=t;var s=n.baseQueue,r=i.pending;if(r!==null){if(s!==null){var a=s.next;s.next=r.next,r.next=a}e.baseQueue=s=r,i.pending=null}if(r=n.baseState,s===null)n.memoizedState=r;else{e=s.next;var o=a=null,l=null,u=e,d=!1;do{var f=u.lane&-536870913;if(f!==u.lane?(_t&f)===f:(pl&f)===f){var p=u.revertLane;if(p===0)l!==null&&(l=l.next={lane:0,revertLane:0,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),f===Up&&(d=!0);else if((pl&p)===p){u=u.next,p===Up&&(d=!0);continue}else f={lane:0,revertLane:u.revertLane,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},l===null?(o=l=f,a=r):l=l.next=f,mt.lanes|=p,Jc|=p;f=u.action,Hh&&t(r,f),r=u.hasEagerState?u.eagerState:t(r,f)}else p={lane:f,revertLane:u.revertLane,gesture:u.gesture,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},l===null?(o=l=p,a=r):l=l.next=p,mt.lanes|=f,Jc|=f;u=u.next}while(u!==null&&u!==e);if(l===null?a=r:l.next=o,!hr(r,n.memoizedState)&&(Zi=!0,d&&(t=rf,t!==null)))throw t;n.memoizedState=r,n.baseState=a,n.baseQueue=l,i.lastRenderedState=r}return s===null&&(i.lanes=0),[n.memoizedState,i.dispatch]}function Vw(n){var e=$i(),t=e.queue;if(t===null)throw Error(Ee(311));t.lastRenderedReducer=n;var i=t.dispatch,s=t.pending,r=e.memoizedState;if(s!==null){t.pending=null;var a=s=s.next;do r=n(r,a.action),a=a.next;while(a!==s);hr(r,e.memoizedState)||(Zi=!0),e.memoizedState=r,e.baseQueue===null&&(e.baseState=r),t.lastRenderedState=r}return[r,i]}function Q3(n,e,t){var i=mt,s=$i(),r=Rt;if(r){if(t===void 0)throw Error(Ee(407));t=t()}else t=e();var a=!hr((ni||s).memoizedState,t);if(a&&(s.memoizedState=t,Zi=!0),s=s.queue,gC(t5.bind(null,i,s,n),[n]),s.getSnapshot!==e||a||Wi!==null&&Wi.memoizedState.tag&1){if(i.flags|=2048,$p(9,{destroy:void 0},e5.bind(null,i,s,t,e),null),li===null)throw Error(Ee(349));r||pl&127||J3(i,e,t)}return t}function J3(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=mt.updateQueue,e===null?(e=O1(),mt.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function e5(n,e,t,i){e.value=t,e.getSnapshot=i,i5(e)&&n5(n)}function t5(n,e,t){return t(function(){i5(e)&&n5(n)})}function i5(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!hr(n,t)}catch{return!0}}function n5(n){var e=Qh(n,2);e!==null&&Cs(e,n,2)}function vS(n){var e=ts();if(typeof n=="function"){var t=n;if(n=t(),Hh){Lc(!0);try{t()}finally{Lc(!1)}}}return e.memoizedState=e.baseState=n,e.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:gl,lastRenderedState:n},e}function s5(n,e,t,i){return n.baseState=t,pC(n,ni,typeof i=="function"?i:gl)}function gB(n,e,t,i,s){if(B1(n))throw Error(Ee(485));if(n=e.action,n!==null){var r={payload:s,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(a){r.listeners.push(a)}};ot.T!==null?t(!0):r.isTransition=!1,i(r),t=e.pending,t===null?(r.next=e.pending=r,r5(e,r)):(r.next=t.next,e.pending=t.next=r)}}function r5(n,e){var t=e.action,i=e.payload,s=n.state;if(e.isTransition){var r=ot.T,a={};ot.T=a;try{var o=t(s,i),l=ot.S;l!==null&&l(a,o),LN(n,e,o)}catch(u){xS(n,e,u)}finally{r!==null&&a.types!==null&&(r.types=a.types),ot.T=r}}else try{r=t(s,i),LN(n,e,r)}catch(u){xS(n,e,u)}}function LN(n,e,t){t!==null&&typeof t=="object"&&typeof t.then=="function"?t.then(function(i){MN(n,e,i)},function(i){return xS(n,e,i)}):MN(n,e,t)}function MN(n,e,t){e.status="fulfilled",e.value=t,a5(e),n.state=t,e=n.pending,e!==null&&(t=e.next,t===e?n.pending=null:(t=t.next,e.next=t,r5(n,t)))}function xS(n,e,t){var i=n.pending;if(n.pending=null,i!==null){i=i.next;do e.status="rejected",e.reason=t,a5(e),e=e.next;while(e!==i)}n.action=null}function a5(n){n=n.listeners;for(var e=0;e<n.length;e++)(0,n[e])()}function o5(n,e){return e}function ON(n,e){if(Rt){var t=li.formState;if(t!==null){e:{var i=mt;if(Rt){if(gi){t:{for(var s=gi,r=Br;s.nodeType!==8;){if(!r){s=null;break t}if(s=Hr(s.nextSibling),s===null){s=null;break t}}r=s.data,s=r==="F!"||r==="F"?s:null}if(s){gi=Hr(s.nextSibling),i=s.data==="F!";break e}}Zc(i)}i=!1}i&&(e=t[0])}}return t=ts(),t.memoizedState=t.baseState=e,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:o5,lastRenderedState:e},t.queue=i,t=A5.bind(null,mt,i),i.dispatch=t,i=vS(!1),r=xC.bind(null,mt,!1,i.queue),i=ts(),s={state:e,dispatch:null,action:n,pending:null},i.queue=s,t=gB.bind(null,mt,s,r,t),s.dispatch=t,i.memoizedState=n,[e,t,!1]}function IN(n){var e=$i();return l5(e,ni,n)}function l5(n,e,t){if(e=pC(n,e,o5)[0],n=nx(gl)[0],typeof e=="object"&&e!==null&&typeof e.then=="function")try{var i=Qy(e)}catch(a){throw a===lg?M1:a}else i=e;e=$i();var s=e.queue,r=s.dispatch;return t!==e.memoizedState&&(mt.flags|=2048,$p(9,{destroy:void 0},mB.bind(null,s,t),null)),[i,r,n]}function mB(n,e){n.action=e}function PN(n){var e=$i(),t=ni;if(t!==null)return l5(e,t,n);$i(),e=e.memoizedState,t=$i();var i=t.queue.dispatch;return t.memoizedState=n,[e,i,!1]}function $p(n,e,t,i){return n={tag:n,create:t,deps:i,inst:e,next:null},e=mt.updateQueue,e===null&&(e=O1(),mt.updateQueue=e),t=e.lastEffect,t===null?e.lastEffect=n.next=n:(i=t.next,t.next=n,n.next=i,e.lastEffect=n),n}function c5(){return $i().memoizedState}function sx(n,e,t,i){var s=ts();mt.flags|=n,s.memoizedState=$p(1|e,{destroy:void 0},t,i===void 0?null:i)}function P1(n,e,t,i){var s=$i();i=i===void 0?null:i;var r=s.memoizedState.inst;ni!==null&&i!==null&&lC(i,ni.memoizedState.deps)?s.memoizedState=$p(e,r,t,i):(mt.flags|=n,s.memoizedState=$p(1|e,r,t,i))}function BN(n,e){sx(8390656,8,n,e)}function gC(n,e){P1(2048,8,n,e)}function yB(n){mt.flags|=4;var e=mt.updateQueue;if(e===null)e=O1(),mt.updateQueue=e,e.events=[n];else{var t=e.events;t===null?e.events=[n]:t.push(n)}}function u5(n){var e=$i().memoizedState;return yB({ref:e,nextImpl:n}),function(){if(Ft&2)throw Error(Ee(440));return e.impl.apply(void 0,arguments)}}function h5(n,e){return P1(4,2,n,e)}function d5(n,e){return P1(4,4,n,e)}function f5(n,e){if(typeof e=="function"){n=n();var t=e(n);return function(){typeof t=="function"?t():e(null)}}if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function p5(n,e,t){t=t!=null?t.concat([n]):null,P1(4,4,f5.bind(null,e,n),t)}function mC(){}function g5(n,e){var t=$i();e=e===void 0?null:e;var i=t.memoizedState;return e!==null&&lC(e,i[1])?i[0]:(t.memoizedState=[n,e],n)}function m5(n,e){var t=$i();e=e===void 0?null:e;var i=t.memoizedState;if(e!==null&&lC(e,i[1]))return i[0];if(i=n(),Hh){Lc(!0);try{n()}finally{Lc(!1)}}return t.memoizedState=[i,e],i}function yC(n,e,t){return t===void 0||pl&1073741824&&!(_t&261930)?n.memoizedState=e:(n.memoizedState=t,n=sj(),mt.lanes|=n,Jc|=n,t)}function y5(n,e,t,i){return hr(t,e)?t:Hp.current!==null?(n=yC(n,t,i),hr(n,e)||(Zi=!0),n):!(pl&42)||pl&1073741824&&!(_t&261930)?(Zi=!0,n.memoizedState=t):(n=sj(),mt.lanes|=n,Jc|=n,e)}function v5(n,e,t,i,s){var r=Ut.p;Ut.p=r!==0&&8>r?r:8;var a=ot.T,o={};ot.T=o,xC(n,!1,e,t);try{var l=s(),u=ot.S;if(u!==null&&u(o,l),l!==null&&typeof l=="object"&&typeof l.then=="function"){var d=dB(l,i);mm(n,e,d,cr(n))}else mm(n,e,i,cr(n))}catch(f){mm(n,e,{then:function(){},status:"rejected",reason:f},cr())}finally{Ut.p=r,a!==null&&o.types!==null&&(a.types=o.types),ot.T=a}}function vB(){}function bS(n,e,t,i){if(n.tag!==5)throw Error(Ee(476));var s=x5(n).queue;v5(n,s,e,Lh,t===null?vB:function(){return b5(n),t(i)})}function x5(n){var e=n.memoizedState;if(e!==null)return e;e={memoizedState:Lh,baseState:Lh,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:gl,lastRenderedState:Lh},next:null};var t={};return e.next={memoizedState:t,baseState:t,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:gl,lastRenderedState:t},next:null},n.memoizedState=e,n=n.alternate,n!==null&&(n.memoizedState=e),e}function b5(n){var e=x5(n);e.next===null&&(e=n.alternate.memoizedState),mm(n,e.next.queue,{},cr())}function vC(){return In(Om)}function w5(){return $i().memoizedState}function S5(){return $i().memoizedState}function xB(n){for(var e=n.return;e!==null;){switch(e.tag){case 24:case 3:var t=cr();n=Hc(t);var i=$c(e,n,t);i!==null&&(Cs(i,e,t),fm(i,e,t)),e={cache:nC()},n.payload=e;return}e=e.return}}function bB(n,e,t){var i=cr();t={lane:i,revertLane:0,gesture:null,action:t,hasEagerState:!1,eagerState:null,next:null},B1(n)?E5(e,t):(t=JE(n,e,t,i),t!==null&&(Cs(t,n,i),C5(t,e,i)))}function A5(n,e,t){var i=cr();mm(n,e,t,i)}function mm(n,e,t,i){var s={lane:i,revertLane:0,gesture:null,action:t,hasEagerState:!1,eagerState:null,next:null};if(B1(n))E5(e,s);else{var r=n.alternate;if(n.lanes===0&&(r===null||r.lanes===0)&&(r=e.lastRenderedReducer,r!==null))try{var a=e.lastRenderedState,o=r(a,t);if(s.hasEagerState=!0,s.eagerState=o,hr(o,a))return L1(n,e,s,0),li===null&&R1(),!1}catch{}finally{}if(t=JE(n,e,s,i),t!==null)return Cs(t,n,i),C5(t,e,i),!0}return!1}function xC(n,e,t,i){if(i={lane:2,revertLane:kC(),gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null},B1(n)){if(e)throw Error(Ee(479))}else e=JE(n,t,i,2),e!==null&&Cs(e,n,2)}function B1(n){var e=n.alternate;return n===mt||e!==null&&e===mt}function E5(n,e){of=fb=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function C5(n,e,t){if(t&4194048){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,u3(n,t)}}var Rm={readContext:In,use:I1,useCallback:ki,useContext:ki,useEffect:ki,useImperativeHandle:ki,useLayoutEffect:ki,useInsertionEffect:ki,useMemo:ki,useReducer:ki,useRef:ki,useState:ki,useDebugValue:ki,useDeferredValue:ki,useTransition:ki,useSyncExternalStore:ki,useId:ki,useHostTransitionStatus:ki,useFormState:ki,useActionState:ki,useOptimistic:ki,useMemoCache:ki,useCacheRefresh:ki};Rm.useEffectEvent=ki;var _5={readContext:In,use:I1,useCallback:function(n,e){return ts().memoizedState=[n,e===void 0?null:e],n},useContext:In,useEffect:BN,useImperativeHandle:function(n,e,t){t=t!=null?t.concat([n]):null,sx(4194308,4,f5.bind(null,e,n),t)},useLayoutEffect:function(n,e){return sx(4194308,4,n,e)},useInsertionEffect:function(n,e){sx(4,2,n,e)},useMemo:function(n,e){var t=ts();e=e===void 0?null:e;var i=n();if(Hh){Lc(!0);try{n()}finally{Lc(!1)}}return t.memoizedState=[i,e],i},useReducer:function(n,e,t){var i=ts();if(t!==void 0){var s=t(e);if(Hh){Lc(!0);try{t(e)}finally{Lc(!1)}}}else s=e;return i.memoizedState=i.baseState=s,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:s},i.queue=n,n=n.dispatch=bB.bind(null,mt,n),[i.memoizedState,n]},useRef:function(n){var e=ts();return n={current:n},e.memoizedState=n},useState:function(n){n=vS(n);var e=n.queue,t=A5.bind(null,mt,e);return e.dispatch=t,[n.memoizedState,t]},useDebugValue:mC,useDeferredValue:function(n,e){var t=ts();return yC(t,n,e)},useTransition:function(){var n=vS(!1);return n=v5.bind(null,mt,n.queue,!0,!1),ts().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,e,t){var i=mt,s=ts();if(Rt){if(t===void 0)throw Error(Ee(407));t=t()}else{if(t=e(),li===null)throw Error(Ee(349));_t&127||J3(i,e,t)}s.memoizedState=t;var r={value:t,getSnapshot:e};return s.queue=r,BN(t5.bind(null,i,r,n),[n]),i.flags|=2048,$p(9,{destroy:void 0},e5.bind(null,i,r,t,e),null),t},useId:function(){var n=ts(),e=li.identifierPrefix;if(Rt){var t=Ya,i=Ga;t=(i&~(1<<32-lr(i)-1)).toString(32)+t,e="_"+e+"R_"+t,t=pb++,0<t&&(e+="H"+t.toString(32)),e+="_"}else t=fB++,e="_"+e+"r_"+t.toString(32)+"_";return n.memoizedState=e},useHostTransitionStatus:vC,useFormState:ON,useActionState:ON,useOptimistic:function(n){var e=ts();e.memoizedState=e.baseState=n;var t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return e.queue=t,e=xC.bind(null,mt,!0,t),t.dispatch=e,[n,e]},useMemoCache:fC,useCacheRefresh:function(){return ts().memoizedState=xB.bind(null,mt)},useEffectEvent:function(n){var e=ts(),t={impl:n};return e.memoizedState=t,function(){if(Ft&2)throw Error(Ee(440));return t.impl.apply(void 0,arguments)}}},bC={readContext:In,use:I1,useCallback:g5,useContext:In,useEffect:gC,useImperativeHandle:p5,useInsertionEffect:h5,useLayoutEffect:d5,useMemo:m5,useReducer:nx,useRef:c5,useState:function(){return nx(gl)},useDebugValue:mC,useDeferredValue:function(n,e){var t=$i();return y5(t,ni.memoizedState,n,e)},useTransition:function(){var n=nx(gl)[0],e=$i().memoizedState;return[typeof n=="boolean"?n:Qy(n),e]},useSyncExternalStore:Q3,useId:w5,useHostTransitionStatus:vC,useFormState:IN,useActionState:IN,useOptimistic:function(n,e){var t=$i();return s5(t,ni,n,e)},useMemoCache:fC,useCacheRefresh:S5};bC.useEffectEvent=u5;var N5={readContext:In,use:I1,useCallback:g5,useContext:In,useEffect:gC,useImperativeHandle:p5,useInsertionEffect:h5,useLayoutEffect:d5,useMemo:m5,useReducer:Vw,useRef:c5,useState:function(){return Vw(gl)},useDebugValue:mC,useDeferredValue:function(n,e){var t=$i();return ni===null?yC(t,n,e):y5(t,ni.memoizedState,n,e)},useTransition:function(){var n=Vw(gl)[0],e=$i().memoizedState;return[typeof n=="boolean"?n:Qy(n),e]},useSyncExternalStore:Q3,useId:w5,useHostTransitionStatus:vC,useFormState:PN,useActionState:PN,useOptimistic:function(n,e){var t=$i();return ni!==null?s5(t,ni,n,e):(t.baseState=n,[n,t.queue.dispatch])},useMemoCache:fC,useCacheRefresh:S5};N5.useEffectEvent=u5;function Gw(n,e,t,i){e=n.memoizedState,t=t(i,e),t=t==null?e:yi({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var wS={enqueueSetState:function(n,e,t){n=n._reactInternals;var i=cr(),s=Hc(i);s.payload=e,t!=null&&(s.callback=t),e=$c(n,s,i),e!==null&&(Cs(e,n,i),fm(e,n,i))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var i=cr(),s=Hc(i);s.tag=1,s.payload=e,t!=null&&(s.callback=t),e=$c(n,s,i),e!==null&&(Cs(e,n,i),fm(e,n,i))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=cr(),i=Hc(t);i.tag=2,e!=null&&(i.callback=e),e=$c(n,i,t),e!==null&&(Cs(e,n,t),fm(e,n,t))}};function FN(n,e,t,i,s,r,a){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(i,r,a):e.prototype&&e.prototype.isPureReactComponent?!Nm(t,i)||!Nm(s,r):!0}function zN(n,e,t,i){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,i),e.state!==n&&wS.enqueueReplaceState(e,e.state,null)}function $h(n,e){var t=e;if("ref"in e){t={};for(var i in e)i!=="ref"&&(t[i]=e[i])}if(n=n.defaultProps){t===e&&(t=yi({},t));for(var s in n)t[s]===void 0&&(t[s]=n[s])}return t}function k5(n){ab(n)}function T5(n){console.error(n)}function D5(n){ab(n)}function gb(n,e){try{var t=n.onUncaughtError;t(e.value,{componentStack:e.stack})}catch(i){setTimeout(function(){throw i})}}function UN(n,e,t){try{var i=n.onCaughtError;i(t.value,{componentStack:t.stack,errorBoundary:e.tag===1?e.stateNode:null})}catch(s){setTimeout(function(){throw s})}}function SS(n,e,t){return t=Hc(t),t.tag=3,t.payload={element:null},t.callback=function(){gb(n,e)},t}function j5(n){return n=Hc(n),n.tag=3,n}function R5(n,e,t,i){var s=t.type.getDerivedStateFromError;if(typeof s=="function"){var r=i.value;n.payload=function(){return s(r)},n.callback=function(){UN(e,t,i)}}var a=t.stateNode;a!==null&&typeof a.componentDidCatch=="function"&&(n.callback=function(){UN(e,t,i),typeof s!="function"&&(qc===null?qc=new Set([this]):qc.add(this));var o=i.stack;this.componentDidCatch(i.value,{componentStack:o!==null?o:""})})}function wB(n,e,t,i,s){if(t.flags|=32768,i!==null&&typeof i=="object"&&typeof i.then=="function"){if(e=t.alternate,e!==null&&og(e,t,s,!0),t=dr.current,t!==null){switch(t.tag){case 31:case 13:return Ur===null?bb():t.alternate===null&&Oi===0&&(Oi=3),t.flags&=-257,t.flags|=65536,t.lanes=s,i===ub?t.flags|=16384:(e=t.updateQueue,e===null?t.updateQueue=new Set([i]):e.add(i),n2(n,i,s)),!1;case 22:return t.flags|=65536,i===ub?t.flags|=16384:(e=t.updateQueue,e===null?(e={transitions:null,markerInstances:null,retryQueue:new Set([i])},t.updateQueue=e):(t=e.retryQueue,t===null?e.retryQueue=new Set([i]):t.add(i)),n2(n,i,s)),!1}throw Error(Ee(435,t.tag))}return n2(n,i,s),bb(),!1}if(Rt)return e=dr.current,e!==null?(!(e.flags&65536)&&(e.flags|=256),e.flags|=65536,e.lanes=s,i!==cS&&(n=Error(Ee(422),{cause:i}),Tm(Pr(n,t)))):(i!==cS&&(e=Error(Ee(423),{cause:i}),Tm(Pr(e,t))),n=n.current.alternate,n.flags|=65536,s&=-s,n.lanes|=s,i=Pr(i,t),s=SS(n.stateNode,i,s),qw(n,s),Oi!==4&&(Oi=2)),!1;var r=Error(Ee(520),{cause:i});if(r=Pr(r,t),xm===null?xm=[r]:xm.push(r),Oi!==4&&(Oi=2),e===null)return!0;i=Pr(i,t),t=e;do{switch(t.tag){case 3:return t.flags|=65536,n=s&-s,t.lanes|=n,n=SS(t.stateNode,i,n),qw(t,n),!1;case 1:if(e=t.type,r=t.stateNode,(t.flags&128)===0&&(typeof e.getDerivedStateFromError=="function"||r!==null&&typeof r.componentDidCatch=="function"&&(qc===null||!qc.has(r))))return t.flags|=65536,s&=-s,t.lanes|=s,s=j5(s),R5(s,n,t,i),qw(t,s),!1}t=t.return}while(t!==null);return!1}var wC=Error(Ee(461)),Zi=!1;function Tn(n,e,t,i){e.child=n===null?G3(e,null,t,i):Uh(e,n.child,t,i)}function HN(n,e,t,i,s){t=t.render;var r=e.ref;if("ref"in i){var a={};for(var o in i)o!=="ref"&&(a[o]=i[o])}else a=i;return zh(e),i=cC(n,e,t,a,r,s),o=uC(),n!==null&&!Zi?(hC(n,e,s),ml(n,e,s)):(Rt&&o&&tC(e),e.flags|=1,Tn(n,e,i,s),e.child)}function $N(n,e,t,i,s){if(n===null){var r=t.type;return typeof r=="function"&&!eC(r)&&r.defaultProps===void 0&&t.compare===null?(e.tag=15,e.type=r,L5(n,e,r,i,s)):(n=tx(t.type,null,i,e,e.mode,s),n.ref=e.ref,n.return=e,e.child=n)}if(r=n.child,!SC(n,s)){var a=r.memoizedProps;if(t=t.compare,t=t!==null?t:Nm,t(a,i)&&n.ref===e.ref)return ml(n,e,s)}return e.flags|=1,n=al(r,i),n.ref=e.ref,n.return=e,e.child=n}function L5(n,e,t,i,s){if(n!==null){var r=n.memoizedProps;if(Nm(r,i)&&n.ref===e.ref)if(Zi=!1,e.pendingProps=i=r,SC(n,s))n.flags&131072&&(Zi=!0);else return e.lanes=n.lanes,ml(n,e,s)}return AS(n,e,t,i,s)}function M5(n,e,t,i){var s=i.children,r=n!==null?n.memoizedState:null;if(n===null&&e.stateNode===null&&(e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.mode==="hidden"){if(e.flags&128){if(r=r!==null?r.baseLanes|t:t,n!==null){for(i=e.child=n.child,s=0;i!==null;)s=s|i.lanes|i.childLanes,i=i.sibling;i=s&~r}else i=0,e.child=null;return qN(n,e,r,t,i)}if(t&536870912)e.memoizedState={baseLanes:0,cachePool:null},n!==null&&ix(e,r!==null?r.cachePool:null),r!==null?RN(e,r):mS(),X3(e);else return i=e.lanes=536870912,qN(n,e,r!==null?r.baseLanes|t:t,t,i)}else r!==null?(ix(e,r.cachePool),RN(e,r),Il(),e.memoizedState=null):(n!==null&&ix(e,null),mS(),Il());return Tn(n,e,s,t),e.child}function Pg(n,e){return n!==null&&n.tag===22||e.stateNode!==null||(e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),e.sibling}function qN(n,e,t,i,s){var r=sC();return r=r===null?null:{parent:Ki._currentValue,pool:r},e.memoizedState={baseLanes:t,cachePool:r},n!==null&&ix(e,null),mS(),X3(e),n!==null&&og(n,e,i,!0),e.childLanes=s,null}function rx(n,e){return e=mb({mode:e.mode,children:e.children},n.mode),e.ref=n.ref,n.child=e,e.return=n,e}function VN(n,e,t){return Uh(e,n.child,null,t),n=rx(e,e.pendingProps),n.flags|=2,tr(e),e.memoizedState=null,n}function SB(n,e,t){var i=e.pendingProps,s=(e.flags&128)!==0;if(e.flags&=-129,n===null){if(Rt){if(i.mode==="hidden")return n=rx(e,i),e.lanes=536870912,Pg(null,n);if(yS(e),(n=gi)?(n=_j(n,Br),n=n!==null&&n.data==="&"?n:null,n!==null&&(e.memoizedState={dehydrated:n,treeContext:Kc!==null?{id:Ga,overflow:Ya}:null,retryLane:536870912,hydrationErrors:null},t=F3(n),t.return=e,e.child=t,Mn=e,gi=null)):n=null,n===null)throw Zc(e);return e.lanes=536870912,null}return rx(e,i)}var r=n.memoizedState;if(r!==null){var a=r.dehydrated;if(yS(e),s)if(e.flags&256)e.flags&=-257,e=VN(n,e,t);else if(e.memoizedState!==null)e.child=n.child,e.flags|=128,e=null;else throw Error(Ee(558));else if(Zi||og(n,e,t,!1),s=(t&n.childLanes)!==0,Zi||s){if(i=li,i!==null&&(a=h3(i,t),a!==0&&a!==r.retryLane))throw r.retryLane=a,Qh(n,a),Cs(i,n,a),wC;bb(),e=VN(n,e,t)}else n=r.treeContext,gi=Hr(a.nextSibling),Mn=e,Rt=!0,Uc=null,Br=!1,n!==null&&U3(e,n),e=rx(e,i),e.flags|=4096;return e}return n=al(n.child,{mode:i.mode,children:i.children}),n.ref=e.ref,e.child=n,n.return=e,n}function ax(n,e){var t=e.ref;if(t===null)n!==null&&n.ref!==null&&(e.flags|=4194816);else{if(typeof t!="function"&&typeof t!="object")throw Error(Ee(284));(n===null||n.ref!==t)&&(e.flags|=4194816)}}function AS(n,e,t,i,s){return zh(e),t=cC(n,e,t,i,void 0,s),i=uC(),n!==null&&!Zi?(hC(n,e,s),ml(n,e,s)):(Rt&&i&&tC(e),e.flags|=1,Tn(n,e,t,s),e.child)}function GN(n,e,t,i,s,r){return zh(e),e.updateQueue=null,t=Z3(e,i,t,s),K3(n),i=uC(),n!==null&&!Zi?(hC(n,e,r),ml(n,e,r)):(Rt&&i&&tC(e),e.flags|=1,Tn(n,e,t,r),e.child)}function YN(n,e,t,i,s){if(zh(e),e.stateNode===null){var r=qd,a=t.contextType;typeof a=="object"&&a!==null&&(r=In(a)),r=new t(i,r),e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,r.updater=wS,e.stateNode=r,r._reactInternals=e,r=e.stateNode,r.props=i,r.state=e.memoizedState,r.refs={},aC(e),a=t.contextType,r.context=typeof a=="object"&&a!==null?In(a):qd,r.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(Gw(e,t,a,i),r.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(a=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),a!==r.state&&wS.enqueueReplaceState(r,r.state,null),gm(e,i,r,s),pm(),r.state=e.memoizedState),typeof r.componentDidMount=="function"&&(e.flags|=4194308),i=!0}else if(n===null){r=e.stateNode;var o=e.memoizedProps,l=$h(t,o);r.props=l;var u=r.context,d=t.contextType;a=qd,typeof d=="object"&&d!==null&&(a=In(d));var f=t.getDerivedStateFromProps;d=typeof f=="function"||typeof r.getSnapshotBeforeUpdate=="function",o=e.pendingProps!==o,d||typeof r.UNSAFE_componentWillReceiveProps!="function"&&typeof r.componentWillReceiveProps!="function"||(o||u!==a)&&zN(e,r,i,a),Ll=!1;var p=e.memoizedState;r.state=p,gm(e,i,r,s),pm(),u=e.memoizedState,o||p!==u||Ll?(typeof f=="function"&&(Gw(e,t,f,i),u=e.memoizedState),(l=Ll||FN(e,t,l,i,p,u,a))?(d||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount()),typeof r.componentDidMount=="function"&&(e.flags|=4194308)):(typeof r.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=u),r.props=i,r.state=u,r.context=a,i=l):(typeof r.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{r=e.stateNode,pS(n,e),a=e.memoizedProps,d=$h(t,a),r.props=d,f=e.pendingProps,p=r.context,u=t.contextType,l=qd,typeof u=="object"&&u!==null&&(l=In(u)),o=t.getDerivedStateFromProps,(u=typeof o=="function"||typeof r.getSnapshotBeforeUpdate=="function")||typeof r.UNSAFE_componentWillReceiveProps!="function"&&typeof r.componentWillReceiveProps!="function"||(a!==f||p!==l)&&zN(e,r,i,l),Ll=!1,p=e.memoizedState,r.state=p,gm(e,i,r,s),pm();var g=e.memoizedState;a!==f||p!==g||Ll||n!==null&&n.dependencies!==null&&cb(n.dependencies)?(typeof o=="function"&&(Gw(e,t,o,i),g=e.memoizedState),(d=Ll||FN(e,t,d,i,p,g,l)||n!==null&&n.dependencies!==null&&cb(n.dependencies))?(u||typeof r.UNSAFE_componentWillUpdate!="function"&&typeof r.componentWillUpdate!="function"||(typeof r.componentWillUpdate=="function"&&r.componentWillUpdate(i,g,l),typeof r.UNSAFE_componentWillUpdate=="function"&&r.UNSAFE_componentWillUpdate(i,g,l)),typeof r.componentDidUpdate=="function"&&(e.flags|=4),typeof r.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof r.componentDidUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=4),typeof r.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=g),r.props=i,r.state=g,r.context=l,i=d):(typeof r.componentDidUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=4),typeof r.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=1024),i=!1)}return r=i,ax(n,e),i=(e.flags&128)!==0,r||i?(r=e.stateNode,t=i&&typeof t.getDerivedStateFromError!="function"?null:r.render(),e.flags|=1,n!==null&&i?(e.child=Uh(e,n.child,null,s),e.child=Uh(e,null,t,s)):Tn(n,e,t,s),e.memoizedState=r.state,n=e.child):n=ml(n,e,s),n}function WN(n,e,t,i){return Fh(),e.flags|=256,Tn(n,e,t,i),e.child}var Yw={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Ww(n){return{baseLanes:n,cachePool:$3()}}function Xw(n,e,t){return n=n!==null?n.childLanes&~t:0,e&&(n|=sr),n}function O5(n,e,t){var i=e.pendingProps,s=!1,r=(e.flags&128)!==0,a;if((a=r)||(a=n!==null&&n.memoizedState===null?!1:(Hi.current&2)!==0),a&&(s=!0,e.flags&=-129),a=(e.flags&32)!==0,e.flags&=-33,n===null){if(Rt){if(s?Ol(e):Il(),(n=gi)?(n=_j(n,Br),n=n!==null&&n.data!=="&"?n:null,n!==null&&(e.memoizedState={dehydrated:n,treeContext:Kc!==null?{id:Ga,overflow:Ya}:null,retryLane:536870912,hydrationErrors:null},t=F3(n),t.return=e,e.child=t,Mn=e,gi=null)):n=null,n===null)throw Zc(e);return PS(n)?e.lanes=32:e.lanes=536870912,null}var o=i.children;return i=i.fallback,s?(Il(),s=e.mode,o=mb({mode:"hidden",children:o},s),i=Mh(i,s,t,null),o.return=e,i.return=e,o.sibling=i,e.child=o,i=e.child,i.memoizedState=Ww(t),i.childLanes=Xw(n,a,t),e.memoizedState=Yw,Pg(null,i)):(Ol(e),ES(e,o))}var l=n.memoizedState;if(l!==null&&(o=l.dehydrated,o!==null)){if(r)e.flags&256?(Ol(e),e.flags&=-257,e=Kw(n,e,t)):e.memoizedState!==null?(Il(),e.child=n.child,e.flags|=128,e=null):(Il(),o=i.fallback,s=e.mode,i=mb({mode:"visible",children:i.children},s),o=Mh(o,s,t,null),o.flags|=2,i.return=e,o.return=e,i.sibling=o,e.child=i,Uh(e,n.child,null,t),i=e.child,i.memoizedState=Ww(t),i.childLanes=Xw(n,a,t),e.memoizedState=Yw,e=Pg(null,i));else if(Ol(e),PS(o)){if(a=o.nextSibling&&o.nextSibling.dataset,a)var u=a.dgst;a=u,i=Error(Ee(419)),i.stack="",i.digest=a,Tm({value:i,source:null,stack:null}),e=Kw(n,e,t)}else if(Zi||og(n,e,t,!1),a=(t&n.childLanes)!==0,Zi||a){if(a=li,a!==null&&(i=h3(a,t),i!==0&&i!==l.retryLane))throw l.retryLane=i,Qh(n,i),Cs(a,n,i),wC;IS(o)||bb(),e=Kw(n,e,t)}else IS(o)?(e.flags|=192,e.child=n.child,e=null):(n=l.treeContext,gi=Hr(o.nextSibling),Mn=e,Rt=!0,Uc=null,Br=!1,n!==null&&U3(e,n),e=ES(e,i.children),e.flags|=4096);return e}return s?(Il(),o=i.fallback,s=e.mode,l=n.child,u=l.sibling,i=al(l,{mode:"hidden",children:i.children}),i.subtreeFlags=l.subtreeFlags&65011712,u!==null?o=al(u,o):(o=Mh(o,s,t,null),o.flags|=2),o.return=e,i.return=e,i.sibling=o,e.child=i,Pg(null,i),i=e.child,o=n.child.memoizedState,o===null?o=Ww(t):(s=o.cachePool,s!==null?(l=Ki._currentValue,s=s.parent!==l?{parent:l,pool:l}:s):s=$3(),o={baseLanes:o.baseLanes|t,cachePool:s}),i.memoizedState=o,i.childLanes=Xw(n,a,t),e.memoizedState=Yw,Pg(n.child,i)):(Ol(e),t=n.child,n=t.sibling,t=al(t,{mode:"visible",children:i.children}),t.return=e,t.sibling=null,n!==null&&(a=e.deletions,a===null?(e.deletions=[n],e.flags|=16):a.push(n)),e.child=t,e.memoizedState=null,t)}function ES(n,e){return e=mb({mode:"visible",children:e},n.mode),e.return=n,n.child=e}function mb(n,e){return n=nr(22,n,null,e),n.lanes=0,n}function Kw(n,e,t){return Uh(e,n.child,null,t),n=ES(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function XN(n,e,t){n.lanes|=e;var i=n.alternate;i!==null&&(i.lanes|=e),hS(n.return,e,t)}function Zw(n,e,t,i,s,r){var a=n.memoizedState;a===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:t,tailMode:s,treeForkCount:r}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=i,a.tail=t,a.tailMode=s,a.treeForkCount=r)}function I5(n,e,t){var i=e.pendingProps,s=i.revealOrder,r=i.tail;i=i.children;var a=Hi.current,o=(a&2)!==0;if(o?(a=a&1|2,e.flags|=128):a&=1,di(Hi,a),Tn(n,e,i,t),i=Rt?km:0,!o&&n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&XN(n,t,e);else if(n.tag===19)XN(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(s){case"forwards":for(t=e.child,s=null;t!==null;)n=t.alternate,n!==null&&db(n)===null&&(s=t),t=t.sibling;t=s,t===null?(s=e.child,e.child=null):(s=t.sibling,t.sibling=null),Zw(e,!1,s,t,r,i);break;case"backwards":case"unstable_legacy-backwards":for(t=null,s=e.child,e.child=null;s!==null;){if(n=s.alternate,n!==null&&db(n)===null){e.child=s;break}n=s.sibling,s.sibling=t,t=s,s=n}Zw(e,!0,t,null,r,i);break;case"together":Zw(e,!1,null,null,void 0,i);break;default:e.memoizedState=null}return e.child}function ml(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),Jc|=e.lanes,!(t&e.childLanes))if(n!==null){if(og(n,e,t,!1),(t&e.childLanes)===0)return null}else return null;if(n!==null&&e.child!==n.child)throw Error(Ee(153));if(e.child!==null){for(n=e.child,t=al(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=al(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function SC(n,e){return n.lanes&e?!0:(n=n.dependencies,!!(n!==null&&cb(n)))}function AB(n,e,t){switch(e.tag){case 3:ib(e,e.stateNode.containerInfo),Ml(e,Ki,n.memoizedState.cache),Fh();break;case 27:case 5:Q2(e);break;case 4:ib(e,e.stateNode.containerInfo);break;case 10:Ml(e,e.type,e.memoizedProps.value);break;case 31:if(e.memoizedState!==null)return e.flags|=128,yS(e),null;break;case 13:var i=e.memoizedState;if(i!==null)return i.dehydrated!==null?(Ol(e),e.flags|=128,null):t&e.child.childLanes?O5(n,e,t):(Ol(e),n=ml(n,e,t),n!==null?n.sibling:null);Ol(e);break;case 19:var s=(n.flags&128)!==0;if(i=(t&e.childLanes)!==0,i||(og(n,e,t,!1),i=(t&e.childLanes)!==0),s){if(i)return I5(n,e,t);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),di(Hi,Hi.current),i)break;return null;case 22:return e.lanes=0,M5(n,e,t,e.pendingProps);case 24:Ml(e,Ki,n.memoizedState.cache)}return ml(n,e,t)}function P5(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps)Zi=!0;else{if(!SC(n,t)&&!(e.flags&128))return Zi=!1,AB(n,e,t);Zi=!!(n.flags&131072)}else Zi=!1,Rt&&e.flags&1048576&&z3(e,km,e.index);switch(e.lanes=0,e.tag){case 16:e:{var i=e.pendingProps;if(n=du(e.elementType),e.type=n,typeof n=="function")eC(n)?(i=$h(n,i),e.tag=1,e=YN(null,e,n,i,t)):(e.tag=0,e=AS(null,e,n,i,t));else{if(n!=null){var s=n.$$typeof;if(s===zE){e.tag=11,e=HN(null,e,n,i,t);break e}else if(s===UE){e.tag=14,e=$N(null,e,n,i,t);break e}}throw e=K2(n)||n,Error(Ee(306,e,""))}}return e;case 0:return AS(n,e,e.type,e.pendingProps,t);case 1:return i=e.type,s=$h(i,e.pendingProps),YN(n,e,i,s,t);case 3:e:{if(ib(e,e.stateNode.containerInfo),n===null)throw Error(Ee(387));i=e.pendingProps;var r=e.memoizedState;s=r.element,pS(n,e),gm(e,i,null,t);var a=e.memoizedState;if(i=a.cache,Ml(e,Ki,i),i!==r.cache&&dS(e,[Ki],t,!0),pm(),i=a.element,r.isDehydrated)if(r={element:i,isDehydrated:!1,cache:a.cache},e.updateQueue.baseState=r,e.memoizedState=r,e.flags&256){e=WN(n,e,i,t);break e}else if(i!==s){s=Pr(Error(Ee(424)),e),Tm(s),e=WN(n,e,i,t);break e}else{switch(n=e.stateNode.containerInfo,n.nodeType){case 9:n=n.body;break;default:n=n.nodeName==="HTML"?n.ownerDocument.body:n}for(gi=Hr(n.firstChild),Mn=e,Rt=!0,Uc=null,Br=!0,t=G3(e,null,i,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling}else{if(Fh(),i===s){e=ml(n,e,t);break e}Tn(n,e,i,t)}e=e.child}return e;case 26:return ax(n,e),n===null?(t=gk(e.type,null,e.pendingProps,null))?e.memoizedState=t:Rt||(t=e.type,n=e.pendingProps,i=Eb(zc.current).createElement(t),i[Ln]=e,i[Ns]=n,Pn(i,t,n),xn(i),e.stateNode=i):e.memoizedState=gk(e.type,n.memoizedProps,e.pendingProps,n.memoizedState),null;case 27:return Q2(e),n===null&&Rt&&(i=e.stateNode=Nj(e.type,e.pendingProps,zc.current),Mn=e,Br=!0,s=gi,su(e.type)?(BS=s,gi=Hr(i.firstChild)):gi=s),Tn(n,e,e.pendingProps.children,t),ax(n,e),n===null&&(e.flags|=4194304),e.child;case 5:return n===null&&Rt&&((s=i=gi)&&(i=JB(i,e.type,e.pendingProps,Br),i!==null?(e.stateNode=i,Mn=e,gi=Hr(i.firstChild),Br=!1,s=!0):s=!1),s||Zc(e)),Q2(e),s=e.type,r=e.pendingProps,a=n!==null?n.memoizedProps:null,i=r.children,MS(s,r)?i=null:a!==null&&MS(s,a)&&(e.flags|=32),e.memoizedState!==null&&(s=cC(n,e,pB,null,null,t),Om._currentValue=s),ax(n,e),Tn(n,e,i,t),e.child;case 6:return n===null&&Rt&&((n=t=gi)&&(t=e8(t,e.pendingProps,Br),t!==null?(e.stateNode=t,Mn=e,gi=null,n=!0):n=!1),n||Zc(e)),null;case 13:return O5(n,e,t);case 4:return ib(e,e.stateNode.containerInfo),i=e.pendingProps,n===null?e.child=Uh(e,null,i,t):Tn(n,e,i,t),e.child;case 11:return HN(n,e,e.type,e.pendingProps,t);case 7:return Tn(n,e,e.pendingProps,t),e.child;case 8:return Tn(n,e,e.pendingProps.children,t),e.child;case 12:return Tn(n,e,e.pendingProps.children,t),e.child;case 10:return i=e.pendingProps,Ml(e,e.type,i.value),Tn(n,e,i.children,t),e.child;case 9:return s=e.type._context,i=e.pendingProps.children,zh(e),s=In(s),i=i(s),e.flags|=1,Tn(n,e,i,t),e.child;case 14:return $N(n,e,e.type,e.pendingProps,t);case 15:return L5(n,e,e.type,e.pendingProps,t);case 19:return I5(n,e,t);case 31:return SB(n,e,t);case 22:return M5(n,e,t,e.pendingProps);case 24:return zh(e),i=In(Ki),n===null?(s=sC(),s===null&&(s=li,r=nC(),s.pooledCache=r,r.refCount++,r!==null&&(s.pooledCacheLanes|=t),s=r),e.memoizedState={parent:i,cache:s},aC(e),Ml(e,Ki,s)):(n.lanes&t&&(pS(n,e),gm(e,null,null,t),pm()),s=n.memoizedState,r=e.memoizedState,s.parent!==i?(s={parent:i,cache:i},e.memoizedState=s,e.lanes===0&&(e.memoizedState=e.updateQueue.baseState=s),Ml(e,Ki,i)):(i=r.cache,Ml(e,Ki,i),i!==s.cache&&dS(e,[Ki],t,!0))),Tn(n,e,e.pendingProps.children,t),e.child;case 29:throw e.pendingProps}throw Error(Ee(156,e.tag))}function oo(n){n.flags|=4}function Qw(n,e,t,i,s){if((e=(n.mode&32)!==0)&&(e=!1),e){if(n.flags|=16777216,(s&335544128)===s)if(n.stateNode.complete)n.flags|=8192;else if(oj())n.flags|=8192;else throw Ih=ub,rC}else n.flags&=-16777217}function KN(n,e){if(e.type!=="stylesheet"||e.state.loading&4)n.flags&=-16777217;else if(n.flags|=16777216,!Dj(e))if(oj())n.flags|=8192;else throw Ih=ub,rC}function Rv(n,e){e!==null&&(n.flags|=4),n.flags&16384&&(e=n.tag!==22?l3():536870912,n.lanes|=e,qp|=e)}function wg(n,e){if(!Rt)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var i=null;t!==null;)t.alternate!==null&&(i=t),t=t.sibling;i===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:i.sibling=null}}function fi(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,i=0;if(e)for(var s=n.child;s!==null;)t|=s.lanes|s.childLanes,i|=s.subtreeFlags&65011712,i|=s.flags&65011712,s.return=n,s=s.sibling;else for(s=n.child;s!==null;)t|=s.lanes|s.childLanes,i|=s.subtreeFlags,i|=s.flags,s.return=n,s=s.sibling;return n.subtreeFlags|=i,n.childLanes=t,e}function EB(n,e,t){var i=e.pendingProps;switch(iC(e),e.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return fi(e),null;case 1:return fi(e),null;case 3:return t=e.stateNode,i=null,n!==null&&(i=n.memoizedState.cache),e.memoizedState.cache!==i&&(e.flags|=2048),ol(Ki),Bp(),t.pendingContext&&(t.context=t.pendingContext,t.pendingContext=null),(n===null||n.child===null)&&(ud(e)?oo(e):n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,$w())),fi(e),null;case 26:var s=e.type,r=e.memoizedState;return n===null?(oo(e),r!==null?(fi(e),KN(e,r)):(fi(e),Qw(e,s,null,i,t))):r?r!==n.memoizedState?(oo(e),fi(e),KN(e,r)):(fi(e),e.flags&=-16777217):(n=n.memoizedProps,n!==i&&oo(e),fi(e),Qw(e,s,n,i,t)),null;case 27:if(nb(e),t=zc.current,s=e.type,n!==null&&e.stateNode!=null)n.memoizedProps!==i&&oo(e);else{if(!i){if(e.stateNode===null)throw Error(Ee(166));return fi(e),null}n=Xa.current,ud(e)?CN(e):(n=Nj(s,i,t),e.stateNode=n,oo(e))}return fi(e),null;case 5:if(nb(e),s=e.type,n!==null&&e.stateNode!=null)n.memoizedProps!==i&&oo(e);else{if(!i){if(e.stateNode===null)throw Error(Ee(166));return fi(e),null}if(r=Xa.current,ud(e))CN(e);else{var a=Eb(zc.current);switch(r){case 1:r=a.createElementNS("http://www.w3.org/2000/svg",s);break;case 2:r=a.createElementNS("http://www.w3.org/1998/Math/MathML",s);break;default:switch(s){case"svg":r=a.createElementNS("http://www.w3.org/2000/svg",s);break;case"math":r=a.createElementNS("http://www.w3.org/1998/Math/MathML",s);break;case"script":r=a.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild);break;case"select":r=typeof i.is=="string"?a.createElement("select",{is:i.is}):a.createElement("select"),i.multiple?r.multiple=!0:i.size&&(r.size=i.size);break;default:r=typeof i.is=="string"?a.createElement(s,{is:i.is}):a.createElement(s)}}r[Ln]=e,r[Ns]=i;e:for(a=e.child;a!==null;){if(a.tag===5||a.tag===6)r.appendChild(a.stateNode);else if(a.tag!==4&&a.tag!==27&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===e)break e;for(;a.sibling===null;){if(a.return===null||a.return===e)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}e.stateNode=r;e:switch(Pn(r,s,i),s){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&oo(e)}}return fi(e),Qw(e,e.type,n===null?null:n.memoizedProps,e.pendingProps,t),null;case 6:if(n&&e.stateNode!=null)n.memoizedProps!==i&&oo(e);else{if(typeof i!="string"&&e.stateNode===null)throw Error(Ee(166));if(n=zc.current,ud(e)){if(n=e.stateNode,t=e.memoizedProps,i=null,s=Mn,s!==null)switch(s.tag){case 27:case 5:i=s.memoizedProps}n[Ln]=e,n=!!(n.nodeValue===t||i!==null&&i.suppressHydrationWarning===!0||Aj(n.nodeValue,t)),n||Zc(e,!0)}else n=Eb(n).createTextNode(i),n[Ln]=e,e.stateNode=n}return fi(e),null;case 31:if(t=e.memoizedState,n===null||n.memoizedState!==null){if(i=ud(e),t!==null){if(n===null){if(!i)throw Error(Ee(318));if(n=e.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(Ee(557));n[Ln]=e}else Fh(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;fi(e),n=!1}else t=$w(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=t),n=!0;if(!n)return e.flags&256?(tr(e),e):(tr(e),null);if(e.flags&128)throw Error(Ee(558))}return fi(e),null;case 13:if(i=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(s=ud(e),i!==null&&i.dehydrated!==null){if(n===null){if(!s)throw Error(Ee(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Ee(317));s[Ln]=e}else Fh(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;fi(e),s=!1}else s=$w(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=s),s=!0;if(!s)return e.flags&256?(tr(e),e):(tr(e),null)}return tr(e),e.flags&128?(e.lanes=t,e):(t=i!==null,n=n!==null&&n.memoizedState!==null,t&&(i=e.child,s=null,i.alternate!==null&&i.alternate.memoizedState!==null&&i.alternate.memoizedState.cachePool!==null&&(s=i.alternate.memoizedState.cachePool.pool),r=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(r=i.memoizedState.cachePool.pool),r!==s&&(i.flags|=2048)),t!==n&&t&&(e.child.flags|=8192),Rv(e,e.updateQueue),fi(e),null);case 4:return Bp(),n===null&&TC(e.stateNode.containerInfo),fi(e),null;case 10:return ol(e.type),fi(e),null;case 19:if(bn(Hi),i=e.memoizedState,i===null)return fi(e),null;if(s=(e.flags&128)!==0,r=i.rendering,r===null)if(s)wg(i,!1);else{if(Oi!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(r=db(n),r!==null){for(e.flags|=128,wg(i,!1),n=r.updateQueue,e.updateQueue=n,Rv(e,n),e.subtreeFlags=0,n=t,t=e.child;t!==null;)B3(t,n),t=t.sibling;return di(Hi,Hi.current&1|2),Rt&&yo(e,i.treeForkCount),e.child}n=n.sibling}i.tail!==null&&ar()>vb&&(e.flags|=128,s=!0,wg(i,!1),e.lanes=4194304)}else{if(!s)if(n=db(r),n!==null){if(e.flags|=128,s=!0,n=n.updateQueue,e.updateQueue=n,Rv(e,n),wg(i,!0),i.tail===null&&i.tailMode==="hidden"&&!r.alternate&&!Rt)return fi(e),null}else 2*ar()-i.renderingStartTime>vb&&t!==536870912&&(e.flags|=128,s=!0,wg(i,!1),e.lanes=4194304);i.isBackwards?(r.sibling=e.child,e.child=r):(n=i.last,n!==null?n.sibling=r:e.child=r,i.last=r)}return i.tail!==null?(n=i.tail,i.rendering=n,i.tail=n.sibling,i.renderingStartTime=ar(),n.sibling=null,t=Hi.current,di(Hi,s?t&1|2:t&1),Rt&&yo(e,i.treeForkCount),n):(fi(e),null);case 22:case 23:return tr(e),oC(),i=e.memoizedState!==null,n!==null?n.memoizedState!==null!==i&&(e.flags|=8192):i&&(e.flags|=8192),i?t&536870912&&!(e.flags&128)&&(fi(e),e.subtreeFlags&6&&(e.flags|=8192)):fi(e),t=e.updateQueue,t!==null&&Rv(e,t.retryQueue),t=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(t=n.memoizedState.cachePool.pool),i=null,e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(i=e.memoizedState.cachePool.pool),i!==t&&(e.flags|=2048),n!==null&&bn(Oh),null;case 24:return t=null,n!==null&&(t=n.memoizedState.cache),e.memoizedState.cache!==t&&(e.flags|=2048),ol(Ki),fi(e),null;case 25:return null;case 30:return null}throw Error(Ee(156,e.tag))}function CB(n,e){switch(iC(e),e.tag){case 1:return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return ol(Ki),Bp(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 26:case 27:case 5:return nb(e),null;case 31:if(e.memoizedState!==null){if(tr(e),e.alternate===null)throw Error(Ee(340));Fh()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 13:if(tr(e),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(Ee(340));Fh()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return bn(Hi),null;case 4:return Bp(),null;case 10:return ol(e.type),null;case 22:case 23:return tr(e),oC(),n!==null&&bn(Oh),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 24:return ol(Ki),null;case 25:return null;default:return null}}function B5(n,e){switch(iC(e),e.tag){case 3:ol(Ki),Bp();break;case 26:case 27:case 5:nb(e);break;case 4:Bp();break;case 31:e.memoizedState!==null&&tr(e);break;case 13:tr(e);break;case 19:bn(Hi);break;case 10:ol(e.type);break;case 22:case 23:tr(e),oC(),n!==null&&bn(Oh);break;case 24:ol(Ki)}}function Jy(n,e){try{var t=e.updateQueue,i=t!==null?t.lastEffect:null;if(i!==null){var s=i.next;t=s;do{if((t.tag&n)===n){i=void 0;var r=t.create,a=t.inst;i=r(),a.destroy=i}t=t.next}while(t!==s)}}catch(o){Xt(e,e.return,o)}}function Qc(n,e,t){try{var i=e.updateQueue,s=i!==null?i.lastEffect:null;if(s!==null){var r=s.next;i=r;do{if((i.tag&n)===n){var a=i.inst,o=a.destroy;if(o!==void 0){a.destroy=void 0,s=e;var l=t,u=o;try{u()}catch(d){Xt(s,l,d)}}}i=i.next}while(i!==r)}}catch(d){Xt(e,e.return,d)}}function F5(n){var e=n.updateQueue;if(e!==null){var t=n.stateNode;try{W3(e,t)}catch(i){Xt(n,n.return,i)}}}function z5(n,e,t){t.props=$h(n.type,n.memoizedProps),t.state=n.memoizedState;try{t.componentWillUnmount()}catch(i){Xt(n,e,i)}}function ym(n,e){try{var t=n.ref;if(t!==null){switch(n.tag){case 26:case 27:case 5:var i=n.stateNode;break;case 30:i=n.stateNode;break;default:i=n.stateNode}typeof t=="function"?n.refCleanup=t(i):t.current=i}}catch(s){Xt(n,e,s)}}function Wa(n,e){var t=n.ref,i=n.refCleanup;if(t!==null)if(typeof i=="function")try{i()}catch(s){Xt(n,e,s)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof t=="function")try{t(null)}catch(s){Xt(n,e,s)}else t.current=null}function U5(n){var e=n.type,t=n.memoizedProps,i=n.stateNode;try{e:switch(e){case"button":case"input":case"select":case"textarea":t.autoFocus&&i.focus();break e;case"img":t.src?i.src=t.src:t.srcSet&&(i.srcset=t.srcSet)}}catch(s){Xt(n,n.return,s)}}function Jw(n,e,t){try{var i=n.stateNode;YB(i,n.type,t,e),i[Ns]=e}catch(s){Xt(n,n.return,s)}}function H5(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&su(n.type)||n.tag===4}function e2(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||H5(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&su(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function CS(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t).insertBefore(n,e):(e=t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,e.appendChild(n),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=nl));else if(i!==4&&(i===27&&su(n.type)&&(t=n.stateNode,e=null),n=n.child,n!==null))for(CS(n,e,t),n=n.sibling;n!==null;)CS(n,e,t),n=n.sibling}function yb(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(i!==4&&(i===27&&su(n.type)&&(t=n.stateNode),n=n.child,n!==null))for(yb(n,e,t),n=n.sibling;n!==null;)yb(n,e,t),n=n.sibling}function $5(n){var e=n.stateNode,t=n.memoizedProps;try{for(var i=n.type,s=e.attributes;s.length;)e.removeAttributeNode(s[0]);Pn(e,i,t),e[Ln]=n,e[Ns]=t}catch(r){Xt(n,n.return,r)}}var el=!1,Xi=!1,t2=!1,ZN=typeof WeakSet=="function"?WeakSet:Set,vn=null;function _B(n,e){if(n=n.containerInfo,RS=kb,n=D3(n),ZE(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var i=t.getSelection&&t.getSelection();if(i&&i.rangeCount!==0){t=i.anchorNode;var s=i.anchorOffset,r=i.focusNode;i=i.focusOffset;try{t.nodeType,r.nodeType}catch{t=null;break e}var a=0,o=-1,l=-1,u=0,d=0,f=n,p=null;t:for(;;){for(var g;f!==t||s!==0&&f.nodeType!==3||(o=a+s),f!==r||i!==0&&f.nodeType!==3||(l=a+i),f.nodeType===3&&(a+=f.nodeValue.length),(g=f.firstChild)!==null;)p=f,f=g;for(;;){if(f===n)break t;if(p===t&&++u===s&&(o=a),p===r&&++d===i&&(l=a),(g=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=g}t=o===-1||l===-1?null:{start:o,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(LS={focusedElem:n,selectionRange:t},kb=!1,vn=e;vn!==null;)if(e=vn,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,vn=n;else for(;vn!==null;){switch(e=vn,r=e.alternate,n=e.flags,e.tag){case 0:if(n&4&&(n=e.updateQueue,n=n!==null?n.events:null,n!==null))for(t=0;t<n.length;t++)s=n[t],s.ref.impl=s.nextImpl;break;case 11:case 15:break;case 1:if(n&1024&&r!==null){n=void 0,t=e,s=r.memoizedProps,r=r.memoizedState,i=t.stateNode;try{var x=$h(t.type,s);n=i.getSnapshotBeforeUpdate(x,r),i.__reactInternalSnapshotBeforeUpdate=n}catch(w){Xt(t,t.return,w)}}break;case 3:if(n&1024){if(n=e.stateNode.containerInfo,t=n.nodeType,t===9)OS(n);else if(t===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":OS(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(n&1024)throw Error(Ee(163))}if(n=e.sibling,n!==null){n.return=e.return,vn=n;break}vn=e.return}}function q5(n,e,t){var i=t.flags;switch(t.tag){case 0:case 11:case 15:co(n,t),i&4&&Jy(5,t);break;case 1:if(co(n,t),i&4)if(n=t.stateNode,e===null)try{n.componentDidMount()}catch(a){Xt(t,t.return,a)}else{var s=$h(t.type,e.memoizedProps);e=e.memoizedState;try{n.componentDidUpdate(s,e,n.__reactInternalSnapshotBeforeUpdate)}catch(a){Xt(t,t.return,a)}}i&64&&F5(t),i&512&&ym(t,t.return);break;case 3:if(co(n,t),i&64&&(n=t.updateQueue,n!==null)){if(e=null,t.child!==null)switch(t.child.tag){case 27:case 5:e=t.child.stateNode;break;case 1:e=t.child.stateNode}try{W3(n,e)}catch(a){Xt(t,t.return,a)}}break;case 27:e===null&&i&4&&$5(t);case 26:case 5:co(n,t),e===null&&i&4&&U5(t),i&512&&ym(t,t.return);break;case 12:co(n,t);break;case 31:co(n,t),i&4&&Y5(n,t);break;case 13:co(n,t),i&4&&W5(n,t),i&64&&(n=t.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(t=OB.bind(null,t),t8(n,t))));break;case 22:if(i=t.memoizedState!==null||el,!i){e=e!==null&&e.memoizedState!==null||Xi,s=el;var r=Xi;el=i,(Xi=e)&&!r?uo(n,t,(t.subtreeFlags&8772)!==0):co(n,t),el=s,Xi=r}break;case 30:break;default:co(n,t)}}function V5(n){var e=n.alternate;e!==null&&(n.alternate=null,V5(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&VE(e)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var Si=null,ws=!1;function lo(n,e,t){for(t=t.child;t!==null;)G5(n,e,t),t=t.sibling}function G5(n,e,t){if(or&&typeof or.onCommitFiberUnmount=="function")try{or.onCommitFiberUnmount(Gy,t)}catch{}switch(t.tag){case 26:Xi||Wa(t,e),lo(n,e,t),t.memoizedState?t.memoizedState.count--:t.stateNode&&(t=t.stateNode,t.parentNode.removeChild(t));break;case 27:Xi||Wa(t,e);var i=Si,s=ws;su(t.type)&&(Si=t.stateNode,ws=!1),lo(n,e,t),wm(t.stateNode),Si=i,ws=s;break;case 5:Xi||Wa(t,e);case 6:if(i=Si,s=ws,Si=null,lo(n,e,t),Si=i,ws=s,Si!==null)if(ws)try{(Si.nodeType===9?Si.body:Si.nodeName==="HTML"?Si.ownerDocument.body:Si).removeChild(t.stateNode)}catch(r){Xt(t,e,r)}else try{Si.removeChild(t.stateNode)}catch(r){Xt(t,e,r)}break;case 18:Si!==null&&(ws?(n=Si,uk(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,t.stateNode),Wp(n)):uk(Si,t.stateNode));break;case 4:i=Si,s=ws,Si=t.stateNode.containerInfo,ws=!0,lo(n,e,t),Si=i,ws=s;break;case 0:case 11:case 14:case 15:Qc(2,t,e),Xi||Qc(4,t,e),lo(n,e,t);break;case 1:Xi||(Wa(t,e),i=t.stateNode,typeof i.componentWillUnmount=="function"&&z5(t,e,i)),lo(n,e,t);break;case 21:lo(n,e,t);break;case 22:Xi=(i=Xi)||t.memoizedState!==null,lo(n,e,t),Xi=i;break;default:lo(n,e,t)}}function Y5(n,e){if(e.memoizedState===null&&(n=e.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{Wp(n)}catch(t){Xt(e,e.return,t)}}}function W5(n,e){if(e.memoizedState===null&&(n=e.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{Wp(n)}catch(t){Xt(e,e.return,t)}}function NB(n){switch(n.tag){case 31:case 13:case 19:var e=n.stateNode;return e===null&&(e=n.stateNode=new ZN),e;case 22:return n=n.stateNode,e=n._retryCache,e===null&&(e=n._retryCache=new ZN),e;default:throw Error(Ee(435,n.tag))}}function Lv(n,e){var t=NB(n);e.forEach(function(i){if(!t.has(i)){t.add(i);var s=IB.bind(null,n,i);i.then(s,s)}})}function cs(n,e){var t=e.deletions;if(t!==null)for(var i=0;i<t.length;i++){var s=t[i],r=n,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 27:if(su(o.type)){Si=o.stateNode,ws=!1;break e}break;case 5:Si=o.stateNode,ws=!1;break e;case 3:case 4:Si=o.stateNode.containerInfo,ws=!0;break e}o=o.return}if(Si===null)throw Error(Ee(160));G5(r,a,s),Si=null,ws=!1,r=s.alternate,r!==null&&(r.return=null),s.return=null}if(e.subtreeFlags&13886)for(e=e.child;e!==null;)X5(e,n),e=e.sibling}var da=null;function X5(n,e){var t=n.alternate,i=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:cs(e,n),us(n),i&4&&(Qc(3,n,n.return),Jy(3,n),Qc(5,n,n.return));break;case 1:cs(e,n),us(n),i&512&&(Xi||t===null||Wa(t,t.return)),i&64&&el&&(n=n.updateQueue,n!==null&&(i=n.callbacks,i!==null&&(t=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=t===null?i:t.concat(i))));break;case 26:var s=da;if(cs(e,n),us(n),i&512&&(Xi||t===null||Wa(t,t.return)),i&4){var r=t!==null?t.memoizedState:null;if(i=n.memoizedState,t===null)if(i===null)if(n.stateNode===null){e:{i=n.type,t=n.memoizedProps,s=s.ownerDocument||s;t:switch(i){case"title":r=s.getElementsByTagName("title")[0],(!r||r[Xy]||r[Ln]||r.namespaceURI==="http://www.w3.org/2000/svg"||r.hasAttribute("itemprop"))&&(r=s.createElement(i),s.head.insertBefore(r,s.querySelector("head > title"))),Pn(r,i,t),r[Ln]=n,xn(r),i=r;break e;case"link":var a=yk("link","href",s).get(i+(t.href||""));if(a){for(var o=0;o<a.length;o++)if(r=a[o],r.getAttribute("href")===(t.href==null||t.href===""?null:t.href)&&r.getAttribute("rel")===(t.rel==null?null:t.rel)&&r.getAttribute("title")===(t.title==null?null:t.title)&&r.getAttribute("crossorigin")===(t.crossOrigin==null?null:t.crossOrigin)){a.splice(o,1);break t}}r=s.createElement(i),Pn(r,i,t),s.head.appendChild(r);break;case"meta":if(a=yk("meta","content",s).get(i+(t.content||""))){for(o=0;o<a.length;o++)if(r=a[o],r.getAttribute("content")===(t.content==null?null:""+t.content)&&r.getAttribute("name")===(t.name==null?null:t.name)&&r.getAttribute("property")===(t.property==null?null:t.property)&&r.getAttribute("http-equiv")===(t.httpEquiv==null?null:t.httpEquiv)&&r.getAttribute("charset")===(t.charSet==null?null:t.charSet)){a.splice(o,1);break t}}r=s.createElement(i),Pn(r,i,t),s.head.appendChild(r);break;default:throw Error(Ee(468,i))}r[Ln]=n,xn(r),i=r}n.stateNode=i}else vk(s,n.type,n.stateNode);else n.stateNode=mk(s,i,n.memoizedProps);else r!==i?(r===null?t.stateNode!==null&&(t=t.stateNode,t.parentNode.removeChild(t)):r.count--,i===null?vk(s,n.type,n.stateNode):mk(s,i,n.memoizedProps)):i===null&&n.stateNode!==null&&Jw(n,n.memoizedProps,t.memoizedProps)}break;case 27:cs(e,n),us(n),i&512&&(Xi||t===null||Wa(t,t.return)),t!==null&&i&4&&Jw(n,n.memoizedProps,t.memoizedProps);break;case 5:if(cs(e,n),us(n),i&512&&(Xi||t===null||Wa(t,t.return)),n.flags&32){s=n.stateNode;try{zp(s,"")}catch(x){Xt(n,n.return,x)}}i&4&&n.stateNode!=null&&(s=n.memoizedProps,Jw(n,s,t!==null?t.memoizedProps:s)),i&1024&&(t2=!0);break;case 6:if(cs(e,n),us(n),i&4){if(n.stateNode===null)throw Error(Ee(162));i=n.memoizedProps,t=n.stateNode;try{t.nodeValue=i}catch(x){Xt(n,n.return,x)}}break;case 3:if(cx=null,s=da,da=Cb(e.containerInfo),cs(e,n),da=s,us(n),i&4&&t!==null&&t.memoizedState.isDehydrated)try{Wp(e.containerInfo)}catch(x){Xt(n,n.return,x)}t2&&(t2=!1,K5(n));break;case 4:i=da,da=Cb(n.stateNode.containerInfo),cs(e,n),us(n),da=i;break;case 12:cs(e,n),us(n);break;case 31:cs(e,n),us(n),i&4&&(i=n.updateQueue,i!==null&&(n.updateQueue=null,Lv(n,i)));break;case 13:cs(e,n),us(n),n.child.flags&8192&&n.memoizedState!==null!=(t!==null&&t.memoizedState!==null)&&(F1=ar()),i&4&&(i=n.updateQueue,i!==null&&(n.updateQueue=null,Lv(n,i)));break;case 22:s=n.memoizedState!==null;var l=t!==null&&t.memoizedState!==null,u=el,d=Xi;if(el=u||s,Xi=d||l,cs(e,n),Xi=d,el=u,us(n),i&8192)e:for(e=n.stateNode,e._visibility=s?e._visibility&-2:e._visibility|1,s&&(t===null||l||el||Xi||fu(n)),t=null,e=n;;){if(e.tag===5||e.tag===26){if(t===null){l=t=e;try{if(r=l.stateNode,s)a=r.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none";else{o=l.stateNode;var f=l.memoizedProps.style,p=f!=null&&f.hasOwnProperty("display")?f.display:null;o.style.display=p==null||typeof p=="boolean"?"":(""+p).trim()}}catch(x){Xt(l,l.return,x)}}}else if(e.tag===6){if(t===null){l=e;try{l.stateNode.nodeValue=s?"":l.memoizedProps}catch(x){Xt(l,l.return,x)}}}else if(e.tag===18){if(t===null){l=e;try{var g=l.stateNode;s?hk(g,!0):hk(l.stateNode,!1)}catch(x){Xt(l,l.return,x)}}}else if((e.tag!==22&&e.tag!==23||e.memoizedState===null||e===n)&&e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break e;for(;e.sibling===null;){if(e.return===null||e.return===n)break e;t===e&&(t=null),e=e.return}t===e&&(t=null),e.sibling.return=e.return,e=e.sibling}i&4&&(i=n.updateQueue,i!==null&&(t=i.retryQueue,t!==null&&(i.retryQueue=null,Lv(n,t))));break;case 19:cs(e,n),us(n),i&4&&(i=n.updateQueue,i!==null&&(n.updateQueue=null,Lv(n,i)));break;case 30:break;case 21:break;default:cs(e,n),us(n)}}function us(n){var e=n.flags;if(e&2){try{for(var t,i=n.return;i!==null;){if(H5(i)){t=i;break}i=i.return}if(t==null)throw Error(Ee(160));switch(t.tag){case 27:var s=t.stateNode,r=e2(n);yb(n,r,s);break;case 5:var a=t.stateNode;t.flags&32&&(zp(a,""),t.flags&=-33);var o=e2(n);yb(n,o,a);break;case 3:case 4:var l=t.stateNode.containerInfo,u=e2(n);CS(n,u,l);break;default:throw Error(Ee(161))}}catch(d){Xt(n,n.return,d)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function K5(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var e=n;K5(e),e.tag===5&&e.flags&1024&&e.stateNode.reset(),n=n.sibling}}function co(n,e){if(e.subtreeFlags&8772)for(e=e.child;e!==null;)q5(n,e.alternate,e),e=e.sibling}function fu(n){for(n=n.child;n!==null;){var e=n;switch(e.tag){case 0:case 11:case 14:case 15:Qc(4,e,e.return),fu(e);break;case 1:Wa(e,e.return);var t=e.stateNode;typeof t.componentWillUnmount=="function"&&z5(e,e.return,t),fu(e);break;case 27:wm(e.stateNode);case 26:case 5:Wa(e,e.return),fu(e);break;case 22:e.memoizedState===null&&fu(e);break;case 30:fu(e);break;default:fu(e)}n=n.sibling}}function uo(n,e,t){for(t=t&&(e.subtreeFlags&8772)!==0,e=e.child;e!==null;){var i=e.alternate,s=n,r=e,a=r.flags;switch(r.tag){case 0:case 11:case 15:uo(s,r,t),Jy(4,r);break;case 1:if(uo(s,r,t),i=r,s=i.stateNode,typeof s.componentDidMount=="function")try{s.componentDidMount()}catch(u){Xt(i,i.return,u)}if(i=r,s=i.updateQueue,s!==null){var o=i.stateNode;try{var l=s.shared.hiddenCallbacks;if(l!==null)for(s.shared.hiddenCallbacks=null,s=0;s<l.length;s++)Y3(l[s],o)}catch(u){Xt(i,i.return,u)}}t&&a&64&&F5(r),ym(r,r.return);break;case 27:$5(r);case 26:case 5:uo(s,r,t),t&&i===null&&a&4&&U5(r),ym(r,r.return);break;case 12:uo(s,r,t);break;case 31:uo(s,r,t),t&&a&4&&Y5(s,r);break;case 13:uo(s,r,t),t&&a&4&&W5(s,r);break;case 22:r.memoizedState===null&&uo(s,r,t),ym(r,r.return);break;case 30:break;default:uo(s,r,t)}e=e.sibling}}function AC(n,e){var t=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(t=n.memoizedState.cachePool.pool),n=null,e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),n!==t&&(n!=null&&n.refCount++,t!=null&&Zy(t))}function EC(n,e){n=null,e.alternate!==null&&(n=e.alternate.memoizedState.cache),e=e.memoizedState.cache,e!==n&&(e.refCount++,n!=null&&Zy(n))}function Xr(n,e,t,i){if(e.subtreeFlags&10256)for(e=e.child;e!==null;)Z5(n,e,t,i),e=e.sibling}function Z5(n,e,t,i){var s=e.flags;switch(e.tag){case 0:case 11:case 15:Xr(n,e,t,i),s&2048&&Jy(9,e);break;case 1:Xr(n,e,t,i);break;case 3:Xr(n,e,t,i),s&2048&&(n=null,e.alternate!==null&&(n=e.alternate.memoizedState.cache),e=e.memoizedState.cache,e!==n&&(e.refCount++,n!=null&&Zy(n)));break;case 12:if(s&2048){Xr(n,e,t,i),n=e.stateNode;try{var r=e.memoizedProps,a=r.id,o=r.onPostCommit;typeof o=="function"&&o(a,e.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(l){Xt(e,e.return,l)}}else Xr(n,e,t,i);break;case 31:Xr(n,e,t,i);break;case 13:Xr(n,e,t,i);break;case 23:break;case 22:r=e.stateNode,a=e.alternate,e.memoizedState!==null?r._visibility&2?Xr(n,e,t,i):vm(n,e):r._visibility&2?Xr(n,e,t,i):(r._visibility|=2,wd(n,e,t,i,(e.subtreeFlags&10256)!==0||!1)),s&2048&&AC(a,e);break;case 24:Xr(n,e,t,i),s&2048&&EC(e.alternate,e);break;default:Xr(n,e,t,i)}}function wd(n,e,t,i,s){for(s=s&&((e.subtreeFlags&10256)!==0||!1),e=e.child;e!==null;){var r=n,a=e,o=t,l=i,u=a.flags;switch(a.tag){case 0:case 11:case 15:wd(r,a,o,l,s),Jy(8,a);break;case 23:break;case 22:var d=a.stateNode;a.memoizedState!==null?d._visibility&2?wd(r,a,o,l,s):vm(r,a):(d._visibility|=2,wd(r,a,o,l,s)),s&&u&2048&&AC(a.alternate,a);break;case 24:wd(r,a,o,l,s),s&&u&2048&&EC(a.alternate,a);break;default:wd(r,a,o,l,s)}e=e.sibling}}function vm(n,e){if(e.subtreeFlags&10256)for(e=e.child;e!==null;){var t=n,i=e,s=i.flags;switch(i.tag){case 22:vm(t,i),s&2048&&AC(i.alternate,i);break;case 24:vm(t,i),s&2048&&EC(i.alternate,i);break;default:vm(t,i)}e=e.sibling}}var Bg=8192;function hd(n,e,t){if(n.subtreeFlags&Bg)for(n=n.child;n!==null;)Q5(n,e,t),n=n.sibling}function Q5(n,e,t){switch(n.tag){case 26:hd(n,e,t),n.flags&Bg&&n.memoizedState!==null&&f8(t,da,n.memoizedState,n.memoizedProps);break;case 5:hd(n,e,t);break;case 3:case 4:var i=da;da=Cb(n.stateNode.containerInfo),hd(n,e,t),da=i;break;case 22:n.memoizedState===null&&(i=n.alternate,i!==null&&i.memoizedState!==null?(i=Bg,Bg=16777216,hd(n,e,t),Bg=i):hd(n,e,t));break;default:hd(n,e,t)}}function J5(n){var e=n.alternate;if(e!==null&&(n=e.child,n!==null)){e.child=null;do e=n.sibling,n.sibling=null,n=e;while(n!==null)}}function Sg(n){var e=n.deletions;if(n.flags&16){if(e!==null)for(var t=0;t<e.length;t++){var i=e[t];vn=i,tj(i,n)}J5(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)ej(n),n=n.sibling}function ej(n){switch(n.tag){case 0:case 11:case 15:Sg(n),n.flags&2048&&Qc(9,n,n.return);break;case 3:Sg(n);break;case 12:Sg(n);break;case 22:var e=n.stateNode;n.memoizedState!==null&&e._visibility&2&&(n.return===null||n.return.tag!==13)?(e._visibility&=-3,ox(n)):Sg(n);break;default:Sg(n)}}function ox(n){var e=n.deletions;if(n.flags&16){if(e!==null)for(var t=0;t<e.length;t++){var i=e[t];vn=i,tj(i,n)}J5(n)}for(n=n.child;n!==null;){switch(e=n,e.tag){case 0:case 11:case 15:Qc(8,e,e.return),ox(e);break;case 22:t=e.stateNode,t._visibility&2&&(t._visibility&=-3,ox(e));break;default:ox(e)}n=n.sibling}}function tj(n,e){for(;vn!==null;){var t=vn;switch(t.tag){case 0:case 11:case 15:Qc(8,t,e);break;case 23:case 22:if(t.memoizedState!==null&&t.memoizedState.cachePool!==null){var i=t.memoizedState.cachePool.pool;i!=null&&i.refCount++}break;case 24:Zy(t.memoizedState.cache)}if(i=t.child,i!==null)i.return=t,vn=i;else e:for(t=n;vn!==null;){i=vn;var s=i.sibling,r=i.return;if(V5(i),i===t){vn=null;break e}if(s!==null){s.return=r,vn=s;break e}vn=r}}}var kB={getCacheForType:function(n){var e=In(Ki),t=e.data.get(n);return t===void 0&&(t=n(),e.data.set(n,t)),t},cacheSignal:function(){return In(Ki).controller.signal}},TB=typeof WeakMap=="function"?WeakMap:Map,Ft=0,li=null,Et=null,_t=0,Wt=0,Js=null,Oc=!1,cg=!1,CC=!1,yl=0,Oi=0,Jc=0,Ph=0,_C=0,sr=0,qp=0,xm=null,Ss=null,_S=!1,F1=0,ij=0,vb=1/0,xb=null,qc=null,rn=0,Vc=null,Vp=null,ll=0,NS=0,kS=null,nj=null,bm=0,TS=null;function cr(){return Ft&2&&_t!==0?_t&-_t:ot.T!==null?kC():d3()}function sj(){if(sr===0)if(!(_t&536870912)||Rt){var n=Cv;Cv<<=1,!(Cv&3932160)&&(Cv=262144),sr=n}else sr=536870912;return n=dr.current,n!==null&&(n.flags|=32),sr}function Cs(n,e,t){(n===li&&(Wt===2||Wt===9)||n.cancelPendingCommit!==null)&&(Gp(n,0),Ic(n,_t,sr,!1)),Wy(n,t),(!(Ft&2)||n!==li)&&(n===li&&(!(Ft&2)&&(Ph|=t),Oi===4&&Ic(n,_t,sr,!1)),so(n))}function rj(n,e,t){if(Ft&6)throw Error(Ee(327));var i=!t&&(e&127)===0&&(e&n.expiredLanes)===0||Yy(n,e),s=i?RB(n,e):i2(n,e,!0),r=i;do{if(s===0){cg&&!i&&Ic(n,e,0,!1);break}else{if(t=n.current.alternate,r&&!DB(t)){s=i2(n,e,!1),r=!1;continue}if(s===2){if(r=e,n.errorRecoveryDisabledLanes&r)var a=0;else a=n.pendingLanes&-536870913,a=a!==0?a:a&536870912?536870912:0;if(a!==0){e=a;e:{var o=n;s=xm;var l=o.current.memoizedState.isDehydrated;if(l&&(Gp(o,a).flags|=256),a=i2(o,a,!1),a!==2){if(CC&&!l){o.errorRecoveryDisabledLanes|=r,Ph|=r,s=4;break e}r=Ss,Ss=s,r!==null&&(Ss===null?Ss=r:Ss.push.apply(Ss,r))}s=a}if(r=!1,s!==2)continue}}if(s===1){Gp(n,0),Ic(n,e,0,!0);break}e:{switch(i=n,r=s,r){case 0:case 1:throw Error(Ee(345));case 4:if((e&4194048)!==e)break;case 6:Ic(i,e,sr,!Oc);break e;case 2:Ss=null;break;case 3:case 5:break;default:throw Error(Ee(329))}if((e&62914560)===e&&(s=F1+300-ar(),10<s)){if(Ic(i,e,sr,!Oc),k1(i,0,!0)!==0)break e;ll=e,i.timeoutHandle=Cj(QN.bind(null,i,t,Ss,xb,_S,e,sr,Ph,qp,Oc,r,"Throttled",-0,0),s);break e}QN(i,t,Ss,xb,_S,e,sr,Ph,qp,Oc,r,null,-0,0)}}break}while(!0);so(n)}function QN(n,e,t,i,s,r,a,o,l,u,d,f,p,g){if(n.timeoutHandle=-1,f=e.subtreeFlags,f&8192||(f&16785408)===16785408){f={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:nl},Q5(e,r,f);var x=(r&62914560)===r?F1-ar():(r&4194048)===r?ij-ar():0;if(x=p8(f,x),x!==null){ll=r,n.cancelPendingCommit=x(ek.bind(null,n,e,r,t,i,s,a,o,l,d,f,null,p,g)),Ic(n,r,a,!u);return}}ek(n,e,r,t,i,s,a,o,l)}function DB(n){for(var e=n;;){var t=e.tag;if((t===0||t===11||t===15)&&e.flags&16384&&(t=e.updateQueue,t!==null&&(t=t.stores,t!==null)))for(var i=0;i<t.length;i++){var s=t[i],r=s.getSnapshot;s=s.value;try{if(!hr(r(),s))return!1}catch{return!1}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ic(n,e,t,i){e&=~_C,e&=~Ph,n.suspendedLanes|=e,n.pingedLanes&=~e,i&&(n.warmLanes|=e),i=n.expirationTimes;for(var s=e;0<s;){var r=31-lr(s),a=1<<r;i[r]=-1,s&=~a}t!==0&&c3(n,t,e)}function z1(){return Ft&6?!0:(ev(0),!1)}function NC(){if(Et!==null){if(Wt===0)var n=Et.return;else n=Et,sl=Jh=null,dC(n),af=null,Dm=0,n=Et;for(;n!==null;)B5(n.alternate,n),n=n.return;Et=null}}function Gp(n,e){var t=n.timeoutHandle;t!==-1&&(n.timeoutHandle=-1,KB(t)),t=n.cancelPendingCommit,t!==null&&(n.cancelPendingCommit=null,t()),ll=0,NC(),li=n,Et=t=al(n.current,null),_t=e,Wt=0,Js=null,Oc=!1,cg=Yy(n,e),CC=!1,qp=sr=_C=Ph=Jc=Oi=0,Ss=xm=null,_S=!1,e&8&&(e|=e&32);var i=n.entangledLanes;if(i!==0)for(n=n.entanglements,i&=e;0<i;){var s=31-lr(i),r=1<<s;e|=n[s],i&=~r}return yl=e,R1(),t}function aj(n,e){mt=null,ot.H=Rm,e===lg||e===M1?(e=DN(),Wt=3):e===rC?(e=DN(),Wt=4):Wt=e===wC?8:e!==null&&typeof e=="object"&&typeof e.then=="function"?6:1,Js=e,Et===null&&(Oi=1,gb(n,Pr(e,n.current)))}function oj(){var n=dr.current;return n===null?!0:(_t&4194048)===_t?Ur===null:(_t&62914560)===_t||_t&536870912?n===Ur:!1}function lj(){var n=ot.H;return ot.H=Rm,n===null?Rm:n}function cj(){var n=ot.A;return ot.A=kB,n}function bb(){Oi=4,Oc||(_t&4194048)!==_t&&dr.current!==null||(cg=!0),!(Jc&134217727)&&!(Ph&134217727)||li===null||Ic(li,_t,sr,!1)}function i2(n,e,t){var i=Ft;Ft|=2;var s=lj(),r=cj();(li!==n||_t!==e)&&(xb=null,Gp(n,e)),e=!1;var a=Oi;e:do try{if(Wt!==0&&Et!==null){var o=Et,l=Js;switch(Wt){case 8:NC(),a=6;break e;case 3:case 2:case 9:case 6:dr.current===null&&(e=!0);var u=Wt;if(Wt=0,Js=null,Yd(n,o,l,u),t&&cg){a=0;break e}break;default:u=Wt,Wt=0,Js=null,Yd(n,o,l,u)}}jB(),a=Oi;break}catch(d){aj(n,d)}while(!0);return e&&n.shellSuspendCounter++,sl=Jh=null,Ft=i,ot.H=s,ot.A=r,Et===null&&(li=null,_t=0,R1()),a}function jB(){for(;Et!==null;)uj(Et)}function RB(n,e){var t=Ft;Ft|=2;var i=lj(),s=cj();li!==n||_t!==e?(xb=null,vb=ar()+500,Gp(n,e)):cg=Yy(n,e);e:do try{if(Wt!==0&&Et!==null){e=Et;var r=Js;t:switch(Wt){case 1:Wt=0,Js=null,Yd(n,e,r,1);break;case 2:case 9:if(TN(r)){Wt=0,Js=null,JN(e);break}e=function(){Wt!==2&&Wt!==9||li!==n||(Wt=7),so(n)},r.then(e,e);break e;case 3:Wt=7;break e;case 4:Wt=5;break e;case 7:TN(r)?(Wt=0,Js=null,JN(e)):(Wt=0,Js=null,Yd(n,e,r,7));break;case 5:var a=null;switch(Et.tag){case 26:a=Et.memoizedState;case 5:case 27:var o=Et;if(a?Dj(a):o.stateNode.complete){Wt=0,Js=null;var l=o.sibling;if(l!==null)Et=l;else{var u=o.return;u!==null?(Et=u,U1(u)):Et=null}break t}}Wt=0,Js=null,Yd(n,e,r,5);break;case 6:Wt=0,Js=null,Yd(n,e,r,6);break;case 8:NC(),Oi=6;break e;default:throw Error(Ee(462))}}LB();break}catch(d){aj(n,d)}while(!0);return sl=Jh=null,ot.H=i,ot.A=s,Ft=t,Et!==null?0:(li=null,_t=0,R1(),Oi)}function LB(){for(;Et!==null&&!iP();)uj(Et)}function uj(n){var e=P5(n.alternate,n,yl);n.memoizedProps=n.pendingProps,e===null?U1(n):Et=e}function JN(n){var e=n,t=e.alternate;switch(e.tag){case 15:case 0:e=GN(t,e,e.pendingProps,e.type,void 0,_t);break;case 11:e=GN(t,e,e.pendingProps,e.type.render,e.ref,_t);break;case 5:dC(e);default:B5(t,e),e=Et=B3(e,yl),e=P5(t,e,yl)}n.memoizedProps=n.pendingProps,e===null?U1(n):Et=e}function Yd(n,e,t,i){sl=Jh=null,dC(e),af=null,Dm=0;var s=e.return;try{if(wB(n,s,e,t,_t)){Oi=1,gb(n,Pr(t,n.current)),Et=null;return}}catch(r){if(s!==null)throw Et=s,r;Oi=1,gb(n,Pr(t,n.current)),Et=null;return}e.flags&32768?(Rt||i===1?n=!0:cg||_t&536870912?n=!1:(Oc=n=!0,(i===2||i===9||i===3||i===6)&&(i=dr.current,i!==null&&i.tag===13&&(i.flags|=16384))),hj(e,n)):U1(e)}function U1(n){var e=n;do{if(e.flags&32768){hj(e,Oc);return}n=e.return;var t=EB(e.alternate,e,yl);if(t!==null){Et=t;return}if(e=e.sibling,e!==null){Et=e;return}Et=e=n}while(e!==null);Oi===0&&(Oi=5)}function hj(n,e){do{var t=CB(n.alternate,n);if(t!==null){t.flags&=32767,Et=t;return}if(t=n.return,t!==null&&(t.flags|=32768,t.subtreeFlags=0,t.deletions=null),!e&&(n=n.sibling,n!==null)){Et=n;return}Et=n=t}while(n!==null);Oi=6,Et=null}function ek(n,e,t,i,s,r,a,o,l){n.cancelPendingCommit=null;do H1();while(rn!==0);if(Ft&6)throw Error(Ee(327));if(e!==null){if(e===n.current)throw Error(Ee(177));if(r=e.lanes|e.childLanes,r|=QE,dP(n,t,r,a,o,l),n===li&&(Et=li=null,_t=0),Vp=e,Vc=n,ll=t,NS=r,kS=s,nj=i,e.subtreeFlags&10256||e.flags&10256?(n.callbackNode=null,n.callbackPriority=0,PB(sb,function(){return mj(),null})):(n.callbackNode=null,n.callbackPriority=0),i=(e.flags&13878)!==0,e.subtreeFlags&13878||i){i=ot.T,ot.T=null,s=Ut.p,Ut.p=2,a=Ft,Ft|=4;try{_B(n,e,t)}finally{Ft=a,Ut.p=s,ot.T=i}}rn=1,dj(),fj(),pj()}}function dj(){if(rn===1){rn=0;var n=Vc,e=Vp,t=(e.flags&13878)!==0;if(e.subtreeFlags&13878||t){t=ot.T,ot.T=null;var i=Ut.p;Ut.p=2;var s=Ft;Ft|=4;try{X5(e,n);var r=LS,a=D3(n.containerInfo),o=r.focusedElem,l=r.selectionRange;if(a!==o&&o&&o.ownerDocument&&T3(o.ownerDocument.documentElement,o)){if(l!==null&&ZE(o)){var u=l.start,d=l.end;if(d===void 0&&(d=u),"selectionStart"in o)o.selectionStart=u,o.selectionEnd=Math.min(d,o.value.length);else{var f=o.ownerDocument||document,p=f&&f.defaultView||window;if(p.getSelection){var g=p.getSelection(),x=o.textContent.length,w=Math.min(l.start,x),y=l.end===void 0?w:Math.min(l.end,x);!g.extend&&w>y&&(a=y,y=w,w=a);var m=SN(o,w),v=SN(o,y);if(m&&v&&(g.rangeCount!==1||g.anchorNode!==m.node||g.anchorOffset!==m.offset||g.focusNode!==v.node||g.focusOffset!==v.offset)){var b=f.createRange();b.setStart(m.node,m.offset),g.removeAllRanges(),w>y?(g.addRange(b),g.extend(v.node,v.offset)):(b.setEnd(v.node,v.offset),g.addRange(b))}}}}for(f=[],g=o;g=g.parentNode;)g.nodeType===1&&f.push({element:g,left:g.scrollLeft,top:g.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<f.length;o++){var A=f[o];A.element.scrollLeft=A.left,A.element.scrollTop=A.top}}kb=!!RS,LS=RS=null}finally{Ft=s,Ut.p=i,ot.T=t}}n.current=e,rn=2}}function fj(){if(rn===2){rn=0;var n=Vc,e=Vp,t=(e.flags&8772)!==0;if(e.subtreeFlags&8772||t){t=ot.T,ot.T=null;var i=Ut.p;Ut.p=2;var s=Ft;Ft|=4;try{q5(n,e.alternate,e)}finally{Ft=s,Ut.p=i,ot.T=t}}rn=3}}function pj(){if(rn===4||rn===3){rn=0,nP();var n=Vc,e=Vp,t=ll,i=nj;e.subtreeFlags&10256||e.flags&10256?rn=5:(rn=0,Vp=Vc=null,gj(n,n.pendingLanes));var s=n.pendingLanes;if(s===0&&(qc=null),qE(t),e=e.stateNode,or&&typeof or.onCommitFiberRoot=="function")try{or.onCommitFiberRoot(Gy,e,void 0,(e.current.flags&128)===128)}catch{}if(i!==null){e=ot.T,s=Ut.p,Ut.p=2,ot.T=null;try{for(var r=n.onRecoverableError,a=0;a<i.length;a++){var o=i[a];r(o.value,{componentStack:o.stack})}}finally{ot.T=e,Ut.p=s}}ll&3&&H1(),so(n),s=n.pendingLanes,t&261930&&s&42?n===TS?bm++:(bm=0,TS=n):bm=0,ev(0)}}function gj(n,e){(n.pooledCacheLanes&=e)===0&&(e=n.pooledCache,e!=null&&(n.pooledCache=null,Zy(e)))}function H1(){return dj(),fj(),pj(),mj()}function mj(){if(rn!==5)return!1;var n=Vc,e=NS;NS=0;var t=qE(ll),i=ot.T,s=Ut.p;try{Ut.p=32>t?32:t,ot.T=null,t=kS,kS=null;var r=Vc,a=ll;if(rn=0,Vp=Vc=null,ll=0,Ft&6)throw Error(Ee(331));var o=Ft;if(Ft|=4,ej(r.current),Z5(r,r.current,a,t),Ft=o,ev(0,!1),or&&typeof or.onPostCommitFiberRoot=="function")try{or.onPostCommitFiberRoot(Gy,r)}catch{}return!0}finally{Ut.p=s,ot.T=i,gj(n,e)}}function tk(n,e,t){e=Pr(t,e),e=SS(n.stateNode,e,2),n=$c(n,e,2),n!==null&&(Wy(n,2),so(n))}function Xt(n,e,t){if(n.tag===3)tk(n,n,t);else for(;e!==null;){if(e.tag===3){tk(e,n,t);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(qc===null||!qc.has(i))){n=Pr(t,n),t=j5(2),i=$c(e,t,2),i!==null&&(R5(t,i,e,n),Wy(i,2),so(i));break}}e=e.return}}function n2(n,e,t){var i=n.pingCache;if(i===null){i=n.pingCache=new TB;var s=new Set;i.set(e,s)}else s=i.get(e),s===void 0&&(s=new Set,i.set(e,s));s.has(t)||(CC=!0,s.add(t),n=MB.bind(null,n,e,t),e.then(n,n))}function MB(n,e,t){var i=n.pingCache;i!==null&&i.delete(e),n.pingedLanes|=n.suspendedLanes&t,n.warmLanes&=~t,li===n&&(_t&t)===t&&(Oi===4||Oi===3&&(_t&62914560)===_t&&300>ar()-F1?!(Ft&2)&&Gp(n,0):_C|=t,qp===_t&&(qp=0)),so(n)}function yj(n,e){e===0&&(e=l3()),n=Qh(n,e),n!==null&&(Wy(n,e),so(n))}function OB(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),yj(n,t)}function IB(n,e){var t=0;switch(n.tag){case 31:case 13:var i=n.stateNode,s=n.memoizedState;s!==null&&(t=s.retryLane);break;case 19:i=n.stateNode;break;case 22:i=n.stateNode._retryCache;break;default:throw Error(Ee(314))}i!==null&&i.delete(e),yj(n,t)}function PB(n,e){return HE(n,e)}var wb=null,Sd=null,DS=!1,Sb=!1,s2=!1,Pc=0;function so(n){n!==Sd&&n.next===null&&(Sd===null?wb=Sd=n:Sd=Sd.next=n),Sb=!0,DS||(DS=!0,FB())}function ev(n,e){if(!s2&&Sb){s2=!0;do for(var t=!1,i=wb;i!==null;){if(n!==0){var s=i.pendingLanes;if(s===0)var r=0;else{var a=i.suspendedLanes,o=i.pingedLanes;r=(1<<31-lr(42|n)+1)-1,r&=s&~(a&~o),r=r&201326741?r&201326741|1:r?r|2:0}r!==0&&(t=!0,ik(i,r))}else r=_t,r=k1(i,i===li?r:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),!(r&3)||Yy(i,r)||(t=!0,ik(i,r));i=i.next}while(t);s2=!1}}function BB(){vj()}function vj(){Sb=DS=!1;var n=0;Pc!==0&&XB()&&(n=Pc);for(var e=ar(),t=null,i=wb;i!==null;){var s=i.next,r=xj(i,e);r===0?(i.next=null,t===null?wb=s:t.next=s,s===null&&(Sd=t)):(t=i,(n!==0||r&3)&&(Sb=!0)),i=s}rn!==0&&rn!==5||ev(n),Pc!==0&&(Pc=0)}function xj(n,e){for(var t=n.suspendedLanes,i=n.pingedLanes,s=n.expirationTimes,r=n.pendingLanes&-62914561;0<r;){var a=31-lr(r),o=1<<a,l=s[a];l===-1?(!(o&t)||o&i)&&(s[a]=hP(o,e)):l<=e&&(n.expiredLanes|=o),r&=~o}if(e=li,t=_t,t=k1(n,n===e?t:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),i=n.callbackNode,t===0||n===e&&(Wt===2||Wt===9)||n.cancelPendingCommit!==null)return i!==null&&i!==null&&Rw(i),n.callbackNode=null,n.callbackPriority=0;if(!(t&3)||Yy(n,t)){if(e=t&-t,e===n.callbackPriority)return e;switch(i!==null&&Rw(i),qE(t)){case 2:case 8:t=a3;break;case 32:t=sb;break;case 268435456:t=o3;break;default:t=sb}return i=bj.bind(null,n),t=HE(t,i),n.callbackPriority=e,n.callbackNode=t,e}return i!==null&&i!==null&&Rw(i),n.callbackPriority=2,n.callbackNode=null,2}function bj(n,e){if(rn!==0&&rn!==5)return n.callbackNode=null,n.callbackPriority=0,null;var t=n.callbackNode;if(H1()&&n.callbackNode!==t)return null;var i=_t;return i=k1(n,n===li?i:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),i===0?null:(rj(n,i,e),xj(n,ar()),n.callbackNode!=null&&n.callbackNode===t?bj.bind(null,n):null)}function ik(n,e){if(H1())return null;rj(n,e,!0)}function FB(){ZB(function(){Ft&6?HE(r3,BB):vj()})}function kC(){if(Pc===0){var n=Up;n===0&&(n=Ev,Ev<<=1,!(Ev&261888)&&(Ev=256)),Pc=n}return Pc}function nk(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:Qv(""+n)}function sk(n,e){var t=e.ownerDocument.createElement("input");return t.name=e.name,t.value=e.value,n.id&&t.setAttribute("form",n.id),e.parentNode.insertBefore(t,e),n=new FormData(n),t.parentNode.removeChild(t),n}function zB(n,e,t,i,s){if(e==="submit"&&t&&t.stateNode===s){var r=nk((s[Ns]||null).action),a=i.submitter;a&&(e=(e=a[Ns]||null)?nk(e.formAction):a.getAttribute("formAction"),e!==null&&(r=e,a=null));var o=new T1("action","action",null,i,s);n.push({event:o,listeners:[{instance:null,listener:function(){if(i.defaultPrevented){if(Pc!==0){var l=a?sk(s,a):new FormData(s);bS(t,{pending:!0,data:l,method:s.method,action:r},null,l)}}else typeof r=="function"&&(o.preventDefault(),l=a?sk(s,a):new FormData(s),bS(t,{pending:!0,data:l,method:s.method,action:r},r,l))},currentTarget:s}]})}}for(var r2=0;r2<lS.length;r2++){var a2=lS[r2],UB=a2.toLowerCase(),HB=a2[0].toUpperCase()+a2.slice(1);va(UB,"on"+HB)}va(R3,"onAnimationEnd");va(L3,"onAnimationIteration");va(M3,"onAnimationStart");va("dblclick","onDoubleClick");va("focusin","onFocus");va("focusout","onBlur");va(sB,"onTransitionRun");va(rB,"onTransitionStart");va(aB,"onTransitionCancel");va(O3,"onTransitionEnd");Fp("onMouseEnter",["mouseout","mouseover"]);Fp("onMouseLeave",["mouseout","mouseover"]);Fp("onPointerEnter",["pointerout","pointerover"]);Fp("onPointerLeave",["pointerout","pointerover"]);Xh("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Xh("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Xh("onBeforeInput",["compositionend","keypress","textInput","paste"]);Xh("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Xh("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Xh("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lm="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$B=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Lm));function wj(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var i=n[t],s=i.event;i=i.listeners;e:{var r=void 0;if(e)for(var a=i.length-1;0<=a;a--){var o=i[a],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==r&&s.isPropagationStopped())break e;r=o,s.currentTarget=u;try{r(s)}catch(d){ab(d)}s.currentTarget=null,r=l}else for(a=0;a<i.length;a++){if(o=i[a],l=o.instance,u=o.currentTarget,o=o.listener,l!==r&&s.isPropagationStopped())break e;r=o,s.currentTarget=u;try{r(s)}catch(d){ab(d)}s.currentTarget=null,r=l}}}}function At(n,e){var t=e[eS];t===void 0&&(t=e[eS]=new Set);var i=n+"__bubble";t.has(i)||(Sj(e,n,2,!1),t.add(i))}function o2(n,e,t){var i=0;e&&(i|=4),Sj(t,n,i,e)}var Mv="_reactListening"+Math.random().toString(36).slice(2);function TC(n){if(!n[Mv]){n[Mv]=!0,f3.forEach(function(t){t!=="selectionchange"&&($B.has(t)||o2(t,!1,n),o2(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[Mv]||(e[Mv]=!0,o2("selectionchange",!1,e))}}function Sj(n,e,t,i){switch(Oj(e)){case 2:var s=y8;break;case 8:s=v8;break;default:s=LC}t=s.bind(null,e,t,n),s=void 0,!rS||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),i?s!==void 0?n.addEventListener(e,t,{capture:!0,passive:s}):n.addEventListener(e,t,!0):s!==void 0?n.addEventListener(e,t,{passive:s}):n.addEventListener(e,t,!1)}function l2(n,e,t,i,s){var r=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var a=i.tag;if(a===3||a===4){var o=i.stateNode.containerInfo;if(o===s)break;if(a===4)for(a=i.return;a!==null;){var l=a.tag;if((l===3||l===4)&&a.stateNode.containerInfo===s)return;a=a.return}for(;o!==null;){if(a=Bd(o),a===null)return;if(l=a.tag,l===5||l===6||l===26||l===27){i=r=a;continue e}o=o.parentNode}}i=i.return}w3(function(){var u=r,d=YE(t),f=[];e:{var p=I3.get(n);if(p!==void 0){var g=T1,x=n;switch(n){case"keypress":if(ex(t)===0)break e;case"keydown":case"keyup":g=IP;break;case"focusin":x="focus",g=Pw;break;case"focusout":x="blur",g=Pw;break;case"beforeblur":case"afterblur":g=Pw;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=dN;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=EP;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=FP;break;case R3:case L3:case M3:g=NP;break;case O3:g=UP;break;case"scroll":case"scrollend":g=SP;break;case"wheel":g=$P;break;case"copy":case"cut":case"paste":g=TP;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=pN;break;case"toggle":case"beforetoggle":g=VP}var w=(e&4)!==0,y=!w&&(n==="scroll"||n==="scrollend"),m=w?p!==null?p+"Capture":null:p;w=[];for(var v=u,b;v!==null;){var A=v;if(b=A.stateNode,A=A.tag,A!==5&&A!==26&&A!==27||b===null||m===null||(A=Cm(v,m),A!=null&&w.push(Mm(v,A,b))),y)break;v=v.return}0<w.length&&(p=new g(p,x,null,t,d),f.push({event:p,listeners:w}))}}if(!(e&7)){e:{if(p=n==="mouseover"||n==="pointerover",g=n==="mouseout"||n==="pointerout",p&&t!==sS&&(x=t.relatedTarget||t.fromElement)&&(Bd(x)||x[rg]))break e;if((g||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,g?(x=t.relatedTarget||t.toElement,g=u,x=x?Bd(x):null,x!==null&&(y=Vy(x),w=x.tag,x!==y||w!==5&&w!==27&&w!==6)&&(x=null)):(g=null,x=u),g!==x)){if(w=dN,A="onMouseLeave",m="onMouseEnter",v="mouse",(n==="pointerout"||n==="pointerover")&&(w=pN,A="onPointerLeave",m="onPointerEnter",v="pointer"),y=g==null?p:Ig(g),b=x==null?p:Ig(x),p=new w(A,v+"leave",g,t,d),p.target=y,p.relatedTarget=b,A=null,Bd(d)===u&&(w=new w(m,v+"enter",x,t,d),w.target=b,w.relatedTarget=y,A=w),y=A,g&&x)t:{for(w=qB,m=g,v=x,b=0,A=m;A;A=w(A))b++;A=0;for(var S=v;S;S=w(S))A++;for(;0<b-A;)m=w(m),b--;for(;0<A-b;)v=w(v),A--;for(;b--;){if(m===v||v!==null&&m===v.alternate){w=m;break t}m=w(m),v=w(v)}w=null}else w=null;g!==null&&rk(f,p,g,w,!1),x!==null&&y!==null&&rk(f,y,x,w,!0)}}e:{if(p=u?Ig(u):window,g=p.nodeName&&p.nodeName.toLowerCase(),g==="select"||g==="input"&&p.type==="file")var C=vN;else if(yN(p))if(N3)C=tB;else{C=JP;var k=QP}else g=p.nodeName,!g||g.toLowerCase()!=="input"||p.type!=="checkbox"&&p.type!=="radio"?u&&GE(u.elementType)&&(C=vN):C=eB;if(C&&(C=C(n,u))){_3(f,C,t,d);break e}k&&k(n,p,u),n==="focusout"&&u&&p.type==="number"&&u.memoizedProps.value!=null&&nS(p,"number",p.value)}switch(k=u?Ig(u):window,n){case"focusin":(yN(k)||k.contentEditable==="true")&&(Ud=k,aS=u,hm=null);break;case"focusout":hm=aS=Ud=null;break;case"mousedown":oS=!0;break;case"contextmenu":case"mouseup":case"dragend":oS=!1,AN(f,t,d);break;case"selectionchange":if(nB)break;case"keydown":case"keyup":AN(f,t,d)}var L;if(KE)e:{switch(n){case"compositionstart":var D="onCompositionStart";break e;case"compositionend":D="onCompositionEnd";break e;case"compositionupdate":D="onCompositionUpdate";break e}D=void 0}else zd?E3(n,t)&&(D="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(D="onCompositionStart");D&&(A3&&t.locale!=="ko"&&(zd||D!=="onCompositionStart"?D==="onCompositionEnd"&&zd&&(L=S3()):(Mc=d,WE="value"in Mc?Mc.value:Mc.textContent,zd=!0)),k=Ab(u,D),0<k.length&&(D=new fN(D,n,null,t,d),f.push({event:D,listeners:k}),L?D.data=L:(L=C3(t),L!==null&&(D.data=L)))),(L=YP?WP(n,t):XP(n,t))&&(D=Ab(u,"onBeforeInput"),0<D.length&&(k=new fN("onBeforeInput","beforeinput",null,t,d),f.push({event:k,listeners:D}),k.data=L)),zB(f,n,u,t,d)}wj(f,e)})}function Mm(n,e,t){return{instance:n,listener:e,currentTarget:t}}function Ab(n,e){for(var t=e+"Capture",i=[];n!==null;){var s=n,r=s.stateNode;if(s=s.tag,s!==5&&s!==26&&s!==27||r===null||(s=Cm(n,t),s!=null&&i.unshift(Mm(n,s,r)),s=Cm(n,e),s!=null&&i.push(Mm(n,s,r))),n.tag===3)return i;n=n.return}return[]}function qB(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function rk(n,e,t,i,s){for(var r=e._reactName,a=[];t!==null&&t!==i;){var o=t,l=o.alternate,u=o.stateNode;if(o=o.tag,l!==null&&l===i)break;o!==5&&o!==26&&o!==27||u===null||(l=u,s?(u=Cm(t,r),u!=null&&a.unshift(Mm(t,u,l))):s||(u=Cm(t,r),u!=null&&a.push(Mm(t,u,l)))),t=t.return}a.length!==0&&n.push({event:e,listeners:a})}var VB=/\r\n?/g,GB=/\u0000|\uFFFD/g;function ak(n){return(typeof n=="string"?n:""+n).replace(VB,`
`).replace(GB,"")}function Aj(n,e){return e=ak(e),ak(n)===e}function ii(n,e,t,i,s,r){switch(t){case"children":typeof i=="string"?e==="body"||e==="textarea"&&i===""||zp(n,i):(typeof i=="number"||typeof i=="bigint")&&e!=="body"&&zp(n,""+i);break;case"className":Nv(n,"class",i);break;case"tabIndex":Nv(n,"tabindex",i);break;case"dir":case"role":case"viewBox":case"width":case"height":Nv(n,t,i);break;case"style":b3(n,i,r);break;case"data":if(e!=="object"){Nv(n,"data",i);break}case"src":case"href":if(i===""&&(e!=="a"||t!=="href")){n.removeAttribute(t);break}if(i==null||typeof i=="function"||typeof i=="symbol"||typeof i=="boolean"){n.removeAttribute(t);break}i=Qv(""+i),n.setAttribute(t,i);break;case"action":case"formAction":if(typeof i=="function"){n.setAttribute(t,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof r=="function"&&(t==="formAction"?(e!=="input"&&ii(n,e,"name",s.name,s,null),ii(n,e,"formEncType",s.formEncType,s,null),ii(n,e,"formMethod",s.formMethod,s,null),ii(n,e,"formTarget",s.formTarget,s,null)):(ii(n,e,"encType",s.encType,s,null),ii(n,e,"method",s.method,s,null),ii(n,e,"target",s.target,s,null)));if(i==null||typeof i=="symbol"||typeof i=="boolean"){n.removeAttribute(t);break}i=Qv(""+i),n.setAttribute(t,i);break;case"onClick":i!=null&&(n.onclick=nl);break;case"onScroll":i!=null&&At("scroll",n);break;case"onScrollEnd":i!=null&&At("scrollend",n);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(Ee(61));if(t=i.__html,t!=null){if(s.children!=null)throw Error(Ee(60));n.innerHTML=t}}break;case"multiple":n.multiple=i&&typeof i!="function"&&typeof i!="symbol";break;case"muted":n.muted=i&&typeof i!="function"&&typeof i!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(i==null||typeof i=="function"||typeof i=="boolean"||typeof i=="symbol"){n.removeAttribute("xlink:href");break}t=Qv(""+i),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",t);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":i!=null&&typeof i!="function"&&typeof i!="symbol"?n.setAttribute(t,""+i):n.removeAttribute(t);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":i&&typeof i!="function"&&typeof i!="symbol"?n.setAttribute(t,""):n.removeAttribute(t);break;case"capture":case"download":i===!0?n.setAttribute(t,""):i!==!1&&i!=null&&typeof i!="function"&&typeof i!="symbol"?n.setAttribute(t,i):n.removeAttribute(t);break;case"cols":case"rows":case"size":case"span":i!=null&&typeof i!="function"&&typeof i!="symbol"&&!isNaN(i)&&1<=i?n.setAttribute(t,i):n.removeAttribute(t);break;case"rowSpan":case"start":i==null||typeof i=="function"||typeof i=="symbol"||isNaN(i)?n.removeAttribute(t):n.setAttribute(t,i);break;case"popover":At("beforetoggle",n),At("toggle",n),Zv(n,"popover",i);break;case"xlinkActuate":ao(n,"http://www.w3.org/1999/xlink","xlink:actuate",i);break;case"xlinkArcrole":ao(n,"http://www.w3.org/1999/xlink","xlink:arcrole",i);break;case"xlinkRole":ao(n,"http://www.w3.org/1999/xlink","xlink:role",i);break;case"xlinkShow":ao(n,"http://www.w3.org/1999/xlink","xlink:show",i);break;case"xlinkTitle":ao(n,"http://www.w3.org/1999/xlink","xlink:title",i);break;case"xlinkType":ao(n,"http://www.w3.org/1999/xlink","xlink:type",i);break;case"xmlBase":ao(n,"http://www.w3.org/XML/1998/namespace","xml:base",i);break;case"xmlLang":ao(n,"http://www.w3.org/XML/1998/namespace","xml:lang",i);break;case"xmlSpace":ao(n,"http://www.w3.org/XML/1998/namespace","xml:space",i);break;case"is":Zv(n,"is",i);break;case"innerText":case"textContent":break;default:(!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(t=bP.get(t)||t,Zv(n,t,i))}}function jS(n,e,t,i,s,r){switch(t){case"style":b3(n,i,r);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(Ee(61));if(t=i.__html,t!=null){if(s.children!=null)throw Error(Ee(60));n.innerHTML=t}}break;case"children":typeof i=="string"?zp(n,i):(typeof i=="number"||typeof i=="bigint")&&zp(n,""+i);break;case"onScroll":i!=null&&At("scroll",n);break;case"onScrollEnd":i!=null&&At("scrollend",n);break;case"onClick":i!=null&&(n.onclick=nl);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!p3.hasOwnProperty(t))e:{if(t[0]==="o"&&t[1]==="n"&&(s=t.endsWith("Capture"),e=t.slice(2,s?t.length-7:void 0),r=n[Ns]||null,r=r!=null?r[t]:null,typeof r=="function"&&n.removeEventListener(e,r,s),typeof i=="function")){typeof r!="function"&&r!==null&&(t in n?n[t]=null:n.hasAttribute(t)&&n.removeAttribute(t)),n.addEventListener(e,i,s);break e}t in n?n[t]=i:i===!0?n.setAttribute(t,""):Zv(n,t,i)}}}function Pn(n,e,t){switch(e){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":At("error",n),At("load",n);var i=!1,s=!1,r;for(r in t)if(t.hasOwnProperty(r)){var a=t[r];if(a!=null)switch(r){case"src":i=!0;break;case"srcSet":s=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(Ee(137,e));default:ii(n,e,r,a,t,null)}}s&&ii(n,e,"srcSet",t.srcSet,t,null),i&&ii(n,e,"src",t.src,t,null);return;case"input":At("invalid",n);var o=r=a=s=null,l=null,u=null;for(i in t)if(t.hasOwnProperty(i)){var d=t[i];if(d!=null)switch(i){case"name":s=d;break;case"type":a=d;break;case"checked":l=d;break;case"defaultChecked":u=d;break;case"value":r=d;break;case"defaultValue":o=d;break;case"children":case"dangerouslySetInnerHTML":if(d!=null)throw Error(Ee(137,e));break;default:ii(n,e,i,d,t,null)}}y3(n,r,o,l,u,a,s,!1);return;case"select":At("invalid",n),i=a=r=null;for(s in t)if(t.hasOwnProperty(s)&&(o=t[s],o!=null))switch(s){case"value":r=o;break;case"defaultValue":a=o;break;case"multiple":i=o;default:ii(n,e,s,o,t,null)}e=r,t=a,n.multiple=!!i,e!=null?nf(n,!!i,e,!1):t!=null&&nf(n,!!i,t,!0);return;case"textarea":At("invalid",n),r=s=i=null;for(a in t)if(t.hasOwnProperty(a)&&(o=t[a],o!=null))switch(a){case"value":i=o;break;case"defaultValue":s=o;break;case"children":r=o;break;case"dangerouslySetInnerHTML":if(o!=null)throw Error(Ee(91));break;default:ii(n,e,a,o,t,null)}x3(n,i,s,r);return;case"option":for(l in t)if(t.hasOwnProperty(l)&&(i=t[l],i!=null))switch(l){case"selected":n.selected=i&&typeof i!="function"&&typeof i!="symbol";break;default:ii(n,e,l,i,t,null)}return;case"dialog":At("beforetoggle",n),At("toggle",n),At("cancel",n),At("close",n);break;case"iframe":case"object":At("load",n);break;case"video":case"audio":for(i=0;i<Lm.length;i++)At(Lm[i],n);break;case"image":At("error",n),At("load",n);break;case"details":At("toggle",n);break;case"embed":case"source":case"link":At("error",n),At("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in t)if(t.hasOwnProperty(u)&&(i=t[u],i!=null))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(Ee(137,e));default:ii(n,e,u,i,t,null)}return;default:if(GE(e)){for(d in t)t.hasOwnProperty(d)&&(i=t[d],i!==void 0&&jS(n,e,d,i,t,void 0));return}}for(o in t)t.hasOwnProperty(o)&&(i=t[o],i!=null&&ii(n,e,o,i,t,null))}function YB(n,e,t,i){switch(e){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var s=null,r=null,a=null,o=null,l=null,u=null,d=null;for(g in t){var f=t[g];if(t.hasOwnProperty(g)&&f!=null)switch(g){case"checked":break;case"value":break;case"defaultValue":l=f;default:i.hasOwnProperty(g)||ii(n,e,g,null,i,f)}}for(var p in i){var g=i[p];if(f=t[p],i.hasOwnProperty(p)&&(g!=null||f!=null))switch(p){case"type":r=g;break;case"name":s=g;break;case"checked":u=g;break;case"defaultChecked":d=g;break;case"value":a=g;break;case"defaultValue":o=g;break;case"children":case"dangerouslySetInnerHTML":if(g!=null)throw Error(Ee(137,e));break;default:g!==f&&ii(n,e,p,g,i,f)}}iS(n,a,o,l,u,d,r,s);return;case"select":g=a=o=p=null;for(r in t)if(l=t[r],t.hasOwnProperty(r)&&l!=null)switch(r){case"value":break;case"multiple":g=l;default:i.hasOwnProperty(r)||ii(n,e,r,null,i,l)}for(s in i)if(r=i[s],l=t[s],i.hasOwnProperty(s)&&(r!=null||l!=null))switch(s){case"value":p=r;break;case"defaultValue":o=r;break;case"multiple":a=r;default:r!==l&&ii(n,e,s,r,i,l)}e=o,t=a,i=g,p!=null?nf(n,!!t,p,!1):!!i!=!!t&&(e!=null?nf(n,!!t,e,!0):nf(n,!!t,t?[]:"",!1));return;case"textarea":g=p=null;for(o in t)if(s=t[o],t.hasOwnProperty(o)&&s!=null&&!i.hasOwnProperty(o))switch(o){case"value":break;case"children":break;default:ii(n,e,o,null,i,s)}for(a in i)if(s=i[a],r=t[a],i.hasOwnProperty(a)&&(s!=null||r!=null))switch(a){case"value":p=s;break;case"defaultValue":g=s;break;case"children":break;case"dangerouslySetInnerHTML":if(s!=null)throw Error(Ee(91));break;default:s!==r&&ii(n,e,a,s,i,r)}v3(n,p,g);return;case"option":for(var x in t)if(p=t[x],t.hasOwnProperty(x)&&p!=null&&!i.hasOwnProperty(x))switch(x){case"selected":n.selected=!1;break;default:ii(n,e,x,null,i,p)}for(l in i)if(p=i[l],g=t[l],i.hasOwnProperty(l)&&p!==g&&(p!=null||g!=null))switch(l){case"selected":n.selected=p&&typeof p!="function"&&typeof p!="symbol";break;default:ii(n,e,l,p,i,g)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var w in t)p=t[w],t.hasOwnProperty(w)&&p!=null&&!i.hasOwnProperty(w)&&ii(n,e,w,null,i,p);for(u in i)if(p=i[u],g=t[u],i.hasOwnProperty(u)&&p!==g&&(p!=null||g!=null))switch(u){case"children":case"dangerouslySetInnerHTML":if(p!=null)throw Error(Ee(137,e));break;default:ii(n,e,u,p,i,g)}return;default:if(GE(e)){for(var y in t)p=t[y],t.hasOwnProperty(y)&&p!==void 0&&!i.hasOwnProperty(y)&&jS(n,e,y,void 0,i,p);for(d in i)p=i[d],g=t[d],!i.hasOwnProperty(d)||p===g||p===void 0&&g===void 0||jS(n,e,d,p,i,g);return}}for(var m in t)p=t[m],t.hasOwnProperty(m)&&p!=null&&!i.hasOwnProperty(m)&&ii(n,e,m,null,i,p);for(f in i)p=i[f],g=t[f],!i.hasOwnProperty(f)||p===g||p==null&&g==null||ii(n,e,f,p,i,g)}function ok(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function WB(){if(typeof performance.getEntriesByType=="function"){for(var n=0,e=0,t=performance.getEntriesByType("resource"),i=0;i<t.length;i++){var s=t[i],r=s.transferSize,a=s.initiatorType,o=s.duration;if(r&&o&&ok(a)){for(a=0,o=s.responseEnd,i+=1;i<t.length;i++){var l=t[i],u=l.startTime;if(u>o)break;var d=l.transferSize,f=l.initiatorType;d&&ok(f)&&(l=l.responseEnd,a+=d*(l<o?1:(o-u)/(l-u)))}if(--i,e+=8*(r+a)/(s.duration/1e3),n++,10<n)break}}if(0<n)return e/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var RS=null,LS=null;function Eb(n){return n.nodeType===9?n:n.ownerDocument}function lk(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Ej(n,e){if(n===0)switch(e){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&e==="foreignObject"?0:n}function MS(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.children=="bigint"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var c2=null;function XB(){var n=window.event;return n&&n.type==="popstate"?n===c2?!1:(c2=n,!0):(c2=null,!1)}var Cj=typeof setTimeout=="function"?setTimeout:void 0,KB=typeof clearTimeout=="function"?clearTimeout:void 0,ck=typeof Promise=="function"?Promise:void 0,ZB=typeof queueMicrotask=="function"?queueMicrotask:typeof ck<"u"?function(n){return ck.resolve(null).then(n).catch(QB)}:Cj;function QB(n){setTimeout(function(){throw n})}function su(n){return n==="head"}function uk(n,e){var t=e,i=0;do{var s=t.nextSibling;if(n.removeChild(t),s&&s.nodeType===8)if(t=s.data,t==="/$"||t==="/&"){if(i===0){n.removeChild(s),Wp(e);return}i--}else if(t==="$"||t==="$?"||t==="$~"||t==="$!"||t==="&")i++;else if(t==="html")wm(n.ownerDocument.documentElement);else if(t==="head"){t=n.ownerDocument.head,wm(t);for(var r=t.firstChild;r;){var a=r.nextSibling,o=r.nodeName;r[Xy]||o==="SCRIPT"||o==="STYLE"||o==="LINK"&&r.rel.toLowerCase()==="stylesheet"||t.removeChild(r),r=a}}else t==="body"&&wm(n.ownerDocument.body);t=s}while(t);Wp(e)}function hk(n,e){var t=n;n=0;do{var i=t.nextSibling;if(t.nodeType===1?e?(t._stashedDisplay=t.style.display,t.style.display="none"):(t.style.display=t._stashedDisplay||"",t.getAttribute("style")===""&&t.removeAttribute("style")):t.nodeType===3&&(e?(t._stashedText=t.nodeValue,t.nodeValue=""):t.nodeValue=t._stashedText||""),i&&i.nodeType===8)if(t=i.data,t==="/$"){if(n===0)break;n--}else t!=="$"&&t!=="$?"&&t!=="$~"&&t!=="$!"||n++;t=i}while(t)}function OS(n){var e=n.firstChild;for(e&&e.nodeType===10&&(e=e.nextSibling);e;){var t=e;switch(e=e.nextSibling,t.nodeName){case"HTML":case"HEAD":case"BODY":OS(t),VE(t);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(t.rel.toLowerCase()==="stylesheet")continue}n.removeChild(t)}}function JB(n,e,t,i){for(;n.nodeType===1;){var s=t;if(n.nodeName.toLowerCase()!==e.toLowerCase()){if(!i&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(i){if(!n[Xy])switch(e){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(r=n.getAttribute("rel"),r==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(r!==s.rel||n.getAttribute("href")!==(s.href==null||s.href===""?null:s.href)||n.getAttribute("crossorigin")!==(s.crossOrigin==null?null:s.crossOrigin)||n.getAttribute("title")!==(s.title==null?null:s.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(r=n.getAttribute("src"),(r!==(s.src==null?null:s.src)||n.getAttribute("type")!==(s.type==null?null:s.type)||n.getAttribute("crossorigin")!==(s.crossOrigin==null?null:s.crossOrigin))&&r&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(e==="input"&&n.type==="hidden"){var r=s.name==null?null:""+s.name;if(s.type==="hidden"&&n.getAttribute("name")===r)return n}else return n;if(n=Hr(n.nextSibling),n===null)break}return null}function e8(n,e,t){if(e==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!t||(n=Hr(n.nextSibling),n===null))return null;return n}function _j(n,e){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!e||(n=Hr(n.nextSibling),n===null))return null;return n}function IS(n){return n.data==="$?"||n.data==="$~"}function PS(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function t8(n,e){var t=n.ownerDocument;if(n.data==="$~")n._reactRetry=e;else if(n.data!=="$?"||t.readyState!=="loading")e();else{var i=function(){e(),t.removeEventListener("DOMContentLoaded",i)};t.addEventListener("DOMContentLoaded",i),n._reactRetry=i}}function Hr(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?"||e==="$~"||e==="&"||e==="F!"||e==="F")break;if(e==="/$"||e==="/&")return null}}return n}var BS=null;function dk(n){n=n.nextSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"||t==="/&"){if(e===0)return Hr(n.nextSibling);e--}else t!=="$"&&t!=="$!"&&t!=="$?"&&t!=="$~"&&t!=="&"||e++}n=n.nextSibling}return null}function fk(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"){if(e===0)return n;e--}else t!=="/$"&&t!=="/&"||e++}n=n.previousSibling}return null}function Nj(n,e,t){switch(e=Eb(t),n){case"html":if(n=e.documentElement,!n)throw Error(Ee(452));return n;case"head":if(n=e.head,!n)throw Error(Ee(453));return n;case"body":if(n=e.body,!n)throw Error(Ee(454));return n;default:throw Error(Ee(451))}}function wm(n){for(var e=n.attributes;e.length;)n.removeAttributeNode(e[0]);VE(n)}var qr=new Map,pk=new Set;function Cb(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var kl=Ut.d;Ut.d={f:i8,r:n8,D:s8,C:r8,L:a8,m:o8,X:c8,S:l8,M:u8};function i8(){var n=kl.f(),e=z1();return n||e}function n8(n){var e=ag(n);e!==null&&e.tag===5&&e.type==="form"?b5(e):kl.r(n)}var ug=typeof document>"u"?null:document;function kj(n,e,t){var i=ug;if(i&&typeof e=="string"&&e){var s=Ir(e);s='link[rel="'+n+'"][href="'+s+'"]',typeof t=="string"&&(s+='[crossorigin="'+t+'"]'),pk.has(s)||(pk.add(s),n={rel:n,crossOrigin:t,href:e},i.querySelector(s)===null&&(e=i.createElement("link"),Pn(e,"link",n),xn(e),i.head.appendChild(e)))}}function s8(n){kl.D(n),kj("dns-prefetch",n,null)}function r8(n,e){kl.C(n,e),kj("preconnect",n,e)}function a8(n,e,t){kl.L(n,e,t);var i=ug;if(i&&n&&e){var s='link[rel="preload"][as="'+Ir(e)+'"]';e==="image"&&t&&t.imageSrcSet?(s+='[imagesrcset="'+Ir(t.imageSrcSet)+'"]',typeof t.imageSizes=="string"&&(s+='[imagesizes="'+Ir(t.imageSizes)+'"]')):s+='[href="'+Ir(n)+'"]';var r=s;switch(e){case"style":r=Yp(n);break;case"script":r=hg(n)}qr.has(r)||(n=yi({rel:"preload",href:e==="image"&&t&&t.imageSrcSet?void 0:n,as:e},t),qr.set(r,n),i.querySelector(s)!==null||e==="style"&&i.querySelector(tv(r))||e==="script"&&i.querySelector(iv(r))||(e=i.createElement("link"),Pn(e,"link",n),xn(e),i.head.appendChild(e)))}}function o8(n,e){kl.m(n,e);var t=ug;if(t&&n){var i=e&&typeof e.as=="string"?e.as:"script",s='link[rel="modulepreload"][as="'+Ir(i)+'"][href="'+Ir(n)+'"]',r=s;switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":r=hg(n)}if(!qr.has(r)&&(n=yi({rel:"modulepreload",href:n},e),qr.set(r,n),t.querySelector(s)===null)){switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(t.querySelector(iv(r)))return}i=t.createElement("link"),Pn(i,"link",n),xn(i),t.head.appendChild(i)}}}function l8(n,e,t){kl.S(n,e,t);var i=ug;if(i&&n){var s=tf(i).hoistableStyles,r=Yp(n);e=e||"default";var a=s.get(r);if(!a){var o={loading:0,preload:null};if(a=i.querySelector(tv(r)))o.loading=5;else{n=yi({rel:"stylesheet",href:n,"data-precedence":e},t),(t=qr.get(r))&&DC(n,t);var l=a=i.createElement("link");xn(l),Pn(l,"link",n),l._p=new Promise(function(u,d){l.onload=u,l.onerror=d}),l.addEventListener("load",function(){o.loading|=1}),l.addEventListener("error",function(){o.loading|=2}),o.loading|=4,lx(a,e,i)}a={type:"stylesheet",instance:a,count:1,state:o},s.set(r,a)}}}function c8(n,e){kl.X(n,e);var t=ug;if(t&&n){var i=tf(t).hoistableScripts,s=hg(n),r=i.get(s);r||(r=t.querySelector(iv(s)),r||(n=yi({src:n,async:!0},e),(e=qr.get(s))&&jC(n,e),r=t.createElement("script"),xn(r),Pn(r,"link",n),t.head.appendChild(r)),r={type:"script",instance:r,count:1,state:null},i.set(s,r))}}function u8(n,e){kl.M(n,e);var t=ug;if(t&&n){var i=tf(t).hoistableScripts,s=hg(n),r=i.get(s);r||(r=t.querySelector(iv(s)),r||(n=yi({src:n,async:!0,type:"module"},e),(e=qr.get(s))&&jC(n,e),r=t.createElement("script"),xn(r),Pn(r,"link",n),t.head.appendChild(r)),r={type:"script",instance:r,count:1,state:null},i.set(s,r))}}function gk(n,e,t,i){var s=(s=zc.current)?Cb(s):null;if(!s)throw Error(Ee(446));switch(n){case"meta":case"title":return null;case"style":return typeof t.precedence=="string"&&typeof t.href=="string"?(e=Yp(t.href),t=tf(s).hoistableStyles,i=t.get(e),i||(i={type:"style",instance:null,count:0,state:null},t.set(e,i)),i):{type:"void",instance:null,count:0,state:null};case"link":if(t.rel==="stylesheet"&&typeof t.href=="string"&&typeof t.precedence=="string"){n=Yp(t.href);var r=tf(s).hoistableStyles,a=r.get(n);if(a||(s=s.ownerDocument||s,a={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},r.set(n,a),(r=s.querySelector(tv(n)))&&!r._p&&(a.instance=r,a.state.loading=5),qr.has(n)||(t={rel:"preload",as:"style",href:t.href,crossOrigin:t.crossOrigin,integrity:t.integrity,media:t.media,hrefLang:t.hrefLang,referrerPolicy:t.referrerPolicy},qr.set(n,t),r||h8(s,n,t,a.state))),e&&i===null)throw Error(Ee(528,""));return a}if(e&&i!==null)throw Error(Ee(529,""));return null;case"script":return e=t.async,t=t.src,typeof t=="string"&&e&&typeof e!="function"&&typeof e!="symbol"?(e=hg(t),t=tf(s).hoistableScripts,i=t.get(e),i||(i={type:"script",instance:null,count:0,state:null},t.set(e,i)),i):{type:"void",instance:null,count:0,state:null};default:throw Error(Ee(444,n))}}function Yp(n){return'href="'+Ir(n)+'"'}function tv(n){return'link[rel="stylesheet"]['+n+"]"}function Tj(n){return yi({},n,{"data-precedence":n.precedence,precedence:null})}function h8(n,e,t,i){n.querySelector('link[rel="preload"][as="style"]['+e+"]")?i.loading=1:(e=n.createElement("link"),i.preload=e,e.addEventListener("load",function(){return i.loading|=1}),e.addEventListener("error",function(){return i.loading|=2}),Pn(e,"link",t),xn(e),n.head.appendChild(e))}function hg(n){return'[src="'+Ir(n)+'"]'}function iv(n){return"script[async]"+n}function mk(n,e,t){if(e.count++,e.instance===null)switch(e.type){case"style":var i=n.querySelector('style[data-href~="'+Ir(t.href)+'"]');if(i)return e.instance=i,xn(i),i;var s=yi({},t,{"data-href":t.href,"data-precedence":t.precedence,href:null,precedence:null});return i=(n.ownerDocument||n).createElement("style"),xn(i),Pn(i,"style",s),lx(i,t.precedence,n),e.instance=i;case"stylesheet":s=Yp(t.href);var r=n.querySelector(tv(s));if(r)return e.state.loading|=4,e.instance=r,xn(r),r;i=Tj(t),(s=qr.get(s))&&DC(i,s),r=(n.ownerDocument||n).createElement("link"),xn(r);var a=r;return a._p=new Promise(function(o,l){a.onload=o,a.onerror=l}),Pn(r,"link",i),e.state.loading|=4,lx(r,t.precedence,n),e.instance=r;case"script":return r=hg(t.src),(s=n.querySelector(iv(r)))?(e.instance=s,xn(s),s):(i=t,(s=qr.get(r))&&(i=yi({},t),jC(i,s)),n=n.ownerDocument||n,s=n.createElement("script"),xn(s),Pn(s,"link",i),n.head.appendChild(s),e.instance=s);case"void":return null;default:throw Error(Ee(443,e.type))}else e.type==="stylesheet"&&!(e.state.loading&4)&&(i=e.instance,e.state.loading|=4,lx(i,t.precedence,n));return e.instance}function lx(n,e,t){for(var i=t.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),s=i.length?i[i.length-1]:null,r=s,a=0;a<i.length;a++){var o=i[a];if(o.dataset.precedence===e)r=o;else if(r!==s)break}r?r.parentNode.insertBefore(n,r.nextSibling):(e=t.nodeType===9?t.head:t,e.insertBefore(n,e.firstChild))}function DC(n,e){n.crossOrigin==null&&(n.crossOrigin=e.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=e.referrerPolicy),n.title==null&&(n.title=e.title)}function jC(n,e){n.crossOrigin==null&&(n.crossOrigin=e.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=e.referrerPolicy),n.integrity==null&&(n.integrity=e.integrity)}var cx=null;function yk(n,e,t){if(cx===null){var i=new Map,s=cx=new Map;s.set(t,i)}else s=cx,i=s.get(t),i||(i=new Map,s.set(t,i));if(i.has(n))return i;for(i.set(n,null),t=t.getElementsByTagName(n),s=0;s<t.length;s++){var r=t[s];if(!(r[Xy]||r[Ln]||n==="link"&&r.getAttribute("rel")==="stylesheet")&&r.namespaceURI!=="http://www.w3.org/2000/svg"){var a=r.getAttribute(e)||"";a=n+a;var o=i.get(a);o?o.push(r):i.set(a,[r])}}return i}function vk(n,e,t){n=n.ownerDocument||n,n.head.insertBefore(t,e==="title"?n.querySelector("head > title"):null)}function d8(n,e,t){if(t===1||e.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof e.precedence!="string"||typeof e.href!="string"||e.href==="")break;return!0;case"link":if(typeof e.rel!="string"||typeof e.href!="string"||e.href===""||e.onLoad||e.onError)break;switch(e.rel){case"stylesheet":return n=e.disabled,typeof e.precedence=="string"&&n==null;default:return!0}case"script":if(e.async&&typeof e.async!="function"&&typeof e.async!="symbol"&&!e.onLoad&&!e.onError&&e.src&&typeof e.src=="string")return!0}return!1}function Dj(n){return!(n.type==="stylesheet"&&!(n.state.loading&3))}function f8(n,e,t,i){if(t.type==="stylesheet"&&(typeof i.media!="string"||matchMedia(i.media).matches!==!1)&&!(t.state.loading&4)){if(t.instance===null){var s=Yp(i.href),r=e.querySelector(tv(s));if(r){e=r._p,e!==null&&typeof e=="object"&&typeof e.then=="function"&&(n.count++,n=_b.bind(n),e.then(n,n)),t.state.loading|=4,t.instance=r,xn(r);return}r=e.ownerDocument||e,i=Tj(i),(s=qr.get(s))&&DC(i,s),r=r.createElement("link"),xn(r);var a=r;a._p=new Promise(function(o,l){a.onload=o,a.onerror=l}),Pn(r,"link",i),t.instance=r}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(t,e),(e=t.state.preload)&&!(t.state.loading&3)&&(n.count++,t=_b.bind(n),e.addEventListener("load",t),e.addEventListener("error",t))}}var u2=0;function p8(n,e){return n.stylesheets&&n.count===0&&ux(n,n.stylesheets),0<n.count||0<n.imgCount?function(t){var i=setTimeout(function(){if(n.stylesheets&&ux(n,n.stylesheets),n.unsuspend){var r=n.unsuspend;n.unsuspend=null,r()}},6e4+e);0<n.imgBytes&&u2===0&&(u2=62500*WB());var s=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&ux(n,n.stylesheets),n.unsuspend)){var r=n.unsuspend;n.unsuspend=null,r()}},(n.imgBytes>u2?50:800)+e);return n.unsuspend=t,function(){n.unsuspend=null,clearTimeout(i),clearTimeout(s)}}:null}function _b(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)ux(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var Nb=null;function ux(n,e){n.stylesheets=null,n.unsuspend!==null&&(n.count++,Nb=new Map,e.forEach(g8,n),Nb=null,_b.call(n))}function g8(n,e){if(!(e.state.loading&4)){var t=Nb.get(n);if(t)var i=t.get(null);else{t=new Map,Nb.set(n,t);for(var s=n.querySelectorAll("link[data-precedence],style[data-precedence]"),r=0;r<s.length;r++){var a=s[r];(a.nodeName==="LINK"||a.getAttribute("media")!=="not all")&&(t.set(a.dataset.precedence,a),i=a)}i&&t.set(null,i)}s=e.instance,a=s.getAttribute("data-precedence"),r=t.get(a)||i,r===i&&t.set(null,s),t.set(a,s),this.count++,i=_b.bind(this),s.addEventListener("load",i),s.addEventListener("error",i),r?r.parentNode.insertBefore(s,r.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(s,n.firstChild)),e.state.loading|=4}}var Om={$$typeof:il,Provider:null,Consumer:null,_currentValue:Lh,_currentValue2:Lh,_threadCount:0};function m8(n,e,t,i,s,r,a,o,l){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Lw(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Lw(0),this.hiddenUpdates=Lw(null),this.identifierPrefix=i,this.onUncaughtError=s,this.onCaughtError=r,this.onRecoverableError=a,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=l,this.incompleteTransitions=new Map}function jj(n,e,t,i,s,r,a,o,l,u,d,f){return n=new m8(n,e,t,a,l,u,d,f,o),e=1,r===!0&&(e|=24),r=nr(3,null,null,e),n.current=r,r.stateNode=n,e=nC(),e.refCount++,n.pooledCache=e,e.refCount++,r.memoizedState={element:i,isDehydrated:t,cache:e},aC(r),n}function Rj(n){return n?(n=qd,n):qd}function Lj(n,e,t,i,s,r){s=Rj(s),i.context===null?i.context=s:i.pendingContext=s,i=Hc(e),i.payload={element:t},r=r===void 0?null:r,r!==null&&(i.callback=r),t=$c(n,i,e),t!==null&&(Cs(t,n,e),fm(t,n,e))}function xk(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function RC(n,e){xk(n,e),(n=n.alternate)&&xk(n,e)}function Mj(n){if(n.tag===13||n.tag===31){var e=Qh(n,67108864);e!==null&&Cs(e,n,67108864),RC(n,67108864)}}function bk(n){if(n.tag===13||n.tag===31){var e=cr();e=$E(e);var t=Qh(n,e);t!==null&&Cs(t,n,e),RC(n,e)}}var kb=!0;function y8(n,e,t,i){var s=ot.T;ot.T=null;var r=Ut.p;try{Ut.p=2,LC(n,e,t,i)}finally{Ut.p=r,ot.T=s}}function v8(n,e,t,i){var s=ot.T;ot.T=null;var r=Ut.p;try{Ut.p=8,LC(n,e,t,i)}finally{Ut.p=r,ot.T=s}}function LC(n,e,t,i){if(kb){var s=FS(i);if(s===null)l2(n,e,i,Tb,t),wk(n,i);else if(b8(s,n,e,t,i))i.stopPropagation();else if(wk(n,i),e&4&&-1<x8.indexOf(n)){for(;s!==null;){var r=ag(s);if(r!==null)switch(r.tag){case 3:if(r=r.stateNode,r.current.memoizedState.isDehydrated){var a=hu(r.pendingLanes);if(a!==0){var o=r;for(o.pendingLanes|=2,o.entangledLanes|=2;a;){var l=1<<31-lr(a);o.entanglements[1]|=l,a&=~l}so(r),!(Ft&6)&&(vb=ar()+500,ev(0))}}break;case 31:case 13:o=Qh(r,2),o!==null&&Cs(o,r,2),z1(),RC(r,2)}if(r=FS(i),r===null&&l2(n,e,i,Tb,t),r===s)break;s=r}s!==null&&i.stopPropagation()}else l2(n,e,i,null,t)}}function FS(n){return n=YE(n),MC(n)}var Tb=null;function MC(n){if(Tb=null,n=Bd(n),n!==null){var e=Vy(n);if(e===null)n=null;else{var t=e.tag;if(t===13){if(n=e3(e),n!==null)return n;n=null}else if(t===31){if(n=t3(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null)}}return Tb=n,null}function Oj(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(sP()){case r3:return 2;case a3:return 8;case sb:case rP:return 32;case o3:return 268435456;default:return 32}default:return 32}}var zS=!1,Gc=null,Yc=null,Wc=null,Im=new Map,Pm=new Map,Pl=[],x8="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function wk(n,e){switch(n){case"focusin":case"focusout":Gc=null;break;case"dragenter":case"dragleave":Yc=null;break;case"mouseover":case"mouseout":Wc=null;break;case"pointerover":case"pointerout":Im.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pm.delete(e.pointerId)}}function Ag(n,e,t,i,s,r){return n===null||n.nativeEvent!==r?(n={blockedOn:e,domEventName:t,eventSystemFlags:i,nativeEvent:r,targetContainers:[s]},e!==null&&(e=ag(e),e!==null&&Mj(e)),n):(n.eventSystemFlags|=i,e=n.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),n)}function b8(n,e,t,i,s){switch(e){case"focusin":return Gc=Ag(Gc,n,e,t,i,s),!0;case"dragenter":return Yc=Ag(Yc,n,e,t,i,s),!0;case"mouseover":return Wc=Ag(Wc,n,e,t,i,s),!0;case"pointerover":var r=s.pointerId;return Im.set(r,Ag(Im.get(r)||null,n,e,t,i,s)),!0;case"gotpointercapture":return r=s.pointerId,Pm.set(r,Ag(Pm.get(r)||null,n,e,t,i,s)),!0}return!1}function Ij(n){var e=Bd(n.target);if(e!==null){var t=Vy(e);if(t!==null){if(e=t.tag,e===13){if(e=e3(t),e!==null){n.blockedOn=e,rN(n.priority,function(){bk(t)});return}}else if(e===31){if(e=t3(t),e!==null){n.blockedOn=e,rN(n.priority,function(){bk(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function hx(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=FS(n.nativeEvent);if(t===null){t=n.nativeEvent;var i=new t.constructor(t.type,t);sS=i,t.target.dispatchEvent(i),sS=null}else return e=ag(t),e!==null&&Mj(e),n.blockedOn=t,!1;e.shift()}return!0}function Sk(n,e,t){hx(n)&&t.delete(e)}function w8(){zS=!1,Gc!==null&&hx(Gc)&&(Gc=null),Yc!==null&&hx(Yc)&&(Yc=null),Wc!==null&&hx(Wc)&&(Wc=null),Im.forEach(Sk),Pm.forEach(Sk)}function Ov(n,e){n.blockedOn===e&&(n.blockedOn=null,zS||(zS=!0,ln.unstable_scheduleCallback(ln.unstable_NormalPriority,w8)))}var Iv=null;function Ak(n){Iv!==n&&(Iv=n,ln.unstable_scheduleCallback(ln.unstable_NormalPriority,function(){Iv===n&&(Iv=null);for(var e=0;e<n.length;e+=3){var t=n[e],i=n[e+1],s=n[e+2];if(typeof i!="function"){if(MC(i||t)===null)continue;break}var r=ag(t);r!==null&&(n.splice(e,3),e-=3,bS(r,{pending:!0,data:s,method:t.method,action:i},i,s))}}))}function Wp(n){function e(l){return Ov(l,n)}Gc!==null&&Ov(Gc,n),Yc!==null&&Ov(Yc,n),Wc!==null&&Ov(Wc,n),Im.forEach(e),Pm.forEach(e);for(var t=0;t<Pl.length;t++){var i=Pl[t];i.blockedOn===n&&(i.blockedOn=null)}for(;0<Pl.length&&(t=Pl[0],t.blockedOn===null);)Ij(t),t.blockedOn===null&&Pl.shift();if(t=(n.ownerDocument||n).$$reactFormReplay,t!=null)for(i=0;i<t.length;i+=3){var s=t[i],r=t[i+1],a=s[Ns]||null;if(typeof r=="function")a||Ak(t);else if(a){var o=null;if(r&&r.hasAttribute("formAction")){if(s=r,a=r[Ns]||null)o=a.formAction;else if(MC(s)!==null)continue}else o=a.action;typeof o=="function"?t[i+1]=o:(t.splice(i,3),i-=3),Ak(t)}}}function Pj(){function n(r){r.canIntercept&&r.info==="react-transition"&&r.intercept({handler:function(){return new Promise(function(a){return s=a})},focusReset:"manual",scroll:"manual"})}function e(){s!==null&&(s(),s=null),i||setTimeout(t,20)}function t(){if(!i&&!navigation.transition){var r=navigation.currentEntry;r&&r.url!=null&&navigation.navigate(r.url,{state:r.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var i=!1,s=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",e),navigation.addEventListener("navigateerror",e),setTimeout(t,100),function(){i=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",e),navigation.removeEventListener("navigateerror",e),s!==null&&(s(),s=null)}}}function OC(n){this._internalRoot=n}$1.prototype.render=OC.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(Ee(409));var t=e.current,i=cr();Lj(t,i,n,e,null,null)};$1.prototype.unmount=OC.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;Lj(n.current,2,null,n,null,null),z1(),e[rg]=null}};function $1(n){this._internalRoot=n}$1.prototype.unstable_scheduleHydration=function(n){if(n){var e=d3();n={blockedOn:null,target:n,priority:e};for(var t=0;t<Pl.length&&e!==0&&e<Pl[t].priority;t++);Pl.splice(t,0,n),t===0&&Ij(n)}};var Ek=QD.version;if(Ek!=="19.2.4")throw Error(Ee(527,Ek,"19.2.4"));Ut.findDOMNode=function(n){var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(Ee(188)):(n=Object.keys(n).join(","),Error(Ee(268,n)));return n=ZI(e),n=n!==null?i3(n):null,n=n===null?null:n.stateNode,n};var S8={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:ot,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Pv=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Pv.isDisabled&&Pv.supportsFiber)try{Gy=Pv.inject(S8),or=Pv}catch{}}_1.createRoot=function(n,e){if(!JD(n))throw Error(Ee(299));var t=!1,i="",s=k5,r=T5,a=D5;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onUncaughtError!==void 0&&(s=e.onUncaughtError),e.onCaughtError!==void 0&&(r=e.onCaughtError),e.onRecoverableError!==void 0&&(a=e.onRecoverableError)),e=jj(n,1,!1,null,null,t,i,null,s,r,a,Pj),n[rg]=e.current,TC(n),new OC(e)};_1.hydrateRoot=function(n,e,t){if(!JD(n))throw Error(Ee(299));var i=!1,s="",r=k5,a=T5,o=D5,l=null;return t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onUncaughtError!==void 0&&(r=t.onUncaughtError),t.onCaughtError!==void 0&&(a=t.onCaughtError),t.onRecoverableError!==void 0&&(o=t.onRecoverableError),t.formState!==void 0&&(l=t.formState)),e=jj(n,1,!0,e,t??null,i,s,l,r,a,o,Pj),e.context=Rj(null),t=e.current,i=cr(),i=$E(i),s=Hc(i),s.callback=null,$c(t,s,i),t=i,e.current.lanes=t,Wy(e,t),so(e),n[rg]=e.current,TC(n),new $1(e)};_1.version="19.2.4";function Bj(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Bj)}catch(n){console.error(n)}}Bj(),GD.exports=_1;var A8=GD.exports,Fj={exports:{}},q1={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var E8=Symbol.for("react.transitional.element"),C8=Symbol.for("react.fragment");function zj(n,e,t){var i=null;if(t!==void 0&&(i=""+t),e.key!==void 0&&(i=""+e.key),"key"in e){t={};for(var s in e)s!=="key"&&(t[s]=e[s])}else t=e;return e=t.ref,{$$typeof:E8,type:n,key:i,ref:e!==void 0?e:null,props:t}}q1.Fragment=C8;q1.jsx=zj;q1.jsxs=zj;Fj.exports=q1;var h=Fj.exports;/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uj=(...n)=>n.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _8=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N8=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase());/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ck=n=>{const e=N8(n);return e.charAt(0).toUpperCase()+e.slice(1)};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var k8={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T8=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0;return!1};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D8=E.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:s="",children:r,iconNode:a,...o},l)=>E.createElement("svg",{ref:l,...k8,width:e,height:e,stroke:n,strokeWidth:i?Number(t)*24/Number(e):t,className:Uj("lucide",s),...!r&&!T8(o)&&{"aria-hidden":"true"},...o},[...a.map(([u,d])=>E.createElement(u,d)),...Array.isArray(r)?r:[r]]));/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=(n,e)=>{const t=E.forwardRef(({className:i,...s},r)=>E.createElement(D8,{ref:r,iconNode:e,className:Uj(`lucide-${_8(Ck(n))}`,`lucide-${n}`,i),...s}));return t.displayName=Ck(n),t};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j8=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],R8=Ne("activity",j8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L8=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],Xp=Ne("archive",L8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M8=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],O8=Ne("arrow-down",M8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I8=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],V1=Ne("arrow-left",I8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P8=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],B8=Ne("arrow-right",P8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F8=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],h2=Ne("arrow-up-down",F8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z8=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],U8=Ne("arrow-up",z8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H8=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["path",{d:"M20.2 20.2c2.04-2.03.02-7.36-4.5-11.9-4.54-4.52-9.87-6.54-11.9-4.5-2.04 2.03-.02 7.36 4.5 11.9 4.54 4.52 9.87 6.54 11.9 4.5Z",key:"1l2ple"}],["path",{d:"M15.7 15.7c4.52-4.54 6.54-9.87 4.5-11.9-2.03-2.04-7.36-.02-11.9 4.5-4.52 4.54-6.54 9.87-4.5 11.9 2.03 2.04 7.36.02 11.9-4.5Z",key:"1wam0m"}]],$8=Ne("atom",H8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q8=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],Ja=Ne("book-open",q8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V8=[["path",{d:"M12 7v6",key:"lw1j43"}],["path",{d:"M15 10H9",key:"o6yqo3"}],["path",{d:"M17 3a2 2 0 0 1 2 2v15a1 1 0 0 1-1.496.868l-4.512-2.578a2 2 0 0 0-1.984 0l-4.512 2.578A1 1 0 0 1 5 20V5a2 2 0 0 1 2-2z",key:"oz39mx"}]],Hj=Ne("bookmark-plus",V8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G8=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],Y8=Ne("brain",G8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W8=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],$j=Ne("building-2",W8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X8=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Bm=Ne("calendar",X8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K8=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],Z8=Ne("camera",K8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q8=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],nv=Ne("check",Q8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J8=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],sv=Ne("chevron-down",J8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eF=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],tF=Ne("chevron-left",eF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iF=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],G1=Ne("chevron-right",iF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nF=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Y1=Ne("circle-alert",nF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sF=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],rF=Ne("circle-check-big",sF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aF=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],qj=Ne("circle-check",aF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oF=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],lF=Ne("circle-question-mark",oF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cF=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],IC=Ne("circle-x",cF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uF=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Vr=Ne("clock",uF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hF=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],dF=Ne("code",hF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fF=[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],PC=Ne("compass",fF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pF=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],rv=Ne("copy",pF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gF=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],mF=Ne("dollar-sign",gF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yF=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],vl=Ne("download",yF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vF=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],Vj=Ne("ellipsis",vF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xF=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],W1=Ne("external-link",xF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bF=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],wF=Ne("eye-off",bF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SF=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],AF=Ne("eye",SF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EF=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],xl=Ne("file-text",EF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CF=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M11 18h2",key:"12mj7e"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"M9 13v-.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 .5.5v.5",key:"qbrxap"}]],_F=Ne("file-type",CF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NF=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]],kF=Ne("file-up",NF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TF=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]],_k=Ne("flame",TF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DF=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],jF=Ne("folder-open",DF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RF=[["line",{x1:"6",x2:"10",y1:"11",y2:"11",key:"1gktln"}],["line",{x1:"8",x2:"8",y1:"9",y2:"13",key:"qnk9ow"}],["line",{x1:"15",x2:"15.01",y1:"12",y2:"12",key:"krot7o"}],["line",{x1:"18",x2:"18.01",y1:"10",y2:"10",key:"1lcuu1"}],["path",{d:"M17.32 5H6.68a4 4 0 0 0-3.978 3.59c-.006.052-.01.101-.017.152C2.604 9.416 2 14.456 2 16a3 3 0 0 0 3 3c1 0 1.5-.5 2-1l1.414-1.414A2 2 0 0 1 9.828 16h4.344a2 2 0 0 1 1.414.586L17 18c.5.5 1 1 2 1a3 3 0 0 0 3-3c0-1.545-.604-6.584-.685-7.258-.007-.05-.011-.1-.017-.151A4 4 0 0 0 17.32 5z",key:"mfqc10"}]],Nk=Ne("gamepad-2",RF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LF=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],ed=Ne("globe",LF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MF=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],Gj=Ne("graduation-cap",MF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OF=[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]],Yj=Ne("hard-drive",OF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IF=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],Wj=Ne("hash",IF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PF=[["path",{d:"m9 11-6 6v3h9l3-3",key:"1a3l36"}],["path",{d:"m22 12-4.6 4.6a2 2 0 0 1-2.8 0l-5.2-5.2a2 2 0 0 1 0-2.8L14 4",key:"14a9rk"}]],av=Ne("highlighter",PF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BF=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],Xj=Ne("image",BF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FF=[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]],US=Ne("inbox",FF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zF=[["path",{d:"M10 8h.01",key:"1r9ogq"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M14 8h.01",key:"1primd"}],["path",{d:"M16 12h.01",key:"1l6xoz"}],["path",{d:"M18 8h.01",key:"emo2bl"}],["path",{d:"M6 8h.01",key:"x9i8wu"}],["path",{d:"M7 16h10",key:"wp8him"}],["path",{d:"M8 12h.01",key:"czm47f"}],["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}]],UF=Ne("keyboard",zF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HF=[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]],$F=Ne("languages",HF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qF=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],VF=Ne("layers",qF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GF=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],YF=Ne("layout-grid",GF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WF=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],XF=Ne("lightbulb",WF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KF=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],Kj=Ne("link",KF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZF=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],QF=Ne("list",ZF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JF=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],xt=Ne("loader-circle",JF);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ez=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],HS=Ne("mail",ez);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tz=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}],["path",{d:"M7 11h10",key:"1twpyw"}],["path",{d:"M7 15h6",key:"d9of3u"}],["path",{d:"M7 7h8",key:"af5zfr"}]],Zj=Ne("message-square-text",tz);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iz=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],Fm=Ne("message-square",iz);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nz=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]],dx=Ne("mic",nz);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sz=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],rz=Ne("music",sz);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const az=[["path",{d:"M15 18h-5",key:"95g1m2"}],["path",{d:"M18 14h-8",key:"sponae"}],["path",{d:"M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-4 0v-9a2 2 0 0 1 2-2h2",key:"39pd36"}],["rect",{width:"8",height:"4",x:"10",y:"6",rx:"1",key:"aywv1n"}]],kk=Ne("newspaper",az);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oz=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"m16 15-3-3 3-3",key:"14y99z"}]],BC=Ne("panel-left-close",oz);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lz=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"m14 9 3 3-3 3",key:"8010ee"}]],Qj=Ne("panel-left-open",lz);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cz=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}]],uz=Ne("panel-left",cz);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hz=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}],["path",{d:"m8 9 3 3-3 3",key:"12hl5m"}]],X1=Ne("panel-right-close",hz);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dz=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}],["path",{d:"m10 15-3-3 3-3",key:"1pgupc"}]],K1=Ne("panel-right-open",dz);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fz=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],pz=Ne("pause",fz);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gz=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Jj=Ne("pencil",gz);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mz=[["path",{d:"M12 17v5",key:"bb1du9"}],["path",{d:"M15 9.34V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H7.89",key:"znwnzq"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M9 9v1.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h11",key:"c9qhm2"}]],yz=Ne("pin-off",mz);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vz=[["path",{d:"M12 17v5",key:"bb1du9"}],["path",{d:"M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H8a2 2 0 0 0 0 4 1 1 0 0 1 1 1z",key:"1nkz8b"}]],eR=Ne("pin",vz);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xz=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],bz=Ne("play",xz);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wz=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],bl=Ne("plus",wz);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sz=[["path",{d:"M13 17a1 1 0 1 0-2 0l.5 4.5a0.5 0.5 0 0 0 1 0z",fill:"currentColor",key:"x1mxqr"}],["path",{d:"M16.85 18.58a9 9 0 1 0-9.7 0",key:"d71mpg"}],["path",{d:"M8 14a5 5 0 1 1 8 0",key:"fc81rn"}],["circle",{cx:"12",cy:"11",r:"1",fill:"currentColor",key:"vqiwd"}]],FC=Ne("podcast",Sz);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Az=[["path",{d:"M16.247 7.761a6 6 0 0 1 0 8.478",key:"1fwjs5"}],["path",{d:"M19.075 4.933a10 10 0 0 1 0 14.134",key:"ehdyv1"}],["path",{d:"M4.925 19.067a10 10 0 0 1 0-14.134",key:"1q22gi"}],["path",{d:"M7.753 16.239a6 6 0 0 1 0-8.478",key:"r2q7qm"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],Ez=Ne("radio",Az);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cz=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Kp=Ne("refresh-cw",Cz);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _z=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],tR=Ne("rotate-ccw",_z);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nz=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],kz=Ne("rotate-cw",Nz);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tz=[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]],Dz=Ne("route",Tz);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jz=[["path",{d:"M4 11a9 9 0 0 1 9 9",key:"pv89mb"}],["path",{d:"M4 4a16 16 0 0 1 16 16",key:"k0647b"}],["circle",{cx:"5",cy:"19",r:"1",key:"bfqh0e"}]],ru=Ne("rss",jz);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rz=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Tk=Ne("save",Rz);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lz=[["path",{d:"M15 12h-5",key:"r7krc0"}],["path",{d:"M15 8h-5",key:"1khuty"}],["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",key:"1ph1d7"}]],Mz=Ne("scroll-text",Lz);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oz=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],dg=Ne("search",Oz);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iz=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Pz=Ne("send",Iz);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bz=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],Db=Ne("settings-2",Bz);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fz=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],zC=Ne("settings",Fz);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zz=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],Uz=Ne("share-2",zz);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hz=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],$z=Ne("shopping-cart",Hz);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qz=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],jb=Ne("sparkles",qz);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vz=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],UC=Ne("star",Vz);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gz=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],Z1=Ne("tag",Gz);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yz=[["path",{d:"M13.172 2a2 2 0 0 1 1.414.586l6.71 6.71a2.4 2.4 0 0 1 0 3.408l-4.592 4.592a2.4 2.4 0 0 1-3.408 0l-6.71-6.71A2 2 0 0 1 6 9.172V3a1 1 0 0 1 1-1z",key:"16rjxf"}],["path",{d:"M2 7v6.172a2 2 0 0 0 .586 1.414l6.71 6.71a2.4 2.4 0 0 0 3.191.193",key:"178nd4"}],["circle",{cx:"10.5",cy:"6.5",r:".5",fill:"currentColor",key:"12ikhr"}]],Wz=Ne("tags",Yz);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xz=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],rs=Ne("trash-2",Xz);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kz=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],d2=Ne("trending-up",Kz);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zz=[["path",{d:"m17 2-5 5-5-5",key:"16satq"}],["rect",{width:"20",height:"15",x:"2",y:"7",rx:"2",key:"1e6viu"}]],Dk=Ne("tv",Zz);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qz=[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]],Jz=Ne("twitter",Qz);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eU=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],iR=Ne("upload",eU);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tU=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],ov=Ne("user",tU);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iU=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],jk=Ne("users",iU);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nU=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],sU=Ne("video",nU);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rU=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],aU=Ne("volume-2",rU);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oU=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]],lU=Ne("volume-x",oU);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cU=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Fn=Ne("x",cU);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uU=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],hU=Ne("zap",uU);function un({icon:n,label:e,active:t,collapsed:i,count:s,onClick:r}){return h.jsxs("button",{onClick:r,className:`
        relative flex items-center gap-3 w-full px-3 py-2 rounded-md text-[13px]
        transition-colors duration-150 cursor-pointer outline-none
        ${t?"text-white bg-white/[0.08]":"text-gray-400 hover:bg-white/5 hover:text-gray-200"}
      `,title:i?e:void 0,children:[t&&h.jsx("span",{className:"absolute left-0 top-1/2 -translate-y-1/2 w-[3px] h-4 rounded-r-full bg-blue-500"}),h.jsx("span",{className:"shrink-0",children:n}),!i&&h.jsxs(h.Fragment,{children:[h.jsx("span",{className:"flex-1 text-left truncate",children:e}),s!==void 0&&h.jsx("span",{className:"text-xs text-gray-500",children:s})]})]})}function f2({label:n,collapsed:e,expanded:t,onToggle:i}){return e?h.jsx("div",{className:"my-2 border-t border-white/5"}):h.jsxs("button",{onClick:i,className:"flex items-center gap-1.5 w-full px-3 pt-5 pb-1.5 text-[11px] font-medium uppercase tracking-wider text-gray-500 hover:text-gray-400 transition-colors cursor-pointer outline-none",children:[t?h.jsx(sv,{size:12}):h.jsx(G1,{size:12}),h.jsx("span",{children:n})]})}function dU({collapsed:n,onToggleCollapse:e,activeView:t,onViewChange:i,onAddFeed:s,onAddUrl:r,onSearch:a,onShortcutsHelp:o,onDownloads:l,onPreferences:u,selectedFeedId:d,onFeedSelect:f,selectedTagId:p,onTagSelect:g,refreshTrigger:x}){const{t:w}=Sn(),y=18,[m,v]=E.useState({library:!0,feed:!0,pinned:!0}),[b,A]=E.useState({}),[S,C]=E.useState([]),[k,L]=E.useState(!1);E.useEffect(()=>{(async()=>{try{const P=await window.electronAPI.feedList(),H={};P.forEach(G=>{const $=G.category||"uncategorized";H[$]||(H[$]=[]),H[$].push(G)}),A(H)}catch(P){console.error("Failed to load feeds:",P)}})()},[x]),E.useEffect(()=>{(async()=>{try{const P=await window.electronAPI.tagList();C(P)}catch(P){console.error("Failed to load tags:",P)}})()},[t]);const D=j=>{v(P=>({...P,[j]:!P[j]}))};return h.jsx("aside",{className:`
        flex flex-col h-full border-r border-white/5 bg-[#111111]
        transition-[width] duration-200 shrink-0 overflow-hidden
        ${n?"w-0 border-r-0":"w-[220px]"}
      `,children:h.jsxs("div",{className:`flex flex-col h-full min-w-[220px] ${n?"opacity-0":"opacity-100"}`,children:[h.jsxs("div",{className:"flex items-center justify-between px-3 py-1.5 shrink-0",children:[!n&&h.jsx("span",{className:"text-xs font-medium text-gray-500 tracking-tight",children:w("app.name")}),h.jsxs("div",{className:"flex items-center gap-1 ml-auto",children:[h.jsx("button",{onClick:r,className:"p-1 rounded hover:bg-white/10 text-gray-400 hover:text-white transition-colors cursor-pointer",title:w("sidebar.saveUrl"),children:h.jsx(Kj,{size:16})}),h.jsx("button",{onClick:s,className:"p-1 rounded hover:bg-white/10 text-gray-400 hover:text-white transition-colors cursor-pointer",title:w("sidebar.addFeed"),children:h.jsx(bl,{size:16})}),h.jsx("button",{onClick:e,className:"p-1 rounded hover:bg-white/10 text-gray-400 hover:text-white transition-colors cursor-pointer",children:n?h.jsx(uz,{size:16}):h.jsx(BC,{size:16})})]})]}),h.jsxs("nav",{className:"flex-1 overflow-y-auto px-2 mt-1",children:[h.jsx(f2,{label:w("sidebar.library"),collapsed:n,expanded:m.library,onToggle:()=>D("library")}),(n||m.library)&&h.jsxs(h.Fragment,{children:[h.jsx(un,{icon:h.jsx(xl,{size:y}),label:w("sidebar.articles"),active:t==="library-articles",collapsed:n,onClick:()=>i("library-articles")}),h.jsx(un,{icon:h.jsx(Ja,{size:y}),label:w("sidebar.books"),active:t==="books",collapsed:n,onClick:()=>i("books")}),h.jsx(un,{icon:h.jsx(HS,{size:y}),label:w("sidebar.emails"),active:t==="library-emails",collapsed:n,onClick:()=>i("library-emails")}),h.jsx(un,{icon:h.jsx(_F,{size:y}),label:w("sidebar.pdfs"),active:t==="library-pdfs",collapsed:n,onClick:()=>i("library-pdfs")}),h.jsx(un,{icon:h.jsx(Jz,{size:y}),label:w("sidebar.tweets"),active:t==="library-tweets",collapsed:n,onClick:()=>i("library-tweets")}),h.jsx(un,{icon:h.jsx(sU,{size:y}),label:w("sidebar.videos"),active:t==="library-videos",collapsed:n,onClick:()=>i("library-videos")}),h.jsx(un,{icon:h.jsx(FC,{size:y}),label:w("sidebar.podcasts"),active:t==="library-podcasts",collapsed:n,onClick:()=>i("library-podcasts")}),h.jsx(un,{icon:h.jsx(Z1,{size:y}),label:w("sidebar.tags"),active:t==="tags"&&!p,collapsed:n,onClick:()=>{L(!k),i("tags"),g==null||g(null)}}),!n&&k&&S.map(j=>h.jsxs("button",{onClick:()=>{g==null||g(j.id),i("tags")},className:`
                  relative flex items-center gap-2 w-full pl-6 pr-3 py-1.5 rounded-md text-[12px]
                  transition-colors duration-150 cursor-pointer outline-none
                  ${p===j.id?"text-white bg-white/[0.08]":"text-gray-400 hover:bg-white/5 hover:text-gray-200"}
                `,children:[p===j.id&&h.jsx("span",{className:"absolute left-0 top-1/2 -translate-y-1/2 w-[3px] h-4 rounded-r-full bg-blue-500"}),h.jsx("span",{className:"flex-1 text-left truncate",children:j.name}),j.articleCount!==void 0&&h.jsx("span",{className:"text-[10px] text-gray-600",children:j.articleCount})]},j.id))]}),h.jsx(f2,{label:w("sidebar.feed"),collapsed:n,expanded:m.feed,onToggle:()=>D("feed")}),(n||m.feed)&&h.jsxs(h.Fragment,{children:[h.jsx(un,{icon:h.jsx(PC,{size:y}),label:w("sidebar.discover"),active:t==="discover",collapsed:n,onClick:()=>i("discover")}),h.jsx(un,{icon:h.jsx(ru,{size:y}),label:w("sidebar.allFeeds"),active:t==="feeds"&&d===null,collapsed:n,onClick:()=>{i("feeds"),f(null)}}),!n&&Object.values(b).flat().filter(j=>j.pinned).map(j=>{var H;const P=j.favicon?h.jsx("img",{src:j.favicon,alt:"",className:"w-4 h-4 rounded"}):h.jsx("div",{className:"w-4 h-4 rounded bg-gray-700 flex items-center justify-center text-[10px] text-gray-400",children:((H=j.title)==null?void 0:H.charAt(0).toUpperCase())||"F"});return h.jsxs("button",{onClick:()=>{f(j.id),i("feeds")},className:`
                    group relative flex items-center gap-2 w-full px-3 py-1.5 rounded-md text-[12px]
                    transition-colors duration-150 cursor-pointer outline-none
                    ${d===j.id?"text-white bg-white/[0.08]":"text-gray-400 hover:bg-white/5 hover:text-gray-200"}
                  `,title:j.title||j.url,children:[d===j.id&&h.jsx("span",{className:"absolute left-0 top-1/2 -translate-y-1/2 w-[3px] h-4 rounded-r-full bg-blue-500"}),h.jsx(eR,{size:10,className:"shrink-0 text-blue-400/60"}),h.jsx("span",{className:"shrink-0",children:P}),h.jsx("span",{className:"flex-1 text-left truncate",children:j.title||j.url})]},`pin-${j.id}`)}),h.jsx(un,{icon:h.jsx(B8,{size:y}),label:w("sidebar.manageFeeds"),active:t==="manage-feeds",collapsed:n,onClick:()=>{i("manage-feeds")}})]}),h.jsx(f2,{label:w("sidebar.pinned"),collapsed:n,expanded:m.pinned,onToggle:()=>D("pinned")}),(n||m.pinned)&&h.jsx(h.Fragment,{children:h.jsx(un,{icon:h.jsx(UC,{size:y}),label:w("sidebar.shortlist"),active:t==="shortlist",collapsed:n,onClick:()=>i("shortlist")})})]}),h.jsxs("div",{className:"px-2 py-2 border-t border-white/5 space-y-0.5",children:[h.jsx(un,{icon:h.jsx(rs,{size:y}),label:w("sidebar.trash"),active:t==="trash",collapsed:n,onClick:()=>i("trash")}),h.jsx(un,{icon:h.jsx(dg,{size:y}),label:w("sidebar.search"),collapsed:n,onClick:a}),h.jsx(un,{icon:h.jsx(UF,{size:y}),label:w("sidebar.shortcuts"),collapsed:n,onClick:o}),h.jsx(un,{icon:h.jsx(vl,{size:y}),label:w("sidebar.downloads"),collapsed:n,onClick:l}),h.jsx(un,{icon:h.jsx(zC,{size:y}),label:w("sidebar.preferences"),collapsed:n,onClick:u}),h.jsx(un,{icon:h.jsx(ov,{size:y}),label:w("sidebar.profile"),collapsed:n})]})]})})}function fU(n){if(!n)return"";const t=Date.now()-new Date(n).getTime();if(t<0)return"just now";const i=Math.floor(t/1e3);if(i<60)return"just now";const s=Math.floor(i/60);if(s<60)return`${s}m`;const r=Math.floor(s/60);if(r<24)return`${r}h`;const a=Math.floor(r/24);if(a<30)return`${a}d`;const o=Math.floor(a/30);return o<12?`${o}mo`:`${Math.floor(o/12)}y`}function pU(n){return n?n.replace(/^www\./,"").charAt(0).toUpperCase():"?"}function gU(n){if(!n)return null;const e=Math.floor(n/3600),t=Math.floor(n%3600/60),i=n%60;return e>0?`${e}:${String(t).padStart(2,"0")}:${String(i).padStart(2,"0")}`:`${t}:${String(i).padStart(2,"0")}`}function mU({article:n,isSelected:e,onHover:t,onClick:i,onStatusChange:s,onToggleShortlist:r,trashMode:a,onRestore:o,onPermanentDelete:l,compact:u,multiSelect:d,isChecked:f,onToggleCheck:p,onContextMenu:g,source:x,onSaveToLibrary:w}){const[y,m]=E.useState(!1),v=x==="feed"||n.source==="feed",b=x==="library"||n.source==="library",A=(H,G)=>{H.stopPropagation(),s(n.id,G)},S=H=>{H.stopPropagation(),r==null||r(n.id,n.isShortlisted===1)},C=H=>{H.stopPropagation(),w==null||w(n.id)},k=n.feedTitle||n.domain,L=pU(k),D=fU(n.savedAt||n.publishedAt),j=n.readProgress>=.9||n.readStatus==="archive"||n.readStatus==="seen",P=[];return k&&P.push(k.replace(/^www\./,"")),n.author&&P.push(n.author),n.readingTime!=null&&n.readingTime>0&&P.push(`${n.readingTime} min`),h.jsxs("div",{onClick:H=>{d||H.metaKey||H.ctrlKey||H.shiftKey?p==null||p(n.id,H):i(n.id)},onContextMenu:H=>{H.preventDefault(),g==null||g(n.id,H.clientX,H.clientY)},onMouseEnter:()=>{m(!0),t(n.id)},onMouseLeave:()=>m(!1),className:`
        relative flex gap-3 px-4 ${u?"py-2":"py-3"} cursor-pointer transition-colors
        ${e?"border-l-2 border-blue-500 bg-white/[0.04]":"border-l-2 border-transparent hover:bg-white/[0.03]"}
        ${j?"opacity-70":""}
      `,children:[d&&h.jsx("div",{className:"shrink-0 flex items-center",children:h.jsx("div",{className:`w-4 h-4 rounded border flex items-center justify-center transition-colors ${f?"bg-blue-500 border-blue-500":"border-white/20 hover:border-white/40"}`,children:f&&h.jsx(nv,{size:12,className:"text-white"})})}),!u&&h.jsx("div",{className:"shrink-0 relative",children:n.thumbnail?h.jsxs(h.Fragment,{children:[h.jsx("img",{src:n.thumbnail,alt:"",className:`w-14 h-14 rounded-md object-cover ${j?"opacity-60":""}`}),n.mediaType==="video"&&n.duration&&h.jsx("span",{className:"absolute bottom-1 right-1 px-1 py-0.5 bg-black/80 text-white text-[10px] font-medium rounded",children:gU(n.duration)})]}):h.jsx("div",{className:`w-14 h-14 rounded-md bg-white/[0.06] flex items-center justify-center text-base font-semibold ${j?"text-gray-600":"text-gray-500"}`,children:L})}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsxs("div",{className:"flex items-start justify-between gap-2",children:[h.jsx("h3",{className:`text-[14px] font-medium truncate leading-snug ${j?"text-gray-500":"text-gray-100"}`,children:n.title||"Untitled"}),!y&&D&&h.jsx("span",{className:"shrink-0 text-[11px] text-gray-500 pt-0.5",children:D})]}),!u&&n.summary&&h.jsx("p",{className:`mt-0.5 text-[13px] leading-snug line-clamp-2 ${j?"text-gray-600":"text-gray-500"}`,children:n.summary}),P.length>0&&h.jsxs("div",{className:"mt-1.5 flex items-center gap-1.5 text-[11px] text-gray-500",children:[h.jsx("span",{className:"shrink-0 w-4 h-4 rounded bg-white/[0.08] flex items-center justify-center text-[10px] font-medium text-gray-400",children:L}),P.map((H,G)=>h.jsxs("span",{className:"flex items-center gap-1.5",children:[G>0&&h.jsx("span",{className:"text-gray-600",children:"Â·"}),h.jsx("span",{className:"truncate max-w-[120px]",children:H})]},G))]})]}),y&&h.jsx("div",{className:"absolute right-3 top-2.5 flex items-center gap-0.5 bg-[#1e1e1e] border border-white/10 rounded-md px-0.5 py-0.5 shadow-lg",children:a?h.jsxs(h.Fragment,{children:[h.jsx("button",{onClick:H=>{H.stopPropagation(),o==null||o(n.id)},className:"p-1 rounded hover:bg-white/10 text-gray-400 hover:text-green-400 transition-colors",title:"Restore",children:h.jsx(tR,{size:14})}),h.jsx("button",{onClick:H=>{H.stopPropagation(),l==null||l(n.id)},className:"p-1 rounded hover:bg-white/10 text-gray-400 hover:text-red-400 transition-colors",title:"Permanently Delete",children:h.jsx(rs,{size:14})})]}):h.jsxs(h.Fragment,{children:[v&&w&&h.jsx("button",{onClick:C,className:"p-1 rounded hover:bg-white/10 text-gray-400 hover:text-blue-400 transition-colors",title:"Save to Library",children:h.jsx(Hj,{size:14})}),h.jsx("button",{onClick:S,className:`p-1 rounded hover:bg-white/10 transition-colors ${n.isShortlisted===1?"text-yellow-400":"text-gray-400 hover:text-white"}`,title:n.isShortlisted===1?"Remove from Shortlist":"Add to Shortlist",children:h.jsx(UC,{size:14,fill:n.isShortlisted===1?"currentColor":"none"})}),b&&h.jsxs(h.Fragment,{children:[n.readStatus!=="archive"&&h.jsx("button",{onClick:H=>A(H,"archive"),className:"p-1 rounded hover:bg-white/10 text-gray-400 hover:text-white transition-colors",title:"Archive",children:h.jsx(Xp,{size:14})}),n.readStatus!=="later"&&h.jsx("button",{onClick:H=>A(H,"later"),className:"p-1 rounded hover:bg-white/10 text-gray-400 hover:text-white transition-colors",title:"Read Later",children:h.jsx(Vr,{size:14})})]}),h.jsx("button",{className:"p-1 rounded hover:bg-white/10 text-gray-400 hover:text-white transition-colors",title:"More",children:h.jsx(Vj,{size:14})})]})}),n.readProgress>0&&h.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-[2px] bg-white/5",children:h.jsx("div",{className:"h-full bg-violet-500 transition-all",style:{width:`${Math.min(n.readProgress*100,100)}%`}})})]})}const yU=()=>{},nR=E.createContext({showToast:yU}),au=()=>E.useContext(nR);function vU({toast:n,onRemove:e}){return E.useEffect(()=>{const t=setTimeout(()=>e(n.id),n.duration);return()=>clearTimeout(t)},[n.id,n.duration,e]),h.jsx("div",{className:"bg-[#1e1e1e] border border-white/10 rounded-lg px-4 py-2.5 shadow-lg transition-all duration-300 ease-out",style:{opacity:n.visible?1:0,transform:n.visible?"translateY(0)":"translateY(8px)"},children:h.jsx("span",{className:"text-sm text-gray-200",children:n.message})})}function xU({children:n}){const[e,t]=E.useState([]),i=E.useCallback(r=>{t(a=>a.map(o=>o.id===r?{...o,visible:!1}:o)),setTimeout(()=>{t(a=>a.filter(o=>o.id!==r))},300)},[]),s=E.useCallback((r,a="info")=>{const o=crypto.randomUUID();t(l=>[...l,{id:o,message:r,type:a,duration:3e3,visible:!1}].slice(-3)),requestAnimationFrame(()=>{t(l=>l.map(u=>u.id===o?{...u,visible:!0}:u))})},[]);return h.jsxs(nR.Provider,{value:{showToast:s},children:[n,e.length>0&&h.jsx("div",{className:"fixed bottom-6 left-1/2 -translate-x-1/2 z-50 flex flex-col-reverse items-center gap-2",children:e.map(r=>h.jsx(vU,{toast:r,onRemove:i},r.id))})]})}function sR(){const[n,e]=E.useState([]),t=E.useCallback(a=>{e(o=>[...o.slice(-19),a])},[]),i=E.useCallback(async()=>{const a=n[n.length-1];a&&(e(o=>o.slice(0,-1)),await a.undo())},[n]),s=n.length>0,r=n.length>0?n[n.length-1]:null;return{push:t,undo:i,canUndo:s,lastAction:r}}function bU({x:n,y:e,items:t,onClose:i}){const s=E.useRef(null);return E.useEffect(()=>{const r=o=>{s.current&&!s.current.contains(o.target)&&i()},a=o=>{o.key==="Escape"&&(o.stopImmediatePropagation(),i())};return document.addEventListener("mousedown",r),document.addEventListener("keydown",a),()=>{document.removeEventListener("mousedown",r),document.removeEventListener("keydown",a)}},[i]),E.useEffect(()=>{if(!s.current)return;const r=s.current.getBoundingClientRect(),a=window.innerWidth,o=window.innerHeight;r.right>a&&(s.current.style.left=`${n-r.width}px`),r.bottom>o&&(s.current.style.top=`${e-r.height}px`)},[n,e]),h.jsx("div",{ref:s,className:"fixed z-50 min-w-[180px] bg-[#1e1e1e] border border-white/10 rounded-lg shadow-xl py-1 backdrop-blur-sm",style:{left:n,top:e},children:t.map((r,a)=>{if(r.separator)return h.jsx("div",{className:"my-1 border-t border-white/10"},a);const o=r.icon;return h.jsxs("button",{onClick:()=>{r.onClick(),i()},className:`
              w-full flex items-center gap-2 px-3 py-1.5 text-[13px] text-left transition-colors cursor-pointer
              ${r.danger?"text-red-400 hover:bg-red-500/10":"text-gray-300 hover:bg-white/10 hover:text-white"}
            `,children:[o&&h.jsx(o,{size:14}),h.jsx("span",{children:r.label})]},a)})})}const wU=[{key:"saved_at",label:"Date saved"},{key:"published_at",label:"Date published"}];function SU({selectedArticleId:n,onSelectArticle:e,onOpenReader:t,refreshTrigger:i,feedId:s,isShortlisted:r,activeView:a,tagId:o,expanded:l,source:u,initialTab:d,mediaType:f}){var Lt;const{t:p}=Sn(),[g,x]=E.useState(()=>{if(d)return d;const ue=u==="feed"?"z-reader-tab-feed":"z-reader-tab-library";return localStorage.getItem(ue)||"inbox"}),[w,y]=E.useState("saved_at"),[m,v]=E.useState("desc"),[b,A]=E.useState(()=>localStorage.getItem("z-reader-view-mode")||"default"),[S,C]=E.useState([]),[k,L]=E.useState(!1),[D,j]=E.useState(new Set),[P,H]=E.useState(null),[G,$]=E.useState(null),{showToast:Y}=au(),F=sR(),M=a==="trash",I=u==="feed",V=u==="library",ie=[{key:"inbox",label:p("contentList.inbox").toUpperCase()},{key:"later",label:p("contentList.later").toUpperCase()},{key:"archive",label:p("contentList.archive").toUpperCase()}],ge=[{key:"unseen",label:p("contentList.unseen").toUpperCase()},{key:"seen",label:p("contentList.seen").toUpperCase()},{key:"all",label:p("contentList.all").toUpperCase()}],ee=I?ge:ie,me=!r&&!M&&!o&&(I||V);E.useEffect(()=>{if(d){x(d);return}const ue=I?"z-reader-tab-feed":"z-reader-tab-library",he=localStorage.getItem(ue);x(he||(I?"unseen":"inbox"))},[d,I]),E.useEffect(()=>{const ue=I?"z-reader-tab-feed":"z-reader-tab-library";localStorage.setItem(ue,g)},[g,I]);const oe=E.useCallback(async()=>{L(!0);try{if(M){const ue=await window.electronAPI.articleListDeleted();C(ue)}else if(a==="tags")if(o){const ue=await window.electronAPI.articleListByTag(o);C(ue)}else C([]);else{const ue={sortBy:w,sortOrder:m,limit:100};u&&!r&&(ue.source=u),f&&(ue.mediaType=f),r||g!=="all"&&(I||V)&&(ue.readStatus=g),s&&(ue.feedId=s,ue.source="feed"),r&&(ue.isShortlisted=!0);const he=await window.electronAPI.articleList(ue);C(he)}}catch(ue){console.error("Failed to fetch articles:",ue)}finally{L(!1)}},[g,w,m,s,r,M,o,u,I,V,a,f]);E.useEffect(()=>{oe()},[oe,i]);const ae={archive:p("contentList.archiveArticle"),later:p("contentList.addToShortlist"),inbox:p("contentList.markAsRead"),seen:p("detailPanel.seen")||"Marked as seen",unseen:p("detailPanel.unseen")||"Marked as unseen"},Z=async(ue,he)=>{try{const Pe=S.find(B=>B.id===ue),Be=(Pe==null?void 0:Pe.readStatus)??"inbox";await window.electronAPI.articleUpdate({id:ue,readStatus:he}),await oe(),Y(ae[he]??`Moved to ${he}`,"success"),F.push({description:`Revert to ${Be}`,undo:async()=>{await window.electronAPI.articleUpdate({id:ue,readStatus:Be}),await oe(),Y("Undone","info")}})}catch(Pe){console.error("Failed to update article status:",Pe)}},re=async ue=>{try{const he=S.find(Be=>Be.id===ue),Pe=(he==null?void 0:he.isShortlisted)===1;await window.electronAPI.articleUpdate({id:ue,isShortlisted:!Pe}),await oe(),Y(Pe?"Removed from Shortlist":"Added to Shortlist","success")}catch(he){console.error("Failed to toggle shortlist:",he)}},ne=async ue=>{try{await window.electronAPI.articleSaveToLibrary(ue),await oe(),Y("Saved to Library","success")}catch(he){console.error("Failed to save to library:",he)}},xe=async ue=>{try{const he=S.findIndex(B=>B.id===ue),Pe=S.filter(B=>B.id!==ue),Be=Pe.length>0?Pe[Math.min(he,Pe.length-1)].id:null;await window.electronAPI.articleDelete(ue),await oe(),Be&&e(Be),Y("Moved to Trash","success"),F.push({description:"Undo delete",undo:async()=>{await window.electronAPI.articleRestore(ue),await oe(),Y("Restored","info")}})}catch(he){console.error("Failed to delete article:",he)}},Re=async ue=>{try{await window.electronAPI.articleRestore(ue),await oe(),Y("Restored","success")}catch(he){console.error("Failed to restore article:",he)}},je=async ue=>{try{await window.electronAPI.articlePermanentDelete(ue),await oe(),Y("Permanently deleted","success")}catch(he){console.error("Failed to permanently delete article:",he)}},Oe=E.useCallback(ue=>{e(ue)},[e]),Ce=E.useCallback(async ue=>{if(!I)return;const he=S.find(Pe=>Pe.id===ue);if(he&&he.readStatus==="unseen"){C(Pe=>Pe.map(Be=>Be.id===ue?{...Be,readStatus:"seen"}:Be));try{await window.electronAPI.articleUpdate({id:ue,readStatus:"seen"})}catch(Pe){console.error("Failed to mark as seen:",Pe)}}},[I,S]),Fe=()=>{v(ue=>ue==="desc"?"asc":"desc")},Ze=()=>{A(ue=>{const he=ue==="default"?"compact":"default";return localStorage.setItem("z-reader-view-mode",he),he})},ye=D.size>0,we=(ue,he)=>{j(Pe=>{const Be=new Set(Pe);if(he.shiftKey&&P){const B=S.map(Ge=>Ge.id),be=B.indexOf(P),Te=B.indexOf(ue);if(be!==-1&&Te!==-1){const[Ge,K]=be<Te?[be,Te]:[Te,be];for(let ve=Ge;ve<=K;ve++)Be.add(B[ve])}}else he.metaKey||he.ctrlKey,Be.has(ue)?Be.delete(ue):Be.add(ue);return Be}),H(ue)},He=()=>{j(new Set(S.map(ue=>ue.id)))},ke=()=>{j(new Set)},Ae=async()=>{if(D.size!==0)try{await window.electronAPI.articleBatchUpdate(Array.from(D),{readStatus:"archive"}),j(new Set),await oe(),Y(`Archived ${D.size} articles`,"success")}catch(ue){console.error("Batch archive failed:",ue)}},it=async()=>{if(D.size!==0)try{await window.electronAPI.articleBatchUpdate(Array.from(D),{readStatus:"later"}),j(new Set),await oe(),Y(`Saved ${D.size} for later`,"success")}catch(ue){console.error("Batch later failed:",ue)}},nt=async()=>{if(D.size!==0)try{const ue=Array.from(D);await window.electronAPI.articleBatchDelete(ue),j(new Set),await oe(),Y(`Deleted ${ue.length} articles`,"success"),F.push({description:`Undo batch delete ${ue.length}`,undo:async()=>{for(const he of ue)await window.electronAPI.articleRestore(he);await oe(),Y("Restored","info")}})}catch(ue){console.error("Batch delete failed:",ue)}},Qe=E.useCallback(ue=>{Ce(ue),t(ue)},[Ce,t]),Nt=(ue,he,Pe)=>{e(ue),$({articleId:ue,x:he,y:Pe})},Ve=()=>{if(!G)return[];const ue=S.find(Be=>Be.id===G.articleId);if(!ue)return[];if(M)return[{label:"Restore",icon:US,onClick:()=>Re(ue.id)},{separator:!0},{label:"Delete permanently",icon:rs,onClick:()=>je(ue.id),danger:!0}];const he=[{label:"Open in Reader",icon:Ja,onClick:()=>t(ue.id)},{separator:!0}];(I||ue.source==="feed")&&(he.push({label:"Save to Library",icon:Hj,onClick:()=>ne(ue.id)}),he.push({separator:!0})),(V||ue.source==="library")&&(ue.readStatus!=="inbox"&&he.push({label:"Move to Inbox",icon:US,onClick:()=>Z(ue.id,"inbox")}),ue.readStatus!=="later"&&he.push({label:"Read later",icon:Vr,onClick:()=>Z(ue.id,"later")}),ue.readStatus!=="archive"&&he.push({label:"Archive",icon:Xp,onClick:()=>Z(ue.id,"archive")}));const Pe=ue.isShortlisted===1;return he.push({label:Pe?"Remove from Shortlist":"Add to Shortlist",icon:UC,onClick:()=>re(ue.id)}),he.push({separator:!0}),he.push({label:"Delete",icon:rs,onClick:()=>xe(ue.id),danger:!0}),ue.url&&(he.push({separator:!0}),he.push({label:"Open in browser",icon:W1,onClick:()=>window.open(ue.url,"_blank")})),he},ce=()=>{y(ue=>ue==="saved_at"?"published_at":"saved_at")},te=((Lt=wU.find(ue=>ue.key===w))==null?void 0:Lt.label)??"",ze=E.useRef(null),st=()=>M?"Trash":r?"Shortlist":o?"Tag":V?"Library":I?"Feed":"Articles",ht=()=>p(M?"contentList.emptyTrash":r?"contentList.emptyShortlist":I?"contentList.noArticles":a==="tags"&&!o||a==="tags"&&o?"contentList.emptyTag":V?"contentList.emptyLibrary":"contentList.noArticles");return E.useEffect(()=>{const ue=he=>{const Pe=he.target.tagName;if(!(Pe==="INPUT"||Pe==="TEXTAREA"))switch(he.key){case"Escape":{if(D.size>0){he.preventDefault(),j(new Set);break}break}case"r":case"R":{if(he.shiftKey&&n){he.preventDefault();const Be=S.find(B=>B.id===n);Be&&Be.readProgress&&Be.readProgress>0&&(window.electronAPI.articleUpdate({id:n,readProgress:0}),C(B=>B.map(be=>be.id===n?{...be,readProgress:0}:be)))}break}case"j":case"ArrowDown":{he.preventDefault();const Be=S.findIndex(be=>be.id===n),B=Be<S.length-1?Be+1:Be;S[B]&&e(S[B].id);break}case"k":case"ArrowUp":{he.preventDefault();const Be=S.findIndex(be=>be.id===n),B=Be>0?Be-1:0;S[B]&&e(S[B].id);break}case"Enter":{n&&(he.preventDefault(),Ce(n),t(n));break}case"1":{he.preventDefault(),x(I?"unseen":"inbox");break}case"2":{he.preventDefault(),x(I?"seen":"later");break}case"3":{he.preventDefault(),I||x("archive");break}case"e":case"E":{he.preventDefault(),n&&V&&Z(n,"archive");break}case"l":case"L":{he.preventDefault(),n&&V&&Z(n,"later");break}case"b":{he.preventDefault(),n&&I&&ne(n);break}case"B":{he.shiftKey&&n&&D.size===0?(he.preventDefault(),j(new Set([n]))):he.shiftKey||(he.preventDefault(),n&&I&&ne(n));break}case"d":case"D":{he.preventDefault(),n&&xe(n);break}case"z":case"Z":{he.preventDefault(),F.canUndo&&F.undo();break}case"s":case"S":{he.preventDefault(),n&&re(n);break}case"f":{he.shiftKey||(he.preventDefault(),n&&re(n));break}case"o":case"O":{if(he.preventDefault(),n){const Be=S.find(B=>B.id===n);Be!=null&&Be.url&&window.open(Be.url,"_blank")}break}case"C":{if(he.shiftKey&&n){he.preventDefault();const Be=S.find(B=>B.id===n);Be!=null&&Be.url&&(navigator.clipboard.writeText(Be.url),Y(p("detailPanel.copyUrl"),"success"))}break}}};return document.addEventListener("keydown",ue),()=>document.removeEventListener("keydown",ue)},[S,n,t,oe,F,D,I,V,Ce]),E.useEffect(()=>{if(!n||!ze.current)return;const ue=ze.current.querySelector(`[data-article-id="${n}"]`);ue==null||ue.scrollIntoView({block:"nearest"})},[n]),h.jsxs("div",{className:"flex flex-col min-w-[300px] border-r border-[#262626] bg-[#141414] h-full flex-1",children:[h.jsxs("div",{className:"shrink-0",children:[h.jsxs("div",{className:"px-4 pt-4 pb-2 flex items-center justify-between",children:[h.jsx("h2",{className:"text-[13px] font-semibold text-white tracking-wide",children:st()}),h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsx("button",{onClick:ce,className:"flex items-center gap-1 px-1.5 py-0.5 rounded text-[11px] text-[#666] hover:text-[#999] hover:bg-white/5 transition-colors cursor-pointer",title:`Sort by: ${te}`,children:h.jsx("span",{children:te})}),h.jsx("button",{onClick:Fe,className:"p-1 rounded text-[#666] hover:text-[#999] hover:bg-white/5 transition-colors cursor-pointer",title:m==="desc"?"Newest first":"Oldest first",children:m==="desc"?h.jsx(O8,{size:12}):h.jsx(U8,{size:12})}),h.jsx("button",{onClick:Ze,className:"p-1 rounded text-[#666] hover:text-[#999] hover:bg-white/5 transition-colors cursor-pointer",title:b==="default"?"Compact view":"Default view",children:b==="default"?h.jsx(QF,{size:12}):h.jsx(YF,{size:12})})]})]}),me&&h.jsx("div",{className:"flex px-4 gap-4 border-b border-[#262626]",children:ee.map(ue=>h.jsx("button",{onClick:()=>x(ue.key),className:`
                  pb-2 text-[11px] font-medium tracking-[0.08em] transition-colors cursor-pointer
                  ${g===ue.key?"text-white border-b-2 border-blue-500":"text-[#555] hover:text-[#888] border-b-2 border-transparent"}
                `,children:ue.label},ue.key))}),!me&&h.jsx("div",{className:"border-b border-[#262626]"})]}),h.jsxs("div",{ref:ze,className:"flex-1 overflow-y-auto",children:[ye&&h.jsxs("div",{className:"sticky top-0 z-10 flex items-center justify-between gap-2 px-4 py-2 bg-blue-500/10 border-b border-blue-500/20",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs("span",{className:"text-[12px] text-blue-400 font-medium",children:[D.size," selected"]}),h.jsx("button",{onClick:He,className:"text-[11px] text-blue-400/70 hover:text-blue-400 transition-colors cursor-pointer",children:"Select all"})]}),h.jsxs("div",{className:"flex items-center gap-1",children:[V&&h.jsxs(h.Fragment,{children:[h.jsx("button",{onClick:Ae,className:"p-1.5 rounded hover:bg-white/10 text-gray-400 hover:text-white transition-colors cursor-pointer",title:"Archive",children:h.jsx(Xp,{size:14})}),h.jsx("button",{onClick:it,className:"p-1.5 rounded hover:bg-white/10 text-gray-400 hover:text-white transition-colors cursor-pointer",title:"Read later",children:h.jsx(Vr,{size:14})})]}),h.jsx("button",{onClick:nt,className:"p-1.5 rounded hover:bg-white/10 text-gray-400 hover:text-red-400 transition-colors cursor-pointer",title:"Delete",children:h.jsx(rs,{size:14})}),h.jsx("button",{onClick:ke,className:"p-1.5 rounded hover:bg-white/10 text-gray-400 hover:text-white transition-colors cursor-pointer",title:"Clear selection",children:h.jsx(Fn,{size:14})})]})]}),k&&S.length===0?h.jsx("div",{className:"flex items-center justify-center h-full",children:h.jsx("span",{className:"text-[13px] text-[#555]",children:"Loading..."})}):S.length===0?h.jsx("div",{className:"flex items-center justify-center h-full",children:h.jsx("span",{className:"text-[13px] text-[#555]",children:ht()})}):h.jsx("div",{children:S.map(ue=>h.jsx("div",{"data-article-id":ue.id,className:"border-b border-[#262626]",children:h.jsx(mU,{article:ue,isSelected:ue.id===n,onHover:Oe,onClick:Qe,onStatusChange:Z,onToggleShortlist:he=>re(he),trashMode:M,onRestore:Re,onPermanentDelete:je,compact:b==="compact",multiSelect:ye,isChecked:D.has(ue.id),onToggleCheck:we,onContextMenu:Nt,source:u,onSaveToLibrary:I?ne:void 0})},ue.id))})]}),h.jsxs("div",{className:"shrink-0 px-4 py-1.5 border-t border-[#262626] text-[11px] text-[#555]",children:[S.length," ",S.length===1?f==="video"?"video":f==="podcast"?"podcast":"article":f==="video"?"videos":f==="podcast"?"podcasts":"articles"]}),G&&h.jsx(bU,{x:G.x,y:G.y,items:Ve(),onClose:()=>$(null)})]})}function AU({articleId:n,onTagsChange:e}){const[t,i]=E.useState([]),[s,r]=E.useState([]),[a,o]=E.useState(""),[l,u]=E.useState(!1),d=E.useRef(null),f=E.useRef(null),p=async()=>{const[v,b]=await Promise.all([window.electronAPI.tagList(),window.electronAPI.articleTagsForArticle(n)]);i(v),r(b)};E.useEffect(()=>{p()},[n]),E.useEffect(()=>{if(!l)return;const v=b=>{f.current&&!f.current.contains(b.target)&&u(!1)};return document.addEventListener("mousedown",v),()=>document.removeEventListener("mousedown",v)},[l]);const g=t.filter(v=>!s.some(b=>b.id===v.id)&&v.name.toLowerCase().includes(a.toLowerCase())),x=async v=>{await window.electronAPI.articleTagAdd(n,v),await p(),o(""),e==null||e()},w=async v=>{await window.electronAPI.articleTagRemove(n,v),await p(),e==null||e()},y=async()=>{const v=a.trim();if(!v)return;const b=await window.electronAPI.tagCreate(v);await window.electronAPI.articleTagAdd(n,b.id),await p(),o(""),e==null||e()},m=v=>{v.key==="Enter"&&(v.preventDefault(),g.length>0?x(g[0].id):a.trim()&&y()),v.key==="Escape"&&u(!1)};return h.jsxs("div",{ref:f,className:"relative",children:[h.jsxs("div",{className:"flex flex-wrap gap-1.5 mb-1.5",children:[s.map(v=>h.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-[11px] bg-blue-500/15 text-blue-400 border border-blue-500/20",children:[v.name,h.jsx("button",{onClick:()=>w(v.id),className:"hover:text-white transition-colors",children:h.jsx(Fn,{size:10})})]},v.id)),h.jsxs("button",{onClick:()=>{u(!0),setTimeout(()=>{var v;return(v=d.current)==null?void 0:v.focus()},50)},className:"inline-flex items-center gap-0.5 px-1.5 py-0.5 rounded-full text-[11px] text-gray-500 hover:text-gray-300 hover:bg-white/5 transition-colors",children:[h.jsx(bl,{size:10}),h.jsx("span",{children:"Add tag"})]})]}),l&&h.jsxs("div",{className:"absolute z-50 left-0 top-full mt-1 w-[200px] bg-[#1e1e1e] border border-white/10 rounded-lg shadow-xl",children:[h.jsx("input",{ref:d,value:a,onChange:v=>o(v.target.value),onKeyDown:m,placeholder:"Search or create tag...",className:"w-full px-3 py-2 bg-transparent text-[12px] text-white placeholder-gray-500 border-b border-white/10 outline-none"}),h.jsxs("div",{className:"max-h-[160px] overflow-y-auto py-1",children:[g.map(v=>h.jsxs("button",{onClick:()=>x(v.id),className:"w-full flex items-center justify-between px-3 py-1.5 text-[12px] text-gray-300 hover:bg-white/5 transition-colors text-left",children:[h.jsx("span",{children:v.name}),v.articleCount!==void 0&&h.jsx("span",{className:"text-[10px] text-gray-600",children:v.articleCount})]},v.id)),g.length===0&&a.trim()&&h.jsxs("button",{onClick:y,className:"w-full flex items-center gap-1.5 px-3 py-1.5 text-[12px] text-blue-400 hover:bg-white/5 transition-colors text-left",children:[h.jsx(bl,{size:12}),h.jsxs("span",{children:['Create "',a.trim(),'"']})]}),g.length===0&&!a.trim()&&h.jsx("p",{className:"px-3 py-2 text-[11px] text-gray-600",children:"No tags available"})]})]})]})}function rR(n){let e=n;e=e.replace(/```(\w*)\n?([\s\S]*?)```/g,(a,o,l)=>`<pre class="my-2 p-2 rounded bg-white/5 text-[12px] leading-[1.5] overflow-x-auto"><code>${aR(l.trimEnd())}</code></pre>`);const t=e.split(`
`),i=[];let s=!1,r=!1;for(const a of t){if(a.includes("<pre class=")&&(r=!0),r){s&&(i.push("</ul>"),s=!1),i.push(a),a.includes("</pre>")&&(r=!1);continue}const o=a.match(/^[\s]*[-*]\s+(.+)/);if(o){s||(i.push('<ul class="list-disc list-inside my-1 space-y-0.5">'),s=!0),i.push(`<li>${Rk(o[1])}</li>`);continue}if(s&&(i.push("</ul>"),s=!1),a.trim()===""){i.push("<br/>");continue}i.push(`<p class="my-0.5">${Rk(a)}</p>`)}return s&&i.push("</ul>"),i.join("")}function Rk(n){let e=aR(n);return e=e.replace(/\*\*(.+?)\*\*/g,'<strong class="font-semibold text-white">$1</strong>'),e=e.replace(/`([^`]+)`/g,'<code class="px-1 py-0.5 rounded bg-white/10 text-[12px] text-blue-300">$1</code>'),e}function aR(n){return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function oR(){return[{key:"valueClarification",icon:h.jsx(PC,{className:"w-5 h-5"}),color:"text-amber-400",pillColor:"bg-amber-500/10 text-amber-400 border-amber-500/20 hover:bg-amber-500/20",prompt:"è¯·ç”¨**ä»·å€¼æ¾„æ¸…æ³•**åˆ†æžè¿™ç¯‡æ–‡ç« ï¼šè¯†åˆ«æ–‡ç« ä¼ è¾¾çš„æ ¸å¿ƒä»·å€¼è§‚ï¼Œåˆ†æžè¿™äº›ä»·å€¼è§‚ä¹‹é—´æ˜¯å¦å­˜åœ¨å†²çªï¼Œå¸®æˆ‘åŽ˜æ¸…å“ªäº›æ˜¯æˆ‘çœŸæ­£è®¤åŒçš„ã€‚"},{key:"sixThinkingHats",icon:h.jsx(XF,{className:"w-5 h-5"}),color:"text-blue-400",pillColor:"bg-blue-500/10 text-blue-400 border-blue-500/20 hover:bg-blue-500/20",prompt:"è¯·ç”¨**å…­é¡¶æ€è€ƒå¸½**æ–¹æ³•åˆ†æžè¿™ç¯‡æ–‡ç« ï¼šåˆ†åˆ«ä»Žç™½å¸½ï¼ˆäº‹å®žï¼‰ã€çº¢å¸½ï¼ˆæƒ…æ„Ÿï¼‰ã€é»‘å¸½ï¼ˆé£Žé™©ï¼‰ã€é»„å¸½ï¼ˆä»·å€¼ï¼‰ã€ç»¿å¸½ï¼ˆåˆ›æ–°ï¼‰ã€è“å¸½ï¼ˆå…¨å±€ï¼‰å…­ä¸ªè§’åº¦å±•å¼€åˆ†æžã€‚"},{key:"firstPrinciples",icon:h.jsx($8,{className:"w-5 h-5"}),color:"text-emerald-400",pillColor:"bg-emerald-500/10 text-emerald-400 border-emerald-500/20 hover:bg-emerald-500/20",prompt:"è¯·ç”¨**ç¬¬ä¸€æ€§åŽŸç†**åˆ†æžè¿™ç¯‡æ–‡ç« ï¼šå‰¥ç¦»è¡¨é¢å‡è®¾ï¼Œå›žå½’æœ€åŸºæœ¬çš„äº‹å®žå’ŒåŽŸç†ï¼Œé‡æ–°æŽ¨å¯¼æ–‡ç« çš„æ ¸å¿ƒè®ºç‚¹æ˜¯å¦æˆç«‹ã€‚"},{key:"socraticMethod",icon:h.jsx(lF,{className:"w-5 h-5"}),color:"text-purple-400",pillColor:"bg-purple-500/10 text-purple-400 border-purple-500/20 hover:bg-purple-500/20",prompt:"è¯·ç”¨**è‹æ ¼æ‹‰åº•æé—®æ³•**åˆ†æžè¿™ç¯‡æ–‡ç« ï¼šé€šè¿‡å±‚å±‚è¿½é—®çš„æ–¹å¼ï¼ŒæŒ‘æˆ˜æ–‡ç« çš„å‡è®¾ã€è¯æ®å’ŒæŽ¨ç†é€»è¾‘ï¼Œå¸®æˆ‘æ·±å…¥æ€è€ƒã€‚"},{key:"feynmanTechnique",icon:h.jsx(Gj,{className:"w-5 h-5"}),color:"text-rose-400",pillColor:"bg-rose-500/10 text-rose-400 border-rose-500/20 hover:bg-rose-500/20",prompt:"è¯·ç”¨**è´¹æ›¼æ•™å­¦æ³•**è§£è¯»è¿™ç¯‡æ–‡ç« ï¼šç”¨æœ€ç®€å•æ˜“æ‡‚çš„è¯­è¨€é‡æ–°è§£é‡Šæ–‡ç« çš„æ ¸å¿ƒæ¦‚å¿µï¼ŒæŒ‡å‡ºæˆ‘å¯èƒ½å­˜åœ¨çš„ç†è§£ç›²åŒºã€‚"}]}function EU({onSelectPreset:n}){const{t:e}=Sn(),t=oR();return h.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center px-2",children:[h.jsx(Fm,{className:"w-8 h-8 text-gray-600 opacity-30 mb-3"}),h.jsx("p",{className:"text-sm text-gray-500 mb-4",children:e("chat.empty")}),h.jsx("div",{className:"grid grid-cols-2 gap-2 w-full",children:t.map(i=>h.jsxs("button",{onClick:()=>n(i.prompt),className:"flex flex-col items-start gap-1.5 p-2.5 rounded-lg bg-[#1a1a1a] border border-white/5 hover:border-white/15 transition-colors cursor-pointer text-left group",children:[h.jsx("span",{className:i.color,children:i.icon}),h.jsx("span",{className:"text-[12px] font-medium text-gray-300 group-hover:text-white transition-colors",children:e(`chat.analysis.${i.key}`)}),h.jsx("span",{className:"text-[11px] text-gray-600 leading-tight",children:e(`chat.analysis.${i.key}Desc`)})]},i.key))}),h.jsx("p",{className:"text-[11px] text-gray-600 mt-3",children:e("chat.analysisHint")})]})}function CU({onSelectPreset:n,disabled:e}){const{t}=Sn(),i=oR();return h.jsx("div",{className:"flex gap-1.5 overflow-x-auto pb-1 scrollbar-none",children:i.map(s=>h.jsxs("button",{onClick:()=>n(s.prompt),disabled:e,className:`shrink-0 flex items-center gap-1 px-2 py-1 rounded-full border text-[11px] transition-colors cursor-pointer disabled:opacity-40 disabled:cursor-not-allowed ${s.pillColor}`,children:[s.icon&&h.jsx("span",{className:"w-3 h-3 [&>svg]:w-3 [&>svg]:h-3",children:s.icon}),t(`chat.analysis.${s.key}`)]},s.key))})}function _U(){const{t:n}=Sn();return h.jsx("div",{className:"flex-1 flex items-center justify-center",children:h.jsxs("div",{className:"text-center text-gray-500 px-6",children:[h.jsx(zC,{className:"w-8 h-8 mx-auto mb-2 opacity-30"}),h.jsx("p",{className:"text-sm",children:n("ai.configureApiKey")})]})})}function NU({message:n}){const{t:e}=Sn(),[t,i]=E.useState(!1),s=n.role==="user";return h.jsx("div",{className:`flex ${s?"justify-end":"justify-start"}`,children:h.jsxs("div",{className:`
          max-w-[85%] rounded-lg px-3 py-2 text-[13px] leading-[1.6]
          ${s?"bg-blue-600 text-white":"bg-[#1a1a1a] border border-white/5 text-gray-300"}
        `,children:[s?h.jsx("p",{className:"whitespace-pre-wrap break-words",children:n.content}):h.jsx("div",{className:"prose-chat break-words",dangerouslySetInnerHTML:{__html:rR(n.content)}}),n.toolCalls&&n.toolCalls.length>0&&h.jsxs("div",{className:"mt-2 border-t border-white/10 pt-1.5",children:[h.jsxs("button",{onClick:()=>i(!t),className:"flex items-center gap-1 text-[11px] text-gray-500 hover:text-gray-300 transition-colors cursor-pointer",children:[t?h.jsx(sv,{className:"w-3 h-3"}):h.jsx(G1,{className:"w-3 h-3"}),h.jsx("span",{children:e("chat.toolCalling",{name:`${n.toolCalls.length} tools`})})]}),t&&h.jsx("div",{className:"mt-1.5 space-y-1",children:n.toolCalls.map((r,a)=>h.jsxs("div",{className:"text-[11px] rounded bg-white/5 px-2 py-1.5",children:[h.jsx("span",{className:"text-purple-400 font-medium",children:r.name}),h.jsx("pre",{className:"mt-1 text-gray-500 overflow-x-auto text-[10px] leading-[1.4]",children:JSON.stringify(r.args,null,2)}),r.result&&h.jsx("pre",{className:"mt-1 text-gray-400 overflow-x-auto text-[10px] leading-[1.4] border-t border-white/5 pt-1",children:r.result.length>200?r.result.slice(0,200)+"...":r.result})]},a))})]})]})})}function kU({text:n,toolCalls:e}){const{t}=Sn(),[i,s]=E.useState(!0);return h.jsx("div",{className:"flex justify-start",children:h.jsxs("div",{className:"max-w-[85%] rounded-lg px-3 py-2 bg-[#1a1a1a] border border-white/5 text-[13px] leading-[1.6] text-gray-300",children:[e.length>0&&h.jsxs("div",{className:"mb-2 pb-1.5 border-b border-white/10",children:[h.jsxs("button",{onClick:()=>s(!i),className:"flex items-center gap-1 text-[11px] text-gray-500 hover:text-gray-300 transition-colors cursor-pointer",children:[i?h.jsx(sv,{className:"w-3 h-3"}):h.jsx(G1,{className:"w-3 h-3"}),h.jsx("span",{children:t("chat.toolCalling",{name:e[e.length-1].name})})]}),i&&h.jsx("div",{className:"mt-1.5 space-y-1",children:e.map((r,a)=>h.jsxs("div",{className:"text-[11px] rounded bg-white/5 px-2 py-1.5",children:[h.jsx("span",{className:"text-purple-400 font-medium",children:r.name}),h.jsx("pre",{className:"mt-1 text-gray-500 overflow-x-auto text-[10px] leading-[1.4]",children:JSON.stringify(r.args,null,2)})]},a))})]}),n?h.jsxs("div",{className:"break-words",children:[h.jsx("div",{dangerouslySetInnerHTML:{__html:rR(n)}}),h.jsx("span",{className:"inline-block w-1.5 h-4 bg-blue-400 animate-pulse ml-0.5 align-text-bottom"})]}):h.jsxs("div",{className:"flex items-center gap-2 text-gray-500",children:[h.jsx(xt,{className:"w-3.5 h-3.5 animate-spin"}),h.jsx("span",{className:"text-[12px]",children:t("chat.thinking")})]})]})})}function TU({sessions:n,currentSessionId:e,onSelect:t,onNew:i,onDelete:s,onClose:r}){const{t:a}=Sn(),o=E.useRef(null);return E.useEffect(()=>{const l=u=>{o.current&&!o.current.contains(u.target)&&r()};return document.addEventListener("mousedown",l),()=>document.removeEventListener("mousedown",l)},[r]),h.jsxs("div",{ref:o,className:"absolute top-full left-0 right-0 mt-1 bg-[#1a1a1a] border border-white/10 rounded-lg shadow-xl z-50 max-h-[300px] overflow-y-auto",children:[h.jsxs("button",{onClick:i,className:"w-full flex items-center gap-2 px-3 py-2 text-[12px] text-gray-400 hover:bg-white/5 hover:text-white transition-colors cursor-pointer border-b border-white/5",children:[h.jsx(bl,{className:"w-3.5 h-3.5"}),h.jsx("span",{children:a("chat.newSession")})]}),n.length===0?h.jsx("div",{className:"px-3 py-4 text-[12px] text-gray-600 text-center",children:a("chat.sessionList")}):n.map(l=>h.jsxs("div",{className:`
              group flex items-center justify-between px-3 py-2 cursor-pointer transition-colors
              ${l.id===e?"bg-white/5 text-white":"text-gray-400 hover:bg-white/5 hover:text-white"}
            `,onClick:()=>t(l.id),children:[h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("p",{className:"text-[12px] truncate",children:l.title||a("chat.newSession")}),h.jsx("p",{className:"text-[10px] text-gray-600 mt-0.5",children:new Date(l.updatedAt).toLocaleDateString("zh-CN")})]}),h.jsx("button",{onClick:u=>{u.stopPropagation(),s(l.id)},className:"p-1 rounded opacity-0 group-hover:opacity-100 hover:bg-white/10 transition-all text-gray-500 hover:text-red-400 cursor-pointer",children:h.jsx(rs,{className:"w-3 h-3"})})]},l.id))]})}function lR({articleId:n}){const{t:e}=Sn(),[t,i]=E.useState([]),[s,r]=E.useState(""),[a,o]=E.useState(!1),[l,u]=E.useState(null),[d,f]=E.useState(""),[p,g]=E.useState([]),[x,w]=E.useState([]),[y,m]=E.useState(!1),[v,b]=E.useState(null),[A,S]=E.useState(null),C=E.useRef(null),k=E.useRef(null),L=E.useRef(p);L.current=p;const D=E.useCallback(()=>{var F;(F=C.current)==null||F.scrollIntoView({behavior:"smooth"})},[]);E.useEffect(()=>{D()},[t,d,D]),E.useEffect(()=>{window.electronAPI.aiSettingsGet().then(F=>{b(!!(F.apiKey&&F.apiKey.trim().length>0))}).catch(()=>{b(!1)})},[]),E.useEffect(()=>{if(v===!1||v===null)return;(async()=>{try{const M=await window.electronAPI.aiChatSessionCreate(n??void 0);u(M.id),i(M.messages);const I=await window.electronAPI.aiChatSessionList();w(I)}catch{S(e("chat.error"))}})()},[n,v,e]),E.useEffect(()=>window.electronAPI.aiChatOnStream(M=>{if(M.type==="text-delta")f(I=>I+(M.textDelta??""));else if(M.type==="tool-call")M.toolCall&&g(I=>[...I,M.toolCall]);else if(M.type!=="tool-result")if(M.type==="done"){const I=L.current;i(V=>[...V,{role:"assistant",content:M.fullText??"",timestamp:new Date().toISOString(),toolCalls:I.length>0?I.map(ie=>({...ie})):void 0}]),f(""),g([]),o(!1)}else M.type==="error"&&(S(M.error??e("chat.error")),f(""),g([]),o(!1))}),[e]);const j=E.useCallback(()=>{if(!s.trim()||!l||a)return;const F={role:"user",content:s.trim(),timestamp:new Date().toISOString()};i(M=>[...M,F]),S(null),window.electronAPI.aiChatSend({sessionId:l,message:s.trim(),articleId:n??void 0}),r(""),o(!0)},[s,l,a,n]),P=E.useCallback(F=>{if(!l||a)return;const M={role:"user",content:F,timestamp:new Date().toISOString()};i(I=>[...I,M]),S(null),window.electronAPI.aiChatSend({sessionId:l,message:F,articleId:n??void 0}),o(!0)},[l,a,n]),H=E.useCallback(F=>{F.key==="Enter"&&!F.shiftKey&&(F.preventDefault(),j())},[j]),G=E.useCallback(async()=>{try{const F=await window.electronAPI.aiChatSessionCreate(n??void 0);u(F.id),i(F.messages),m(!1);const M=await window.electronAPI.aiChatSessionList();w(M)}catch{S(e("chat.error"))}},[n,e]),$=E.useCallback(async F=>{try{const M=await window.electronAPI.aiChatSessionGet(F);M&&(u(M.id),i(M.messages)),m(!1)}catch{S(e("chat.error"))}},[e]),Y=E.useCallback(async F=>{try{await window.electronAPI.aiChatSessionDelete(F),F===l&&await G();const M=await window.electronAPI.aiChatSessionList();w(M)}catch{S(e("chat.error"))}},[l,G,e]);return v===null?h.jsx("div",{className:"flex flex-col h-full items-center justify-center",children:h.jsx(xt,{className:"w-5 h-5 animate-spin text-gray-500"})}):v===!1?h.jsx("div",{className:"flex flex-col h-full",children:h.jsx(_U,{})}):h.jsxs("div",{className:"flex flex-col h-full",children:[h.jsxs("div",{className:"shrink-0 relative",children:[h.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b border-white/5",children:[h.jsxs("button",{onClick:()=>m(!y),className:"flex items-center gap-1.5 text-[12px] text-gray-400 hover:text-white transition-colors cursor-pointer",children:[h.jsx(Fm,{className:"w-3.5 h-3.5"}),h.jsx("span",{children:e("chat.sessionList")}),h.jsx(sv,{className:"w-3 h-3"})]}),h.jsx("button",{onClick:G,className:"p-1 rounded hover:bg-white/10 text-gray-500 hover:text-white transition-colors cursor-pointer",title:e("chat.newSession"),children:h.jsx(bl,{className:"w-3.5 h-3.5"})})]}),y&&h.jsx(TU,{sessions:x,currentSessionId:l,onSelect:$,onNew:G,onDelete:Y,onClose:()=>m(!1)})]}),h.jsxs("div",{className:"flex-1 overflow-y-auto p-3 space-y-3",children:[t.length===0&&!a&&h.jsx(EU,{onSelectPreset:P}),t.map((F,M)=>h.jsx(NU,{message:F},M)),a&&h.jsx(kU,{text:d,toolCalls:p}),A&&!a&&h.jsx("div",{className:"flex justify-center",children:h.jsx("p",{className:"text-[12px] text-red-400 bg-red-500/10 border border-red-500/20 rounded-lg px-3 py-1.5",children:A})}),h.jsx("div",{ref:C})]}),h.jsxs("div",{className:"shrink-0 border-t border-white/5 p-3",children:[t.length>0&&h.jsx("div",{className:"mb-2",children:h.jsx(CU,{onSelectPreset:P,disabled:a||!l})}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("input",{ref:k,type:"text",value:s,onChange:F=>r(F.target.value),onKeyDown:H,placeholder:e("chat.placeholder"),disabled:a||!l,className:"flex-1 bg-[#1a1a1a] border border-white/10 rounded-lg px-3 py-2 text-[13px] text-white placeholder-gray-600 outline-none focus:border-blue-500/50 transition-colors disabled:opacity-50"}),h.jsxs("button",{onClick:j,disabled:a||!s.trim()||!l,className:"shrink-0 px-3 py-2 rounded-lg bg-blue-600 text-white text-[13px] font-medium hover:bg-blue-500 transition-colors cursor-pointer disabled:opacity-40 disabled:cursor-not-allowed flex items-center gap-1.5",children:[a?h.jsx(xt,{className:"w-3.5 h-3.5 animate-spin"}):h.jsx(Pz,{className:"w-3.5 h-3.5"}),h.jsx("span",{children:e("chat.send")})]})]})]})]})}function fg({defaultWidth:n,minWidth:e=220,maxWidth:t=600,storageKey:i}){const[s,r]=E.useState(()=>{if(i){const d=localStorage.getItem(i);if(d){const f=parseInt(d,10);if(!isNaN(f)&&f>=e&&f<=t)return f}}return n}),a=E.useRef(!1),o=E.useRef(0),l=E.useRef(0),u=E.useCallback(d=>{d.preventDefault(),a.current=!0,o.current=d.clientX,l.current=s,document.body.style.cursor="col-resize",document.body.style.userSelect="none"},[s]);return E.useEffect(()=>{const d=p=>{if(!a.current)return;const g=o.current-p.clientX,x=Math.min(t,Math.max(e,l.current+g));r(x)},f=()=>{a.current&&(a.current=!1,document.body.style.cursor="",document.body.style.userSelect="")};return document.addEventListener("mousemove",d),document.addEventListener("mouseup",f),()=>{document.removeEventListener("mousemove",d),document.removeEventListener("mouseup",f)}},[e,t]),E.useEffect(()=>{i&&localStorage.setItem(i,String(s))},[s,i]),{width:s,handleMouseDown:u}}function $S(n){if(!n)return null;try{return new Date(n).toLocaleDateString("zh-CN",{year:"numeric",month:"short",day:"numeric"})}catch{return n}}const Lk={yellow:"#fbbf24",blue:"#3b82f6",green:"#22c55e",red:"#ef4444"};function DU(n,e){const t=Date.now()-new Date(n).getTime(),i=Math.floor(t/6e4);if(i<1)return e("time.justNow");if(i<60)return e("time.minutesAgo",{n:i});const s=Math.floor(i/60);if(s<24)return e("time.hoursAgo",{n:s});const r=Math.floor(s/24);return r<30?e("time.daysAgo",{n:r}):$S(n)??n}function jU(n){if(!n)return null;const e=Math.floor(n/3600),t=Math.floor(n%3600/60),i=n%60;return e>0?`${e}:${String(t).padStart(2,"0")}:${String(i).padStart(2,"0")}`:`${t}:${String(i).padStart(2,"0")}`}function HC({articleId:n,collapsed:e,externalHighlights:t,onExternalDeleteHighlight:i,onHighlightClick:s}){var Nt;const{t:r}=Sn(),{width:a,handleMouseDown:o}=fg({defaultWidth:600,minWidth:280,maxWidth:600,storageKey:"detailPanelWidth"}),[l,u]=E.useState("info"),d=[{key:"info",label:r("feedDetail.info")},{key:"notebook",label:r("detailPanel.highlights")},{key:"chat",label:r("chat.title")}],[f,p]=E.useState(null),[g,x]=E.useState(!1),[w,y]=E.useState([]),[m,v]=E.useState(null),[b,A]=E.useState(""),[S,C]=E.useState(!1),[k,L]=E.useState(null),[D,j]=E.useState(null),[P,H]=E.useState(!1),[G,$]=E.useState(null),[Y,F]=E.useState(null),[M,I]=E.useState(!1),[V,ie]=E.useState(!1),[ge,ee]=E.useState(null),[me,oe]=E.useState(null),[ae,Z]=E.useState(!1),[re,ne]=E.useState(null),[xe,Re]=E.useState(null),je=t!=null,Oe=je?t:w;E.useEffect(()=>{if(L(null),j(null),C(!1),$(null),F(null),H(!1),I(!1),ee(null),oe(null),ie(!1),ne(null),Re(null),Z(!1),!n){p(null),y([]);return}let Ve=!1;return x(!0),window.electronAPI.articleGet(n).then(ce=>{Ve||(p(ce),x(!1))}).catch(()=>{Ve||(p(null),x(!1))}),je||window.electronAPI.highlightList(n).then(ce=>{Ve||y(ce)}),()=>{Ve=!0}},[n,je]);const Ce=E.useCallback(async Ve=>{je&&i?i(Ve):(await window.electronAPI.highlightDelete(Ve),y(ce=>ce.filter(te=>te.id!==Ve)))},[je,i]),Fe=E.useCallback(async(Ve,ce)=>{const te=await window.electronAPI.highlightUpdate({id:Ve,note:ce});je||y(ze=>ze.map(st=>st.id===Ve?te:st)),v(null)},[je]),Ze=E.useCallback(async Ve=>{n&&await window.electronAPI.highlightExport(n,Ve)},[n]),ye=E.useCallback(async()=>{try{const Ve=await window.electronAPI.aiSettingsGet();return!!(Ve.apiKey&&Ve.apiKey.trim().length>0)}catch{return!1}},[]),we=E.useCallback(async()=>{if(!n)return;if(!await ye()){j(r("ai.configureApiKey"));return}C(!0),L(null),j(null);try{const ce=await window.electronAPI.aiSummarize({articleId:n});L(ce.summary)}catch{j(r("ai.errorOccurred"))}finally{C(!1)}},[n,ye,r]),He=E.useCallback(async Ve=>{if(!n)return;if(!await ye()){F(r("ai.configureApiKey"));return}H(!0),$(null),F(null),I(!1);try{const te=await window.electronAPI.aiTranslate({articleId:n,targetLanguage:Ve});$({title:te.translatedTitle,content:te.translatedContent})}catch{F(r("ai.errorOccurred"))}finally{H(!1)}},[n,ye,r]),ke=E.useCallback(async()=>{if(!n)return;if(!await ye()){oe(r("ai.configureApiKey"));return}ie(!0),ee(null),oe(null);try{const ce=await window.electronAPI.aiAutoTag({articleId:n});ee(ce.tags)}catch{oe(r("ai.errorOccurred"))}finally{ie(!1)}},[n,ye,r]),Ae=E.useCallback(async()=>{if(!n)return;if(!await ye()){Re(r("ai.configureApiKey"));return}Z(!0),ne(null),Re(null);try{const ce=await window.electronAPI.aiExtractTopics({articleId:n});ne(ce)}catch{Re(r("ai.errorOccurred"))}finally{Z(!1)}},[n,ye,r]),it=(f==null?void 0:f.mediaType)==="video",nt=f?[{label:"Published",value:$S(f.publishedAt),icon:h.jsx(Bm,{className:"w-3.5 h-3.5"})},...it?[]:[{label:"Author",value:f.author,icon:h.jsx(ov,{className:"w-3.5 h-3.5"})}],{label:"Domain",value:f.domain,icon:h.jsx(ed,{className:"w-3.5 h-3.5"})},...it&&f.duration?[{label:"Length",value:jU(f.duration),icon:h.jsx(Vr,{className:"w-3.5 h-3.5"})}]:[],...it?[{label:"Progress",value:`${Math.round(f.readProgress*100)}%`,icon:h.jsx(xl,{className:"w-3.5 h-3.5"})}]:[],...it?[]:[{label:"Reading Time",value:f.readingTime?`${f.readingTime} min`:null,icon:h.jsx(Vr,{className:"w-3.5 h-3.5"})}],...it?[]:[{label:"Word Count",value:((Nt=f.wordCount)==null?void 0:Nt.toLocaleString())??null,icon:h.jsx(xl,{className:"w-3.5 h-3.5"})}],{label:"Saved",value:$S(f.savedAt),icon:h.jsx(Bm,{className:"w-3.5 h-3.5"})}]:[],Qe={inbox:r("contentList.inbox"),later:r("contentList.later"),archive:r("contentList.archive")};return h.jsxs("div",{className:`
        flex flex-col bg-[#0f0f0f] border-l border-[#262626] shrink-0
        overflow-hidden relative
        ${e?"w-0 border-l-0":""}
      `,style:e?void 0:{width:a},children:[!e&&h.jsx("div",{onMouseDown:o,className:"absolute left-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500/30 active:bg-blue-500/50 z-10 transition-colors"}),h.jsxs("div",{className:"flex flex-col h-full",style:{minWidth:a},children:[h.jsx("div",{className:"shrink-0 flex gap-1 px-4 pt-3 border-b border-white/5",children:d.map(Ve=>h.jsxs("button",{onClick:()=>u(Ve.key),className:`
              px-3 py-1.5 text-xs font-medium transition-colors cursor-pointer
              ${l===Ve.key?"text-white border-b-2 border-blue-500":"text-gray-500 hover:text-gray-300"}
            `,children:[Ve.label,Ve.key==="notebook"&&h.jsx("span",{className:"ml-1 min-w-[1em] text-center text-[10px] text-gray-500 tabular-nums inline-block",children:Oe.length})]},Ve.key))}),h.jsx("div",{className:`flex-1 flex flex-col min-h-0 ${l==="chat"?"":"overflow-y-auto p-4"}`,children:n?g?h.jsx("div",{className:"flex items-center justify-center h-full text-sm text-gray-500",children:r("common.loading")}):f?h.jsxs(h.Fragment,{children:[l==="info"&&h.jsxs("div",{className:"flex-1 flex flex-col",children:[h.jsxs("div",{className:"flex-1",children:[h.jsx("h3",{className:"mt-2 text-[11px] font-semibold uppercase tracking-wider text-gray-500",children:"Summary"}),h.jsx("p",{className:"mt-2 text-[13px] leading-[1.6] text-gray-400",children:f.summary||r("detailPanel.noHighlights")}),h.jsx("div",{className:"mt-6",children:nt.map(Ve=>h.jsxs("div",{className:"flex items-center py-2.5 border-b border-white/5 last:border-b-0",children:[h.jsxs("span",{className:"flex items-center gap-1.5 text-[12px] text-gray-500 w-[120px] shrink-0",children:[Ve.icon,Ve.label]}),h.jsx("span",{className:"text-[13px] text-white truncate",children:Ve.value||"â€”"})]},Ve.label))}),h.jsxs("div",{className:"mt-6",children:[h.jsxs("div",{className:"flex items-center gap-1.5 mb-2",children:[h.jsx(Z1,{className:"w-3.5 h-3.5 text-gray-500"}),h.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-wider text-gray-500",children:"Tags"})]}),h.jsx(AU,{articleId:f.id})]}),h.jsxs("div",{className:"mt-6",children:[h.jsxs("div",{className:"flex items-center gap-1.5 mb-3",children:[h.jsx(jb,{className:"w-3.5 h-3.5 text-gray-500"}),h.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-wider text-gray-500",children:r("ai.aiActions")})]}),h.jsxs("div",{className:"flex flex-col gap-2",children:[h.jsxs("div",{className:"rounded-lg bg-[#1a1a1a] border border-white/5 p-3",children:[h.jsxs("button",{onClick:we,disabled:S,className:"flex items-center gap-2 text-[13px] text-gray-300 hover:text-white transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed w-full",children:[S?h.jsx(xt,{className:"w-4 h-4 animate-spin text-blue-400"}):h.jsx(jb,{className:"w-4 h-4 text-blue-400"}),h.jsx("span",{children:r(S?"ai.generating":"ai.summarize")})]}),k&&h.jsx("p",{className:"mt-2 text-[13px] text-gray-300 leading-[1.6] border-t border-white/5 pt-2",children:k}),D&&h.jsx("p",{className:"mt-2 text-[12px] text-red-400 border-t border-white/5 pt-2",children:D})]}),h.jsxs("div",{className:"rounded-lg bg-[#1a1a1a] border border-white/5 p-3",children:[h.jsxs("button",{onClick:()=>{P||I(!M)},disabled:P,className:"flex items-center gap-2 text-[13px] text-gray-300 hover:text-white transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed w-full",children:[P?h.jsx(xt,{className:"w-4 h-4 animate-spin text-green-400"}):h.jsx($F,{className:"w-4 h-4 text-green-400"}),h.jsx("span",{children:r(P?"ai.generating":"ai.translate")})]}),M&&h.jsx("div",{className:"mt-2 flex gap-2 border-t border-white/5 pt-2",children:[{key:"zh",label:r("ai.chinese")},{key:"en",label:r("ai.english")},{key:"ja",label:r("ai.japanese")}].map(Ve=>h.jsx("button",{onClick:()=>He(Ve.key),className:"px-2.5 py-1 text-[12px] rounded-md bg-white/5 text-gray-400 hover:bg-white/10 hover:text-white transition-colors cursor-pointer",children:Ve.label},Ve.key))}),G&&h.jsxs("div",{className:"mt-2 border-t border-white/5 pt-2",children:[h.jsx("p",{className:"text-[13px] text-white font-medium",children:G.title}),h.jsx("p",{className:"mt-1 text-[13px] text-gray-300 leading-[1.6] line-clamp-6",children:G.content})]}),Y&&h.jsx("p",{className:"mt-2 text-[12px] text-red-400 border-t border-white/5 pt-2",children:Y})]}),h.jsxs("div",{className:"rounded-lg bg-[#1a1a1a] border border-white/5 p-3",children:[h.jsxs("button",{onClick:ke,disabled:V,className:"flex items-center gap-2 text-[13px] text-gray-300 hover:text-white transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed w-full",children:[V?h.jsx(xt,{className:"w-4 h-4 animate-spin text-purple-400"}):h.jsx(Wz,{className:"w-4 h-4 text-purple-400"}),h.jsx("span",{children:r(V?"ai.generating":"ai.autoTag")})]}),ge&&h.jsxs("div",{className:"mt-2 border-t border-white/5 pt-2",children:[h.jsx("p",{className:"text-[11px] text-gray-500 mb-1.5",children:r("ai.suggestedTags")}),h.jsx("div",{className:"flex flex-wrap gap-1.5",children:ge.map(Ve=>h.jsx("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 text-[12px] rounded-md bg-purple-500/10 text-purple-300 border border-purple-500/20",children:Ve},Ve))})]}),me&&h.jsx("p",{className:"mt-2 text-[12px] text-red-400 border-t border-white/5 pt-2",children:me})]}),h.jsxs("div",{className:"rounded-lg bg-[#1a1a1a] border border-white/5 p-3",children:[h.jsxs("button",{onClick:Ae,disabled:ae,className:"flex items-center gap-2 text-[13px] text-gray-300 hover:text-white transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed w-full",children:[ae?h.jsx(xt,{className:"w-4 h-4 animate-spin text-emerald-400"}):h.jsx(Wj,{className:"w-4 h-4 text-emerald-400"}),h.jsx("span",{children:r(ae?"ai.generating":"ai.extractTopics")})]}),re&&h.jsxs("div",{className:"mt-2 border-t border-white/5 pt-2",children:[h.jsx("p",{className:"text-[11px] text-gray-500 mb-1.5",children:r("ai.topics")}),h.jsx("div",{className:"flex flex-wrap gap-1.5",children:re.topics.map((Ve,ce)=>h.jsx("span",{className:"px-2 py-0.5 rounded-full bg-emerald-500/10 text-emerald-400 text-xs",children:Ve},ce))})]}),xe&&h.jsx("p",{className:"mt-2 text-[12px] text-red-400 border-t border-white/5 pt-2",children:xe})]})]})]})]}),h.jsxs("div",{className:"mt-6 rounded-lg bg-[#1a1a1a] border border-white/5 p-3",children:[h.jsxs("div",{className:"flex items-center justify-between text-[12px]",children:[h.jsx("span",{className:"text-gray-500",children:r("books.readStatus")}),h.jsx("span",{className:"text-white font-medium",children:Qe[f.readStatus]??f.readStatus})]}),h.jsxs("div",{className:"mt-2",children:[h.jsxs("div",{className:"flex items-center justify-between text-[12px] mb-1",children:[h.jsx("span",{className:"text-gray-500",children:r("books.progress")}),h.jsxs("span",{className:"text-white font-medium",children:[Math.round(f.readProgress*100),"%"]})]}),h.jsx("div",{className:"w-full h-1 rounded-full bg-white/10",children:h.jsx("div",{className:"h-1 rounded-full bg-blue-500 transition-all",style:{width:`${Math.round(f.readProgress*100)}%`}})})]})]})]}),l==="notebook"&&h.jsx("div",{className:"flex-1 flex flex-col",children:Oe.length===0?h.jsx("div",{className:"flex items-center justify-center h-full",children:h.jsxs("div",{className:"text-center text-gray-500",children:[h.jsx(av,{className:"w-8 h-8 mx-auto mb-2 opacity-40"}),h.jsx("p",{className:"text-sm",children:r("detailPanel.noHighlights")})]})}):h.jsxs("div",{className:"flex flex-col gap-2",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("span",{className:"text-[11px] font-semibold uppercase tracking-wider text-gray-500",children:[Oe.length," ",r("detailPanel.highlights").toLowerCase()]}),h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsx("button",{onClick:()=>Ze("clipboard"),className:"p-1 rounded hover:bg-white/10 text-gray-500 hover:text-white transition-colors cursor-pointer",title:r("common.copy"),children:h.jsx(rv,{className:"w-3.5 h-3.5"})}),h.jsx("button",{onClick:()=>Ze("file"),className:"p-1 rounded hover:bg-white/10 text-gray-500 hover:text-white transition-colors cursor-pointer",title:r("common.export"),children:h.jsx(vl,{className:"w-3.5 h-3.5"})})]})]}),Oe.map(Ve=>h.jsxs("div",{className:`group relative flex rounded-lg bg-[#1a1a1a] border border-white/5 overflow-hidden ${s?"cursor-pointer hover:border-white/10":""}`,onClick:()=>s==null?void 0:s(Ve.id),children:[h.jsx("div",{className:"w-[3px] shrink-0",style:{backgroundColor:Lk[Ve.color]??Lk.yellow}}),h.jsxs("div",{className:"flex-1 p-3 min-w-0",children:[h.jsxs("p",{className:"text-[13px] leading-[1.6] text-gray-300 italic",children:["â€œ",Ve.text,"â€"]}),m===Ve.id?h.jsx("textarea",{autoFocus:!0,value:b,onChange:ce=>A(ce.target.value),onBlur:()=>Fe(Ve.id,b),onKeyDown:ce=>{ce.key==="Enter"&&!ce.shiftKey&&(ce.preventDefault(),Fe(Ve.id,b)),ce.key==="Escape"&&v(null)},className:"mt-1.5 w-full text-[12px] text-gray-300 bg-white/5 border border-white/10 rounded px-2 py-1.5 resize-none outline-none focus:border-blue-500/50",rows:2,placeholder:r("detailPanel.addNote")}):h.jsx("button",{onClick:()=>{v(Ve.id),A(Ve.note||"")},className:"mt-1.5 block text-left text-[12px] text-gray-400 hover:text-gray-300 transition-colors w-full",children:Ve.note||r("detailPanel.addNote")}),h.jsx("span",{className:"mt-2 block text-[11px] text-gray-600",children:DU(Ve.createdAt,r)})]}),h.jsx("button",{onClick:()=>Ce(Ve.id),className:"absolute top-2 right-2 p-1 rounded opacity-0 group-hover:opacity-100 hover:bg-white/10 transition-all cursor-pointer text-gray-500 hover:text-red-400",children:h.jsx(rs,{className:"w-3.5 h-3.5"})})]},Ve.id))]})}),l==="chat"&&h.jsx("div",{className:"flex-1 flex flex-col min-h-0",children:h.jsx(lR,{articleId:n})})]}):h.jsx("div",{className:"flex items-center justify-center h-full text-sm text-gray-500",children:r("errors.notFound")}):h.jsx("div",{className:"flex items-center justify-center h-full text-sm text-gray-500",children:r("detailPanel.noSelection")})})]})]})}function RU(n,e){if(n.match(/^[a-z]+:\/\//i))return n;if(n.match(/^\/\//))return window.location.protocol+n;if(n.match(/^[a-z]+:/i))return n;const t=document.implementation.createHTMLDocument(),i=t.createElement("base"),s=t.createElement("a");return t.head.appendChild(i),t.body.appendChild(s),e&&(i.href=e),s.href=n,s.href}const LU=(()=>{let n=0;const e=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(n+=1,`u${e()}${n}`)})();function Xc(n){const e=[];for(let t=0,i=n.length;t<i;t++)e.push(n[t]);return e}let dd=null;function cR(n={}){return dd||(n.includeStyleProperties?(dd=n.includeStyleProperties,dd):(dd=Xc(window.getComputedStyle(document.documentElement)),dd))}function Rb(n,e){const i=(n.ownerDocument.defaultView||window).getComputedStyle(n).getPropertyValue(e);return i?parseFloat(i.replace("px","")):0}function MU(n){const e=Rb(n,"border-left-width"),t=Rb(n,"border-right-width");return n.clientWidth+e+t}function OU(n){const e=Rb(n,"border-top-width"),t=Rb(n,"border-bottom-width");return n.clientHeight+e+t}function uR(n,e={}){const t=e.width||MU(n),i=e.height||OU(n);return{width:t,height:i}}function IU(){let n,e;try{e=process}catch{}const t=e&&e.env?e.env.devicePixelRatio:null;return t&&(n=parseInt(t,10),Number.isNaN(n)&&(n=1)),n||window.devicePixelRatio||1}const js=16384;function PU(n){(n.width>js||n.height>js)&&(n.width>js&&n.height>js?n.width>n.height?(n.height*=js/n.width,n.width=js):(n.width*=js/n.height,n.height=js):n.width>js?(n.height*=js/n.width,n.width=js):(n.width*=js/n.height,n.height=js))}function Lb(n){return new Promise((e,t)=>{const i=new Image;i.onload=()=>{i.decode().then(()=>{requestAnimationFrame(()=>e(i))})},i.onerror=t,i.crossOrigin="anonymous",i.decoding="async",i.src=n})}async function BU(n){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(n)).then(encodeURIComponent).then(e=>`data:image/svg+xml;charset=utf-8,${e}`)}async function FU(n,e,t){const i="http://www.w3.org/2000/svg",s=document.createElementNS(i,"svg"),r=document.createElementNS(i,"foreignObject");return s.setAttribute("width",`${e}`),s.setAttribute("height",`${t}`),s.setAttribute("viewBox",`0 0 ${e} ${t}`),r.setAttribute("width","100%"),r.setAttribute("height","100%"),r.setAttribute("x","0"),r.setAttribute("y","0"),r.setAttribute("externalResourcesRequired","true"),s.appendChild(r),r.appendChild(n),BU(s)}const _s=(n,e)=>{if(n instanceof e)return!0;const t=Object.getPrototypeOf(n);return t===null?!1:t.constructor.name===e.name||_s(t,e)};function zU(n){const e=n.getPropertyValue("content");return`${n.cssText} content: '${e.replace(/'|"/g,"")}';`}function UU(n,e){return cR(e).map(t=>{const i=n.getPropertyValue(t),s=n.getPropertyPriority(t);return`${t}: ${i}${s?" !important":""};`}).join(" ")}function HU(n,e,t,i){const s=`.${n}:${e}`,r=t.cssText?zU(t):UU(t,i);return document.createTextNode(`${s}{${r}}`)}function Mk(n,e,t,i){const s=window.getComputedStyle(n,t),r=s.getPropertyValue("content");if(r===""||r==="none")return;const a=LU();try{e.className=`${e.className} ${a}`}catch{return}const o=document.createElement("style");o.appendChild(HU(a,t,s,i)),e.appendChild(o)}function $U(n,e,t){Mk(n,e,":before",t),Mk(n,e,":after",t)}const Ok="application/font-woff",Ik="image/jpeg",qU={woff:Ok,woff2:Ok,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:Ik,jpeg:Ik,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function VU(n){const e=/\.([^./]*?)$/g.exec(n);return e?e[1]:""}function $C(n){const e=VU(n).toLowerCase();return qU[e]||""}function GU(n){return n.split(/,/)[1]}function qS(n){return n.search(/^(data:)/)!==-1}function YU(n,e){return`data:${e};base64,${n}`}async function hR(n,e,t){const i=await fetch(n,e);if(i.status===404)throw new Error(`Resource "${i.url}" not found`);const s=await i.blob();return new Promise((r,a)=>{const o=new FileReader;o.onerror=a,o.onloadend=()=>{try{r(t({res:i,result:o.result}))}catch(l){a(l)}},o.readAsDataURL(s)})}const p2={};function WU(n,e,t){let i=n.replace(/\?.*/,"");return t&&(i=n),/ttf|otf|eot|woff2?/i.test(i)&&(i=i.replace(/.*\//,"")),e?`[${e}]${i}`:i}async function qC(n,e,t){const i=WU(n,e,t.includeQueryParams);if(p2[i]!=null)return p2[i];t.cacheBust&&(n+=(/\?/.test(n)?"&":"?")+new Date().getTime());let s;try{const r=await hR(n,t.fetchRequestInit,({res:a,result:o})=>(e||(e=a.headers.get("Content-Type")||""),GU(o)));s=YU(r,e)}catch(r){s=t.imagePlaceholder||"";let a=`Failed to fetch resource: ${n}`;r&&(a=typeof r=="string"?r:r.message),a&&console.warn(a)}return p2[i]=s,s}async function XU(n){const e=n.toDataURL();return e==="data:,"?n.cloneNode(!1):Lb(e)}async function KU(n,e){if(n.currentSrc){const r=document.createElement("canvas"),a=r.getContext("2d");r.width=n.clientWidth,r.height=n.clientHeight,a==null||a.drawImage(n,0,0,r.width,r.height);const o=r.toDataURL();return Lb(o)}const t=n.poster,i=$C(t),s=await qC(t,i,e);return Lb(s)}async function ZU(n,e){var t;try{if(!((t=n==null?void 0:n.contentDocument)===null||t===void 0)&&t.body)return await Q1(n.contentDocument.body,e,!0)}catch{}return n.cloneNode(!1)}async function QU(n,e){return _s(n,HTMLCanvasElement)?XU(n):_s(n,HTMLVideoElement)?KU(n,e):_s(n,HTMLIFrameElement)?ZU(n,e):n.cloneNode(dR(n))}const JU=n=>n.tagName!=null&&n.tagName.toUpperCase()==="SLOT",dR=n=>n.tagName!=null&&n.tagName.toUpperCase()==="SVG";async function e9(n,e,t){var i,s;if(dR(e))return e;let r=[];return JU(n)&&n.assignedNodes?r=Xc(n.assignedNodes()):_s(n,HTMLIFrameElement)&&(!((i=n.contentDocument)===null||i===void 0)&&i.body)?r=Xc(n.contentDocument.body.childNodes):r=Xc(((s=n.shadowRoot)!==null&&s!==void 0?s:n).childNodes),r.length===0||_s(n,HTMLVideoElement)||await r.reduce((a,o)=>a.then(()=>Q1(o,t)).then(l=>{l&&e.appendChild(l)}),Promise.resolve()),e}function t9(n,e,t){const i=e.style;if(!i)return;const s=window.getComputedStyle(n);s.cssText?(i.cssText=s.cssText,i.transformOrigin=s.transformOrigin):cR(t).forEach(r=>{let a=s.getPropertyValue(r);r==="font-size"&&a.endsWith("px")&&(a=`${Math.floor(parseFloat(a.substring(0,a.length-2)))-.1}px`),_s(n,HTMLIFrameElement)&&r==="display"&&a==="inline"&&(a="block"),r==="d"&&e.getAttribute("d")&&(a=`path(${e.getAttribute("d")})`),i.setProperty(r,a,s.getPropertyPriority(r))})}function i9(n,e){_s(n,HTMLTextAreaElement)&&(e.innerHTML=n.value),_s(n,HTMLInputElement)&&e.setAttribute("value",n.value)}function n9(n,e){if(_s(n,HTMLSelectElement)){const t=e,i=Array.from(t.children).find(s=>n.value===s.getAttribute("value"));i&&i.setAttribute("selected","")}}function s9(n,e,t){return _s(e,Element)&&(t9(n,e,t),$U(n,e,t),i9(n,e),n9(n,e)),e}async function r9(n,e){const t=n.querySelectorAll?n.querySelectorAll("use"):[];if(t.length===0)return n;const i={};for(let r=0;r<t.length;r++){const o=t[r].getAttribute("xlink:href");if(o){const l=n.querySelector(o),u=document.querySelector(o);!l&&u&&!i[o]&&(i[o]=await Q1(u,e,!0))}}const s=Object.values(i);if(s.length){const r="http://www.w3.org/1999/xhtml",a=document.createElementNS(r,"svg");a.setAttribute("xmlns",r),a.style.position="absolute",a.style.width="0",a.style.height="0",a.style.overflow="hidden",a.style.display="none";const o=document.createElementNS(r,"defs");a.appendChild(o);for(let l=0;l<s.length;l++)o.appendChild(s[l]);n.appendChild(a)}return n}async function Q1(n,e,t){return!t&&e.filter&&!e.filter(n)?null:Promise.resolve(n).then(i=>QU(i,e)).then(i=>e9(n,i,e)).then(i=>s9(n,i,e)).then(i=>r9(i,e))}const fR=/url\((['"]?)([^'"]+?)\1\)/g,a9=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,o9=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function l9(n){const e=n.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${e})(['"]?\\))`,"g")}function c9(n){const e=[];return n.replace(fR,(t,i,s)=>(e.push(s),t)),e.filter(t=>!qS(t))}async function u9(n,e,t,i,s){try{const r=t?RU(e,t):e,a=$C(e);let o;return s||(o=await qC(r,a,i)),n.replace(l9(e),`$1${o}$3`)}catch{}return n}function h9(n,{preferredFontFormat:e}){return e?n.replace(o9,t=>{for(;;){const[i,,s]=a9.exec(t)||[];if(!s)return"";if(s===e)return`src: ${i};`}}):n}function pR(n){return n.search(fR)!==-1}async function gR(n,e,t){if(!pR(n))return n;const i=h9(n,t);return c9(i).reduce((r,a)=>r.then(o=>u9(o,a,e,t)),Promise.resolve(i))}async function fd(n,e,t){var i;const s=(i=e.style)===null||i===void 0?void 0:i.getPropertyValue(n);if(s){const r=await gR(s,null,t);return e.style.setProperty(n,r,e.style.getPropertyPriority(n)),!0}return!1}async function d9(n,e){await fd("background",n,e)||await fd("background-image",n,e),await fd("mask",n,e)||await fd("-webkit-mask",n,e)||await fd("mask-image",n,e)||await fd("-webkit-mask-image",n,e)}async function f9(n,e){const t=_s(n,HTMLImageElement);if(!(t&&!qS(n.src))&&!(_s(n,SVGImageElement)&&!qS(n.href.baseVal)))return;const i=t?n.src:n.href.baseVal,s=await qC(i,$C(i),e);await new Promise((r,a)=>{n.onload=r,n.onerror=e.onImageErrorHandler?(...l)=>{try{r(e.onImageErrorHandler(...l))}catch(u){a(u)}}:a;const o=n;o.decode&&(o.decode=r),o.loading==="lazy"&&(o.loading="eager"),t?(n.srcset="",n.src=s):n.href.baseVal=s})}async function p9(n,e){const i=Xc(n.childNodes).map(s=>mR(s,e));await Promise.all(i).then(()=>n)}async function mR(n,e){_s(n,Element)&&(await d9(n,e),await f9(n,e),await p9(n,e))}function g9(n,e){const{style:t}=n;e.backgroundColor&&(t.backgroundColor=e.backgroundColor),e.width&&(t.width=`${e.width}px`),e.height&&(t.height=`${e.height}px`);const i=e.style;return i!=null&&Object.keys(i).forEach(s=>{t[s]=i[s]}),n}const Pk={};async function Bk(n){let e=Pk[n];if(e!=null)return e;const i=await(await fetch(n)).text();return e={url:n,cssText:i},Pk[n]=e,e}async function Fk(n,e){let t=n.cssText;const i=/url\(["']?([^"')]+)["']?\)/g,r=(t.match(/url\([^)]+\)/g)||[]).map(async a=>{let o=a.replace(i,"$1");return o.startsWith("https://")||(o=new URL(o,n.url).href),hR(o,e.fetchRequestInit,({result:l})=>(t=t.replace(a,`url(${l})`),[a,l]))});return Promise.all(r).then(()=>t)}function zk(n){if(n==null)return[];const e=[],t=/(\/\*[\s\S]*?\*\/)/gi;let i=n.replace(t,"");const s=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const l=s.exec(i);if(l===null)break;e.push(l[0])}i=i.replace(s,"");const r=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,a="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",o=new RegExp(a,"gi");for(;;){let l=r.exec(i);if(l===null){if(l=o.exec(i),l===null)break;r.lastIndex=o.lastIndex}else o.lastIndex=r.lastIndex;e.push(l[0])}return e}async function m9(n,e){const t=[],i=[];return n.forEach(s=>{if("cssRules"in s)try{Xc(s.cssRules||[]).forEach((r,a)=>{if(r.type===CSSRule.IMPORT_RULE){let o=a+1;const l=r.href,u=Bk(l).then(d=>Fk(d,e)).then(d=>zk(d).forEach(f=>{try{s.insertRule(f,f.startsWith("@import")?o+=1:s.cssRules.length)}catch(p){console.error("Error inserting rule from remote css",{rule:f,error:p})}})).catch(d=>{console.error("Error loading remote css",d.toString())});i.push(u)}})}catch(r){const a=n.find(o=>o.href==null)||document.styleSheets[0];s.href!=null&&i.push(Bk(s.href).then(o=>Fk(o,e)).then(o=>zk(o).forEach(l=>{a.insertRule(l,a.cssRules.length)})).catch(o=>{console.error("Error loading remote stylesheet",o)})),console.error("Error inlining remote css file",r)}}),Promise.all(i).then(()=>(n.forEach(s=>{if("cssRules"in s)try{Xc(s.cssRules||[]).forEach(r=>{t.push(r)})}catch(r){console.error(`Error while reading CSS rules from ${s.href}`,r)}}),t))}function y9(n){return n.filter(e=>e.type===CSSRule.FONT_FACE_RULE).filter(e=>pR(e.style.getPropertyValue("src")))}async function v9(n,e){if(n.ownerDocument==null)throw new Error("Provided element is not within a Document");const t=Xc(n.ownerDocument.styleSheets),i=await m9(t,e);return y9(i)}function yR(n){return n.trim().replace(/["']/g,"")}function x9(n){const e=new Set;function t(i){(i.style.fontFamily||getComputedStyle(i).fontFamily).split(",").forEach(r=>{e.add(yR(r))}),Array.from(i.children).forEach(r=>{r instanceof HTMLElement&&t(r)})}return t(n),e}async function b9(n,e){const t=await v9(n,e),i=x9(n);return(await Promise.all(t.filter(r=>i.has(yR(r.style.fontFamily))).map(r=>{const a=r.parentStyleSheet?r.parentStyleSheet.href:null;return gR(r.cssText,a,e)}))).join(`
`)}async function w9(n,e){const t=e.fontEmbedCSS!=null?e.fontEmbedCSS:e.skipFonts?null:await b9(n,e);if(t){const i=document.createElement("style"),s=document.createTextNode(t);i.appendChild(s),n.firstChild?n.insertBefore(i,n.firstChild):n.appendChild(i)}}async function S9(n,e={}){const{width:t,height:i}=uR(n,e),s=await Q1(n,e,!0);return await w9(s,e),await mR(s,e),g9(s,e),await FU(s,t,i)}async function A9(n,e={}){const{width:t,height:i}=uR(n,e),s=await S9(n,e),r=await Lb(s),a=document.createElement("canvas"),o=a.getContext("2d"),l=e.pixelRatio||IU(),u=e.canvasWidth||t,d=e.canvasHeight||i;return a.width=u*l,a.height=d*l,e.skipAutoScale||PU(a),a.style.width=`${u}`,a.style.height=`${d}`,e.backgroundColor&&(o.fillStyle=e.backgroundColor,o.fillRect(0,0,a.width,a.height)),o.drawImage(r,0,0,a.width,a.height),a}async function E9(n,e={}){return(await A9(n,e)).toDataURL()}function C9(n,e){return n?n.length>e?n.slice(0,e)+"...":n:""}function _9(n){if(!n)return"";try{const e=new Date(n),t=e.getFullYear(),i=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return`${t}-${i}-${s}`}catch{return""}}const N9=({highlight:n,article:e,theme:t})=>{const i=`quote-${t.styles.quoteStyle}`,s=_9(new Date().toISOString());return h.jsx("div",{className:`share-card ${t.cssClass}`,style:{"--accent-color":t.styles.accentColor,borderRadius:t.styles.cardRadius,padding:t.styles.padding,fontFamily:t.styles.fontFamily},children:h.jsxs("div",{className:"card-content",children:[h.jsx("div",{className:"card-title",style:{fontSize:"1.125rem",marginBottom:"6px"},children:e.title??"æ— æ ‡é¢˜"}),h.jsxs("div",{className:"card-meta",style:{marginBottom:"16px"},children:[e.author&&h.jsx("span",{children:e.author}),e.author&&e.domain&&h.jsx("span",{children:" Â· "}),e.domain&&h.jsx("span",{className:"card-source",children:e.domain})]}),h.jsx("div",{className:i,style:{marginBottom:"14px"},children:h.jsx("span",{className:"quote-text",children:C9(n.text,300)})}),n.note&&n.note.trim()!==""&&h.jsx("div",{className:"card-note",style:{fontSize:"0.85rem",opacity:.75,marginBottom:"14px",paddingLeft:"8px"},children:n.note}),h.jsx("div",{className:"card-divider"}),h.jsxs("div",{className:"card-branding",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"4px"},children:[h.jsx("span",{children:"Z-Reader"}),h.jsx("span",{children:s})]})]})})},Uk=10,k9=150;function T9(n,e){return n?n.length>e?n.slice(0,e)+"...":n:""}function D9(n){if(!n)return"";try{const e=new Date(n),t=e.getFullYear(),i=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return`${t}-${i}-${s}`}catch{return""}}const j9=({highlights:n,article:e,theme:t})=>{const i=D9(new Date().toISOString()),s=n.length,r=n.slice(0,Uk),a=s-Uk;return h.jsx("div",{className:`share-card ${t.cssClass}`,style:{"--accent-color":t.styles.accentColor,borderRadius:t.styles.cardRadius,padding:t.styles.padding,fontFamily:t.styles.fontFamily},children:h.jsxs("div",{className:"card-content",children:[h.jsx("div",{className:"card-title",style:{fontSize:"1.125rem",marginBottom:"6px"},children:e.title??"æ— æ ‡é¢˜"}),h.jsxs("div",{className:"card-meta",style:{marginBottom:"16px"},children:[e.author&&h.jsx("span",{children:e.author}),e.author&&e.domain&&h.jsx("span",{children:" Â· "}),e.domain&&h.jsx("span",{className:"card-source",children:e.domain})]}),h.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px",marginBottom:"14px"},children:[r.map(o=>h.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"flex-start"},children:[h.jsx("span",{style:{color:"var(--accent-color)",flexShrink:0,lineHeight:"1.6",fontSize:"0.75rem"},children:"â—"}),h.jsxs("div",{style:{flex:1},children:[h.jsxs("span",{className:"quote-text",style:{lineHeight:"1.6"},children:["ã€Œ",T9(o.text,k9),"ã€"]}),o.note&&o.note.trim()!==""&&h.jsx("div",{className:"card-note",style:{fontSize:"0.8rem",opacity:.7,marginTop:"4px"},children:o.note})]})]},o.id)),a>0&&h.jsxs("div",{style:{fontSize:"0.8rem",opacity:.55,textAlign:"center",paddingTop:"4px"},children:["è¿˜æœ‰ ",a," æ¡é«˜äº®"]})]}),h.jsx("div",{className:"card-divider"}),h.jsxs("div",{className:"card-branding",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"4px"},children:[h.jsx("span",{children:"Z-Reader"}),h.jsxs("span",{children:["å…± ",s," æ¡é«˜äº®"]}),h.jsx("span",{children:i})]})]})})},Hk=10,R9=150;function L9(n,e){return n?n.length>e?n.slice(0,e)+"...":n:""}function M9(n){if(!n)return"";try{const e=new Date(n),t=e.getFullYear(),i=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return`${t}-${i}-${s}`}catch{return""}}const O9=({highlights:n,article:e,theme:t})=>{const i=n.length,s=n.slice(0,Hk),r=i-Hk;return h.jsx("div",{className:`share-card ${t.cssClass}`,style:{"--accent-color":t.styles.accentColor,borderRadius:t.styles.cardRadius,padding:t.styles.padding,fontFamily:t.styles.fontFamily},children:h.jsxs("div",{className:"card-content",children:[h.jsx("div",{className:"card-title",style:{fontSize:"1.5rem",marginBottom:"8px"},children:e.title??"æ— æ ‡é¢˜"}),h.jsxs("div",{className:"card-meta",style:{marginBottom:"16px"},children:[e.author&&h.jsx("span",{children:e.author}),e.author&&e.domain&&h.jsx("span",{children:" Â· "}),e.domain&&h.jsx("span",{className:"card-source",children:e.domain}),(e.author||e.domain)&&e.publishedAt&&h.jsx("span",{children:" Â· "}),e.publishedAt&&h.jsx("span",{children:M9(e.publishedAt)})]}),h.jsx("div",{className:"card-divider"}),h.jsx("div",{style:{fontSize:"0.85rem",fontWeight:600,opacity:.65,marginBottom:"12px",letterSpacing:"0.05em"},children:"ç²¾é€‰ç¬”è®°"}),h.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"10px",marginBottom:"14px"},children:[s.map(a=>h.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"flex-start"},children:[h.jsx("span",{style:{color:"var(--accent-color)",flexShrink:0,lineHeight:"1.6",fontSize:"0.75rem"},children:"â—"}),h.jsxs("div",{style:{flex:1},children:[h.jsxs("span",{className:"quote-text",style:{lineHeight:"1.6"},children:["ã€Œ",L9(a.text,R9),"ã€"]}),a.note&&a.note.trim()!==""&&h.jsx("div",{className:"card-note",style:{fontSize:"0.8rem",opacity:.7,marginTop:"4px"},children:a.note})]})]},a.id)),r>0&&h.jsxs("div",{style:{fontSize:"0.8rem",opacity:.55,textAlign:"center",paddingTop:"4px"},children:["è¿˜æœ‰ ",r," æ¡é«˜äº®"]})]}),h.jsx("div",{className:"card-divider"}),h.jsxs("div",{className:"card-branding",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"4px"},children:[h.jsx("span",{children:"Z-Reader"}),h.jsxs("span",{children:["å…± ",i," æ¡é«˜äº®"]})]})]})})},vR=i6.forwardRef(({cardType:n,theme:e,highlights:t,article:i},s)=>{const r=()=>{if(t.length===0)return h.jsx("div",{style:{padding:"40px 20px",textAlign:"center",opacity:.5},children:"è¯·è‡³å°‘é€‰æ‹©ä¸€æ¡é«˜äº®"});switch(n){case"single":return h.jsx(N9,{highlight:t[0],article:i,theme:e});case"multi":return h.jsx(j9,{highlights:t,article:i,theme:e});case"summary":return h.jsx(O9,{highlights:t,article:i,theme:e});default:return null}};return h.jsx("div",{ref:s,className:e.cssClass,style:{width:420,background:e.styles.background,color:e.styles.textColor,fontFamily:e.styles.fontFamily,borderRadius:e.styles.cardRadius,padding:e.styles.padding},children:r()})});vR.displayName="CardRenderer";const I9=({rendererRef:n,cardType:e,theme:t,highlights:i,article:s})=>h.jsx("div",{className:"card-preview-canvas",style:{height:560,overflowY:"auto",background:"#1a1a1a",backgroundImage:"radial-gradient(circle, rgba(255,255,255,0.08) 1px, transparent 1px)",backgroundSize:"16px 16px",borderRadius:8,display:"flex",justifyContent:"center",alignItems:"flex-start",padding:"32px 16px"},children:h.jsx(vR,{ref:n,cardType:e,theme:t,highlights:i,article:s})}),P9={id:"swiss-design",name:"Swiss Design",category:"classic",styles:{background:"#ffffff",textColor:"#1a1a1a",accentColor:"#e63333",fontFamily:'"Helvetica Neue", Helvetica, "PingFang SC", "Noto Sans SC", Arial, sans-serif',quoteStyle:"border-left",cardRadius:"0px",padding:"40px"},cssClass:"theme-swiss-design"},B9={id:"minimalism",name:"Minimalism",category:"classic",styles:{background:"#fafafa",textColor:"#333333",accentColor:"#999999",fontFamily:'"SF Pro Text", -apple-system, "PingFang SC", "Noto Sans SC", sans-serif',quoteStyle:"minimal",cardRadius:"4px",padding:"48px"},cssClass:"theme-minimalism"},F9={id:"ink-wash",name:"æ°´å¢¨",category:"artistic",styles:{background:"#f5f0e8",textColor:"#2c2416",accentColor:"#5a4a3a",fontFamily:'"Noto Serif SC", "Source Han Serif SC", "Songti SC", "SimSun", serif',quoteStyle:"border-left",cardRadius:"8px",padding:"44px"},cssClass:"theme-ink-wash"},z9={id:"cyberpunk",name:"Cyberpunk",category:"digital",styles:{background:"#0a0a0f",textColor:"#e0e0e8",accentColor:"#00ffcc",fontFamily:'"JetBrains Mono", "Fira Code", "SF Mono", "Noto Sans SC", monospace',quoteStyle:"highlight-bg",cardRadius:"0px",padding:"36px"},cssClass:"theme-cyberpunk"},U9={id:"risograph",name:"Risograph",category:"retro",styles:{background:"#fef5f0",textColor:"#1a2744",accentColor:"#e8614d",fontFamily:'"Georgia", "Noto Serif SC", "Times New Roman", serif',quoteStyle:"quotation-marks",cardRadius:"4px",padding:"40px"},cssClass:"theme-risograph"},VS=[P9,B9,F9,z9,U9],H9=n=>VS.find(e=>e.id===n)??VS[0],$9=({selectedThemeId:n,onSelectTheme:e})=>h.jsx("div",{className:"grid grid-cols-3 gap-2",children:VS.map(t=>{const i=t.id===n;return h.jsxs("button",{type:"button",onClick:()=>e(t.id),className:`
              flex flex-col items-center gap-1.5 p-2 rounded-lg cursor-pointer
              transition-all duration-150
              border-2
              ${i?"border-blue-500 ring-2 ring-blue-500/30 bg-[#2a2a30]":"border-transparent hover:border-[#444] bg-[#1e1e24]"}
            `,children:[h.jsxs("div",{className:"w-full h-10 rounded overflow-hidden relative",style:{background:t.styles.background},children:[h.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1.5",style:{background:t.styles.accentColor}}),h.jsxs("div",{className:"absolute top-2 left-2 right-4 space-y-1",children:[h.jsx("div",{className:"h-[3px] rounded-full opacity-30",style:{background:t.styles.textColor,width:"70%"}}),h.jsx("div",{className:"h-[3px] rounded-full opacity-20",style:{background:t.styles.textColor,width:"50%"}})]})]}),h.jsx("span",{className:"text-[11px] text-[#aaa] truncate w-full text-center",children:t.name})]},t.id)})}),$k={yellow:"#fbbf24",blue:"#3b82f6",green:"#22c55e",red:"#ef4444"},q9=({highlights:n,selectedIds:e,onToggle:t,onSelectAll:i,onDeselectAll:s})=>{const r=n.length>0&&e.size===n.length;return h.jsxs("div",{className:"flex flex-col gap-2",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("span",{className:"text-xs text-[#888]",children:["å·²é€‰ ",e.size,"/",n.length]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("button",{type:"button",onClick:i,disabled:r,className:"text-xs text-blue-400 hover:text-blue-300 disabled:text-[#555] disabled:cursor-not-allowed transition-colors",children:"å…¨é€‰"}),h.jsx("button",{type:"button",onClick:s,disabled:e.size===0,className:"text-xs text-blue-400 hover:text-blue-300 disabled:text-[#555] disabled:cursor-not-allowed transition-colors",children:"å–æ¶ˆå…¨é€‰"})]})]}),h.jsx("div",{className:"flex flex-col gap-1 max-h-48 overflow-y-auto pr-1",children:n.length===0?h.jsx("p",{className:"text-xs text-[#666] text-center py-4",children:"æš‚æ— é«˜äº®"}):n.map(a=>{const o=e.has(a.id),l=$k[a.color]??$k.yellow,u=a.text?a.text.length>50?a.text.slice(0,50)+"...":a.text:"(ç©ºé«˜äº®)";return h.jsxs("label",{className:`
                  flex items-start gap-2 p-2 rounded-md cursor-pointer
                  transition-colors duration-100
                  ${o?"bg-[#2a2a35]":"hover:bg-[#1e1e28]"}
                `,children:[h.jsx("input",{type:"checkbox",checked:o,onChange:()=>t(a.id),className:"mt-0.5 h-3.5 w-3.5 rounded border-[#555] bg-transparent accent-blue-500 shrink-0"}),h.jsx("div",{className:"w-1 h-full min-h-[16px] rounded-full shrink-0",style:{background:l}}),h.jsx("span",{className:"text-xs text-[#ccc] leading-relaxed break-all",children:u})]},a.id)})})]})},V9=[{value:"single",label:"å•æ¡"},{value:"multi",label:"åˆé›†"},{value:"summary",label:"æ‘˜è¦"}],Bv=({title:n})=>h.jsx("h3",{className:"text-xs font-medium text-[#888] uppercase tracking-wider mb-2",children:n}),G9=({cardType:n,onCardTypeChange:e,selectedThemeId:t,onSelectTheme:i,highlights:s,selectedHighlightIds:r,onToggleHighlight:a,onSelectAllHighlights:o,onDeselectAllHighlights:l,onExport:u,isExporting:d})=>h.jsxs("div",{className:"flex flex-col gap-5 p-4",children:[h.jsxs("div",{children:[h.jsx(Bv,{title:"å¡ç‰‡ç±»åž‹"}),h.jsx("div",{className:"flex bg-[#1a1a20] rounded-lg p-1 gap-0.5",children:V9.map(f=>{const p=n===f.value;return h.jsx("button",{type:"button",onClick:()=>e(f.value),className:`
                  flex-1 text-xs py-1.5 rounded-md font-medium transition-all duration-150
                  ${p?"bg-[#333340] text-white shadow-sm":"text-[#888] hover:text-[#bbb]"}
                `,children:f.label},f.value)})})]}),h.jsxs("div",{children:[h.jsx(Bv,{title:"ä¸»é¢˜é£Žæ ¼"}),h.jsx($9,{selectedThemeId:t,onSelectTheme:i})]}),(n==="multi"||n==="summary")&&h.jsxs("div",{children:[h.jsx(Bv,{title:"é€‰æ‹©é«˜äº®"}),h.jsx(q9,{highlights:s,selectedIds:r,onToggle:a,onSelectAll:o,onDeselectAll:l})]}),h.jsxs("div",{children:[h.jsx(Bv,{title:"å¯¼å‡º"}),h.jsxs("div",{className:"flex gap-2",children:[h.jsxs("button",{type:"button",onClick:()=>u("file"),disabled:d,className:`
              flex-1 flex items-center justify-center gap-1.5
              text-xs font-medium py-2 rounded-lg
              transition-all duration-150
              ${d?"bg-[#2a2a30] text-[#555] cursor-not-allowed":"bg-blue-600 hover:bg-blue-500 text-white active:scale-[0.98]"}
            `,children:[d?h.jsx(xt,{className:"w-3.5 h-3.5 animate-spin"}):h.jsx(vl,{className:"w-3.5 h-3.5"}),"ä¿å­˜å›¾ç‰‡"]}),h.jsxs("button",{type:"button",onClick:()=>u("clipboard"),disabled:d,className:`
              flex-1 flex items-center justify-center gap-1.5
              text-xs font-medium py-2 rounded-lg
              transition-all duration-150
              ${d?"bg-[#2a2a30] text-[#555] cursor-not-allowed":"bg-[#2a2a35] hover:bg-[#35353e] text-[#ccc] border border-[#444] active:scale-[0.98]"}
            `,children:[d?h.jsx(xt,{className:"w-3.5 h-3.5 animate-spin"}):h.jsx(rv,{className:"w-3.5 h-3.5"}),"å¤åˆ¶å‰ªè´´æ¿"]})]})]})]}),xR=({open:n,onClose:e,highlights:t,article:i,initialCardType:s})=>{const[r,a]=E.useState(s??(t.length===1?"single":"multi")),[o,l]=E.useState("swiss-design"),[u,d]=E.useState(()=>new Set(t.map(S=>S.id))),[f,p]=E.useState(!1),g=E.useRef(null);E.useEffect(()=>{if(!n)return;const S=C=>{C.key==="Escape"&&e()};return window.addEventListener("keydown",S),()=>window.removeEventListener("keydown",S)},[n,e]),E.useEffect(()=>{d(new Set(t.map(S=>S.id)))},[t]);const x=E.useMemo(()=>{const S=t.filter(C=>u.has(C.id));return r==="single"?S.length>0?[S[0]]:[]:S},[t,u,r]),w=E.useCallback(S=>{d(C=>{const k=new Set(C);return k.has(S)?k.delete(S):k.add(S),k})},[]),y=E.useCallback(()=>{d(new Set(t.map(S=>S.id)))},[t]),m=E.useCallback(()=>{d(new Set)},[]),v=E.useCallback(async S=>{const C=g.current;if(C){p(!0);try{const k=await E9(C,{pixelRatio:2});if(S==="file"){const L=`z-reader-${(i.title||"card").slice(0,30)}-${Date.now()}.png`;await window.electronAPI.shareCardExportImage(k,L)}else await window.electronAPI.shareCardCopyClipboard(k)}catch(k){console.error("å¯¼å‡ºå¤±è´¥:",k)}finally{p(!1)}}},[i.title]),b=E.useCallback(S=>{S.target===S.currentTarget&&e()},[e]),A=E.useMemo(()=>H9(o),[o]);return n?h.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",onClick:b,children:[h.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm"}),h.jsxs("div",{className:"relative z-10 flex flex-col bg-[#1e1e24] rounded-xl shadow-2xl border border-[#333]",style:{width:"80vw",maxWidth:960,maxHeight:"90vh"},children:[h.jsxs("div",{className:"flex items-center justify-between px-5 py-3 border-b border-[#333]",children:[h.jsx("h2",{className:"text-sm font-medium text-[#ddd]",children:"åˆ†äº«å¡ç‰‡"}),h.jsx("button",{type:"button",onClick:e,className:"p-1 rounded-md text-[#888] hover:text-white hover:bg-[#333] transition-colors",children:h.jsx(Fn,{className:"w-4 h-4"})})]}),h.jsxs("div",{className:"flex flex-1 min-h-0 overflow-hidden",children:[h.jsx("div",{className:"flex-[3] p-5 overflow-auto",children:h.jsx(I9,{rendererRef:g,cardType:r,theme:A,highlights:x,article:i})}),h.jsx("div",{className:"flex-[2] border-l border-[#333] overflow-auto",children:h.jsx(G9,{cardType:r,onCardTypeChange:a,selectedThemeId:o,onSelectTheme:l,highlights:t,selectedHighlightIds:u,onToggleHighlight:w,onSelectAllHighlights:y,onDeselectAllHighlights:m,onExport:v,isExporting:f})})]})]})]}):null};function GS(n){if(!n)return null;try{return new Date(n).toLocaleDateString("zh-CN",{year:"numeric",month:"short",day:"numeric"})}catch{return n}}const qk={yellow:"#fbbf24",blue:"#3b82f6",green:"#22c55e",red:"#ef4444"};function Y9(n){const e=Date.now()-new Date(n).getTime(),t=Math.floor(e/6e4);if(t<1)return"åˆšåˆš";if(t<60)return`${t} åˆ†é’Ÿå‰`;const i=Math.floor(t/60);if(i<24)return`${i} å°æ—¶å‰`;const s=Math.floor(i/24);return s<30?`${s} å¤©å‰`:GS(n)??n}function W9({articleId:n,highlights:e,onHighlightsChange:t,onDeleteHighlight:i,onHighlightClick:s,forceTab:r,readProgress:a=0}){const{width:o,handleMouseDown:l}=fg({defaultWidth:500,minWidth:240,maxWidth:500,storageKey:"readerDetailPanelWidth"}),[u,d]=E.useState("info"),[f,p]=E.useState(null),[g,x]=E.useState(!1),[w,y]=E.useState(null),[m,v]=E.useState("");E.useEffect(()=>{r&&d(r.tab)},[r]),E.useEffect(()=>{let $=!1;return x(!0),window.electronAPI.articleGet(n).then(Y=>{$||(p(Y),x(!1))}).catch(()=>{$||(p(null),x(!1))}),()=>{$=!0}},[n]);const b=E.useCallback(async $=>{i($)},[i]),A=E.useCallback(async($,Y)=>{const F=await window.electronAPI.highlightUpdate({id:$,note:Y});t(e.map(M=>M.id===$?F:M)),y(null)},[e,t]),S=E.useCallback(async $=>{await window.electronAPI.highlightExport(n,$)},[n]),[C,k]=E.useState(!1),[L,D]=E.useState([]),[j,P]=E.useState(),H=E.useCallback(($,Y)=>{D($),P(Y),k(!0)},[]),G=f?[{label:"Type",value:"Article",icon:h.jsx(xl,{className:"w-3.5 h-3.5"})},{label:"Domain",value:f.domain,icon:h.jsx(ed,{className:"w-3.5 h-3.5"})},{label:"Published",value:GS(f.publishedAt),icon:h.jsx(Bm,{className:"w-3.5 h-3.5"})},{label:"Length",value:f.readingTime?`${f.readingTime} min`:null,icon:h.jsx(Vr,{className:"w-3.5 h-3.5"})},{label:"Progress",value:`${Math.round(a*100)}%`,icon:h.jsx(xl,{className:"w-3.5 h-3.5"})},{label:"Saved",value:GS(f.savedAt),icon:h.jsx(Bm,{className:"w-3.5 h-3.5"})},{label:"Author",value:f.author,icon:h.jsx(ov,{className:"w-3.5 h-3.5"})}]:[];return h.jsxs("div",{className:"shrink-0 flex flex-col h-full min-h-0 border-l border-[#262626] bg-[#141414] relative",style:{width:o},children:[h.jsx("div",{onMouseDown:l,className:"absolute left-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500/30 active:bg-blue-500/50 z-10 transition-colors"}),h.jsx("div",{className:"shrink-0 flex gap-2 px-4 pt-3 pb-2 border-b border-[#262626]",children:[{key:"info",label:"Info"},{key:"notebook",label:"Notebook",count:e.length},{key:"chat",label:"Chat"}].map($=>h.jsxs("button",{onClick:()=>d($.key),className:`
              px-2.5 py-1 text-xs font-medium rounded transition-colors cursor-pointer flex items-center gap-1
              ${u===$.key?"text-white bg-white/10":"text-gray-500 hover:text-gray-300 hover:bg-white/5"}
            `,children:[$.label,$.count!=null&&$.count>0&&h.jsx("span",{className:"text-[10px] text-gray-500",children:$.count})]},$.key))}),h.jsx("div",{className:`flex-1 min-h-0 flex flex-col ${u==="chat"?"":"overflow-y-auto p-4"}`,children:g?h.jsx("div",{className:"flex items-center justify-center h-full text-sm text-gray-500",children:"åŠ è½½ä¸­â€¦"}):f?h.jsxs(h.Fragment,{children:[u==="info"&&h.jsxs("div",{className:"flex flex-col gap-4",children:[h.jsxs("div",{children:[h.jsx("h3",{className:"text-[11px] font-semibold uppercase tracking-wider text-gray-500 mb-2",children:"Summary"}),h.jsx("p",{className:"text-[12px] leading-[1.6] text-gray-400",children:f.summary||"æš‚æ— æ‘˜è¦"})]}),h.jsx("div",{children:G.map($=>h.jsxs("div",{className:"flex items-center py-2 border-b border-white/5 last:border-b-0",children:[h.jsxs("span",{className:"flex items-center gap-1.5 text-[11px] text-gray-500 w-[90px] shrink-0",children:[$.icon,$.label]}),h.jsx("span",{className:"text-[12px] text-white truncate",children:$.value||"â€”"})]},$.label))})]}),u==="notebook"&&h.jsx("div",{className:"flex flex-col",children:e.length===0?h.jsx("div",{className:"flex items-center justify-center h-[300px]",children:h.jsxs("div",{className:"text-center text-gray-500",children:[h.jsx(av,{className:"w-8 h-8 mx-auto mb-2 opacity-40"}),h.jsxs("p",{className:"text-sm",children:[e.length," highlights"]})]})}):h.jsxs("div",{className:"flex flex-col gap-3",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("span",{className:"text-[11px] font-semibold uppercase tracking-wider text-gray-500",children:[e.length," ",e.length===1?"highlight":"highlights"]}),h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsx("button",{onClick:()=>S("clipboard"),className:"p-1 rounded hover:bg-white/10 text-gray-500 hover:text-white transition-colors cursor-pointer",title:"å¤åˆ¶åˆ°å‰ªè´´æ¿",children:h.jsx(rv,{className:"w-3 h-3"})}),h.jsx("button",{onClick:()=>S("file"),className:"p-1 rounded hover:bg-white/10 text-gray-500 hover:text-white transition-colors cursor-pointer",title:"ä¿å­˜ä¸ºæ–‡ä»¶",children:h.jsx(vl,{className:"w-3 h-3"})}),h.jsx("button",{onClick:()=>H(e),className:"p-1 rounded hover:bg-white/10 text-gray-500 hover:text-white transition-colors cursor-pointer",title:"ç”Ÿæˆåˆ†äº«å¡ç‰‡",children:h.jsx(Xj,{className:"w-3 h-3"})})]})]}),[...e].sort(($,Y)=>new Date(Y.createdAt).getTime()-new Date($.createdAt).getTime()).map($=>h.jsxs("div",{className:"group relative flex rounded-lg bg-[#1a1a1a] border border-white/5 overflow-hidden cursor-pointer hover:border-white/15 transition-colors",onClick:()=>s==null?void 0:s($.id),children:[h.jsx("div",{className:"w-[3px] shrink-0",style:{backgroundColor:qk[$.color]??qk.yellow}}),h.jsxs("div",{className:"flex-1 p-2.5 min-w-0",children:[h.jsxs("p",{className:"text-[12px] leading-[1.5] text-gray-300 italic",children:["â€œ",$.text,"â€"]}),w===$.id?h.jsx("textarea",{autoFocus:!0,value:m,onChange:Y=>v(Y.target.value),onBlur:()=>A($.id,m),onKeyDown:Y=>{Y.key==="Enter"&&!Y.shiftKey&&(Y.preventDefault(),A($.id,m)),Y.key==="Escape"&&y(null)},className:"mt-1 w-full text-[11px] text-gray-300 bg-white/5 border border-white/10 rounded px-2 py-1 resize-none outline-none focus:border-blue-500/50",rows:2,placeholder:"æ·»åŠ ç¬”è®°â€¦"}):h.jsx("button",{onClick:()=>{y($.id),v($.note||"")},className:"mt-1 block text-left text-[11px] text-gray-400 hover:text-gray-300 transition-colors w-full",children:$.note||"æ·»åŠ ç¬”è®°â€¦"}),h.jsx("span",{className:"mt-1.5 block text-[10px] text-gray-600",children:Y9($.createdAt)})]}),h.jsxs("div",{className:"absolute top-1.5 right-1.5 flex items-center gap-0.5 opacity-0 group-hover:opacity-100 transition-all",children:[h.jsx("button",{onClick:Y=>{Y.stopPropagation(),H([$],"single")},className:"p-1 rounded hover:bg-white/10 cursor-pointer text-gray-500 hover:text-blue-400",title:"ç”Ÿæˆåˆ†äº«å¡ç‰‡",children:h.jsx(Uz,{className:"w-3 h-3"})}),h.jsx("button",{onClick:Y=>{Y.stopPropagation(),b($.id)},className:"p-1 rounded hover:bg-white/10 cursor-pointer text-gray-500 hover:text-red-400",children:h.jsx(rs,{className:"w-3 h-3"})})]})]},$.id))]})}),u==="chat"&&h.jsx("div",{className:"flex-1 flex flex-col min-h-0",children:h.jsx(lR,{articleId:n})})]}):h.jsx("div",{className:"flex items-center justify-center h-full text-sm text-gray-500",children:"æ–‡ç« ä¸å­˜åœ¨"})}),f&&h.jsx(xR,{open:C,onClose:()=>k(!1),highlights:L,article:f,initialCardType:j})]})}const bR="z-reader-settings",wR=[{key:"system",label:"System"},{key:"serif",label:"Serif"},{key:"sans-serif",label:"Sans-serif"},{key:"monospace",label:"Monospace"}],pu=[1.5,1.75,2],X9=[{key:"dark",label:"Dark",preview:"bg-[#0f0f0f] border-gray-700"},{key:"light",label:"Light",preview:"bg-white border-gray-300"},{key:"sepia",label:"Sepia",preview:"bg-[#f4ecd8] border-amber-300"}],Vk={font:"system",fontSize:16,lineHeight:1.75,theme:"dark"};function K9(){try{const n=localStorage.getItem(bR);if(n)return{...Vk,...JSON.parse(n)}}catch{}return Vk}function Ad(n){localStorage.setItem(bR,JSON.stringify(n))}const Z9={system:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',serif:'Georgia, "Times New Roman", serif',"sans-serif":'"Helvetica Neue", Arial, sans-serif',monospace:'"SF Mono", "Fira Code", "Cascadia Code", monospace'};function Q9({open:n,onClose:e,settings:t,onSettingsChange:i}){const s=E.useRef(null);if(E.useEffect(()=>{if(!n)return;const a=o=>{s.current&&!s.current.contains(o.target)&&e()};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[n,e]),!n)return null;const r=a=>{const o={...t,...a};i(o),Ad(o)};return h.jsxs("div",{ref:s,className:"absolute right-4 top-12 w-[280px] bg-[#1e1e1e] border border-white/10 rounded-lg shadow-2xl z-50 p-4 space-y-5",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("h3",{className:"text-[13px] font-semibold text-white",children:"Reading Settings"}),h.jsx("button",{onClick:e,className:"p-1 rounded hover:bg-white/10 text-gray-400 hover:text-white transition-colors",children:h.jsx(Fn,{size:14})})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-[11px] text-gray-500 mb-1.5",children:"Font"}),h.jsx("div",{className:"grid grid-cols-2 gap-1.5",children:wR.map(a=>h.jsx("button",{onClick:()=>r({font:a.key}),className:`px-2 py-1.5 rounded text-[12px] transition-colors ${t.font===a.key?"bg-blue-500/20 text-blue-400 border border-blue-500/30":"bg-white/5 text-gray-400 hover:bg-white/10 border border-transparent"}`,children:a.label},a.key))})]}),h.jsxs("div",{children:[h.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[h.jsx("label",{className:"text-[11px] text-gray-500",children:"Font Size"}),h.jsxs("span",{className:"text-[11px] text-gray-400",children:[t.fontSize,"px"]})]}),h.jsx("input",{type:"range",min:14,max:22,step:1,value:t.fontSize,onChange:a=>r({fontSize:Number(a.target.value)}),className:"w-full accent-blue-500"}),h.jsxs("div",{className:"flex justify-between text-[10px] text-gray-600 mt-0.5",children:[h.jsx("span",{children:"14"}),h.jsx("span",{children:"22"})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-[11px] text-gray-500 mb-1.5",children:"Line Height"}),h.jsx("div",{className:"flex gap-1.5",children:pu.map(a=>h.jsx("button",{onClick:()=>r({lineHeight:a}),className:`flex-1 px-2 py-1.5 rounded text-[12px] transition-colors ${t.lineHeight===a?"bg-blue-500/20 text-blue-400 border border-blue-500/30":"bg-white/5 text-gray-400 hover:bg-white/10 border border-transparent"}`,children:a},a))})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-[11px] text-gray-500 mb-1.5",children:"Theme"}),h.jsx("div",{className:"flex gap-2",children:X9.map(a=>h.jsxs("button",{onClick:()=>r({theme:a.key}),className:`flex-1 flex flex-col items-center gap-1 p-2 rounded transition-colors ${t.theme===a.key?"ring-2 ring-blue-500":""}`,children:[h.jsx("div",{className:`w-8 h-8 rounded border ${a.preview}`}),h.jsx("span",{className:"text-[10px] text-gray-400",children:a.label})]},a.key))})]})]})}function J9({highlightId:n,currentTags:e,onTagAdd:t,onTagRemove:i,onTagCreate:s,onClose:r}){const[a,o]=E.useState([]),[l,u]=E.useState(""),d=E.useRef(null),f=E.useRef(null);E.useEffect(()=>{window.electronAPI.tagList().then(o)},[]),E.useEffect(()=>{setTimeout(()=>{var y;return(y=d.current)==null?void 0:y.focus()},50)},[]),E.useEffect(()=>{const y=m=>{f.current&&!f.current.contains(m.target)&&r()};return document.addEventListener("mousedown",y),()=>document.removeEventListener("mousedown",y)},[r]);const p=a.filter(y=>!e.some(m=>m.id===y.id)&&y.name.toLowerCase().includes(l.toLowerCase())),g=y=>{t(n,y),u("")},x=()=>{const y=l.trim();y&&(s(n,y),u(""))},w=y=>{y.key==="Enter"&&(y.preventDefault(),p.length>0?g(p[0].id):l.trim()&&x()),y.key==="Escape"&&(y.preventDefault(),r())};return h.jsxs("div",{ref:f,className:"annotation-tag-picker",onMouseDown:y=>y.stopPropagation(),children:[e.length>0&&h.jsx("div",{className:"annotation-tag-picker-current",children:e.map(y=>h.jsxs("span",{className:"annotation-tag-pill",children:[y.name,h.jsx("button",{onClick:()=>i(n,y.id),className:"annotation-tag-remove",children:h.jsx(Fn,{size:9})})]},y.id))}),h.jsx("input",{ref:d,value:l,onChange:y=>u(y.target.value),onKeyDown:w,placeholder:"æœç´¢æˆ–åˆ›å»ºæ ‡ç­¾â€¦",className:"annotation-tag-picker-input"}),h.jsxs("div",{className:"annotation-tag-picker-list",children:[p.map(y=>h.jsx("button",{onClick:()=>g(y.id),className:"annotation-tag-picker-option",children:y.name},y.id)),p.length===0&&l.trim()&&h.jsxs("button",{onClick:x,className:"annotation-tag-picker-create",children:[h.jsx(bl,{size:12}),h.jsxs("span",{children:['åˆ›å»º "',l.trim(),'"']})]}),p.length===0&&!l.trim()&&h.jsx("p",{className:"annotation-tag-picker-empty",children:"æš‚æ— å¯ç”¨æ ‡ç­¾"})]})]})}function SR(n,e){const t=n.querySelector(`mark[data-highlight-id="${e}"]`);if(!t)return null;const i=t;let s=0,r=i;for(;r&&r!==n;)s+=r.offsetTop,r=r.offsetParent;return s}function eH(n,e,t){if(!t)return[];const i=[];for(const r of n){const a=r.note&&r.note.trim().length>0,o=(e[r.id]||[]).length>0;if(!a&&!o)continue;const l=SR(t,r.id);l!==null&&i.push({highlightId:r.id,top:l,note:r.note,tags:e[r.id]||[]})}i.sort((r,a)=>r.top-a.top);const s=40;for(let r=1;r<i.length;r++)i[r].top-i[r-1].top<s&&(i[r].top=i[r-1].top+s);return i}function tH({initialValue:n,onSave:e,onCancel:t}){const[i,s]=E.useState(n),r=E.useRef(null);E.useEffect(()=>{setTimeout(()=>{var o;return(o=r.current)==null?void 0:o.focus()},50)},[]);const a=o=>{o.key==="Enter"&&(o.metaKey||o.ctrlKey)&&(o.preventDefault(),e(i.trim())),o.key==="Escape"&&(o.preventDefault(),t())};return h.jsxs("div",{className:"annotation-editor",onMouseDown:o=>o.stopPropagation(),children:[h.jsx("textarea",{ref:r,value:i,onChange:o=>s(o.target.value),onKeyDown:a,placeholder:"æ·»åŠ ç¬”è®°â€¦",className:"annotation-editor-textarea",rows:3}),h.jsxs("div",{className:"annotation-editor-actions",children:[h.jsx("button",{onClick:t,className:"annotation-editor-btn annotation-editor-btn-cancel",children:"å–æ¶ˆ"}),h.jsx("button",{onClick:()=>e(i.trim()),className:"annotation-editor-btn annotation-editor-btn-save",children:"ä¿å­˜"})]})]})}function iH({text:n,onClick:e}){return h.jsx("div",{className:"annotation-note-display",onClick:e,title:"ç‚¹å‡»ç¼–è¾‘ç¬”è®°",children:n})}function nH({tags:n,onRemove:e,onClick:t}){return n.length===0?null:h.jsx("div",{className:"annotation-tags-display",onClick:t,children:n.map(i=>h.jsxs("span",{className:"annotation-tag-pill",children:[i.name,h.jsx("button",{className:"annotation-tag-remove",onClick:s=>{s.stopPropagation(),e(i.id)},children:"Ã—"})]},i.id))})}function sH({highlights:n,highlightTagsMap:e,editingAnnotation:t,contentRef:i,onSaveNote:s,onCancelEdit:r,onTagAdd:a,onTagRemove:o,onTagCreate:l,onStartEditNote:u,onStartEditTag:d}){const[f,p]=E.useState([]),g=E.useRef(null),x=E.useCallback(()=>{p(eH(n,e,i.current))},[n,e,i]);E.useEffect(()=>{x()},[x]),E.useEffect(()=>{if(!i.current)return;const m=new MutationObserver(()=>{x()});return m.observe(i.current,{childList:!0,subtree:!0}),()=>m.disconnect()},[i,x]);const w=!t||!i.current?null:SR(i.current,t.highlightId),y=t?n.find(m=>m.id===t.highlightId):null;return h.jsxs("div",{ref:g,className:"annotation-layer",children:[f.map(m=>(t==null?void 0:t.highlightId)===m.highlightId?null:h.jsxs("div",{className:"annotation-item",style:{top:m.top},children:[m.note&&h.jsx(iH,{text:m.note,onClick:()=>u(m.highlightId)}),m.tags.length>0&&h.jsx(nH,{tags:m.tags,onRemove:b=>o(m.highlightId,b),onClick:()=>d(m.highlightId)})]},m.highlightId)),t&&w!==null&&h.jsxs("div",{className:"annotation-item annotation-item-editing",style:{top:w},children:[t.type==="note"&&h.jsx(tH,{initialValue:(y==null?void 0:y.note)??"",onSave:m=>s(t.highlightId,m),onCancel:r}),t.type==="tag"&&h.jsx(J9,{highlightId:t.highlightId,currentTags:e[t.highlightId]||[],onTagAdd:a,onTagRemove:o,onTagCreate:l,onClose:r})]})]})}const Ed="p, li, blockquote",Gk={yellow:"rgba(251, 191, 36, 0.25)",blue:"rgba(59, 130, 246, 0.25)",green:"rgba(34, 197, 94, 0.25)",red:"rgba(239, 68, 68, 0.25)"},Yk="rgba(251, 191, 36, 0.45)";function AR(n){const e=document.createTreeWalker(n,NodeFilter.SHOW_TEXT),t=[];let i;for(;i=e.nextNode();)t.push(i);return t}function Fv(n,e,t){const i=AR(n);let s=0;const r=document.createRange();let a=!1;for(const o of i){const l=o.data.length,u=s+l;if(!a&&e>=s&&e<=u&&(r.setStart(o,e-s),a=!0),a&&t>=s&&t<=u)return r.setEnd(o,t-s),r;s=u}return null}function Wk(n,e,t,i){const s=[],r=document.createTreeWalker(n,NodeFilter.SHOW_TEXT);let a;for(;a=r.nextNode();){const u=a;e.intersectsNode(u)&&s.push(u)}if(s.length===0)return;const o=Gk[i]??Gk.yellow,l=[];for(const u of s){const d=u===e.startContainer?e.startOffset:0,f=u===e.endContainer?e.endOffset:u.data.length;f<=d||l.push({node:u,start:d,end:f})}for(let u=l.length-1;u>=0;u--){const{node:d,start:f,end:p}=l[u];let g=d;p<g.data.length&&g.splitText(p),f>0&&(g=d.splitText(f));const x=document.createElement("mark");x.dataset.highlightId=t,x.style.backgroundColor=o,x.style.borderTop=`1px solid ${Yk}`,x.style.borderBottom=`1px solid ${Yk}`,x.style.borderRadius="2px",x.style.padding="2px 0",x.style.color="inherit",x.style.cursor="pointer",g.parentNode.insertBefore(x,g),x.appendChild(g)}}function rH(n,e){n.querySelectorAll(`mark[data-highlight-id="${e}"]`).forEach(t=>{const i=t.parentNode;if(i){for(;t.firstChild;)i.insertBefore(t.firstChild,t);i.removeChild(t),i.normalize()}})}function Xk(n,e){let t=n;for(;t&&t!==e;){if(t instanceof HTMLElement&&t.matches(Ed))return t;t=t.parentNode}return null}function aH(n,e){const t=[];let i=n;for(;i&&i!==e;){const s=i.parentElement;if(!s)break;const r=i.tagName.toLowerCase(),o=Array.from(s.children).filter(l=>l.tagName.toLowerCase()===r).indexOf(i)+1;if(t.unshift(`${r}:nth-of-type(${o})`),s===e)break;i=s}return t.join(" > ")}function oH(n,e){try{return n.querySelector(e)}catch{return null}}function Kk(n,e){const i=(n.textContent??"").indexOf(e);return i===-1?null:{startOffset:i,endOffset:i+e.length}}function lH(n,e){const t=AR(n);if(t.length===0)return null;let i=-1,s=-1,r=0;for(let a=0;a<t.length;a++){const o=t[a],l=o.data.length;if(i<0&&(o===e.startContainer?i=r+e.startOffset:e.startContainer===o.parentNode&&e.startOffset===Array.from(o.parentNode.childNodes).indexOf(o)?i=r:e.startContainer.contains(o)&&a===0&&e.startOffset===0&&(i=0)),o===e.endContainer)s=r+e.endOffset;else if(e.endContainer===o.parentNode){const u=Array.from(o.parentNode.childNodes).indexOf(o);e.endOffset===u+1&&(s=r+l)}else e.endContainer.contains(o)&&a===t.length-1&&(s=r+l);r+=l}return i<0||s<0||i>=s?null:{startOffset:i,endOffset:s}}function cH(n){if(!n)return null;try{return new Date(n).toLocaleDateString("zh-CN",{year:"numeric",month:"short",day:"numeric"})}catch{return n}}function uH({articleId:n,onClose:e}){const[t,i]=E.useState(null),[s,r]=E.useState(null),[a,o]=E.useState(!0),[l,u]=E.useState(!1),[d,f]=E.useState(-1),[p,g]=E.useState([]),[x,w]=E.useState(null),[y,m]=E.useState(K9),[v,b]=E.useState(!1),[A,S]=E.useState([]),[C,k]=E.useState(()=>localStorage.getItem("reader-toc-collapsed")==="true"),[L,D]=E.useState(()=>localStorage.getItem("reader-detail-collapsed")==="true"),[j,P]=E.useState(0),[H,G]=E.useState(),[$,Y]=E.useState(null),[F,M]=E.useState("info"),[I,V]=E.useState({}),[ie,ge]=E.useState(!1),[ee,me]=E.useState([]);E.useEffect(()=>{H&&M(H.tab)},[H]);const oe=E.useRef(null),ae=E.useRef(null),Z=E.useRef(null),re=E.useRef(null),ne=E.useRef([]),xe=E.useRef(null),Re=E.useRef(0),je=E.useRef(null);ne.current=p,E.useEffect(()=>{let ce=!1;async function te(){o(!0);try{const ze=await window.electronAPI.articleGet(n);if(ce)return;if(i(ze),ze&&(P(ze.readProgress??0),Re.current=ze.readProgress??0),ze!=null&&ze.feedId){const ht=(await window.electronAPI.feedList()).find(Lt=>Lt.id===ze.feedId);!ce&&ht&&r(ht.title)}if(ze&&!ze.content&&ze.url){u(!0);const st=await window.electronAPI.articleParseContent(n);ce||(i(st),u(!1))}}catch{}finally{ce||o(!1)}}return te(),()=>{ce=!0}},[n]),E.useEffect(()=>{let ce=!1;return window.electronAPI.highlightList(n).then(te=>{ce||g(te)}),()=>{ce=!0}},[n]);const Oe=E.useCallback(async ce=>{if(ce.length===0)return;const te=await window.electronAPI.highlightTagsBatch(ce);V(ze=>({...ze,...te}))},[]);E.useEffect(()=>{p.length>0&&Oe(p.map(ce=>ce.id))},[p,Oe]);const Ce=E.useCallback(()=>{window.electronAPI.articleUpdate({id:n,readProgress:Re.current})},[n]);E.useEffect(()=>{const ce=ae.current;if(!ce)return;const te=()=>{const{scrollTop:ze,scrollHeight:st,clientHeight:ht}=ce,Lt=st-ht;if(Lt<=0)return;const ue=Math.min(ze/Lt,1);Re.current=ue,P(ue),je.current&&clearTimeout(je.current),je.current=setTimeout(()=>{Ce()},1e3)};return ce.addEventListener("scroll",te,{passive:!0}),()=>{ce.removeEventListener("scroll",te),je.current&&clearTimeout(je.current),Ce()}},[Ce]);const Fe=E.useCallback(()=>{if(oe.current)for(const ce of ne.current){if(!oe.current)break;let te=null;if(ce.anchorPath&&ce.startOffset!=null&&ce.endOffset!=null){const ze=oH(oe.current,ce.anchorPath);if(ze&&(te=Fv(ze,ce.startOffset,ce.endOffset),te&&ce.text&&te.toString()!==ce.text&&(te=null),!te&&ce.text)){const st=Kk(ze,ce.text);st&&(te=Fv(ze,st.startOffset,st.endOffset))}}if(!te&&!ce.anchorPath&&ce.startOffset!=null&&ce.endOffset!=null&&(te=Fv(oe.current,ce.startOffset,ce.endOffset),te&&ce.text&&te.toString()!==ce.text&&(te=null)),!te&&ce.text){const ze=Kk(oe.current,ce.text);ze&&(te=Fv(oe.current,ze.startOffset,ze.endOffset))}te&&Wk(oe.current,te,ce.id,ce.color)}},[]);E.useEffect(()=>{a||!(t!=null&&t.content)||!oe.current||(oe.current.innerHTML=t.content,setTimeout(()=>{if(!oe.current)return;const ce=oe.current.querySelectorAll("h1, h2, h3, h4, h5, h6"),te=Array.from(ce).map((ze,st)=>{var Lt;const ht=`heading-${st}`;return ze.id=ht,{id:ht,text:((Lt=ze.textContent)==null?void 0:Lt.trim())??"",level:parseInt(ze.tagName.charAt(1))}});S(te)},0))},[a,t==null?void 0:t.content]),E.useEffect(()=>{a||!(t!=null&&t.content)||!oe.current||ne.current.length!==0&&(oe.current.querySelectorAll("mark[data-highlight-id]").forEach(ce=>{const te=ce.parentNode;if(te){for(;ce.firstChild;)te.insertBefore(ce.firstChild,ce);te.removeChild(ce),te.normalize()}}),Fe())},[p,a,t==null?void 0:t.content,Fe]);const Ze=E.useCallback(ce=>{if(!oe.current)return;const te=oe.current.querySelector(`mark[data-highlight-id="${ce}"]`);if(!te)return;te.scrollIntoView({behavior:"smooth",block:"center"});const ze=te;ze.style.transition="outline 0.2s",ze.style.outline="2px solid rgba(251,191,36,0.8)",ze.style.outlineOffset="2px",setTimeout(()=>{ze.style.outline="none",ze.style.outlineOffset="0"},1500)},[]);E.useEffect(()=>{if(!oe.current)return;const ce=oe.current.querySelectorAll(Ed);ce.forEach((te,ze)=>{te.setAttribute("data-focused",String(ze===d))}),d>=0&&ce[d]&&ce[d].scrollIntoView({block:"nearest"})},[d]);const ye=E.useCallback(ce=>{setTimeout(()=>{const te=window.getSelection();if(!oe.current)return;if(te&&!te.isCollapsed){if(!te.toString().trim()||!oe.current.contains(te.anchorNode))return;const ue=te.getRangeAt(0);xe.current=ue.cloneRange();const he=ue.getBoundingClientRect();w({mode:"selection",x:he.left+he.width/2,y:he.top-10});return}const ze=ce.target,st=ze.closest("mark[data-highlight-id]");if(st){const Lt=st.dataset.highlightId;if(Lt){const ue=st.getBoundingClientRect();w({mode:"highlight",highlightId:Lt,x:ue.left+ue.width/2,y:ue.top-10})}return}const ht=Xk(ze,oe.current);if(ht){const Lt=oe.current.querySelectorAll(Ed),ue=Array.from(Lt).indexOf(ht);ue!==-1&&f(he=>he===ue?-1:ue)}w(null)},10)},[]),we=E.useCallback(async ce=>{if(!t||!oe.current)return;const te=ce.toString().trim();if(!te)return;const ze=Xk(ce.startContainer,oe.current);let st,ht,Lt;if(ze){st=aH(ze,oe.current);const B=lH(ze,ce);B&&(ht=B.startOffset,Lt=B.endOffset)}if(ne.current.some(B=>!!(st&&B.anchorPath===st&&ht!=null&&B.startOffset===ht&&Lt!=null&&B.endOffset===Lt||B.text===te&&B.anchorPath===st)))return;const he=`pending-${Date.now()}`;Wk(oe.current,ce,he,"yellow");const Pe=await window.electronAPI.highlightCreate({articleId:t.id,text:te,color:"yellow",anchorPath:st,startOffset:ht,endOffset:Lt});g(B=>[...B,Pe]),G({tab:"notebook",ts:Date.now()}),oe.current.querySelectorAll(`mark[data-highlight-id="${he}"]`).forEach(B=>{B.dataset.highlightId=Pe.id});const Be=oe.current.querySelectorAll(`mark[data-highlight-id="${Pe.id}"]`);if(Be.length>0){const B=Be[0].getBoundingClientRect();w({mode:"highlight",highlightId:Pe.id,x:B.left+B.width/2,y:B.top-10})}},[t]),He=E.useCallback(async()=>{var te;const ce=xe.current;ce&&(xe.current=null,w(null),await we(ce),(te=window.getSelection())==null||te.removeAllRanges())},[we]),ke=E.useCallback(async ce=>{await window.electronAPI.highlightDelete(ce),g(te=>te.filter(ze=>ze.id!==ce)),w(null),Y(te=>(te==null?void 0:te.highlightId)===ce?null:te),V(te=>{const ze={...te};return delete ze[ce],ze}),oe.current&&rH(oe.current,ce)},[]);E.useEffect(()=>{const ce=te=>{var st,ht;if((st=Z.current)!=null&&st.contains(te.target)||(ht=re.current)!=null&&ht.contains(te.target))return;const ze=te.target;ze.closest("mark[data-highlight-id]")||ze.closest(".annotation-editor, .annotation-tag-picker")||(w(null),Y(null),xe.current=null)};return document.addEventListener("mousedown",ce),()=>document.removeEventListener("mousedown",ce)},[]);const Ae=E.useCallback(async(ce,te)=>{const ze=await window.electronAPI.highlightUpdate({id:ce,note:te||void 0});g(st=>st.map(ht=>ht.id===ce?ze:ht)),Y(null)},[]),it=E.useCallback(async(ce,te)=>{await window.electronAPI.highlightTagAdd(ce,te);const ze=await window.electronAPI.highlightTagsForHighlight(ce);V(st=>({...st,[ce]:ze}))},[]),nt=E.useCallback(async(ce,te)=>{await window.electronAPI.highlightTagRemove(ce,te);const ze=await window.electronAPI.highlightTagsForHighlight(ce);V(st=>({...st,[ce]:ze}))},[]),Qe=E.useCallback(async(ce,te)=>{const ze=await window.electronAPI.tagCreate(te);await window.electronAPI.highlightTagAdd(ce,ze.id);const st=await window.electronAPI.highlightTagsForHighlight(ce);V(ht=>({...ht,[ce]:st}))},[]);E.useEffect(()=>{const ce=te=>{var ue;const ze=te.target.tagName,st=ze==="INPUT"||ze==="TEXTAREA";if(te.key==="Escape"){if($){Y(null);return}if(x){w(null),xe.current=null,(ue=window.getSelection())==null||ue.removeAllRanges();return}if(st){te.target.blur();return}e();return}if(te.key==="["){te.preventDefault(),k(he=>{const Pe=!he;return localStorage.setItem("reader-toc-collapsed",String(Pe)),Pe});return}if(te.key==="]"){te.preventDefault(),D(he=>{const Pe=!he;return localStorage.setItem("reader-detail-collapsed",String(Pe)),Pe});return}if(te.shiftKey&&(te.key==="r"||te.key==="R")){te.preventDefault(),t&&t.readProgress&&t.readProgress>0&&(window.electronAPI.articleUpdate({id:t.id,readProgress:0}),Re.current=0,P(0));return}if(st)return;if(te.key==="n"&&!te.shiftKey&&!te.ctrlKey&&!te.metaKey&&d>=0&&oe.current){const Pe=oe.current.querySelectorAll(Ed)[d];if(Pe){const Be=Pe.querySelector("mark[data-highlight-id]");if(Be!=null&&Be.dataset.highlightId){te.preventDefault(),Y({highlightId:Be.dataset.highlightId,type:"note"});return}}}if(te.key==="t"&&!te.shiftKey&&!te.ctrlKey&&!te.metaKey&&d>=0&&oe.current){const Pe=oe.current.querySelectorAll(Ed)[d];if(Pe){const Be=Pe.querySelector("mark[data-highlight-id]");if(Be!=null&&Be.dataset.highlightId){te.preventDefault(),Y({highlightId:Be.dataset.highlightId,type:"tag"});return}}}if(te.shiftKey&&te.key==="T"&&!te.ctrlKey&&!te.metaKey){te.preventDefault(),D(!1),localStorage.setItem("reader-detail-collapsed","false"),G({tab:"info",ts:Date.now()});return}if(te.shiftKey&&te.key==="N"&&!te.ctrlKey&&!te.metaKey){te.preventDefault(),D(!1),localStorage.setItem("reader-detail-collapsed","false"),G({tab:"notebook",ts:Date.now()});return}if(te.shiftKey&&te.key==="C"&&!te.ctrlKey&&!te.metaKey){te.preventDefault(),t!=null&&t.url&&navigator.clipboard.writeText(t.url);return}if(te.ctrlKey&&te.shiftKey&&(te.key==="F"||te.key==="f")){te.preventDefault();const he=wR.map(be=>be.key),Pe=he.indexOf(y.font),Be=he[(Pe+1)%he.length],B={...y,font:Be};m(B),Ad(B);return}if(te.key==="_"){te.preventDefault();const he=Math.max(14,y.fontSize-1),Pe={...y,fontSize:he};m(Pe),Ad(Pe);return}if(te.key==="+"){te.preventDefault();const he=Math.min(22,y.fontSize+1),Pe={...y,fontSize:he};m(Pe),Ad(Pe);return}if(te.key===":"){te.preventDefault();const he=pu.indexOf(y.lineHeight),Pe=he<=0?pu.length-1:he-1,Be={...y,lineHeight:pu[Pe]};m(Be),Ad(Be);return}if(te.key==='"'){te.preventDefault();const Pe=(pu.indexOf(y.lineHeight)+1)%pu.length,Be={...y,lineHeight:pu[Pe]};m(Be),Ad(Be);return}if(te.key==="o"&&!te.shiftKey&&!te.ctrlKey&&!te.metaKey){te.preventDefault(),t!=null&&t.url&&window.open(t.url,"_blank");return}if(te.key==="`"&&!te.shiftKey&&!te.ctrlKey&&!te.metaKey){te.preventDefault();const he=["info","notebook","chat"],Pe=he.indexOf(F),Be=he[(Pe+1)%he.length];M(Be),D(!1),localStorage.setItem("reader-detail-collapsed","false"),G({tab:Be,ts:Date.now()});return}if(te.key==="~"){te.preventDefault();const he=["info","notebook","chat"],Pe=he.indexOf(F),Be=he[(Pe-1+he.length)%he.length];M(Be),D(!1),localStorage.setItem("reader-detail-collapsed","false"),G({tab:Be,ts:Date.now()});return}if(!oe.current)return;const ht=oe.current.querySelectorAll(Ed),Lt=ht.length;if(Lt!==0){if(te.key==="j"||te.key==="ArrowDown")te.preventDefault(),f(he=>Math.min(he+1,Lt-1));else if(te.key==="k"||te.key==="ArrowUp")te.preventDefault(),f(he=>Math.max(he-1,0));else if(te.key==="h"||te.key==="H"){te.preventDefault();const he=window.getSelection();if(he&&!he.isCollapsed&&oe.current.contains(he.anchorNode)){const Pe=he.getRangeAt(0).cloneRange();he.removeAllRanges(),w(null),we(Pe);return}if(d>=0){const Pe=ht[d];if(Pe){const Be=Pe.querySelector("mark[data-highlight-id]");if(Be){const be=Be.dataset.highlightId;if(be){ke(be);return}}const B=document.createRange();B.selectNodeContents(Pe),we(B)}}}}};return document.addEventListener("keydown",ce),()=>document.removeEventListener("keydown",ce)},[e,x,$,d,t,we,ke,y,F]);const Nt=a||l,Ve=y.theme==="light"?"reader-theme-light":y.theme==="sepia"?"reader-theme-sepia":"reader-theme-dark";return h.jsxs("div",{className:`flex flex-1 h-full overflow-hidden ${Ve}`,children:[h.jsxs("div",{className:`shrink-0 flex flex-col border-r border-[#262626] bg-[#141414] transition-all duration-200 overflow-hidden ${C?"w-0 border-r-0":"w-[220px]"}`,children:[h.jsxs("div",{className:"shrink-0 flex items-center justify-between px-4 h-12 border-b border-[#262626]",children:[h.jsx("button",{onClick:e,className:"p-1.5 rounded hover:bg-white/10 transition-colors cursor-pointer text-gray-400 hover:text-white",title:"è¿”å›žåˆ—è¡¨",children:h.jsx(V1,{className:"w-4 h-4"})}),h.jsx("h2",{className:"text-[13px] font-semibold text-white tracking-wide",children:"Contents"}),h.jsx("div",{className:"w-6"})]}),h.jsx("div",{className:"flex-1 overflow-y-auto p-3",children:A.length>0?h.jsx("ul",{className:"space-y-1",children:A.map(ce=>h.jsx("li",{children:h.jsx("button",{onClick:()=>{var te;(te=document.getElementById(ce.id))==null||te.scrollIntoView({behavior:"smooth",block:"start"})},className:"text-[12px] text-gray-400 hover:text-white text-left truncate w-full transition-colors",style:{paddingLeft:`${(ce.level-1)*12}px`},children:ce.text})},ce.id))}):h.jsx("p",{className:"text-[12px] text-gray-500",children:Nt?"åŠ è½½ä¸­â€¦":"æ­¤æ–‡ç« æ²¡æœ‰ç« èŠ‚æ ‡é¢˜"})})]}),h.jsxs("div",{className:"relative flex-1 flex flex-col overflow-hidden",children:[h.jsxs("div",{className:"shrink-0 flex items-center justify-between px-6 h-12 border-b border-[#262626]",children:[h.jsxs("div",{className:"flex items-center gap-1.5 text-[12px] min-w-0 truncate",children:[h.jsx("button",{onClick:()=>k(ce=>{const te=!ce;return localStorage.setItem("reader-toc-collapsed",String(te)),te}),className:"p-1 rounded hover:bg-white/10 transition-colors cursor-pointer text-gray-400 hover:text-white shrink-0",title:C?"å±•å¼€ç›®å½•":"æ”¶èµ·ç›®å½•",children:C?h.jsx(Qj,{className:"w-4 h-4"}):h.jsx(BC,{className:"w-4 h-4"})}),s&&h.jsxs(h.Fragment,{children:[h.jsx("span",{className:"text-gray-500 truncate",children:s}),h.jsx("span",{className:"text-gray-600",children:">"})]}),h.jsx("span",{className:"text-gray-400 truncate",children:(t==null?void 0:t.title)??"åŠ è½½ä¸­â€¦"})]}),h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsx("button",{onClick:()=>b(!v),className:"p-1.5 rounded hover:bg-white/10 transition-colors cursor-pointer text-gray-400 hover:text-white",title:"æŽ’ç‰ˆè®¾ç½®",children:h.jsx(Db,{className:"w-4 h-4"})}),h.jsx("button",{onClick:()=>D(ce=>{const te=!ce;return localStorage.setItem("reader-detail-collapsed",String(te)),te}),className:"p-1.5 rounded hover:bg-white/10 transition-colors cursor-pointer text-gray-400 hover:text-white",title:L?"å±•å¼€è¯¦æƒ…":"æ”¶èµ·è¯¦æƒ…",children:L?h.jsx(K1,{className:"w-4 h-4"}):h.jsx(X1,{className:"w-4 h-4"})})]})]}),h.jsx(Q9,{open:v,onClose:()=>b(!1),settings:y,onSettingsChange:m}),h.jsx("div",{className:"shrink-0 h-[2px] bg-white/5",children:h.jsx("div",{className:"h-full bg-blue-500 transition-[width] duration-300",style:{width:`${Math.round(j*100)}%`}})}),h.jsx("div",{ref:ae,className:"flex-1 overflow-y-auto",children:Nt?h.jsxs("div",{className:"flex flex-col items-center justify-center h-full gap-3",children:[h.jsx(xt,{className:"w-6 h-6 text-gray-500 animate-spin"}),h.jsx("span",{className:"text-sm text-gray-500",children:l?"æ­£åœ¨è§£æžæ–‡ç« å†…å®¹â€¦":"åŠ è½½ä¸­â€¦"})]}):t?h.jsxs("div",{className:"relative",children:[h.jsxs("div",{className:"mx-auto max-w-[680px] px-8 py-10",children:[h.jsx("h1",{className:"text-[28px] font-bold leading-tight text-white",children:t.title}),h.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-x-3 gap-y-1 text-[13px] text-gray-500",children:[t.author&&h.jsx("span",{children:t.author}),t.domain&&h.jsx("span",{children:t.domain}),t.publishedAt&&h.jsx("span",{children:cH(t.publishedAt)}),t.readingTime&&h.jsxs("span",{children:[t.readingTime," min read"]})]}),t.content?h.jsx("div",{ref:oe,className:"article-content mt-8",style:{fontFamily:Z9[y.font],fontSize:`${y.fontSize}px`,lineHeight:y.lineHeight},onMouseUp:ye}):h.jsx("p",{className:"mt-8 text-gray-500 text-sm",children:"æš‚æ— æ­£æ–‡å†…å®¹"})]}),h.jsx("div",{ref:re,children:h.jsx(sH,{highlights:p,highlightTagsMap:I,editingAnnotation:$,contentRef:oe,onSaveNote:Ae,onCancelEdit:()=>Y(null),onTagAdd:it,onTagRemove:nt,onTagCreate:Qe,onStartEditNote:ce=>Y({highlightId:ce,type:"note"}),onStartEditTag:ce=>Y({highlightId:ce,type:"tag"})})})]}):h.jsx("div",{className:"flex items-center justify-center h-full text-sm text-gray-500",children:"æ–‡ç« ä¸å­˜åœ¨"})})]}),x&&h.jsx("div",{ref:Z,className:"fixed z-[9999] flex items-center gap-0.5 px-1.5 py-1 bg-[#2a2a2a] rounded-full shadow-xl border border-white/10",style:{left:x.x,top:x.y,transform:"translate(-50%, -100%)"},children:x.mode==="selection"?h.jsx("button",{onClick:He,className:"w-7 h-7 flex items-center justify-center rounded-full bg-amber-500/20 hover:bg-amber-500/30 transition-colors cursor-pointer",title:"é«˜äº®",children:h.jsx(av,{className:"w-3.5 h-3.5 text-amber-400"})}):h.jsxs(h.Fragment,{children:[h.jsx("button",{onClick:()=>x.highlightId&&ke(x.highlightId),className:"w-7 h-7 flex items-center justify-center rounded-full bg-[#4a3a1a] hover:bg-[#5a4520] transition-colors cursor-pointer",title:"åˆ é™¤é«˜äº®",children:h.jsx(Fn,{className:"w-3.5 h-3.5 text-amber-400"})}),h.jsx("button",{onClick:()=>{x.highlightId&&(Y({highlightId:x.highlightId,type:"note"}),w(null))},className:"w-7 h-7 flex items-center justify-center rounded-full hover:bg-white/10 transition-colors cursor-pointer text-gray-400 hover:text-white",title:"æ·»åŠ ç¬”è®°",children:h.jsx(Zj,{className:"w-3.5 h-3.5"})}),h.jsx("button",{onClick:()=>{x.highlightId&&(Y({highlightId:x.highlightId,type:"tag"}),w(null))},className:"w-7 h-7 flex items-center justify-center rounded-full hover:bg-white/10 transition-colors cursor-pointer text-gray-400 hover:text-white",title:"æ·»åŠ æ ‡ç­¾",children:h.jsx(Z1,{className:"w-3.5 h-3.5"})}),h.jsx("button",{onClick:()=>{if(x.highlightId){const ce=p.find(te=>te.id===x.highlightId);ce&&(me([ce]),ge(!0)),w(null)}},className:"w-7 h-7 flex items-center justify-center rounded-full hover:bg-white/10 transition-colors cursor-pointer text-gray-400 hover:text-white",title:"ç”Ÿæˆåˆ†äº«å¡ç‰‡",children:h.jsx(Xj,{className:"w-3.5 h-3.5"})}),h.jsx("button",{className:"w-7 h-7 flex items-center justify-center rounded-full hover:bg-white/10 transition-colors cursor-pointer text-gray-400 hover:text-white",title:"æ›´å¤š",children:h.jsx(Vj,{className:"w-3.5 h-3.5"})})]})}),h.jsx("div",{className:`shrink-0 h-full overflow-hidden ${L?"w-0":""}`,children:h.jsx(W9,{articleId:n,highlights:p,onHighlightsChange:g,onDeleteHighlight:ke,onHighlightClick:Ze,forceTab:H,readProgress:j})}),t&&h.jsx(xR,{open:ie,onClose:()=>ge(!1),highlights:ee,article:t,initialCardType:"single"})]})}const hH=[{id:"inbox",label:"Go to Inbox",shortcut:"1",icon:US},{id:"later",label:"Go to Later",shortcut:"2",icon:Vr},{id:"archive",label:"Go to Archive",shortcut:"3",icon:Xp},{id:"archive-article",label:"Archive Article",shortcut:"E",icon:Xp},{id:"later-article",label:"Read Later",shortcut:"L",icon:Vr},{id:"delete-article",label:"Delete Article",shortcut:"D",icon:rs},{id:"open-reader",label:"Open in Reader",shortcut:"Enter",icon:Ja},{id:"search",label:"Search",shortcut:"/",icon:dg}];function dH({open:n,onClose:e,onExecute:t}){const[i,s]=E.useState(""),[r,a]=E.useState(0),o=E.useRef(null),l=hH.filter(f=>f.label.toLowerCase().includes(i.toLowerCase()));E.useEffect(()=>{n&&(s(""),a(0),requestAnimationFrame(()=>{var f;return(f=o.current)==null?void 0:f.focus()}))},[n]),E.useEffect(()=>{a(0)},[i]);const u=E.useCallback(f=>{e(),t(f)},[e,t]),d=E.useCallback(f=>{switch(f.key){case"ArrowDown":f.preventDefault(),a(p=>p<l.length-1?p+1:0);break;case"ArrowUp":f.preventDefault(),a(p=>p>0?p-1:l.length-1);break;case"Enter":f.preventDefault(),l[r]&&u(l[r].id);break;case"Escape":f.preventDefault(),e();break}},[l,r,u,e]);return n?h.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-start justify-center pt-[20%]",onClick:e,children:h.jsxs("div",{className:"w-[520px] bg-[#1a1a1a] rounded-xl border border-white/10 shadow-2xl",onClick:f=>f.stopPropagation(),onKeyDown:d,children:[h.jsx("input",{ref:o,type:"text",value:i,onChange:f=>s(f.target.value),placeholder:"Type a command...",className:"w-full bg-transparent border-b border-white/5 px-4 py-3 text-white text-sm placeholder:text-gray-500 outline-none"}),h.jsxs("div",{className:"max-h-[320px] overflow-y-auto py-1",children:[l.map((f,p)=>{const g=f.icon;return h.jsxs("button",{onClick:()=>u(f.id),className:`w-full px-4 py-2.5 flex items-center justify-between cursor-pointer transition-colors ${p===r?"bg-white/[0.06]":"hover:bg-white/5"}`,children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx(g,{size:16,className:"text-gray-400"}),h.jsx("span",{className:"text-sm text-gray-200",children:f.label})]}),h.jsx("span",{className:"text-[11px] text-gray-500 bg-white/5 rounded px-1.5 py-0.5",children:f.shortcut})]},f.id)}),l.length===0&&h.jsx("div",{className:"px-4 py-6 text-center text-sm text-gray-500",children:"No matching commands"})]})]})}):null}function fH({onSubscribed:n}){const[e,t]=E.useState(""),[i,s]=E.useState("show"),[r,a]=E.useState([]),[o,l]=E.useState(!1),[u,d]=E.useState(null),[f,p]=E.useState(new Set),[g,x]=E.useState(!1),w=E.useRef(null),{showToast:y}=au();E.useEffect(()=>{setTimeout(()=>{var S;return(S=w.current)==null?void 0:S.focus()},100)},[]),E.useEffect(()=>{window.electronAPI.feedList().then(S=>{const C=new Set(S.map(k=>k.url));p(C)}).catch(()=>{})},[]);const m=/^https?:\/\//i.test(e.trim()),v=E.useCallback(async()=>{const S=e.trim();if(S){if(/^https?:\/\//i.test(S)){x(!0),a([]);try{const C=await window.electronAPI.podcastResolveUrl(S);C!=null&&C.feedUrl?a([{title:C.title??"Podcast",author:C.author??null,image:C.image??null,feedUrl:C.feedUrl,website:S,source:"itunes",id:C.feedUrl}]):y("æ— æ³•è§£æžè¯¥ URLï¼Œè¯·å°è¯•ç›´æŽ¥ç²˜è´´ RSS åœ°å€")}catch{y("URL è§£æžå¤±è´¥")}finally{x(!1)}return}l(!0),a([]);try{const C=await window.electronAPI.podcastSearch({query:S,type:i,limit:20});a(C)}catch{y("æœç´¢å¤±è´¥ï¼Œè¯·ç¨åŽé‡è¯•")}finally{l(!1)}}},[e,i,y]),b=E.useCallback(S=>{S.key==="Enter"&&(S.preventDefault(),v())},[v]),A=E.useCallback(async S=>{if(!S.feedUrl){y("è¯¥æ’­å®¢æ—  RSS åœ°å€");return}if(f.has(S.feedUrl)){y("å·²è®¢é˜…è¯¥æ’­å®¢");return}d(S.id);try{await window.electronAPI.feedAdd({url:S.feedUrl,title:S.title||void 0}),p(C=>new Set(C).add(S.feedUrl)),y(`å·²è®¢é˜…ã€Œ${S.title}ã€`),n==null||n()}catch(C){const k=C instanceof Error?C.message:"è®¢é˜…å¤±è´¥";y(k)}finally{d(null)}},[f,y,n]);return h.jsxs("div",{className:"flex flex-col gap-4",children:[h.jsxs("div",{className:"flex gap-2",children:[h.jsxs("div",{className:"relative flex-1",children:[h.jsx(dg,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500"}),h.jsx("input",{ref:w,type:"text",value:e,onChange:S=>t(S.target.value),onKeyDown:b,placeholder:"æœç´¢æ’­å®¢åç§°æˆ–ç²˜è´´ URL...",className:"w-full pl-9 pr-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),!m&&h.jsxs("div",{className:"flex rounded-md overflow-hidden border border-white/10 shrink-0",children:[h.jsx("button",{onClick:()=>s("show"),className:`px-3 py-2 text-xs font-medium transition-colors cursor-pointer ${i==="show"?"bg-blue-600 text-white":"bg-[#111] text-gray-400 hover:text-white"}`,children:"èŠ‚ç›®"}),h.jsx("button",{onClick:()=>s("episode"),className:`px-3 py-2 text-xs font-medium transition-colors cursor-pointer ${i==="episode"?"bg-blue-600 text-white":"bg-[#111] text-gray-400 hover:text-white"}`,children:"å•é›†"})]}),h.jsx("button",{onClick:v,disabled:!e.trim()||o||g,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-700 disabled:cursor-not-allowed text-white text-sm font-medium rounded-md transition-colors cursor-pointer shrink-0",children:o||g?h.jsx(xt,{size:16,className:"animate-spin"}):"æœç´¢"})]}),(o||g)&&r.length===0&&h.jsxs("div",{className:"flex items-center justify-center py-8",children:[h.jsx(xt,{size:20,className:"animate-spin text-gray-500"}),h.jsx("span",{className:"ml-2 text-sm text-gray-500",children:g?"æ­£åœ¨è§£æž URL...":"æœç´¢ä¸­..."})]}),!o&&!g&&r.length===0&&e.trim()&&h.jsx("div",{className:"text-center py-8 text-sm text-gray-500",children:"æœªæ‰¾åˆ°ç»“æžœã€‚è¯•è¯•å…¶ä»–å…³é”®è¯æˆ–ç²˜è´´ RSS åœ°å€ã€‚"}),r.length>0&&h.jsx("div",{className:"flex flex-col gap-1 max-h-[400px] overflow-y-auto",children:r.map(S=>{const C=S.feedUrl?f.has(S.feedUrl):!1,k=u===S.id;return h.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-md hover:bg-white/5 transition-colors group",children:[S.image?h.jsx("img",{src:S.image,alt:"",className:"w-12 h-12 rounded-md object-cover shrink-0"}):h.jsx("div",{className:"w-12 h-12 rounded-md bg-gray-800 flex items-center justify-center shrink-0",children:h.jsx(ru,{size:18,className:"text-gray-600"})}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("div",{className:"text-sm font-medium text-gray-200 truncate",children:S.title}),S.author&&h.jsx("div",{className:"text-xs text-gray-500 truncate",children:S.author}),S.feedUrl&&h.jsx("div",{className:"text-[10px] text-gray-600 truncate mt-0.5",children:S.feedUrl})]}),h.jsx("button",{onClick:()=>A(S),disabled:C||k||!S.feedUrl,className:`shrink-0 flex items-center gap-1.5 px-3 py-1.5 rounded-md text-xs font-medium transition-colors cursor-pointer ${C?"bg-green-900/30 text-green-400 cursor-default":S.feedUrl?"bg-blue-600 hover:bg-blue-700 text-white":"bg-gray-800 text-gray-600 cursor-not-allowed"}`,children:k?h.jsx(xt,{size:14,className:"animate-spin"}):C?h.jsxs(h.Fragment,{children:[h.jsx(nv,{size:14}),h.jsx("span",{children:"å·²è®¢é˜…"})]}):h.jsxs(h.Fragment,{children:[h.jsx(bl,{size:14}),h.jsx("span",{children:"è®¢é˜…"})]})})]},`${S.source}-${S.id}`)})}),h.jsx("p",{className:"text-xs text-gray-600 px-1",children:"æ”¯æŒæœç´¢æ’­å®¢åç§°ï¼Œæˆ–ç²˜è´´ Apple Podcasts / Spotify / å°å®‡å®™ / RSS é“¾æŽ¥"})]})}function pH({open:n,onClose:e,onFeedAdded:t}){const{t:i}=Sn(),[s,r]=E.useState("rss"),[a,o]=E.useState(""),[l,u]=E.useState(""),[d,f]=E.useState(""),[p,g]=E.useState(!1),x=E.useRef(null),w=E.useRef(null),{showToast:y}=au(),[m,v]=E.useState(""),[b,A]=E.useState(""),[S,C]=E.useState(null),[k,L]=E.useState(!1);E.useEffect(()=>{n&&(o(""),u(""),f(""),v(""),A(""),C(null),L(!1),s==="rss"?setTimeout(()=>{var $;return($=x.current)==null?void 0:$.focus()},100):s==="newsletter"&&setTimeout(()=>{var $;return($=w.current)==null?void 0:$.focus()},100))},[n,s]),E.useEffect(()=>{if(!n)return;const $=Y=>{Y.key==="Escape"&&(Y.stopImmediatePropagation(),e())};return document.addEventListener("keydown",$),()=>document.removeEventListener("keydown",$)},[n,e]);const D=async $=>{if($.preventDefault(),!!a.trim()){g(!0);try{await window.electronAPI.feedAdd({url:a.trim(),title:l.trim()||void 0,category:d.trim()||void 0}),y(i("dialog.addFeed.addSuccess")),e(),t==null||t()}catch(Y){console.error("æ·»åŠ è®¢é˜…å¤±è´¥:",Y),y(i("dialog.addFeed.addFailed"))}finally{g(!1)}}},j=async()=>{g(!0);try{const $=await window.electronAPI.feedImportOpml();$.length>0?(y(i("dialog.addFeed.addSuccess")+`: ${$.length} feeds`),e(),t==null||t()):y("No feeds imported")}catch($){console.error("å¯¼å…¥ OPML å¤±è´¥:",$),y("Failed to import OPML")}finally{g(!1)}},P=()=>{t==null||t()},H=async $=>{if($.preventDefault(),!!m.trim()){g(!0);try{const Y=await window.electronAPI.newsletterCreate({name:m.trim(),category:b.trim()||void 0});C({email:Y.email,feedUrl:Y.feedUrl}),y("Newsletter created"),t==null||t()}catch(Y){console.error("åˆ›å»º Newsletter å¤±è´¥:",Y),y("Failed to create newsletter")}finally{g(!1)}}},G=async()=>{if(S)try{await navigator.clipboard.writeText(S.email),L(!0),y(i("common.copy")+" success"),setTimeout(()=>L(!1),2e3)}catch{y(i("common.copy")+" failed")}};return n?h.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[h.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:e}),h.jsxs("div",{className:"relative w-full max-w-lg bg-[#1a1a1a] border border-white/10 rounded-lg shadow-2xl",children:[h.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-white/10",children:[h.jsx("h2",{className:"text-lg font-semibold text-white",children:i("dialog.addFeed.title")}),h.jsx("button",{onClick:e,className:"p-1 rounded hover:bg-white/10 text-gray-400 hover:text-white transition-colors",disabled:p,children:h.jsx(Fn,{size:20})})]}),h.jsxs("div",{className:"flex border-b border-white/10 px-6",children:[h.jsxs("button",{onClick:()=>r("rss"),className:`flex items-center gap-2 px-4 py-2.5 text-sm font-medium border-b-2 transition-colors cursor-pointer ${s==="rss"?"border-blue-500 text-white":"border-transparent text-gray-400 hover:text-gray-200"}`,children:[h.jsx(ru,{size:16}),"RSS / YouTube"]}),h.jsxs("button",{onClick:()=>r("podcast"),className:`flex items-center gap-2 px-4 py-2.5 text-sm font-medium border-b-2 transition-colors cursor-pointer ${s==="podcast"?"border-blue-500 text-white":"border-transparent text-gray-400 hover:text-gray-200"}`,children:[h.jsx(FC,{size:16}),"æ’­å®¢"]}),h.jsxs("button",{onClick:()=>r("newsletter"),className:`flex items-center gap-2 px-4 py-2.5 text-sm font-medium border-b-2 transition-colors cursor-pointer ${s==="newsletter"?"border-blue-500 text-white":"border-transparent text-gray-400 hover:text-gray-200"}`,children:[h.jsx(HS,{size:16}),"Newsletter"]})]}),s==="rss"?h.jsxs(h.Fragment,{children:[h.jsxs("form",{onSubmit:D,className:"p-6 space-y-4",children:[h.jsxs("div",{children:[h.jsxs("label",{htmlFor:"feed-url",className:"block text-sm font-medium text-gray-300 mb-1.5",children:["RSS URL ",h.jsx("span",{className:"text-red-400",children:"*"})]}),h.jsx("input",{ref:x,id:"feed-url",type:"text",value:a,onChange:$=>o($.target.value),placeholder:"https://example.com/feed.xml æˆ– YouTube é¢‘é“ URL",className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:p})]}),h.jsxs("div",{children:[h.jsx("label",{htmlFor:"feed-title",className:"block text-sm font-medium text-gray-300 mb-1.5",children:"è®¢é˜…åç§° (å¯é€‰)"}),h.jsx("input",{id:"feed-title",type:"text",value:l,onChange:$=>u($.target.value),placeholder:"è‡ªåŠ¨ä»Ž RSS èŽ·å–",className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:p})]}),h.jsxs("div",{children:[h.jsx("label",{htmlFor:"feed-category",className:"block text-sm font-medium text-gray-300 mb-1.5",children:"åˆ†ç±» (å¯é€‰)"}),h.jsx("input",{id:"feed-category",type:"text",value:d,onChange:$=>f($.target.value),placeholder:"ä¾‹å¦‚: æŠ€æœ¯ã€æ–°é—»ã€åšå®¢",className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:p})]}),h.jsxs("div",{className:"flex gap-3 pt-2",children:[h.jsx("button",{type:"submit",disabled:p||!a.trim(),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-700 disabled:cursor-not-allowed text-white text-sm font-medium rounded-md transition-colors",children:p?h.jsxs(h.Fragment,{children:[h.jsx(xt,{size:16,className:"animate-spin"}),h.jsx("span",{children:"æ·»åŠ ä¸­..."})]}):h.jsxs(h.Fragment,{children:[h.jsx(bl,{size:16}),h.jsx("span",{children:"æ·»åŠ è®¢é˜…"})]})}),h.jsxs("button",{type:"button",onClick:j,disabled:p,className:"flex items-center justify-center gap-2 px-4 py-2 bg-gray-700 hover:bg-gray-600 disabled:bg-gray-800 disabled:cursor-not-allowed text-white text-sm font-medium rounded-md transition-colors",title:"å¯¼å…¥ OPML æ–‡ä»¶",children:[h.jsx(kF,{size:16}),h.jsx("span",{children:"å¯¼å…¥ OPML"})]})]})]}),h.jsx("div",{className:"px-6 pb-6 pt-0",children:h.jsx("p",{className:"text-xs text-gray-500",children:"æç¤º: å¯ä»¥ç›´æŽ¥è¾“å…¥ RSS URLã€ç½‘ç«™é¦–é¡µæˆ– YouTube é¢‘é“é“¾æŽ¥"})})]}):s==="podcast"?h.jsx("div",{className:"p-6",children:h.jsx(fH,{onSubscribed:P})}):h.jsx(h.Fragment,{children:S?h.jsxs("div",{className:"p-6 space-y-4",children:[h.jsxs("div",{className:"p-4 bg-green-500/10 border border-green-500/20 rounded-lg space-y-3",children:[h.jsx("p",{className:"text-sm text-green-400 font-medium",children:"Newsletter è®¢é˜…åˆ›å»ºæˆåŠŸ"}),h.jsx("p",{className:"text-xs text-gray-400",children:"è¯·ç”¨ä»¥ä¸‹é‚®ç®±åœ°å€åŽ»è®¢é˜…ä½ çš„ newsletterï¼š"}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("code",{className:"flex-1 px-3 py-2 bg-black/30 border border-white/10 rounded text-sm text-white font-mono select-all break-all",children:S.email}),h.jsx("button",{onClick:G,className:"shrink-0 p-2 rounded hover:bg-white/10 text-gray-400 hover:text-white transition-colors",title:"å¤åˆ¶é‚®ç®±åœ°å€",children:k?h.jsx(nv,{size:16,className:"text-green-400"}):h.jsx(rv,{size:16})})]})]}),h.jsxs("div",{className:"space-y-2 text-xs text-gray-500",children:[h.jsx("p",{children:"æŽ¥ä¸‹æ¥ï¼š"}),h.jsxs("ol",{className:"list-decimal list-inside space-y-1",children:[h.jsx("li",{children:"å¤åˆ¶ä¸Šé¢çš„é‚®ç®±åœ°å€"}),h.jsx("li",{children:"åŽ» newsletter çš„ç½‘ç«™ç”¨æ­¤åœ°å€è®¢é˜…"}),h.jsx("li",{children:"æ”¶åˆ°çš„ newsletter ä¼šè‡ªåŠ¨å‡ºçŽ°åœ¨ Feed ä¸­"})]})]}),h.jsx("button",{onClick:e,className:"w-full px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white text-sm font-medium rounded-md transition-colors",children:"å®Œæˆ"})]}):h.jsxs("form",{onSubmit:H,className:"p-6 space-y-4",children:[h.jsxs("div",{children:[h.jsxs("label",{htmlFor:"newsletter-name",className:"block text-sm font-medium text-gray-300 mb-1.5",children:["Newsletter åç§° ",h.jsx("span",{className:"text-red-400",children:"*"})]}),h.jsx("input",{ref:w,id:"newsletter-name",type:"text",value:m,onChange:$=>v($.target.value),placeholder:"ä¾‹å¦‚: Morning Brew, The Hustle",className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:p})]}),h.jsxs("div",{children:[h.jsx("label",{htmlFor:"newsletter-category",className:"block text-sm font-medium text-gray-300 mb-1.5",children:"åˆ†ç±» (å¯é€‰)"}),h.jsx("input",{id:"newsletter-category",type:"text",value:b,onChange:$=>A($.target.value),placeholder:"ä¾‹å¦‚: æŠ€æœ¯ã€æ–°é—»ã€å•†ä¸š",className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:p})]}),h.jsx("div",{className:"pt-2",children:h.jsx("button",{type:"submit",disabled:p||!m.trim(),className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-700 disabled:cursor-not-allowed text-white text-sm font-medium rounded-md transition-colors",children:p?h.jsxs(h.Fragment,{children:[h.jsx(xt,{size:16,className:"animate-spin"}),h.jsx("span",{children:"åˆ›å»ºä¸­..."})]}):h.jsxs(h.Fragment,{children:[h.jsx(HS,{size:16}),h.jsx("span",{children:"åˆ›å»º Newsletter è®¢é˜…"})]})})}),h.jsx("div",{className:"pt-0",children:h.jsx("p",{className:"text-xs text-gray-500",children:"å°†é€šè¿‡ kill-the-newsletter.com ç”Ÿæˆä¸€ä¸ªä¸“ç”¨é‚®ç®±åœ°å€ï¼Œç”¨è¯¥åœ°å€è®¢é˜… newsletter åŽï¼Œå†…å®¹ä¼šè‡ªåŠ¨å‡ºçŽ°åœ¨ä½ çš„ Feed ä¸­ã€‚"})})]})})]})]}):null}function gH({open:n,onClose:e,onArticleSaved:t}){const[i,s]=E.useState(""),[r,a]=E.useState(""),[o,l]=E.useState(!1),u=E.useRef(null),{showToast:d}=au();E.useEffect(()=>{n&&(s(""),a(""),setTimeout(()=>{var p;return(p=u.current)==null?void 0:p.focus()},100))},[n]),E.useEffect(()=>{if(!n)return;const p=g=>{g.key==="Escape"&&(g.stopImmediatePropagation(),e())};return document.addEventListener("keydown",p),()=>document.removeEventListener("keydown",p)},[n,e]);const f=async p=>{if(p.preventDefault(),!!i.trim()){l(!0);try{await window.electronAPI.articleSaveUrl({url:i.trim(),title:r.trim()||void 0}),d("Saved to Library"),e(),t==null||t()}catch(g){console.error("Failed to save URL:",g),d("Failed to save URL. Please check the URL and try again.")}finally{l(!1)}}};return n?h.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[h.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:e}),h.jsxs("div",{className:"relative w-full max-w-md bg-[#1a1a1a] border border-white/10 rounded-lg shadow-2xl",children:[h.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-white/10",children:[h.jsx("h2",{className:"text-lg font-semibold text-white",children:"Save URL to Library"}),h.jsx("button",{onClick:e,className:"p-1 rounded hover:bg-white/10 text-gray-400 hover:text-white transition-colors",disabled:o,children:h.jsx(Fn,{size:20})})]}),h.jsxs("form",{onSubmit:f,className:"p-6 space-y-4",children:[h.jsxs("div",{children:[h.jsxs("label",{htmlFor:"save-url",className:"block text-sm font-medium text-gray-300 mb-1.5",children:["URL ",h.jsx("span",{className:"text-red-400",children:"*"})]}),h.jsx("input",{ref:u,id:"save-url",type:"url",value:i,onChange:p=>s(p.target.value),placeholder:"https://example.com/article",className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:o,required:!0})]}),h.jsxs("div",{children:[h.jsx("label",{htmlFor:"save-title",className:"block text-sm font-medium text-gray-300 mb-1.5",children:"Title (optional)"}),h.jsx("input",{id:"save-title",type:"text",value:r,onChange:p=>a(p.target.value),placeholder:"Auto-detected from page",className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:o})]}),h.jsx("div",{className:"flex gap-3 pt-2",children:h.jsx("button",{type:"submit",disabled:o||!i.trim(),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-700 disabled:cursor-not-allowed text-white text-sm font-medium rounded-md transition-colors",children:o?h.jsxs(h.Fragment,{children:[h.jsx(xt,{size:16,className:"animate-spin"}),h.jsx("span",{children:"Saving..."})]}):h.jsxs(h.Fragment,{children:[h.jsx(Kj,{size:16}),h.jsx("span",{children:"Save to Library"})]})})})]}),h.jsx("div",{className:"px-6 pb-6 pt-0",children:h.jsxs("p",{className:"text-xs text-gray-500",children:["The article content will be automatically parsed from the URL. You can also use ",h.jsx("kbd",{className:"px-1 py-0.5 bg-white/10 rounded text-gray-400",children:"Cmd+Shift+S"})," to open this dialog."]})})]})]}):null}function mH({open:n,onClose:e,onSelectArticle:t}){const{t:i}=Sn(),[s,r]=E.useState(""),[a,o]=E.useState([]),[l,u]=E.useState(0),[d,f]=E.useState(!1),p=E.useRef(null),g=E.useRef(void 0),x=E.useCallback(async b=>{const A=b.trim();if(!A){o([]);return}f(!0);try{const S=await window.electronAPI.articleSearch({query:A,limit:20});o(S),u(0)}catch(S){console.error("Search failed:",S),o([])}finally{f(!1)}},[]);E.useEffect(()=>(g.current&&clearTimeout(g.current),g.current=setTimeout(()=>{x(s)},300),()=>{g.current&&clearTimeout(g.current)}),[s,x]),E.useEffect(()=>{n&&(r(""),o([]),u(0),requestAnimationFrame(()=>{var b;return(b=p.current)==null?void 0:b.focus()}))},[n]);const w=E.useCallback(b=>{e(),t(b)},[e,t]),y=E.useCallback(b=>{switch(b.key){case"ArrowDown":b.preventDefault(),u(A=>A<a.length-1?A+1:0);break;case"ArrowUp":b.preventDefault(),u(A=>A>0?A-1:a.length-1);break;case"Enter":b.preventDefault(),a[l]&&w(a[l].id);break;case"Escape":b.preventDefault(),e();break}},[a,l,w,e]),m=(b,A)=>{if(!b||!A)return b||"";const S=new RegExp(`(${A.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");return b.split(S).map((k,L)=>S.test(k)?h.jsx("span",{className:"bg-yellow-500/30 text-yellow-200 font-medium",children:k},L):h.jsx("span",{children:k},L))},v=(b,A)=>{const S=b.contentText||b.summary||"",C=120;if(S.length<=C)return S;const L=S.toLowerCase().indexOf(A.toLowerCase());if(L===-1)return S.substring(0,C)+"...";const D=Math.max(0,L-40),j=Math.min(S.length,D+C),P=D>0?"...":"",H=j<S.length?"...":"";return P+S.substring(D,j)+H};return n?h.jsx("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-start justify-center pt-[15%]",onClick:e,children:h.jsxs("div",{className:"w-[680px] bg-[#1a1a1a] rounded-xl border border-white/10 shadow-2xl overflow-hidden",onClick:b=>b.stopPropagation(),onKeyDown:y,children:[h.jsxs("div",{className:"flex items-center gap-3 px-4 py-3.5 border-b border-white/5",children:[h.jsx(dg,{size:18,className:"text-gray-500 shrink-0"}),h.jsx("input",{ref:p,type:"text",value:s,onChange:b=>r(b.target.value),placeholder:i("search.placeholder"),className:"flex-1 bg-transparent text-white text-[14px] placeholder:text-gray-500 outline-none"})]}),h.jsxs("div",{className:"max-h-[420px] overflow-y-auto",children:[d&&h.jsx("div",{className:"px-4 py-8 text-center text-sm text-gray-500",children:i("search.searching")}),!d&&s&&a.length===0&&h.jsx("div",{className:"px-4 py-8 text-center text-sm text-gray-500",children:i("search.noResults")}),!d&&!s&&h.jsx("div",{className:"px-4 py-8 text-center text-sm text-gray-500",children:i("search.placeholder")}),!d&&a.length>0&&h.jsx("div",{className:"py-1",children:a.map((b,A)=>h.jsxs("button",{onClick:()=>w(b.id),className:`w-full px-4 py-3 flex flex-col gap-1.5 cursor-pointer transition-colors text-left ${A===l?"bg-white/[0.08]":"hover:bg-white/5"}`,children:[h.jsx("div",{className:"text-[14px] text-gray-100 font-medium line-clamp-1",children:m(b.title,s)}),h.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-gray-500",children:[b.author&&h.jsxs(h.Fragment,{children:[h.jsx("span",{children:m(b.author,s)}),h.jsx("span",{children:"â€¢"})]}),b.domain&&h.jsxs(h.Fragment,{children:[h.jsx("span",{children:b.domain}),h.jsx("span",{children:"â€¢"})]}),b.publishedAt&&h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsx(Vr,{size:10}),h.jsx("span",{children:new Date(b.publishedAt).toLocaleDateString("zh-CN")})]})]}),b.contentText&&h.jsx("div",{className:"text-[12px] text-gray-500 line-clamp-2",children:m(v(b,s),s)})]},b.id))})]}),h.jsxs("div",{className:"px-4 py-2 border-t border-white/5 flex items-center justify-between text-[11px] text-gray-600",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsxs("span",{children:["â†‘â†“ ",i("common.navigation")||"Navigate"]}),h.jsxs("span",{children:["Enter ",i("common.select")||"Select"]}),h.jsxs("span",{children:["Esc ",i("common.close")]})]}),a.length>0&&h.jsxs("span",{children:[a.length," ",i("search.results")]})]})]})}):null}const yH=[{title:"å¯¼èˆª",items:[{keys:["j","â†“"],description:"ä¸‹ä¸€ç¯‡æ–‡ç«  / ä¸‹ä¸€æ®µè½"},{keys:["k","â†‘"],description:"ä¸Šä¸€ç¯‡æ–‡ç«  / ä¸Šä¸€æ®µè½"},{keys:["Enter"],description:"æ‰“å¼€é˜…è¯»è§†å›¾"},{keys:["Esc"],description:"è¿”å›ž / å…³é—­"},{keys:["O"],description:"åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€åŽŸæ–‡"}]},{title:"æ–‡ç« æ“ä½œ",items:[{keys:["E"],description:"å½’æ¡£"},{keys:["L"],description:"ç¨åŽé˜…è¯»"},{keys:["D"],description:"åˆ é™¤"},{keys:["S","F"],description:"æ”¶è— / å–æ¶ˆæ”¶è—"},{keys:["B"],description:"ä¿å­˜åˆ° Library (Feed è§†å›¾)"},{keys:["Z"],description:"æ’¤é”€"},{keys:["â‡§B"],description:"è¿›å…¥æ‰¹é‡é€‰æ‹©æ¨¡å¼"},{keys:["â‡§C"],description:"å¤åˆ¶åŽŸæ–‡é“¾æŽ¥"}]},{title:"é˜…è¯»è§†å›¾",items:[{keys:["H"],description:"é«˜äº®å½“å‰æ®µè½"},{keys:["N"],description:"ä¸ºå½“å‰é«˜äº®æ·»åŠ ç¬”è®°"},{keys:["T"],description:"ä¸ºå½“å‰é«˜äº®æ·»åŠ æ ‡ç­¾"},{keys:["â‡§N"],description:"æ‰“å¼€ Notebook é¢æ¿"},{keys:["â‡§T"],description:"ä¸ºæ–‡æ¡£æ·»åŠ æ ‡ç­¾"},{keys:["â‡§R"],description:"é‡ç½®é˜…è¯»è¿›åº¦"},{keys:["`"],description:"å‘å‰åˆ‡æ¢ä¾§è¾¹æ æ ‡ç­¾"},{keys:["â‡§`"],description:"å‘åŽåˆ‡æ¢ä¾§è¾¹æ æ ‡ç­¾"}]},{title:"æŽ’ç‰ˆè®¾ç½® (é˜…è¯»è§†å›¾)",items:[{keys:["âŒƒâ‡§F"],description:"åˆ‡æ¢å­—ä½“"},{keys:["â‡§+"],description:"å¢žå¤§å­—å·"},{keys:["â‡§-"],description:"å‡å°å­—å·"},{keys:['â‡§"'],description:"å¢žå¤§è¡Œè·"},{keys:["â‡§:"],description:"å‡å°è¡Œè·"}]},{title:"è§†å›¾åˆ‡æ¢",items:[{keys:["1"],description:"Inbox / Unseen"},{keys:["2"],description:"Later / Seen"},{keys:["3"],description:"Archive"}]},{title:"é¢æ¿",items:[{keys:["["],description:"æ”¶æŠ˜/å±•å¼€å·¦ä¾§æ "},{keys:["]"],description:"æ”¶æŠ˜/å±•å¼€å³ä¾§è¯¦æƒ…é¢æ¿"}]},{title:"å…¨å±€",items:[{keys:["âŒ˜K"],description:"å‘½ä»¤é¢æ¿"},{keys:["/"],description:"æœç´¢"},{keys:["?"],description:"å¿«æ·é”®å¸®åŠ©"},{keys:["â‡§A"],description:"æ·»åŠ  RSS è®¢é˜…"},{keys:["â‡§F"],description:"æœç´¢/è¿‡æ»¤æ–‡æ¡£"},{keys:["âŒ˜â‡§S"],description:"ä¿å­˜ URL åˆ° Library"}]}];function vH({open:n,onClose:e}){const t=E.useRef(null);return E.useEffect(()=>{if(!n)return;const i=s=>{s.key==="Escape"&&(s.stopImmediatePropagation(),e())};return document.addEventListener("keydown",i),()=>document.removeEventListener("keydown",i)},[n,e]),E.useEffect(()=>{if(!n)return;const i=s=>{t.current&&!t.current.contains(s.target)&&e()};return document.addEventListener("mousedown",i),()=>document.removeEventListener("mousedown",i)},[n,e]),n?h.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:h.jsxs("div",{ref:t,className:"w-[480px] max-h-[70vh] bg-[#1a1a1a] border border-white/10 rounded-xl shadow-2xl flex flex-col overflow-hidden",children:[h.jsxs("div",{className:"flex items-center justify-between px-5 py-3.5 border-b border-white/10",children:[h.jsx("h2",{className:"text-[14px] font-semibold text-white",children:"Keyboard Shortcuts"}),h.jsx("button",{onClick:e,className:"p-1 rounded hover:bg-white/10 text-gray-400 hover:text-white transition-colors",children:h.jsx(Fn,{size:16})})]}),h.jsx("div",{className:"overflow-y-auto min-h-0 flex-1 p-5 space-y-6",children:yH.map(i=>h.jsxs("div",{children:[h.jsx("h3",{className:"text-[11px] font-semibold uppercase tracking-wider text-gray-500 mb-2",children:i.title}),h.jsx("div",{className:"space-y-1",children:i.items.map(s=>h.jsxs("div",{className:"flex items-center justify-between py-1.5",children:[h.jsx("span",{className:"text-[13px] text-gray-300",children:s.description}),h.jsx("div",{className:"flex items-center gap-1",children:s.keys.map((r,a)=>h.jsxs("span",{className:"flex items-center gap-1",children:[a>0&&h.jsx("span",{className:"text-[10px] text-gray-600",children:"/"}),h.jsx("kbd",{className:"px-1.5 py-0.5 text-[11px] font-mono text-gray-300 bg-white/5 border border-white/10 rounded",children:r})]},a))})]},s.description))})]},i.title))})]})}):null}function xH(n){return n?new Date(n).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"ä»Žæœª"}function bH({feed:n,onClose:e,onSave:t,onDelete:i,onFetch:s}){const[r,a]=E.useState(n.title||""),[o,l]=E.useState(n.category||""),[u,d]=E.useState(n.fetchInterval),[f,p]=E.useState(!1);E.useEffect(()=>{const m=v=>{v.key==="Escape"&&(v.stopImmediatePropagation(),e())};return document.addEventListener("keydown",m),()=>document.removeEventListener("keydown",m)},[e]);const g=()=>{t({...n,title:r||null,category:o||null,fetchInterval:u}),e()},x=async()=>{p(!0);try{await s(n.id)}finally{p(!1)}},w=()=>{confirm("ç¡®å®šå–æ¶ˆè®¢é˜…æ­¤ Feedï¼Ÿæ‰€æœ‰å…³è”æ–‡ç« ä¸ä¼šè¢«åˆ é™¤ã€‚")&&(i(n.id),e())},y=n.errorCount===0;return h.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",onClick:m=>{m.target===m.currentTarget&&e()},children:h.jsxs("div",{className:"w-[440px] bg-[#1a1a1a] rounded-xl border border-white/10 shadow-2xl",children:[h.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b border-white/10",children:[h.jsx("h2",{className:"text-[15px] font-semibold text-white",children:"Feed ç®¡ç†"}),h.jsx("button",{onClick:e,className:"p-1 rounded hover:bg-white/10 text-gray-400 hover:text-white transition-colors cursor-pointer",children:h.jsx(Fn,{size:16})})]}),h.jsxs("div",{className:"px-5 py-4 space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-[12px] text-gray-400 mb-1",children:"æ ‡é¢˜"}),h.jsx("input",{type:"text",value:r,onChange:m=>a(m.target.value),className:"w-full px-3 py-2 rounded-md bg-white/5 border border-white/10 text-[13px] text-white placeholder-gray-500 outline-none focus:border-blue-500/50 transition-colors",placeholder:"Feed æ ‡é¢˜"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-[12px] text-gray-400 mb-1",children:"URL"}),h.jsx("div",{className:"px-3 py-2 rounded-md bg-white/5 border border-white/10 text-[13px] text-gray-400 truncate",children:n.url})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-[12px] text-gray-400 mb-1",children:"åˆ†ç±»"}),h.jsx("input",{type:"text",value:o,onChange:m=>l(m.target.value),className:"w-full px-3 py-2 rounded-md bg-white/5 border border-white/10 text-[13px] text-white placeholder-gray-500 outline-none focus:border-blue-500/50 transition-colors",placeholder:"æœªåˆ†ç±»"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-[12px] text-gray-400 mb-1",children:"æŠ“å–é—´éš”ï¼ˆåˆ†é’Ÿï¼‰"}),h.jsx("input",{type:"number",value:u,onChange:m=>d(Math.max(1,parseInt(m.target.value)||30)),min:1,className:"w-full px-3 py-2 rounded-md bg-white/5 border border-white/10 text-[13px] text-white placeholder-gray-500 outline-none focus:border-blue-500/50 transition-colors"})]}),h.jsxs("div",{className:"px-3 py-2.5 rounded-md bg-white/5 border border-white/10 space-y-1.5",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[y?h.jsx(rF,{size:14,className:"text-green-400"}):h.jsx(Y1,{size:14,className:"text-yellow-400"}),h.jsx("span",{className:`text-[12px] font-medium ${y?"text-green-400":"text-yellow-400"}`,children:y?"è¿è¡Œæ­£å¸¸":`è¿žç»­é”™è¯¯ ${n.errorCount} æ¬¡`})]}),h.jsxs("div",{className:"text-[11px] text-gray-500",children:["ä¸Šæ¬¡æŠ“å–: ",xH(n.lastFetchedAt)]})]})]}),h.jsxs("div",{className:"flex items-center justify-between px-5 py-3 border-t border-white/10",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs("button",{onClick:x,disabled:f,className:"flex items-center gap-1.5 px-3 py-1.5 rounded-md text-[12px] text-gray-300 bg-white/5 hover:bg-white/10 border border-white/10 transition-colors cursor-pointer disabled:opacity-50",children:[h.jsx(Kp,{size:12,className:f?"animate-spin":""}),f?"æŠ“å–ä¸­...":"æ‰‹åŠ¨æŠ“å–"]}),h.jsxs("button",{onClick:w,className:"flex items-center gap-1.5 px-3 py-1.5 rounded-md text-[12px] text-red-400 bg-white/5 hover:bg-red-500/10 border border-white/10 transition-colors cursor-pointer",children:[h.jsx(rs,{size:12}),"å–æ¶ˆè®¢é˜…"]})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("button",{onClick:e,className:"px-3 py-1.5 rounded-md text-[12px] text-gray-400 hover:text-white transition-colors cursor-pointer",children:"å–æ¶ˆ"}),h.jsx("button",{onClick:g,className:"px-4 py-1.5 rounded-md text-[12px] font-medium text-white bg-blue-600 hover:bg-blue-500 transition-colors cursor-pointer",children:"ä¿å­˜"})]})]})]})})}function wH({onSelectFeed:n,selectedFeedId:e,onEditFeed:t,onAddFeed:i,refreshTrigger:s,onDeleteFeed:r}){const[a,o]=E.useState([]),[l,u]=E.useState({}),[d,f]=E.useState(""),[p,g]=E.useState("lastUpdated"),[x,w]=E.useState("desc"),[y,m]=E.useState(!0),[v,b]=E.useState(null),A=E.useRef(!1),S=E.useCallback(async()=>{try{m(!0);const[P,H]=await Promise.all([window.electronAPI.feedList(),window.electronAPI.feedArticleCount()]);o(P);const G={};H.forEach($=>{G[$.feedId]=$}),u(G),e===null&&P.length>0&&!A.current&&(n(P[0].id),A.current=!0)}catch(P){console.error("Failed to load feeds:",P)}finally{m(!1)}},[e,n]);E.useEffect(()=>{S()},[S,s]);const C=E.useCallback(async(P,H)=>{H.stopPropagation();try{await window.electronAPI.feedTogglePin(P),await S()}catch(G){console.error("Failed to toggle pin:",G)}},[S]),k=E.useCallback(async(P,H,G)=>{if(G.stopPropagation(),!!confirm(`ç¡®å®šå–æ¶ˆè®¢é˜…ã€Œ${H}ã€ï¼Ÿå…³è”æ–‡ç« ä¸ä¼šè¢«åˆ é™¤ã€‚`)){b(P);try{await r(P),e===P&&n(null),await S()}catch($){console.error("Failed to delete feed:",$)}finally{b(null)}}},[r,e,n,S]),L=P=>{p===P?w(H=>H==="asc"?"desc":"asc"):(g(P),w("desc"))},D=E.useMemo(()=>{let P=a;if(d.trim()){const H=d.toLowerCase();P=P.filter(G=>(G.title||"").toLowerCase().includes(H)||G.url.toLowerCase().includes(H))}return P=[...P].sort((H,G)=>{var Y,F;let $=0;return p==="name"?$=(H.title||H.url).localeCompare(G.title||G.url):p==="documents"?$=(((Y=l[H.id])==null?void 0:Y.total)||0)-(((F=l[G.id])==null?void 0:F.total)||0):p==="lastUpdated"&&($=(H.lastFetchedAt||"").localeCompare(G.lastFetchedAt||"")),x==="asc"?$:-$}),P},[a,d,p,x,l]),j=P=>{if(!P)return"-";const H=new Date(P),$=new Date().getTime()-H.getTime(),Y=Math.floor($/6e4);if(Y<60)return`${Y}m ago`;const F=Math.floor(Y/60);if(F<24)return`${F}h ago`;const M=Math.floor(F/24);return M<30?`${M}d ago`:H.toLocaleDateString("zh-CN",{month:"short",day:"numeric"})};return h.jsxs("div",{className:"flex flex-col h-full bg-[#141414] min-w-[400px] flex-1",children:[h.jsx("div",{className:"shrink-0 border-b border-[#262626]",children:h.jsxs("div",{className:"flex items-center justify-between px-5 pt-4 pb-3",children:[h.jsxs("div",{className:"flex items-center gap-6",children:[h.jsx("span",{className:"text-[14px] font-semibold text-white border-b-2 border-white pb-1",children:"Subscribed"}),h.jsx("span",{className:"text-[14px] text-gray-500 pb-1 cursor-not-allowed",children:"Suggested"})]}),h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsxs("div",{className:"relative",children:[h.jsx(dg,{size:14,className:"absolute left-2.5 top-1/2 -translate-y-1/2 text-gray-500"}),h.jsx("input",{type:"text",placeholder:"Find...",value:d,onChange:P=>f(P.target.value),className:"w-[180px] pl-8 pr-3 py-1.5 bg-[#1a1a1a] border border-[#333] rounded-md text-[12px] text-gray-300 placeholder-gray-600 focus:outline-none focus:border-[#555] transition-colors"})]}),h.jsxs("button",{onClick:i,className:"flex items-center gap-1.5 px-3 py-1.5 bg-blue-600 hover:bg-blue-500 rounded-md text-[12px] text-white font-medium transition-colors cursor-pointer",children:[h.jsx(bl,{size:14}),"Add feed"]})]})]})}),h.jsxs("div",{className:"flex-1 overflow-y-auto",children:[h.jsx("div",{className:"sticky top-0 bg-[#141414] border-b border-[#262626] z-10",children:h.jsxs("div",{className:"grid grid-cols-[1fr_1fr_100px_120px_130px] gap-2 px-5 py-2 text-[11px] font-medium text-gray-500 uppercase tracking-wider",children:[h.jsxs("button",{onClick:()=>L("name"),className:"flex items-center gap-1 text-left hover:text-gray-300 transition-colors cursor-pointer",children:["Name",p==="name"&&h.jsx(h2,{size:10})]}),h.jsx("span",{children:"Description"}),h.jsxs("button",{onClick:()=>L("documents"),className:"flex items-center gap-1 hover:text-gray-300 transition-colors cursor-pointer",children:["Documents",p==="documents"&&h.jsx(h2,{size:10})]}),h.jsx("span",{children:"Category"}),h.jsxs("button",{onClick:()=>L("lastUpdated"),className:"flex items-center gap-1 hover:text-gray-300 transition-colors cursor-pointer",children:["Last Updated",p==="lastUpdated"&&h.jsx(h2,{size:10})]})]})}),y?h.jsx("div",{className:"flex items-center justify-center py-20 text-gray-500 text-[13px]",children:"Loading..."}):D.length===0?h.jsx("div",{className:"flex flex-col items-center justify-center py-20 text-gray-500 text-[13px]",children:d?"No feeds found":"No subscriptions yet"}):D.map(P=>{var H;return h.jsxs("div",{onClick:()=>n(P.id),className:`
                group grid grid-cols-[1fr_1fr_100px_120px_130px] gap-2 px-5 h-10 items-center
                border-b border-[#1e1e1e] cursor-pointer transition-colors
                ${e===P.id?"bg-white/[0.06]":"hover:bg-white/[0.03]"}
              `,children:[h.jsxs("div",{className:"flex items-center gap-2.5 min-w-0",children:[P.favicon?h.jsx("img",{src:P.favicon,alt:"",className:"w-5 h-5 rounded shrink-0"}):h.jsx("div",{className:"w-5 h-5 rounded bg-[#333] flex items-center justify-center shrink-0",children:h.jsx(ru,{size:10,className:"text-gray-500"})}),h.jsx("span",{className:"text-[13px] text-gray-200 truncate",children:P.title||P.url})]}),h.jsx("span",{className:"text-[12px] text-gray-500 truncate",children:P.description||"-"}),h.jsx("span",{className:"text-[12px] text-gray-400 tabular-nums",children:((H=l[P.id])==null?void 0:H.total)||0}),h.jsx("span",{className:"text-[12px] text-gray-500 truncate",children:P.category||"-"}),h.jsxs("div",{className:"flex items-center justify-between min-w-0",children:[h.jsx("span",{className:"text-[12px] text-gray-500 group-hover:hidden",children:j(P.lastFetchedAt)}),h.jsxs("div",{className:"hidden group-hover:flex items-center gap-0.5",children:[h.jsx("button",{onClick:G=>{G.stopPropagation(),t(P)},className:"p-1.5 rounded hover:bg-white/10 text-gray-500 hover:text-gray-200 transition-colors cursor-pointer",title:"Edit feed",children:h.jsx(Jj,{size:14})}),h.jsx("button",{onClick:G=>C(P.id,G),className:`p-1.5 rounded hover:bg-white/10 transition-colors cursor-pointer ${P.pinned?"text-blue-400 hover:text-blue-300":"text-gray-500 hover:text-gray-200"}`,title:P.pinned?"Unpin from sidebar":"Pin to sidebar",children:P.pinned?h.jsx(yz,{size:14}):h.jsx(eR,{size:14})}),h.jsx("button",{onClick:G=>k(P.id,P.title||P.url,G),disabled:v===P.id,className:"p-1.5 rounded hover:bg-red-500/10 text-gray-500 hover:text-red-400 transition-colors cursor-pointer disabled:opacity-50",title:"Unsubscribe",children:h.jsx(rs,{size:14})})]})]})]},P.id)})]}),h.jsx("div",{className:"shrink-0 border-t border-[#262626] px-5 py-2 flex items-center justify-end",children:h.jsxs("span",{className:"text-[11px] text-gray-500",children:["Count: ",D.length]})})]})}function SH({feedId:n,onEditFeed:e,onDeleteFeed:t,onFetchFeed:i,onOpenArticle:s,refreshTrigger:r,collapsed:a}){const[o,l]=E.useState(null),[u,d]=E.useState(null),[f,p]=E.useState([]),[g,x]=E.useState(!1),{width:w,handleMouseDown:y}=fg({defaultWidth:600,minWidth:280,maxWidth:600,storageKey:"feedDetailPanelWidth"}),m=E.useCallback(async()=>{if(n)try{const[S,C,k]=await Promise.all([window.electronAPI.feedList(),window.electronAPI.feedArticleCount(),window.electronAPI.articleList({feedId:n,sortBy:"saved_at",sortOrder:"desc",limit:5})]),L=S.find(D=>D.id===n);l(L||null),d(C.find(D=>D.feedId===n)||null),p(k)}catch(S){console.error("Failed to load feed details:",S)}},[n]);E.useEffect(()=>{m()},[m,r]);const v=E.useCallback(async()=>{if(n){x(!0);try{await i(n),await m()}finally{x(!1)}}},[n,i,m]),b=E.useCallback(async()=>{o&&confirm(`ç¡®å®šå–æ¶ˆè®¢é˜…ã€Œ${o.title||o.url}ã€ï¼Ÿå…³è”æ–‡ç« ä¸ä¼šè¢«åˆ é™¤ã€‚`)&&await t(o.id)},[o,t]),A=S=>S?new Date(S).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"-";return n?o?h.jsxs("div",{className:`
        flex flex-col bg-[#0f0f0f] border-l border-[#262626] shrink-0
        overflow-hidden relative
        ${a?"w-0 border-l-0":""}
      `,style:a?void 0:{width:w},children:[!a&&h.jsx("div",{onMouseDown:y,className:"absolute left-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500/30 active:bg-blue-500/50 z-10 transition-colors"}),h.jsxs("div",{className:"flex flex-col h-full overflow-y-auto",style:{minWidth:w},children:[h.jsxs("div",{className:"px-5 pt-5 pb-4 border-b border-[#1e1e1e]",children:[h.jsxs("div",{className:"flex items-start gap-3",children:[o.favicon?h.jsx("img",{src:o.favicon,alt:"",className:"w-10 h-10 rounded-lg shrink-0 mt-0.5"}):h.jsx("div",{className:"w-10 h-10 rounded-lg bg-[#222] flex items-center justify-center shrink-0 mt-0.5",children:h.jsx(ru,{size:18,className:"text-gray-500"})}),h.jsxs("div",{className:"min-w-0 flex-1",children:[h.jsx("h2",{className:"text-[15px] font-semibold text-white leading-tight truncate",children:o.title||o.url}),h.jsxs("a",{href:o.url,className:"flex items-center gap-1 text-[11px] text-gray-500 hover:text-blue-400 mt-1 truncate transition-colors",title:o.url,children:[h.jsx(W1,{size:10,className:"shrink-0"}),h.jsx("span",{className:"truncate",children:o.url})]})]})]}),o.description&&h.jsx("p",{className:"mt-3 text-[12px] text-gray-400 leading-relaxed",children:o.description})]}),h.jsxs("div",{className:"px-5 py-4 space-y-3 border-b border-[#1e1e1e]",children:[h.jsxs("div",{className:"flex items-center gap-2.5 text-[12px]",children:[h.jsx(jF,{size:13,className:"text-gray-500 shrink-0"}),h.jsx("span",{className:"text-gray-500",children:"Category"}),h.jsx("span",{className:"ml-auto text-gray-300",children:o.category||"Uncategorized"})]}),h.jsxs("div",{className:"flex items-center gap-2.5 text-[12px]",children:[h.jsx(Vr,{size:13,className:"text-gray-500 shrink-0"}),h.jsx("span",{className:"text-gray-500",children:"Fetch Interval"}),h.jsxs("span",{className:"ml-auto text-gray-300",children:[o.fetchInterval," min"]})]}),h.jsxs("div",{className:"flex items-center gap-2.5 text-[12px]",children:[h.jsx(xl,{size:13,className:"text-gray-500 shrink-0"}),h.jsx("span",{className:"text-gray-500",children:"Articles"}),h.jsxs("span",{className:"ml-auto text-gray-300",children:[(u==null?void 0:u.total)||0," total / ",(u==null?void 0:u.unseen)||0," unseen"]})]}),h.jsxs("div",{className:"flex items-center gap-2.5 text-[12px]",children:[h.jsx(R8,{size:13,className:"text-gray-500 shrink-0"}),h.jsx("span",{className:"text-gray-500",children:"Health"}),h.jsx("span",{className:"ml-auto flex items-center gap-1",children:o.errorCount===0?h.jsxs(h.Fragment,{children:[h.jsx(qj,{size:12,className:"text-green-500"}),h.jsx("span",{className:"text-green-400",children:"Healthy"})]}):h.jsxs(h.Fragment,{children:[h.jsx(Y1,{size:12,className:"text-red-500"}),h.jsxs("span",{className:"text-red-400",children:[o.errorCount," errors"]})]})})]}),h.jsxs("div",{className:"flex items-center gap-2.5 text-[12px]",children:[h.jsx(Kp,{size:13,className:"text-gray-500 shrink-0"}),h.jsx("span",{className:"text-gray-500",children:"Last Fetched"}),h.jsx("span",{className:"ml-auto text-gray-300",children:A(o.lastFetchedAt)})]}),h.jsxs("div",{className:"flex items-center gap-2.5 text-[12px]",children:[h.jsx(Bm,{size:13,className:"text-gray-500 shrink-0"}),h.jsx("span",{className:"text-gray-500",children:"Created"}),h.jsx("span",{className:"ml-auto text-gray-300",children:A(o.createdAt)})]})]}),h.jsxs("div",{className:"px-5 py-3 flex items-center gap-2 border-b border-[#1e1e1e]",children:[h.jsxs("button",{onClick:v,disabled:g,className:"flex items-center gap-1.5 px-3 py-1.5 rounded-md text-[12px] bg-white/5 hover:bg-white/10 text-gray-300 border border-white/10 transition-colors cursor-pointer disabled:opacity-50",children:[h.jsx(Kp,{size:12,className:g?"animate-spin":""}),g?"Fetching...":"Fetch now"]}),h.jsxs("button",{onClick:()=>e(o),className:"flex items-center gap-1.5 px-3 py-1.5 rounded-md text-[12px] bg-white/5 hover:bg-white/10 text-gray-300 border border-white/10 transition-colors cursor-pointer",children:[h.jsx(Jj,{size:12}),"Edit"]}),h.jsxs("button",{onClick:b,className:"flex items-center gap-1.5 px-3 py-1.5 rounded-md text-[12px] text-red-400 bg-white/5 hover:bg-red-500/10 border border-white/10 transition-colors cursor-pointer",children:[h.jsx(rs,{size:12}),"Unsubscribe"]})]}),h.jsxs("div",{className:"px-5 py-4",children:[h.jsx("h3",{className:"text-[11px] font-medium text-gray-500 uppercase tracking-wider mb-3",children:"Recent Articles"}),f.length===0?h.jsx("p",{className:"text-[12px] text-gray-600",children:"No articles yet"}):h.jsx("div",{className:"space-y-2",children:f.map(S=>h.jsxs("button",{onClick:()=>s==null?void 0:s(S.id),className:"w-full text-left px-3 py-2 rounded-md hover:bg-white/5 transition-colors cursor-pointer",children:[h.jsx("p",{className:"text-[12px] text-gray-300 truncate",children:S.title||"Untitled"}),h.jsx("p",{className:"text-[10px] text-gray-600 mt-0.5",children:A(S.savedAt)})]},S.id))})]})]})]}):h.jsxs("div",{className:`
          flex flex-col bg-[#0f0f0f] border-l border-[#262626] shrink-0
          overflow-hidden relative
          ${a?"w-0 border-l-0":""}
        `,style:a?void 0:{width:w},children:[!a&&h.jsx("div",{onMouseDown:y,className:"absolute left-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500/30 active:bg-blue-500/50 z-10 transition-colors"}),h.jsx("div",{className:"flex items-center justify-center h-full text-gray-500 text-[13px]",style:{minWidth:w},children:"Loading..."})]}):h.jsxs("div",{className:`
          flex flex-col bg-[#0f0f0f] border-l border-[#262626] shrink-0
          overflow-hidden relative
          ${a?"w-0 border-l-0":""}
        `,style:a?void 0:{width:w},children:[!a&&h.jsx("div",{onMouseDown:y,className:"absolute left-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500/30 active:bg-blue-500/50 z-10 transition-colors"}),h.jsx("div",{className:"flex items-center justify-center h-full text-gray-600 text-[13px]",style:{minWidth:w},children:"é€‰æ‹©ä¸€ä¸ªè®¢é˜…æºæŸ¥çœ‹è¯¦æƒ…"})]})}const AH=[{key:"inbox",label:"INBOX"},{key:"later",label:"LATER"},{key:"archive",label:"ARCHIVE"}],EH={inbox:"Newly saved books will appear in Inbox until triaged",later:"Books saved for later will appear here",archive:"Archived books will appear here"};function CH({selectedBookId:n,onSelectBook:e,onOpenReader:t,refreshTrigger:i,expanded:s}){const[r,a]=E.useState(()=>localStorage.getItem("z-reader-tab-book")||"inbox"),[o,l]=E.useState([]),[u,d]=E.useState(!1),[f,p]=E.useState(!1),{showToast:g}=au(),x=sR(),w=E.useRef(null);E.useEffect(()=>{localStorage.setItem("z-reader-tab-book",r)},[r]);const y=E.useCallback(async()=>{d(!0);try{const A={readStatus:r,limit:100},S=await window.electronAPI.bookList(A);l(S)}catch(A){console.error("Failed to fetch books:",A)}finally{d(!1)}},[r]),m=E.useCallback(async()=>{p(!0);try{const A=await window.electronAPI.bookImport();if(A.length===0)return;a("inbox");const S=await window.electronAPI.bookList({readStatus:"inbox",limit:100});l(S),e(A[0].id)}catch(A){console.error("Failed to import books:",A)}finally{p(!1)}},[e]),v=E.useCallback(async(A,S)=>{try{const C=o.find(L=>L.id===A),k=(C==null?void 0:C.readStatus)??"inbox";await window.electronAPI.bookUpdate({id:A,readStatus:S}),await y(),e(A),g(S==="archive"?"Archived":S==="later"?"Saved for later":"Moved to Inbox","success"),x.push({description:`Revert to ${k}`,undo:async()=>{await window.electronAPI.bookUpdate({id:A,readStatus:k}),await y(),e(A),g("Undone","info")}})}catch(C){console.error("Failed to update book status:",C)}},[o,y,e,g,x]),b=E.useCallback(async A=>{try{await window.electronAPI.bookDelete(A),await y(),g("Moved to Trash","success"),x.push({description:"Undo delete",undo:async()=>{await window.electronAPI.bookRestore(A),await y(),e(A),g("Restored","info")}})}catch(S){console.error("Failed to delete book:",S)}},[y,e,g,x]);return E.useEffect(()=>{y()},[y,i]),E.useEffect(()=>{if(!n||!w.current)return;const A=w.current.querySelector(`[data-book-id="${n}"]`);A==null||A.scrollIntoView({block:"nearest"})},[n]),E.useEffect(()=>{const A=S=>{const C=S.target.tagName;if(!(C==="INPUT"||C==="TEXTAREA"))switch(S.key){case"j":case"ArrowDown":{S.preventDefault();const k=o.findIndex(D=>D.id===n),L=k<o.length-1?k+1:k;o[L]&&e(o[L].id);break}case"k":case"ArrowUp":{S.preventDefault();const k=o.findIndex(D=>D.id===n),L=k>0?k-1:0;o[L]&&e(o[L].id);break}case"Enter":{n&&(S.preventDefault(),t(n));break}case"1":{S.preventDefault(),a("inbox");break}case"2":{S.preventDefault(),a("later");break}case"3":{S.preventDefault(),a("archive");break}case"e":case"E":{S.preventDefault(),n&&v(n,"archive");break}case"l":case"L":{S.preventDefault(),n&&v(n,"later");break}case"d":case"D":{S.preventDefault(),n&&b(n);break}case"z":case"Z":{S.preventDefault(),x.canUndo&&x.undo();break}}};return document.addEventListener("keydown",A),()=>document.removeEventListener("keydown",A)},[o,n,e,t,v,b,x]),h.jsxs("div",{className:`flex flex-col border-r border-[#262626] bg-[#141414] h-full flex-1 ${s?"min-w-[360px]":"min-w-[300px]"}`,children:[h.jsxs("div",{className:"shrink-0",children:[h.jsxs("div",{className:"px-4 pt-4 pb-2 flex items-center justify-between",children:[h.jsx("h2",{className:"text-[13px] font-semibold text-white tracking-wide",children:"Books"}),h.jsxs("button",{onClick:m,disabled:f,className:"h-8 px-2.5 rounded-md border border-white/10 bg-white/5 hover:bg-white/10 disabled:opacity-60 disabled:cursor-not-allowed text-xs text-gray-300 hover:text-white transition-colors cursor-pointer flex items-center gap-1.5",title:"å¯¼å…¥ä¹¦ç±",children:[f?h.jsx(xt,{className:"w-3.5 h-3.5 animate-spin"}):h.jsx(iR,{className:"w-3.5 h-3.5"}),h.jsx("span",{children:"å¯¼å…¥"})]})]}),h.jsx("div",{className:"flex px-4 gap-4 border-b border-[#262626]",children:AH.map(A=>h.jsx("button",{onClick:()=>a(A.key),className:`
                pb-2 text-[11px] font-medium tracking-[0.08em] transition-colors cursor-pointer
                ${r===A.key?"text-white border-b-2 border-blue-500":"text-[#555] hover:text-[#888] border-b-2 border-transparent"}
              `,children:A.label},A.key))})]}),h.jsx("div",{ref:w,className:"flex-1 overflow-y-auto",children:u&&o.length===0?h.jsx("div",{className:"flex items-center justify-center h-full",children:h.jsx("span",{className:"text-[13px] text-[#555]",children:"Loading..."})}):o.length===0?h.jsx("div",{className:"flex items-center justify-center h-full px-8",children:h.jsx("span",{className:"text-[13px] text-[#555] text-center",children:EH[r]})}):h.jsx("div",{children:o.map(A=>h.jsx("div",{"data-book-id":A.id,className:"border-b border-[#262626]",children:h.jsx(_H,{book:A,isSelected:A.id===n,onSelect:e,onOpen:t})},A.id))})}),h.jsxs("div",{className:"shrink-0 px-4 py-1.5 border-t border-[#262626] text-[11px] text-[#555]",children:[o.length," ",o.length===1?"book":"books"]})]})}function _H({book:n,isSelected:e,onSelect:t,onOpen:i}){const[s,r]=E.useState(!1),a=Math.round(n.readProgress*100);return h.jsxs("div",{onClick:()=>{t(n.id),i(n.id)},onMouseEnter:()=>{r(!0),t(n.id)},onMouseLeave:()=>r(!1),className:`
        relative flex gap-3 px-4 py-3 cursor-pointer transition-colors
        ${e?"border-l-2 border-blue-500 bg-white/[0.04]":"border-l-2 border-transparent hover:bg-white/[0.03]"}
      `,children:[h.jsx("div",{className:"shrink-0",children:n.cover?h.jsx("img",{src:n.cover,alt:"",className:"w-10 h-14 rounded object-cover"}):h.jsx("div",{className:"w-10 h-14 rounded bg-white/[0.06] flex items-center justify-center",children:h.jsx(Ja,{size:16,className:"text-gray-500"})})}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("h3",{className:"text-[14px] font-medium text-gray-100 truncate leading-snug",children:n.title||"Untitled"}),n.author&&h.jsx("p",{className:"mt-0.5 text-[12px] text-gray-500 truncate",children:n.author}),a>0&&h.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[h.jsx("div",{className:"flex-1 h-1 rounded-full bg-white/10",children:h.jsx("div",{className:"h-1 rounded-full bg-blue-500 transition-all",style:{width:`${a}%`}})}),h.jsxs("span",{className:"text-[10px] text-gray-500 tabular-nums shrink-0",children:[a,"%"]})]})]}),s&&h.jsx("div",{className:"absolute right-3 top-3",children:h.jsx("button",{onClick:o=>{o.stopPropagation(),i(n.id)},className:"p-1.5 rounded bg-[#1e1e1e] border border-white/10 hover:bg-white/10 text-gray-400 hover:text-white transition-colors shadow-lg",title:"Open",children:h.jsx(Ja,{size:14})})})]})}function NH({bookId:n,collapsed:e,onOpenReader:t,onRefresh:i}){const[s,r]=E.useState(null),[a,o]=E.useState(!1),{width:l,handleMouseDown:u}=fg({defaultWidth:600,minWidth:280,maxWidth:600,storageKey:"bookDetailPanelWidth"});E.useEffect(()=>{if(!n){r(null);return}let w=!1;return o(!0),window.electronAPI.bookGet(n).then(y=>{w||(r(y),o(!1))}).catch(()=>{w||(r(null),o(!1))}),()=>{w=!0}},[n]);const d=E.useCallback(async w=>{if(n)try{const y=await window.electronAPI.bookUpdate({id:n,readStatus:w});r(y),i()}catch(y){console.error("Failed to update book status:",y)}},[n,i]),f=E.useCallback(async()=>{if(n)try{await window.electronAPI.bookDelete(n),i()}catch(w){console.error("Failed to delete book:",w)}},[n,i]),p=s?Math.round(s.readProgress*100):0,g={inbox:"æ”¶ä»¶ç®±",later:"ç¨åŽé˜…è¯»",archive:"å·²å½’æ¡£"},x=s?[{label:"Author",value:s.author,icon:h.jsx(ov,{className:"w-3.5 h-3.5"})},{label:"Publisher",value:s.publisher,icon:h.jsx($j,{className:"w-3.5 h-3.5"})},{label:"Language",value:s.language,icon:h.jsx(ed,{className:"w-3.5 h-3.5"})}]:[];return h.jsxs("div",{className:`
        flex flex-col bg-[#0f0f0f] border-l border-[#262626] shrink-0
        overflow-hidden relative
        ${e?"w-0 border-l-0":""}
      `,style:e?void 0:{width:l},children:[!e&&h.jsx("div",{onMouseDown:u,className:"absolute left-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500/30 active:bg-blue-500/50 z-10 transition-colors"}),h.jsx("div",{className:"flex flex-col h-full",style:{minWidth:l},children:h.jsx("div",{className:"flex-1 overflow-y-auto p-4 flex flex-col",children:n?a?h.jsx("div",{className:"flex items-center justify-center h-full text-sm text-gray-500",children:"åŠ è½½ä¸­â€¦"}):s?h.jsxs("div",{className:"flex-1 flex flex-col",children:[h.jsx("div",{className:"flex justify-center py-4",children:s.cover?h.jsx("img",{src:s.cover,alt:"",className:"w-32 h-48 rounded-lg object-cover shadow-lg"}):h.jsx("div",{className:"w-32 h-48 rounded-lg bg-white/[0.06] flex items-center justify-center",children:h.jsx(Ja,{size:32,className:"text-gray-500"})})}),h.jsx("h2",{className:"text-[16px] font-semibold text-white text-center leading-snug",children:s.title||"Untitled"}),s.author&&h.jsx("p",{className:"mt-1 text-[13px] text-gray-500 text-center",children:s.author}),h.jsxs("div",{className:"mt-6 rounded-lg bg-[#1a1a1a] border border-white/5 p-3",children:[h.jsxs("div",{className:"flex items-center justify-between text-[12px]",children:[h.jsx("span",{className:"text-gray-500",children:"çŠ¶æ€"}),h.jsx("span",{className:"text-white font-medium",children:g[s.readStatus]??s.readStatus})]}),h.jsxs("div",{className:"mt-2",children:[h.jsxs("div",{className:"flex items-center justify-between text-[12px] mb-1",children:[h.jsx("span",{className:"text-gray-500",children:"é˜…è¯»è¿›åº¦"}),h.jsxs("span",{className:"text-white font-medium",children:[p,"%"]})]}),h.jsx("div",{className:"w-full h-1 rounded-full bg-white/10",children:h.jsx("div",{className:"h-1 rounded-full bg-blue-500 transition-all",style:{width:`${p}%`}})})]})]}),h.jsx("div",{className:"mt-4",children:x.map(w=>h.jsxs("div",{className:"flex items-center py-2.5 border-b border-white/5 last:border-b-0",children:[h.jsxs("span",{className:"flex items-center gap-1.5 text-[12px] text-gray-500 w-[120px] shrink-0",children:[w.icon,w.label]}),h.jsx("span",{className:"text-[13px] text-white truncate",children:w.value||"â€”"})]},w.label))}),s.description&&h.jsxs("div",{className:"mt-4",children:[h.jsx("h3",{className:"text-[11px] font-semibold uppercase tracking-wider text-gray-500",children:"Description"}),h.jsx("p",{className:"mt-2 text-[13px] leading-[1.6] text-gray-400 line-clamp-6",children:s.description})]}),h.jsxs("div",{className:"mt-auto pt-6 flex flex-col gap-2",children:[h.jsxs("button",{onClick:()=>t(s.id),className:"w-full py-2 rounded-lg bg-blue-600 hover:bg-blue-500 text-white text-[13px] font-medium transition-colors cursor-pointer flex items-center justify-center gap-2",children:[h.jsx(Ja,{size:14}),"æ‰“å¼€é˜…è¯»"]}),h.jsxs("div",{className:"flex gap-2",children:[s.readStatus!=="later"&&h.jsxs("button",{onClick:()=>d("later"),className:"flex-1 py-1.5 rounded-lg bg-white/5 hover:bg-white/10 text-gray-400 hover:text-white text-[12px] transition-colors cursor-pointer flex items-center justify-center gap-1.5",children:[h.jsx(Vr,{size:13}),"ç¨åŽ"]}),s.readStatus!=="archive"&&h.jsxs("button",{onClick:()=>d("archive"),className:"flex-1 py-1.5 rounded-lg bg-white/5 hover:bg-white/10 text-gray-400 hover:text-white text-[12px] transition-colors cursor-pointer flex items-center justify-center gap-1.5",children:[h.jsx(Xp,{size:13}),"å½’æ¡£"]}),h.jsxs("button",{onClick:f,className:"flex-1 py-1.5 rounded-lg bg-white/5 hover:bg-white/10 text-gray-400 hover:text-red-400 text-[12px] transition-colors cursor-pointer flex items-center justify-center gap-1.5",children:[h.jsx(rs,{size:13}),"åˆ é™¤"]})]})]})]}):h.jsx("div",{className:"flex items-center justify-center h-full text-sm text-gray-500",children:"ä¹¦ç±ä¸å­˜åœ¨"}):h.jsx("div",{className:"flex items-center justify-center h-full text-sm text-gray-500",children:"é€‰æ‹©ä¸€æœ¬ä¹¦æŸ¥çœ‹è¯¦æƒ…"})})})]})}function kH({onImported:n,collapsed:e}){const[t,i]=E.useState(!1),s=E.useCallback(async()=>{try{(await window.electronAPI.bookImport()).length>0&&n()}catch(d){console.error("Failed to import book:",d)}},[n]),r=E.useCallback(d=>{d.preventDefault(),d.stopPropagation(),i(!0)},[]),a=E.useCallback(d=>{d.preventDefault(),d.stopPropagation(),i(!1)},[]),o=E.useCallback(d=>{d.preventDefault(),d.stopPropagation(),i(!1),s()},[s]),{width:l,handleMouseDown:u}=fg({defaultWidth:600,minWidth:280,maxWidth:600,storageKey:"bookUploadPanelWidth"});return h.jsxs("div",{className:`
        flex flex-col bg-[#0f0f0f] border-l border-[#262626] shrink-0
        overflow-hidden relative
        ${e?"w-0 border-l-0":""}
      `,style:e?void 0:{width:l},children:[!e&&h.jsx("div",{onMouseDown:u,className:"absolute left-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500/30 active:bg-blue-500/50 z-10 transition-colors"}),h.jsxs("div",{className:"flex flex-col h-full",style:{minWidth:l},children:[h.jsx("div",{className:"shrink-0 px-4 pt-3 pb-2 border-b border-white/5",children:h.jsx("h3",{className:"text-[13px] font-semibold text-white",children:"Upload Books"})}),h.jsx("div",{className:"flex-1 flex items-center justify-center p-6",children:h.jsxs("div",{onDragOver:r,onDragLeave:a,onDrop:o,className:`
              w-full rounded-xl border-2 border-dashed p-8 flex flex-col items-center gap-4 transition-colors
              ${t?"border-blue-500 bg-blue-500/5":"border-white/10 hover:border-white/20"}
            `,children:[h.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/5 flex items-center justify-center",children:h.jsx(iR,{size:24,className:"text-gray-500"})}),h.jsxs("div",{className:"text-center",children:[h.jsx("p",{className:"text-[14px] text-gray-300",children:"Drag and drop EPUB/PDF files here"}),h.jsx("p",{className:"mt-1 text-[12px] text-gray-600",children:"Max file size: 500 MB"})]}),h.jsx("button",{onClick:s,className:"text-[13px] text-blue-400 hover:text-blue-300 transition-colors cursor-pointer",children:"Select a book file"})]})}),h.jsxs("div",{className:"shrink-0 px-6 pb-6 flex items-center gap-2 text-[12px] text-gray-600",children:[h.jsx(Ja,{size:14}),h.jsx("span",{children:"Supported: EPUB, PDF"})]})]})]})}function TH({items:n,onNavigate:e,loading:t}){function i(s,r=0){return s.map(a=>h.jsxs("li",{children:[h.jsx("button",{onClick:()=>e(a),className:"text-[12px] text-gray-400 hover:text-white text-left truncate w-full transition-colors py-0.5",style:{paddingLeft:`${r*12}px`},children:a.label}),a.children&&a.children.length>0&&h.jsx("ul",{children:i(a.children,r+1)})]},a.id))}return h.jsx("div",{className:"flex-1 overflow-y-auto p-3",children:n.length>0?h.jsx("ul",{className:"space-y-0.5",children:i(n)}):h.jsx("p",{className:"text-[12px] text-gray-500",children:t?"åŠ è½½ä¸­â€¦":"æ­¤ä¹¦ç±æ²¡æœ‰ç›®å½•"})})}const Zk={yellow:"#fbbf24",blue:"#3b82f6",green:"#22c55e",red:"#ef4444"};function DH(n){const e=Date.now()-new Date(n).getTime(),t=Math.floor(e/6e4);if(t<1)return"åˆšåˆš";if(t<60)return`${t} åˆ†é’Ÿå‰`;const i=Math.floor(t/60);if(i<24)return`${i} å°æ—¶å‰`;const s=Math.floor(i/24);return s<30?`${s} å¤©å‰`:new Date(n).toLocaleDateString("zh-CN")}function jH({book:n,readProgress:e,highlights:t,activeTab:i,onTabChange:s,focusedHighlightId:r,focusSignal:a,onHighlightsChange:o,onDeleteHighlight:l,onHighlightClick:u}){var D;const{width:d,handleMouseDown:f}=fg({defaultWidth:500,minWidth:240,maxWidth:500,storageKey:"bookReaderDetailPanelWidth"}),[p,g]=E.useState("info"),[x,w]=E.useState(null),[y,m]=E.useState(""),[v,b]=E.useState(null),A=E.useRef(new Map),S=i??p,C=E.useCallback(j=>{i===void 0&&g(j),s==null||s(j)},[i,s]);E.useEffect(()=>{if(!r||S!=="notebook")return;const j=A.current.get(r);if(!j)return;j.scrollIntoView({behavior:"smooth",block:"center"}),b(r);const P=window.setTimeout(()=>{b(H=>H===r?null:H)},1200);return()=>window.clearTimeout(P)},[r,a,S]);const k=E.useCallback(async(j,P)=>{const H=await window.electronAPI.highlightUpdate({id:j,note:P});o(t.map(G=>G.id===j?H:G)),w(null)},[t,o]),L=[...t].sort((j,P)=>new Date(P.createdAt).getTime()-new Date(j.createdAt).getTime());return h.jsxs("div",{className:"shrink-0 flex flex-col h-full min-h-0 border-l border-[#262626] bg-[#141414] relative",style:{width:d},children:[h.jsx("div",{onMouseDown:f,className:"absolute left-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500/30 active:bg-blue-500/50 z-10 transition-colors"}),h.jsx("div",{className:"shrink-0 flex gap-2 px-4 pt-3 pb-2 border-b border-[#262626]",children:[{key:"info",label:"Info"},{key:"notebook",label:"Notebook",count:t.length},{key:"chat",label:"Chat"}].map(j=>h.jsxs("button",{onClick:()=>C(j.key),className:`
              px-2.5 py-1 text-xs font-medium rounded transition-colors cursor-pointer flex items-center gap-1
              ${S===j.key?"text-white bg-white/10":"text-gray-500 hover:text-gray-300 hover:bg-white/5"}
            `,children:[j.label,j.count!=null&&j.count>0&&h.jsx("span",{className:"text-[10px] text-gray-500",children:j.count})]},j.key))}),h.jsxs("div",{className:"flex-1 min-h-0 overflow-y-auto p-4",children:[S==="info"&&n&&h.jsxs("div",{className:"flex flex-col gap-4",children:[h.jsxs("div",{children:[h.jsx("h3",{className:"text-[11px] font-semibold uppercase tracking-wider text-gray-500 mb-2",children:"Details"}),[{label:"Type",value:((D=n.fileType)==null?void 0:D.toUpperCase())||"EPUB",icon:h.jsx(xl,{className:"w-3.5 h-3.5"})},{label:"Author",value:n.author,icon:h.jsx(ov,{className:"w-3.5 h-3.5"})},{label:"Publisher",value:n.publisher,icon:h.jsx($j,{className:"w-3.5 h-3.5"})},{label:"Language",value:n.language,icon:h.jsx(ed,{className:"w-3.5 h-3.5"})},{label:"Progress",value:`${Math.round((e??n.readProgress??0)*100)}%`,icon:h.jsx(Vr,{className:"w-3.5 h-3.5"})}].map(j=>h.jsxs("div",{className:"flex items-center py-2 border-b border-white/5 last:border-b-0",children:[h.jsxs("span",{className:"flex items-center gap-1.5 text-[11px] text-gray-500 w-[90px] shrink-0",children:[j.icon,j.label]}),h.jsx("span",{className:"text-[12px] text-white truncate",children:j.value||"â€”"})]},j.label))]}),n.description&&h.jsxs("div",{children:[h.jsx("h3",{className:"text-[11px] font-semibold uppercase tracking-wider text-gray-500 mb-2",children:"Description"}),h.jsx("p",{className:"text-[12px] leading-[1.6] text-gray-400 line-clamp-6",children:n.description})]})]}),S==="notebook"&&h.jsx("div",{className:"flex flex-col",children:L.length===0?h.jsx("div",{className:"flex items-center justify-center h-[300px]",children:h.jsxs("div",{className:"text-center text-gray-500",children:[h.jsx(av,{className:"w-8 h-8 mx-auto mb-2 opacity-40"}),h.jsx("p",{className:"text-sm",children:"0 highlights"})]})}):h.jsxs("div",{className:"flex flex-col gap-3",children:[h.jsxs("span",{className:"text-[11px] font-semibold uppercase tracking-wider text-gray-500",children:[L.length," ",L.length===1?"highlight":"highlights"]}),L.map(j=>h.jsxs("div",{ref:P=>{P?A.current.set(j.id,P):A.current.delete(j.id)},className:"group relative flex rounded-lg bg-[#1a1a1a] border border-white/5 overflow-hidden cursor-pointer hover:border-white/15 transition-colors",style:{boxShadow:v===j.id?"0 0 0 2px rgba(59,130,246,0.55) inset":void 0},onClick:()=>u==null?void 0:u(j.id),children:[h.jsx("div",{className:"w-[3px] shrink-0",style:{backgroundColor:Zk[j.color]??Zk.yellow}}),h.jsxs("div",{className:"flex-1 p-2.5 min-w-0",children:[h.jsxs("p",{className:"text-[12px] leading-[1.5] text-gray-300 italic",children:["â€œ",j.text,"â€"]}),x===j.id?h.jsx("textarea",{autoFocus:!0,value:y,onChange:P=>m(P.target.value),onBlur:()=>k(j.id,y),onKeyDown:P=>{P.key==="Enter"&&!P.shiftKey&&(P.preventDefault(),k(j.id,y)),P.key==="Escape"&&w(null)},className:"mt-1 w-full text-[11px] text-gray-300 bg-white/5 border border-white/10 rounded px-2 py-1 resize-none outline-none focus:border-blue-500/50",rows:2,placeholder:"æ·»åŠ ç¬”è®°â€¦"}):h.jsx("button",{onClick:P=>{P.stopPropagation(),w(j.id),m(j.note||"")},className:"mt-1 block text-left text-[11px] text-gray-400 hover:text-gray-300 transition-colors w-full",children:j.note||"æ·»åŠ ç¬”è®°â€¦"}),h.jsx("span",{className:"mt-1.5 block text-[10px] text-gray-600",children:DH(j.createdAt)})]}),h.jsx("button",{onClick:P=>{P.stopPropagation(),l(j.id)},className:"absolute top-1.5 right-1.5 p-1 rounded opacity-0 group-hover:opacity-100 hover:bg-white/10 transition-all cursor-pointer text-gray-500 hover:text-red-400",children:h.jsx(rs,{className:"w-3 h-3"})})]},j.id))]})}),S==="chat"&&h.jsx("div",{className:"flex items-center justify-center h-[300px]",children:h.jsxs("div",{className:"text-center text-gray-600",children:[h.jsx(Fm,{className:"w-8 h-8 mx-auto mb-2 opacity-30"}),h.jsx("p",{className:"text-sm",children:"AI å¯¹è¯ï¼ˆäºŒæœŸåŠŸèƒ½ï¼‰"})]})})]})]})}const ER="z-reader-book-settings",RH=[{key:"system",label:"System"},{key:"serif",label:"Serif"},{key:"sans-serif",label:"Sans-serif"},{key:"monospace",label:"Monospace"}],LH=[1.5,1.75,2],MH=[{key:"dark",label:"Dark",preview:"bg-[#0f0f0f] border-gray-700"},{key:"light",label:"Light",preview:"bg-white border-gray-300"},{key:"sepia",label:"Sepia",preview:"bg-[#f4ecd8] border-amber-300"}],Qk={font:"system",fontSize:16,lineHeight:1.75,theme:"dark"};function OH(){try{const n=localStorage.getItem(ER);if(n)return{...Qk,...JSON.parse(n)}}catch{}return Qk}function IH(n){localStorage.setItem(ER,JSON.stringify(n))}const J1={system:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',serif:'"Georgia", "Times New Roman", serif',"sans-serif":'"Helvetica Neue", "Arial", sans-serif',monospace:'"JetBrains Mono", "Fira Code", monospace'};function PH({open:n,onClose:e,settings:t,onSettingsChange:i}){const s=E.useRef(null);if(E.useEffect(()=>{if(!n)return;const a=o=>{s.current&&!s.current.contains(o.target)&&e()};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[n,e]),!n)return null;const r=a=>{const o={...t,...a};i(o),IH(o)};return h.jsxs("div",{ref:s,className:"absolute top-12 right-4 z-50 w-[260px] bg-[#1a1a1a] border border-white/10 rounded-lg shadow-xl p-4 space-y-4",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("h3",{className:"text-[13px] font-semibold text-white",children:"æŽ’ç‰ˆè®¾ç½®"}),h.jsx("button",{onClick:e,className:"p-1 rounded hover:bg-white/10 text-gray-400 hover:text-white cursor-pointer",children:h.jsx(Fn,{className:"w-4 h-4"})})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-[11px] text-gray-500 uppercase tracking-wider",children:"Font"}),h.jsx("div",{className:"mt-1 flex gap-1",children:RH.map(a=>h.jsx("button",{onClick:()=>r({font:a.key}),className:`flex-1 py-1 text-[11px] rounded transition-colors cursor-pointer ${t.font===a.key?"bg-white/10 text-white":"text-gray-500 hover:bg-white/5"}`,children:a.label},a.key))})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-[11px] text-gray-500 uppercase tracking-wider",children:"Size"}),h.jsxs("div",{className:"mt-1 flex items-center gap-3",children:[h.jsx("button",{onClick:()=>r({fontSize:Math.max(12,t.fontSize-1)}),className:"w-7 h-7 rounded bg-white/5 text-white text-sm hover:bg-white/10 cursor-pointer",children:"âˆ’"}),h.jsx("span",{className:"text-[13px] text-white w-8 text-center",children:t.fontSize}),h.jsx("button",{onClick:()=>r({fontSize:Math.min(28,t.fontSize+1)}),className:"w-7 h-7 rounded bg-white/5 text-white text-sm hover:bg-white/10 cursor-pointer",children:"+"})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-[11px] text-gray-500 uppercase tracking-wider",children:"Line Height"}),h.jsx("div",{className:"mt-1 flex gap-1",children:LH.map(a=>h.jsx("button",{onClick:()=>r({lineHeight:a}),className:`flex-1 py-1 text-[11px] rounded transition-colors cursor-pointer ${t.lineHeight===a?"bg-white/10 text-white":"text-gray-500 hover:bg-white/5"}`,children:a},a))})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-[11px] text-gray-500 uppercase tracking-wider",children:"Theme"}),h.jsx("div",{className:"mt-1 flex gap-2",children:MH.map(a=>h.jsx("button",{onClick:()=>r({theme:a.key}),className:`flex-1 py-1.5 text-[11px] rounded border transition-colors cursor-pointer ${a.preview} ${t.theme===a.key?"ring-2 ring-blue-500":""}`,children:a.label},a.key))})]})]})}var YS={exports:{}},CR={exports:{}},BH=void 0,_R=function(n){return n!==BH&&n!==null},FH=_R,zH={object:!0,function:!0,undefined:!0},UH=function(n){return FH(n)?hasOwnProperty.call(zH,typeof n):!1},HH=UH,$H=function(n){if(!HH(n))return!1;try{return n.constructor?n.constructor.prototype===n:!1}catch{return!1}},qH=$H,VH=function(n){if(typeof n!="function"||!hasOwnProperty.call(n,"length"))return!1;try{if(typeof n.length!="number"||typeof n.call!="function"||typeof n.apply!="function")return!1}catch{return!1}return!qH(n)},GH=VH,YH=/^\s*class[\s{/}]/,WH=Function.prototype.toString,XH=function(n){return!(!GH(n)||YH.test(WH.call(n)))},KH=function(){var n=Object.assign,e;return typeof n!="function"?!1:(e={foo:"raz"},n(e,{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")},g2,Jk;function ZH(){return Jk||(Jk=1,g2=function(){try{return Object.keys("primitive"),!0}catch{return!1}}),g2}var QH=function(){},JH=QH(),VC=function(n){return n!==JH&&n!==null},m2,eT;function e7(){if(eT)return m2;eT=1;var n=VC,e=Object.keys;return m2=function(t){return e(n(t)?Object(t):t)},m2}var y2,tT;function t7(){return tT||(tT=1,y2=ZH()()?Object.keys:e7()),y2}var v2,iT;function i7(){if(iT)return v2;iT=1;var n=VC;return v2=function(e){if(!n(e))throw new TypeError("Cannot use null or undefined");return e},v2}var x2,nT;function n7(){if(nT)return x2;nT=1;var n=t7(),e=i7(),t=Math.max;return x2=function(i,s){var r,a,o=t(arguments.length,2),l;for(i=Object(e(i)),l=function(u){try{i[u]=s[u]}catch(d){r||(r=d)}},a=1;a<o;++a)s=arguments[a],n(s).forEach(l);if(r!==void 0)throw r;return i},x2}var s7=KH()?Object.assign:n7(),r7=VC,a7=Array.prototype.forEach,o7=Object.create,l7=function(n,e){var t;for(t in n)e[t]=n[t]},c7=function(n){var e=o7(null);return a7.call(arguments,function(t){r7(t)&&l7(Object(t),e)}),e},b2="razdwatrzy",u7=function(){return typeof b2.contains!="function"?!1:b2.contains("dwa")===!0&&b2.contains("foo")===!1},w2,sT;function h7(){if(sT)return w2;sT=1;var n=String.prototype.indexOf;return w2=function(e){return n.call(this,e,arguments[1])>-1},w2}var d7=u7()?String.prototype.contains:h7(),fx=_R,rT=XH,NR=s7,kR=c7,Sm=d7,f7=CR.exports=function(n,e){var t,i,s,r,a;return arguments.length<2||typeof n!="string"?(r=e,e=n,n=null):r=arguments[2],fx(n)?(t=Sm.call(n,"c"),i=Sm.call(n,"e"),s=Sm.call(n,"w")):(t=s=!0,i=!1),a={value:e,configurable:t,enumerable:i,writable:s},r?NR(kR(r),a):a};f7.gs=function(n,e,t){var i,s,r,a;return typeof n!="string"?(r=t,t=e,e=n,n=null):r=arguments[3],fx(e)?rT(e)?fx(t)?rT(t)||(r=t,t=void 0):t=void 0:(r=e,e=t=void 0):e=void 0,fx(n)?(i=Sm.call(n,"c"),s=Sm.call(n,"e")):(i=!0,s=!1),a={get:e,set:t,configurable:i,enumerable:s},r?NR(kR(r),a):a};var p7=CR.exports,g7=function(n){if(typeof n!="function")throw new TypeError(n+" is not a function");return n};(function(n,e){var t=p7,i=g7,s=Function.prototype.apply,r=Function.prototype.call,a=Object.create,o=Object.defineProperty,l=Object.defineProperties,u=Object.prototype.hasOwnProperty,d={configurable:!0,enumerable:!1,writable:!0},f,p,g,x,w,y,m;f=function(v,b){var A;return i(b),u.call(this,"__ee__")?A=this.__ee__:(A=d.value=a(null),o(this,"__ee__",d),d.value=null),A[v]?typeof A[v]=="object"?A[v].push(b):A[v]=[A[v],b]:A[v]=b,this},p=function(v,b){var A,S;return i(b),S=this,f.call(this,v,A=function(){g.call(S,v,A),s.call(b,this,arguments)}),A.__eeOnceListener__=b,this},g=function(v,b){var A,S,C,k;if(i(b),!u.call(this,"__ee__"))return this;if(A=this.__ee__,!A[v])return this;if(S=A[v],typeof S=="object")for(k=0;C=S[k];++k)(C===b||C.__eeOnceListener__===b)&&(S.length===2?A[v]=S[k?0:1]:S.splice(k,1));else(S===b||S.__eeOnceListener__===b)&&delete A[v];return this},x=function(v){var b,A,S,C,k;if(u.call(this,"__ee__")&&(C=this.__ee__[v],!!C))if(typeof C=="object"){for(A=arguments.length,k=new Array(A-1),b=1;b<A;++b)k[b-1]=arguments[b];for(C=C.slice(),b=0;S=C[b];++b)s.call(S,this,k)}else switch(arguments.length){case 1:r.call(C,this);break;case 2:r.call(C,this,arguments[1]);break;case 3:r.call(C,this,arguments[1],arguments[2]);break;default:for(A=arguments.length,k=new Array(A-1),b=1;b<A;++b)k[b-1]=arguments[b];s.call(C,this,k)}},w={on:f,once:p,off:g,emit:x},y={on:t(f),once:t(p),off:t(g),emit:t(x)},m=l({},y),n.exports=e=function(v){return v==null?a(m):l(Object(v),y)},e.methods=w})(YS,YS.exports);var m7=YS.exports;const ro=Wh(m7);var ou={},lu={};function y7(n,e,t){if(t===void 0&&(t=Array.prototype),n&&typeof t.find=="function")return t.find.call(n,e);for(var i=0;i<n.length;i++)if(Object.prototype.hasOwnProperty.call(n,i)){var s=n[i];if(e.call(void 0,s,i,n))return s}}function GC(n,e){return e===void 0&&(e=Object),e&&typeof e.freeze=="function"?e.freeze(n):n}var TR=GC({HTML:"text/html",isHTML:function(n){return n===TR.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),DR=GC({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(n){return n===DR.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});lu.find=y7;lu.freeze=GC;lu.MIME_TYPE=TR;lu.NAMESPACE=DR;var jR=lu,Ka=jR.find,zm=jR.NAMESPACE;function v7(n){return n!==""}function x7(n){return n?n.split(/[\t\n\f\r ]+/).filter(v7):[]}function b7(n,e){return n.hasOwnProperty(e)||(n[e]=!0),n}function aT(n){if(!n)return[];var e=x7(n);return Object.keys(e.reduce(b7,{}))}function w7(n){return function(e){return n&&n.indexOf(e)!==-1}}function lv(n,e){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}function Ts(n,e){var t=n.prototype;if(!(t instanceof e)){let i=function(){};i.prototype=e.prototype,i=new i,lv(t,i),n.prototype=t=i}t.constructor!=n&&(typeof n!="function"&&console.error("unknown Class:"+n),t.constructor=n)}var Ds={},ma=Ds.ELEMENT_NODE=1,Zp=Ds.ATTRIBUTE_NODE=2,Mb=Ds.TEXT_NODE=3,RR=Ds.CDATA_SECTION_NODE=4,LR=Ds.ENTITY_REFERENCE_NODE=5,S7=Ds.ENTITY_NODE=6,MR=Ds.PROCESSING_INSTRUCTION_NODE=7,OR=Ds.COMMENT_NODE=8,IR=Ds.DOCUMENT_NODE=9,PR=Ds.DOCUMENT_TYPE_NODE=10,wl=Ds.DOCUMENT_FRAGMENT_NODE=11,A7=Ds.NOTATION_NODE=12,Xn={},wn={};Xn.INDEX_SIZE_ERR=(wn[1]="Index size error",1);Xn.DOMSTRING_SIZE_ERR=(wn[2]="DOMString size error",2);var Es=Xn.HIERARCHY_REQUEST_ERR=(wn[3]="Hierarchy request error",3);Xn.WRONG_DOCUMENT_ERR=(wn[4]="Wrong document",4);Xn.INVALID_CHARACTER_ERR=(wn[5]="Invalid character",5);Xn.NO_DATA_ALLOWED_ERR=(wn[6]="No data allowed",6);Xn.NO_MODIFICATION_ALLOWED_ERR=(wn[7]="No modification allowed",7);var BR=Xn.NOT_FOUND_ERR=(wn[8]="Not found",8);Xn.NOT_SUPPORTED_ERR=(wn[9]="Not supported",9);var oT=Xn.INUSE_ATTRIBUTE_ERR=(wn[10]="Attribute in use",10);Xn.INVALID_STATE_ERR=(wn[11]="Invalid state",11);Xn.SYNTAX_ERR=(wn[12]="Syntax error",12);Xn.INVALID_MODIFICATION_ERR=(wn[13]="Invalid modification",13);Xn.NAMESPACE_ERR=(wn[14]="Invalid namespace",14);Xn.INVALID_ACCESS_ERR=(wn[15]="Invalid access",15);function Ui(n,e){if(e instanceof Error)var t=e;else t=this,Error.call(this,wn[n]),this.message=wn[n],Error.captureStackTrace&&Error.captureStackTrace(this,Ui);return t.code=n,e&&(this.message=this.message+": "+e),t}Ui.prototype=Error.prototype;lv(Xn,Ui);function cl(){}cl.prototype={length:0,item:function(n){return n>=0&&n<this.length?this[n]:null},toString:function(n,e){for(var t=[],i=0;i<this.length;i++)Wd(this[i],t,n,e);return t.join("")},filter:function(n){return Array.prototype.filter.call(this,n)},indexOf:function(n){return Array.prototype.indexOf.call(this,n)}};function Qp(n,e){this._node=n,this._refresh=e,YC(this)}function YC(n){var e=n._node._inc||n._node.ownerDocument._inc;if(n._inc!==e){var t=n._refresh(n._node);if(KR(n,"length",t.length),!n.$$length||t.length<n.$$length)for(var i=t.length;i in n;i++)Object.prototype.hasOwnProperty.call(n,i)&&delete n[i];lv(t,n),n._inc=e}}Qp.prototype.item=function(n){return YC(this),this[n]||null};Ts(Qp,cl);function Ob(){}function FR(n,e){for(var t=n.length;t--;)if(n[t]===e)return t}function lT(n,e,t,i){if(i?e[FR(e,i)]=t:e[e.length++]=t,n){t.ownerElement=n;var s=n.ownerDocument;s&&(i&&HR(s,n,i),E7(s,n,t))}}function cT(n,e,t){var i=FR(e,t);if(i>=0){for(var s=e.length-1;i<s;)e[i]=e[++i];if(e.length=s,n){var r=n.ownerDocument;r&&(HR(r,n,t),t.ownerElement=null)}}else throw new Ui(BR,new Error(n.tagName+"@"+t))}Ob.prototype={length:0,item:cl.prototype.item,getNamedItem:function(n){for(var e=this.length;e--;){var t=this[e];if(t.nodeName==n)return t}},setNamedItem:function(n){var e=n.ownerElement;if(e&&e!=this._ownerElement)throw new Ui(oT);var t=this.getNamedItem(n.nodeName);return lT(this._ownerElement,this,n,t),t},setNamedItemNS:function(n){var e=n.ownerElement,t;if(e&&e!=this._ownerElement)throw new Ui(oT);return t=this.getNamedItemNS(n.namespaceURI,n.localName),lT(this._ownerElement,this,n,t),t},removeNamedItem:function(n){var e=this.getNamedItem(n);return cT(this._ownerElement,this,e),e},removeNamedItemNS:function(n,e){var t=this.getNamedItemNS(n,e);return cT(this._ownerElement,this,t),t},getNamedItemNS:function(n,e){for(var t=this.length;t--;){var i=this[t];if(i.localName==e&&i.namespaceURI==n)return i}return null}};function zR(){}zR.prototype={hasFeature:function(n,e){return!0},createDocument:function(n,e,t){var i=new cv;if(i.implementation=this,i.childNodes=new cl,i.doctype=t||null,t&&i.appendChild(t),e){var s=i.createElementNS(n,e);i.appendChild(s)}return i},createDocumentType:function(n,e,t){var i=new ew;return i.name=n,i.nodeName=n,i.publicId=e||"",i.systemId=t||"",i}};function Kt(){}Kt.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(n,e){return Ib(this,n,e)},replaceChild:function(n,e){Ib(this,n,e,qR),e&&this.removeChild(e)},removeChild:function(n){return $R(this,n)},appendChild:function(n){return this.insertBefore(n,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(n){return WS(this.ownerDocument||this,this,n)},normalize:function(){for(var n=this.firstChild;n;){var e=n.nextSibling;e&&e.nodeType==Mb&&n.nodeType==Mb?(this.removeChild(e),n.appendData(e.data)):(n.normalize(),n=e)}},isSupported:function(n,e){return this.ownerDocument.implementation.hasFeature(n,e)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(n){for(var e=this;e;){var t=e._nsMap;if(t){for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)&&t[i]===n)return i}e=e.nodeType==Zp?e.ownerDocument:e.parentNode}return null},lookupNamespaceURI:function(n){for(var e=this;e;){var t=e._nsMap;if(t&&n in t&&Object.prototype.hasOwnProperty.call(t,n))return t[n];e=e.nodeType==Zp?e.ownerDocument:e.parentNode}return null},isDefaultNamespace:function(n){var e=this.lookupPrefix(n);return e==null}};function UR(n){return n=="<"&&"&lt;"||n==">"&&"&gt;"||n=="&"&&"&amp;"||n=='"'&&"&quot;"||"&#"+n.charCodeAt()+";"}lv(Ds,Kt);lv(Ds,Kt.prototype);function Um(n,e){if(e(n))return!0;if(n=n.firstChild)do if(Um(n,e))return!0;while(n=n.nextSibling)}function cv(){this.ownerDocument=this}function E7(n,e,t){n&&n._inc++;var i=t.namespaceURI;i===zm.XMLNS&&(e._nsMap[t.prefix?t.localName:""]=t.value)}function HR(n,e,t,i){n&&n._inc++;var s=t.namespaceURI;s===zm.XMLNS&&delete e._nsMap[t.prefix?t.localName:""]}function WC(n,e,t){if(n&&n._inc){n._inc++;var i=e.childNodes;if(t)i[i.length++]=t;else{for(var s=e.firstChild,r=0;s;)i[r++]=s,s=s.nextSibling;i.length=r,delete i[i.length]}}}function $R(n,e){var t=e.previousSibling,i=e.nextSibling;return t?t.nextSibling=i:n.firstChild=i,i?i.previousSibling=t:n.lastChild=t,e.parentNode=null,e.previousSibling=null,e.nextSibling=null,WC(n.ownerDocument,n),e}function C7(n){return n&&(n.nodeType===Kt.DOCUMENT_NODE||n.nodeType===Kt.DOCUMENT_FRAGMENT_NODE||n.nodeType===Kt.ELEMENT_NODE)}function _7(n){return n&&(Za(n)||XC(n)||Sl(n)||n.nodeType===Kt.DOCUMENT_FRAGMENT_NODE||n.nodeType===Kt.COMMENT_NODE||n.nodeType===Kt.PROCESSING_INSTRUCTION_NODE)}function Sl(n){return n&&n.nodeType===Kt.DOCUMENT_TYPE_NODE}function Za(n){return n&&n.nodeType===Kt.ELEMENT_NODE}function XC(n){return n&&n.nodeType===Kt.TEXT_NODE}function uT(n,e){var t=n.childNodes||[];if(Ka(t,Za)||Sl(e))return!1;var i=Ka(t,Sl);return!(e&&i&&t.indexOf(i)>t.indexOf(e))}function hT(n,e){var t=n.childNodes||[];function i(r){return Za(r)&&r!==e}if(Ka(t,i))return!1;var s=Ka(t,Sl);return!(e&&s&&t.indexOf(s)>t.indexOf(e))}function N7(n,e,t){if(!C7(n))throw new Ui(Es,"Unexpected parent node type "+n.nodeType);if(t&&t.parentNode!==n)throw new Ui(BR,"child not in parent");if(!_7(e)||Sl(e)&&n.nodeType!==Kt.DOCUMENT_NODE)throw new Ui(Es,"Unexpected node type "+e.nodeType+" for parent node type "+n.nodeType)}function k7(n,e,t){var i=n.childNodes||[],s=e.childNodes||[];if(e.nodeType===Kt.DOCUMENT_FRAGMENT_NODE){var r=s.filter(Za);if(r.length>1||Ka(s,XC))throw new Ui(Es,"More than one element or text in fragment");if(r.length===1&&!uT(n,t))throw new Ui(Es,"Element in fragment can not be inserted before doctype")}if(Za(e)&&!uT(n,t))throw new Ui(Es,"Only one element can be added and only after doctype");if(Sl(e)){if(Ka(i,Sl))throw new Ui(Es,"Only one doctype is allowed");var a=Ka(i,Za);if(t&&i.indexOf(a)<i.indexOf(t))throw new Ui(Es,"Doctype can only be inserted before an element");if(!t&&a)throw new Ui(Es,"Doctype can not be appended since element is present")}}function qR(n,e,t){var i=n.childNodes||[],s=e.childNodes||[];if(e.nodeType===Kt.DOCUMENT_FRAGMENT_NODE){var r=s.filter(Za);if(r.length>1||Ka(s,XC))throw new Ui(Es,"More than one element or text in fragment");if(r.length===1&&!hT(n,t))throw new Ui(Es,"Element in fragment can not be inserted before doctype")}if(Za(e)&&!hT(n,t))throw new Ui(Es,"Only one element can be added and only after doctype");if(Sl(e)){if(Ka(i,function(l){return Sl(l)&&l!==t}))throw new Ui(Es,"Only one doctype is allowed");var a=Ka(i,Za);if(t&&i.indexOf(a)<i.indexOf(t))throw new Ui(Es,"Doctype can only be inserted before an element")}}function Ib(n,e,t,i){N7(n,e,t),n.nodeType===Kt.DOCUMENT_NODE&&(i||k7)(n,e,t);var s=e.parentNode;if(s&&s.removeChild(e),e.nodeType===wl){var r=e.firstChild;if(r==null)return e;var a=e.lastChild}else r=a=e;var o=t?t.previousSibling:n.lastChild;r.previousSibling=o,a.nextSibling=t,o?o.nextSibling=r:n.firstChild=r,t==null?n.lastChild=a:t.previousSibling=a;do r.parentNode=n;while(r!==a&&(r=r.nextSibling));return WC(n.ownerDocument||n,n),e.nodeType==wl&&(e.firstChild=e.lastChild=null),e}function T7(n,e){return e.parentNode&&e.parentNode.removeChild(e),e.parentNode=n,e.previousSibling=n.lastChild,e.nextSibling=null,e.previousSibling?e.previousSibling.nextSibling=e:n.firstChild=e,n.lastChild=e,WC(n.ownerDocument,n,e),e}cv.prototype={nodeName:"#document",nodeType:IR,doctype:null,documentElement:null,_inc:1,insertBefore:function(n,e){if(n.nodeType==wl){for(var t=n.firstChild;t;){var i=t.nextSibling;this.insertBefore(t,e),t=i}return n}return Ib(this,n,e),n.ownerDocument=this,this.documentElement===null&&n.nodeType===ma&&(this.documentElement=n),n},removeChild:function(n){return this.documentElement==n&&(this.documentElement=null),$R(this,n)},replaceChild:function(n,e){Ib(this,n,e,qR),n.ownerDocument=this,e&&this.removeChild(e),Za(n)&&(this.documentElement=n)},importNode:function(n,e){return XR(this,n,e)},getElementById:function(n){var e=null;return Um(this.documentElement,function(t){if(t.nodeType==ma&&t.getAttribute("id")==n)return e=t,!0}),e},getElementsByClassName:function(n){var e=aT(n);return new Qp(this,function(t){var i=[];return e.length>0&&Um(t.documentElement,function(s){if(s!==t&&s.nodeType===ma){var r=s.getAttribute("class");if(r){var a=n===r;if(!a){var o=aT(r);a=e.every(w7(o))}a&&i.push(s)}}}),i})},createElement:function(n){var e=new qh;e.ownerDocument=this,e.nodeName=n,e.tagName=n,e.localName=n,e.childNodes=new cl;var t=e.attributes=new Ob;return t._ownerElement=e,e},createDocumentFragment:function(){var n=new tw;return n.ownerDocument=this,n.childNodes=new cl,n},createTextNode:function(n){var e=new KC;return e.ownerDocument=this,e.appendData(n),e},createComment:function(n){var e=new ZC;return e.ownerDocument=this,e.appendData(n),e},createCDATASection:function(n){var e=new QC;return e.ownerDocument=this,e.appendData(n),e},createProcessingInstruction:function(n,e){var t=new e_;return t.ownerDocument=this,t.tagName=t.nodeName=t.target=n,t.nodeValue=t.data=e,t},createAttribute:function(n){var e=new Pb;return e.ownerDocument=this,e.name=n,e.nodeName=n,e.localName=n,e.specified=!0,e},createEntityReference:function(n){var e=new JC;return e.ownerDocument=this,e.nodeName=n,e},createElementNS:function(n,e){var t=new qh,i=e.split(":"),s=t.attributes=new Ob;return t.childNodes=new cl,t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.namespaceURI=n,i.length==2?(t.prefix=i[0],t.localName=i[1]):t.localName=e,s._ownerElement=t,t},createAttributeNS:function(n,e){var t=new Pb,i=e.split(":");return t.ownerDocument=this,t.nodeName=e,t.name=e,t.namespaceURI=n,t.specified=!0,i.length==2?(t.prefix=i[0],t.localName=i[1]):t.localName=e,t}};Ts(cv,Kt);function qh(){this._nsMap={}}qh.prototype={nodeType:ma,hasAttribute:function(n){return this.getAttributeNode(n)!=null},getAttribute:function(n){var e=this.getAttributeNode(n);return e&&e.value||""},getAttributeNode:function(n){return this.attributes.getNamedItem(n)},setAttribute:function(n,e){var t=this.ownerDocument.createAttribute(n);t.value=t.nodeValue=""+e,this.setAttributeNode(t)},removeAttribute:function(n){var e=this.getAttributeNode(n);e&&this.removeAttributeNode(e)},appendChild:function(n){return n.nodeType===wl?this.insertBefore(n,null):T7(this,n)},setAttributeNode:function(n){return this.attributes.setNamedItem(n)},setAttributeNodeNS:function(n){return this.attributes.setNamedItemNS(n)},removeAttributeNode:function(n){return this.attributes.removeNamedItem(n.nodeName)},removeAttributeNS:function(n,e){var t=this.getAttributeNodeNS(n,e);t&&this.removeAttributeNode(t)},hasAttributeNS:function(n,e){return this.getAttributeNodeNS(n,e)!=null},getAttributeNS:function(n,e){var t=this.getAttributeNodeNS(n,e);return t&&t.value||""},setAttributeNS:function(n,e,t){var i=this.ownerDocument.createAttributeNS(n,e);i.value=i.nodeValue=""+t,this.setAttributeNode(i)},getAttributeNodeNS:function(n,e){return this.attributes.getNamedItemNS(n,e)},getElementsByTagName:function(n){return new Qp(this,function(e){var t=[];return Um(e,function(i){i!==e&&i.nodeType==ma&&(n==="*"||i.tagName==n)&&t.push(i)}),t})},getElementsByTagNameNS:function(n,e){return new Qp(this,function(t){var i=[];return Um(t,function(s){s!==t&&s.nodeType===ma&&(n==="*"||s.namespaceURI===n)&&(e==="*"||s.localName==e)&&i.push(s)}),i})}};cv.prototype.getElementsByTagName=qh.prototype.getElementsByTagName;cv.prototype.getElementsByTagNameNS=qh.prototype.getElementsByTagNameNS;Ts(qh,Kt);function Pb(){}Pb.prototype.nodeType=Zp;Ts(Pb,Kt);function uv(){}uv.prototype={data:"",substringData:function(n,e){return this.data.substring(n,n+e)},appendData:function(n){n=this.data+n,this.nodeValue=this.data=n,this.length=n.length},insertData:function(n,e){this.replaceData(n,0,e)},appendChild:function(n){throw new Error(wn[Es])},deleteData:function(n,e){this.replaceData(n,e,"")},replaceData:function(n,e,t){var i=this.data.substring(0,n),s=this.data.substring(n+e);t=i+t+s,this.nodeValue=this.data=t,this.length=t.length}};Ts(uv,Kt);function KC(){}KC.prototype={nodeName:"#text",nodeType:Mb,splitText:function(n){var e=this.data,t=e.substring(n);e=e.substring(0,n),this.data=this.nodeValue=e,this.length=e.length;var i=this.ownerDocument.createTextNode(t);return this.parentNode&&this.parentNode.insertBefore(i,this.nextSibling),i}};Ts(KC,uv);function ZC(){}ZC.prototype={nodeName:"#comment",nodeType:OR};Ts(ZC,uv);function QC(){}QC.prototype={nodeName:"#cdata-section",nodeType:RR};Ts(QC,uv);function ew(){}ew.prototype.nodeType=PR;Ts(ew,Kt);function VR(){}VR.prototype.nodeType=A7;Ts(VR,Kt);function GR(){}GR.prototype.nodeType=S7;Ts(GR,Kt);function JC(){}JC.prototype.nodeType=LR;Ts(JC,Kt);function tw(){}tw.prototype.nodeName="#document-fragment";tw.prototype.nodeType=wl;Ts(tw,Kt);function e_(){}e_.prototype.nodeType=MR;Ts(e_,Kt);function YR(){}YR.prototype.serializeToString=function(n,e,t){return WR.call(n,e,t)};Kt.prototype.toString=WR;function WR(n,e){var t=[],i=this.nodeType==9&&this.documentElement||this,s=i.prefix,r=i.namespaceURI;if(r&&s==null){var s=i.lookupPrefix(r);if(s==null)var a=[{namespace:r,prefix:null}]}return Wd(this,t,n,e,a),t.join("")}function dT(n,e,t){var i=n.prefix||"",s=n.namespaceURI;if(!s||i==="xml"&&s===zm.XML||s===zm.XMLNS)return!1;for(var r=t.length;r--;){var a=t[r];if(a.prefix===i)return a.namespace!==s}return!0}function S2(n,e,t){n.push(" ",e,'="',t.replace(/[<&"]/g,UR),'"')}function Wd(n,e,t,i,s){if(s||(s=[]),i)if(n=i(n),n){if(typeof n=="string"){e.push(n);return}}else return;switch(n.nodeType){case ma:var r=n.attributes,a=r.length,m=n.firstChild,o=n.tagName;t=zm.isHTML(n.namespaceURI)||t;var l=o;if(!t&&!n.prefix&&n.namespaceURI){for(var u,d=0;d<r.length;d++)if(r.item(d).name==="xmlns"){u=r.item(d).value;break}if(!u)for(var f=s.length-1;f>=0;f--){var p=s[f];if(p.prefix===""&&p.namespace===n.namespaceURI){u=p.namespace;break}}if(u!==n.namespaceURI)for(var f=s.length-1;f>=0;f--){var p=s[f];if(p.namespace===n.namespaceURI){p.prefix&&(l=p.prefix+":"+o);break}}}e.push("<",l);for(var g=0;g<a;g++){var x=r.item(g);x.prefix=="xmlns"?s.push({prefix:x.localName,namespace:x.value}):x.nodeName=="xmlns"&&s.push({prefix:"",namespace:x.value})}for(var g=0;g<a;g++){var x=r.item(g);if(dT(x,t,s)){var w=x.prefix||"",y=x.namespaceURI;S2(e,w?"xmlns:"+w:"xmlns",y),s.push({prefix:w,namespace:y})}Wd(x,e,t,i,s)}if(o===l&&dT(n,t,s)){var w=n.prefix||"",y=n.namespaceURI;S2(e,w?"xmlns:"+w:"xmlns",y),s.push({prefix:w,namespace:y})}if(m||t&&!/^(?:meta|link|img|br|hr|input)$/i.test(o)){if(e.push(">"),t&&/^script$/i.test(o))for(;m;)m.data?e.push(m.data):Wd(m,e,t,i,s.slice()),m=m.nextSibling;else for(;m;)Wd(m,e,t,i,s.slice()),m=m.nextSibling;e.push("</",l,">")}else e.push("/>");return;case IR:case wl:for(var m=n.firstChild;m;)Wd(m,e,t,i,s.slice()),m=m.nextSibling;return;case Zp:return S2(e,n.name,n.value);case Mb:return e.push(n.data.replace(/[<&]/g,UR).replace(/]]>/g,"]]&gt;"));case RR:return e.push("<![CDATA[",n.data,"]]>");case OR:return e.push("<!--",n.data,"-->");case PR:var v=n.publicId,b=n.systemId;if(e.push("<!DOCTYPE ",n.name),v)e.push(" PUBLIC ",v),b&&b!="."&&e.push(" ",b),e.push(">");else if(b&&b!=".")e.push(" SYSTEM ",b,">");else{var A=n.internalSubset;A&&e.push(" [",A,"]"),e.push(">")}return;case MR:return e.push("<?",n.target," ",n.data,"?>");case LR:return e.push("&",n.nodeName,";");default:e.push("??",n.nodeName)}}function XR(n,e,t){var i;switch(e.nodeType){case ma:i=e.cloneNode(!1),i.ownerDocument=n;case wl:break;case Zp:t=!0;break}if(i||(i=e.cloneNode(!1)),i.ownerDocument=n,i.parentNode=null,t)for(var s=e.firstChild;s;)i.appendChild(XR(n,s,t)),s=s.nextSibling;return i}function WS(n,e,t){var i=new e.constructor;for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){var r=e[s];typeof r!="object"&&r!=i[s]&&(i[s]=r)}switch(e.childNodes&&(i.childNodes=new cl),i.ownerDocument=n,i.nodeType){case ma:var a=e.attributes,o=i.attributes=new Ob,l=a.length;o._ownerElement=i;for(var u=0;u<l;u++)i.setAttributeNode(WS(n,a.item(u),!0));break;case Zp:t=!0}if(t)for(var d=e.firstChild;d;)i.appendChild(WS(n,d,t)),d=d.nextSibling;return i}function KR(n,e,t){n[e]=t}try{if(Object.defineProperty){let n=function(e){switch(e.nodeType){case ma:case wl:var t=[];for(e=e.firstChild;e;)e.nodeType!==7&&e.nodeType!==8&&t.push(n(e)),e=e.nextSibling;return t.join("");default:return e.nodeValue}};Object.defineProperty(Qp.prototype,"length",{get:function(){return YC(this),this.$$length}}),Object.defineProperty(Kt.prototype,"textContent",{get:function(){return n(this)},set:function(e){switch(this.nodeType){case ma:case wl:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),KR=function(e,t,i){e["$$"+t]=i}}}catch{}ou.DocumentType=ew;ou.DOMException=Ui;ou.DOMImplementation=zR;ou.Element=qh;ou.Node=Kt;ou.NodeList=cl;ou.XMLSerializer=YR;var hv={},ZR={};(function(n){var e=lu.freeze;n.XML_ENTITIES=e({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),n.HTML_ENTITIES=e({Aacute:"Ã",aacute:"Ã¡",Abreve:"Ä‚",abreve:"Äƒ",ac:"âˆ¾",acd:"âˆ¿",acE:"âˆ¾Ì³",Acirc:"Ã‚",acirc:"Ã¢",acute:"Â´",Acy:"Ð",acy:"Ð°",AElig:"Ã†",aelig:"Ã¦",af:"â¡",Afr:"ð”„",afr:"ð”ž",Agrave:"Ã€",agrave:"Ã ",alefsym:"â„µ",aleph:"â„µ",Alpha:"Î‘",alpha:"Î±",Amacr:"Ä€",amacr:"Ä",amalg:"â¨¿",AMP:"&",amp:"&",And:"â©“",and:"âˆ§",andand:"â©•",andd:"â©œ",andslope:"â©˜",andv:"â©š",ang:"âˆ ",ange:"â¦¤",angle:"âˆ ",angmsd:"âˆ¡",angmsdaa:"â¦¨",angmsdab:"â¦©",angmsdac:"â¦ª",angmsdad:"â¦«",angmsdae:"â¦¬",angmsdaf:"â¦­",angmsdag:"â¦®",angmsdah:"â¦¯",angrt:"âˆŸ",angrtvb:"âŠ¾",angrtvbd:"â¦",angsph:"âˆ¢",angst:"Ã…",angzarr:"â¼",Aogon:"Ä„",aogon:"Ä…",Aopf:"ð”¸",aopf:"ð•’",ap:"â‰ˆ",apacir:"â©¯",apE:"â©°",ape:"â‰Š",apid:"â‰‹",apos:"'",ApplyFunction:"â¡",approx:"â‰ˆ",approxeq:"â‰Š",Aring:"Ã…",aring:"Ã¥",Ascr:"ð’œ",ascr:"ð’¶",Assign:"â‰”",ast:"*",asymp:"â‰ˆ",asympeq:"â‰",Atilde:"Ãƒ",atilde:"Ã£",Auml:"Ã„",auml:"Ã¤",awconint:"âˆ³",awint:"â¨‘",backcong:"â‰Œ",backepsilon:"Ï¶",backprime:"â€µ",backsim:"âˆ½",backsimeq:"â‹",Backslash:"âˆ–",Barv:"â«§",barvee:"âŠ½",Barwed:"âŒ†",barwed:"âŒ…",barwedge:"âŒ…",bbrk:"âŽµ",bbrktbrk:"âŽ¶",bcong:"â‰Œ",Bcy:"Ð‘",bcy:"Ð±",bdquo:"â€ž",becaus:"âˆµ",Because:"âˆµ",because:"âˆµ",bemptyv:"â¦°",bepsi:"Ï¶",bernou:"â„¬",Bernoullis:"â„¬",Beta:"Î’",beta:"Î²",beth:"â„¶",between:"â‰¬",Bfr:"ð”…",bfr:"ð”Ÿ",bigcap:"â‹‚",bigcirc:"â—¯",bigcup:"â‹ƒ",bigodot:"â¨€",bigoplus:"â¨",bigotimes:"â¨‚",bigsqcup:"â¨†",bigstar:"â˜…",bigtriangledown:"â–½",bigtriangleup:"â–³",biguplus:"â¨„",bigvee:"â‹",bigwedge:"â‹€",bkarow:"â¤",blacklozenge:"â§«",blacksquare:"â–ª",blacktriangle:"â–´",blacktriangledown:"â–¾",blacktriangleleft:"â—‚",blacktriangleright:"â–¸",blank:"â£",blk12:"â–’",blk14:"â–‘",blk34:"â–“",block:"â–ˆ",bne:"=âƒ¥",bnequiv:"â‰¡âƒ¥",bNot:"â«­",bnot:"âŒ",Bopf:"ð”¹",bopf:"ð•“",bot:"âŠ¥",bottom:"âŠ¥",bowtie:"â‹ˆ",boxbox:"â§‰",boxDL:"â•—",boxDl:"â•–",boxdL:"â••",boxdl:"â”",boxDR:"â•”",boxDr:"â•“",boxdR:"â•’",boxdr:"â”Œ",boxH:"â•",boxh:"â”€",boxHD:"â•¦",boxHd:"â•¤",boxhD:"â•¥",boxhd:"â”¬",boxHU:"â•©",boxHu:"â•§",boxhU:"â•¨",boxhu:"â”´",boxminus:"âŠŸ",boxplus:"âŠž",boxtimes:"âŠ ",boxUL:"â•",boxUl:"â•œ",boxuL:"â•›",boxul:"â”˜",boxUR:"â•š",boxUr:"â•™",boxuR:"â•˜",boxur:"â””",boxV:"â•‘",boxv:"â”‚",boxVH:"â•¬",boxVh:"â•«",boxvH:"â•ª",boxvh:"â”¼",boxVL:"â•£",boxVl:"â•¢",boxvL:"â•¡",boxvl:"â”¤",boxVR:"â• ",boxVr:"â•Ÿ",boxvR:"â•ž",boxvr:"â”œ",bprime:"â€µ",Breve:"Ë˜",breve:"Ë˜",brvbar:"Â¦",Bscr:"â„¬",bscr:"ð’·",bsemi:"â",bsim:"âˆ½",bsime:"â‹",bsol:"\\",bsolb:"â§…",bsolhsub:"âŸˆ",bull:"â€¢",bullet:"â€¢",bump:"â‰Ž",bumpE:"âª®",bumpe:"â‰",Bumpeq:"â‰Ž",bumpeq:"â‰",Cacute:"Ä†",cacute:"Ä‡",Cap:"â‹’",cap:"âˆ©",capand:"â©„",capbrcup:"â©‰",capcap:"â©‹",capcup:"â©‡",capdot:"â©€",CapitalDifferentialD:"â……",caps:"âˆ©ï¸€",caret:"â",caron:"Ë‡",Cayleys:"â„­",ccaps:"â©",Ccaron:"ÄŒ",ccaron:"Ä",Ccedil:"Ã‡",ccedil:"Ã§",Ccirc:"Äˆ",ccirc:"Ä‰",Cconint:"âˆ°",ccups:"â©Œ",ccupssm:"â©",Cdot:"ÄŠ",cdot:"Ä‹",cedil:"Â¸",Cedilla:"Â¸",cemptyv:"â¦²",cent:"Â¢",CenterDot:"Â·",centerdot:"Â·",Cfr:"â„­",cfr:"ð” ",CHcy:"Ð§",chcy:"Ñ‡",check:"âœ“",checkmark:"âœ“",Chi:"Î§",chi:"Ï‡",cir:"â—‹",circ:"Ë†",circeq:"â‰—",circlearrowleft:"â†º",circlearrowright:"â†»",circledast:"âŠ›",circledcirc:"âŠš",circleddash:"âŠ",CircleDot:"âŠ™",circledR:"Â®",circledS:"â“ˆ",CircleMinus:"âŠ–",CirclePlus:"âŠ•",CircleTimes:"âŠ—",cirE:"â§ƒ",cire:"â‰—",cirfnint:"â¨",cirmid:"â«¯",cirscir:"â§‚",ClockwiseContourIntegral:"âˆ²",CloseCurlyDoubleQuote:"â€",CloseCurlyQuote:"â€™",clubs:"â™£",clubsuit:"â™£",Colon:"âˆ·",colon:":",Colone:"â©´",colone:"â‰”",coloneq:"â‰”",comma:",",commat:"@",comp:"âˆ",compfn:"âˆ˜",complement:"âˆ",complexes:"â„‚",cong:"â‰…",congdot:"â©­",Congruent:"â‰¡",Conint:"âˆ¯",conint:"âˆ®",ContourIntegral:"âˆ®",Copf:"â„‚",copf:"ð•”",coprod:"âˆ",Coproduct:"âˆ",COPY:"Â©",copy:"Â©",copysr:"â„—",CounterClockwiseContourIntegral:"âˆ³",crarr:"â†µ",Cross:"â¨¯",cross:"âœ—",Cscr:"ð’ž",cscr:"ð’¸",csub:"â«",csube:"â«‘",csup:"â«",csupe:"â«’",ctdot:"â‹¯",cudarrl:"â¤¸",cudarrr:"â¤µ",cuepr:"â‹ž",cuesc:"â‹Ÿ",cularr:"â†¶",cularrp:"â¤½",Cup:"â‹“",cup:"âˆª",cupbrcap:"â©ˆ",CupCap:"â‰",cupcap:"â©†",cupcup:"â©Š",cupdot:"âŠ",cupor:"â©…",cups:"âˆªï¸€",curarr:"â†·",curarrm:"â¤¼",curlyeqprec:"â‹ž",curlyeqsucc:"â‹Ÿ",curlyvee:"â‹Ž",curlywedge:"â‹",curren:"Â¤",curvearrowleft:"â†¶",curvearrowright:"â†·",cuvee:"â‹Ž",cuwed:"â‹",cwconint:"âˆ²",cwint:"âˆ±",cylcty:"âŒ­",Dagger:"â€¡",dagger:"â€ ",daleth:"â„¸",Darr:"â†¡",dArr:"â‡“",darr:"â†“",dash:"â€",Dashv:"â«¤",dashv:"âŠ£",dbkarow:"â¤",dblac:"Ë",Dcaron:"ÄŽ",dcaron:"Ä",Dcy:"Ð”",dcy:"Ð´",DD:"â……",dd:"â…†",ddagger:"â€¡",ddarr:"â‡Š",DDotrahd:"â¤‘",ddotseq:"â©·",deg:"Â°",Del:"âˆ‡",Delta:"Î”",delta:"Î´",demptyv:"â¦±",dfisht:"â¥¿",Dfr:"ð”‡",dfr:"ð”¡",dHar:"â¥¥",dharl:"â‡ƒ",dharr:"â‡‚",DiacriticalAcute:"Â´",DiacriticalDot:"Ë™",DiacriticalDoubleAcute:"Ë",DiacriticalGrave:"`",DiacriticalTilde:"Ëœ",diam:"â‹„",Diamond:"â‹„",diamond:"â‹„",diamondsuit:"â™¦",diams:"â™¦",die:"Â¨",DifferentialD:"â…†",digamma:"Ï",disin:"â‹²",div:"Ã·",divide:"Ã·",divideontimes:"â‹‡",divonx:"â‹‡",DJcy:"Ð‚",djcy:"Ñ’",dlcorn:"âŒž",dlcrop:"âŒ",dollar:"$",Dopf:"ð”»",dopf:"ð••",Dot:"Â¨",dot:"Ë™",DotDot:"âƒœ",doteq:"â‰",doteqdot:"â‰‘",DotEqual:"â‰",dotminus:"âˆ¸",dotplus:"âˆ”",dotsquare:"âŠ¡",doublebarwedge:"âŒ†",DoubleContourIntegral:"âˆ¯",DoubleDot:"Â¨",DoubleDownArrow:"â‡“",DoubleLeftArrow:"â‡",DoubleLeftRightArrow:"â‡”",DoubleLeftTee:"â«¤",DoubleLongLeftArrow:"âŸ¸",DoubleLongLeftRightArrow:"âŸº",DoubleLongRightArrow:"âŸ¹",DoubleRightArrow:"â‡’",DoubleRightTee:"âŠ¨",DoubleUpArrow:"â‡‘",DoubleUpDownArrow:"â‡•",DoubleVerticalBar:"âˆ¥",DownArrow:"â†“",Downarrow:"â‡“",downarrow:"â†“",DownArrowBar:"â¤“",DownArrowUpArrow:"â‡µ",DownBreve:"Ì‘",downdownarrows:"â‡Š",downharpoonleft:"â‡ƒ",downharpoonright:"â‡‚",DownLeftRightVector:"â¥",DownLeftTeeVector:"â¥ž",DownLeftVector:"â†½",DownLeftVectorBar:"â¥–",DownRightTeeVector:"â¥Ÿ",DownRightVector:"â‡",DownRightVectorBar:"â¥—",DownTee:"âŠ¤",DownTeeArrow:"â†§",drbkarow:"â¤",drcorn:"âŒŸ",drcrop:"âŒŒ",Dscr:"ð’Ÿ",dscr:"ð’¹",DScy:"Ð…",dscy:"Ñ•",dsol:"â§¶",Dstrok:"Ä",dstrok:"Ä‘",dtdot:"â‹±",dtri:"â–¿",dtrif:"â–¾",duarr:"â‡µ",duhar:"â¥¯",dwangle:"â¦¦",DZcy:"Ð",dzcy:"ÑŸ",dzigrarr:"âŸ¿",Eacute:"Ã‰",eacute:"Ã©",easter:"â©®",Ecaron:"Äš",ecaron:"Ä›",ecir:"â‰–",Ecirc:"ÃŠ",ecirc:"Ãª",ecolon:"â‰•",Ecy:"Ð­",ecy:"Ñ",eDDot:"â©·",Edot:"Ä–",eDot:"â‰‘",edot:"Ä—",ee:"â…‡",efDot:"â‰’",Efr:"ð”ˆ",efr:"ð”¢",eg:"âªš",Egrave:"Ãˆ",egrave:"Ã¨",egs:"âª–",egsdot:"âª˜",el:"âª™",Element:"âˆˆ",elinters:"â§",ell:"â„“",els:"âª•",elsdot:"âª—",Emacr:"Ä’",emacr:"Ä“",empty:"âˆ…",emptyset:"âˆ…",EmptySmallSquare:"â—»",emptyv:"âˆ…",EmptyVerySmallSquare:"â–«",emsp:"â€ƒ",emsp13:"â€„",emsp14:"â€…",ENG:"ÅŠ",eng:"Å‹",ensp:"â€‚",Eogon:"Ä˜",eogon:"Ä™",Eopf:"ð”¼",eopf:"ð•–",epar:"â‹•",eparsl:"â§£",eplus:"â©±",epsi:"Îµ",Epsilon:"Î•",epsilon:"Îµ",epsiv:"Ïµ",eqcirc:"â‰–",eqcolon:"â‰•",eqsim:"â‰‚",eqslantgtr:"âª–",eqslantless:"âª•",Equal:"â©µ",equals:"=",EqualTilde:"â‰‚",equest:"â‰Ÿ",Equilibrium:"â‡Œ",equiv:"â‰¡",equivDD:"â©¸",eqvparsl:"â§¥",erarr:"â¥±",erDot:"â‰“",Escr:"â„°",escr:"â„¯",esdot:"â‰",Esim:"â©³",esim:"â‰‚",Eta:"Î—",eta:"Î·",ETH:"Ã",eth:"Ã°",Euml:"Ã‹",euml:"Ã«",euro:"â‚¬",excl:"!",exist:"âˆƒ",Exists:"âˆƒ",expectation:"â„°",ExponentialE:"â…‡",exponentiale:"â…‡",fallingdotseq:"â‰’",Fcy:"Ð¤",fcy:"Ñ„",female:"â™€",ffilig:"ï¬ƒ",fflig:"ï¬€",ffllig:"ï¬„",Ffr:"ð”‰",ffr:"ð”£",filig:"ï¬",FilledSmallSquare:"â—¼",FilledVerySmallSquare:"â–ª",fjlig:"fj",flat:"â™­",fllig:"ï¬‚",fltns:"â–±",fnof:"Æ’",Fopf:"ð”½",fopf:"ð•—",ForAll:"âˆ€",forall:"âˆ€",fork:"â‹”",forkv:"â«™",Fouriertrf:"â„±",fpartint:"â¨",frac12:"Â½",frac13:"â…“",frac14:"Â¼",frac15:"â…•",frac16:"â…™",frac18:"â…›",frac23:"â…”",frac25:"â…–",frac34:"Â¾",frac35:"â…—",frac38:"â…œ",frac45:"â…˜",frac56:"â…š",frac58:"â…",frac78:"â…ž",frasl:"â„",frown:"âŒ¢",Fscr:"â„±",fscr:"ð’»",gacute:"Çµ",Gamma:"Î“",gamma:"Î³",Gammad:"Ïœ",gammad:"Ï",gap:"âª†",Gbreve:"Äž",gbreve:"ÄŸ",Gcedil:"Ä¢",Gcirc:"Äœ",gcirc:"Ä",Gcy:"Ð“",gcy:"Ð³",Gdot:"Ä ",gdot:"Ä¡",gE:"â‰§",ge:"â‰¥",gEl:"âªŒ",gel:"â‹›",geq:"â‰¥",geqq:"â‰§",geqslant:"â©¾",ges:"â©¾",gescc:"âª©",gesdot:"âª€",gesdoto:"âª‚",gesdotol:"âª„",gesl:"â‹›ï¸€",gesles:"âª”",Gfr:"ð”Š",gfr:"ð”¤",Gg:"â‹™",gg:"â‰«",ggg:"â‹™",gimel:"â„·",GJcy:"Ðƒ",gjcy:"Ñ“",gl:"â‰·",gla:"âª¥",glE:"âª’",glj:"âª¤",gnap:"âªŠ",gnapprox:"âªŠ",gnE:"â‰©",gne:"âªˆ",gneq:"âªˆ",gneqq:"â‰©",gnsim:"â‹§",Gopf:"ð”¾",gopf:"ð•˜",grave:"`",GreaterEqual:"â‰¥",GreaterEqualLess:"â‹›",GreaterFullEqual:"â‰§",GreaterGreater:"âª¢",GreaterLess:"â‰·",GreaterSlantEqual:"â©¾",GreaterTilde:"â‰³",Gscr:"ð’¢",gscr:"â„Š",gsim:"â‰³",gsime:"âªŽ",gsiml:"âª",Gt:"â‰«",GT:">",gt:">",gtcc:"âª§",gtcir:"â©º",gtdot:"â‹—",gtlPar:"â¦•",gtquest:"â©¼",gtrapprox:"âª†",gtrarr:"â¥¸",gtrdot:"â‹—",gtreqless:"â‹›",gtreqqless:"âªŒ",gtrless:"â‰·",gtrsim:"â‰³",gvertneqq:"â‰©ï¸€",gvnE:"â‰©ï¸€",Hacek:"Ë‡",hairsp:"â€Š",half:"Â½",hamilt:"â„‹",HARDcy:"Ðª",hardcy:"ÑŠ",hArr:"â‡”",harr:"â†”",harrcir:"â¥ˆ",harrw:"â†­",Hat:"^",hbar:"â„",Hcirc:"Ä¤",hcirc:"Ä¥",hearts:"â™¥",heartsuit:"â™¥",hellip:"â€¦",hercon:"âŠ¹",Hfr:"â„Œ",hfr:"ð”¥",HilbertSpace:"â„‹",hksearow:"â¤¥",hkswarow:"â¤¦",hoarr:"â‡¿",homtht:"âˆ»",hookleftarrow:"â†©",hookrightarrow:"â†ª",Hopf:"â„",hopf:"ð•™",horbar:"â€•",HorizontalLine:"â”€",Hscr:"â„‹",hscr:"ð’½",hslash:"â„",Hstrok:"Ä¦",hstrok:"Ä§",HumpDownHump:"â‰Ž",HumpEqual:"â‰",hybull:"âƒ",hyphen:"â€",Iacute:"Ã",iacute:"Ã­",ic:"â£",Icirc:"ÃŽ",icirc:"Ã®",Icy:"Ð˜",icy:"Ð¸",Idot:"Ä°",IEcy:"Ð•",iecy:"Ðµ",iexcl:"Â¡",iff:"â‡”",Ifr:"â„‘",ifr:"ð”¦",Igrave:"ÃŒ",igrave:"Ã¬",ii:"â…ˆ",iiiint:"â¨Œ",iiint:"âˆ­",iinfin:"â§œ",iiota:"â„©",IJlig:"Ä²",ijlig:"Ä³",Im:"â„‘",Imacr:"Äª",imacr:"Ä«",image:"â„‘",ImaginaryI:"â…ˆ",imagline:"â„",imagpart:"â„‘",imath:"Ä±",imof:"âŠ·",imped:"Æµ",Implies:"â‡’",in:"âˆˆ",incare:"â„…",infin:"âˆž",infintie:"â§",inodot:"Ä±",Int:"âˆ¬",int:"âˆ«",intcal:"âŠº",integers:"â„¤",Integral:"âˆ«",intercal:"âŠº",Intersection:"â‹‚",intlarhk:"â¨—",intprod:"â¨¼",InvisibleComma:"â£",InvisibleTimes:"â¢",IOcy:"Ð",iocy:"Ñ‘",Iogon:"Ä®",iogon:"Ä¯",Iopf:"ð•€",iopf:"ð•š",Iota:"Î™",iota:"Î¹",iprod:"â¨¼",iquest:"Â¿",Iscr:"â„",iscr:"ð’¾",isin:"âˆˆ",isindot:"â‹µ",isinE:"â‹¹",isins:"â‹´",isinsv:"â‹³",isinv:"âˆˆ",it:"â¢",Itilde:"Ä¨",itilde:"Ä©",Iukcy:"Ð†",iukcy:"Ñ–",Iuml:"Ã",iuml:"Ã¯",Jcirc:"Ä´",jcirc:"Äµ",Jcy:"Ð™",jcy:"Ð¹",Jfr:"ð”",jfr:"ð”§",jmath:"È·",Jopf:"ð•",jopf:"ð•›",Jscr:"ð’¥",jscr:"ð’¿",Jsercy:"Ðˆ",jsercy:"Ñ˜",Jukcy:"Ð„",jukcy:"Ñ”",Kappa:"Îš",kappa:"Îº",kappav:"Ï°",Kcedil:"Ä¶",kcedil:"Ä·",Kcy:"Ðš",kcy:"Ðº",Kfr:"ð”Ž",kfr:"ð”¨",kgreen:"Ä¸",KHcy:"Ð¥",khcy:"Ñ…",KJcy:"ÐŒ",kjcy:"Ñœ",Kopf:"ð•‚",kopf:"ð•œ",Kscr:"ð’¦",kscr:"ð“€",lAarr:"â‡š",Lacute:"Ä¹",lacute:"Äº",laemptyv:"â¦´",lagran:"â„’",Lambda:"Î›",lambda:"Î»",Lang:"âŸª",lang:"âŸ¨",langd:"â¦‘",langle:"âŸ¨",lap:"âª…",Laplacetrf:"â„’",laquo:"Â«",Larr:"â†ž",lArr:"â‡",larr:"â†",larrb:"â‡¤",larrbfs:"â¤Ÿ",larrfs:"â¤",larrhk:"â†©",larrlp:"â†«",larrpl:"â¤¹",larrsim:"â¥³",larrtl:"â†¢",lat:"âª«",lAtail:"â¤›",latail:"â¤™",late:"âª­",lates:"âª­ï¸€",lBarr:"â¤Ž",lbarr:"â¤Œ",lbbrk:"â²",lbrace:"{",lbrack:"[",lbrke:"â¦‹",lbrksld:"â¦",lbrkslu:"â¦",Lcaron:"Ä½",lcaron:"Ä¾",Lcedil:"Ä»",lcedil:"Ä¼",lceil:"âŒˆ",lcub:"{",Lcy:"Ð›",lcy:"Ð»",ldca:"â¤¶",ldquo:"â€œ",ldquor:"â€ž",ldrdhar:"â¥§",ldrushar:"â¥‹",ldsh:"â†²",lE:"â‰¦",le:"â‰¤",LeftAngleBracket:"âŸ¨",LeftArrow:"â†",Leftarrow:"â‡",leftarrow:"â†",LeftArrowBar:"â‡¤",LeftArrowRightArrow:"â‡†",leftarrowtail:"â†¢",LeftCeiling:"âŒˆ",LeftDoubleBracket:"âŸ¦",LeftDownTeeVector:"â¥¡",LeftDownVector:"â‡ƒ",LeftDownVectorBar:"â¥™",LeftFloor:"âŒŠ",leftharpoondown:"â†½",leftharpoonup:"â†¼",leftleftarrows:"â‡‡",LeftRightArrow:"â†”",Leftrightarrow:"â‡”",leftrightarrow:"â†”",leftrightarrows:"â‡†",leftrightharpoons:"â‡‹",leftrightsquigarrow:"â†­",LeftRightVector:"â¥Ž",LeftTee:"âŠ£",LeftTeeArrow:"â†¤",LeftTeeVector:"â¥š",leftthreetimes:"â‹‹",LeftTriangle:"âŠ²",LeftTriangleBar:"â§",LeftTriangleEqual:"âŠ´",LeftUpDownVector:"â¥‘",LeftUpTeeVector:"â¥ ",LeftUpVector:"â†¿",LeftUpVectorBar:"â¥˜",LeftVector:"â†¼",LeftVectorBar:"â¥’",lEg:"âª‹",leg:"â‹š",leq:"â‰¤",leqq:"â‰¦",leqslant:"â©½",les:"â©½",lescc:"âª¨",lesdot:"â©¿",lesdoto:"âª",lesdotor:"âªƒ",lesg:"â‹šï¸€",lesges:"âª“",lessapprox:"âª…",lessdot:"â‹–",lesseqgtr:"â‹š",lesseqqgtr:"âª‹",LessEqualGreater:"â‹š",LessFullEqual:"â‰¦",LessGreater:"â‰¶",lessgtr:"â‰¶",LessLess:"âª¡",lesssim:"â‰²",LessSlantEqual:"â©½",LessTilde:"â‰²",lfisht:"â¥¼",lfloor:"âŒŠ",Lfr:"ð”",lfr:"ð”©",lg:"â‰¶",lgE:"âª‘",lHar:"â¥¢",lhard:"â†½",lharu:"â†¼",lharul:"â¥ª",lhblk:"â–„",LJcy:"Ð‰",ljcy:"Ñ™",Ll:"â‹˜",ll:"â‰ª",llarr:"â‡‡",llcorner:"âŒž",Lleftarrow:"â‡š",llhard:"â¥«",lltri:"â—º",Lmidot:"Ä¿",lmidot:"Å€",lmoust:"âŽ°",lmoustache:"âŽ°",lnap:"âª‰",lnapprox:"âª‰",lnE:"â‰¨",lne:"âª‡",lneq:"âª‡",lneqq:"â‰¨",lnsim:"â‹¦",loang:"âŸ¬",loarr:"â‡½",lobrk:"âŸ¦",LongLeftArrow:"âŸµ",Longleftarrow:"âŸ¸",longleftarrow:"âŸµ",LongLeftRightArrow:"âŸ·",Longleftrightarrow:"âŸº",longleftrightarrow:"âŸ·",longmapsto:"âŸ¼",LongRightArrow:"âŸ¶",Longrightarrow:"âŸ¹",longrightarrow:"âŸ¶",looparrowleft:"â†«",looparrowright:"â†¬",lopar:"â¦…",Lopf:"ð•ƒ",lopf:"ð•",loplus:"â¨­",lotimes:"â¨´",lowast:"âˆ—",lowbar:"_",LowerLeftArrow:"â†™",LowerRightArrow:"â†˜",loz:"â—Š",lozenge:"â—Š",lozf:"â§«",lpar:"(",lparlt:"â¦“",lrarr:"â‡†",lrcorner:"âŒŸ",lrhar:"â‡‹",lrhard:"â¥­",lrm:"â€Ž",lrtri:"âŠ¿",lsaquo:"â€¹",Lscr:"â„’",lscr:"ð“",Lsh:"â†°",lsh:"â†°",lsim:"â‰²",lsime:"âª",lsimg:"âª",lsqb:"[",lsquo:"â€˜",lsquor:"â€š",Lstrok:"Å",lstrok:"Å‚",Lt:"â‰ª",LT:"<",lt:"<",ltcc:"âª¦",ltcir:"â©¹",ltdot:"â‹–",lthree:"â‹‹",ltimes:"â‹‰",ltlarr:"â¥¶",ltquest:"â©»",ltri:"â—ƒ",ltrie:"âŠ´",ltrif:"â—‚",ltrPar:"â¦–",lurdshar:"â¥Š",luruhar:"â¥¦",lvertneqq:"â‰¨ï¸€",lvnE:"â‰¨ï¸€",macr:"Â¯",male:"â™‚",malt:"âœ ",maltese:"âœ ",Map:"â¤…",map:"â†¦",mapsto:"â†¦",mapstodown:"â†§",mapstoleft:"â†¤",mapstoup:"â†¥",marker:"â–®",mcomma:"â¨©",Mcy:"Ðœ",mcy:"Ð¼",mdash:"â€”",mDDot:"âˆº",measuredangle:"âˆ¡",MediumSpace:"âŸ",Mellintrf:"â„³",Mfr:"ð”",mfr:"ð”ª",mho:"â„§",micro:"Âµ",mid:"âˆ£",midast:"*",midcir:"â«°",middot:"Â·",minus:"âˆ’",minusb:"âŠŸ",minusd:"âˆ¸",minusdu:"â¨ª",MinusPlus:"âˆ“",mlcp:"â«›",mldr:"â€¦",mnplus:"âˆ“",models:"âŠ§",Mopf:"ð•„",mopf:"ð•ž",mp:"âˆ“",Mscr:"â„³",mscr:"ð“‚",mstpos:"âˆ¾",Mu:"Îœ",mu:"Î¼",multimap:"âŠ¸",mumap:"âŠ¸",nabla:"âˆ‡",Nacute:"Åƒ",nacute:"Å„",nang:"âˆ âƒ’",nap:"â‰‰",napE:"â©°Ì¸",napid:"â‰‹Ì¸",napos:"Å‰",napprox:"â‰‰",natur:"â™®",natural:"â™®",naturals:"â„•",nbsp:"Â ",nbump:"â‰ŽÌ¸",nbumpe:"â‰Ì¸",ncap:"â©ƒ",Ncaron:"Å‡",ncaron:"Åˆ",Ncedil:"Å…",ncedil:"Å†",ncong:"â‰‡",ncongdot:"â©­Ì¸",ncup:"â©‚",Ncy:"Ð",ncy:"Ð½",ndash:"â€“",ne:"â‰ ",nearhk:"â¤¤",neArr:"â‡—",nearr:"â†—",nearrow:"â†—",nedot:"â‰Ì¸",NegativeMediumSpace:"â€‹",NegativeThickSpace:"â€‹",NegativeThinSpace:"â€‹",NegativeVeryThinSpace:"â€‹",nequiv:"â‰¢",nesear:"â¤¨",nesim:"â‰‚Ì¸",NestedGreaterGreater:"â‰«",NestedLessLess:"â‰ª",NewLine:`
`,nexist:"âˆ„",nexists:"âˆ„",Nfr:"ð”‘",nfr:"ð”«",ngE:"â‰§Ì¸",nge:"â‰±",ngeq:"â‰±",ngeqq:"â‰§Ì¸",ngeqslant:"â©¾Ì¸",nges:"â©¾Ì¸",nGg:"â‹™Ì¸",ngsim:"â‰µ",nGt:"â‰«âƒ’",ngt:"â‰¯",ngtr:"â‰¯",nGtv:"â‰«Ì¸",nhArr:"â‡Ž",nharr:"â†®",nhpar:"â«²",ni:"âˆ‹",nis:"â‹¼",nisd:"â‹º",niv:"âˆ‹",NJcy:"ÐŠ",njcy:"Ñš",nlArr:"â‡",nlarr:"â†š",nldr:"â€¥",nlE:"â‰¦Ì¸",nle:"â‰°",nLeftarrow:"â‡",nleftarrow:"â†š",nLeftrightarrow:"â‡Ž",nleftrightarrow:"â†®",nleq:"â‰°",nleqq:"â‰¦Ì¸",nleqslant:"â©½Ì¸",nles:"â©½Ì¸",nless:"â‰®",nLl:"â‹˜Ì¸",nlsim:"â‰´",nLt:"â‰ªâƒ’",nlt:"â‰®",nltri:"â‹ª",nltrie:"â‹¬",nLtv:"â‰ªÌ¸",nmid:"âˆ¤",NoBreak:"â ",NonBreakingSpace:"Â ",Nopf:"â„•",nopf:"ð•Ÿ",Not:"â«¬",not:"Â¬",NotCongruent:"â‰¢",NotCupCap:"â‰­",NotDoubleVerticalBar:"âˆ¦",NotElement:"âˆ‰",NotEqual:"â‰ ",NotEqualTilde:"â‰‚Ì¸",NotExists:"âˆ„",NotGreater:"â‰¯",NotGreaterEqual:"â‰±",NotGreaterFullEqual:"â‰§Ì¸",NotGreaterGreater:"â‰«Ì¸",NotGreaterLess:"â‰¹",NotGreaterSlantEqual:"â©¾Ì¸",NotGreaterTilde:"â‰µ",NotHumpDownHump:"â‰ŽÌ¸",NotHumpEqual:"â‰Ì¸",notin:"âˆ‰",notindot:"â‹µÌ¸",notinE:"â‹¹Ì¸",notinva:"âˆ‰",notinvb:"â‹·",notinvc:"â‹¶",NotLeftTriangle:"â‹ª",NotLeftTriangleBar:"â§Ì¸",NotLeftTriangleEqual:"â‹¬",NotLess:"â‰®",NotLessEqual:"â‰°",NotLessGreater:"â‰¸",NotLessLess:"â‰ªÌ¸",NotLessSlantEqual:"â©½Ì¸",NotLessTilde:"â‰´",NotNestedGreaterGreater:"âª¢Ì¸",NotNestedLessLess:"âª¡Ì¸",notni:"âˆŒ",notniva:"âˆŒ",notnivb:"â‹¾",notnivc:"â‹½",NotPrecedes:"âŠ€",NotPrecedesEqual:"âª¯Ì¸",NotPrecedesSlantEqual:"â‹ ",NotReverseElement:"âˆŒ",NotRightTriangle:"â‹«",NotRightTriangleBar:"â§Ì¸",NotRightTriangleEqual:"â‹­",NotSquareSubset:"âŠÌ¸",NotSquareSubsetEqual:"â‹¢",NotSquareSuperset:"âŠÌ¸",NotSquareSupersetEqual:"â‹£",NotSubset:"âŠ‚âƒ’",NotSubsetEqual:"âŠˆ",NotSucceeds:"âŠ",NotSucceedsEqual:"âª°Ì¸",NotSucceedsSlantEqual:"â‹¡",NotSucceedsTilde:"â‰¿Ì¸",NotSuperset:"âŠƒâƒ’",NotSupersetEqual:"âŠ‰",NotTilde:"â‰",NotTildeEqual:"â‰„",NotTildeFullEqual:"â‰‡",NotTildeTilde:"â‰‰",NotVerticalBar:"âˆ¤",npar:"âˆ¦",nparallel:"âˆ¦",nparsl:"â«½âƒ¥",npart:"âˆ‚Ì¸",npolint:"â¨”",npr:"âŠ€",nprcue:"â‹ ",npre:"âª¯Ì¸",nprec:"âŠ€",npreceq:"âª¯Ì¸",nrArr:"â‡",nrarr:"â†›",nrarrc:"â¤³Ì¸",nrarrw:"â†Ì¸",nRightarrow:"â‡",nrightarrow:"â†›",nrtri:"â‹«",nrtrie:"â‹­",nsc:"âŠ",nsccue:"â‹¡",nsce:"âª°Ì¸",Nscr:"ð’©",nscr:"ð“ƒ",nshortmid:"âˆ¤",nshortparallel:"âˆ¦",nsim:"â‰",nsime:"â‰„",nsimeq:"â‰„",nsmid:"âˆ¤",nspar:"âˆ¦",nsqsube:"â‹¢",nsqsupe:"â‹£",nsub:"âŠ„",nsubE:"â«…Ì¸",nsube:"âŠˆ",nsubset:"âŠ‚âƒ’",nsubseteq:"âŠˆ",nsubseteqq:"â«…Ì¸",nsucc:"âŠ",nsucceq:"âª°Ì¸",nsup:"âŠ…",nsupE:"â«†Ì¸",nsupe:"âŠ‰",nsupset:"âŠƒâƒ’",nsupseteq:"âŠ‰",nsupseteqq:"â«†Ì¸",ntgl:"â‰¹",Ntilde:"Ã‘",ntilde:"Ã±",ntlg:"â‰¸",ntriangleleft:"â‹ª",ntrianglelefteq:"â‹¬",ntriangleright:"â‹«",ntrianglerighteq:"â‹­",Nu:"Î",nu:"Î½",num:"#",numero:"â„–",numsp:"â€‡",nvap:"â‰âƒ’",nVDash:"âŠ¯",nVdash:"âŠ®",nvDash:"âŠ­",nvdash:"âŠ¬",nvge:"â‰¥âƒ’",nvgt:">âƒ’",nvHarr:"â¤„",nvinfin:"â§ž",nvlArr:"â¤‚",nvle:"â‰¤âƒ’",nvlt:"<âƒ’",nvltrie:"âŠ´âƒ’",nvrArr:"â¤ƒ",nvrtrie:"âŠµâƒ’",nvsim:"âˆ¼âƒ’",nwarhk:"â¤£",nwArr:"â‡–",nwarr:"â†–",nwarrow:"â†–",nwnear:"â¤§",Oacute:"Ã“",oacute:"Ã³",oast:"âŠ›",ocir:"âŠš",Ocirc:"Ã”",ocirc:"Ã´",Ocy:"Ðž",ocy:"Ð¾",odash:"âŠ",Odblac:"Å",odblac:"Å‘",odiv:"â¨¸",odot:"âŠ™",odsold:"â¦¼",OElig:"Å’",oelig:"Å“",ofcir:"â¦¿",Ofr:"ð”’",ofr:"ð”¬",ogon:"Ë›",Ograve:"Ã’",ograve:"Ã²",ogt:"â§",ohbar:"â¦µ",ohm:"Î©",oint:"âˆ®",olarr:"â†º",olcir:"â¦¾",olcross:"â¦»",oline:"â€¾",olt:"â§€",Omacr:"ÅŒ",omacr:"Å",Omega:"Î©",omega:"Ï‰",Omicron:"ÎŸ",omicron:"Î¿",omid:"â¦¶",ominus:"âŠ–",Oopf:"ð•†",oopf:"ð• ",opar:"â¦·",OpenCurlyDoubleQuote:"â€œ",OpenCurlyQuote:"â€˜",operp:"â¦¹",oplus:"âŠ•",Or:"â©”",or:"âˆ¨",orarr:"â†»",ord:"â©",order:"â„´",orderof:"â„´",ordf:"Âª",ordm:"Âº",origof:"âŠ¶",oror:"â©–",orslope:"â©—",orv:"â©›",oS:"â“ˆ",Oscr:"ð’ª",oscr:"â„´",Oslash:"Ã˜",oslash:"Ã¸",osol:"âŠ˜",Otilde:"Ã•",otilde:"Ãµ",Otimes:"â¨·",otimes:"âŠ—",otimesas:"â¨¶",Ouml:"Ã–",ouml:"Ã¶",ovbar:"âŒ½",OverBar:"â€¾",OverBrace:"âž",OverBracket:"âŽ´",OverParenthesis:"âœ",par:"âˆ¥",para:"Â¶",parallel:"âˆ¥",parsim:"â«³",parsl:"â«½",part:"âˆ‚",PartialD:"âˆ‚",Pcy:"ÐŸ",pcy:"Ð¿",percnt:"%",period:".",permil:"â€°",perp:"âŠ¥",pertenk:"â€±",Pfr:"ð”“",pfr:"ð”­",Phi:"Î¦",phi:"Ï†",phiv:"Ï•",phmmat:"â„³",phone:"â˜Ž",Pi:"Î ",pi:"Ï€",pitchfork:"â‹”",piv:"Ï–",planck:"â„",planckh:"â„Ž",plankv:"â„",plus:"+",plusacir:"â¨£",plusb:"âŠž",pluscir:"â¨¢",plusdo:"âˆ”",plusdu:"â¨¥",pluse:"â©²",PlusMinus:"Â±",plusmn:"Â±",plussim:"â¨¦",plustwo:"â¨§",pm:"Â±",Poincareplane:"â„Œ",pointint:"â¨•",Popf:"â„™",popf:"ð•¡",pound:"Â£",Pr:"âª»",pr:"â‰º",prap:"âª·",prcue:"â‰¼",prE:"âª³",pre:"âª¯",prec:"â‰º",precapprox:"âª·",preccurlyeq:"â‰¼",Precedes:"â‰º",PrecedesEqual:"âª¯",PrecedesSlantEqual:"â‰¼",PrecedesTilde:"â‰¾",preceq:"âª¯",precnapprox:"âª¹",precneqq:"âªµ",precnsim:"â‹¨",precsim:"â‰¾",Prime:"â€³",prime:"â€²",primes:"â„™",prnap:"âª¹",prnE:"âªµ",prnsim:"â‹¨",prod:"âˆ",Product:"âˆ",profalar:"âŒ®",profline:"âŒ’",profsurf:"âŒ“",prop:"âˆ",Proportion:"âˆ·",Proportional:"âˆ",propto:"âˆ",prsim:"â‰¾",prurel:"âŠ°",Pscr:"ð’«",pscr:"ð“…",Psi:"Î¨",psi:"Ïˆ",puncsp:"â€ˆ",Qfr:"ð””",qfr:"ð”®",qint:"â¨Œ",Qopf:"â„š",qopf:"ð•¢",qprime:"â—",Qscr:"ð’¬",qscr:"ð“†",quaternions:"â„",quatint:"â¨–",quest:"?",questeq:"â‰Ÿ",QUOT:'"',quot:'"',rAarr:"â‡›",race:"âˆ½Ì±",Racute:"Å”",racute:"Å•",radic:"âˆš",raemptyv:"â¦³",Rang:"âŸ«",rang:"âŸ©",rangd:"â¦’",range:"â¦¥",rangle:"âŸ©",raquo:"Â»",Rarr:"â† ",rArr:"â‡’",rarr:"â†’",rarrap:"â¥µ",rarrb:"â‡¥",rarrbfs:"â¤ ",rarrc:"â¤³",rarrfs:"â¤ž",rarrhk:"â†ª",rarrlp:"â†¬",rarrpl:"â¥…",rarrsim:"â¥´",Rarrtl:"â¤–",rarrtl:"â†£",rarrw:"â†",rAtail:"â¤œ",ratail:"â¤š",ratio:"âˆ¶",rationals:"â„š",RBarr:"â¤",rBarr:"â¤",rbarr:"â¤",rbbrk:"â³",rbrace:"}",rbrack:"]",rbrke:"â¦Œ",rbrksld:"â¦Ž",rbrkslu:"â¦",Rcaron:"Å˜",rcaron:"Å™",Rcedil:"Å–",rcedil:"Å—",rceil:"âŒ‰",rcub:"}",Rcy:"Ð ",rcy:"Ñ€",rdca:"â¤·",rdldhar:"â¥©",rdquo:"â€",rdquor:"â€",rdsh:"â†³",Re:"â„œ",real:"â„œ",realine:"â„›",realpart:"â„œ",reals:"â„",rect:"â–­",REG:"Â®",reg:"Â®",ReverseElement:"âˆ‹",ReverseEquilibrium:"â‡‹",ReverseUpEquilibrium:"â¥¯",rfisht:"â¥½",rfloor:"âŒ‹",Rfr:"â„œ",rfr:"ð”¯",rHar:"â¥¤",rhard:"â‡",rharu:"â‡€",rharul:"â¥¬",Rho:"Î¡",rho:"Ï",rhov:"Ï±",RightAngleBracket:"âŸ©",RightArrow:"â†’",Rightarrow:"â‡’",rightarrow:"â†’",RightArrowBar:"â‡¥",RightArrowLeftArrow:"â‡„",rightarrowtail:"â†£",RightCeiling:"âŒ‰",RightDoubleBracket:"âŸ§",RightDownTeeVector:"â¥",RightDownVector:"â‡‚",RightDownVectorBar:"â¥•",RightFloor:"âŒ‹",rightharpoondown:"â‡",rightharpoonup:"â‡€",rightleftarrows:"â‡„",rightleftharpoons:"â‡Œ",rightrightarrows:"â‡‰",rightsquigarrow:"â†",RightTee:"âŠ¢",RightTeeArrow:"â†¦",RightTeeVector:"â¥›",rightthreetimes:"â‹Œ",RightTriangle:"âŠ³",RightTriangleBar:"â§",RightTriangleEqual:"âŠµ",RightUpDownVector:"â¥",RightUpTeeVector:"â¥œ",RightUpVector:"â†¾",RightUpVectorBar:"â¥”",RightVector:"â‡€",RightVectorBar:"â¥“",ring:"Ëš",risingdotseq:"â‰“",rlarr:"â‡„",rlhar:"â‡Œ",rlm:"â€",rmoust:"âŽ±",rmoustache:"âŽ±",rnmid:"â«®",roang:"âŸ­",roarr:"â‡¾",robrk:"âŸ§",ropar:"â¦†",Ropf:"â„",ropf:"ð•£",roplus:"â¨®",rotimes:"â¨µ",RoundImplies:"â¥°",rpar:")",rpargt:"â¦”",rppolint:"â¨’",rrarr:"â‡‰",Rrightarrow:"â‡›",rsaquo:"â€º",Rscr:"â„›",rscr:"ð“‡",Rsh:"â†±",rsh:"â†±",rsqb:"]",rsquo:"â€™",rsquor:"â€™",rthree:"â‹Œ",rtimes:"â‹Š",rtri:"â–¹",rtrie:"âŠµ",rtrif:"â–¸",rtriltri:"â§Ž",RuleDelayed:"â§´",ruluhar:"â¥¨",rx:"â„ž",Sacute:"Åš",sacute:"Å›",sbquo:"â€š",Sc:"âª¼",sc:"â‰»",scap:"âª¸",Scaron:"Å ",scaron:"Å¡",sccue:"â‰½",scE:"âª´",sce:"âª°",Scedil:"Åž",scedil:"ÅŸ",Scirc:"Åœ",scirc:"Å",scnap:"âªº",scnE:"âª¶",scnsim:"â‹©",scpolint:"â¨“",scsim:"â‰¿",Scy:"Ð¡",scy:"Ñ",sdot:"â‹…",sdotb:"âŠ¡",sdote:"â©¦",searhk:"â¤¥",seArr:"â‡˜",searr:"â†˜",searrow:"â†˜",sect:"Â§",semi:";",seswar:"â¤©",setminus:"âˆ–",setmn:"âˆ–",sext:"âœ¶",Sfr:"ð”–",sfr:"ð”°",sfrown:"âŒ¢",sharp:"â™¯",SHCHcy:"Ð©",shchcy:"Ñ‰",SHcy:"Ð¨",shcy:"Ñˆ",ShortDownArrow:"â†“",ShortLeftArrow:"â†",shortmid:"âˆ£",shortparallel:"âˆ¥",ShortRightArrow:"â†’",ShortUpArrow:"â†‘",shy:"Â­",Sigma:"Î£",sigma:"Ïƒ",sigmaf:"Ï‚",sigmav:"Ï‚",sim:"âˆ¼",simdot:"â©ª",sime:"â‰ƒ",simeq:"â‰ƒ",simg:"âªž",simgE:"âª ",siml:"âª",simlE:"âªŸ",simne:"â‰†",simplus:"â¨¤",simrarr:"â¥²",slarr:"â†",SmallCircle:"âˆ˜",smallsetminus:"âˆ–",smashp:"â¨³",smeparsl:"â§¤",smid:"âˆ£",smile:"âŒ£",smt:"âªª",smte:"âª¬",smtes:"âª¬ï¸€",SOFTcy:"Ð¬",softcy:"ÑŒ",sol:"/",solb:"â§„",solbar:"âŒ¿",Sopf:"ð•Š",sopf:"ð•¤",spades:"â™ ",spadesuit:"â™ ",spar:"âˆ¥",sqcap:"âŠ“",sqcaps:"âŠ“ï¸€",sqcup:"âŠ”",sqcups:"âŠ”ï¸€",Sqrt:"âˆš",sqsub:"âŠ",sqsube:"âŠ‘",sqsubset:"âŠ",sqsubseteq:"âŠ‘",sqsup:"âŠ",sqsupe:"âŠ’",sqsupset:"âŠ",sqsupseteq:"âŠ’",squ:"â–¡",Square:"â–¡",square:"â–¡",SquareIntersection:"âŠ“",SquareSubset:"âŠ",SquareSubsetEqual:"âŠ‘",SquareSuperset:"âŠ",SquareSupersetEqual:"âŠ’",SquareUnion:"âŠ”",squarf:"â–ª",squf:"â–ª",srarr:"â†’",Sscr:"ð’®",sscr:"ð“ˆ",ssetmn:"âˆ–",ssmile:"âŒ£",sstarf:"â‹†",Star:"â‹†",star:"â˜†",starf:"â˜…",straightepsilon:"Ïµ",straightphi:"Ï•",strns:"Â¯",Sub:"â‹",sub:"âŠ‚",subdot:"âª½",subE:"â«…",sube:"âŠ†",subedot:"â«ƒ",submult:"â«",subnE:"â«‹",subne:"âŠŠ",subplus:"âª¿",subrarr:"â¥¹",Subset:"â‹",subset:"âŠ‚",subseteq:"âŠ†",subseteqq:"â«…",SubsetEqual:"âŠ†",subsetneq:"âŠŠ",subsetneqq:"â«‹",subsim:"â«‡",subsub:"â«•",subsup:"â«“",succ:"â‰»",succapprox:"âª¸",succcurlyeq:"â‰½",Succeeds:"â‰»",SucceedsEqual:"âª°",SucceedsSlantEqual:"â‰½",SucceedsTilde:"â‰¿",succeq:"âª°",succnapprox:"âªº",succneqq:"âª¶",succnsim:"â‹©",succsim:"â‰¿",SuchThat:"âˆ‹",Sum:"âˆ‘",sum:"âˆ‘",sung:"â™ª",Sup:"â‹‘",sup:"âŠƒ",sup1:"Â¹",sup2:"Â²",sup3:"Â³",supdot:"âª¾",supdsub:"â«˜",supE:"â«†",supe:"âŠ‡",supedot:"â«„",Superset:"âŠƒ",SupersetEqual:"âŠ‡",suphsol:"âŸ‰",suphsub:"â«—",suplarr:"â¥»",supmult:"â«‚",supnE:"â«Œ",supne:"âŠ‹",supplus:"â«€",Supset:"â‹‘",supset:"âŠƒ",supseteq:"âŠ‡",supseteqq:"â«†",supsetneq:"âŠ‹",supsetneqq:"â«Œ",supsim:"â«ˆ",supsub:"â«”",supsup:"â«–",swarhk:"â¤¦",swArr:"â‡™",swarr:"â†™",swarrow:"â†™",swnwar:"â¤ª",szlig:"ÃŸ",Tab:"	",target:"âŒ–",Tau:"Î¤",tau:"Ï„",tbrk:"âŽ´",Tcaron:"Å¤",tcaron:"Å¥",Tcedil:"Å¢",tcedil:"Å£",Tcy:"Ð¢",tcy:"Ñ‚",tdot:"âƒ›",telrec:"âŒ•",Tfr:"ð”—",tfr:"ð”±",there4:"âˆ´",Therefore:"âˆ´",therefore:"âˆ´",Theta:"Î˜",theta:"Î¸",thetasym:"Ï‘",thetav:"Ï‘",thickapprox:"â‰ˆ",thicksim:"âˆ¼",ThickSpace:"âŸâ€Š",thinsp:"â€‰",ThinSpace:"â€‰",thkap:"â‰ˆ",thksim:"âˆ¼",THORN:"Ãž",thorn:"Ã¾",Tilde:"âˆ¼",tilde:"Ëœ",TildeEqual:"â‰ƒ",TildeFullEqual:"â‰…",TildeTilde:"â‰ˆ",times:"Ã—",timesb:"âŠ ",timesbar:"â¨±",timesd:"â¨°",tint:"âˆ­",toea:"â¤¨",top:"âŠ¤",topbot:"âŒ¶",topcir:"â«±",Topf:"ð•‹",topf:"ð•¥",topfork:"â«š",tosa:"â¤©",tprime:"â€´",TRADE:"â„¢",trade:"â„¢",triangle:"â–µ",triangledown:"â–¿",triangleleft:"â—ƒ",trianglelefteq:"âŠ´",triangleq:"â‰œ",triangleright:"â–¹",trianglerighteq:"âŠµ",tridot:"â—¬",trie:"â‰œ",triminus:"â¨º",TripleDot:"âƒ›",triplus:"â¨¹",trisb:"â§",tritime:"â¨»",trpezium:"â¢",Tscr:"ð’¯",tscr:"ð“‰",TScy:"Ð¦",tscy:"Ñ†",TSHcy:"Ð‹",tshcy:"Ñ›",Tstrok:"Å¦",tstrok:"Å§",twixt:"â‰¬",twoheadleftarrow:"â†ž",twoheadrightarrow:"â† ",Uacute:"Ãš",uacute:"Ãº",Uarr:"â†Ÿ",uArr:"â‡‘",uarr:"â†‘",Uarrocir:"â¥‰",Ubrcy:"ÐŽ",ubrcy:"Ñž",Ubreve:"Å¬",ubreve:"Å­",Ucirc:"Ã›",ucirc:"Ã»",Ucy:"Ð£",ucy:"Ñƒ",udarr:"â‡…",Udblac:"Å°",udblac:"Å±",udhar:"â¥®",ufisht:"â¥¾",Ufr:"ð”˜",ufr:"ð”²",Ugrave:"Ã™",ugrave:"Ã¹",uHar:"â¥£",uharl:"â†¿",uharr:"â†¾",uhblk:"â–€",ulcorn:"âŒœ",ulcorner:"âŒœ",ulcrop:"âŒ",ultri:"â—¸",Umacr:"Åª",umacr:"Å«",uml:"Â¨",UnderBar:"_",UnderBrace:"âŸ",UnderBracket:"âŽµ",UnderParenthesis:"â",Union:"â‹ƒ",UnionPlus:"âŠŽ",Uogon:"Å²",uogon:"Å³",Uopf:"ð•Œ",uopf:"ð•¦",UpArrow:"â†‘",Uparrow:"â‡‘",uparrow:"â†‘",UpArrowBar:"â¤’",UpArrowDownArrow:"â‡…",UpDownArrow:"â†•",Updownarrow:"â‡•",updownarrow:"â†•",UpEquilibrium:"â¥®",upharpoonleft:"â†¿",upharpoonright:"â†¾",uplus:"âŠŽ",UpperLeftArrow:"â†–",UpperRightArrow:"â†—",Upsi:"Ï’",upsi:"Ï…",upsih:"Ï’",Upsilon:"Î¥",upsilon:"Ï…",UpTee:"âŠ¥",UpTeeArrow:"â†¥",upuparrows:"â‡ˆ",urcorn:"âŒ",urcorner:"âŒ",urcrop:"âŒŽ",Uring:"Å®",uring:"Å¯",urtri:"â—¹",Uscr:"ð’°",uscr:"ð“Š",utdot:"â‹°",Utilde:"Å¨",utilde:"Å©",utri:"â–µ",utrif:"â–´",uuarr:"â‡ˆ",Uuml:"Ãœ",uuml:"Ã¼",uwangle:"â¦§",vangrt:"â¦œ",varepsilon:"Ïµ",varkappa:"Ï°",varnothing:"âˆ…",varphi:"Ï•",varpi:"Ï–",varpropto:"âˆ",vArr:"â‡•",varr:"â†•",varrho:"Ï±",varsigma:"Ï‚",varsubsetneq:"âŠŠï¸€",varsubsetneqq:"â«‹ï¸€",varsupsetneq:"âŠ‹ï¸€",varsupsetneqq:"â«Œï¸€",vartheta:"Ï‘",vartriangleleft:"âŠ²",vartriangleright:"âŠ³",Vbar:"â««",vBar:"â«¨",vBarv:"â«©",Vcy:"Ð’",vcy:"Ð²",VDash:"âŠ«",Vdash:"âŠ©",vDash:"âŠ¨",vdash:"âŠ¢",Vdashl:"â«¦",Vee:"â‹",vee:"âˆ¨",veebar:"âŠ»",veeeq:"â‰š",vellip:"â‹®",Verbar:"â€–",verbar:"|",Vert:"â€–",vert:"|",VerticalBar:"âˆ£",VerticalLine:"|",VerticalSeparator:"â˜",VerticalTilde:"â‰€",VeryThinSpace:"â€Š",Vfr:"ð”™",vfr:"ð”³",vltri:"âŠ²",vnsub:"âŠ‚âƒ’",vnsup:"âŠƒâƒ’",Vopf:"ð•",vopf:"ð•§",vprop:"âˆ",vrtri:"âŠ³",Vscr:"ð’±",vscr:"ð“‹",vsubnE:"â«‹ï¸€",vsubne:"âŠŠï¸€",vsupnE:"â«Œï¸€",vsupne:"âŠ‹ï¸€",Vvdash:"âŠª",vzigzag:"â¦š",Wcirc:"Å´",wcirc:"Åµ",wedbar:"â©Ÿ",Wedge:"â‹€",wedge:"âˆ§",wedgeq:"â‰™",weierp:"â„˜",Wfr:"ð”š",wfr:"ð”´",Wopf:"ð•Ž",wopf:"ð•¨",wp:"â„˜",wr:"â‰€",wreath:"â‰€",Wscr:"ð’²",wscr:"ð“Œ",xcap:"â‹‚",xcirc:"â—¯",xcup:"â‹ƒ",xdtri:"â–½",Xfr:"ð”›",xfr:"ð”µ",xhArr:"âŸº",xharr:"âŸ·",Xi:"Îž",xi:"Î¾",xlArr:"âŸ¸",xlarr:"âŸµ",xmap:"âŸ¼",xnis:"â‹»",xodot:"â¨€",Xopf:"ð•",xopf:"ð•©",xoplus:"â¨",xotime:"â¨‚",xrArr:"âŸ¹",xrarr:"âŸ¶",Xscr:"ð’³",xscr:"ð“",xsqcup:"â¨†",xuplus:"â¨„",xutri:"â–³",xvee:"â‹",xwedge:"â‹€",Yacute:"Ã",yacute:"Ã½",YAcy:"Ð¯",yacy:"Ñ",Ycirc:"Å¶",ycirc:"Å·",Ycy:"Ð«",ycy:"Ñ‹",yen:"Â¥",Yfr:"ð”œ",yfr:"ð”¶",YIcy:"Ð‡",yicy:"Ñ—",Yopf:"ð•",yopf:"ð•ª",Yscr:"ð’´",yscr:"ð“Ž",YUcy:"Ð®",yucy:"ÑŽ",Yuml:"Å¸",yuml:"Ã¿",Zacute:"Å¹",zacute:"Åº",Zcaron:"Å½",zcaron:"Å¾",Zcy:"Ð—",zcy:"Ð·",Zdot:"Å»",zdot:"Å¼",zeetrf:"â„¨",ZeroWidthSpace:"â€‹",Zeta:"Î–",zeta:"Î¶",Zfr:"â„¨",zfr:"ð”·",ZHcy:"Ð–",zhcy:"Ð¶",zigrarr:"â‡",Zopf:"â„¤",zopf:"ð•«",Zscr:"ð’µ",zscr:"ð“",zwj:"â€",zwnj:"â€Œ"}),n.entityMap=n.HTML_ENTITIES})(ZR);var t_={},Hm=lu.NAMESPACE,XS=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,fT=new RegExp("[\\-\\.0-9"+XS.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),pT=new RegExp("^"+XS.source+fT.source+"*(?::"+XS.source+fT.source+"*)?$"),Eg=0,Dl=1,pd=2,Cg=3,gd=4,md=5,_g=6,zv=7;function Jp(n,e){this.message=n,this.locator=e,Error.captureStackTrace&&Error.captureStackTrace(this,Jp)}Jp.prototype=new Error;Jp.prototype.name=Jp.name;function QR(){}QR.prototype={parse:function(n,e,t){var i=this.domBuilder;i.startDocument(),JR(e,e={}),D7(n,e,t,i,this.errorHandler),i.endDocument()}};function D7(n,e,t,i,s){function r(F){if(F>65535){F-=65536;var M=55296+(F>>10),I=56320+(F&1023);return String.fromCharCode(M,I)}else return String.fromCharCode(F)}function a(F){var M=F.slice(1,-1);return M in t?t[M]:M.charAt(0)==="#"?r(parseInt(M.substr(1).replace("x","0x"))):(s.error("entity not found:"+F),F)}function o(F){if(F>w){var M=n.substring(w,F).replace(/&#?\w+;/g,a);p&&l(w),i.characters(M,0,F-w),w=F}}function l(F,M){for(;F>=d&&(M=f.exec(n));)u=M.index,d=u+M[0].length,p.lineNumber++;p.columnNumber=F-u+1}for(var u=0,d=0,f=/.*(?:\r\n?|\n)|.*$/g,p=i.locator,g=[{currentNSMap:e}],x={},w=0;;){try{var y=n.indexOf("<",w);if(y<0){if(!n.substr(w).match(/^\s*$/)){var m=i.doc,v=m.createTextNode(n.substr(w));m.appendChild(v),i.currentElement=v}return}switch(y>w&&o(y),n.charAt(y+1)){case"/":var P=n.indexOf(">",y+3),b=n.substring(y+2,P).replace(/[ \t\n\r]+$/g,""),A=g.pop();P<0?(b=n.substring(y+2).replace(/[\s<].*/,""),s.error("end tag name: "+b+" is not complete:"+A.tagName),P=y+1+b.length):b.match(/\s</)&&(b=b.replace(/[\s<].*/,""),s.error("end tag name: "+b+" maybe not complete"),P=y+1+b.length);var S=A.localNSMap,C=A.tagName==b,k=C||A.tagName&&A.tagName.toLowerCase()==b.toLowerCase();if(k){if(i.endElement(A.uri,A.localName,b),S)for(var L in S)Object.prototype.hasOwnProperty.call(S,L)&&i.endPrefixMapping(L);C||s.fatalError("end tag name: "+b+" is not match the current start tagName:"+A.tagName)}else g.push(A);P++;break;case"?":p&&l(y),P=O7(n,y,i);break;case"!":p&&l(y),P=M7(n,y,i,s);break;default:p&&l(y);var D=new e4,j=g[g.length-1].currentNSMap,P=j7(n,y,D,j,a,s),H=D.length;if(!D.closed&&L7(n,P,D.tagName,x)&&(D.closed=!0,t.nbsp||s.warning("unclosed xml attribute")),p&&H){for(var G=gT(p,{}),$=0;$<H;$++){var Y=D[$];l(Y.offset),Y.locator=gT(p,{})}i.locator=G,mT(D,i,j)&&g.push(D),i.locator=p}else mT(D,i,j)&&g.push(D);Hm.isHTML(D.uri)&&!D.closed?P=R7(n,P,D.tagName,a,i):P++}}catch(F){if(F instanceof Jp)throw F;s.error("element parse error: "+F),P=-1}P>w?w=P:o(Math.max(y,w)+1)}}function gT(n,e){return e.lineNumber=n.lineNumber,e.columnNumber=n.columnNumber,e}function j7(n,e,t,i,s,r){function a(p,g,x){t.attributeNames.hasOwnProperty(p)&&r.fatalError("Attribute "+p+" redefined"),t.addValue(p,g,x)}for(var o,l,u=++e,d=Eg;;){var f=n.charAt(u);switch(f){case"=":if(d===Dl)o=n.slice(e,u),d=Cg;else if(d===pd)d=Cg;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(d===Cg||d===Dl)if(d===Dl&&(r.warning('attribute value must after "="'),o=n.slice(e,u)),e=u+1,u=n.indexOf(f,e),u>0)l=n.slice(e,u).replace(/&#?\w+;/g,s),a(o,l,e-1),d=md;else throw new Error("attribute value no end '"+f+"' match");else if(d==gd)l=n.slice(e,u).replace(/&#?\w+;/g,s),a(o,l,e),r.warning('attribute "'+o+'" missed start quot('+f+")!!"),e=u+1,d=md;else throw new Error('attribute value must after "="');break;case"/":switch(d){case Eg:t.setTagName(n.slice(e,u));case md:case _g:case zv:d=zv,t.closed=!0;case gd:case Dl:break;case pd:t.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return r.error("unexpected end of input"),d==Eg&&t.setTagName(n.slice(e,u)),u;case">":switch(d){case Eg:t.setTagName(n.slice(e,u));case md:case _g:case zv:break;case gd:case Dl:l=n.slice(e,u),l.slice(-1)==="/"&&(t.closed=!0,l=l.slice(0,-1));case pd:d===pd&&(l=o),d==gd?(r.warning('attribute "'+l+'" missed quot(")!'),a(o,l.replace(/&#?\w+;/g,s),e)):((!Hm.isHTML(i[""])||!l.match(/^(?:disabled|checked|selected)$/i))&&r.warning('attribute "'+l+'" missed value!! "'+l+'" instead!!'),a(l,l,e));break;case Cg:throw new Error("attribute value missed!!")}return u;case"Â€":f=" ";default:if(f<=" ")switch(d){case Eg:t.setTagName(n.slice(e,u)),d=_g;break;case Dl:o=n.slice(e,u),d=pd;break;case gd:var l=n.slice(e,u).replace(/&#?\w+;/g,s);r.warning('attribute "'+l+'" missed quot(")!!'),a(o,l,e);case md:d=_g;break}else switch(d){case pd:t.tagName,(!Hm.isHTML(i[""])||!o.match(/^(?:disabled|checked|selected)$/i))&&r.warning('attribute "'+o+'" missed value!! "'+o+'" instead2!!'),a(o,o,e),e=u,d=Dl;break;case md:r.warning('attribute space is required"'+o+'"!!');case _g:d=Dl,e=u;break;case Cg:d=gd,e=u;break;case zv:throw new Error("elements closed character '/' and '>' must be connected to")}}u++}}function mT(n,e,t){for(var i=n.tagName,s=null,f=n.length;f--;){var r=n[f],a=r.qName,o=r.value,p=a.indexOf(":");if(p>0)var l=r.prefix=a.slice(0,p),u=a.slice(p+1),d=l==="xmlns"&&u;else u=a,l=null,d=a==="xmlns"&&"";r.localName=u,d!==!1&&(s==null&&(s={},JR(t,t={})),t[d]=s[d]=o,r.uri=Hm.XMLNS,e.startPrefixMapping(d,o))}for(var f=n.length;f--;){r=n[f];var l=r.prefix;l&&(l==="xml"&&(r.uri=Hm.XML),l!=="xmlns"&&(r.uri=t[l||""]))}var p=i.indexOf(":");p>0?(l=n.prefix=i.slice(0,p),u=n.localName=i.slice(p+1)):(l=null,u=n.localName=i);var g=n.uri=t[l||""];if(e.startElement(g,u,i,n),n.closed){if(e.endElement(g,u,i),s)for(l in s)Object.prototype.hasOwnProperty.call(s,l)&&e.endPrefixMapping(l)}else return n.currentNSMap=t,n.localNSMap=s,!0}function R7(n,e,t,i,s){if(/^(?:script|textarea)$/i.test(t)){var r=n.indexOf("</"+t+">",e),a=n.substring(e+1,r);if(/[&<]/.test(a))return/^script$/i.test(t)?(s.characters(a,0,a.length),r):(a=a.replace(/&#?\w+;/g,i),s.characters(a,0,a.length),r)}return e+1}function L7(n,e,t,i){var s=i[t];return s==null&&(s=n.lastIndexOf("</"+t+">"),s<e&&(s=n.lastIndexOf("</"+t)),i[t]=s),s<e}function JR(n,e){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}function M7(n,e,t,i){var s=n.charAt(e+2);switch(s){case"-":if(n.charAt(e+3)==="-"){var r=n.indexOf("-->",e+4);return r>e?(t.comment(n,e+4,r-e-4),r+3):(i.error("Unclosed comment"),-1)}else return-1;default:if(n.substr(e+3,6)=="CDATA["){var r=n.indexOf("]]>",e+9);return t.startCDATA(),t.characters(n,e+9,r-e-9),t.endCDATA(),r+3}var a=I7(n,e),o=a.length;if(o>1&&/!doctype/i.test(a[0][0])){var l=a[1][0],u=!1,d=!1;o>3&&(/^public$/i.test(a[2][0])?(u=a[3][0],d=o>4&&a[4][0]):/^system$/i.test(a[2][0])&&(d=a[3][0]));var f=a[o-1];return t.startDTD(l,u,d),t.endDTD(),f.index+f[0].length}}return-1}function O7(n,e,t){var i=n.indexOf("?>",e);if(i){var s=n.substring(e,i).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return s?(s[0].length,t.processingInstruction(s[1],s[2]),i+2):-1}return-1}function e4(){this.attributeNames={}}e4.prototype={setTagName:function(n){if(!pT.test(n))throw new Error("invalid tagName:"+n);this.tagName=n},addValue:function(n,e,t){if(!pT.test(n))throw new Error("invalid attribute:"+n);this.attributeNames[n]=this.length,this[this.length++]={qName:n,value:e,offset:t}},length:0,getLocalName:function(n){return this[n].localName},getLocator:function(n){return this[n].locator},getQName:function(n){return this[n].qName},getURI:function(n){return this[n].uri},getValue:function(n){return this[n].value}};function I7(n,e){var t,i=[],s=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(s.lastIndex=e,s.exec(n);t=s.exec(n);)if(i.push(t),t[1])return i}t_.XMLReader=QR;t_.ParseError=Jp;var P7=lu,i_=ou,yT=ZR,t4=t_,B7=i_.DOMImplementation,vT=P7.NAMESPACE,F7=t4.ParseError,z7=t4.XMLReader;function i4(n){this.options=n||{locator:{}}}i4.prototype.parseFromString=function(n,e){var t=this.options,i=new z7,s=t.domBuilder||new dv,r=t.errorHandler,a=t.locator,o=t.xmlns||{},l=/\/x?html?$/.test(e),u=l?yT.HTML_ENTITIES:yT.XML_ENTITIES;return a&&s.setDocumentLocator(a),i.errorHandler=U7(r,s,a),i.domBuilder=t.domBuilder||s,l&&(o[""]=vT.HTML),o.xml=o.xml||vT.XML,n&&typeof n=="string"?i.parse(n,o,u):i.errorHandler.error("invalid doc source"),s.doc};function U7(n,e,t){if(!n){if(e instanceof dv)return e;n=e}var i={},s=n instanceof Function;t=t||{};function r(a){var o=n[a];!o&&s&&(o=n.length==2?function(l){n(a,l)}:n),i[a]=o&&function(l){o("[xmldom "+a+"]	"+l+KS(t))}||function(){}}return r("warning"),r("error"),r("fatalError"),i}function dv(){this.cdata=!1}function yd(n,e){e.lineNumber=n.lineNumber,e.columnNumber=n.columnNumber}dv.prototype={startDocument:function(){this.doc=new B7().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(n,e,t,i){var s=this.doc,r=s.createElementNS(n,t||e),a=i.length;Uv(this,r),this.currentElement=r,this.locator&&yd(this.locator,r);for(var o=0;o<a;o++){var n=i.getURI(o),l=i.getValue(o),t=i.getQName(o),u=s.createAttributeNS(n,t);this.locator&&yd(i.getLocator(o),u),u.value=u.nodeValue=l,r.setAttributeNode(u)}},endElement:function(n,e,t){var i=this.currentElement;i.tagName,this.currentElement=i.parentNode},startPrefixMapping:function(n,e){},endPrefixMapping:function(n){},processingInstruction:function(n,e){var t=this.doc.createProcessingInstruction(n,e);this.locator&&yd(this.locator,t),Uv(this,t)},ignorableWhitespace:function(n,e,t){},characters:function(n,e,t){if(n=xT.apply(this,arguments),n){if(this.cdata)var i=this.doc.createCDATASection(n);else var i=this.doc.createTextNode(n);this.currentElement?this.currentElement.appendChild(i):/^\s*$/.test(n)&&this.doc.appendChild(i),this.locator&&yd(this.locator,i)}},skippedEntity:function(n){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(n){(this.locator=n)&&(n.lineNumber=0)},comment:function(n,e,t){n=xT.apply(this,arguments);var i=this.doc.createComment(n);this.locator&&yd(this.locator,i),Uv(this,i)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(n,e,t){var i=this.doc.implementation;if(i&&i.createDocumentType){var s=i.createDocumentType(n,e,t);this.locator&&yd(this.locator,s),Uv(this,s),this.doc.doctype=s}},warning:function(n){console.warn("[xmldom warning]	"+n,KS(this.locator))},error:function(n){console.error("[xmldom error]	"+n,KS(this.locator))},fatalError:function(n){throw new F7(n,this.locator)}};function KS(n){if(n)return`
@`+(n.systemId||"")+"#[line:"+n.lineNumber+",col:"+n.columnNumber+"]"}function xT(n,e,t){return typeof n=="string"?n.substr(e,t):n.length>=e+t||e?new java.lang.String(n,e,t)+"":n}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(n){dv.prototype[n]=function(){return null}});function Uv(n,e){n.currentElement?n.currentElement.appendChild(e):n.doc.appendChild(e)}hv.__DOMHandler=dv;hv.DOMParser=i4;hv.DOMImplementation=i_.DOMImplementation;hv.XMLSerializer=i_.XMLSerializer;var n4=hv.DOMParser;const n_=typeof window<"u"?window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame:!1,H7=1,$7=3,s4=typeof URL<"u"?URL:typeof window<"u"?window.URL||window.webkitURL||window.mozURL:void 0;function iw(){var n=new Date().getTime(),e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var i=(n+Math.random()*16)%16|0;return n=Math.floor(n/16),(t=="x"?i:i&7|8).toString(16)});return e}function q7(){return Math.max(document.documentElement.clientHeight,document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight)}function r4(n){return!!(n&&n.nodeType==1)}function Li(n){return!isNaN(parseFloat(n))&&isFinite(n)}function a4(n){let e=parseFloat(n);return Li(n)===!1?!1:typeof n=="string"&&n.indexOf(".")>-1?!0:Math.floor(e)!==e}function Cd(n){var e=["Webkit","webkit","Moz","O","ms"],t=["-webkit-","-webkit-","-moz-","-o-","-ms-"],i=n.toLowerCase(),s=e.length;if(typeof document>"u"||typeof document.body.style[i]<"u")return n;for(var r=0;r<s;r++)if(typeof document.body.style[t[r]+i]<"u")return t[r]+i;return n}function o4(n){for(var e=1,t=arguments.length;e<t;e++){var i=arguments[e];for(var s in i)n[s]===void 0&&(n[s]=i[s])}return n}function Bn(n){var e=[].slice.call(arguments,1);return e.forEach(function(t){t&&Object.getOwnPropertyNames(t).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}),n}function V7(n,e,t){var i=eg(n,e,t);return e.splice(i,0,n),i}function eg(n,e,t,i,s){var r=i||0,a=s||e.length,o=parseInt(r+(a-r)/2),l;return t||(t=function(u,d){if(u>d)return 1;if(u<d)return-1;if(u==d)return 0}),a-r<=0?o:(l=t(e[o],n),a-r===1?l>=0?o:o+1:l===0?o:l===-1?eg(n,e,t,o,a):eg(n,e,t,r,o))}function Bb(n,e,t,i,s){var r=i||0,a=s||e.length,o=parseInt(r+(a-r)/2),l;return t||(t=function(u,d){if(u>d)return 1;if(u<d)return-1;if(u==d)return 0}),a-r<=0?-1:(l=t(e[o],n),a-r===1?l===0?o:-1:l===0?o:l===-1?Bb(n,e,t,o,a):Bb(n,e,t,r,o))}function px(n){var e=window.getComputedStyle(n),t=["width","paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"],i=["height","paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"],s=0,r=0;return t.forEach(function(a){s+=parseFloat(e[a])||0}),i.forEach(function(a){r+=parseFloat(e[a])||0}),{height:r,width:s}}function Fb(n){var e=window.getComputedStyle(n),t=["paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"],i=["paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"],s=0,r=0;return t.forEach(function(a){s+=parseFloat(e[a])||0}),i.forEach(function(a){r+=parseFloat(e[a])||0}),{height:r,width:s}}function ZS(n){let e,t=n.ownerDocument;if(n.nodeType==Node.TEXT_NODE){let i=t.createRange();i.selectNodeContents(n),e=i.getBoundingClientRect()}else e=n.getBoundingClientRect();return e}function zb(){var n=window.innerWidth,e=window.innerHeight;return{top:0,left:0,right:n,bottom:e,width:n,height:e}}function s_(n,e){for(var t=n.parentNode,i=t.childNodes,s,r=-1,a=0;a<i.length&&(s=i[a],s.nodeType===e&&r++,s!=n);a++);return r}function G7(n){return s_(n,$7)}function l4(n){return s_(n,H7)}function $m(n){return["xml","opf","ncx"].indexOf(n)>-1}function c4(n,e){return new Blob([n],{type:e})}function Ub(n,e){var t,i=c4(n,e);return t=s4.createObjectURL(i),t}function u4(n){return s4.revokeObjectURL(n)}function QS(n,e){var t,i;if(typeof n=="string")return t=btoa(n),i="data:"+e+";base64,"+t,i}function h4(n){return Object.prototype.toString.call(n).slice(8,-1)}function Qa(n,e,t){var i,s;return typeof DOMParser>"u"||t?s=n4:s=DOMParser,n.charCodeAt(0)===65279&&(n=n.slice(1)),i=new s().parseFromString(n,e),i}function oi(n,e){var t;if(!n)throw new Error("No Element Provided");if(typeof n.querySelector<"u")return n.querySelector(e);if(t=n.getElementsByTagName(e),t.length)return t[0]}function Al(n,e){return typeof n.querySelector<"u"?n.querySelectorAll(e):n.getElementsByTagName(e)}function _d(n,e,t){var i,s;if(typeof n.querySelector<"u"){e+="[";for(var r in t)e+=r+"~='"+t[r]+"'";return e+="]",n.querySelector(e)}else if(i=n.getElementsByTagName(e),s=Array.prototype.slice.call(i,0).filter(function(a){for(var o in t)if(a.getAttribute(o)===t[o])return!0;return!1}),s)return s[0]}function Hb(n,e){var t=n.ownerDocument||n;typeof t.createTreeWalker<"u"?d4(n,e,NodeFilter.SHOW_TEXT):r_(n,function(i){i&&i.nodeType===3&&e(i)})}function d4(n,e,t){var i=document.createTreeWalker(n,t,null,!1);let s;for(;s=i.nextNode();)e(s)}function r_(n,e){if(e(n))return!0;if(n=n.firstChild,n)do{if(r_(n,e))return!0;n=n.nextSibling}while(n)}function f4(n){return new Promise(function(e,t){var i=new FileReader;i.readAsDataURL(n),i.onloadend=function(){e(i.result)}})}function Dt(){this.resolve=null,this.reject=null,this.id=iw(),this.promise=new Promise((n,e)=>{this.resolve=n,this.reject=e}),Object.freeze(this)}function $b(n,e,t){var i;if(typeof n.querySelector<"u"&&(i=n.querySelector(`${e}[*|type="${t}"]`)),!i||i.length===0){i=Al(n,e);for(var s=0;s<i.length;s++)if(i[s].getAttributeNS("http://www.idpf.org/2007/ops","type")===t||i[s].getAttribute("epub:type")===t)return i[s]}else return i}function JS(n){for(var e=[],t=n.childNodes,i=0;i<t.length;i++){let s=t[i];s.nodeType===1&&e.push(s)}return e}function eA(n){for(var e=[n];n;n=n.parentNode)e.unshift(n);return e}function Nd(n,e,t){for(var i=[],s=n.childNodes,r=0;r<s.length;r++){let a=s[r];if(a.nodeType===1&&a.nodeName.toLowerCase()===e){if(t)return a;i.push(a)}}if(!t)return i}function Y7(n,e){let t;if(!(n===null||e===""))for(t=n.parentNode;t.nodeType===1;){if(t.tagName.toLowerCase()===e)return t;t=t.parentNode}}class p4{constructor(){this.collapsed=!1,this.commonAncestorContainer=void 0,this.endContainer=void 0,this.endOffset=void 0,this.startContainer=void 0,this.startOffset=void 0}setStart(e,t){this.startContainer=e,this.startOffset=t,this.endContainer?this.commonAncestorContainer=this._commonAncestorContainer():this.collapse(!0),this._checkCollapsed()}setEnd(e,t){this.endContainer=e,this.endOffset=t,this.startContainer?(this.collapsed=!1,this.commonAncestorContainer=this._commonAncestorContainer()):this.collapse(!1),this._checkCollapsed()}collapse(e){this.collapsed=!0,e?(this.endContainer=this.startContainer,this.endOffset=this.startOffset,this.commonAncestorContainer=this.startContainer.parentNode):(this.startContainer=this.endContainer,this.startOffset=this.endOffset,this.commonAncestorContainer=this.endOffset.parentNode)}selectNode(e){let t=e.parentNode,i=Array.prototype.indexOf.call(t.childNodes,e);this.setStart(t,i),this.setEnd(t,i+1)}selectNodeContents(e){e.childNodes[e.childNodes-1];let t=e.nodeType===3?e.textContent.length:parent.childNodes.length;this.setStart(e,0),this.setEnd(e,t)}_commonAncestorContainer(e,t){var i=eA(e||this.startContainer),s=eA(t||this.endContainer);if(i[0]==s[0]){for(var r=0;r<i.length;r++)if(i[r]!=s[r])return i[r-1]}}_checkCollapsed(){this.startContainer===this.endContainer&&this.startOffset===this.endOffset?this.collapsed=!0:this.collapsed=!1}toString(){}}const W7=Object.freeze(Object.defineProperty({__proto__:null,RangeObject:p4,blob2base64:f4,borders:Fb,bounds:px,createBase64Url:QS,createBlob:c4,createBlobUrl:Ub,defaults:o4,defer:Dt,documentHeight:q7,extend:Bn,filterChildren:Nd,findChildren:JS,getParentByTagName:Y7,indexOfElementNode:l4,indexOfNode:s_,indexOfSorted:Bb,indexOfTextNode:G7,insert:V7,isElement:r4,isFloat:a4,isNumber:Li,isXml:$m,locationOf:eg,nodeBounds:ZS,parents:eA,parse:Qa,prefixed:Cd,qs:oi,qsa:Al,qsp:_d,querySelectorByType:$b,requestAnimationFrame:n_,revokeBlobUrl:u4,sprint:Hb,treeWalker:d4,type:h4,uuid:iw,walk:r_,windowBounds:zb},Symbol.toStringTag,{value:"Module"}));if(!g4)var g4={cwd:function(){return"/"}};function xa(n){if(typeof n!="string")throw new TypeError("Path must be a string. Received "+n)}function bT(n,e){for(var t="",i=-1,s=0,r,a=0;a<=n.length;++a){if(a<n.length)r=n.charCodeAt(a);else{if(r===47)break;r=47}if(r===47){if(!(i===a-1||s===1))if(i!==a-1&&s===2){if(t.length<2||t.charCodeAt(t.length-1)!==46||t.charCodeAt(t.length-2)!==46){if(t.length>2){for(var o=t.length-1,l=o;l>=0&&t.charCodeAt(l)!==47;--l);if(l!==o){l===-1?t="":t=t.slice(0,l),i=a,s=0;continue}}else if(t.length===2||t.length===1){t="",i=a,s=0;continue}}e&&(t.length>0?t+="/..":t="..")}else t.length>0?t+="/"+n.slice(i+1,a):t=n.slice(i+1,a);i=a,s=0}else r===46&&s!==-1?++s:s=-1}return t}function X7(n,e){var t=e.dir||e.root,i=e.base||(e.name||"")+(e.ext||"");return t?t===e.root?t+i:t+n+i:i}var gx={resolve:function(){for(var e="",t=!1,i,s=arguments.length-1;s>=-1&&!t;s--){var r;s>=0?r=arguments[s]:(i===void 0&&(i=g4.cwd()),r=i),xa(r),r.length!==0&&(e=r+"/"+e,t=r.charCodeAt(0)===47)}return e=bT(e,!t),t?e.length>0?"/"+e:"/":e.length>0?e:"."},normalize:function(e){if(xa(e),e.length===0)return".";var t=e.charCodeAt(0)===47,i=e.charCodeAt(e.length-1)===47;return e=bT(e,!t),e.length===0&&!t&&(e="."),e.length>0&&i&&(e+="/"),t?"/"+e:e},isAbsolute:function(e){return xa(e),e.length>0&&e.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var e,t=0;t<arguments.length;++t){var i=arguments[t];xa(i),i.length>0&&(e===void 0?e=i:e+="/"+i)}return e===void 0?".":gx.normalize(e)},relative:function(e,t){if(xa(e),xa(t),e===t||(e=gx.resolve(e),t=gx.resolve(t),e===t))return"";for(var i=1;i<e.length&&e.charCodeAt(i)===47;++i);for(var s=e.length,r=s-i,a=1;a<t.length&&t.charCodeAt(a)===47;++a);for(var o=t.length,l=o-a,u=r<l?r:l,d=-1,f=0;f<=u;++f){if(f===u){if(l>u){if(t.charCodeAt(a+f)===47)return t.slice(a+f+1);if(f===0)return t.slice(a+f)}else r>u&&(e.charCodeAt(i+f)===47?d=f:f===0&&(d=0));break}var p=e.charCodeAt(i+f),g=t.charCodeAt(a+f);if(p!==g)break;p===47&&(d=f)}var x="";for(f=i+d+1;f<=s;++f)(f===s||e.charCodeAt(f)===47)&&(x.length===0?x+="..":x+="/..");return x.length>0?x+t.slice(a+d):(a+=d,t.charCodeAt(a)===47&&++a,t.slice(a))},_makeLong:function(e){return e},dirname:function(e){if(xa(e),e.length===0)return".";for(var t=e.charCodeAt(0),i=t===47,s=-1,r=!0,a=e.length-1;a>=1;--a)if(t=e.charCodeAt(a),t===47){if(!r){s=a;break}}else r=!1;return s===-1?i?"/":".":i&&s===1?"//":e.slice(0,s)},basename:function(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');xa(e);var i=0,s=-1,r=!0,a;if(t!==void 0&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var o=t.length-1,l=-1;for(a=e.length-1;a>=0;--a){var u=e.charCodeAt(a);if(u===47){if(!r){i=a+1;break}}else l===-1&&(r=!1,l=a+1),o>=0&&(u===t.charCodeAt(o)?--o===-1&&(s=a):(o=-1,s=l))}return i===s?s=l:s===-1&&(s=e.length),e.slice(i,s)}else{for(a=e.length-1;a>=0;--a)if(e.charCodeAt(a)===47){if(!r){i=a+1;break}}else s===-1&&(r=!1,s=a+1);return s===-1?"":e.slice(i,s)}},extname:function(e){xa(e);for(var t=-1,i=0,s=-1,r=!0,a=0,o=e.length-1;o>=0;--o){var l=e.charCodeAt(o);if(l===47){if(!r){i=o+1;break}continue}s===-1&&(r=!1,s=o+1),l===46?t===-1?t=o:a!==1&&(a=1):t!==-1&&(a=-1)}return t===-1||s===-1||a===0||a===1&&t===s-1&&t===i+1?"":e.slice(t,s)},format:function(e){if(e===null||typeof e!="object")throw new TypeError('Parameter "pathObject" must be an object, not '+typeof e);return X7("/",e)},parse:function(e){xa(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;var i=e.charCodeAt(0),s=i===47,r;s?(t.root="/",r=1):r=0;for(var a=-1,o=0,l=-1,u=!0,d=e.length-1,f=0;d>=r;--d){if(i=e.charCodeAt(d),i===47){if(!u){o=d+1;break}continue}l===-1&&(u=!1,l=d+1),i===46?a===-1?a=d:f!==1&&(f=1):a!==-1&&(f=-1)}return a===-1||l===-1||f===0||f===1&&a===l-1&&a===o+1?l!==-1&&(o===0&&s?t.base=t.name=e.slice(1,l):t.base=t.name=e.slice(o,l)):(o===0&&s?(t.name=e.slice(1,a),t.base=e.slice(1,l)):(t.name=e.slice(o,a),t.base=e.slice(o,l)),t.ext=e.slice(a,l)),o>0?t.dir=e.slice(0,o-1):s&&(t.dir="/"),t},sep:"/",delimiter:":",posix:null},K7=gx;const Bc=Wh(K7);class El{constructor(e){var t,i;t=e.indexOf("://"),t>-1&&(e=new URL(e).pathname),i=this.parse(e),this.path=e,this.isDirectory(e)?this.directory=e:this.directory=i.dir+"/",this.filename=i.base,this.extension=i.ext.slice(1)}parse(e){return Bc.parse(e)}isAbsolute(e){return Bc.isAbsolute(e||this.path)}isDirectory(e){return e.charAt(e.length-1)==="/"}resolve(e){return Bc.resolve(this.directory,e)}relative(e){var t=e&&e.indexOf("://")>-1;return t?e:Bc.relative(this.directory,e)}splitPath(e){return this.splitPathRe.exec(e).slice(1)}toString(){return this.path}}class Jr{constructor(e,t){var i=e.indexOf("://")>-1,s=e,r;if(this.Url=void 0,this.href=e,this.protocol="",this.origin="",this.hash="",this.hash="",this.search="",this.base=t,!i&&t!==!1&&typeof t!="string"&&window&&window.location&&(this.base=window.location.href),i||this.base)try{this.base?this.Url=new URL(e,this.base):this.Url=new URL(e),this.href=this.Url.href,this.protocol=this.Url.protocol,this.origin=this.Url.origin,this.hash=this.Url.hash,this.search=this.Url.search,s=this.Url.pathname+(this.Url.search?this.Url.search:"")}catch{this.Url=void 0,this.base&&(r=new El(this.base),s=r.resolve(s))}this.Path=new El(s),this.directory=this.Path.directory,this.filename=this.Path.filename,this.extension=this.Path.extension}path(){return this.Path}resolve(e){var t=e.indexOf("://")>-1,i;return t?e:(i=Bc.resolve(this.directory,e),this.origin+i)}relative(e){return Bc.relative(e,this.directory)}toString(){return this.href}}const vd=1,gr=3,Z7=9;class jt{constructor(e,t,i){var s;if(this.str="",this.base={},this.spinePos=0,this.range=!1,this.path={},this.start=null,this.end=null,!(this instanceof jt))return new jt(e,t,i);if(typeof t=="string"?this.base=this.parseComponent(t):typeof t=="object"&&t.steps&&(this.base=t),s=this.checkType(e),s==="string")return this.str=e,Bn(this,this.parse(e));if(s==="range")return Bn(this,this.fromRange(e,this.base,i));if(s==="node")return Bn(this,this.fromNode(e,this.base,i));if(s==="EpubCFI"&&e.path)return e;if(e)throw new TypeError("not a valid argument for EpubCFI");return this}checkType(e){return this.isCfiString(e)?"string":e&&typeof e=="object"&&(h4(e)==="Range"||typeof e.startContainer<"u")?"range":e&&typeof e=="object"&&typeof e.nodeType<"u"?"node":e&&typeof e=="object"&&e instanceof jt?"EpubCFI":!1}parse(e){var t={spinePos:-1,range:!1,base:{},path:{},start:null,end:null},i,s,r;return typeof e!="string"?{spinePos:-1}:(e.indexOf("epubcfi(")===0&&e[e.length-1]===")"&&(e=e.slice(8,e.length-1)),i=this.getChapterComponent(e),i?(t.base=this.parseComponent(i),s=this.getPathComponent(e),t.path=this.parseComponent(s),r=this.getRange(e),r&&(t.range=!0,t.start=this.parseComponent(r[0]),t.end=this.parseComponent(r[1])),t.spinePos=t.base.steps[1].index,t):{spinePos:-1})}parseComponent(e){var t={steps:[],terminal:{offset:null,assertion:null}},i=e.split(":"),s=i[0].split("/"),r;return i.length>1&&(r=i[1],t.terminal=this.parseTerminal(r)),s[0]===""&&s.shift(),t.steps=s.map((function(a){return this.parseStep(a)}).bind(this)),t}parseStep(e){var t,i,s,r,a;if(r=e.match(/\[(.*)\]/),r&&r[1]&&(a=r[1]),i=parseInt(e),!isNaN(i))return i%2===0?(t="element",s=i/2-1):(t="text",s=(i-1)/2),{type:t,index:s,id:a||null}}parseTerminal(e){var t,i,s=e.match(/\[(.*)\]/);return s&&s[1]?(t=parseInt(e.split("[")[0]),i=s[1]):t=parseInt(e),Li(t)||(t=null),{offset:t,assertion:i}}getChapterComponent(e){var t=e.split("!");return t[0]}getPathComponent(e){var t=e.split("!");if(t[1])return t[1].split(",")[0]}getRange(e){var t=e.split(",");return t.length===3?[t[1],t[2]]:!1}getCharecterOffsetComponent(e){var t=e.split(":");return t[1]||""}joinSteps(e){return e?e.map(function(t){var i="";return t.type==="element"&&(i+=(t.index+1)*2),t.type==="text"&&(i+=1+2*t.index),t.id&&(i+="["+t.id+"]"),i}).join("/"):""}segmentString(e){var t="/";return t+=this.joinSteps(e.steps),e.terminal&&e.terminal.offset!=null&&(t+=":"+e.terminal.offset),e.terminal&&e.terminal.assertion!=null&&(t+="["+e.terminal.assertion+"]"),t}toString(){var e="epubcfi(";return e+=this.segmentString(this.base),e+="!",e+=this.segmentString(this.path),this.range&&this.start&&(e+=",",e+=this.segmentString(this.start)),this.range&&this.end&&(e+=",",e+=this.segmentString(this.end)),e+=")",e}compare(e,t){var i,s,r,a;if(typeof e=="string"&&(e=new jt(e)),typeof t=="string"&&(t=new jt(t)),e.spinePos>t.spinePos)return 1;if(e.spinePos<t.spinePos)return-1;e.range?(i=e.path.steps.concat(e.start.steps),r=e.start.terminal):(i=e.path.steps,r=e.path.terminal),t.range?(s=t.path.steps.concat(t.start.steps),a=t.start.terminal):(s=t.path.steps,a=t.path.terminal);for(var o=0;o<i.length;o++){if(!i[o])return-1;if(!s[o]||i[o].index>s[o].index)return 1;if(i[o].index<s[o].index)return-1}return i.length<s.length?-1:r.offset>a.offset?1:r.offset<a.offset?-1:0}step(e){var t=e.nodeType===gr?"text":"element";return{id:e.id,tagName:e.tagName,type:t,index:this.position(e)}}filteredStep(e,t){var i=this.filter(e,t),s;if(i)return s=i.nodeType===gr?"text":"element",{id:i.id,tagName:i.tagName,type:s,index:this.filteredPosition(i,t)}}pathTo(e,t,i){for(var s={steps:[],terminal:{offset:null,assertion:null}},r=e,a;r&&r.parentNode&&r.parentNode.nodeType!=Z7;)i?a=this.filteredStep(r,i):a=this.step(r),a&&s.steps.unshift(a),r=r.parentNode;return t!=null&&t>=0&&(s.terminal.offset=t,s.steps[s.steps.length-1].type!="text"&&s.steps.push({type:"text",index:0})),s}equalStep(e,t){return!e||!t?!1:e.index===t.index&&e.id===t.id&&e.type===t.type}fromRange(e,t,i){var s={range:!1,base:{},path:{},start:null,end:null},r=e.startContainer,a=e.endContainer,o=e.startOffset,l=e.endOffset,u=!1;if(i&&(u=r.ownerDocument.querySelector("."+i)!=null),typeof t=="string"?(s.base=this.parseComponent(t),s.spinePos=s.base.steps[1].index):typeof t=="object"&&(s.base=t),e.collapsed)u&&(o=this.patchOffset(r,o,i)),s.path=this.pathTo(r,o,i);else{s.range=!0,u&&(o=this.patchOffset(r,o,i)),s.start=this.pathTo(r,o,i),u&&(l=this.patchOffset(a,l,i)),s.end=this.pathTo(a,l,i),s.path={steps:[],terminal:null};var d=s.start.steps.length,f;for(f=0;f<d&&this.equalStep(s.start.steps[f],s.end.steps[f]);f++)f===d-1?s.start.terminal===s.end.terminal&&(s.path.steps.push(s.start.steps[f]),s.range=!1):s.path.steps.push(s.start.steps[f]);s.start.steps=s.start.steps.slice(s.path.steps.length),s.end.steps=s.end.steps.slice(s.path.steps.length)}return s}fromNode(e,t,i){var s={range:!1,base:{},path:{},start:null,end:null};return typeof t=="string"?(s.base=this.parseComponent(t),s.spinePos=s.base.steps[1].index):typeof t=="object"&&(s.base=t),s.path=this.pathTo(e,null,i),s}filter(e,t){var i,s,r,a,o,l=!1;return e.nodeType===gr?(l=!0,r=e.parentNode,i=e.parentNode.classList.contains(t)):(l=!1,i=e.classList.contains(t)),i&&l?(a=r.previousSibling,o=r.nextSibling,a&&a.nodeType===gr?s=a:o&&o.nodeType===gr&&(s=o),s||e):i&&!l?!1:e}patchOffset(e,t,i){if(e.nodeType!=gr)throw new Error("Anchor must be a text node");var s=e,r=t;for(e.parentNode.classList.contains(i)&&(s=e.parentNode);s.previousSibling;){if(s.previousSibling.nodeType===vd)if(s.previousSibling.classList.contains(i))r+=s.previousSibling.textContent.length;else break;else r+=s.previousSibling.textContent.length;s=s.previousSibling}return r}normalizedMap(e,t,i){var s={},r=-1,a,o=e.length,l,u;for(a=0;a<o;a++)l=e[a].nodeType,l===vd&&e[a].classList.contains(i)&&(l=gr),a>0&&l===gr&&u===gr?s[a]=r:t===l&&(r=r+1,s[a]=r),u=l;return s}position(e){var t,i;return e.nodeType===vd?(t=e.parentNode.children,t||(t=JS(e.parentNode)),i=Array.prototype.indexOf.call(t,e)):(t=this.textNodes(e.parentNode),i=t.indexOf(e)),i}filteredPosition(e,t){var i,s,r;return e.nodeType===vd?(i=e.parentNode.children,r=this.normalizedMap(i,vd,t)):(i=e.parentNode.childNodes,e.parentNode.classList.contains(t)&&(e=e.parentNode,i=e.parentNode.childNodes),r=this.normalizedMap(i,gr,t)),s=Array.prototype.indexOf.call(i,e),r[s]}stepsToXpath(e){var t=[".","*"];return e.forEach(function(i){var s=i.index+1;i.id?t.push("*[position()="+s+" and @id='"+i.id+"']"):i.type==="text"?t.push("text()["+s+"]"):t.push("*["+s+"]")}),t.join("/")}stepsToQuerySelector(e){var t=["html"];return e.forEach(function(i){var s=i.index+1;i.id?t.push("#"+i.id):i.type==="text"||t.push("*:nth-child("+s+")")}),t.join(">")}textNodes(e,t){return Array.prototype.slice.call(e.childNodes).filter(function(i){return i.nodeType===gr?!0:!!(t&&i.classList.contains(t))})}walkToNode(e,t,i){var s=t||document,r=s.documentElement,a,o,l=e.length,u;for(u=0;u<l&&(o=e[u],o.type==="element"?o.id?r=s.getElementById(o.id):(a=r.children||JS(r),r=a[o.index]):o.type==="text"&&(r=this.textNodes(r,i)[o.index]),!!r);u++);return r}findNode(e,t,i){var s=t||document,r,a;return!i&&typeof s.evaluate<"u"?(a=this.stepsToXpath(e),r=s.evaluate(a,s,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue):i?r=this.walkToNode(e,s,i):r=this.walkToNode(e,s),r}fixMiss(e,t,i,s){var r=this.findNode(e.slice(0,-1),i,s),a=r.childNodes,o=this.normalizedMap(a,gr,s),l,u,d=e[e.length-1].index;for(let f in o){if(!o.hasOwnProperty(f))return;if(o[f]===d)if(l=a[f],u=l.textContent.length,t>u)t=t-u;else{l.nodeType===vd?r=l.childNodes[0]:r=l;break}}return{container:r,offset:t}}toRange(e,t){var i=e||document,s,r,a,o,l,u=this,d,f,p=t?i.querySelector("."+t)!=null:!1,g;if(typeof i.createRange<"u"?s=i.createRange():s=new p4,u.range?(r=u.start,d=u.path.steps.concat(r.steps),o=this.findNode(d,i,p?t:null),a=u.end,f=u.path.steps.concat(a.steps),l=this.findNode(f,i,p?t:null)):(r=u.path,d=u.path.steps,o=this.findNode(u.path.steps,i,p?t:null)),o)try{r.terminal.offset!=null?s.setStart(o,r.terminal.offset):s.setStart(o,0)}catch{g=this.fixMiss(d,r.terminal.offset,i,p?t:null),s.setStart(g.container,g.offset)}else return console.log("No startContainer found for",this.toString()),null;if(l)try{a.terminal.offset!=null?s.setEnd(l,a.terminal.offset):s.setEnd(l,0)}catch{g=this.fixMiss(f,u.end.terminal.offset,i,p?t:null),s.setEnd(g.container,g.offset)}return s}isCfiString(e){return typeof e=="string"&&e.indexOf("epubcfi(")===0&&e[e.length-1]===")"}generateChapterComponent(e,t,i){var s=parseInt(t),r=(e+1)*2,a="/"+r+"/";return a+=(s+1)*2,i&&(a+="["+i+"]"),a}collapse(e){this.range&&(this.range=!1,e?(this.path.steps=this.path.steps.concat(this.start.steps),this.path.terminal=this.start.terminal):(this.path.steps=this.path.steps.concat(this.end.steps),this.path.terminal=this.end.terminal))}}class fa{constructor(e){this.context=e||this,this.hooks=[]}register(){for(var e=0;e<arguments.length;++e)if(typeof arguments[e]=="function")this.hooks.push(arguments[e]);else for(var t=0;t<arguments[e].length;++t)this.hooks.push(arguments[e][t])}deregister(e){let t;for(let i=0;i<this.hooks.length;i++)if(t=this.hooks[i],t===e){this.hooks.splice(i,1);break}}trigger(){var e=arguments,t=this.context,i=[];return this.hooks.forEach(function(s){try{var r=s.apply(t,e)}catch(a){console.log(a)}r&&typeof r.then=="function"&&i.push(r)}),Promise.all(i)}list(){return this.hooks}clear(){return this.hooks=[]}}function m4(n,e){var t,i,s=e.url,r=s.indexOf("://")>-1;n&&(i=oi(n,"head"),t=oi(i,"base"),t||(t=n.createElement("base"),i.insertBefore(t,i.firstChild)),!r&&window&&window.location&&(s=window.location.origin+s),t.setAttribute("href",s))}function Q7(n,e){var t,i,s=e.canonical;n&&(t=oi(n,"head"),i=oi(t,"link[rel='canonical']"),i?i.setAttribute("href",s):(i=n.createElement("link"),i.setAttribute("rel","canonical"),i.setAttribute("href",s),t.appendChild(i)))}function J7(n,e){var t,i,s=e.idref;n&&(t=oi(n,"head"),i=oi(t,"link[property='dc.identifier']"),i?i.setAttribute("content",s):(i=n.createElement("meta"),i.setAttribute("name","dc.identifier"),i.setAttribute("content",s),t.appendChild(i)))}function e$(n,e){var t=n.querySelectorAll("a[href]");if(t.length)for(var i=oi(n.ownerDocument,"base"),s=i?i.getAttribute("href"):void 0,r=(function(o){var l=o.getAttribute("href");if(l.indexOf("mailto:")!==0){var u=l.indexOf("://")>-1;if(u)o.setAttribute("target","_blank");else{var d;try{d=new Jr(l,s)}catch{}o.onclick=function(){return d&&d.hash?e(d.Path.path+d.hash):e(d?d.Path.path:l),!1}}}}).bind(this),a=0;a<t.length;a++)r(t[a])}function wT(n,e,t){return e.forEach(function(i,s){i&&t[s]&&(i=i.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),n=n.replace(new RegExp(i,"g"),t[s]))}),n}function qm(n,e,t,i){var s=typeof window<"u"?window.URL:!1,r=s?"blob":"arraybuffer",a=new Dt,o=new XMLHttpRequest,l=XMLHttpRequest.prototype,u;"overrideMimeType"in l||Object.defineProperty(l,"overrideMimeType",{value:function(){}}),t&&(o.withCredentials=!0),o.onreadystatechange=f,o.onerror=d,o.open("GET",n,!0);for(u in i)o.setRequestHeader(u,i[u]);e=="json"&&o.setRequestHeader("Accept","application/json"),e||(e=new El(n).extension),e=="blob"&&(o.responseType=r),$m(e)&&o.overrideMimeType("text/xml"),e=="binary"&&(o.responseType="arraybuffer"),o.send();function d(p){a.reject(p)}function f(){if(this.readyState===XMLHttpRequest.DONE){var p=!1;if((this.responseType===""||this.responseType==="document")&&(p=this.responseXML),this.status===200||this.status===0||p){var g;if(!this.response&&!p)return a.reject({status:this.status,message:"Empty Response",stack:new Error().stack}),a.promise;if(this.status===403)return a.reject({status:this.status,response:this.response,message:"Forbidden",stack:new Error().stack}),a.promise;p?g=this.responseXML:$m(e)?g=Qa(this.response,"text/xml"):e=="xhtml"?g=Qa(this.response,"application/xhtml+xml"):e=="html"||e=="htm"?g=Qa(this.response,"text/html"):e=="json"?g=JSON.parse(this.response):e=="blob"?s?g=this.response:g=new Blob([this.response]):g=this.response,a.resolve(g)}else a.reject({status:this.status,message:this.response,stack:new Error().stack})}}return a.promise}class t${constructor(e,t){this.idref=e.idref,this.linear=e.linear==="yes",this.properties=e.properties,this.index=e.index,this.href=e.href,this.url=e.url,this.canonical=e.canonical,this.next=e.next,this.prev=e.prev,this.cfiBase=e.cfiBase,t?this.hooks=t:(this.hooks={},this.hooks.serialize=new fa(this),this.hooks.content=new fa(this)),this.document=void 0,this.contents=void 0,this.output=void 0}load(e){var t=e||this.request||qm,i=new Dt,s=i.promise;return this.contents?i.resolve(this.contents):t(this.url).then((function(r){return this.document=r,this.contents=r.documentElement,this.hooks.content.trigger(this.document,this)}).bind(this)).then((function(){i.resolve(this.contents)}).bind(this)).catch(function(r){i.reject(r)}),s}base(){return m4(this.document,this)}render(e){var t=new Dt,i=t.promise;return this.output,this.load(e).then((function(s){var r=typeof navigator<"u"&&navigator.userAgent||"",a=r.indexOf("Trident")>=0,o;typeof XMLSerializer>"u"||a?o=n4:o=XMLSerializer;var l=new o;return this.output=l.serializeToString(s),this.output}).bind(this)).then((function(){return this.hooks.serialize.trigger(this.output,this)}).bind(this)).then((function(){t.resolve(this.output)}).bind(this)).catch(function(s){t.reject(s)}),i}find(e){var t=this,i=[],s=e.toLowerCase(),r=function(a){for(var o=a.textContent.toLowerCase(),l=t.document.createRange(),u,d,f=-1,p,g=150;d!=-1;)d=o.indexOf(s,f+1),d!=-1&&(l=t.document.createRange(),l.setStart(a,d),l.setEnd(a,d+s.length),u=t.cfiFromRange(l),a.textContent.length<g?p=a.textContent:(p=a.textContent.substring(d-g/2,d+g/2),p="..."+p+"..."),i.push({cfi:u,excerpt:p})),f=d};return Hb(t.document,function(a){r(a)}),i}search(e,t=5){if(typeof document.createTreeWalker>"u")return this.find(e);let i=[];const s=150,r=this,a=e.toLowerCase(),o=function(f){const x=f.reduce((w,y)=>w+y.textContent,"").toLowerCase().indexOf(a);if(x!=-1){const y=x+a.length;let m=0,v=0;if(x<f[0].length){let b;for(;m<f.length-1&&(v+=f[m].length,!(y<=v));)m+=1;let A=f[0],S=f[m],C=r.document.createRange();C.setStart(A,x);let k=f.slice(0,m).reduce((D,j)=>D+j.textContent.length,0);C.setEnd(S,k>y?y:y-k),b=r.cfiFromRange(C);let L=f.slice(0,m+1).reduce((D,j)=>D+j.textContent,"");L.length>s&&(L=L.substring(x-s/2,x+s/2),L="..."+L+"..."),i.push({cfi:b,excerpt:L})}}},l=document.createTreeWalker(r.document,NodeFilter.SHOW_TEXT,null,!1);let u,d=[];for(;u=l.nextNode();)d.push(u),d.length==t&&(o(d.slice(0,t)),d=d.slice(1,t));return d.length>0&&o(d),i}reconcileLayoutSettings(e){var t={layout:e.layout,spread:e.spread,orientation:e.orientation};return this.properties.forEach(function(i){var s=i.replace("rendition:",""),r=s.indexOf("-"),a,o;r!=-1&&(a=s.slice(0,r),o=s.slice(r+1),t[a]=o)}),t}cfiFromRange(e){return new jt(e,this.cfiBase).toString()}cfiFromElement(e){return new jt(e,this.cfiBase).toString()}unload(){this.document=void 0,this.contents=void 0,this.output=void 0}destroy(){this.unload(),this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.idref=void 0,this.linear=void 0,this.properties=void 0,this.index=void 0,this.href=void 0,this.url=void 0,this.next=void 0,this.prev=void 0,this.cfiBase=void 0}}class i${constructor(){this.spineItems=[],this.spineByHref={},this.spineById={},this.hooks={},this.hooks.serialize=new fa,this.hooks.content=new fa,this.hooks.content.register(m4),this.hooks.content.register(Q7),this.hooks.content.register(J7),this.epubcfi=new jt,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}unpack(e,t,i){this.items=e.spine,this.manifest=e.manifest,this.spineNodeIndex=e.spineNodeIndex,this.baseUrl=e.baseUrl||e.basePath||"",this.length=this.items.length,this.items.forEach((s,r)=>{var a=this.manifest[s.idref],o;s.index=r,s.cfiBase=this.epubcfi.generateChapterComponent(this.spineNodeIndex,s.index,s.id),s.href&&(s.url=t(s.href,!0),s.canonical=i(s.href)),a&&(s.href=a.href,s.url=t(s.href,!0),s.canonical=i(s.href),a.properties.length&&s.properties.push.apply(s.properties,a.properties)),s.linear==="yes"?(s.prev=(function(){let l=s.index;for(;l>0;){let u=this.get(l-1);if(u&&u.linear)return u;l-=1}}).bind(this),s.next=(function(){let l=s.index;for(;l<this.spineItems.length-1;){let u=this.get(l+1);if(u&&u.linear)return u;l+=1}}).bind(this)):(s.prev=function(){},s.next=function(){}),o=new t$(s,this.hooks),this.append(o)}),this.loaded=!0}get(e){var t=0;if(typeof e>"u")for(;t<this.spineItems.length;){let i=this.spineItems[t];if(i&&i.linear)break;t+=1}else this.epubcfi.isCfiString(e)?t=new jt(e).spinePos:typeof e=="number"||isNaN(e)===!1?t=e:typeof e=="string"&&e.indexOf("#")===0?t=this.spineById[e.substring(1)]:typeof e=="string"&&(e=e.split("#")[0],t=this.spineByHref[e]||this.spineByHref[encodeURI(e)]);return this.spineItems[t]||null}append(e){var t=this.spineItems.length;return e.index=t,this.spineItems.push(e),this.spineByHref[decodeURI(e.href)]=t,this.spineByHref[encodeURI(e.href)]=t,this.spineByHref[e.href]=t,this.spineById[e.idref]=t,t}prepend(e){return this.spineByHref[e.href]=0,this.spineById[e.idref]=0,this.spineItems.forEach(function(t,i){t.index=i}),0}remove(e){var t=this.spineItems.indexOf(e);if(t>-1)return delete this.spineByHref[e.href],delete this.spineById[e.idref],this.spineItems.splice(t,1)}each(){return this.spineItems.forEach.apply(this.spineItems,arguments)}first(){let e=0;do{let t=this.get(e);if(t&&t.linear)return t;e+=1}while(e<this.spineItems.length)}last(){let e=this.spineItems.length-1;do{let t=this.get(e);if(t&&t.linear)return t;e-=1}while(e>=0)}destroy(){this.each(e=>e.destroy()),this.spineItems=void 0,this.spineByHref=void 0,this.spineById=void 0,this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.epubcfi=void 0,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}}class a_{constructor(e){this._q=[],this.context=e,this.tick=n_,this.running=!1,this.paused=!1}enqueue(){var e,t,i,s=[].shift.call(arguments),r=arguments;if(!s)throw new Error("No Task Provided");return typeof s=="function"?(e=new Dt,t=e.promise,i={task:s,args:r,deferred:e,promise:t}):i={promise:s},this._q.push(i),this.paused==!1&&!this.running&&this.run(),i.promise}dequeue(){var e,t,i;if(this._q.length&&!this.paused){if(e=this._q.shift(),t=e.task,t)return i=t.apply(this.context,e.args),i&&typeof i.then=="function"?i.then((function(){e.deferred.resolve.apply(this.context,arguments)}).bind(this),(function(){e.deferred.reject.apply(this.context,arguments)}).bind(this)):(e.deferred.resolve.apply(this.context,i),e.promise);if(e.promise)return e.promise}else return e=new Dt,e.deferred.resolve(),e.promise}dump(){for(;this._q.length;)this.dequeue()}run(){return this.running||(this.running=!0,this.defered=new Dt),this.tick.call(window,()=>{this._q.length?this.dequeue().then((function(){this.run()}).bind(this)):(this.defered.resolve(),this.running=void 0)}),this.paused==!0&&(this.paused=!1),this.defered.promise}flush(){if(this.running)return this.running;if(this._q.length)return this.running=this.dequeue().then((function(){return this.running=void 0,this.flush()}).bind(this)),this.running}clear(){this._q=[]}length(){return this._q.length}pause(){this.paused=!0}stop(){this._q=[],this.running=!1,this.paused=!0}}const nw="0.3",mx=["keydown","keyup","keypressed","mouseup","mousedown","mousemove","click","touchend","touchstart","touchmove"],$e={BOOK:{OPEN_FAILED:"openFailed"},CONTENTS:{EXPAND:"expand",RESIZE:"resize",SELECTED:"selected",SELECTED_RANGE:"selectedRange",LINK_CLICKED:"linkClicked"},LOCATIONS:{CHANGED:"changed"},MANAGERS:{RESIZE:"resize",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",ADDED:"added",SCROLL:"scroll",SCROLLED:"scrolled",REMOVED:"removed"},VIEWS:{AXIS:"axis",WRITING_MODE:"writingMode",LOAD_ERROR:"loaderror",RENDERED:"rendered",RESIZED:"resized",DISPLAYED:"displayed",SHOWN:"shown",HIDDEN:"hidden",MARK_CLICKED:"markClicked"},RENDITION:{STARTED:"started",ATTACHED:"attached",DISPLAYED:"displayed",DISPLAY_ERROR:"displayerror",RENDERED:"rendered",REMOVED:"removed",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",LOCATION_CHANGED:"locationChanged",RELOCATED:"relocated",MARK_CLICKED:"markClicked",SELECTED:"selected",LAYOUT:"layout"},LAYOUT:{UPDATED:"updated"},ANNOTATION:{ATTACH:"attach",DETACH:"detach"}};class y4{constructor(e,t,i){this.spine=e,this.request=t,this.pause=i||100,this.q=new a_(this),this.epubcfi=new jt,this._locations=[],this._locationsWords=[],this.total=0,this.break=150,this._current=0,this._wordCounter=0,this.currentLocation="",this._currentCfi="",this.processingTimeout=void 0}generate(e){return e&&(this.break=e),this.q.pause(),this.spine.each((function(t){t.linear&&this.q.enqueue(this.process.bind(this),t)}).bind(this)),this.q.run().then((function(){return this.total=this._locations.length-1,this._currentCfi&&(this.currentLocation=this._currentCfi),this._locations}).bind(this))}createRange(){return{startContainer:void 0,startOffset:void 0,endContainer:void 0,endOffset:void 0}}process(e){return e.load(this.request).then((function(t){var i=new Dt,s=this.parse(t,e.cfiBase);return this._locations=this._locations.concat(s),e.unload(),this.processingTimeout=setTimeout(()=>i.resolve(s),this.pause),i.promise}).bind(this))}parse(e,t,i){var s=[],r,a=e.ownerDocument,o=oi(a,"body"),l=0,u,d=i||this.break,f=function(p){var g=p.length,x,w=0;if(p.textContent.trim().length===0)return!1;for(l==0&&(r=this.createRange(),r.startContainer=p,r.startOffset=0),x=d-l,x>g&&(l+=g,w=g);w<g;)if(x=d-l,l===0&&(w+=1,r=this.createRange(),r.startContainer=p,r.startOffset=w),w+x>=g)l+=g-w,w=g;else{w+=x,r.endContainer=p,r.endOffset=w;let y=new jt(r,t).toString();s.push(y),l=0}u=p};if(Hb(o,f.bind(this)),r&&r.startContainer&&u){r.endContainer=u,r.endOffset=u.length;let p=new jt(r,t).toString();s.push(p),l=0}return s}generateFromWords(e,t,i){var s=e?new jt(e):void 0;return this.q.pause(),this._locationsWords=[],this._wordCounter=0,this.spine.each((function(r){r.linear&&(s?r.index>=s.spinePos&&this.q.enqueue(this.processWords.bind(this),r,t,s,i):this.q.enqueue(this.processWords.bind(this),r,t,s,i))}).bind(this)),this.q.run().then((function(){return this._currentCfi&&(this.currentLocation=this._currentCfi),this._locationsWords}).bind(this))}processWords(e,t,i,s){return s&&this._locationsWords.length>=s?Promise.resolve():e.load(this.request).then((function(r){var a=new Dt,o=this.parseWords(r,e,t,i),l=s-this._locationsWords.length;return this._locationsWords=this._locationsWords.concat(o.length>=s?o.slice(0,l):o),e.unload(),this.processingTimeout=setTimeout(()=>a.resolve(o),this.pause),a.promise}).bind(this))}countWords(e){return e=e.replace(/(^\s*)|(\s*$)/gi,""),e=e.replace(/[ ]{2,}/gi," "),e=e.replace(/\n /,`
`),e.split(" ").length}parseWords(e,t,i,s){var r=t.cfiBase,a=[],o=e.ownerDocument,l=oi(o,"body"),u=i,d=s?s.spinePos!==t.index:!0,f;s&&t.index===s.spinePos&&(f=s.findNode(s.range?s.path.steps.concat(s.start.steps):s.path.steps,e.ownerDocument));var p=function(g){if(!d)if(g===f)d=!0;else return!1;if(g.textContent.length<10&&g.textContent.trim().length===0)return!1;var x=this.countWords(g.textContent),w,y=0;if(x===0)return!1;for(w=u-this._wordCounter,w>x&&(this._wordCounter+=x,y=x);y<x;)if(w=u-this._wordCounter,y+w>=x)this._wordCounter+=x-y,y=x;else{y+=w;let m=new jt(g,r);a.push({cfi:m.toString(),wordCount:this._wordCounter}),this._wordCounter=0}};return Hb(l,p.bind(this)),a}locationFromCfi(e){let t;return jt.prototype.isCfiString(e)&&(e=new jt(e)),this._locations.length===0?-1:(t=eg(e,this._locations,this.epubcfi.compare),t>this.total?this.total:t)}percentageFromCfi(e){if(this._locations.length===0)return null;var t=this.locationFromCfi(e);return this.percentageFromLocation(t)}percentageFromLocation(e){return!e||!this.total?0:e/this.total}cfiFromLocation(e){var t=-1;return typeof e!="number"&&(e=parseInt(e)),e>=0&&e<this._locations.length&&(t=this._locations[e]),t}cfiFromPercentage(e){let t;if(e>1&&console.warn("Normalize cfiFromPercentage value to between 0 - 1"),e>=1){let i=new jt(this._locations[this.total]);return i.collapse(),i.toString()}return t=Math.ceil(this.total*e),this.cfiFromLocation(t)}load(e){return typeof e=="string"?this._locations=JSON.parse(e):this._locations=e,this.total=this._locations.length-1,this._locations}save(){return JSON.stringify(this._locations)}getCurrent(){return this._current}setCurrent(e){var t;if(typeof e=="string")this._currentCfi=e;else if(typeof e=="number")this._current=e;else return;this._locations.length!==0&&(typeof e=="string"?(t=this.locationFromCfi(e),this._current=t):t=e,this.emit($e.LOCATIONS.CHANGED,{percentage:this.percentageFromLocation(t)}))}get currentLocation(){return this._current}set currentLocation(e){this.setCurrent(e)}length(){return this._locations.length}destroy(){this.spine=void 0,this.request=void 0,this.pause=void 0,this.q.stop(),this.q=void 0,this.epubcfi=void 0,this._locations=void 0,this.total=void 0,this.break=void 0,this._current=void 0,this.currentLocation=void 0,this._currentCfi=void 0,clearTimeout(this.processingTimeout)}}ro(y4.prototype);class n${constructor(e){this.packagePath="",this.directory="",this.encoding="",e&&this.parse(e)}parse(e){var t;if(!e)throw new Error("Container File Not Found");if(t=oi(e,"rootfile"),!t)throw new Error("No RootFile Found");this.packagePath=t.getAttribute("full-path"),this.directory=Bc.dirname(this.packagePath),this.encoding=e.xmlEncoding}destroy(){this.packagePath=void 0,this.directory=void 0,this.encoding=void 0}}class ST{constructor(e){this.manifest={},this.navPath="",this.ncxPath="",this.coverPath="",this.spineNodeIndex=0,this.spine=[],this.metadata={},e&&this.parse(e)}parse(e){var t,i,s;if(!e)throw new Error("Package File Not Found");if(t=oi(e,"metadata"),!t)throw new Error("No Metadata Found");if(i=oi(e,"manifest"),!i)throw new Error("No Manifest Found");if(s=oi(e,"spine"),!s)throw new Error("No Spine Found");return this.manifest=this.parseManifest(i),this.navPath=this.findNavPath(i),this.ncxPath=this.findNcxPath(i,s),this.coverPath=this.findCoverPath(e),this.spineNodeIndex=l4(s),this.spine=this.parseSpine(s,this.manifest),this.uniqueIdentifier=this.findUniqueIdentifier(e),this.metadata=this.parseMetadata(t),this.metadata.direction=s.getAttribute("page-progression-direction"),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex}}parseMetadata(e){var t={};return t.title=this.getElementText(e,"title"),t.creator=this.getElementText(e,"creator"),t.description=this.getElementText(e,"description"),t.pubdate=this.getElementText(e,"date"),t.publisher=this.getElementText(e,"publisher"),t.identifier=this.getElementText(e,"identifier"),t.language=this.getElementText(e,"language"),t.rights=this.getElementText(e,"rights"),t.modified_date=this.getPropertyText(e,"dcterms:modified"),t.layout=this.getPropertyText(e,"rendition:layout"),t.orientation=this.getPropertyText(e,"rendition:orientation"),t.flow=this.getPropertyText(e,"rendition:flow"),t.viewport=this.getPropertyText(e,"rendition:viewport"),t.media_active_class=this.getPropertyText(e,"media:active-class"),t.spread=this.getPropertyText(e,"rendition:spread"),t}parseManifest(e){var t={},i=Al(e,"item"),s=Array.prototype.slice.call(i);return s.forEach(function(r){var a=r.getAttribute("id"),o=r.getAttribute("href")||"",l=r.getAttribute("media-type")||"",u=r.getAttribute("media-overlay")||"",d=r.getAttribute("properties")||"";t[a]={href:o,type:l,overlay:u,properties:d.length?d.split(" "):[]}}),t}parseSpine(e,t){var i=[],s=Al(e,"itemref"),r=Array.prototype.slice.call(s);return r.forEach(function(a,o){var l=a.getAttribute("idref"),u=a.getAttribute("properties")||"",d=u.length?u.split(" "):[],f={id:a.getAttribute("id"),idref:l,linear:a.getAttribute("linear")||"yes",properties:d,index:o};i.push(f)}),i}findUniqueIdentifier(e){var t=e.documentElement.getAttribute("unique-identifier");if(!t)return"";var i=e.getElementById(t);return i&&i.localName==="identifier"&&i.namespaceURI==="http://purl.org/dc/elements/1.1/"&&i.childNodes.length>0?i.childNodes[0].nodeValue.trim():""}findNavPath(e){var t=_d(e,"item",{properties:"nav"});return t?t.getAttribute("href"):!1}findNcxPath(e,t){var i=_d(e,"item",{"media-type":"application/x-dtbncx+xml"}),s;return i||(s=t.getAttribute("toc"),s&&(i=e.querySelector(`#${s}`))),i?i.getAttribute("href"):!1}findCoverPath(e){var t=oi(e,"package");t.getAttribute("version");var i=_d(e,"item",{properties:"cover-image"});if(i)return i.getAttribute("href");var s=_d(e,"meta",{name:"cover"});if(s){var r=s.getAttribute("content"),a=e.getElementById(r);return a?a.getAttribute("href"):""}else return!1}getElementText(e,t){var i=e.getElementsByTagNameNS("http://purl.org/dc/elements/1.1/",t),s;return!i||i.length===0?"":(s=i[0],s.childNodes.length?s.childNodes[0].nodeValue:"")}getPropertyText(e,t){var i=_d(e,"meta",{property:t});return i&&i.childNodes.length?i.childNodes[0].nodeValue:""}load(e){this.metadata=e.metadata;let t=e.readingOrder||e.spine;return this.spine=t.map((i,s)=>(i.index=s,i.linear=i.linear||"yes",i)),e.resources.forEach((i,s)=>{this.manifest[s]=i,i.rel&&i.rel[0]==="cover"&&(this.coverPath=i.href)}),this.spineNodeIndex=0,this.toc=e.toc.map((i,s)=>(i.label=i.title,i)),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex,toc:this.toc}}destroy(){this.manifest=void 0,this.navPath=void 0,this.ncxPath=void 0,this.coverPath=void 0,this.spineNodeIndex=void 0,this.spine=void 0,this.metadata=void 0}}class A2{constructor(e){this.toc=[],this.tocByHref={},this.tocById={},this.landmarks=[],this.landmarksByType={},this.length=0,e&&this.parse(e)}parse(e){let t=e.nodeType,i,s;t&&(i=oi(e,"html"),s=oi(e,"ncx")),t?i?(this.toc=this.parseNav(e),this.landmarks=this.parseLandmarks(e)):s&&(this.toc=this.parseNcx(e)):this.toc=this.load(e),this.length=0,this.unpack(this.toc)}unpack(e){for(var t,i=0;i<e.length;i++)t=e[i],t.href&&(this.tocByHref[t.href]=i),t.id&&(this.tocById[t.id]=i),this.length++,t.subitems.length&&this.unpack(t.subitems)}get(e){var t;return e?(e.indexOf("#")===0?t=this.tocById[e.substring(1)]:e in this.tocByHref&&(t=this.tocByHref[e]),this.getByIndex(e,t,this.toc)):this.toc}getByIndex(e,t,i){if(i.length===0)return;const s=i[t];if(s&&(e===s.id||e===s.href))return s;{let r;for(let a=0;a<i.length&&(r=this.getByIndex(e,t,i[a].subitems),!r);++a);return r}}landmark(e){var t;return e?(t=this.landmarksByType[e],this.landmarks[t]):this.landmarks}parseNav(e){var t=$b(e,"nav","toc"),i=[];if(!t)return i;let s=Nd(t,"ol",!0);return s&&(i=this.parseNavList(s)),i}parseNavList(e,t){const i=[];if(!e||!e.children)return i;for(let s=0;s<e.children.length;s++){const r=this.navItem(e.children[s],t);r&&i.push(r)}return i}navItem(e,t){let i=e.getAttribute("id")||void 0,s=Nd(e,"a",!0)||Nd(e,"span",!0);if(!s)return;let r=s.getAttribute("href")||"";i||(i=r);let a=s.textContent||"",o=[],l=Nd(e,"ol",!0);return l&&(o=this.parseNavList(l,i)),{id:i,href:r,label:a,subitems:o,parent:t}}parseLandmarks(e){var t=$b(e,"nav","landmarks"),i=t?Al(t,"li"):[],s=i.length,r,a=[],o;if(!i||s===0)return a;for(r=0;r<s;++r)o=this.landmarkItem(i[r]),o&&(a.push(o),this.landmarksByType[o.type]=r);return a}landmarkItem(e){let t=Nd(e,"a",!0);if(!t)return;let i=t.getAttributeNS("http://www.idpf.org/2007/ops","type")||void 0,s=t.getAttribute("href")||"",r=t.textContent||"";return{href:s,label:r,type:i}}parseNcx(e){var t=Al(e,"navPoint"),i=t.length,s,r={},a=[],o,l;if(!t||i===0)return a;for(s=0;s<i;++s)o=this.ncxItem(t[s]),r[o.id]=o,o.parent?(l=r[o.parent],l.subitems.push(o)):a.push(o);return a}ncxItem(e){var t=e.getAttribute("id")||!1,i=oi(e,"content"),s=i.getAttribute("src"),r=oi(e,"navLabel"),a=r.textContent?r.textContent:"",o=[],l=e.parentNode,u;return l&&(l.nodeName==="navPoint"||l.nodeName.split(":").slice(-1)[0]==="navPoint")&&(u=l.getAttribute("id")),{id:t,href:s,label:a,subitems:o,parent:u}}load(e){return e.map(t=>(t.label=t.title,t.subitems=t.children?this.load(t.children):[],t))}forEach(e){return this.toc.forEach(e)}}var Ng={application:{ecmascript:["es","ecma"],javascript:"js",ogg:"ogx",pdf:"pdf",postscript:["ps","ai","eps","epsi","epsf","eps2","eps3"],"rdf+xml":"rdf",smil:["smi","smil"],"xhtml+xml":["xhtml","xht"],xml:["xml","xsl","xsd","opf","ncx"],zip:"zip","x-httpd-eruby":"rhtml","x-latex":"latex","x-maker":["frm","maker","frame","fm","fb","book","fbdoc"],"x-object":"o","x-shockwave-flash":["swf","swfl"],"x-silverlight":"scr","epub+zip":"epub","font-tdpfr":"pfr","inkml+xml":["ink","inkml"],json:"json","jsonml+json":"jsonml","mathml+xml":"mathml","metalink+xml":"metalink",mp4:"mp4s","omdoc+xml":"omdoc",oxps:"oxps","vnd.amazon.ebook":"azw",widget:"wgt","x-dtbook+xml":"dtb","x-dtbresource+xml":"res","x-font-bdf":"bdf","x-font-ghostscript":"gsf","x-font-linux-psf":"psf","x-font-otf":"otf","x-font-pcf":"pcf","x-font-snf":"snf","x-font-ttf":["ttf","ttc"],"x-font-type1":["pfa","pfb","pfm","afm"],"x-font-woff":"woff","x-mobipocket-ebook":["prc","mobi"],"x-mspublisher":"pub","x-nzb":"nzb","x-tgif":"obj","xaml+xml":"xaml","xml-dtd":"dtd","xproc+xml":"xpl","xslt+xml":"xslt","internet-property-stream":"acx","x-compress":"z","x-compressed":"tgz","x-gzip":"gz"},audio:{flac:"flac",midi:["mid","midi","kar","rmi"],mpeg:["mpga","mpega","mp2","mp3","m4a","mp2a","m2a","m3a"],mpegurl:"m3u",ogg:["oga","ogg","spx"],"x-aiff":["aif","aiff","aifc"],"x-ms-wma":"wma","x-wav":"wav",adpcm:"adp",mp4:"mp4a",webm:"weba","x-aac":"aac","x-caf":"caf","x-matroska":"mka","x-pn-realaudio-plugin":"rmp",xm:"xm",mid:["mid","rmi"]},image:{gif:"gif",ief:"ief",jpeg:["jpeg","jpg","jpe"],pcx:"pcx",png:"png","svg+xml":["svg","svgz"],tiff:["tiff","tif"],"x-icon":"ico",bmp:"bmp",webp:"webp","x-pict":["pic","pct"],"x-tga":"tga","cis-cod":"cod"},text:{"cache-manifest":["manifest","appcache"],css:"css",csv:"csv",html:["html","htm","shtml","stm"],mathml:"mml",plain:["txt","text","brf","conf","def","list","log","in","bas"],richtext:"rtx","tab-separated-values":"tsv","x-bibtex":"bib"},video:{mpeg:["mpeg","mpg","mpe","m1v","m2v","mp2","mpa","mpv2"],mp4:["mp4","mp4v","mpg4"],quicktime:["qt","mov"],ogg:"ogv","vnd.mpegurl":["mxu","m4u"],"x-flv":"flv","x-la-asf":["lsf","lsx"],"x-mng":"mng","x-ms-asf":["asf","asx","asr"],"x-ms-wm":"wm","x-ms-wmv":"wmv","x-ms-wmx":"wmx","x-ms-wvx":"wvx","x-msvideo":"avi","x-sgi-movie":"movie","x-matroska":["mpv","mkv","mk3d","mks"],"3gpp2":"3g2",h261:"h261",h263:"h263",h264:"h264",jpeg:"jpgv",jpm:["jpm","jpgm"],mj2:["mj2","mjp2"],"vnd.ms-playready.media.pyv":"pyv","vnd.uvvu.mp4":["uvu","uvvu"],"vnd.vivo":"viv",webm:"webm","x-f4v":"f4v","x-m4v":"m4v","x-ms-vob":"vob","x-smv":"smv"}},s$=function(){var n,e,t,i,s={};for(n in Ng)if(Ng.hasOwnProperty(n)){for(e in Ng[n])if(Ng[n].hasOwnProperty(e))if(t=Ng[n][e],typeof t=="string")s[t]=n+"/"+e;else for(i=0;i<t.length;i++)s[t[i]]=n+"/"+e}return s}(),r$="text/plain";function a$(n){return n&&s$[n.split(".").pop().toLowerCase()]||r$}const cf={lookup:a$};class o${constructor(e,t){this.settings={replacements:t&&t.replacements||"base64",archive:t&&t.archive,resolver:t&&t.resolver,request:t&&t.request},this.process(e)}process(e){this.manifest=e,this.resources=Object.keys(e).map(function(t){return e[t]}),this.replacementUrls=[],this.html=[],this.assets=[],this.css=[],this.urls=[],this.cssUrls=[],this.split(),this.splitUrls()}split(){this.html=this.resources.filter(function(e){if(e.type==="application/xhtml+xml"||e.type==="text/html")return!0}),this.assets=this.resources.filter(function(e){if(e.type!=="application/xhtml+xml"&&e.type!=="text/html")return!0}),this.css=this.resources.filter(function(e){if(e.type==="text/css")return!0})}splitUrls(){this.urls=this.assets.map((function(e){return e.href}).bind(this)),this.cssUrls=this.css.map(function(e){return e.href})}createUrl(e){var t=new Jr(e),i=cf.lookup(t.filename);return this.settings.archive?this.settings.archive.createUrl(e,{base64:this.settings.replacements==="base64"}):this.settings.replacements==="base64"?this.settings.request(e,"blob").then(s=>f4(s)).then(s=>QS(s,i)):this.settings.request(e,"blob").then(s=>Ub(s,i))}replacements(){if(this.settings.replacements==="none")return new Promise((function(t){t(this.urls)}).bind(this));var e=this.urls.map(t=>{var i=this.settings.resolver(t);return this.createUrl(i).catch(s=>(console.error(s),null))});return Promise.all(e).then(t=>(this.replacementUrls=t.filter(i=>typeof i=="string"),t))}replaceCss(e,t){var i=[];return e=e||this.settings.archive,t=t||this.settings.resolver,this.cssUrls.forEach((function(s){var r=this.createCssFile(s,e,t).then((function(a){var o=this.urls.indexOf(s);o>-1&&(this.replacementUrls[o]=a)}).bind(this));i.push(r)}).bind(this)),Promise.all(i)}createCssFile(e){var t;if(Bc.isAbsolute(e))return new Promise(function(a){a()});var i=this.settings.resolver(e),s;this.settings.archive?s=this.settings.archive.getText(i):s=this.settings.request(i,"text");var r=this.urls.map(a=>{var o=this.settings.resolver(a),l=new El(i).relative(o);return l});return s?s.then(a=>(a=wT(a,r,this.replacementUrls),this.settings.replacements==="base64"?t=QS(a,"text/css"):t=Ub(a,"text/css"),t),a=>new Promise(function(o){o()})):new Promise(function(a){a()})}relativeTo(e,t){return t=t||this.settings.resolver,this.urls.map((function(i){var s=t(i),r=new El(e).relative(s);return r}).bind(this))}get(e){var t=this.urls.indexOf(e);if(t!==-1)return this.replacementUrls.length?new Promise((function(i,s){i(this.replacementUrls[t])}).bind(this)):this.createUrl(e)}substitute(e,t){var i;return t?i=this.relativeTo(t):i=this.urls,wT(e,i,this.replacementUrls)}destroy(){this.settings=void 0,this.manifest=void 0,this.resources=void 0,this.replacementUrls=void 0,this.html=void 0,this.assets=void 0,this.css=void 0,this.urls=void 0,this.cssUrls=void 0}}class E2{constructor(e){this.pages=[],this.locations=[],this.epubcfi=new jt,this.firstPage=0,this.lastPage=0,this.totalPages=0,this.toc=void 0,this.ncx=void 0,e&&(this.pageList=this.parse(e)),this.pageList&&this.pageList.length&&this.process(this.pageList)}parse(e){var t=oi(e,"html"),i=oi(e,"ncx");if(t)return this.parseNav(e);if(i)return this.parseNcx(e)}parseNav(e){var t=$b(e,"nav","page-list"),i=t?Al(t,"li"):[],s=i.length,r,a=[],o;if(!i||s===0)return a;for(r=0;r<s;++r)o=this.item(i[r]),a.push(o);return a}parseNcx(e){var t=[],i=0,s,r,a,o=0;if(r=oi(e,"pageList"),!r||(a=Al(r,"pageTarget"),o=a.length,!a||a.length===0))return t;for(i=0;i<o;++i)s=this.ncxItem(a[i]),t.push(s);return t}ncxItem(e){var t=oi(e,"navLabel"),i=oi(t,"text"),s=i.textContent,r=oi(e,"content"),a=r.getAttribute("src"),o=parseInt(s,10);return{href:a,page:o}}item(e){var t=oi(e,"a"),i=t.getAttribute("href")||"",s=t.textContent||"",r=parseInt(s),a=i.indexOf("epubcfi"),o,l,u;return a!=-1?(o=i.split("#"),l=o[0],u=o.length>1?o[1]:!1,{cfi:u,href:i,packageUrl:l,page:r}):{href:i,page:r}}process(e){e.forEach(function(t){this.pages.push(t.page),t.cfi&&this.locations.push(t.cfi)},this),this.firstPage=parseInt(this.pages[0]),this.lastPage=parseInt(this.pages[this.pages.length-1]),this.totalPages=this.lastPage-this.firstPage}pageFromCfi(e){var t=-1;if(this.locations.length===0)return-1;var i=Bb(e,this.locations,this.epubcfi.compare);return i!=-1?t=this.pages[i]:(i=eg(e,this.locations,this.epubcfi.compare),t=i-1>=0?this.pages[i-1]:this.pages[0],t!==void 0||(t=-1)),t}cfiFromPage(e){var t=-1;typeof e!="number"&&(e=parseInt(e));var i=this.pages.indexOf(e);return i!=-1&&(t=this.locations[i]),t}pageFromPercentage(e){var t=Math.round(this.totalPages*e);return t}percentageFromPage(e){var t=(e-this.firstPage)/this.totalPages;return Math.round(t*1e3)/1e3}percentageFromCfi(e){var t=this.pageFromCfi(e),i=this.percentageFromPage(t);return i}destroy(){this.pages=void 0,this.locations=void 0,this.epubcfi=void 0,this.pageList=void 0,this.toc=void 0,this.ncx=void 0}}class v4{constructor(e){this.settings=e,this.name=e.layout||"reflowable",this._spread=e.spread!=="none",this._minSpreadWidth=e.minSpreadWidth||800,this._evenSpreads=e.evenSpreads||!1,e.flow==="scrolled"||e.flow==="scrolled-continuous"||e.flow==="scrolled-doc"?this._flow="scrolled":this._flow="paginated",this.width=0,this.height=0,this.spreadWidth=0,this.delta=0,this.columnWidth=0,this.gap=0,this.divisor=1,this.props={name:this.name,spread:this._spread,flow:this._flow,width:0,height:0,spreadWidth:0,delta:0,columnWidth:0,gap:0,divisor:1}}flow(e){return typeof e<"u"&&(e==="scrolled"||e==="scrolled-continuous"||e==="scrolled-doc"?this._flow="scrolled":this._flow="paginated",this.update({flow:this._flow})),this._flow}spread(e,t){return e&&(this._spread=e!=="none",this.update({spread:this._spread})),t>=0&&(this._minSpreadWidth=t),this._spread}calculate(e,t,i){var s=1,r=i||0,a=e,o=t,l=Math.floor(a/12),u,d,f,p;this._spread&&a>=this._minSpreadWidth?s=2:s=1,this.name==="reflowable"&&this._flow==="paginated"&&!(i>=0)&&(r=l%2===0?l:l-1),this.name==="pre-paginated"&&(r=0),s>1?(u=a/s-r,f=u+r):(u=a,f=a),this.name==="pre-paginated"&&s>1&&(a=u),d=u*s+r,p=a,this.width=a,this.height=o,this.spreadWidth=d,this.pageWidth=f,this.delta=p,this.columnWidth=u,this.gap=r,this.divisor=s,this.update({width:a,height:o,spreadWidth:d,pageWidth:f,delta:p,columnWidth:u,gap:r,divisor:s})}format(e,t,i){var s;return this.name==="pre-paginated"?s=e.fit(this.columnWidth,this.height,t):this._flow==="paginated"?s=e.columns(this.width,this.height,this.columnWidth,this.gap,this.settings.direction):i&&i==="horizontal"?s=e.size(null,this.height):s=e.size(this.width,null),s}count(e,t){let i,s;return this.name==="pre-paginated"?(i=1,s=1):this._flow==="paginated"?(t=t||this.delta,i=Math.ceil(e/t),s=i*this.divisor):(t=t||this.height,i=Math.ceil(e/t),s=i),{spreads:i,pages:s}}update(e){if(Object.keys(e).forEach(t=>{this.props[t]===e[t]&&delete e[t]}),Object.keys(e).length>0){let t=Bn(this.props,e);this.emit($e.LAYOUT.UPDATED,t,e)}}}ro(v4.prototype);class l${constructor(e){this.rendition=e,this._themes={default:{rules:{},url:"",serialized:""}},this._overrides={},this._current="default",this._injected=[],this.rendition.hooks.content.register(this.inject.bind(this)),this.rendition.hooks.content.register(this.overrides.bind(this))}register(){if(arguments.length!==0){if(arguments.length===1&&typeof arguments[0]=="object")return this.registerThemes(arguments[0]);if(arguments.length===1&&typeof arguments[0]=="string")return this.default(arguments[0]);if(arguments.length===2&&typeof arguments[1]=="string")return this.registerUrl(arguments[0],arguments[1]);if(arguments.length===2&&typeof arguments[1]=="object")return this.registerRules(arguments[0],arguments[1])}}default(e){if(e){if(typeof e=="string")return this.registerUrl("default",e);if(typeof e=="object")return this.registerRules("default",e)}}registerThemes(e){for(var t in e)e.hasOwnProperty(t)&&(typeof e[t]=="string"?this.registerUrl(t,e[t]):this.registerRules(t,e[t]))}registerCss(e,t){this._themes[e]={serialized:t},(this._injected[e]||e=="default")&&this.update(e)}registerUrl(e,t){var i=new Jr(t);this._themes[e]={url:i.toString()},(this._injected[e]||e=="default")&&this.update(e)}registerRules(e,t){this._themes[e]={rules:t},(this._injected[e]||e=="default")&&this.update(e)}select(e){var t=this._current,i;this._current=e,this.update(e),i=this.rendition.getContents(),i.forEach(s=>{s.removeClass(t),s.addClass(e)})}update(e){var t=this.rendition.getContents();t.forEach(i=>{this.add(e,i)})}inject(e){var t=[],i=this._themes,s;for(var r in i)i.hasOwnProperty(r)&&(r===this._current||r==="default")&&(s=i[r],(s.rules&&Object.keys(s.rules).length>0||s.url&&t.indexOf(s.url)===-1)&&this.add(r,e),this._injected.push(r));this._current!="default"&&e.addClass(this._current)}add(e,t){var i=this._themes[e];!i||!t||(i.url?t.addStylesheet(i.url):i.serialized?(t.addStylesheetCss(i.serialized,e),i.injected=!0):i.rules&&(t.addStylesheetRules(i.rules,e),i.injected=!0))}override(e,t,i){var s=this.rendition.getContents();this._overrides[e]={value:t,priority:i===!0},s.forEach(r=>{r.css(e,this._overrides[e].value,this._overrides[e].priority)})}removeOverride(e){var t=this.rendition.getContents();delete this._overrides[e],t.forEach(i=>{i.css(e)})}overrides(e){var t=this._overrides;for(var i in t)t.hasOwnProperty(i)&&e.css(i,t[i].value,t[i].priority)}fontSize(e){this.override("font-size",e)}font(e){this.override("font-family",e,!0)}destroy(){this.rendition=void 0,this._themes=void 0,this._overrides=void 0,this._current=void 0,this._injected=void 0}}class qb{constructor(e,t,i,s=!1){this.layout=e,this.horizontal=i==="horizontal",this.direction=t||"ltr",this._dev=s}section(e){var t=this.findRanges(e),i=this.rangeListToCfiList(e.section.cfiBase,t);return i}page(e,t,i,s){var r=e&&e.document?e.document.body:!1,a;if(r){if(a=this.rangePairToCfiPair(t,{start:this.findStart(r,i,s),end:this.findEnd(r,i,s)}),this._dev===!0){let o=e.document,l=new jt(a.start).toRange(o),u=new jt(a.end).toRange(o),d=o.defaultView.getSelection(),f=o.createRange();d.removeAllRanges(),f.setStart(l.startContainer,l.startOffset),f.setEnd(u.endContainer,u.endOffset),d.addRange(f)}return a}}walk(e,t){if(!(e&&e.nodeType===Node.TEXT_NODE)){var i={acceptNode:function(l){return l.data.trim().length>0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}},s=i.acceptNode;s.acceptNode=i.acceptNode;for(var r=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,s,!1),a,o;(a=r.nextNode())&&(o=t(a),!o););return o}}findRanges(e){for(var t=[],i=e.contents.scrollWidth(),s=Math.ceil(i/this.layout.spreadWidth),r=s*this.layout.divisor,a=this.layout.columnWidth,o=this.layout.gap,l,u,d=0;d<r.pages;d++)l=(a+o)*d,u=a*(d+1)+o*d,t.push({start:this.findStart(e.document.body,l,u),end:this.findEnd(e.document.body,l,u)});return t}findStart(e,t,i){for(var s=[e],r,a,o=e;s.length;)if(r=s.shift(),a=this.walk(r,l=>{var u,d,f,p,g;if(g=ZS(l),this.horizontal&&this.direction==="ltr"){if(u=this.horizontal?g.left:g.top,d=this.horizontal?g.right:g.bottom,u>=t&&u<=i)return l;if(d>t)return l;o=l,s.push(l)}else if(this.horizontal&&this.direction==="rtl"){if(u=g.left,d=g.right,d<=i&&d>=t)return l;if(u<i)return l;o=l,s.push(l)}else{if(f=g.top,p=g.bottom,f>=t&&f<=i)return l;if(p>t)return l;o=l,s.push(l)}}),a)return this.findTextStartRange(a,t,i);return this.findTextStartRange(o,t,i)}findEnd(e,t,i){for(var s=[e],r,a=e,o;s.length;)if(r=s.shift(),o=this.walk(r,l=>{var u,d,f,p,g;if(g=ZS(l),this.horizontal&&this.direction==="ltr"){if(u=Math.round(g.left),d=Math.round(g.right),u>i&&a)return a;if(d>i)return l;a=l,s.push(l)}else if(this.horizontal&&this.direction==="rtl"){if(u=Math.round(this.horizontal?g.left:g.top),d=Math.round(this.horizontal?g.right:g.bottom),d<t&&a)return a;if(u<t)return l;a=l,s.push(l)}else{if(f=Math.round(g.top),p=Math.round(g.bottom),f>i&&a)return a;if(p>i)return l;a=l,s.push(l)}}),o)return this.findTextEndRange(o,t,i);return this.findTextEndRange(a,t,i)}findTextStartRange(e,t,i){for(var s=this.splitTextNodeIntoRanges(e),r,a,o,l,u,d=0;d<s.length;d++)if(r=s[d],a=r.getBoundingClientRect(),this.horizontal&&this.direction==="ltr"){if(o=a.left,o>=t)return r}else if(this.horizontal&&this.direction==="rtl"){if(u=a.right,u<=i)return r}else if(l=a.top,l>=t)return r;return s[0]}findTextEndRange(e,t,i){for(var s=this.splitTextNodeIntoRanges(e),r,a,o,l,u,d,f,p=0;p<s.length;p++){if(a=s[p],o=a.getBoundingClientRect(),this.horizontal&&this.direction==="ltr"){if(l=o.left,u=o.right,l>i&&r)return r;if(u>i)return a}else if(this.horizontal&&this.direction==="rtl"){if(l=o.left,u=o.right,u<t&&r)return r;if(l<t)return a}else{if(d=o.top,f=o.bottom,d>i&&r)return r;if(f>i)return a}r=a}return s[s.length-1]}splitTextNodeIntoRanges(e,t){var i=[],s=e.textContent||"",r=s.trim(),a,o=e.ownerDocument,l=t||" ",u=r.indexOf(l);if(u===-1||e.nodeType!=Node.TEXT_NODE)return a=o.createRange(),a.selectNodeContents(e),[a];for(a=o.createRange(),a.setStart(e,0),a.setEnd(e,u),i.push(a),a=!1;u!=-1;)u=r.indexOf(l,u+1),u>0&&(a&&(a.setEnd(e,u),i.push(a)),a=o.createRange(),a.setStart(e,u+1));return a&&(a.setEnd(e,r.length),i.push(a)),i}rangePairToCfiPair(e,t){var i=t.start,s=t.end;i.collapse(!0),s.collapse(!1);let r=new jt(i,e).toString(),a=new jt(s,e).toString();return{start:r,end:a}}rangeListToCfiList(e,t){for(var i=[],s,r=0;r<t.length;r++)s=this.rangePairToCfiPair(e,t[r]),i.push(s);return i}axis(e){return e&&(this.horizontal=e==="horizontal"),this.horizontal}}const x4=typeof navigator<"u",c$=x4&&/Chrome/.test(navigator.userAgent),AT=x4&&!c$&&/AppleWebKit/.test(navigator.userAgent),u$=1;class o_{constructor(e,t,i,s){this.epubcfi=new jt,this.document=e,this.documentElement=this.document.documentElement,this.content=t||this.document.body,this.window=this.document.defaultView,this._size={width:0,height:0},this.sectionIndex=s||0,this.cfiBase=i||"",this.epubReadingSystem("epub.js",nw),this.called=0,this.active=!0,this.listeners()}static get listenedEvents(){return mx}width(e){var t=this.content;return e&&Li(e)&&(e=e+"px"),e&&(t.style.width=e),parseInt(this.window.getComputedStyle(t).width)}height(e){var t=this.content;return e&&Li(e)&&(e=e+"px"),e&&(t.style.height=e),parseInt(this.window.getComputedStyle(t).height)}contentWidth(e){var t=this.content||this.document.body;return e&&Li(e)&&(e=e+"px"),e&&(t.style.width=e),parseInt(this.window.getComputedStyle(t).width)}contentHeight(e){var t=this.content||this.document.body;return e&&Li(e)&&(e=e+"px"),e&&(t.style.height=e),parseInt(this.window.getComputedStyle(t).height)}textWidth(){let e,t,i=this.document.createRange(),s=this.content||this.document.body,r=Fb(s);return i.selectNodeContents(s),e=i.getBoundingClientRect(),t=e.width,r&&r.width&&(t+=r.width),Math.round(t)}textHeight(){let e,t,i=this.document.createRange(),s=this.content||this.document.body;return i.selectNodeContents(s),e=i.getBoundingClientRect(),t=e.bottom,Math.round(t)}scrollWidth(){var e=this.documentElement.scrollWidth;return e}scrollHeight(){var e=this.documentElement.scrollHeight;return e}overflow(e){return e&&(this.documentElement.style.overflow=e),this.window.getComputedStyle(this.documentElement).overflow}overflowX(e){return e&&(this.documentElement.style.overflowX=e),this.window.getComputedStyle(this.documentElement).overflowX}overflowY(e){return e&&(this.documentElement.style.overflowY=e),this.window.getComputedStyle(this.documentElement).overflowY}css(e,t,i){var s=this.content||this.document.body;return t?s.style.setProperty(e,t,i?"important":""):s.style.removeProperty(e),this.window.getComputedStyle(s)[e]}viewport(e){var t=this.document.querySelector("meta[name='viewport']"),i={width:void 0,height:void 0,scale:void 0,minimum:void 0,maximum:void 0,scalable:void 0},s=[],r={};if(t&&t.hasAttribute("content")){let a=t.getAttribute("content"),o=a.match(/width\s*=\s*([^,]*)/),l=a.match(/height\s*=\s*([^,]*)/),u=a.match(/initial-scale\s*=\s*([^,]*)/),d=a.match(/minimum-scale\s*=\s*([^,]*)/),f=a.match(/maximum-scale\s*=\s*([^,]*)/),p=a.match(/user-scalable\s*=\s*([^,]*)/);o&&o.length&&typeof o[1]<"u"&&(i.width=o[1]),l&&l.length&&typeof l[1]<"u"&&(i.height=l[1]),u&&u.length&&typeof u[1]<"u"&&(i.scale=u[1]),d&&d.length&&typeof d[1]<"u"&&(i.minimum=d[1]),f&&f.length&&typeof f[1]<"u"&&(i.maximum=f[1]),p&&p.length&&typeof p[1]<"u"&&(i.scalable=p[1])}return r=o4(e||{},i),e&&(r.width&&s.push("width="+r.width),r.height&&s.push("height="+r.height),r.scale&&s.push("initial-scale="+r.scale),r.scalable==="no"?(s.push("minimum-scale="+r.scale),s.push("maximum-scale="+r.scale),s.push("user-scalable="+r.scalable)):(r.scalable&&s.push("user-scalable="+r.scalable),r.minimum&&s.push("minimum-scale="+r.minimum),r.maximum&&s.push("minimum-scale="+r.maximum)),t||(t=this.document.createElement("meta"),t.setAttribute("name","viewport"),this.document.querySelector("head").appendChild(t)),t.setAttribute("content",s.join(", ")),this.window.scrollTo(0,0)),r}expand(){this.emit($e.CONTENTS.EXPAND)}listeners(){this.imageLoadListeners(),this.mediaQueryListeners(),this.addEventListeners(),this.addSelectionListeners(),typeof ResizeObserver>"u"?(this.resizeListeners(),this.visibilityListeners()):this.resizeObservers(),this.linksHandler()}removeListeners(){this.removeEventListeners(),this.removeSelectionListeners(),this.observer&&this.observer.disconnect(),clearTimeout(this.expanding)}resizeCheck(){let e=this.textWidth(),t=this.textHeight();(e!=this._size.width||t!=this._size.height)&&(this._size={width:e,height:t},this.onResize&&this.onResize(this._size),this.emit($e.CONTENTS.RESIZE,this._size))}resizeListeners(){clearTimeout(this.expanding),requestAnimationFrame(this.resizeCheck.bind(this)),this.expanding=setTimeout(this.resizeListeners.bind(this),350)}visibilityListeners(){document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&this.active===!1?(this.active=!0,this.resizeListeners()):(this.active=!1,clearTimeout(this.expanding))})}transitionListeners(){let e=this.content;e.style.transitionProperty="font, font-size, font-size-adjust, font-stretch, font-variation-settings, font-weight, width, height",e.style.transitionDuration="0.001ms",e.style.transitionTimingFunction="linear",e.style.transitionDelay="0",this._resizeCheck=this.resizeCheck.bind(this),this.document.addEventListener("transitionend",this._resizeCheck)}mediaQueryListeners(){for(var e=this.document.styleSheets,t=(function(o){o.matches&&!this._expanding&&setTimeout(this.expand.bind(this),1)}).bind(this),i=0;i<e.length;i+=1){var s;try{s=e[i].cssRules}catch{return}if(!s)return;for(var r=0;r<s.length;r+=1)if(s[r].media){var a=this.window.matchMedia(s[r].media.mediaText);a.addListener(t)}}}resizeObservers(){this.observer=new ResizeObserver(e=>{requestAnimationFrame(this.resizeCheck.bind(this))}),this.observer.observe(this.document.documentElement)}mutationObservers(){this.observer=new MutationObserver(t=>{this.resizeCheck()});let e={attributes:!0,childList:!0,characterData:!0,subtree:!0};this.observer.observe(this.document,e)}imageLoadListeners(){for(var e=this.document.querySelectorAll("img"),t,i=0;i<e.length;i++)t=e[i],typeof t.naturalWidth<"u"&&t.naturalWidth===0&&(t.onload=this.expand.bind(this))}fontLoadListeners(){!this.document||!this.document.fonts||this.document.fonts.ready.then((function(){this.resizeCheck()}).bind(this))}root(){return this.document?this.document.documentElement:null}locationOf(e,t){var i,s={left:0,top:0};if(!this.document)return s;if(this.epubcfi.isCfiString(e)){let r=new jt(e).toRange(this.document,t);if(r){try{if(!r.endContainer||r.startContainer==r.endContainer&&r.startOffset==r.endOffset){let a=r.startContainer.textContent.indexOf(" ",r.startOffset);a==-1&&(a=r.startContainer.textContent.length),r.setEnd(r.startContainer,a)}}catch(a){console.error("setting end offset to start container length failed",a)}if(r.startContainer.nodeType===Node.ELEMENT_NODE)i=r.startContainer.getBoundingClientRect(),s.left=i.left,s.top=i.top;else if(AT){let a=r.startContainer,o=new Range;try{a.nodeType===u$?i=a.getBoundingClientRect():r.startOffset+2<a.length?(o.setStart(a,r.startOffset),o.setEnd(a,r.startOffset+2),i=o.getBoundingClientRect()):r.startOffset-2>0?(o.setStart(a,r.startOffset-2),o.setEnd(a,r.startOffset),i=o.getBoundingClientRect()):i=a.parentNode.getBoundingClientRect()}catch(l){console.error(l,l.stack)}}else i=r.getBoundingClientRect()}}else if(typeof e=="string"&&e.indexOf("#")>-1){let r=e.substring(e.indexOf("#")+1),a=this.document.getElementById(r);if(a)if(AT){let o=new Range;o.selectNode(a),i=o.getBoundingClientRect()}else i=a.getBoundingClientRect()}return i&&(s.left=i.left,s.top=i.top),s}addStylesheet(e){return new Promise((function(t,i){var s,r=!1;if(!this.document){t(!1);return}if(s=this.document.querySelector("link[href='"+e+"']"),s){t(!0);return}s=this.document.createElement("link"),s.type="text/css",s.rel="stylesheet",s.href=e,s.onload=s.onreadystatechange=function(){!r&&(!this.readyState||this.readyState=="complete")&&(r=!0,setTimeout(()=>{t(!0)},1))},this.document.head.appendChild(s)}).bind(this))}_getStylesheetNode(e){var t;return e="epubjs-inserted-css-"+(e||""),this.document?(t=this.document.getElementById(e),t||(t=this.document.createElement("style"),t.id=e,this.document.head.appendChild(t)),t):!1}addStylesheetCss(e,t){if(!this.document||!e)return!1;var i;return i=this._getStylesheetNode(t),i.innerHTML=e,!0}addStylesheetRules(e,t){var i;if(!(!this.document||!e||e.length===0))if(i=this._getStylesheetNode(t).sheet,Object.prototype.toString.call(e)==="[object Array]")for(var s=0,r=e.length;s<r;s++){var a=1,o=e[s],l=e[s][0],u="";Object.prototype.toString.call(o[1][0])==="[object Array]"&&(o=o[1],a=0);for(var d=o.length;a<d;a++){var f=o[a];u+=f[0]+":"+f[1]+(f[2]?" !important":"")+`;
`}i.insertRule(l+"{"+u+"}",i.cssRules.length)}else Object.keys(e).forEach(g=>{const x=e[g];if(Array.isArray(x))x.forEach(w=>{const m=Object.keys(w).map(v=>`${v}:${w[v]}`).join(";");i.insertRule(`${g}{${m}}`,i.cssRules.length)});else{const y=Object.keys(x).map(m=>`${m}:${x[m]}`).join(";");i.insertRule(`${g}{${y}}`,i.cssRules.length)}})}addScript(e){return new Promise((function(t,i){var s,r=!1;if(!this.document){t(!1);return}s=this.document.createElement("script"),s.type="text/javascript",s.async=!0,s.src=e,s.onload=s.onreadystatechange=function(){!r&&(!this.readyState||this.readyState=="complete")&&(r=!0,setTimeout(function(){t(!0)},1))},this.document.head.appendChild(s)}).bind(this))}addClass(e){var t;this.document&&(t=this.content||this.document.body,t&&t.classList.add(e))}removeClass(e){var t;this.document&&(t=this.content||this.document.body,t&&t.classList.remove(e))}addEventListeners(){this.document&&(this._triggerEvent=this.triggerEvent.bind(this),mx.forEach(function(e){this.document.addEventListener(e,this._triggerEvent,{passive:!0})},this))}removeEventListeners(){this.document&&(mx.forEach(function(e){this.document.removeEventListener(e,this._triggerEvent,{passive:!0})},this),this._triggerEvent=void 0)}triggerEvent(e){this.emit(e.type,e)}addSelectionListeners(){this.document&&(this._onSelectionChange=this.onSelectionChange.bind(this),this.document.addEventListener("selectionchange",this._onSelectionChange,{passive:!0}))}removeSelectionListeners(){this.document&&(this.document.removeEventListener("selectionchange",this._onSelectionChange,{passive:!0}),this._onSelectionChange=void 0)}onSelectionChange(e){this.selectionEndTimeout&&clearTimeout(this.selectionEndTimeout),this.selectionEndTimeout=setTimeout((function(){var t=this.window.getSelection();this.triggerSelectedEvent(t)}).bind(this),250)}triggerSelectedEvent(e){var t,i;e&&e.rangeCount>0&&(t=e.getRangeAt(0),t.collapsed||(i=new jt(t,this.cfiBase).toString(),this.emit($e.CONTENTS.SELECTED,i),this.emit($e.CONTENTS.SELECTED_RANGE,t)))}range(e,t){var i=new jt(e);return i.toRange(this.document,t)}cfiFromRange(e,t){return new jt(e,this.cfiBase,t).toString()}cfiFromNode(e,t){return new jt(e,this.cfiBase,t).toString()}map(e){var t=new qb(e);return t.section()}size(e,t){var i={scale:1,scalable:"no"};this.layoutStyle("scrolling"),e>=0&&(this.width(e),i.width=e,this.css("padding","0 "+e/12+"px")),t>=0&&(this.height(t),i.height=t),this.css("margin","0"),this.css("box-sizing","border-box"),this.viewport(i)}columns(e,t,i,s,r){let a=Cd("column-axis"),o=Cd("column-gap"),l=Cd("column-width"),u=Cd("column-fill"),f=this.writingMode().indexOf("vertical")===0?"vertical":"horizontal";this.layoutStyle("paginated"),r==="rtl"&&f==="horizontal"&&this.direction(r),this.width(e),this.height(t),this.viewport({width:e,height:t,scale:1,scalable:"no"}),this.css("overflow-y","hidden"),this.css("margin","0",!0),f==="vertical"?(this.css("padding-top",s/2+"px",!0),this.css("padding-bottom",s/2+"px",!0),this.css("padding-left","20px"),this.css("padding-right","20px"),this.css(a,"vertical")):(this.css("padding-top","20px"),this.css("padding-bottom","20px"),this.css("padding-left",s/2+"px",!0),this.css("padding-right",s/2+"px",!0),this.css(a,"horizontal")),this.css("box-sizing","border-box"),this.css("max-width","inherit"),this.css(u,"auto"),this.css(o,s+"px"),this.css(l,i+"px"),this.css("-webkit-line-box-contain","block glyphs replaced")}scaler(e,t,i){var s="scale("+e+")",r="";this.css("transform-origin","top left"),(t>=0||i>=0)&&(r=" translate("+(t||0)+"px, "+(i||0)+"px )"),this.css("transform",s+r)}fit(e,t,i){var s=this.viewport(),r=parseInt(s.width),a=parseInt(s.height),o=e/r,l=t/a,u=o<l?o:l;if(this.layoutStyle("paginated"),this.width(r),this.height(a),this.overflow("hidden"),this.scaler(u,0,0),this.css("background-size",r*u+"px "+a*u+"px"),this.css("background-color","transparent"),i&&i.properties.includes("page-spread-left")){var d=e-r*u;this.css("margin-left",d+"px")}}direction(e){this.documentElement&&(this.documentElement.style.direction=e)}mapPage(e,t,i,s,r){var a=new qb(t,r);return a.page(this,e,i,s)}linksHandler(){e$(this.content,e=>{this.emit($e.CONTENTS.LINK_CLICKED,e)})}writingMode(e){let t=Cd("writing-mode");return e&&this.documentElement&&(this.documentElement.style[t]=e),this.window.getComputedStyle(this.documentElement)[t]||""}layoutStyle(e){return e&&(this._layoutStyle=e,navigator.epubReadingSystem.layoutStyle=this._layoutStyle),this._layoutStyle||"paginated"}epubReadingSystem(e,t){return navigator.epubReadingSystem={name:e,version:t,layoutStyle:this.layoutStyle(),hasFeature:function(i){switch(i){case"dom-manipulation":return!0;case"layout-changes":return!0;case"touch-events":return!0;case"mouse-events":return!0;case"keyboard-events":return!0;case"spine-scripting":return!1;default:return!1}}},navigator.epubReadingSystem}destroy(){this.removeListeners()}}ro(o_.prototype);class h${constructor(e){this.rendition=e,this.highlights=[],this.underlines=[],this.marks=[],this._annotations={},this._annotationsBySectionIndex={},this.rendition.hooks.render.register(this.inject.bind(this)),this.rendition.hooks.unloaded.register(this.clear.bind(this))}add(e,t,i,s,r,a){let o=encodeURI(t+e),u=new jt(t).spinePos,d=new b4({type:e,cfiRange:t,data:i,sectionIndex:u,cb:s,className:r,styles:a});return this._annotations[o]=d,u in this._annotationsBySectionIndex?this._annotationsBySectionIndex[u].push(o):this._annotationsBySectionIndex[u]=[o],this.rendition.views().forEach(p=>{d.sectionIndex===p.index&&d.attach(p)}),d}remove(e,t){let i=encodeURI(e+t);if(i in this._annotations){let s=this._annotations[i];if(t&&s.type!==t)return;this.rendition.views().forEach(a=>{this._removeFromAnnotationBySectionIndex(s.sectionIndex,i),s.sectionIndex===a.index&&s.detach(a)}),delete this._annotations[i]}}_removeFromAnnotationBySectionIndex(e,t){this._annotationsBySectionIndex[e]=this._annotationsAt(e).filter(i=>i!==t)}_annotationsAt(e){return this._annotationsBySectionIndex[e]}highlight(e,t,i,s,r){return this.add("highlight",e,t,i,s,r)}underline(e,t,i,s,r){return this.add("underline",e,t,i,s,r)}mark(e,t,i){return this.add("mark",e,t,i)}each(){return this._annotations.forEach.apply(this._annotations,arguments)}inject(e){let t=e.index;t in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[t].forEach(s=>{this._annotations[s].attach(e)})}clear(e){let t=e.index;t in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[t].forEach(s=>{this._annotations[s].detach(e)})}show(){}hide(){}}class b4{constructor({type:e,cfiRange:t,data:i,sectionIndex:s,cb:r,className:a,styles:o}){this.type=e,this.cfiRange=t,this.data=i,this.sectionIndex=s,this.mark=void 0,this.cb=r,this.className=a,this.styles=o}update(e){this.data=e}attach(e){let{cfiRange:t,data:i,type:s,mark:r,cb:a,className:o,styles:l}=this,u;return s==="highlight"?u=e.highlight(t,i,a,o,l):s==="underline"?u=e.underline(t,i,a,o,l):s==="mark"&&(u=e.mark(t,i,a)),this.mark=u,this.emit($e.ANNOTATION.ATTACH,u),u}detach(e){let{cfiRange:t,type:i}=this,s;return e&&(i==="highlight"?s=e.unhighlight(t):i==="underline"?s=e.ununderline(t):i==="mark"&&(s=e.unmark(t))),this.mark=void 0,this.emit($e.ANNOTATION.DETACH,s),s}text(){}}ro(b4.prototype);var rl={},sw={};Object.defineProperty(sw,"__esModule",{value:!0});sw.createElement=w4;function w4(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}sw.default={createElement:w4};var fv={};Object.defineProperty(fv,"__esModule",{value:!0});fv.proxyMouse=S4;fv.clone=A4;fv.default={proxyMouse:S4};function S4(n,e){function t(a){for(var o=e.length-1;o>=0;o--){var l=e[o],u=a.clientX,d=a.clientY;if(a.touches&&a.touches.length&&(u=a.touches[0].clientX,d=a.touches[0].clientY),!!d$(l,n,u,d)){l.dispatchEvent(A4(a));break}}}if(n.nodeName==="iframe"||n.nodeName==="IFRAME")try{this.target=n.contentDocument}catch{this.target=n}else this.target=n;for(var i=["mouseup","mousedown","click","touchstart"],s=0;s<i.length;s++){var r=i[s];this.target.addEventListener(r,function(a){return t(a)},!1)}}function A4(n){var e=Object.assign({},n,{bubbles:!1});try{return new MouseEvent(n.type,e)}catch{var t=document.createEvent("MouseEvents");return t.initMouseEvent(n.type,!1,e.cancelable,e.view,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget),t}}function d$(n,e,t,i){var s=e.getBoundingClientRect();function r(d,f,p){var g=d.top-s.top,x=d.left-s.left,w=g+d.height,y=x+d.width;return g<=p&&x<=f&&w>p&&y>f}var a=n.getBoundingClientRect();if(!r(a,t,i))return!1;for(var o=n.getClientRects(),l=0,u=o.length;l<u;l++)if(r(o[l],t,i))return!0;return!1}var Vb,l_;Object.defineProperty(rl,"__esModule",{value:!0});var E4=rl.Underline=l_=rl.Highlight=rl.Mark=Vb=rl.Pane=void 0,f$=function n(e,t,i){e===null&&(e=Function.prototype);var s=Object.getOwnPropertyDescriptor(e,t);if(s===void 0){var r=Object.getPrototypeOf(e);return r===null?void 0:n(r,t,i)}else{if("value"in s)return s.value;var a=s.get;return a===void 0?void 0:a.call(i)}},rw=function(){function n(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}}(),p$=sw,Vm=C4(p$),g$=fv,m$=C4(g$);function C4(n){return n&&n.__esModule?n:{default:n}}function _4(n,e){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:n}function N4(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(n,e):n.__proto__=e)}function aw(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}Vb=rl.Pane=function(){function n(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document.body;aw(this,n),this.target=e,this.element=Vm.default.createElement("svg"),this.marks=[],this.element.style.position="absolute",this.element.setAttribute("pointer-events","none"),m$.default.proxyMouse(this.target,this.marks),this.container=t,this.container.appendChild(this.element),this.render()}return rw(n,[{key:"addMark",value:function(t){var i=Vm.default.createElement("g");return this.element.appendChild(i),t.bind(i,this.container),this.marks.push(t),t.render(),t}},{key:"removeMark",value:function(t){var i=this.marks.indexOf(t);if(i!==-1){var s=t.unbind();this.element.removeChild(s),this.marks.splice(i,1)}}},{key:"render",value:function(){b$(this.element,x$(this.target,this.container));var t=!0,i=!1,s=void 0;try{for(var r=this.marks[Symbol.iterator](),a;!(t=(a=r.next()).done);t=!0){var o=a.value;o.render()}}catch(l){i=!0,s=l}finally{try{!t&&r.return&&r.return()}finally{if(i)throw s}}}}]),n}();var y$=rl.Mark=function(){function n(){aw(this,n),this.element=null}return rw(n,[{key:"bind",value:function(t,i){this.element=t,this.container=i}},{key:"unbind",value:function(){var t=this.element;return this.element=null,t}},{key:"render",value:function(){}},{key:"dispatchEvent",value:function(t){this.element&&this.element.dispatchEvent(t)}},{key:"getBoundingClientRect",value:function(){return this.element.getBoundingClientRect()}},{key:"getClientRects",value:function(){for(var t=[],i=this.element.firstChild;i;)t.push(i.getBoundingClientRect()),i=i.nextSibling;return t}},{key:"filteredRanges",value:function(){var t=Array.from(this.range.getClientRects());return t.filter(function(i){for(var s=0;s<t.length;s++){if(t[s]===i)return!0;var r=w$(t[s],i);if(r)return!1}return!0})}}]),n}(),v$=l_=rl.Highlight=function(n){N4(e,n);function e(t,i,s,r){aw(this,e);var a=_4(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return a.range=t,a.className=i,a.data=s||{},a.attributes=r||{},a}return rw(e,[{key:"bind",value:function(i,s){f$(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"bind",this).call(this,i,s);for(var r in this.data)this.data.hasOwnProperty(r)&&(this.element.dataset[r]=this.data[r]);for(var r in this.attributes)this.attributes.hasOwnProperty(r)&&this.element.setAttribute(r,this.attributes[r]);this.className&&this.element.classList.add(this.className)}},{key:"render",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var i=this.element.ownerDocument.createDocumentFragment(),s=this.filteredRanges(),r=this.element.getBoundingClientRect(),a=this.container.getBoundingClientRect(),o=0,l=s.length;o<l;o++){var u=s[o],d=Vm.default.createElement("rect");d.setAttribute("x",u.left-r.left+a.left),d.setAttribute("y",u.top-r.top+a.top),d.setAttribute("height",u.height),d.setAttribute("width",u.width),i.appendChild(d)}this.element.appendChild(i)}}]),e}(y$);E4=rl.Underline=function(n){N4(e,n);function e(t,i,s,r){return aw(this,e),_4(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,s,r))}return rw(e,[{key:"render",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var i=this.element.ownerDocument.createDocumentFragment(),s=this.filteredRanges(),r=this.element.getBoundingClientRect(),a=this.container.getBoundingClientRect(),o=0,l=s.length;o<l;o++){var u=s[o],d=Vm.default.createElement("rect");d.setAttribute("x",u.left-r.left+a.left),d.setAttribute("y",u.top-r.top+a.top),d.setAttribute("height",u.height),d.setAttribute("width",u.width),d.setAttribute("fill","none");var f=Vm.default.createElement("line");f.setAttribute("x1",u.left-r.left+a.left),f.setAttribute("x2",u.left-r.left+a.left+u.width),f.setAttribute("y1",u.top-r.top+a.top+u.height-1),f.setAttribute("y2",u.top-r.top+a.top+u.height-1),f.setAttribute("stroke-width",1),f.setAttribute("stroke","black"),f.setAttribute("stroke-linecap","square"),i.appendChild(d),i.appendChild(f)}this.element.appendChild(i)}}]),e}(v$);function x$(n,e){var t=e.getBoundingClientRect(),i=n.getBoundingClientRect();return{top:i.top-t.top,left:i.left-t.left,height:n.scrollHeight,width:n.scrollWidth}}function b$(n,e){n.style.setProperty("top",e.top+"px","important"),n.style.setProperty("left",e.left+"px","important"),n.style.setProperty("height",e.height+"px","important"),n.style.setProperty("width",e.width+"px","important")}function w$(n,e){return e.right<=n.right&&e.left>=n.left&&e.top>=n.top&&e.bottom<=n.bottom}class k4{constructor(e,t){this.settings=Bn({ignoreClass:"",axis:void 0,direction:void 0,width:0,height:0,layout:void 0,globalLayoutProperties:{},method:void 0,forceRight:!1,allowScriptedContent:!1,allowPopups:!1},t||{}),this.id="epubjs-view-"+iw(),this.section=e,this.index=e.index,this.element=this.container(this.settings.axis),this.added=!1,this.displayed=!1,this.rendered=!1,this.fixedWidth=0,this.fixedHeight=0,this.epubcfi=new jt,this.layout=this.settings.layout,this.pane=void 0,this.highlights={},this.underlines={},this.marks={}}container(e){var t=document.createElement("div");return t.classList.add("epub-view"),t.style.height="0px",t.style.width="0px",t.style.overflow="hidden",t.style.position="relative",t.style.display="block",e&&e=="horizontal"?t.style.flex="none":t.style.flex="initial",t}create(){return this.iframe?this.iframe:(this.element||(this.element=this.createContainer()),this.iframe=document.createElement("iframe"),this.iframe.id=this.id,this.iframe.scrolling="no",this.iframe.style.overflow="hidden",this.iframe.seamless="seamless",this.iframe.style.border="none",this.iframe.sandbox="allow-same-origin",this.settings.allowScriptedContent&&(this.iframe.sandbox+=" allow-scripts"),this.settings.allowPopups&&(this.iframe.sandbox+=" allow-popups"),this.iframe.setAttribute("enable-annotation","true"),this.resizing=!0,this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this.element.setAttribute("ref",this.index),this.added=!0,this.elementBounds=px(this.element),"srcdoc"in this.iframe?this.supportsSrcdoc=!0:this.supportsSrcdoc=!1,this.settings.method||(this.settings.method=this.supportsSrcdoc?"srcdoc":"write"),this.iframe)}render(e,t){return this.create(),this.size(),this.sectionRender||(this.sectionRender=this.section.render(e)),this.sectionRender.then((function(i){return this.load(i)}).bind(this)).then((function(){let i=this.contents.writingMode(),s;return this.settings.flow==="scrolled"?s=i.indexOf("vertical")===0?"horizontal":"vertical":s=i.indexOf("vertical")===0?"vertical":"horizontal",i.indexOf("vertical")===0&&this.settings.flow==="paginated"&&(this.layout.delta=this.layout.height),this.setAxis(s),this.emit($e.VIEWS.AXIS,s),this.setWritingMode(i),this.emit($e.VIEWS.WRITING_MODE,i),this.layout.format(this.contents,this.section,this.axis),this.addListeners(),new Promise((r,a)=>{this.expand(),this.settings.forceRight&&(this.element.style.marginLeft=this.width()+"px"),r()})}).bind(this),(function(i){return this.emit($e.VIEWS.LOAD_ERROR,i),new Promise((s,r)=>{r(i)})}).bind(this)).then((function(){this.emit($e.VIEWS.RENDERED,this.section)}).bind(this))}reset(){this.iframe&&(this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this._textWidth=void 0,this._contentWidth=void 0,this._textHeight=void 0,this._contentHeight=void 0),this._needsReframe=!0}size(e,t){var i=e||this.settings.width,s=t||this.settings.height;this.layout.name==="pre-paginated"?this.lock("both",i,s):this.settings.axis==="horizontal"?this.lock("height",i,s):this.lock("width",i,s),this.settings.width=i,this.settings.height=s}lock(e,t,i){var s=Fb(this.element),r;this.iframe?r=Fb(this.iframe):r={width:0,height:0},e=="width"&&Li(t)&&(this.lockedWidth=t-s.width-r.width),e=="height"&&Li(i)&&(this.lockedHeight=i-s.height-r.height),e==="both"&&Li(t)&&Li(i)&&(this.lockedWidth=t-s.width-r.width,this.lockedHeight=i-s.height-r.height),this.displayed&&this.iframe&&this.expand()}expand(e){var t=this.lockedWidth,i=this.lockedHeight,s;!this.iframe||this._expanding||(this._expanding=!0,this.layout.name==="pre-paginated"?(t=this.layout.columnWidth,i=this.layout.height):this.settings.axis==="horizontal"?(t=this.contents.textWidth(),t%this.layout.pageWidth>0&&(t=Math.ceil(t/this.layout.pageWidth)*this.layout.pageWidth),this.settings.forceEvenPages&&(s=t/this.layout.pageWidth,this.layout.divisor>1&&this.layout.name==="reflowable"&&s%2>0&&(t+=this.layout.pageWidth))):this.settings.axis==="vertical"&&(i=this.contents.textHeight(),this.settings.flow==="paginated"&&i%this.layout.height>0&&(i=Math.ceil(i/this.layout.height)*this.layout.height)),(this._needsReframe||t!=this._width||i!=this._height)&&this.reframe(t,i),this._expanding=!1)}reframe(e,t){var i;Li(e)&&(this.element.style.width=e+"px",this.iframe.style.width=e+"px",this._width=e),Li(t)&&(this.element.style.height=t+"px",this.iframe.style.height=t+"px",this._height=t);let s=this.prevBounds?e-this.prevBounds.width:e,r=this.prevBounds?t-this.prevBounds.height:t;i={width:e,height:t,widthDelta:s,heightDelta:r},this.pane&&this.pane.render(),requestAnimationFrame(()=>{let a;for(let o in this.marks)this.marks.hasOwnProperty(o)&&(a=this.marks[o],this.placeMark(a.element,a.range))}),this.onResize(this,i),this.emit($e.VIEWS.RESIZED,i),this.prevBounds=i,this.elementBounds=px(this.element)}load(e){var t=new Dt,i=t.promise;if(!this.iframe)return t.reject(new Error("No Iframe Available")),i;if(this.iframe.onload=(function(r){this.onLoad(r,t)}).bind(this),this.settings.method==="blobUrl")this.blobUrl=Ub(e,"application/xhtml+xml"),this.iframe.src=this.blobUrl,this.element.appendChild(this.iframe);else if(this.settings.method==="srcdoc")this.iframe.srcdoc=e,this.element.appendChild(this.iframe);else{if(this.element.appendChild(this.iframe),this.document=this.iframe.contentDocument,!this.document)return t.reject(new Error("No Document Available")),i;if(this.iframe.contentDocument.open(),window.MSApp&&MSApp.execUnsafeLocalFunction){var s=this;MSApp.execUnsafeLocalFunction(function(){s.iframe.contentDocument.write(e)})}else this.iframe.contentDocument.write(e);this.iframe.contentDocument.close()}return i}onLoad(e,t){this.window=this.iframe.contentWindow,this.document=this.iframe.contentDocument,this.contents=new o_(this.document,this.document.body,this.section.cfiBase,this.section.index),this.rendering=!1;var i=this.document.querySelector("link[rel='canonical']");i?i.setAttribute("href",this.section.canonical):(i=this.document.createElement("link"),i.setAttribute("rel","canonical"),i.setAttribute("href",this.section.canonical),this.document.querySelector("head").appendChild(i)),this.contents.on($e.CONTENTS.EXPAND,()=>{this.displayed&&this.iframe&&(this.expand(),this.contents&&this.layout.format(this.contents))}),this.contents.on($e.CONTENTS.RESIZE,s=>{this.displayed&&this.iframe&&(this.expand(),this.contents&&this.layout.format(this.contents))}),t.resolve(this.contents)}setLayout(e){this.layout=e,this.contents&&(this.layout.format(this.contents),this.expand())}setAxis(e){this.settings.axis=e,e=="horizontal"?this.element.style.flex="none":this.element.style.flex="initial",this.size()}setWritingMode(e){this.writingMode=e}addListeners(){}removeListeners(e){}display(e){var t=new Dt;return this.displayed?t.resolve(this):this.render(e).then((function(){this.emit($e.VIEWS.DISPLAYED,this),this.onDisplayed(this),this.displayed=!0,t.resolve(this)}).bind(this),function(i){t.reject(i,this)}),t.promise}show(){this.element.style.visibility="visible",this.iframe&&(this.iframe.style.visibility="visible",this.iframe.style.transform="translateZ(0)",this.iframe.offsetWidth,this.iframe.style.transform=null),this.emit($e.VIEWS.SHOWN,this)}hide(){this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.stopExpanding=!0,this.emit($e.VIEWS.HIDDEN,this)}offset(){return{top:this.element.offsetTop,left:this.element.offsetLeft}}width(){return this._width}height(){return this._height}position(){return this.element.getBoundingClientRect()}locationOf(e){this.iframe.getBoundingClientRect();var t=this.contents.locationOf(e,this.settings.ignoreClass);return{left:t.left,top:t.top}}onDisplayed(e){}onResize(e,t){}bounds(e){return(e||!this.elementBounds)&&(this.elementBounds=px(this.element)),this.elementBounds}highlight(e,t={},i,s="epubjs-hl",r={}){if(!this.contents)return;const a=Object.assign({fill:"yellow","fill-opacity":"0.3","mix-blend-mode":"multiply"},r);let o=this.contents.range(e),l=()=>{this.emit($e.VIEWS.MARK_CLICKED,e,t)};t.epubcfi=e,this.pane||(this.pane=new Vb(this.iframe,this.element));let u=new l_(o,s,t,a),d=this.pane.addMark(u);return this.highlights[e]={mark:d,element:d.element,listeners:[l,i]},d.element.setAttribute("ref",s),d.element.addEventListener("click",l),d.element.addEventListener("touchstart",l),i&&(d.element.addEventListener("click",i),d.element.addEventListener("touchstart",i)),d}underline(e,t={},i,s="epubjs-ul",r={}){if(!this.contents)return;const a=Object.assign({stroke:"black","stroke-opacity":"0.3","mix-blend-mode":"multiply"},r);let o=this.contents.range(e),l=()=>{this.emit($e.VIEWS.MARK_CLICKED,e,t)};t.epubcfi=e,this.pane||(this.pane=new Vb(this.iframe,this.element));let u=new E4(o,s,t,a),d=this.pane.addMark(u);return this.underlines[e]={mark:d,element:d.element,listeners:[l,i]},d.element.setAttribute("ref",s),d.element.addEventListener("click",l),d.element.addEventListener("touchstart",l),i&&(d.element.addEventListener("click",i),d.element.addEventListener("touchstart",i)),d}mark(e,t={},i){if(!this.contents)return;if(e in this.marks)return this.marks[e];let s=this.contents.range(e);if(!s)return;let r=s.commonAncestorContainer,a=r.nodeType===1?r:r.parentNode,o=u=>{this.emit($e.VIEWS.MARK_CLICKED,e,t)};s.collapsed&&r.nodeType===1?(s=new Range,s.selectNodeContents(r)):s.collapsed&&(s=new Range,s.selectNodeContents(a));let l=this.document.createElement("a");return l.setAttribute("ref","epubjs-mk"),l.style.position="absolute",l.dataset.epubcfi=e,t&&Object.keys(t).forEach(u=>{l.dataset[u]=t[u]}),i&&(l.addEventListener("click",i),l.addEventListener("touchstart",i)),l.addEventListener("click",o),l.addEventListener("touchstart",o),this.placeMark(l,s),this.element.appendChild(l),this.marks[e]={element:l,range:s,listeners:[o,i]},a}placeMark(e,t){let i,s,r;if(this.layout.name==="pre-paginated"||this.settings.axis!=="horizontal"){let o=t.getBoundingClientRect();i=o.top,s=o.right}else{let o=t.getClientRects(),l;for(var a=0;a!=o.length;a++)l=o[a],(!r||l.left<r)&&(r=l.left,s=Math.ceil(r/this.layout.props.pageWidth)*this.layout.props.pageWidth-this.layout.gap/2,i=l.top)}e.style.top=`${i}px`,e.style.left=`${s}px`}unhighlight(e){let t;e in this.highlights&&(t=this.highlights[e],this.pane.removeMark(t.mark),t.listeners.forEach(i=>{i&&(t.element.removeEventListener("click",i),t.element.removeEventListener("touchstart",i))}),delete this.highlights[e])}ununderline(e){let t;e in this.underlines&&(t=this.underlines[e],this.pane.removeMark(t.mark),t.listeners.forEach(i=>{i&&(t.element.removeEventListener("click",i),t.element.removeEventListener("touchstart",i))}),delete this.underlines[e])}unmark(e){let t;e in this.marks&&(t=this.marks[e],this.element.removeChild(t.element),t.listeners.forEach(i=>{i&&(t.element.removeEventListener("click",i),t.element.removeEventListener("touchstart",i))}),delete this.marks[e])}destroy(){for(let e in this.highlights)this.unhighlight(e);for(let e in this.underlines)this.ununderline(e);for(let e in this.marks)this.unmark(e);this.blobUrl&&u4(this.blobUrl),this.displayed&&(this.displayed=!1,this.removeListeners(),this.contents.destroy(),this.stopExpanding=!0,this.element.removeChild(this.iframe),this.pane&&(this.pane.element.remove(),this.pane=void 0),this.iframe=void 0,this.contents=void 0,this._textWidth=null,this._textHeight=null,this._width=null,this._height=null)}}ro(k4.prototype);function S$(){var n="reverse",e=A$();return document.body.appendChild(e),e.scrollLeft>0?n="default":typeof Element<"u"&&Element.prototype.scrollIntoView?(e.children[0].children[1].scrollIntoView(),e.scrollLeft<0&&(n="negative")):(e.scrollLeft=1,e.scrollLeft===0&&(n="negative")),document.body.removeChild(e),n}function A$(){var n=document.createElement("div");n.dir="rtl",n.style.position="fixed",n.style.width="1px",n.style.height="1px",n.style.top="0px",n.style.left="0px",n.style.overflow="hidden";var e=document.createElement("div");e.style.width="2px";var t=document.createElement("span");t.style.width="1px",t.style.display="inline-block";var i=document.createElement("span");return i.style.width="1px",i.style.display="inline-block",e.appendChild(t),e.appendChild(i),n.appendChild(e),n}function E$(n){var e=typeof n;return n!=null&&(e=="object"||e=="function")}var c_=E$,C$=typeof zr=="object"&&zr&&zr.Object===Object&&zr,_$=C$,N$=_$,k$=typeof self=="object"&&self&&self.Object===Object&&self,T$=N$||k$||Function("return this")(),T4=T$,D$=T4,j$=function(){return D$.Date.now()},R$=j$,L$=/\s/;function M$(n){for(var e=n.length;e--&&L$.test(n.charAt(e)););return e}var O$=M$,I$=O$,P$=/^\s+/;function B$(n){return n&&n.slice(0,I$(n)+1).replace(P$,"")}var F$=B$,z$=T4,U$=z$.Symbol,D4=U$,ET=D4,j4=Object.prototype,H$=j4.hasOwnProperty,$$=j4.toString,kg=ET?ET.toStringTag:void 0;function q$(n){var e=H$.call(n,kg),t=n[kg];try{n[kg]=void 0;var i=!0}catch{}var s=$$.call(n);return i&&(e?n[kg]=t:delete n[kg]),s}var V$=q$,G$=Object.prototype,Y$=G$.toString;function W$(n){return Y$.call(n)}var X$=W$,CT=D4,K$=V$,Z$=X$,Q$="[object Null]",J$="[object Undefined]",_T=CT?CT.toStringTag:void 0;function eq(n){return n==null?n===void 0?J$:Q$:_T&&_T in Object(n)?K$(n):Z$(n)}var tq=eq;function iq(n){return n!=null&&typeof n=="object"}var nq=iq,sq=tq,rq=nq,aq="[object Symbol]";function oq(n){return typeof n=="symbol"||rq(n)&&sq(n)==aq}var lq=oq,cq=F$,NT=c_,uq=lq,kT=NaN,hq=/^[-+]0x[0-9a-f]+$/i,dq=/^0b[01]+$/i,fq=/^0o[0-7]+$/i,pq=parseInt;function gq(n){if(typeof n=="number")return n;if(uq(n))return kT;if(NT(n)){var e=typeof n.valueOf=="function"?n.valueOf():n;n=NT(e)?e+"":e}if(typeof n!="string")return n===0?n:+n;n=cq(n);var t=dq.test(n);return t||fq.test(n)?pq(n.slice(2),t?2:8):hq.test(n)?kT:+n}var mq=gq,yq=c_,C2=R$,TT=mq,vq="Expected a function",xq=Math.max,bq=Math.min;function wq(n,e,t){var i,s,r,a,o,l,u=0,d=!1,f=!1,p=!0;if(typeof n!="function")throw new TypeError(vq);e=TT(e)||0,yq(t)&&(d=!!t.leading,f="maxWait"in t,r=f?xq(TT(t.maxWait)||0,e):r,p="trailing"in t?!!t.trailing:p);function g(C){var k=i,L=s;return i=s=void 0,u=C,a=n.apply(L,k),a}function x(C){return u=C,o=setTimeout(m,e),d?g(C):a}function w(C){var k=C-l,L=C-u,D=e-k;return f?bq(D,r-L):D}function y(C){var k=C-l,L=C-u;return l===void 0||k>=e||k<0||f&&L>=r}function m(){var C=C2();if(y(C))return v(C);o=setTimeout(m,w(C))}function v(C){return o=void 0,p&&i?g(C):(i=s=void 0,a)}function b(){o!==void 0&&clearTimeout(o),u=0,i=l=s=o=void 0}function A(){return o===void 0?a:v(C2())}function S(){var C=C2(),k=y(C);if(i=arguments,s=this,l=C,k){if(o===void 0)return x(l);if(f)return clearTimeout(o),o=setTimeout(m,e),g(l)}return o===void 0&&(o=setTimeout(m,e)),a}return S.cancel=b,S.flush=A,S}var R4=wq;const Sq=Wh(R4);var Aq=R4,Eq=c_,Cq="Expected a function";function _q(n,e,t){var i=!0,s=!0;if(typeof n!="function")throw new TypeError(Cq);return Eq(t)&&(i="leading"in t?!!t.leading:i,s="trailing"in t?!!t.trailing:s),Aq(n,e,{leading:i,maxWait:e,trailing:s})}var Nq=_q;const kq=Wh(Nq);class Tq{constructor(e){this.settings=e||{},this.id="epubjs-container-"+iw(),this.container=this.create(this.settings),this.settings.hidden&&(this.wrapper=this.wrap(this.container))}create(e){let t=e.height,i=e.width,s=e.overflow||!1,r=e.axis||"vertical",a=e.direction;Bn(this.settings,e),e.height&&Li(e.height)&&(t=e.height+"px"),e.width&&Li(e.width)&&(i=e.width+"px");let o=document.createElement("div");return o.id=this.id,o.classList.add("epub-container"),o.style.wordSpacing="0",o.style.lineHeight="0",o.style.verticalAlign="top",o.style.position="relative",r==="horizontal"&&(o.style.display="flex",o.style.flexDirection="row",o.style.flexWrap="nowrap"),i&&(o.style.width=i),t&&(o.style.height=t),s&&(s==="scroll"&&r==="vertical"?(o.style["overflow-y"]=s,o.style["overflow-x"]="hidden"):s==="scroll"&&r==="horizontal"?(o.style["overflow-y"]="hidden",o.style["overflow-x"]=s):o.style.overflow=s),a&&(o.dir=a,o.style.direction=a),a&&this.settings.fullsize&&(document.body.style.direction=a),o}wrap(e){var t=document.createElement("div");return t.style.visibility="hidden",t.style.overflow="hidden",t.style.width="0",t.style.height="0",t.appendChild(e),t}getElement(e){var t;if(r4(e)?t=e:typeof e=="string"&&(t=document.getElementById(e)),!t)throw new Error("Not an Element");return t}attachTo(e){var t=this.getElement(e),i;if(t)return this.settings.hidden?i=this.wrapper:i=this.container,t.appendChild(i),this.element=t,t}getContainer(){return this.container}onResize(e){(!Li(this.settings.width)||!Li(this.settings.height))&&(this.resizeFunc=kq(e,50),window.addEventListener("resize",this.resizeFunc,!1))}onOrientationChange(e){this.orientationChangeFunc=e,window.addEventListener("orientationchange",this.orientationChangeFunc,!1)}size(e,t){var i;let s=e||this.settings.width,r=t||this.settings.height;e===null?(i=this.element.getBoundingClientRect(),i.width&&(e=Math.floor(i.width),this.container.style.width=e+"px")):Li(e)?this.container.style.width=e+"px":this.container.style.width=e,t===null?(i=i||this.element.getBoundingClientRect(),i.height&&(t=i.height,this.container.style.height=t+"px")):Li(t)?this.container.style.height=t+"px":this.container.style.height=t,Li(e)||(e=this.container.clientWidth),Li(t)||(t=this.container.clientHeight),this.containerStyles=window.getComputedStyle(this.container),this.containerPadding={left:parseFloat(this.containerStyles["padding-left"])||0,right:parseFloat(this.containerStyles["padding-right"])||0,top:parseFloat(this.containerStyles["padding-top"])||0,bottom:parseFloat(this.containerStyles["padding-bottom"])||0};let a=zb(),o=window.getComputedStyle(document.body),l={left:parseFloat(o["padding-left"])||0,right:parseFloat(o["padding-right"])||0,top:parseFloat(o["padding-top"])||0,bottom:parseFloat(o["padding-bottom"])||0};return s||(e=a.width-l.left-l.right),(this.settings.fullsize&&!r||!r)&&(t=a.height-l.top-l.bottom),{width:e-this.containerPadding.left-this.containerPadding.right,height:t-this.containerPadding.top-this.containerPadding.bottom}}bounds(){let e;return this.container.style.overflow!=="visible"&&(e=this.container&&this.container.getBoundingClientRect()),!e||!e.width||!e.height?zb():e}getSheet(){var e=document.createElement("style");return e.appendChild(document.createTextNode("")),document.head.appendChild(e),e.sheet}addStyleRules(e,t){var i="#"+this.id+" ",s="";this.sheet||(this.sheet=this.getSheet()),t.forEach(function(r){for(var a in r)r.hasOwnProperty(a)&&(s+=a+":"+r[a]+";")}),this.sheet.insertRule(i+e+" {"+s+"}",0)}axis(e){e==="horizontal"?(this.container.style.display="flex",this.container.style.flexDirection="row",this.container.style.flexWrap="nowrap"):this.container.style.display="block",this.settings.axis=e}direction(e){this.container&&(this.container.dir=e,this.container.style.direction=e),this.settings.fullsize&&(document.body.style.direction=e),this.settings.dir=e}overflow(e){this.container&&(e==="scroll"&&this.settings.axis==="vertical"?(this.container.style["overflow-y"]=e,this.container.style["overflow-x"]="hidden"):e==="scroll"&&this.settings.axis==="horizontal"?(this.container.style["overflow-y"]="hidden",this.container.style["overflow-x"]=e):this.container.style.overflow=e),this.settings.overflow=e}destroy(){this.element&&(this.settings.hidden?this.wrapper:this.container,this.element.contains(this.container)&&this.element.removeChild(this.container),window.removeEventListener("resize",this.resizeFunc),window.removeEventListener("orientationChange",this.orientationChangeFunc))}}class Dq{constructor(e){this.container=e,this._views=[],this.length=0,this.hidden=!1}all(){return this._views}first(){return this._views[0]}last(){return this._views[this._views.length-1]}indexOf(e){return this._views.indexOf(e)}slice(){return this._views.slice.apply(this._views,arguments)}get(e){return this._views[e]}append(e){return this._views.push(e),this.container&&this.container.appendChild(e.element),this.length++,e}prepend(e){return this._views.unshift(e),this.container&&this.container.insertBefore(e.element,this.container.firstChild),this.length++,e}insert(e,t){return this._views.splice(t,0,e),this.container&&(t<this.container.children.length?this.container.insertBefore(e.element,this.container.children[t]):this.container.appendChild(e.element)),this.length++,e}remove(e){var t=this._views.indexOf(e);t>-1&&this._views.splice(t,1),this.destroy(e),this.length--}destroy(e){e.displayed&&e.destroy(),this.container&&this.container.removeChild(e.element),e=null}forEach(){return this._views.forEach.apply(this._views,arguments)}clear(){var e,t=this.length;if(this.length){for(var i=0;i<t;i++)e=this._views[i],this.destroy(e);this._views=[],this.length=0}}find(e){for(var t,i=this.length,s=0;s<i;s++)if(t=this._views[s],t.displayed&&t.section.index==e.index)return t}displayed(){for(var e=[],t,i=this.length,s=0;s<i;s++)t=this._views[s],t.displayed&&e.push(t);return e}show(){for(var e,t=this.length,i=0;i<t;i++)e=this._views[i],e.displayed&&e.show();this.hidden=!1}hide(){for(var e,t=this.length,i=0;i<t;i++)e=this._views[i],e.displayed&&e.hide();this.hidden=!0}}class Gb{constructor(e){this.name="default",this.optsSettings=e.settings,this.View=e.view,this.request=e.request,this.renditionQueue=e.queue,this.q=new a_(this),this.settings=Bn(this.settings||{},{infinite:!0,hidden:!1,width:void 0,height:void 0,axis:void 0,writingMode:void 0,flow:"scrolled",ignoreClass:"",fullsize:void 0,allowScriptedContent:!1,allowPopups:!1}),Bn(this.settings,e.settings||{}),this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,method:this.settings.method,width:0,height:0,forceEvenPages:!0,allowScriptedContent:this.settings.allowScriptedContent,allowPopups:this.settings.allowPopups},this.rendered=!1}render(e,t){let i=e.tagName;typeof this.settings.fullsize>"u"&&i&&(i.toLowerCase()=="body"||i.toLowerCase()=="html")&&(this.settings.fullsize=!0),this.settings.fullsize&&(this.settings.overflow="visible",this.overflow=this.settings.overflow),this.settings.size=t,this.settings.rtlScrollType=S$(),this.stage=new Tq({width:t.width,height:t.height,overflow:this.overflow,hidden:this.settings.hidden,axis:this.settings.axis,fullsize:this.settings.fullsize,direction:this.settings.direction}),this.stage.attachTo(e),this.container=this.stage.getContainer(),this.views=new Dq(this.container),this._bounds=this.bounds(),this._stageSize=this.stage.size(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.stage.onResize(this.onResized.bind(this)),this.stage.onOrientationChange(this.onOrientationChange.bind(this)),this.addEventListeners(),this.layout&&this.updateLayout(),this.rendered=!0}addEventListeners(){var e;window.addEventListener("unload",(function(t){this.destroy()}).bind(this)),this.settings.fullsize?e=window:e=this.container,this._onScroll=this.onScroll.bind(this),e.addEventListener("scroll",this._onScroll)}removeEventListeners(){var e;this.settings.fullsize?e=window:e=this.container,e.removeEventListener("scroll",this._onScroll),this._onScroll=void 0}destroy(){clearTimeout(this.orientationTimeout),clearTimeout(this.resizeTimeout),clearTimeout(this.afterScrolled),this.clear(),this.removeEventListeners(),this.stage.destroy(),this.rendered=!1}onOrientationChange(e){let{orientation:t}=window;this.optsSettings.resizeOnOrientationChange&&this.resize(),clearTimeout(this.orientationTimeout),this.orientationTimeout=setTimeout((function(){this.orientationTimeout=void 0,this.optsSettings.resizeOnOrientationChange&&this.resize(),this.emit($e.MANAGERS.ORIENTATION_CHANGE,t)}).bind(this),500)}onResized(e){this.resize()}resize(e,t,i){let s=this.stage.size(e,t);if(this.winBounds=zb(),this.orientationTimeout&&this.winBounds.width===this.winBounds.height){this._stageSize=void 0;return}this._stageSize&&this._stageSize.width===s.width&&this._stageSize.height===s.height||(this._stageSize=s,this._bounds=this.bounds(),this.clear(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.updateLayout(),this.emit($e.MANAGERS.RESIZED,{width:this._stageSize.width,height:this._stageSize.height},i))}createView(e,t){return new this.View(e,Bn(this.viewSettings,{forceRight:t}))}handleNextPrePaginated(e,t,i){let s;if(this.layout.name==="pre-paginated"&&this.layout.divisor>1){if(e||t.index===0)return;if(s=t.next(),s&&!s.properties.includes("page-spread-left"))return i.call(this,s)}}display(e,t){var i=new Dt,s=i.promise;(t===e.href||Li(t))&&(t=void 0);var r=this.views.find(e);if(r&&e&&this.layout.name!=="pre-paginated"){let o=r.offset();if(this.settings.direction==="ltr")this.scrollTo(o.left,o.top,!0);else{let l=r.width();this.scrollTo(o.left+l,o.top,!0)}if(t){let l=r.locationOf(t),u=r.width();this.moveTo(l,u)}return i.resolve(),s}this.clear();let a=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&e.properties.includes("page-spread-right")&&(a=!0),this.add(e,a).then((function(o){if(t){let l=o.locationOf(t),u=o.width();this.moveTo(l,u)}}).bind(this),o=>{i.reject(o)}).then((function(){return this.handleNextPrePaginated(a,e,this.add)}).bind(this)).then((function(){this.views.show(),i.resolve()}).bind(this)),s}afterDisplayed(e){this.emit($e.MANAGERS.ADDED,e)}afterResized(e){this.emit($e.MANAGERS.RESIZE,e.section)}moveTo(e,t){var i=0,s=0;this.isPaginated?(i=Math.floor(e.left/this.layout.delta)*this.layout.delta,i+this.layout.delta>this.container.scrollWidth&&(i=this.container.scrollWidth-this.layout.delta),s=Math.floor(e.top/this.layout.delta)*this.layout.delta,s+this.layout.delta>this.container.scrollHeight&&(s=this.container.scrollHeight-this.layout.delta)):s=e.top,this.settings.direction==="rtl"&&(i=i+this.layout.delta,i=i-t),this.scrollTo(i,s,!0)}add(e,t){var i=this.createView(e,t);return this.views.append(i),i.onDisplayed=this.afterDisplayed.bind(this),i.onResize=this.afterResized.bind(this),i.on($e.VIEWS.AXIS,s=>{this.updateAxis(s)}),i.on($e.VIEWS.WRITING_MODE,s=>{this.updateWritingMode(s)}),i.display(this.request)}append(e,t){var i=this.createView(e,t);return this.views.append(i),i.onDisplayed=this.afterDisplayed.bind(this),i.onResize=this.afterResized.bind(this),i.on($e.VIEWS.AXIS,s=>{this.updateAxis(s)}),i.on($e.VIEWS.WRITING_MODE,s=>{this.updateWritingMode(s)}),i.display(this.request)}prepend(e,t){var i=this.createView(e,t);return i.on($e.VIEWS.RESIZED,s=>{this.counter(s)}),this.views.prepend(i),i.onDisplayed=this.afterDisplayed.bind(this),i.onResize=this.afterResized.bind(this),i.on($e.VIEWS.AXIS,s=>{this.updateAxis(s)}),i.on($e.VIEWS.WRITING_MODE,s=>{this.updateWritingMode(s)}),i.display(this.request)}counter(e){this.settings.axis==="vertical"?this.scrollBy(0,e.heightDelta,!0):this.scrollBy(e.widthDelta,0,!0)}next(){var e,t;let i=this.settings.direction;if(this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"&&(!i||i==="ltr")?(this.scrollLeft=this.container.scrollLeft,t=this.container.scrollLeft+this.container.offsetWidth+this.layout.delta,t<=this.container.scrollWidth?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next()):this.isPaginated&&this.settings.axis==="horizontal"&&i==="rtl"?(this.scrollLeft=this.container.scrollLeft,this.settings.rtlScrollType==="default"?(t=this.container.scrollLeft,t>0?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next()):(t=this.container.scrollLeft+this.layout.delta*-1,t>this.container.scrollWidth*-1?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next())):this.isPaginated&&this.settings.axis==="vertical"?(this.scrollTop=this.container.scrollTop,this.container.scrollTop+this.container.offsetHeight<this.container.scrollHeight?this.scrollBy(0,this.layout.height,!0):e=this.views.last().section.next()):e=this.views.last().section.next(),e)){this.clear(),this.updateLayout();let s=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&e.properties.includes("page-spread-right")&&(s=!0),this.append(e,s).then((function(){return this.handleNextPrePaginated(s,e,this.append)}).bind(this),r=>r).then((function(){!this.isPaginated&&this.settings.axis==="horizontal"&&this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"&&this.scrollTo(this.container.scrollWidth,0,!0),this.views.show()}).bind(this))}}prev(){var e,t;let i=this.settings.direction;if(this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"&&(!i||i==="ltr")?(this.scrollLeft=this.container.scrollLeft,t=this.container.scrollLeft,t>0?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev()):this.isPaginated&&this.settings.axis==="horizontal"&&i==="rtl"?(this.scrollLeft=this.container.scrollLeft,this.settings.rtlScrollType==="default"?(t=this.container.scrollLeft+this.container.offsetWidth,t<this.container.scrollWidth?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev()):(t=this.container.scrollLeft,t<0?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev())):this.isPaginated&&this.settings.axis==="vertical"?(this.scrollTop=this.container.scrollTop,this.container.scrollTop>0?this.scrollBy(0,-this.layout.height,!0):e=this.views.first().section.prev()):e=this.views.first().section.prev(),e)){this.clear(),this.updateLayout();let s=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&typeof e.prev()!="object"&&(s=!0),this.prepend(e,s).then((function(){var r;if(this.layout.name==="pre-paginated"&&this.layout.divisor>1&&(r=e.prev(),r))return this.prepend(r)}).bind(this),r=>r).then((function(){this.isPaginated&&this.settings.axis==="horizontal"&&(this.settings.direction==="rtl"?this.settings.rtlScrollType==="default"?this.scrollTo(0,0,!0):this.scrollTo(this.container.scrollWidth*-1+this.layout.delta,0,!0):this.scrollTo(this.container.scrollWidth-this.layout.delta,0,!0)),this.views.show()}).bind(this))}}current(){var e=this.visible();return e.length?e[e.length-1]:null}clear(){this.views&&(this.views.hide(),this.scrollTo(0,0,!0),this.views.clear())}currentLocation(){return this.updateLayout(),this.isPaginated&&this.settings.axis==="horizontal"?this.location=this.paginatedLocation():this.location=this.scrolledLocation(),this.location}scrolledLocation(){let e=this.visible(),t=this.container.getBoundingClientRect(),i=t.height<window.innerHeight?t.height:window.innerHeight,s=t.width<window.innerWidth?t.width:window.innerWidth,r=this.settings.axis==="vertical";this.settings.direction;let a=0,o=0;return this.settings.fullsize&&(a=r?window.scrollY:window.scrollX),e.map(u=>{let{index:d,href:f}=u.section,p=u.position(),g=u.width(),x=u.height(),w,y,m,v;r?(w=a+t.top-p.top+o,y=w+i-o,v=this.layout.count(x,i).pages,m=i):(w=a+t.left-p.left+o,y=w+s-o,v=this.layout.count(g,s).pages,m=s);let b=Math.ceil(w/m),A=[],S=Math.ceil(y/m);if(this.settings.direction==="rtl"&&!r){let L=b;b=v-S,S=v-L}A=[];for(var C=b;C<=S;C++){let L=C+1;A.push(L)}let k=this.mapping.page(u.contents,u.section.cfiBase,w,y);return{index:d,href:f,pages:A,totalPages:v,mapping:k}})}paginatedLocation(){let e=this.visible(),t=this.container.getBoundingClientRect(),i=0,s=0;return this.settings.fullsize&&(i=window.scrollX),e.map(a=>{let{index:o,href:l}=a.section,u,d=a.position(),f=a.width(),p,g,x;this.settings.direction==="rtl"?(u=t.right-i,x=Math.min(Math.abs(u-d.left),this.layout.width)-s,g=d.width-(d.right-u)-s,p=g-x):(u=t.left+i,x=Math.min(d.right-u,this.layout.width)-s,p=u-d.left+s,g=p+x),s+=x;let w=this.mapping.page(a.contents,a.section.cfiBase,p,g),y=this.layout.count(f).pages,m=Math.floor(p/this.layout.pageWidth),v=[],b=Math.floor(g/this.layout.pageWidth);if(m<0&&(m=0,b=b+1),this.settings.direction==="rtl"){let S=m;m=y-b,b=y-S}for(var A=m+1;A<=b;A++){let S=A;v.push(S)}return{index:o,href:l,pages:v,totalPages:y,mapping:w}})}isVisible(e,t,i,s){var r=e.position(),a=s||this.bounds();return this.settings.axis==="horizontal"&&r.right>a.left-t&&r.left<a.right+i?!0:this.settings.axis==="vertical"&&r.bottom>a.top-t&&r.top<a.bottom+i}visible(){for(var e=this.bounds(),t=this.views.displayed(),i=t.length,s=[],r,a,o=0;o<i;o++)a=t[o],r=this.isVisible(a,0,0,e),r===!0&&s.push(a);return s}scrollBy(e,t,i){let s=this.settings.direction==="rtl"?-1:1;i&&(this.ignore=!0),this.settings.fullsize?window.scrollBy(e*s,t*s):(e&&(this.container.scrollLeft+=e*s),t&&(this.container.scrollTop+=t)),this.scrolled=!0}scrollTo(e,t,i){i&&(this.ignore=!0),this.settings.fullsize?window.scrollTo(e,t):(this.container.scrollLeft=e,this.container.scrollTop=t),this.scrolled=!0}onScroll(){let e,t;this.settings.fullsize?(e=window.scrollY,t=window.scrollX):(e=this.container.scrollTop,t=this.container.scrollLeft),this.scrollTop=e,this.scrollLeft=t,this.ignore?this.ignore=!1:(this.emit($e.MANAGERS.SCROLL,{top:e,left:t}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout((function(){this.emit($e.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}).bind(this),20))}bounds(){var e;return e=this.stage.bounds(),e}applyLayout(e){this.layout=e,this.updateLayout(),this.views&&this.views.length>0&&this.layout.name==="pre-paginated"&&this.display(this.views.first().section)}updateLayout(){this.stage&&(this._stageSize=this.stage.size(),this.isPaginated?(this.layout.calculate(this._stageSize.width,this._stageSize.height,this.settings.gap),this.settings.offset=this.layout.delta/this.layout.divisor):this.layout.calculate(this._stageSize.width,this._stageSize.height),this.viewSettings.width=this.layout.width,this.viewSettings.height=this.layout.height,this.setLayout(this.layout))}setLayout(e){this.viewSettings.layout=e,this.mapping=new qb(e.props,this.settings.direction,this.settings.axis),this.views&&this.views.forEach(function(t){t&&t.setLayout(e)})}updateWritingMode(e){this.writingMode=e}updateAxis(e,t){!t&&e===this.settings.axis||(this.settings.axis=e,this.stage&&this.stage.axis(e),this.viewSettings.axis=e,this.mapping&&(this.mapping=new qb(this.layout.props,this.settings.direction,this.settings.axis)),this.layout&&(e==="vertical"?this.layout.spread("none"):this.layout.spread(this.layout.settings.spread)))}updateFlow(e,t="auto"){let i=e==="paginated"||e==="auto";this.isPaginated=i,e==="scrolled-doc"||e==="scrolled-continuous"||e==="scrolled"?this.updateAxis("vertical"):this.updateAxis("horizontal"),this.viewSettings.flow=e,this.settings.overflow?this.overflow=this.settings.overflow:this.overflow=i?"hidden":t,this.stage&&this.stage.overflow(this.overflow),this.updateLayout()}getContents(){var e=[];return this.views&&this.views.forEach(function(t){const i=t&&t.contents;i&&e.push(i)}),e}direction(e="ltr"){this.settings.direction=e,this.stage&&this.stage.direction(e),this.viewSettings.direction=e,this.updateLayout()}isRendered(){return this.rendered}}ro(Gb.prototype);const jq={easeInCubic:function(n){return Math.pow(n,3)}};class tA{constructor(e,t){this.settings=Bn({duration:80,minVelocity:.2,minDistance:10,easing:jq.easeInCubic},t||{}),this.supportsTouch=this.supportsTouch(),this.supportsTouch&&this.setup(e)}setup(e){this.manager=e,this.layout=this.manager.layout,this.fullsize=this.manager.settings.fullsize,this.fullsize?(this.element=this.manager.stage.element,this.scroller=window,this.disableScroll()):(this.element=this.manager.stage.container,this.scroller=this.element,this.element.style.WebkitOverflowScrolling="touch"),this.manager.settings.offset=this.layout.width,this.manager.settings.afterScrolledTimeout=this.settings.duration*2,this.isVertical=this.manager.settings.axis==="vertical",!(!this.manager.isPaginated||this.isVertical)&&(this.touchCanceler=!1,this.resizeCanceler=!1,this.snapping=!1,this.scrollLeft,this.scrollTop,this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0,this.addListeners())}supportsTouch(){return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)}disableScroll(){this.element.style.overflow="hidden"}enableScroll(){this.element.style.overflow=""}addListeners(){this._onResize=this.onResize.bind(this),window.addEventListener("resize",this._onResize),this._onScroll=this.onScroll.bind(this),this.scroller.addEventListener("scroll",this._onScroll),this._onTouchStart=this.onTouchStart.bind(this),this.scroller.addEventListener("touchstart",this._onTouchStart,{passive:!0}),this.on("touchstart",this._onTouchStart),this._onTouchMove=this.onTouchMove.bind(this),this.scroller.addEventListener("touchmove",this._onTouchMove,{passive:!0}),this.on("touchmove",this._onTouchMove),this._onTouchEnd=this.onTouchEnd.bind(this),this.scroller.addEventListener("touchend",this._onTouchEnd,{passive:!0}),this.on("touchend",this._onTouchEnd),this._afterDisplayed=this.afterDisplayed.bind(this),this.manager.on($e.MANAGERS.ADDED,this._afterDisplayed)}removeListeners(){window.removeEventListener("resize",this._onResize),this._onResize=void 0,this.scroller.removeEventListener("scroll",this._onScroll),this._onScroll=void 0,this.scroller.removeEventListener("touchstart",this._onTouchStart,{passive:!0}),this.off("touchstart",this._onTouchStart),this._onTouchStart=void 0,this.scroller.removeEventListener("touchmove",this._onTouchMove,{passive:!0}),this.off("touchmove",this._onTouchMove),this._onTouchMove=void 0,this.scroller.removeEventListener("touchend",this._onTouchEnd,{passive:!0}),this.off("touchend",this._onTouchEnd),this._onTouchEnd=void 0,this.manager.off($e.MANAGERS.ADDED,this._afterDisplayed),this._afterDisplayed=void 0}afterDisplayed(e){let t=e.contents;["touchstart","touchmove","touchend"].forEach(i=>{t.on(i,s=>this.triggerViewEvent(s,t))})}triggerViewEvent(e,t){this.emit(e.type,e,t)}onScroll(e){this.scrollLeft=this.fullsize?window.scrollX:this.scroller.scrollLeft,this.scrollTop=this.fullsize?window.scrollY:this.scroller.scrollTop}onResize(e){this.resizeCanceler=!0}onTouchStart(e){let{screenX:t,screenY:i}=e.touches[0];this.fullsize&&this.enableScroll(),this.touchCanceler=!0,this.startTouchX||(this.startTouchX=t,this.startTouchY=i,this.startTime=this.now()),this.endTouchX=t,this.endTouchY=i,this.endTime=this.now()}onTouchMove(e){let{screenX:t,screenY:i}=e.touches[0],s=Math.abs(i-this.endTouchY);this.touchCanceler=!0,!this.fullsize&&s<10&&(this.element.scrollLeft-=t-this.endTouchX),this.endTouchX=t,this.endTouchY=i,this.endTime=this.now()}onTouchEnd(e){this.fullsize&&this.disableScroll(),this.touchCanceler=!1;let t=this.wasSwiped();t!==0?this.snap(t):this.snap(),this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0}wasSwiped(){let e=this.layout.pageWidth*this.layout.divisor,t=this.endTouchX-this.startTouchX,i=Math.abs(t),s=this.endTime-this.startTime,r=t/s,a=this.settings.minVelocity;if(i<=this.settings.minDistance||i>=e)return 0;if(r>a)return-1;if(r<-a)return 1}needsSnap(){let e=this.scrollLeft,t=this.layout.pageWidth*this.layout.divisor;return e%t!==0}snap(e=0){let t=this.scrollLeft,i=this.layout.pageWidth*this.layout.divisor,s=Math.round(t/i)*i;return e&&(s+=e*i),this.smoothScrollTo(s)}smoothScrollTo(e){const t=new Dt,i=this.scrollLeft,s=this.now(),r=this.settings.duration,a=this.settings.easing;this.snapping=!0;function o(){const l=this.now(),u=Math.min(1,(l-s)/r);if(a(u),this.touchCanceler||this.resizeCanceler){this.resizeCanceler=!1,this.snapping=!1,t.resolve();return}u<1?(window.requestAnimationFrame(o.bind(this)),this.scrollTo(i+(e-i)*u,0)):(this.scrollTo(e,0),this.snapping=!1,t.resolve())}return o.call(this),t.promise}scrollTo(e=0,t=0){this.fullsize?window.scroll(e,t):(this.scroller.scrollLeft=e,this.scroller.scrollTop=t)}now(){return"now"in window.performance?performance.now():new Date().getTime()}destroy(){this.scroller&&(this.fullsize&&this.enableScroll(),this.removeListeners(),this.scroller=void 0)}}ro(tA.prototype);class Rq extends Gb{constructor(e){super(e),this.name="continuous",this.settings=Bn(this.settings||{},{infinite:!0,overflow:void 0,axis:void 0,writingMode:void 0,flow:"scrolled",offset:500,offsetDelta:250,width:void 0,height:void 0,snap:!1,afterScrolledTimeout:10,allowScriptedContent:!1,allowPopups:!1}),Bn(this.settings,e.settings||{}),e.settings.gap!="undefined"&&e.settings.gap===0&&(this.settings.gap=e.settings.gap),this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,width:0,height:0,forceEvenPages:!1,allowScriptedContent:this.settings.allowScriptedContent,allowPopups:this.settings.allowPopups},this.scrollTop=0,this.scrollLeft=0}display(e,t){return Gb.prototype.display.call(this,e,t).then((function(){return this.fill()}).bind(this))}fill(e){var t=e||new Dt;return this.q.enqueue(()=>this.check()).then(i=>{i?this.fill(t):t.resolve()}),t.promise}moveTo(e){var t=0,i=0;this.isPaginated?(t=Math.floor(e.left/this.layout.delta)*this.layout.delta,t+this.settings.offsetDelta):(i=e.top,e.top+this.settings.offsetDelta),(t>0||i>0)&&this.scrollBy(t,i,!0)}afterResized(e){this.emit($e.MANAGERS.RESIZE,e.section)}removeShownListeners(e){e.onDisplayed=function(){}}add(e){var t=this.createView(e);return this.views.append(t),t.on($e.VIEWS.RESIZED,i=>{t.expanded=!0}),t.on($e.VIEWS.AXIS,i=>{this.updateAxis(i)}),t.on($e.VIEWS.WRITING_MODE,i=>{this.updateWritingMode(i)}),t.onDisplayed=this.afterDisplayed.bind(this),t.onResize=this.afterResized.bind(this),t.display(this.request)}append(e){var t=this.createView(e);return t.on($e.VIEWS.RESIZED,i=>{t.expanded=!0}),t.on($e.VIEWS.AXIS,i=>{this.updateAxis(i)}),t.on($e.VIEWS.WRITING_MODE,i=>{this.updateWritingMode(i)}),this.views.append(t),t.onDisplayed=this.afterDisplayed.bind(this),t}prepend(e){var t=this.createView(e);return t.on($e.VIEWS.RESIZED,i=>{this.counter(i),t.expanded=!0}),t.on($e.VIEWS.AXIS,i=>{this.updateAxis(i)}),t.on($e.VIEWS.WRITING_MODE,i=>{this.updateWritingMode(i)}),this.views.prepend(t),t.onDisplayed=this.afterDisplayed.bind(this),t}counter(e){this.settings.axis==="vertical"?this.scrollBy(0,e.heightDelta,!0):this.scrollBy(e.widthDelta,0,!0)}update(e){for(var t=this.bounds(),i=this.views.all(),s=i.length,r=typeof e<"u"?e:this.settings.offset||0,a,o,l=new Dt,u=[],d=0;d<s;d++)if(o=i[d],a=this.isVisible(o,r,r,t),a===!0)if(o.displayed)o.show();else{let f=o.display(this.request).then(function(p){p.show()},p=>{o.hide()});u.push(f)}else this.q.enqueue(o.destroy.bind(o)),clearTimeout(this.trimTimeout),this.trimTimeout=setTimeout((function(){this.q.enqueue(this.trim.bind(this))}).bind(this),250);return u.length?Promise.all(u).catch(f=>{l.reject(f)}):(l.resolve(),l.promise)}check(e,t){var i=new Dt,s=[],r=this.settings.axis==="horizontal",a=this.settings.offset||0;e&&r&&(a=e),t&&!r&&(a=t);var o=this._bounds;let l=r?this.scrollLeft:this.scrollTop,u=r?Math.floor(o.width):o.height,d=r?this.container.scrollWidth:this.container.scrollHeight,f=this.writingMode&&this.writingMode.indexOf("vertical")===0?"vertical":"horizontal",p=this.settings.rtlScrollType,g=this.settings.direction==="rtl";this.settings.fullsize?(r&&g&&p==="negative"||!r&&g&&p==="default")&&(l=l*-1):(g&&p==="default"&&f==="horizontal"&&(l=d-u-l),g&&p==="negative"&&f==="horizontal"&&(l=l*-1));let x=()=>{let b=this.views.first(),A=b&&b.section.prev();A&&s.push(this.prepend(A))},w=()=>{let b=this.views.last(),A=b&&b.section.next();A&&s.push(this.append(A))},y=l+u+a,m=l-a;y>=d&&w(),m<0&&x();let v=s.map(b=>b.display(this.request));return s.length?Promise.all(v).then(()=>this.check()).then(()=>this.update(a),b=>b):(this.q.enqueue((function(){this.update()}).bind(this)),i.resolve(!1),i.promise)}trim(){for(var e=new Dt,t=this.views.displayed(),i=t[0],s=t[t.length-1],r=this.views.indexOf(i),a=this.views.indexOf(s),o=this.views.slice(0,r),l=this.views.slice(a+1),u=0;u<o.length-1;u++)this.erase(o[u],o);for(var d=1;d<l.length;d++)this.erase(l[d]);return e.resolve(),e.promise}erase(e,t){var i,s;this.settings.fullsize?(i=window.scrollY,s=window.scrollX):(i=this.container.scrollTop,s=this.container.scrollLeft);var r=e.bounds();this.views.remove(e),t&&(this.settings.axis==="vertical"?this.scrollTo(0,i-r.height,!0):this.settings.direction==="rtl"?this.settings.fullsize?this.scrollTo(s+Math.floor(r.width),0,!0):this.scrollTo(s,0,!0):this.scrollTo(s-Math.floor(r.width),0,!0))}addEventListeners(e){window.addEventListener("unload",(function(t){this.ignore=!0,this.destroy()}).bind(this)),this.addScrollListeners(),this.isPaginated&&this.settings.snap&&(this.snapper=new tA(this,this.settings.snap&&typeof this.settings.snap=="object"&&this.settings.snap))}addScrollListeners(){var e;this.tick=n_;let t=this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"?-1:1;this.scrollDeltaVert=0,this.scrollDeltaHorz=0,this.settings.fullsize?(e=window,this.scrollTop=window.scrollY*t,this.scrollLeft=window.scrollX*t):(e=this.container,this.scrollTop=this.container.scrollTop,this.scrollLeft=this.container.scrollLeft),this._onScroll=this.onScroll.bind(this),e.addEventListener("scroll",this._onScroll),this._scrolled=Sq(this.scrolled.bind(this),30),this.didScroll=!1}removeEventListeners(){var e;this.settings.fullsize?e=window:e=this.container,e.removeEventListener("scroll",this._onScroll),this._onScroll=void 0}onScroll(){let e,t,i=this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"?-1:1;this.settings.fullsize?(e=window.scrollY*i,t=window.scrollX*i):(e=this.container.scrollTop,t=this.container.scrollLeft),this.scrollTop=e,this.scrollLeft=t,this.ignore?this.ignore=!1:this._scrolled(),this.scrollDeltaVert+=Math.abs(e-this.prevScrollTop),this.scrollDeltaHorz+=Math.abs(t-this.prevScrollLeft),this.prevScrollTop=e,this.prevScrollLeft=t,clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout((function(){this.scrollDeltaVert=0,this.scrollDeltaHorz=0}).bind(this),150),clearTimeout(this.afterScrolled),this.didScroll=!1}scrolled(){this.q.enqueue((function(){return this.check()}).bind(this)),this.emit($e.MANAGERS.SCROLL,{top:this.scrollTop,left:this.scrollLeft}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout((function(){this.snapper&&this.snapper.supportsTouch&&this.snapper.needsSnap()||this.emit($e.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}).bind(this),this.settings.afterScrolledTimeout)}next(){let e=this.layout.props.name==="pre-paginated"&&this.layout.props.spread?this.layout.props.delta*2:this.layout.props.delta;this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"?this.scrollBy(e,0,!0):this.scrollBy(0,this.layout.height,!0),this.q.enqueue((function(){return this.check()}).bind(this)))}prev(){let e=this.layout.props.name==="pre-paginated"&&this.layout.props.spread?this.layout.props.delta*2:this.layout.props.delta;this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"?this.scrollBy(-e,0,!0):this.scrollBy(0,-this.layout.height,!0),this.q.enqueue((function(){return this.check()}).bind(this)))}updateFlow(e){this.rendered&&this.snapper&&(this.snapper.destroy(),this.snapper=void 0),super.updateFlow(e,"scroll"),this.rendered&&this.isPaginated&&this.settings.snap&&(this.snapper=new tA(this,this.settings.snap&&typeof this.settings.snap=="object"&&this.settings.snap))}destroy(){super.destroy(),this.snapper&&this.snapper.destroy()}}class u_{constructor(e,t){this.settings=Bn(this.settings||{},{width:null,height:null,ignoreClass:"",manager:"default",view:"iframe",flow:null,layout:null,spread:null,minSpreadWidth:800,stylesheet:null,resizeOnOrientationChange:!0,script:null,snap:!1,defaultDirection:"ltr",allowScriptedContent:!1,allowPopups:!1}),Bn(this.settings,t),typeof this.settings.manager=="object"&&(this.manager=this.settings.manager),this.book=e,this.hooks={},this.hooks.display=new fa(this),this.hooks.serialize=new fa(this),this.hooks.content=new fa(this),this.hooks.unloaded=new fa(this),this.hooks.layout=new fa(this),this.hooks.render=new fa(this),this.hooks.show=new fa(this),this.hooks.content.register(this.handleLinks.bind(this)),this.hooks.content.register(this.passEvents.bind(this)),this.hooks.content.register(this.adjustImages.bind(this)),this.book.spine.hooks.content.register(this.injectIdentifier.bind(this)),this.settings.stylesheet&&this.book.spine.hooks.content.register(this.injectStylesheet.bind(this)),this.settings.script&&this.book.spine.hooks.content.register(this.injectScript.bind(this)),this.themes=new l$(this),this.annotations=new h$(this),this.epubcfi=new jt,this.q=new a_(this),this.location=void 0,this.q.enqueue(this.book.opened),this.starting=new Dt,this.started=this.starting.promise,this.q.enqueue(this.start)}setManager(e){this.manager=e}requireManager(e){var t;return typeof e=="string"&&e==="default"?t=Gb:typeof e=="string"&&e==="continuous"?t=Rq:t=e,t}requireView(e){var t;return typeof e=="string"&&e==="iframe"?t=k4:t=e,t}start(){switch(!this.settings.layout&&(this.book.package.metadata.layout==="pre-paginated"||this.book.displayOptions.fixedLayout==="true")&&(this.settings.layout="pre-paginated"),this.book.package.metadata.spread){case"none":this.settings.spread="none";break;case"both":this.settings.spread=!0;break}this.manager||(this.ViewManager=this.requireManager(this.settings.manager),this.View=this.requireView(this.settings.view),this.manager=new this.ViewManager({view:this.View,queue:this.q,request:this.book.load.bind(this.book),settings:this.settings})),this.direction(this.book.package.metadata.direction||this.settings.defaultDirection),this.settings.globalLayoutProperties=this.determineLayoutProperties(this.book.package.metadata),this.flow(this.settings.globalLayoutProperties.flow),this.layout(this.settings.globalLayoutProperties),this.manager.on($e.MANAGERS.ADDED,this.afterDisplayed.bind(this)),this.manager.on($e.MANAGERS.REMOVED,this.afterRemoved.bind(this)),this.manager.on($e.MANAGERS.RESIZED,this.onResized.bind(this)),this.manager.on($e.MANAGERS.ORIENTATION_CHANGE,this.onOrientationChange.bind(this)),this.manager.on($e.MANAGERS.SCROLLED,this.reportLocation.bind(this)),this.emit($e.RENDITION.STARTED),this.starting.resolve()}attachTo(e){return this.q.enqueue((function(){this.manager.render(e,{width:this.settings.width,height:this.settings.height}),this.emit($e.RENDITION.ATTACHED)}).bind(this))}display(e){return this.displaying&&this.displaying.resolve(),this.q.enqueue(this._display,e)}_display(e){if(this.book){this.epubcfi.isCfiString(e);var t=new Dt,i=t.promise,s;return this.displaying=t,this.book.locations.length()&&a4(e)&&(e=this.book.locations.cfiFromPercentage(parseFloat(e))),s=this.book.spine.get(e),s?(this.manager.display(s,e).then(()=>{t.resolve(s),this.displaying=void 0,this.emit($e.RENDITION.DISPLAYED,s),this.reportLocation()},r=>{this.emit($e.RENDITION.DISPLAY_ERROR,r)}),i):(t.reject(new Error("No Section Found")),i)}}afterDisplayed(e){e.on($e.VIEWS.MARK_CLICKED,(t,i)=>this.triggerMarkEvent(t,i,e.contents)),this.hooks.render.trigger(e,this).then(()=>{e.contents?this.hooks.content.trigger(e.contents,this).then(()=>{this.emit($e.RENDITION.RENDERED,e.section,e)}):this.emit($e.RENDITION.RENDERED,e.section,e)})}afterRemoved(e){this.hooks.unloaded.trigger(e,this).then(()=>{this.emit($e.RENDITION.REMOVED,e.section,e)})}onResized(e,t){this.emit($e.RENDITION.RESIZED,{width:e.width,height:e.height},t),this.location&&this.location.start&&this.display(t||this.location.start.cfi)}onOrientationChange(e){this.emit($e.RENDITION.ORIENTATION_CHANGE,e)}moveTo(e){this.manager.moveTo(e)}resize(e,t,i){e&&(this.settings.width=e),t&&(this.settings.height=t),this.manager.resize(e,t,i)}clear(){this.manager.clear()}next(){return this.q.enqueue(this.manager.next.bind(this.manager)).then(this.reportLocation.bind(this))}prev(){return this.q.enqueue(this.manager.prev.bind(this.manager)).then(this.reportLocation.bind(this))}determineLayoutProperties(e){var t,i=this.settings.layout||e.layout||"reflowable",s=this.settings.spread||e.spread||"auto",r=this.settings.orientation||e.orientation||"auto",a=this.settings.flow||e.flow||"auto",o=e.viewport||"",l=this.settings.minSpreadWidth||e.minSpreadWidth||800,u=this.settings.direction||e.direction||"ltr";return(this.settings.width===0||this.settings.width>0)&&(this.settings.height===0||this.settings.height>0),t={layout:i,spread:s,orientation:r,flow:a,viewport:o,minSpreadWidth:l,direction:u},t}flow(e){var t=e;(e==="scrolled"||e==="scrolled-doc"||e==="scrolled-continuous")&&(t="scrolled"),(e==="auto"||e==="paginated")&&(t="paginated"),this.settings.flow=e,this._layout&&this._layout.flow(t),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this.manager&&this.manager.updateFlow(t),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}layout(e){return e&&(this._layout=new v4(e),this._layout.spread(e.spread,this.settings.minSpreadWidth),this._layout.on($e.LAYOUT.UPDATED,(t,i)=>{this.emit($e.RENDITION.LAYOUT,t,i)})),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this._layout}spread(e,t){this.settings.spread=e,t&&(this.settings.minSpreadWidth=t),this._layout&&this._layout.spread(e,t),this.manager&&this.manager.isRendered()&&this.manager.updateLayout()}direction(e){this.settings.direction=e||"ltr",this.manager&&this.manager.direction(this.settings.direction),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}reportLocation(){return this.q.enqueue((function(){requestAnimationFrame((function(){var i=this.manager.currentLocation();if(i&&i.then&&typeof i.then=="function")i.then((function(s){let r=this.located(s);!r||!r.start||!r.end||(this.location=r,this.emit($e.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit($e.RENDITION.RELOCATED,this.location))}).bind(this));else if(i){let s=this.located(i);if(!s||!s.start||!s.end)return;this.location=s,this.emit($e.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit($e.RENDITION.RELOCATED,this.location)}}).bind(this))}).bind(this))}currentLocation(){var e=this.manager.currentLocation();if(e&&e.then&&typeof e.then=="function")e.then((function(t){return this.located(t)}).bind(this));else if(e)return this.located(e)}located(e){if(!e.length)return{};let t=e[0],i=e[e.length-1],s={start:{index:t.index,href:t.href,cfi:t.mapping.start,displayed:{page:t.pages[0]||1,total:t.totalPages}},end:{index:i.index,href:i.href,cfi:i.mapping.end,displayed:{page:i.pages[i.pages.length-1]||1,total:i.totalPages}}},r=this.book.locations.locationFromCfi(t.mapping.start),a=this.book.locations.locationFromCfi(i.mapping.end);r!=null&&(s.start.location=r,s.start.percentage=this.book.locations.percentageFromLocation(r)),a!=null&&(s.end.location=a,s.end.percentage=this.book.locations.percentageFromLocation(a));let o=this.book.pageList.pageFromCfi(t.mapping.start),l=this.book.pageList.pageFromCfi(i.mapping.end);return o!=-1&&(s.start.page=o),l!=-1&&(s.end.page=l),i.index===this.book.spine.last().index&&s.end.displayed.page>=s.end.displayed.total&&(s.atEnd=!0),t.index===this.book.spine.first().index&&s.start.displayed.page===1&&(s.atStart=!0),s}destroy(){this.manager&&this.manager.destroy(),this.book=void 0}passEvents(e){mx.forEach(t=>{e.on(t,i=>this.triggerViewEvent(i,e))}),e.on($e.CONTENTS.SELECTED,t=>this.triggerSelectedEvent(t,e))}triggerViewEvent(e,t){this.emit(e.type,e,t)}triggerSelectedEvent(e,t){this.emit($e.RENDITION.SELECTED,e,t)}triggerMarkEvent(e,t,i){this.emit($e.RENDITION.MARK_CLICKED,e,t,i)}getRange(e,t){var i=new jt(e),s=this.manager.visible().filter(function(r){if(i.spinePos===r.index)return!0});if(s.length)return s[0].contents.range(i,t)}adjustImages(e){if(this._layout.name==="pre-paginated")return new Promise(function(r){r()});let t=e.window.getComputedStyle(e.content,null),i=(e.content.offsetHeight-(parseFloat(t.paddingTop)+parseFloat(t.paddingBottom)))*.95,s=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight);return e.addStylesheetRules({img:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-s+"px":"100%")+"!important","max-height":i+"px!important","object-fit":"contain","page-break-inside":"avoid","break-inside":"avoid","box-sizing":"border-box"},svg:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-s+"px":"100%")+"!important","max-height":i+"px!important","page-break-inside":"avoid","break-inside":"avoid"}}),new Promise(function(r,a){setTimeout(function(){r()},1)})}getContents(){return this.manager?this.manager.getContents():[]}views(){return(this.manager?this.manager.views:void 0)||[]}handleLinks(e){e&&e.on($e.CONTENTS.LINK_CLICKED,t=>{let i=this.book.path.relative(t);this.display(i)})}injectStylesheet(e,t){let i=e.createElement("link");i.setAttribute("type","text/css"),i.setAttribute("rel","stylesheet"),i.setAttribute("href",this.settings.stylesheet),e.getElementsByTagName("head")[0].appendChild(i)}injectScript(e,t){let i=e.createElement("script");i.setAttribute("type","text/javascript"),i.setAttribute("src",this.settings.script),i.textContent=" ",e.getElementsByTagName("head")[0].appendChild(i)}injectIdentifier(e,t){let i=this.book.packaging.metadata.identifier,s=e.createElement("meta");s.setAttribute("name","dc.relation.ispartof"),i&&s.setAttribute("content",i),e.getElementsByTagName("head")[0].appendChild(s)}}ro(u_.prototype);function Fc(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var L4={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(n,e){(function(t){n.exports=t()})(function(){return function t(i,s,r){function a(u,d){if(!s[u]){if(!i[u]){var f=typeof Fc=="function"&&Fc;if(!d&&f)return f(u,!0);if(o)return o(u,!0);var p=new Error("Cannot find module '"+u+"'");throw p.code="MODULE_NOT_FOUND",p}var g=s[u]={exports:{}};i[u][0].call(g.exports,function(x){var w=i[u][1][x];return a(w||x)},g,g.exports,t,i,s,r)}return s[u].exports}for(var o=typeof Fc=="function"&&Fc,l=0;l<r.length;l++)a(r[l]);return a}({1:[function(t,i,s){var r=t("./utils"),a=t("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";s.encode=function(l){for(var u=[],d,f,p,g,x,w,y,m=0,v=l.length,b=v,A=r.getTypeOf(l)!=="string";m<l.length;)b=v-m,A?(d=l[m++],f=m<v?l[m++]:0,p=m<v?l[m++]:0):(d=l.charCodeAt(m++),f=m<v?l.charCodeAt(m++):0,p=m<v?l.charCodeAt(m++):0),g=d>>2,x=(d&3)<<4|f>>4,w=b>1?(f&15)<<2|p>>6:64,y=b>2?p&63:64,u.push(o.charAt(g)+o.charAt(x)+o.charAt(w)+o.charAt(y));return u.join("")},s.decode=function(l){var u,d,f,p,g,x,w,y=0,m=0,v="data:";if(l.substr(0,v.length)===v)throw new Error("Invalid base64 input, it looks like a data url.");l=l.replace(/[^A-Za-z0-9+/=]/g,"");var b=l.length*3/4;if(l.charAt(l.length-1)===o.charAt(64)&&b--,l.charAt(l.length-2)===o.charAt(64)&&b--,b%1!==0)throw new Error("Invalid base64 input, bad content length.");var A;for(a.uint8array?A=new Uint8Array(b|0):A=new Array(b|0);y<l.length;)p=o.indexOf(l.charAt(y++)),g=o.indexOf(l.charAt(y++)),x=o.indexOf(l.charAt(y++)),w=o.indexOf(l.charAt(y++)),u=p<<2|g>>4,d=(g&15)<<4|x>>2,f=(x&3)<<6|w,A[m++]=u,x!==64&&(A[m++]=d),w!==64&&(A[m++]=f);return A}},{"./support":30,"./utils":32}],2:[function(t,i,s){var r=t("./external"),a=t("./stream/DataWorker"),o=t("./stream/Crc32Probe"),l=t("./stream/DataLengthProbe");function u(d,f,p,g,x){this.compressedSize=d,this.uncompressedSize=f,this.crc32=p,this.compression=g,this.compressedContent=x}u.prototype={getContentWorker:function(){var d=new a(r.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),f=this;return d.on("end",function(){if(this.streamInfo.data_length!==f.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),d},getCompressedWorker:function(){return new a(r.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},u.createWorkerFrom=function(d,f,p){return d.pipe(new o).pipe(new l("uncompressedSize")).pipe(f.compressWorker(p)).pipe(new l("compressedSize")).withStreamInfo("compression",f)},i.exports=u},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,i,s){var r=t("./stream/GenericWorker");s.STORE={magic:"\0\0",compressWorker:function(){return new r("STORE compression")},uncompressWorker:function(){return new r("STORE decompression")}},s.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,i,s){var r=t("./utils");function a(){for(var d,f=[],p=0;p<256;p++){d=p;for(var g=0;g<8;g++)d=d&1?3988292384^d>>>1:d>>>1;f[p]=d}return f}var o=a();function l(d,f,p,g){var x=o,w=g+p;d=d^-1;for(var y=g;y<w;y++)d=d>>>8^x[(d^f[y])&255];return d^-1}function u(d,f,p,g){var x=o,w=g+p;d=d^-1;for(var y=g;y<w;y++)d=d>>>8^x[(d^f.charCodeAt(y))&255];return d^-1}i.exports=function(f,p){if(typeof f>"u"||!f.length)return 0;var g=r.getTypeOf(f)!=="string";return g?l(p|0,f,f.length,0):u(p|0,f,f.length,0)}},{"./utils":32}],5:[function(t,i,s){s.base64=!1,s.binary=!1,s.dir=!1,s.createFolders=!0,s.date=null,s.compression=null,s.compressionOptions=null,s.comment=null,s.unixPermissions=null,s.dosPermissions=null},{}],6:[function(t,i,s){var r=null;typeof Promise<"u"?r=Promise:r=t("lie"),i.exports={Promise:r}},{lie:37}],7:[function(t,i,s){var r=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",a=t("pako"),o=t("./utils"),l=t("./stream/GenericWorker"),u=r?"uint8array":"array";s.magic="\b\0";function d(f,p){l.call(this,"FlateWorker/"+f),this._pako=null,this._pakoAction=f,this._pakoOptions=p,this.meta={}}o.inherits(d,l),d.prototype.processChunk=function(f){this.meta=f.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(u,f.data),!1)},d.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},d.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},d.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var f=this;this._pako.onData=function(p){f.push({data:p,meta:f.meta})}},s.compressWorker=function(f){return new d("Deflate",f)},s.uncompressWorker=function(){return new d("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,i,s){var r=t("../utils"),a=t("../stream/GenericWorker"),o=t("../utf8"),l=t("../crc32"),u=t("../signature"),d=function(m,v){var b="",A;for(A=0;A<v;A++)b+=String.fromCharCode(m&255),m=m>>>8;return b},f=function(m,v){var b=m;return m||(b=v?16893:33204),(b&65535)<<16},p=function(m){return(m||0)&63},g=function(m,v,b,A,S,C){var k=m.file,L=m.compression,D=C!==o.utf8encode,j=r.transformTo("string",C(k.name)),P=r.transformTo("string",o.utf8encode(k.name)),H=k.comment,G=r.transformTo("string",C(H)),$=r.transformTo("string",o.utf8encode(H)),Y=P.length!==k.name.length,F=$.length!==H.length,M,I,V="",ie="",ge="",ee=k.dir,me=k.date,oe={crc32:0,compressedSize:0,uncompressedSize:0};(!v||b)&&(oe.crc32=m.crc32,oe.compressedSize=m.compressedSize,oe.uncompressedSize=m.uncompressedSize);var ae=0;v&&(ae|=8),!D&&(Y||F)&&(ae|=2048);var Z=0,re=0;ee&&(Z|=16),S==="UNIX"?(re=798,Z|=f(k.unixPermissions,ee)):(re=20,Z|=p(k.dosPermissions)),M=me.getUTCHours(),M=M<<6,M=M|me.getUTCMinutes(),M=M<<5,M=M|me.getUTCSeconds()/2,I=me.getUTCFullYear()-1980,I=I<<4,I=I|me.getUTCMonth()+1,I=I<<5,I=I|me.getUTCDate(),Y&&(ie=d(1,1)+d(l(j),4)+P,V+="up"+d(ie.length,2)+ie),F&&(ge=d(1,1)+d(l(G),4)+$,V+="uc"+d(ge.length,2)+ge);var ne="";ne+=`
\0`,ne+=d(ae,2),ne+=L.magic,ne+=d(M,2),ne+=d(I,2),ne+=d(oe.crc32,4),ne+=d(oe.compressedSize,4),ne+=d(oe.uncompressedSize,4),ne+=d(j.length,2),ne+=d(V.length,2);var xe=u.LOCAL_FILE_HEADER+ne+j+V,Re=u.CENTRAL_FILE_HEADER+d(re,2)+ne+d(G.length,2)+"\0\0\0\0"+d(Z,4)+d(A,4)+j+V+G;return{fileRecord:xe,dirRecord:Re}},x=function(m,v,b,A,S){var C="",k=r.transformTo("string",S(A));return C=u.CENTRAL_DIRECTORY_END+"\0\0\0\0"+d(m,2)+d(m,2)+d(v,4)+d(b,4)+d(k.length,2)+k,C},w=function(m){var v="";return v=u.DATA_DESCRIPTOR+d(m.crc32,4)+d(m.compressedSize,4)+d(m.uncompressedSize,4),v};function y(m,v,b,A){a.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=v,this.zipPlatform=b,this.encodeFileName=A,this.streamFiles=m,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}r.inherits(y,a),y.prototype.push=function(m){var v=m.meta.percent||0,b=this.entriesCount,A=this._sources.length;this.accumulate?this.contentBuffer.push(m):(this.bytesWritten+=m.data.length,a.prototype.push.call(this,{data:m.data,meta:{currentFile:this.currentFile,percent:b?(v+100*(b-A-1))/b:100}}))},y.prototype.openedSource=function(m){this.currentSourceOffset=this.bytesWritten,this.currentFile=m.file.name;var v=this.streamFiles&&!m.file.dir;if(v){var b=g(m,v,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:b.fileRecord,meta:{percent:0}})}else this.accumulate=!0},y.prototype.closedSource=function(m){this.accumulate=!1;var v=this.streamFiles&&!m.file.dir,b=g(m,v,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(b.dirRecord),v)this.push({data:w(m),meta:{percent:100}});else for(this.push({data:b.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},y.prototype.flush=function(){for(var m=this.bytesWritten,v=0;v<this.dirRecords.length;v++)this.push({data:this.dirRecords[v],meta:{percent:100}});var b=this.bytesWritten-m,A=x(this.dirRecords.length,b,m,this.zipComment,this.encodeFileName);this.push({data:A,meta:{percent:100}})},y.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},y.prototype.registerPrevious=function(m){this._sources.push(m);var v=this;return m.on("data",function(b){v.processChunk(b)}),m.on("end",function(){v.closedSource(v.previous.streamInfo),v._sources.length?v.prepareNextSource():v.end()}),m.on("error",function(b){v.error(b)}),this},y.prototype.resume=function(){if(!a.prototype.resume.call(this))return!1;if(!this.previous&&this._sources.length)return this.prepareNextSource(),!0;if(!this.previous&&!this._sources.length&&!this.generatedError)return this.end(),!0},y.prototype.error=function(m){var v=this._sources;if(!a.prototype.error.call(this,m))return!1;for(var b=0;b<v.length;b++)try{v[b].error(m)}catch{}return!0},y.prototype.lock=function(){a.prototype.lock.call(this);for(var m=this._sources,v=0;v<m.length;v++)m[v].lock()},i.exports=y},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,i,s){var r=t("../compressions"),a=t("./ZipFileWorker"),o=function(l,u){var d=l||u,f=r[d];if(!f)throw new Error(d+" is not a valid compression method !");return f};s.generateWorker=function(l,u,d){var f=new a(u.streamFiles,d,u.platform,u.encodeFileName),p=0;try{l.forEach(function(g,x){p++;var w=o(x.options.compression,u.compression),y=x.options.compressionOptions||u.compressionOptions||{},m=x.dir,v=x.date;x._compressWorker(w,y).withStreamInfo("file",{name:g,dir:m,date:v,comment:x.comment||"",unixPermissions:x.unixPermissions,dosPermissions:x.dosPermissions}).pipe(f)}),f.entriesCount=p}catch(g){f.error(g)}return f}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,i,s){function r(){if(!(this instanceof r))return new r;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new r;for(var o in this)typeof this[o]!="function"&&(a[o]=this[o]);return a}}r.prototype=t("./object"),r.prototype.loadAsync=t("./load"),r.support=t("./support"),r.defaults=t("./defaults"),r.version="3.10.1",r.loadAsync=function(a,o){return new r().loadAsync(a,o)},r.external=t("./external"),i.exports=r},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,i,s){var r=t("./utils"),a=t("./external"),o=t("./utf8"),l=t("./zipEntries"),u=t("./stream/Crc32Probe"),d=t("./nodejsUtils");function f(p){return new a.Promise(function(g,x){var w=p.decompressed.getContentWorker().pipe(new u);w.on("error",function(y){x(y)}).on("end",function(){w.streamInfo.crc32!==p.decompressed.crc32?x(new Error("Corrupted zip : CRC32 mismatch")):g()}).resume()})}i.exports=function(p,g){var x=this;return g=r.extend(g||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),d.isNode&&d.isStream(p)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):r.prepareContent("the loaded zip file",p,!0,g.optimizedBinaryString,g.base64).then(function(w){var y=new l(g);return y.load(w),y}).then(function(y){var m=[a.Promise.resolve(y)],v=y.files;if(g.checkCRC32)for(var b=0;b<v.length;b++)m.push(f(v[b]));return a.Promise.all(m)}).then(function(y){for(var m=y.shift(),v=m.files,b=0;b<v.length;b++){var A=v[b],S=A.fileNameStr,C=r.resolve(A.fileNameStr);x.file(C,A.decompressed,{binary:!0,optimizedBinaryString:!0,date:A.date,dir:A.dir,comment:A.fileCommentStr.length?A.fileCommentStr:null,unixPermissions:A.unixPermissions,dosPermissions:A.dosPermissions,createFolders:g.createFolders}),A.dir||(x.file(C).unsafeOriginalName=S)}return m.zipComment.length&&(x.comment=m.zipComment),x})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,i,s){var r=t("../utils"),a=t("../stream/GenericWorker");function o(l,u){a.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(u)}r.inherits(o,a),o.prototype._bindStream=function(l){var u=this;this._stream=l,l.pause(),l.on("data",function(d){u.push({data:d,meta:{percent:0}})}).on("error",function(d){u.isPaused?this.generatedError=d:u.error(d)}).on("end",function(){u.isPaused?u._upstreamEnded=!0:u.end()})},o.prototype.pause=function(){return a.prototype.pause.call(this)?(this._stream.pause(),!0):!1},o.prototype.resume=function(){return a.prototype.resume.call(this)?(this._upstreamEnded?this.end():this._stream.resume(),!0):!1},i.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,i,s){var r=t("readable-stream").Readable,a=t("../utils");a.inherits(o,r);function o(l,u,d){r.call(this,u),this._helper=l;var f=this;l.on("data",function(p,g){f.push(p)||f._helper.pause(),d&&d(g)}).on("error",function(p){f.emit("error",p)}).on("end",function(){f.push(null)})}o.prototype._read=function(){this._helper.resume()},i.exports=o},{"../utils":32,"readable-stream":16}],14:[function(t,i,s){i.exports={isNode:typeof Buffer<"u",newBufferFrom:function(r,a){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(r,a);if(typeof r=="number")throw new Error('The "data" argument must not be a number');return new Buffer(r,a)},allocBuffer:function(r){if(Buffer.alloc)return Buffer.alloc(r);var a=new Buffer(r);return a.fill(0),a},isBuffer:function(r){return Buffer.isBuffer(r)},isStream:function(r){return r&&typeof r.on=="function"&&typeof r.pause=="function"&&typeof r.resume=="function"}}},{}],15:[function(t,i,s){var r=t("./utf8"),a=t("./utils"),o=t("./stream/GenericWorker"),l=t("./stream/StreamHelper"),u=t("./defaults"),d=t("./compressedObject"),f=t("./zipObject"),p=t("./generate"),g=t("./nodejsUtils"),x=t("./nodejs/NodejsStreamInputAdapter"),w=function(S,C,k){var L=a.getTypeOf(C),D,j=a.extend(k||{},u);j.date=j.date||new Date,j.compression!==null&&(j.compression=j.compression.toUpperCase()),typeof j.unixPermissions=="string"&&(j.unixPermissions=parseInt(j.unixPermissions,8)),j.unixPermissions&&j.unixPermissions&16384&&(j.dir=!0),j.dosPermissions&&j.dosPermissions&16&&(j.dir=!0),j.dir&&(S=m(S)),j.createFolders&&(D=y(S))&&v.call(this,D,!0);var P=L==="string"&&j.binary===!1&&j.base64===!1;(!k||typeof k.binary>"u")&&(j.binary=!P);var H=C instanceof d&&C.uncompressedSize===0;(H||j.dir||!C||C.length===0)&&(j.base64=!1,j.binary=!0,C="",j.compression="STORE",L="string");var G=null;C instanceof d||C instanceof o?G=C:g.isNode&&g.isStream(C)?G=new x(S,C):G=a.prepareContent(S,C,j.binary,j.optimizedBinaryString,j.base64);var $=new f(S,G,j);this.files[S]=$},y=function(S){S.slice(-1)==="/"&&(S=S.substring(0,S.length-1));var C=S.lastIndexOf("/");return C>0?S.substring(0,C):""},m=function(S){return S.slice(-1)!=="/"&&(S+="/"),S},v=function(S,C){return C=typeof C<"u"?C:u.createFolders,S=m(S),this.files[S]||w.call(this,S,null,{dir:!0,createFolders:C}),this.files[S]};function b(S){return Object.prototype.toString.call(S)==="[object RegExp]"}var A={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(S){var C,k,L;for(C in this.files)L=this.files[C],k=C.slice(this.root.length,C.length),k&&C.slice(0,this.root.length)===this.root&&S(k,L)},filter:function(S){var C=[];return this.forEach(function(k,L){S(k,L)&&C.push(L)}),C},file:function(S,C,k){if(arguments.length===1)if(b(S)){var L=S;return this.filter(function(j,P){return!P.dir&&L.test(j)})}else{var D=this.files[this.root+S];return D&&!D.dir?D:null}else S=this.root+S,w.call(this,S,C,k);return this},folder:function(S){if(!S)return this;if(b(S))return this.filter(function(D,j){return j.dir&&S.test(D)});var C=this.root+S,k=v.call(this,C),L=this.clone();return L.root=k.name,L},remove:function(S){S=this.root+S;var C=this.files[S];if(C||(S.slice(-1)!=="/"&&(S+="/"),C=this.files[S]),C&&!C.dir)delete this.files[S];else for(var k=this.filter(function(D,j){return j.name.slice(0,S.length)===S}),L=0;L<k.length;L++)delete this.files[k[L].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(S){var C,k={};try{if(k=a.extend(S||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:r.utf8encode}),k.type=k.type.toLowerCase(),k.compression=k.compression.toUpperCase(),k.type==="binarystring"&&(k.type="string"),!k.type)throw new Error("No output type specified.");a.checkSupport(k.type),(k.platform==="darwin"||k.platform==="freebsd"||k.platform==="linux"||k.platform==="sunos")&&(k.platform="UNIX"),k.platform==="win32"&&(k.platform="DOS");var L=k.comment||this.comment||"";C=p.generateWorker(this,k,L)}catch(D){C=new o("error"),C.error(D)}return new l(C,k.type||"string",k.mimeType)},generateAsync:function(S,C){return this.generateInternalStream(S).accumulate(C)},generateNodeStream:function(S,C){return S=S||{},S.type||(S.type="nodebuffer"),this.generateInternalStream(S).toNodejsStream(C)}};i.exports=A},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,i,s){i.exports=t("stream")},{stream:void 0}],17:[function(t,i,s){var r=t("./DataReader"),a=t("../utils");function o(l){r.call(this,l);for(var u=0;u<this.data.length;u++)l[u]=l[u]&255}a.inherits(o,r),o.prototype.byteAt=function(l){return this.data[this.zero+l]},o.prototype.lastIndexOfSignature=function(l){for(var u=l.charCodeAt(0),d=l.charCodeAt(1),f=l.charCodeAt(2),p=l.charCodeAt(3),g=this.length-4;g>=0;--g)if(this.data[g]===u&&this.data[g+1]===d&&this.data[g+2]===f&&this.data[g+3]===p)return g-this.zero;return-1},o.prototype.readAndCheckSignature=function(l){var u=l.charCodeAt(0),d=l.charCodeAt(1),f=l.charCodeAt(2),p=l.charCodeAt(3),g=this.readData(4);return u===g[0]&&d===g[1]&&f===g[2]&&p===g[3]},o.prototype.readData=function(l){if(this.checkOffset(l),l===0)return[];var u=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},i.exports=o},{"../utils":32,"./DataReader":18}],18:[function(t,i,s){var r=t("../utils");function a(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(){},readInt:function(o){var l=0,u;for(this.checkOffset(o),u=this.index+o-1;u>=this.index;u--)l=(l<<8)+this.byteAt(u);return this.index+=o,l},readString:function(o){return r.transformTo("string",this.readData(o))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC((o>>25&127)+1980,(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(o&31)<<1))}},i.exports=a},{"../utils":32}],19:[function(t,i,s){var r=t("./Uint8ArrayReader"),a=t("../utils");function o(l){r.call(this,l)}a.inherits(o,r),o.prototype.readData=function(l){this.checkOffset(l);var u=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},i.exports=o},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,i,s){var r=t("./DataReader"),a=t("../utils");function o(l){r.call(this,l)}a.inherits(o,r),o.prototype.byteAt=function(l){return this.data.charCodeAt(this.zero+l)},o.prototype.lastIndexOfSignature=function(l){return this.data.lastIndexOf(l)-this.zero},o.prototype.readAndCheckSignature=function(l){var u=this.readData(4);return l===u},o.prototype.readData=function(l){this.checkOffset(l);var u=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},i.exports=o},{"../utils":32,"./DataReader":18}],21:[function(t,i,s){var r=t("./ArrayReader"),a=t("../utils");function o(l){r.call(this,l)}a.inherits(o,r),o.prototype.readData=function(l){if(this.checkOffset(l),l===0)return new Uint8Array(0);var u=this.data.subarray(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},i.exports=o},{"../utils":32,"./ArrayReader":17}],22:[function(t,i,s){var r=t("../utils"),a=t("../support"),o=t("./ArrayReader"),l=t("./StringReader"),u=t("./NodeBufferReader"),d=t("./Uint8ArrayReader");i.exports=function(f){var p=r.getTypeOf(f);return r.checkSupport(p),p==="string"&&!a.uint8array?new l(f):p==="nodebuffer"?new u(f):a.uint8array?new d(r.transformTo("uint8array",f)):new o(r.transformTo("array",f))}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,i,s){s.LOCAL_FILE_HEADER="PK",s.CENTRAL_FILE_HEADER="PK",s.CENTRAL_DIRECTORY_END="PK",s.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",s.ZIP64_CENTRAL_DIRECTORY_END="PK",s.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,i,s){var r=t("./GenericWorker"),a=t("../utils");function o(l){r.call(this,"ConvertWorker to "+l),this.destType=l}a.inherits(o,r),o.prototype.processChunk=function(l){this.push({data:a.transformTo(this.destType,l.data),meta:l.meta})},i.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(t,i,s){var r=t("./GenericWorker"),a=t("../crc32"),o=t("../utils");function l(){r.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}o.inherits(l,r),l.prototype.processChunk=function(u){this.streamInfo.crc32=a(u.data,this.streamInfo.crc32||0),this.push(u)},i.exports=l},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,i,s){var r=t("../utils"),a=t("./GenericWorker");function o(l){a.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}r.inherits(o,a),o.prototype.processChunk=function(l){if(l){var u=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=u+l.data.length}a.prototype.processChunk.call(this,l)},i.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(t,i,s){var r=t("../utils"),a=t("./GenericWorker"),o=16*1024;function l(u){a.call(this,"DataWorker");var d=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,u.then(function(f){d.dataIsReady=!0,d.data=f,d.max=f&&f.length||0,d.type=r.getTypeOf(f),d.isPaused||d._tickAndRepeat()},function(f){d.error(f)})}r.inherits(l,a),l.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},l.prototype.resume=function(){return a.prototype.resume.call(this)?(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,r.delay(this._tickAndRepeat,[],this)),!0):!1},l.prototype._tickAndRepeat=function(){this._tickScheduled=!1,!(this.isPaused||this.isFinished)&&(this._tick(),this.isFinished||(r.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},l.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var u=o,d=null,f=Math.min(this.max,this.index+u);if(this.index>=this.max)return this.end();switch(this.type){case"string":d=this.data.substring(this.index,f);break;case"uint8array":d=this.data.subarray(this.index,f);break;case"array":case"nodebuffer":d=this.data.slice(this.index,f);break}return this.index=f,this.push({data:d,meta:{percent:this.max?this.index/this.max*100:0}})},i.exports=l},{"../utils":32,"./GenericWorker":28}],28:[function(t,i,s){function r(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}r.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return this.isFinished?!1:(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,o){return this._listeners[a].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,o){if(this._listeners[a])for(var l=0;l<this._listeners[a].length;l++)this._listeners[a][l].call(this,o)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var o=this;return a.on("data",function(l){o.processChunk(l)}),a.on("end",function(){o.end()}),a.on("error",function(l){o.error(l)}),this},pause:function(){return this.isPaused||this.isFinished?!1:(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var a=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,o){return this.extraStreamInfo[a]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},i.exports=r},{}],29:[function(t,i,s){var r=t("../utils"),a=t("./ConvertWorker"),o=t("./GenericWorker"),l=t("../base64"),u=t("../support"),d=t("../external"),f=null;if(u.nodestream)try{f=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function p(y,m,v){switch(y){case"blob":return r.newBlob(r.transformTo("arraybuffer",m),v);case"base64":return l.encode(m);default:return r.transformTo(y,m)}}function g(y,m){var v,b=0,A=null,S=0;for(v=0;v<m.length;v++)S+=m[v].length;switch(y){case"string":return m.join("");case"array":return Array.prototype.concat.apply([],m);case"uint8array":for(A=new Uint8Array(S),v=0;v<m.length;v++)A.set(m[v],b),b+=m[v].length;return A;case"nodebuffer":return Buffer.concat(m);default:throw new Error("concat : unsupported type '"+y+"'")}}function x(y,m){return new d.Promise(function(v,b){var A=[],S=y._internalType,C=y._outputType,k=y._mimeType;y.on("data",function(L,D){A.push(L),m&&m(D)}).on("error",function(L){A=[],b(L)}).on("end",function(){try{var L=p(C,g(S,A),k);v(L)}catch(D){b(D)}A=[]}).resume()})}function w(y,m,v){var b=m;switch(m){case"blob":case"arraybuffer":b="uint8array";break;case"base64":b="string";break}try{this._internalType=b,this._outputType=m,this._mimeType=v,r.checkSupport(b),this._worker=y.pipe(new a(b)),y.lock()}catch(A){this._worker=new o("error"),this._worker.error(A)}}w.prototype={accumulate:function(y){return x(this,y)},on:function(y,m){var v=this;return y==="data"?this._worker.on(y,function(b){m.call(v,b.data,b.meta)}):this._worker.on(y,function(){r.delay(m,arguments,v)}),this},resume:function(){return r.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(y){if(r.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new f(this,{objectMode:this._outputType!=="nodebuffer"},y)}},i.exports=w},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,i,s){if(s.base64=!0,s.array=!0,s.string=!0,s.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",s.nodebuffer=typeof Buffer<"u",s.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")s.blob=!1;else{var r=new ArrayBuffer(0);try{s.blob=new Blob([r],{type:"application/zip"}).size===0}catch{try{var a=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,o=new a;o.append(r),s.blob=o.getBlob("application/zip").size===0}catch{s.blob=!1}}}try{s.nodestream=!!t("readable-stream").Readable}catch{s.nodestream=!1}},{"readable-stream":16}],31:[function(t,i,s){for(var r=t("./utils"),a=t("./support"),o=t("./nodejsUtils"),l=t("./stream/GenericWorker"),u=new Array(256),d=0;d<256;d++)u[d]=d>=252?6:d>=248?5:d>=240?4:d>=224?3:d>=192?2:1;u[254]=u[254]=1;var f=function(y){var m,v,b,A,S,C=y.length,k=0;for(A=0;A<C;A++)v=y.charCodeAt(A),(v&64512)===55296&&A+1<C&&(b=y.charCodeAt(A+1),(b&64512)===56320&&(v=65536+(v-55296<<10)+(b-56320),A++)),k+=v<128?1:v<2048?2:v<65536?3:4;for(a.uint8array?m=new Uint8Array(k):m=new Array(k),S=0,A=0;S<k;A++)v=y.charCodeAt(A),(v&64512)===55296&&A+1<C&&(b=y.charCodeAt(A+1),(b&64512)===56320&&(v=65536+(v-55296<<10)+(b-56320),A++)),v<128?m[S++]=v:v<2048?(m[S++]=192|v>>>6,m[S++]=128|v&63):v<65536?(m[S++]=224|v>>>12,m[S++]=128|v>>>6&63,m[S++]=128|v&63):(m[S++]=240|v>>>18,m[S++]=128|v>>>12&63,m[S++]=128|v>>>6&63,m[S++]=128|v&63);return m},p=function(y,m){var v;for(m=m||y.length,m>y.length&&(m=y.length),v=m-1;v>=0&&(y[v]&192)===128;)v--;return v<0||v===0?m:v+u[y[v]]>m?v:m},g=function(y){var m,v,b,A,S=y.length,C=new Array(S*2);for(v=0,m=0;m<S;){if(b=y[m++],b<128){C[v++]=b;continue}if(A=u[b],A>4){C[v++]=65533,m+=A-1;continue}for(b&=A===2?31:A===3?15:7;A>1&&m<S;)b=b<<6|y[m++]&63,A--;if(A>1){C[v++]=65533;continue}b<65536?C[v++]=b:(b-=65536,C[v++]=55296|b>>10&1023,C[v++]=56320|b&1023)}return C.length!==v&&(C.subarray?C=C.subarray(0,v):C.length=v),r.applyFromCharCode(C)};s.utf8encode=function(m){return a.nodebuffer?o.newBufferFrom(m,"utf-8"):f(m)},s.utf8decode=function(m){return a.nodebuffer?r.transformTo("nodebuffer",m).toString("utf-8"):(m=r.transformTo(a.uint8array?"uint8array":"array",m),g(m))};function x(){l.call(this,"utf-8 decode"),this.leftOver=null}r.inherits(x,l),x.prototype.processChunk=function(y){var m=r.transformTo(a.uint8array?"uint8array":"array",y.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var v=m;m=new Uint8Array(v.length+this.leftOver.length),m.set(this.leftOver,0),m.set(v,this.leftOver.length)}else m=this.leftOver.concat(m);this.leftOver=null}var b=p(m),A=m;b!==m.length&&(a.uint8array?(A=m.subarray(0,b),this.leftOver=m.subarray(b,m.length)):(A=m.slice(0,b),this.leftOver=m.slice(b,m.length))),this.push({data:s.utf8decode(A),meta:y.meta})},x.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:s.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},s.Utf8DecodeWorker=x;function w(){l.call(this,"utf-8 encode")}r.inherits(w,l),w.prototype.processChunk=function(y){this.push({data:s.utf8encode(y.data),meta:y.meta})},s.Utf8EncodeWorker=w},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,i,s){var r=t("./support"),a=t("./base64"),o=t("./nodejsUtils"),l=t("./external");t("setimmediate");function u(y){var m=null;return r.uint8array?m=new Uint8Array(y.length):m=new Array(y.length),f(y,m)}s.newBlob=function(y,m){s.checkSupport("blob");try{return new Blob([y],{type:m})}catch{try{var v=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,b=new v;return b.append(y),b.getBlob(m)}catch{throw new Error("Bug : can't construct the Blob.")}}};function d(y){return y}function f(y,m){for(var v=0;v<y.length;++v)m[v]=y.charCodeAt(v)&255;return m}var p={stringifyByChunk:function(y,m,v){var b=[],A=0,S=y.length;if(S<=v)return String.fromCharCode.apply(null,y);for(;A<S;)m==="array"||m==="nodebuffer"?b.push(String.fromCharCode.apply(null,y.slice(A,Math.min(A+v,S)))):b.push(String.fromCharCode.apply(null,y.subarray(A,Math.min(A+v,S)))),A+=v;return b.join("")},stringifyByChar:function(y){for(var m="",v=0;v<y.length;v++)m+=String.fromCharCode(y[v]);return m},applyCanBeUsed:{uint8array:function(){try{return r.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return r.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch{return!1}}()}};function g(y){var m=65536,v=s.getTypeOf(y),b=!0;if(v==="uint8array"?b=p.applyCanBeUsed.uint8array:v==="nodebuffer"&&(b=p.applyCanBeUsed.nodebuffer),b)for(;m>1;)try{return p.stringifyByChunk(y,v,m)}catch{m=Math.floor(m/2)}return p.stringifyByChar(y)}s.applyFromCharCode=g;function x(y,m){for(var v=0;v<y.length;v++)m[v]=y[v];return m}var w={};w.string={string:d,array:function(y){return f(y,new Array(y.length))},arraybuffer:function(y){return w.string.uint8array(y).buffer},uint8array:function(y){return f(y,new Uint8Array(y.length))},nodebuffer:function(y){return f(y,o.allocBuffer(y.length))}},w.array={string:g,array:d,arraybuffer:function(y){return new Uint8Array(y).buffer},uint8array:function(y){return new Uint8Array(y)},nodebuffer:function(y){return o.newBufferFrom(y)}},w.arraybuffer={string:function(y){return g(new Uint8Array(y))},array:function(y){return x(new Uint8Array(y),new Array(y.byteLength))},arraybuffer:d,uint8array:function(y){return new Uint8Array(y)},nodebuffer:function(y){return o.newBufferFrom(new Uint8Array(y))}},w.uint8array={string:g,array:function(y){return x(y,new Array(y.length))},arraybuffer:function(y){return y.buffer},uint8array:d,nodebuffer:function(y){return o.newBufferFrom(y)}},w.nodebuffer={string:g,array:function(y){return x(y,new Array(y.length))},arraybuffer:function(y){return w.nodebuffer.uint8array(y).buffer},uint8array:function(y){return x(y,new Uint8Array(y.length))},nodebuffer:d},s.transformTo=function(y,m){if(m||(m=""),!y)return m;s.checkSupport(y);var v=s.getTypeOf(m),b=w[v][y](m);return b},s.resolve=function(y){for(var m=y.split("/"),v=[],b=0;b<m.length;b++){var A=m[b];A==="."||A===""&&b!==0&&b!==m.length-1||(A===".."?v.pop():v.push(A))}return v.join("/")},s.getTypeOf=function(y){if(typeof y=="string")return"string";if(Object.prototype.toString.call(y)==="[object Array]")return"array";if(r.nodebuffer&&o.isBuffer(y))return"nodebuffer";if(r.uint8array&&y instanceof Uint8Array)return"uint8array";if(r.arraybuffer&&y instanceof ArrayBuffer)return"arraybuffer"},s.checkSupport=function(y){var m=r[y.toLowerCase()];if(!m)throw new Error(y+" is not supported by this platform")},s.MAX_VALUE_16BITS=65535,s.MAX_VALUE_32BITS=-1,s.pretty=function(y){var m="",v,b;for(b=0;b<(y||"").length;b++)v=y.charCodeAt(b),m+="\\x"+(v<16?"0":"")+v.toString(16).toUpperCase();return m},s.delay=function(y,m,v){setImmediate(function(){y.apply(v||null,m||[])})},s.inherits=function(y,m){var v=function(){};v.prototype=m.prototype,y.prototype=new v},s.extend=function(){var y={},m,v;for(m=0;m<arguments.length;m++)for(v in arguments[m])Object.prototype.hasOwnProperty.call(arguments[m],v)&&typeof y[v]>"u"&&(y[v]=arguments[m][v]);return y},s.prepareContent=function(y,m,v,b,A){var S=l.Promise.resolve(m).then(function(C){var k=r.blob&&(C instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(C))!==-1);return k&&typeof FileReader<"u"?new l.Promise(function(L,D){var j=new FileReader;j.onload=function(P){L(P.target.result)},j.onerror=function(P){D(P.target.error)},j.readAsArrayBuffer(C)}):C});return S.then(function(C){var k=s.getTypeOf(C);return k?(k==="arraybuffer"?C=s.transformTo("uint8array",C):k==="string"&&(A?C=a.decode(C):v&&b!==!0&&(C=u(C))),C):l.Promise.reject(new Error("Can't read the data of '"+y+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,i,s){var r=t("./reader/readerFor"),a=t("./utils"),o=t("./signature"),l=t("./zipEntry"),u=t("./support");function d(f){this.files=[],this.loadOptions=f}d.prototype={checkSignature:function(f){if(!this.reader.readAndCheckSignature(f)){this.reader.index-=4;var p=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(p)+", expected "+a.pretty(f)+")")}},isSignature:function(f,p){var g=this.reader.index;this.reader.setIndex(f);var x=this.reader.readString(4),w=x===p;return this.reader.setIndex(g),w},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var f=this.reader.readData(this.zipCommentLength),p=u.uint8array?"uint8array":"array",g=a.transformTo(p,f);this.zipComment=this.loadOptions.decodeFileName(g)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var f=this.zip64EndOfCentralSize-44,p=0,g,x,w;p<f;)g=this.reader.readInt(2),x=this.reader.readInt(4),w=this.reader.readData(x),this.zip64ExtensibleData[g]={id:g,length:x,value:w}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var f,p;for(f=0;f<this.files.length;f++)p=this.files[f],this.reader.setIndex(p.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),p.readLocalPart(this.reader),p.handleUTF8(),p.processAttributes()},readCentralDir:function(){var f;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)f=new l({zip64:this.zip64},this.loadOptions),f.readCentralPart(this.reader),this.files.push(f);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var f=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(f<0){var p=!this.isSignature(0,o.LOCAL_FILE_HEADER);throw p?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory")}this.reader.setIndex(f);var g=f;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,f=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),f<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(f),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var x=this.centralDirOffset+this.centralDirSize;this.zip64&&(x+=20,x+=12+this.zip64EndOfCentralSize);var w=g-x;if(w>0)this.isSignature(g,o.CENTRAL_FILE_HEADER)||(this.reader.zero=w);else if(w<0)throw new Error("Corrupted zip: missing "+Math.abs(w)+" bytes.")},prepareReader:function(f){this.reader=r(f)},load:function(f){this.prepareReader(f),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},i.exports=d},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,i,s){var r=t("./reader/readerFor"),a=t("./utils"),o=t("./compressedObject"),l=t("./crc32"),u=t("./utf8"),d=t("./compressions"),f=t("./support"),p=0,g=3,x=function(y){for(var m in d)if(Object.prototype.hasOwnProperty.call(d,m)&&d[m].magic===y)return d[m];return null};function w(y,m){this.options=y,this.loadOptions=m}w.prototype={isEncrypted:function(){return(this.bitFlag&1)===1},useUTF8:function(){return(this.bitFlag&2048)===2048},readLocalPart:function(y){var m,v;if(y.skip(22),this.fileNameLength=y.readInt(2),v=y.readInt(2),this.fileName=y.readData(this.fileNameLength),y.skip(v),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(m=x(this.compressionMethod),m===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,m,y.readData(this.compressedSize))},readCentralPart:function(y){this.versionMadeBy=y.readInt(2),y.skip(2),this.bitFlag=y.readInt(2),this.compressionMethod=y.readString(2),this.date=y.readDate(),this.crc32=y.readInt(4),this.compressedSize=y.readInt(4),this.uncompressedSize=y.readInt(4);var m=y.readInt(2);if(this.extraFieldsLength=y.readInt(2),this.fileCommentLength=y.readInt(2),this.diskNumberStart=y.readInt(2),this.internalFileAttributes=y.readInt(2),this.externalFileAttributes=y.readInt(4),this.localHeaderOffset=y.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");y.skip(m),this.readExtraFields(y),this.parseZIP64ExtraField(y),this.fileComment=y.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var y=this.versionMadeBy>>8;this.dir=!!(this.externalFileAttributes&16),y===p&&(this.dosPermissions=this.externalFileAttributes&63),y===g&&(this.unixPermissions=this.externalFileAttributes>>16&65535),!this.dir&&this.fileNameStr.slice(-1)==="/"&&(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var y=r(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=y.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=y.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=y.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=y.readInt(4))}},readExtraFields:function(y){var m=y.index+this.extraFieldsLength,v,b,A;for(this.extraFields||(this.extraFields={});y.index+4<m;)v=y.readInt(2),b=y.readInt(2),A=y.readData(b),this.extraFields[v]={id:v,length:b,value:A};y.setIndex(m)},handleUTF8:function(){var y=f.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=u.utf8decode(this.fileName),this.fileCommentStr=u.utf8decode(this.fileComment);else{var m=this.findExtraFieldUnicodePath();if(m!==null)this.fileNameStr=m;else{var v=a.transformTo(y,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(v)}var b=this.findExtraFieldUnicodeComment();if(b!==null)this.fileCommentStr=b;else{var A=a.transformTo(y,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(A)}}},findExtraFieldUnicodePath:function(){var y=this.extraFields[28789];if(y){var m=r(y.value);return m.readInt(1)!==1||l(this.fileName)!==m.readInt(4)?null:u.utf8decode(m.readData(y.length-5))}return null},findExtraFieldUnicodeComment:function(){var y=this.extraFields[25461];if(y){var m=r(y.value);return m.readInt(1)!==1||l(this.fileComment)!==m.readInt(4)?null:u.utf8decode(m.readData(y.length-5))}return null}},i.exports=w},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,i,s){var r=t("./stream/StreamHelper"),a=t("./stream/DataWorker"),o=t("./utf8"),l=t("./compressedObject"),u=t("./stream/GenericWorker"),d=function(x,w,y){this.name=x,this.dir=y.dir,this.date=y.date,this.comment=y.comment,this.unixPermissions=y.unixPermissions,this.dosPermissions=y.dosPermissions,this._data=w,this._dataBinary=y.binary,this.options={compression:y.compression,compressionOptions:y.compressionOptions}};d.prototype={internalStream:function(x){var w=null,y="string";try{if(!x)throw new Error("No output type specified.");y=x.toLowerCase();var m=y==="string"||y==="text";(y==="binarystring"||y==="text")&&(y="string"),w=this._decompressWorker();var v=!this._dataBinary;v&&!m&&(w=w.pipe(new o.Utf8EncodeWorker)),!v&&m&&(w=w.pipe(new o.Utf8DecodeWorker))}catch(b){w=new u("error"),w.error(b)}return new r(w,y,"")},async:function(x,w){return this.internalStream(x).accumulate(w)},nodeStream:function(x,w){return this.internalStream(x||"nodebuffer").toNodejsStream(w)},_compressWorker:function(x,w){if(this._data instanceof l&&this._data.compression.magic===x.magic)return this._data.getCompressedWorker();var y=this._decompressWorker();return this._dataBinary||(y=y.pipe(new o.Utf8EncodeWorker)),l.createWorkerFrom(y,x,w)},_decompressWorker:function(){return this._data instanceof l?this._data.getContentWorker():this._data instanceof u?this._data:new a(this._data)}};for(var f=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],p=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},g=0;g<f.length;g++)d.prototype[f[g]]=p;i.exports=d},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,i,s){(function(r){var a=r.MutationObserver||r.WebKitMutationObserver,o;if(a){var l=0,u=new a(x),d=r.document.createTextNode("");u.observe(d,{characterData:!0}),o=function(){d.data=l=++l%2}}else if(!r.setImmediate&&typeof r.MessageChannel<"u"){var f=new r.MessageChannel;f.port1.onmessage=x,o=function(){f.port2.postMessage(0)}}else"document"in r&&"onreadystatechange"in r.document.createElement("script")?o=function(){var y=r.document.createElement("script");y.onreadystatechange=function(){x(),y.onreadystatechange=null,y.parentNode.removeChild(y),y=null},r.document.documentElement.appendChild(y)}:o=function(){setTimeout(x,0)};var p,g=[];function x(){p=!0;for(var y,m,v=g.length;v;){for(m=g,g=[],y=-1;++y<v;)m[y]();v=g.length}p=!1}i.exports=w;function w(y){g.push(y)===1&&!p&&o()}}).call(this,typeof zr<"u"?zr:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,i,s){var r=t("immediate");function a(){}var o={},l=["REJECTED"],u=["FULFILLED"],d=["PENDING"];i.exports=f;function f(S){if(typeof S!="function")throw new TypeError("resolver must be a function");this.state=d,this.queue=[],this.outcome=void 0,S!==a&&w(this,S)}f.prototype.finally=function(S){if(typeof S!="function")return this;var C=this.constructor;return this.then(k,L);function k(D){function j(){return D}return C.resolve(S()).then(j)}function L(D){function j(){throw D}return C.resolve(S()).then(j)}},f.prototype.catch=function(S){return this.then(null,S)},f.prototype.then=function(S,C){if(typeof S!="function"&&this.state===u||typeof C!="function"&&this.state===l)return this;var k=new this.constructor(a);if(this.state!==d){var L=this.state===u?S:C;g(k,L,this.outcome)}else this.queue.push(new p(k,S,C));return k};function p(S,C,k){this.promise=S,typeof C=="function"&&(this.onFulfilled=C,this.callFulfilled=this.otherCallFulfilled),typeof k=="function"&&(this.onRejected=k,this.callRejected=this.otherCallRejected)}p.prototype.callFulfilled=function(S){o.resolve(this.promise,S)},p.prototype.otherCallFulfilled=function(S){g(this.promise,this.onFulfilled,S)},p.prototype.callRejected=function(S){o.reject(this.promise,S)},p.prototype.otherCallRejected=function(S){g(this.promise,this.onRejected,S)};function g(S,C,k){r(function(){var L;try{L=C(k)}catch(D){return o.reject(S,D)}L===S?o.reject(S,new TypeError("Cannot resolve promise with itself")):o.resolve(S,L)})}o.resolve=function(S,C){var k=y(x,C);if(k.status==="error")return o.reject(S,k.value);var L=k.value;if(L)w(S,L);else{S.state=u,S.outcome=C;for(var D=-1,j=S.queue.length;++D<j;)S.queue[D].callFulfilled(C)}return S},o.reject=function(S,C){S.state=l,S.outcome=C;for(var k=-1,L=S.queue.length;++k<L;)S.queue[k].callRejected(C);return S};function x(S){var C=S&&S.then;if(S&&(typeof S=="object"||typeof S=="function")&&typeof C=="function")return function(){C.apply(S,arguments)}}function w(S,C){var k=!1;function L(H){k||(k=!0,o.reject(S,H))}function D(H){k||(k=!0,o.resolve(S,H))}function j(){C(D,L)}var P=y(j);P.status==="error"&&L(P.value)}function y(S,C){var k={};try{k.value=S(C),k.status="success"}catch(L){k.status="error",k.value=L}return k}f.resolve=m;function m(S){return S instanceof this?S:o.resolve(new this(a),S)}f.reject=v;function v(S){var C=new this(a);return o.reject(C,S)}f.all=b;function b(S){var C=this;if(Object.prototype.toString.call(S)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=S.length,L=!1;if(!k)return this.resolve([]);for(var D=new Array(k),j=0,P=-1,H=new this(a);++P<k;)G(S[P],P);return H;function G($,Y){C.resolve($).then(F,function(M){L||(L=!0,o.reject(H,M))});function F(M){D[Y]=M,++j===k&&!L&&(L=!0,o.resolve(H,D))}}}f.race=A;function A(S){var C=this;if(Object.prototype.toString.call(S)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=S.length,L=!1;if(!k)return this.resolve([]);for(var D=-1,j=new this(a);++D<k;)P(S[D]);return j;function P(H){C.resolve(H).then(function(G){L||(L=!0,o.resolve(j,G))},function(G){L||(L=!0,o.reject(j,G))})}}},{immediate:36}],38:[function(t,i,s){var r=t("./lib/utils/common").assign,a=t("./lib/deflate"),o=t("./lib/inflate"),l=t("./lib/zlib/constants"),u={};r(u,a,o,l),i.exports=u},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,i,s){var r=t("./zlib/deflate"),a=t("./utils/common"),o=t("./utils/strings"),l=t("./zlib/messages"),u=t("./zlib/zstream"),d=Object.prototype.toString,f=0,p=4,g=0,x=1,w=2,y=-1,m=0,v=8;function b(k){if(!(this instanceof b))return new b(k);this.options=a.assign({level:y,method:v,chunkSize:16384,windowBits:15,memLevel:8,strategy:m,to:""},k||{});var L=this.options;L.raw&&L.windowBits>0?L.windowBits=-L.windowBits:L.gzip&&L.windowBits>0&&L.windowBits<16&&(L.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var D=r.deflateInit2(this.strm,L.level,L.method,L.windowBits,L.memLevel,L.strategy);if(D!==g)throw new Error(l[D]);if(L.header&&r.deflateSetHeader(this.strm,L.header),L.dictionary){var j;if(typeof L.dictionary=="string"?j=o.string2buf(L.dictionary):d.call(L.dictionary)==="[object ArrayBuffer]"?j=new Uint8Array(L.dictionary):j=L.dictionary,D=r.deflateSetDictionary(this.strm,j),D!==g)throw new Error(l[D]);this._dict_set=!0}}b.prototype.push=function(k,L){var D=this.strm,j=this.options.chunkSize,P,H;if(this.ended)return!1;H=L===~~L?L:L===!0?p:f,typeof k=="string"?D.input=o.string2buf(k):d.call(k)==="[object ArrayBuffer]"?D.input=new Uint8Array(k):D.input=k,D.next_in=0,D.avail_in=D.input.length;do{if(D.avail_out===0&&(D.output=new a.Buf8(j),D.next_out=0,D.avail_out=j),P=r.deflate(D,H),P!==x&&P!==g)return this.onEnd(P),this.ended=!0,!1;(D.avail_out===0||D.avail_in===0&&(H===p||H===w))&&(this.options.to==="string"?this.onData(o.buf2binstring(a.shrinkBuf(D.output,D.next_out))):this.onData(a.shrinkBuf(D.output,D.next_out)))}while((D.avail_in>0||D.avail_out===0)&&P!==x);return H===p?(P=r.deflateEnd(this.strm),this.onEnd(P),this.ended=!0,P===g):(H===w&&(this.onEnd(g),D.avail_out=0),!0)},b.prototype.onData=function(k){this.chunks.push(k)},b.prototype.onEnd=function(k){k===g&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=k,this.msg=this.strm.msg};function A(k,L){var D=new b(L);if(D.push(k,!0),D.err)throw D.msg||l[D.err];return D.result}function S(k,L){return L=L||{},L.raw=!0,A(k,L)}function C(k,L){return L=L||{},L.gzip=!0,A(k,L)}s.Deflate=b,s.deflate=A,s.deflateRaw=S,s.gzip=C},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,i,s){var r=t("./zlib/inflate"),a=t("./utils/common"),o=t("./utils/strings"),l=t("./zlib/constants"),u=t("./zlib/messages"),d=t("./zlib/zstream"),f=t("./zlib/gzheader"),p=Object.prototype.toString;function g(y){if(!(this instanceof g))return new g(y);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},y||{});var m=this.options;m.raw&&m.windowBits>=0&&m.windowBits<16&&(m.windowBits=-m.windowBits,m.windowBits===0&&(m.windowBits=-15)),m.windowBits>=0&&m.windowBits<16&&!(y&&y.windowBits)&&(m.windowBits+=32),m.windowBits>15&&m.windowBits<48&&(m.windowBits&15||(m.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var v=r.inflateInit2(this.strm,m.windowBits);if(v!==l.Z_OK)throw new Error(u[v]);this.header=new f,r.inflateGetHeader(this.strm,this.header)}g.prototype.push=function(y,m){var v=this.strm,b=this.options.chunkSize,A=this.options.dictionary,S,C,k,L,D,j,P=!1;if(this.ended)return!1;C=m===~~m?m:m===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof y=="string"?v.input=o.binstring2buf(y):p.call(y)==="[object ArrayBuffer]"?v.input=new Uint8Array(y):v.input=y,v.next_in=0,v.avail_in=v.input.length;do{if(v.avail_out===0&&(v.output=new a.Buf8(b),v.next_out=0,v.avail_out=b),S=r.inflate(v,l.Z_NO_FLUSH),S===l.Z_NEED_DICT&&A&&(typeof A=="string"?j=o.string2buf(A):p.call(A)==="[object ArrayBuffer]"?j=new Uint8Array(A):j=A,S=r.inflateSetDictionary(this.strm,j)),S===l.Z_BUF_ERROR&&P===!0&&(S=l.Z_OK,P=!1),S!==l.Z_STREAM_END&&S!==l.Z_OK)return this.onEnd(S),this.ended=!0,!1;v.next_out&&(v.avail_out===0||S===l.Z_STREAM_END||v.avail_in===0&&(C===l.Z_FINISH||C===l.Z_SYNC_FLUSH))&&(this.options.to==="string"?(k=o.utf8border(v.output,v.next_out),L=v.next_out-k,D=o.buf2string(v.output,k),v.next_out=L,v.avail_out=b-L,L&&a.arraySet(v.output,v.output,k,L,0),this.onData(D)):this.onData(a.shrinkBuf(v.output,v.next_out))),v.avail_in===0&&v.avail_out===0&&(P=!0)}while((v.avail_in>0||v.avail_out===0)&&S!==l.Z_STREAM_END);return S===l.Z_STREAM_END&&(C=l.Z_FINISH),C===l.Z_FINISH?(S=r.inflateEnd(this.strm),this.onEnd(S),this.ended=!0,S===l.Z_OK):(C===l.Z_SYNC_FLUSH&&(this.onEnd(l.Z_OK),v.avail_out=0),!0)},g.prototype.onData=function(y){this.chunks.push(y)},g.prototype.onEnd=function(y){y===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=y,this.msg=this.strm.msg};function x(y,m){var v=new g(m);if(v.push(y,!0),v.err)throw v.msg||u[v.err];return v.result}function w(y,m){return m=m||{},m.raw=!0,x(y,m)}s.Inflate=g,s.inflate=x,s.inflateRaw=w,s.ungzip=x},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,i,s){var r=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";s.assign=function(l){for(var u=Array.prototype.slice.call(arguments,1);u.length;){var d=u.shift();if(d){if(typeof d!="object")throw new TypeError(d+"must be non-object");for(var f in d)d.hasOwnProperty(f)&&(l[f]=d[f])}}return l},s.shrinkBuf=function(l,u){return l.length===u?l:l.subarray?l.subarray(0,u):(l.length=u,l)};var a={arraySet:function(l,u,d,f,p){if(u.subarray&&l.subarray){l.set(u.subarray(d,d+f),p);return}for(var g=0;g<f;g++)l[p+g]=u[d+g]},flattenChunks:function(l){var u,d,f,p,g,x;for(f=0,u=0,d=l.length;u<d;u++)f+=l[u].length;for(x=new Uint8Array(f),p=0,u=0,d=l.length;u<d;u++)g=l[u],x.set(g,p),p+=g.length;return x}},o={arraySet:function(l,u,d,f,p){for(var g=0;g<f;g++)l[p+g]=u[d+g]},flattenChunks:function(l){return[].concat.apply([],l)}};s.setTyped=function(l){l?(s.Buf8=Uint8Array,s.Buf16=Uint16Array,s.Buf32=Int32Array,s.assign(s,a)):(s.Buf8=Array,s.Buf16=Array,s.Buf32=Array,s.assign(s,o))},s.setTyped(r)},{}],42:[function(t,i,s){var r=t("./common"),a=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{o=!1}for(var l=new r.Buf8(256),u=0;u<256;u++)l[u]=u>=252?6:u>=248?5:u>=240?4:u>=224?3:u>=192?2:1;l[254]=l[254]=1,s.string2buf=function(f){var p,g,x,w,y,m=f.length,v=0;for(w=0;w<m;w++)g=f.charCodeAt(w),(g&64512)===55296&&w+1<m&&(x=f.charCodeAt(w+1),(x&64512)===56320&&(g=65536+(g-55296<<10)+(x-56320),w++)),v+=g<128?1:g<2048?2:g<65536?3:4;for(p=new r.Buf8(v),y=0,w=0;y<v;w++)g=f.charCodeAt(w),(g&64512)===55296&&w+1<m&&(x=f.charCodeAt(w+1),(x&64512)===56320&&(g=65536+(g-55296<<10)+(x-56320),w++)),g<128?p[y++]=g:g<2048?(p[y++]=192|g>>>6,p[y++]=128|g&63):g<65536?(p[y++]=224|g>>>12,p[y++]=128|g>>>6&63,p[y++]=128|g&63):(p[y++]=240|g>>>18,p[y++]=128|g>>>12&63,p[y++]=128|g>>>6&63,p[y++]=128|g&63);return p};function d(f,p){if(p<65537&&(f.subarray&&o||!f.subarray&&a))return String.fromCharCode.apply(null,r.shrinkBuf(f,p));for(var g="",x=0;x<p;x++)g+=String.fromCharCode(f[x]);return g}s.buf2binstring=function(f){return d(f,f.length)},s.binstring2buf=function(f){for(var p=new r.Buf8(f.length),g=0,x=p.length;g<x;g++)p[g]=f.charCodeAt(g);return p},s.buf2string=function(f,p){var g,x,w,y,m=p||f.length,v=new Array(m*2);for(x=0,g=0;g<m;){if(w=f[g++],w<128){v[x++]=w;continue}if(y=l[w],y>4){v[x++]=65533,g+=y-1;continue}for(w&=y===2?31:y===3?15:7;y>1&&g<m;)w=w<<6|f[g++]&63,y--;if(y>1){v[x++]=65533;continue}w<65536?v[x++]=w:(w-=65536,v[x++]=55296|w>>10&1023,v[x++]=56320|w&1023)}return d(v,x)},s.utf8border=function(f,p){var g;for(p=p||f.length,p>f.length&&(p=f.length),g=p-1;g>=0&&(f[g]&192)===128;)g--;return g<0||g===0?p:g+l[f[g]]>p?g:p}},{"./common":41}],43:[function(t,i,s){function r(a,o,l,u){for(var d=a&65535|0,f=a>>>16&65535|0,p=0;l!==0;){p=l>2e3?2e3:l,l-=p;do d=d+o[u++]|0,f=f+d|0;while(--p);d%=65521,f%=65521}return d|f<<16|0}i.exports=r},{}],44:[function(t,i,s){i.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,i,s){function r(){for(var l,u=[],d=0;d<256;d++){l=d;for(var f=0;f<8;f++)l=l&1?3988292384^l>>>1:l>>>1;u[d]=l}return u}var a=r();function o(l,u,d,f){var p=a,g=f+d;l^=-1;for(var x=f;x<g;x++)l=l>>>8^p[(l^u[x])&255];return l^-1}i.exports=o},{}],46:[function(t,i,s){var r=t("../utils/common"),a=t("./trees"),o=t("./adler32"),l=t("./crc32"),u=t("./messages"),d=0,f=1,p=3,g=4,x=5,w=0,y=1,m=-2,v=-3,b=-5,A=-1,S=1,C=2,k=3,L=4,D=0,j=2,P=8,H=9,G=15,$=8,Y=29,F=256,M=F+1+Y,I=30,V=19,ie=2*M+1,ge=15,ee=3,me=258,oe=me+ee+1,ae=32,Z=42,re=69,ne=73,xe=91,Re=103,je=113,Oe=666,Ce=1,Fe=2,Ze=3,ye=4,we=3;function He(N,de){return N.msg=u[de],de}function ke(N){return(N<<1)-(N>4?9:0)}function Ae(N){for(var de=N.length;--de>=0;)N[de]=0}function it(N){var de=N.state,pe=de.pending;pe>N.avail_out&&(pe=N.avail_out),pe!==0&&(r.arraySet(N.output,de.pending_buf,de.pending_out,pe,N.next_out),N.next_out+=pe,de.pending_out+=pe,N.total_out+=pe,N.avail_out-=pe,de.pending-=pe,de.pending===0&&(de.pending_out=0))}function nt(N,de){a._tr_flush_block(N,N.block_start>=0?N.block_start:-1,N.strstart-N.block_start,de),N.block_start=N.strstart,it(N.strm)}function Qe(N,de){N.pending_buf[N.pending++]=de}function Nt(N,de){N.pending_buf[N.pending++]=de>>>8&255,N.pending_buf[N.pending++]=de&255}function Ve(N,de,pe,z){var X=N.avail_in;return X>z&&(X=z),X===0?0:(N.avail_in-=X,r.arraySet(de,N.input,N.next_in,X,pe),N.state.wrap===1?N.adler=o(N.adler,de,X,pe):N.state.wrap===2&&(N.adler=l(N.adler,de,X,pe)),N.next_in+=X,N.total_in+=X,X)}function ce(N,de){var pe=N.max_chain_length,z=N.strstart,X,le,et=N.prev_length,qe=N.nice_match,We=N.strstart>N.w_size-oe?N.strstart-(N.w_size-oe):0,St=N.window,Yr=N.w_mask,vi=N.prev,kt=N.strstart+me,Ii=St[z+et-1],cn=St[z+et];N.prev_length>=N.good_match&&(pe>>=2),qe>N.lookahead&&(qe=N.lookahead);do if(X=de,!(St[X+et]!==cn||St[X+et-1]!==Ii||St[X]!==St[z]||St[++X]!==St[z+1])){z+=2,X++;do;while(St[++z]===St[++X]&&St[++z]===St[++X]&&St[++z]===St[++X]&&St[++z]===St[++X]&&St[++z]===St[++X]&&St[++z]===St[++X]&&St[++z]===St[++X]&&St[++z]===St[++X]&&z<kt);if(le=me-(kt-z),z=kt-me,le>et){if(N.match_start=de,et=le,le>=qe)break;Ii=St[z+et-1],cn=St[z+et]}}while((de=vi[de&Yr])>We&&--pe!==0);return et<=N.lookahead?et:N.lookahead}function te(N){var de=N.w_size,pe,z,X,le,et;do{if(le=N.window_size-N.lookahead-N.strstart,N.strstart>=de+(de-oe)){r.arraySet(N.window,N.window,de,de,0),N.match_start-=de,N.strstart-=de,N.block_start-=de,z=N.hash_size,pe=z;do X=N.head[--pe],N.head[pe]=X>=de?X-de:0;while(--z);z=de,pe=z;do X=N.prev[--pe],N.prev[pe]=X>=de?X-de:0;while(--z);le+=de}if(N.strm.avail_in===0)break;if(z=Ve(N.strm,N.window,N.strstart+N.lookahead,le),N.lookahead+=z,N.lookahead+N.insert>=ee)for(et=N.strstart-N.insert,N.ins_h=N.window[et],N.ins_h=(N.ins_h<<N.hash_shift^N.window[et+1])&N.hash_mask;N.insert&&(N.ins_h=(N.ins_h<<N.hash_shift^N.window[et+ee-1])&N.hash_mask,N.prev[et&N.w_mask]=N.head[N.ins_h],N.head[N.ins_h]=et,et++,N.insert--,!(N.lookahead+N.insert<ee)););}while(N.lookahead<oe&&N.strm.avail_in!==0)}function ze(N,de){var pe=65535;for(pe>N.pending_buf_size-5&&(pe=N.pending_buf_size-5);;){if(N.lookahead<=1){if(te(N),N.lookahead===0&&de===d)return Ce;if(N.lookahead===0)break}N.strstart+=N.lookahead,N.lookahead=0;var z=N.block_start+pe;if((N.strstart===0||N.strstart>=z)&&(N.lookahead=N.strstart-z,N.strstart=z,nt(N,!1),N.strm.avail_out===0)||N.strstart-N.block_start>=N.w_size-oe&&(nt(N,!1),N.strm.avail_out===0))return Ce}return N.insert=0,de===g?(nt(N,!0),N.strm.avail_out===0?Ze:ye):(N.strstart>N.block_start&&(nt(N,!1),N.strm.avail_out===0),Ce)}function st(N,de){for(var pe,z;;){if(N.lookahead<oe){if(te(N),N.lookahead<oe&&de===d)return Ce;if(N.lookahead===0)break}if(pe=0,N.lookahead>=ee&&(N.ins_h=(N.ins_h<<N.hash_shift^N.window[N.strstart+ee-1])&N.hash_mask,pe=N.prev[N.strstart&N.w_mask]=N.head[N.ins_h],N.head[N.ins_h]=N.strstart),pe!==0&&N.strstart-pe<=N.w_size-oe&&(N.match_length=ce(N,pe)),N.match_length>=ee)if(z=a._tr_tally(N,N.strstart-N.match_start,N.match_length-ee),N.lookahead-=N.match_length,N.match_length<=N.max_lazy_match&&N.lookahead>=ee){N.match_length--;do N.strstart++,N.ins_h=(N.ins_h<<N.hash_shift^N.window[N.strstart+ee-1])&N.hash_mask,pe=N.prev[N.strstart&N.w_mask]=N.head[N.ins_h],N.head[N.ins_h]=N.strstart;while(--N.match_length!==0);N.strstart++}else N.strstart+=N.match_length,N.match_length=0,N.ins_h=N.window[N.strstart],N.ins_h=(N.ins_h<<N.hash_shift^N.window[N.strstart+1])&N.hash_mask;else z=a._tr_tally(N,0,N.window[N.strstart]),N.lookahead--,N.strstart++;if(z&&(nt(N,!1),N.strm.avail_out===0))return Ce}return N.insert=N.strstart<ee-1?N.strstart:ee-1,de===g?(nt(N,!0),N.strm.avail_out===0?Ze:ye):N.last_lit&&(nt(N,!1),N.strm.avail_out===0)?Ce:Fe}function ht(N,de){for(var pe,z,X;;){if(N.lookahead<oe){if(te(N),N.lookahead<oe&&de===d)return Ce;if(N.lookahead===0)break}if(pe=0,N.lookahead>=ee&&(N.ins_h=(N.ins_h<<N.hash_shift^N.window[N.strstart+ee-1])&N.hash_mask,pe=N.prev[N.strstart&N.w_mask]=N.head[N.ins_h],N.head[N.ins_h]=N.strstart),N.prev_length=N.match_length,N.prev_match=N.match_start,N.match_length=ee-1,pe!==0&&N.prev_length<N.max_lazy_match&&N.strstart-pe<=N.w_size-oe&&(N.match_length=ce(N,pe),N.match_length<=5&&(N.strategy===S||N.match_length===ee&&N.strstart-N.match_start>4096)&&(N.match_length=ee-1)),N.prev_length>=ee&&N.match_length<=N.prev_length){X=N.strstart+N.lookahead-ee,z=a._tr_tally(N,N.strstart-1-N.prev_match,N.prev_length-ee),N.lookahead-=N.prev_length-1,N.prev_length-=2;do++N.strstart<=X&&(N.ins_h=(N.ins_h<<N.hash_shift^N.window[N.strstart+ee-1])&N.hash_mask,pe=N.prev[N.strstart&N.w_mask]=N.head[N.ins_h],N.head[N.ins_h]=N.strstart);while(--N.prev_length!==0);if(N.match_available=0,N.match_length=ee-1,N.strstart++,z&&(nt(N,!1),N.strm.avail_out===0))return Ce}else if(N.match_available){if(z=a._tr_tally(N,0,N.window[N.strstart-1]),z&&nt(N,!1),N.strstart++,N.lookahead--,N.strm.avail_out===0)return Ce}else N.match_available=1,N.strstart++,N.lookahead--}return N.match_available&&(z=a._tr_tally(N,0,N.window[N.strstart-1]),N.match_available=0),N.insert=N.strstart<ee-1?N.strstart:ee-1,de===g?(nt(N,!0),N.strm.avail_out===0?Ze:ye):N.last_lit&&(nt(N,!1),N.strm.avail_out===0)?Ce:Fe}function Lt(N,de){for(var pe,z,X,le,et=N.window;;){if(N.lookahead<=me){if(te(N),N.lookahead<=me&&de===d)return Ce;if(N.lookahead===0)break}if(N.match_length=0,N.lookahead>=ee&&N.strstart>0&&(X=N.strstart-1,z=et[X],z===et[++X]&&z===et[++X]&&z===et[++X])){le=N.strstart+me;do;while(z===et[++X]&&z===et[++X]&&z===et[++X]&&z===et[++X]&&z===et[++X]&&z===et[++X]&&z===et[++X]&&z===et[++X]&&X<le);N.match_length=me-(le-X),N.match_length>N.lookahead&&(N.match_length=N.lookahead)}if(N.match_length>=ee?(pe=a._tr_tally(N,1,N.match_length-ee),N.lookahead-=N.match_length,N.strstart+=N.match_length,N.match_length=0):(pe=a._tr_tally(N,0,N.window[N.strstart]),N.lookahead--,N.strstart++),pe&&(nt(N,!1),N.strm.avail_out===0))return Ce}return N.insert=0,de===g?(nt(N,!0),N.strm.avail_out===0?Ze:ye):N.last_lit&&(nt(N,!1),N.strm.avail_out===0)?Ce:Fe}function ue(N,de){for(var pe;;){if(N.lookahead===0&&(te(N),N.lookahead===0)){if(de===d)return Ce;break}if(N.match_length=0,pe=a._tr_tally(N,0,N.window[N.strstart]),N.lookahead--,N.strstart++,pe&&(nt(N,!1),N.strm.avail_out===0))return Ce}return N.insert=0,de===g?(nt(N,!0),N.strm.avail_out===0?Ze:ye):N.last_lit&&(nt(N,!1),N.strm.avail_out===0)?Ce:Fe}function he(N,de,pe,z,X){this.good_length=N,this.max_lazy=de,this.nice_length=pe,this.max_chain=z,this.func=X}var Pe;Pe=[new he(0,0,0,0,ze),new he(4,4,8,4,st),new he(4,5,16,8,st),new he(4,6,32,32,st),new he(4,4,16,16,ht),new he(8,16,32,32,ht),new he(8,16,128,128,ht),new he(8,32,128,256,ht),new he(32,128,258,1024,ht),new he(32,258,258,4096,ht)];function Be(N){N.window_size=2*N.w_size,Ae(N.head),N.max_lazy_match=Pe[N.level].max_lazy,N.good_match=Pe[N.level].good_length,N.nice_match=Pe[N.level].nice_length,N.max_chain_length=Pe[N.level].max_chain,N.strstart=0,N.block_start=0,N.lookahead=0,N.insert=0,N.match_length=N.prev_length=ee-1,N.match_available=0,N.ins_h=0}function B(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=P,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new r.Buf16(ie*2),this.dyn_dtree=new r.Buf16((2*I+1)*2),this.bl_tree=new r.Buf16((2*V+1)*2),Ae(this.dyn_ltree),Ae(this.dyn_dtree),Ae(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new r.Buf16(ge+1),this.heap=new r.Buf16(2*M+1),Ae(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new r.Buf16(2*M+1),Ae(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function be(N){var de;return!N||!N.state?He(N,m):(N.total_in=N.total_out=0,N.data_type=j,de=N.state,de.pending=0,de.pending_out=0,de.wrap<0&&(de.wrap=-de.wrap),de.status=de.wrap?Z:je,N.adler=de.wrap===2?0:1,de.last_flush=d,a._tr_init(de),w)}function Te(N){var de=be(N);return de===w&&Be(N.state),de}function Ge(N,de){return!N||!N.state||N.state.wrap!==2?m:(N.state.gzhead=de,w)}function K(N,de,pe,z,X,le){if(!N)return m;var et=1;if(de===A&&(de=6),z<0?(et=0,z=-z):z>15&&(et=2,z-=16),X<1||X>H||pe!==P||z<8||z>15||de<0||de>9||le<0||le>L)return He(N,m);z===8&&(z=9);var qe=new B;return N.state=qe,qe.strm=N,qe.wrap=et,qe.gzhead=null,qe.w_bits=z,qe.w_size=1<<qe.w_bits,qe.w_mask=qe.w_size-1,qe.hash_bits=X+7,qe.hash_size=1<<qe.hash_bits,qe.hash_mask=qe.hash_size-1,qe.hash_shift=~~((qe.hash_bits+ee-1)/ee),qe.window=new r.Buf8(qe.w_size*2),qe.head=new r.Buf16(qe.hash_size),qe.prev=new r.Buf16(qe.w_size),qe.lit_bufsize=1<<X+6,qe.pending_buf_size=qe.lit_bufsize*4,qe.pending_buf=new r.Buf8(qe.pending_buf_size),qe.d_buf=1*qe.lit_bufsize,qe.l_buf=3*qe.lit_bufsize,qe.level=de,qe.strategy=le,qe.method=pe,Te(N)}function ve(N,de){return K(N,de,P,G,$,D)}function O(N,de){var pe,z,X,le;if(!N||!N.state||de>x||de<0)return N?He(N,m):m;if(z=N.state,!N.output||!N.input&&N.avail_in!==0||z.status===Oe&&de!==g)return He(N,N.avail_out===0?b:m);if(z.strm=N,pe=z.last_flush,z.last_flush=de,z.status===Z)if(z.wrap===2)N.adler=0,Qe(z,31),Qe(z,139),Qe(z,8),z.gzhead?(Qe(z,(z.gzhead.text?1:0)+(z.gzhead.hcrc?2:0)+(z.gzhead.extra?4:0)+(z.gzhead.name?8:0)+(z.gzhead.comment?16:0)),Qe(z,z.gzhead.time&255),Qe(z,z.gzhead.time>>8&255),Qe(z,z.gzhead.time>>16&255),Qe(z,z.gzhead.time>>24&255),Qe(z,z.level===9?2:z.strategy>=C||z.level<2?4:0),Qe(z,z.gzhead.os&255),z.gzhead.extra&&z.gzhead.extra.length&&(Qe(z,z.gzhead.extra.length&255),Qe(z,z.gzhead.extra.length>>8&255)),z.gzhead.hcrc&&(N.adler=l(N.adler,z.pending_buf,z.pending,0)),z.gzindex=0,z.status=re):(Qe(z,0),Qe(z,0),Qe(z,0),Qe(z,0),Qe(z,0),Qe(z,z.level===9?2:z.strategy>=C||z.level<2?4:0),Qe(z,we),z.status=je);else{var et=P+(z.w_bits-8<<4)<<8,qe=-1;z.strategy>=C||z.level<2?qe=0:z.level<6?qe=1:z.level===6?qe=2:qe=3,et|=qe<<6,z.strstart!==0&&(et|=ae),et+=31-et%31,z.status=je,Nt(z,et),z.strstart!==0&&(Nt(z,N.adler>>>16),Nt(z,N.adler&65535)),N.adler=1}if(z.status===re)if(z.gzhead.extra){for(X=z.pending;z.gzindex<(z.gzhead.extra.length&65535)&&!(z.pending===z.pending_buf_size&&(z.gzhead.hcrc&&z.pending>X&&(N.adler=l(N.adler,z.pending_buf,z.pending-X,X)),it(N),X=z.pending,z.pending===z.pending_buf_size));)Qe(z,z.gzhead.extra[z.gzindex]&255),z.gzindex++;z.gzhead.hcrc&&z.pending>X&&(N.adler=l(N.adler,z.pending_buf,z.pending-X,X)),z.gzindex===z.gzhead.extra.length&&(z.gzindex=0,z.status=ne)}else z.status=ne;if(z.status===ne)if(z.gzhead.name){X=z.pending;do{if(z.pending===z.pending_buf_size&&(z.gzhead.hcrc&&z.pending>X&&(N.adler=l(N.adler,z.pending_buf,z.pending-X,X)),it(N),X=z.pending,z.pending===z.pending_buf_size)){le=1;break}z.gzindex<z.gzhead.name.length?le=z.gzhead.name.charCodeAt(z.gzindex++)&255:le=0,Qe(z,le)}while(le!==0);z.gzhead.hcrc&&z.pending>X&&(N.adler=l(N.adler,z.pending_buf,z.pending-X,X)),le===0&&(z.gzindex=0,z.status=xe)}else z.status=xe;if(z.status===xe)if(z.gzhead.comment){X=z.pending;do{if(z.pending===z.pending_buf_size&&(z.gzhead.hcrc&&z.pending>X&&(N.adler=l(N.adler,z.pending_buf,z.pending-X,X)),it(N),X=z.pending,z.pending===z.pending_buf_size)){le=1;break}z.gzindex<z.gzhead.comment.length?le=z.gzhead.comment.charCodeAt(z.gzindex++)&255:le=0,Qe(z,le)}while(le!==0);z.gzhead.hcrc&&z.pending>X&&(N.adler=l(N.adler,z.pending_buf,z.pending-X,X)),le===0&&(z.status=Re)}else z.status=Re;if(z.status===Re&&(z.gzhead.hcrc?(z.pending+2>z.pending_buf_size&&it(N),z.pending+2<=z.pending_buf_size&&(Qe(z,N.adler&255),Qe(z,N.adler>>8&255),N.adler=0,z.status=je)):z.status=je),z.pending!==0){if(it(N),N.avail_out===0)return z.last_flush=-1,w}else if(N.avail_in===0&&ke(de)<=ke(pe)&&de!==g)return He(N,b);if(z.status===Oe&&N.avail_in!==0)return He(N,b);if(N.avail_in!==0||z.lookahead!==0||de!==d&&z.status!==Oe){var We=z.strategy===C?ue(z,de):z.strategy===k?Lt(z,de):Pe[z.level].func(z,de);if((We===Ze||We===ye)&&(z.status=Oe),We===Ce||We===Ze)return N.avail_out===0&&(z.last_flush=-1),w;if(We===Fe&&(de===f?a._tr_align(z):de!==x&&(a._tr_stored_block(z,0,0,!1),de===p&&(Ae(z.head),z.lookahead===0&&(z.strstart=0,z.block_start=0,z.insert=0))),it(N),N.avail_out===0))return z.last_flush=-1,w}return de!==g?w:z.wrap<=0?y:(z.wrap===2?(Qe(z,N.adler&255),Qe(z,N.adler>>8&255),Qe(z,N.adler>>16&255),Qe(z,N.adler>>24&255),Qe(z,N.total_in&255),Qe(z,N.total_in>>8&255),Qe(z,N.total_in>>16&255),Qe(z,N.total_in>>24&255)):(Nt(z,N.adler>>>16),Nt(z,N.adler&65535)),it(N),z.wrap>0&&(z.wrap=-z.wrap),z.pending!==0?w:y)}function _e(N){var de;return!N||!N.state?m:(de=N.state.status,de!==Z&&de!==re&&de!==ne&&de!==xe&&de!==Re&&de!==je&&de!==Oe?He(N,m):(N.state=null,de===je?He(N,v):w))}function rt(N,de){var pe=de.length,z,X,le,et,qe,We,St,Yr;if(!N||!N.state||(z=N.state,et=z.wrap,et===2||et===1&&z.status!==Z||z.lookahead))return m;for(et===1&&(N.adler=o(N.adler,de,pe,0)),z.wrap=0,pe>=z.w_size&&(et===0&&(Ae(z.head),z.strstart=0,z.block_start=0,z.insert=0),Yr=new r.Buf8(z.w_size),r.arraySet(Yr,de,pe-z.w_size,z.w_size,0),de=Yr,pe=z.w_size),qe=N.avail_in,We=N.next_in,St=N.input,N.avail_in=pe,N.next_in=0,N.input=de,te(z);z.lookahead>=ee;){X=z.strstart,le=z.lookahead-(ee-1);do z.ins_h=(z.ins_h<<z.hash_shift^z.window[X+ee-1])&z.hash_mask,z.prev[X&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=X,X++;while(--le);z.strstart=X,z.lookahead=ee-1,te(z)}return z.strstart+=z.lookahead,z.block_start=z.strstart,z.insert=z.lookahead,z.lookahead=0,z.match_length=z.prev_length=ee-1,z.match_available=0,N.next_in=We,N.input=St,N.avail_in=qe,z.wrap=et,w}s.deflateInit=ve,s.deflateInit2=K,s.deflateReset=Te,s.deflateResetKeep=be,s.deflateSetHeader=Ge,s.deflate=O,s.deflateEnd=_e,s.deflateSetDictionary=rt,s.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,i,s){function r(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}i.exports=r},{}],48:[function(t,i,s){var r=30,a=12;i.exports=function(l,u){var d,f,p,g,x,w,y,m,v,b,A,S,C,k,L,D,j,P,H,G,$,Y,F,M,I;d=l.state,f=l.next_in,M=l.input,p=f+(l.avail_in-5),g=l.next_out,I=l.output,x=g-(u-l.avail_out),w=g+(l.avail_out-257),y=d.dmax,m=d.wsize,v=d.whave,b=d.wnext,A=d.window,S=d.hold,C=d.bits,k=d.lencode,L=d.distcode,D=(1<<d.lenbits)-1,j=(1<<d.distbits)-1;e:do{C<15&&(S+=M[f++]<<C,C+=8,S+=M[f++]<<C,C+=8),P=k[S&D];t:for(;;){if(H=P>>>24,S>>>=H,C-=H,H=P>>>16&255,H===0)I[g++]=P&65535;else if(H&16){G=P&65535,H&=15,H&&(C<H&&(S+=M[f++]<<C,C+=8),G+=S&(1<<H)-1,S>>>=H,C-=H),C<15&&(S+=M[f++]<<C,C+=8,S+=M[f++]<<C,C+=8),P=L[S&j];i:for(;;){if(H=P>>>24,S>>>=H,C-=H,H=P>>>16&255,H&16){if($=P&65535,H&=15,C<H&&(S+=M[f++]<<C,C+=8,C<H&&(S+=M[f++]<<C,C+=8)),$+=S&(1<<H)-1,$>y){l.msg="invalid distance too far back",d.mode=r;break e}if(S>>>=H,C-=H,H=g-x,$>H){if(H=$-H,H>v&&d.sane){l.msg="invalid distance too far back",d.mode=r;break e}if(Y=0,F=A,b===0){if(Y+=m-H,H<G){G-=H;do I[g++]=A[Y++];while(--H);Y=g-$,F=I}}else if(b<H){if(Y+=m+b-H,H-=b,H<G){G-=H;do I[g++]=A[Y++];while(--H);if(Y=0,b<G){H=b,G-=H;do I[g++]=A[Y++];while(--H);Y=g-$,F=I}}}else if(Y+=b-H,H<G){G-=H;do I[g++]=A[Y++];while(--H);Y=g-$,F=I}for(;G>2;)I[g++]=F[Y++],I[g++]=F[Y++],I[g++]=F[Y++],G-=3;G&&(I[g++]=F[Y++],G>1&&(I[g++]=F[Y++]))}else{Y=g-$;do I[g++]=I[Y++],I[g++]=I[Y++],I[g++]=I[Y++],G-=3;while(G>2);G&&(I[g++]=I[Y++],G>1&&(I[g++]=I[Y++]))}}else if(H&64){l.msg="invalid distance code",d.mode=r;break e}else{P=L[(P&65535)+(S&(1<<H)-1)];continue i}break}}else if(H&64)if(H&32){d.mode=a;break e}else{l.msg="invalid literal/length code",d.mode=r;break e}else{P=k[(P&65535)+(S&(1<<H)-1)];continue t}break}}while(f<p&&g<w);G=C>>3,f-=G,C-=G<<3,S&=(1<<C)-1,l.next_in=f,l.next_out=g,l.avail_in=f<p?5+(p-f):5-(f-p),l.avail_out=g<w?257+(w-g):257-(g-w),d.hold=S,d.bits=C}},{}],49:[function(t,i,s){var r=t("../utils/common"),a=t("./adler32"),o=t("./crc32"),l=t("./inffast"),u=t("./inftrees"),d=0,f=1,p=2,g=4,x=5,w=6,y=0,m=1,v=2,b=-2,A=-3,S=-4,C=-5,k=8,L=1,D=2,j=3,P=4,H=5,G=6,$=7,Y=8,F=9,M=10,I=11,V=12,ie=13,ge=14,ee=15,me=16,oe=17,ae=18,Z=19,re=20,ne=21,xe=22,Re=23,je=24,Oe=25,Ce=26,Fe=27,Ze=28,ye=29,we=30,He=31,ke=32,Ae=852,it=592,nt=15,Qe=nt;function Nt(K){return(K>>>24&255)+(K>>>8&65280)+((K&65280)<<8)+((K&255)<<24)}function Ve(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function ce(K){var ve;return!K||!K.state?b:(ve=K.state,K.total_in=K.total_out=ve.total=0,K.msg="",ve.wrap&&(K.adler=ve.wrap&1),ve.mode=L,ve.last=0,ve.havedict=0,ve.dmax=32768,ve.head=null,ve.hold=0,ve.bits=0,ve.lencode=ve.lendyn=new r.Buf32(Ae),ve.distcode=ve.distdyn=new r.Buf32(it),ve.sane=1,ve.back=-1,y)}function te(K){var ve;return!K||!K.state?b:(ve=K.state,ve.wsize=0,ve.whave=0,ve.wnext=0,ce(K))}function ze(K,ve){var O,_e;return!K||!K.state||(_e=K.state,ve<0?(O=0,ve=-ve):(O=(ve>>4)+1,ve<48&&(ve&=15)),ve&&(ve<8||ve>15))?b:(_e.window!==null&&_e.wbits!==ve&&(_e.window=null),_e.wrap=O,_e.wbits=ve,te(K))}function st(K,ve){var O,_e;return K?(_e=new Ve,K.state=_e,_e.window=null,O=ze(K,ve),O!==y&&(K.state=null),O):b}function ht(K){return st(K,Qe)}var Lt=!0,ue,he;function Pe(K){if(Lt){var ve;for(ue=new r.Buf32(512),he=new r.Buf32(32),ve=0;ve<144;)K.lens[ve++]=8;for(;ve<256;)K.lens[ve++]=9;for(;ve<280;)K.lens[ve++]=7;for(;ve<288;)K.lens[ve++]=8;for(u(f,K.lens,0,288,ue,0,K.work,{bits:9}),ve=0;ve<32;)K.lens[ve++]=5;u(p,K.lens,0,32,he,0,K.work,{bits:5}),Lt=!1}K.lencode=ue,K.lenbits=9,K.distcode=he,K.distbits=5}function Be(K,ve,O,_e){var rt,N=K.state;return N.window===null&&(N.wsize=1<<N.wbits,N.wnext=0,N.whave=0,N.window=new r.Buf8(N.wsize)),_e>=N.wsize?(r.arraySet(N.window,ve,O-N.wsize,N.wsize,0),N.wnext=0,N.whave=N.wsize):(rt=N.wsize-N.wnext,rt>_e&&(rt=_e),r.arraySet(N.window,ve,O-_e,rt,N.wnext),_e-=rt,_e?(r.arraySet(N.window,ve,O-_e,_e,0),N.wnext=_e,N.whave=N.wsize):(N.wnext+=rt,N.wnext===N.wsize&&(N.wnext=0),N.whave<N.wsize&&(N.whave+=rt))),0}function B(K,ve){var O,_e,rt,N,de,pe,z,X,le,et,qe,We,St,Yr,vi=0,kt,Ii,cn,zn,sd,rd,Ni,ls,Ji=new r.Buf8(4),Wr,fr,xv=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!K||!K.state||!K.output||!K.input&&K.avail_in!==0)return b;O=K.state,O.mode===V&&(O.mode=ie),de=K.next_out,rt=K.output,z=K.avail_out,N=K.next_in,_e=K.input,pe=K.avail_in,X=O.hold,le=O.bits,et=pe,qe=z,ls=y;e:for(;;)switch(O.mode){case L:if(O.wrap===0){O.mode=ie;break}for(;le<16;){if(pe===0)break e;pe--,X+=_e[N++]<<le,le+=8}if(O.wrap&2&&X===35615){O.check=0,Ji[0]=X&255,Ji[1]=X>>>8&255,O.check=o(O.check,Ji,2,0),X=0,le=0,O.mode=D;break}if(O.flags=0,O.head&&(O.head.done=!1),!(O.wrap&1)||(((X&255)<<8)+(X>>8))%31){K.msg="incorrect header check",O.mode=we;break}if((X&15)!==k){K.msg="unknown compression method",O.mode=we;break}if(X>>>=4,le-=4,Ni=(X&15)+8,O.wbits===0)O.wbits=Ni;else if(Ni>O.wbits){K.msg="invalid window size",O.mode=we;break}O.dmax=1<<Ni,K.adler=O.check=1,O.mode=X&512?M:V,X=0,le=0;break;case D:for(;le<16;){if(pe===0)break e;pe--,X+=_e[N++]<<le,le+=8}if(O.flags=X,(O.flags&255)!==k){K.msg="unknown compression method",O.mode=we;break}if(O.flags&57344){K.msg="unknown header flags set",O.mode=we;break}O.head&&(O.head.text=X>>8&1),O.flags&512&&(Ji[0]=X&255,Ji[1]=X>>>8&255,O.check=o(O.check,Ji,2,0)),X=0,le=0,O.mode=j;case j:for(;le<32;){if(pe===0)break e;pe--,X+=_e[N++]<<le,le+=8}O.head&&(O.head.time=X),O.flags&512&&(Ji[0]=X&255,Ji[1]=X>>>8&255,Ji[2]=X>>>16&255,Ji[3]=X>>>24&255,O.check=o(O.check,Ji,4,0)),X=0,le=0,O.mode=P;case P:for(;le<16;){if(pe===0)break e;pe--,X+=_e[N++]<<le,le+=8}O.head&&(O.head.xflags=X&255,O.head.os=X>>8),O.flags&512&&(Ji[0]=X&255,Ji[1]=X>>>8&255,O.check=o(O.check,Ji,2,0)),X=0,le=0,O.mode=H;case H:if(O.flags&1024){for(;le<16;){if(pe===0)break e;pe--,X+=_e[N++]<<le,le+=8}O.length=X,O.head&&(O.head.extra_len=X),O.flags&512&&(Ji[0]=X&255,Ji[1]=X>>>8&255,O.check=o(O.check,Ji,2,0)),X=0,le=0}else O.head&&(O.head.extra=null);O.mode=G;case G:if(O.flags&1024&&(We=O.length,We>pe&&(We=pe),We&&(O.head&&(Ni=O.head.extra_len-O.length,O.head.extra||(O.head.extra=new Array(O.head.extra_len)),r.arraySet(O.head.extra,_e,N,We,Ni)),O.flags&512&&(O.check=o(O.check,_e,We,N)),pe-=We,N+=We,O.length-=We),O.length))break e;O.length=0,O.mode=$;case $:if(O.flags&2048){if(pe===0)break e;We=0;do Ni=_e[N+We++],O.head&&Ni&&O.length<65536&&(O.head.name+=String.fromCharCode(Ni));while(Ni&&We<pe);if(O.flags&512&&(O.check=o(O.check,_e,We,N)),pe-=We,N+=We,Ni)break e}else O.head&&(O.head.name=null);O.length=0,O.mode=Y;case Y:if(O.flags&4096){if(pe===0)break e;We=0;do Ni=_e[N+We++],O.head&&Ni&&O.length<65536&&(O.head.comment+=String.fromCharCode(Ni));while(Ni&&We<pe);if(O.flags&512&&(O.check=o(O.check,_e,We,N)),pe-=We,N+=We,Ni)break e}else O.head&&(O.head.comment=null);O.mode=F;case F:if(O.flags&512){for(;le<16;){if(pe===0)break e;pe--,X+=_e[N++]<<le,le+=8}if(X!==(O.check&65535)){K.msg="header crc mismatch",O.mode=we;break}X=0,le=0}O.head&&(O.head.hcrc=O.flags>>9&1,O.head.done=!0),K.adler=O.check=0,O.mode=V;break;case M:for(;le<32;){if(pe===0)break e;pe--,X+=_e[N++]<<le,le+=8}K.adler=O.check=Nt(X),X=0,le=0,O.mode=I;case I:if(O.havedict===0)return K.next_out=de,K.avail_out=z,K.next_in=N,K.avail_in=pe,O.hold=X,O.bits=le,v;K.adler=O.check=1,O.mode=V;case V:if(ve===x||ve===w)break e;case ie:if(O.last){X>>>=le&7,le-=le&7,O.mode=Fe;break}for(;le<3;){if(pe===0)break e;pe--,X+=_e[N++]<<le,le+=8}switch(O.last=X&1,X>>>=1,le-=1,X&3){case 0:O.mode=ge;break;case 1:if(Pe(O),O.mode=re,ve===w){X>>>=2,le-=2;break e}break;case 2:O.mode=oe;break;case 3:K.msg="invalid block type",O.mode=we}X>>>=2,le-=2;break;case ge:for(X>>>=le&7,le-=le&7;le<32;){if(pe===0)break e;pe--,X+=_e[N++]<<le,le+=8}if((X&65535)!==(X>>>16^65535)){K.msg="invalid stored block lengths",O.mode=we;break}if(O.length=X&65535,X=0,le=0,O.mode=ee,ve===w)break e;case ee:O.mode=me;case me:if(We=O.length,We){if(We>pe&&(We=pe),We>z&&(We=z),We===0)break e;r.arraySet(rt,_e,N,We,de),pe-=We,N+=We,z-=We,de+=We,O.length-=We;break}O.mode=V;break;case oe:for(;le<14;){if(pe===0)break e;pe--,X+=_e[N++]<<le,le+=8}if(O.nlen=(X&31)+257,X>>>=5,le-=5,O.ndist=(X&31)+1,X>>>=5,le-=5,O.ncode=(X&15)+4,X>>>=4,le-=4,O.nlen>286||O.ndist>30){K.msg="too many length or distance symbols",O.mode=we;break}O.have=0,O.mode=ae;case ae:for(;O.have<O.ncode;){for(;le<3;){if(pe===0)break e;pe--,X+=_e[N++]<<le,le+=8}O.lens[xv[O.have++]]=X&7,X>>>=3,le-=3}for(;O.have<19;)O.lens[xv[O.have++]]=0;if(O.lencode=O.lendyn,O.lenbits=7,Wr={bits:O.lenbits},ls=u(d,O.lens,0,19,O.lencode,0,O.work,Wr),O.lenbits=Wr.bits,ls){K.msg="invalid code lengths set",O.mode=we;break}O.have=0,O.mode=Z;case Z:for(;O.have<O.nlen+O.ndist;){for(;vi=O.lencode[X&(1<<O.lenbits)-1],kt=vi>>>24,Ii=vi>>>16&255,cn=vi&65535,!(kt<=le);){if(pe===0)break e;pe--,X+=_e[N++]<<le,le+=8}if(cn<16)X>>>=kt,le-=kt,O.lens[O.have++]=cn;else{if(cn===16){for(fr=kt+2;le<fr;){if(pe===0)break e;pe--,X+=_e[N++]<<le,le+=8}if(X>>>=kt,le-=kt,O.have===0){K.msg="invalid bit length repeat",O.mode=we;break}Ni=O.lens[O.have-1],We=3+(X&3),X>>>=2,le-=2}else if(cn===17){for(fr=kt+3;le<fr;){if(pe===0)break e;pe--,X+=_e[N++]<<le,le+=8}X>>>=kt,le-=kt,Ni=0,We=3+(X&7),X>>>=3,le-=3}else{for(fr=kt+7;le<fr;){if(pe===0)break e;pe--,X+=_e[N++]<<le,le+=8}X>>>=kt,le-=kt,Ni=0,We=11+(X&127),X>>>=7,le-=7}if(O.have+We>O.nlen+O.ndist){K.msg="invalid bit length repeat",O.mode=we;break}for(;We--;)O.lens[O.have++]=Ni}}if(O.mode===we)break;if(O.lens[256]===0){K.msg="invalid code -- missing end-of-block",O.mode=we;break}if(O.lenbits=9,Wr={bits:O.lenbits},ls=u(f,O.lens,0,O.nlen,O.lencode,0,O.work,Wr),O.lenbits=Wr.bits,ls){K.msg="invalid literal/lengths set",O.mode=we;break}if(O.distbits=6,O.distcode=O.distdyn,Wr={bits:O.distbits},ls=u(p,O.lens,O.nlen,O.ndist,O.distcode,0,O.work,Wr),O.distbits=Wr.bits,ls){K.msg="invalid distances set",O.mode=we;break}if(O.mode=re,ve===w)break e;case re:O.mode=ne;case ne:if(pe>=6&&z>=258){K.next_out=de,K.avail_out=z,K.next_in=N,K.avail_in=pe,O.hold=X,O.bits=le,l(K,qe),de=K.next_out,rt=K.output,z=K.avail_out,N=K.next_in,_e=K.input,pe=K.avail_in,X=O.hold,le=O.bits,O.mode===V&&(O.back=-1);break}for(O.back=0;vi=O.lencode[X&(1<<O.lenbits)-1],kt=vi>>>24,Ii=vi>>>16&255,cn=vi&65535,!(kt<=le);){if(pe===0)break e;pe--,X+=_e[N++]<<le,le+=8}if(Ii&&!(Ii&240)){for(zn=kt,sd=Ii,rd=cn;vi=O.lencode[rd+((X&(1<<zn+sd)-1)>>zn)],kt=vi>>>24,Ii=vi>>>16&255,cn=vi&65535,!(zn+kt<=le);){if(pe===0)break e;pe--,X+=_e[N++]<<le,le+=8}X>>>=zn,le-=zn,O.back+=zn}if(X>>>=kt,le-=kt,O.back+=kt,O.length=cn,Ii===0){O.mode=Ce;break}if(Ii&32){O.back=-1,O.mode=V;break}if(Ii&64){K.msg="invalid literal/length code",O.mode=we;break}O.extra=Ii&15,O.mode=xe;case xe:if(O.extra){for(fr=O.extra;le<fr;){if(pe===0)break e;pe--,X+=_e[N++]<<le,le+=8}O.length+=X&(1<<O.extra)-1,X>>>=O.extra,le-=O.extra,O.back+=O.extra}O.was=O.length,O.mode=Re;case Re:for(;vi=O.distcode[X&(1<<O.distbits)-1],kt=vi>>>24,Ii=vi>>>16&255,cn=vi&65535,!(kt<=le);){if(pe===0)break e;pe--,X+=_e[N++]<<le,le+=8}if(!(Ii&240)){for(zn=kt,sd=Ii,rd=cn;vi=O.distcode[rd+((X&(1<<zn+sd)-1)>>zn)],kt=vi>>>24,Ii=vi>>>16&255,cn=vi&65535,!(zn+kt<=le);){if(pe===0)break e;pe--,X+=_e[N++]<<le,le+=8}X>>>=zn,le-=zn,O.back+=zn}if(X>>>=kt,le-=kt,O.back+=kt,Ii&64){K.msg="invalid distance code",O.mode=we;break}O.offset=cn,O.extra=Ii&15,O.mode=je;case je:if(O.extra){for(fr=O.extra;le<fr;){if(pe===0)break e;pe--,X+=_e[N++]<<le,le+=8}O.offset+=X&(1<<O.extra)-1,X>>>=O.extra,le-=O.extra,O.back+=O.extra}if(O.offset>O.dmax){K.msg="invalid distance too far back",O.mode=we;break}O.mode=Oe;case Oe:if(z===0)break e;if(We=qe-z,O.offset>We){if(We=O.offset-We,We>O.whave&&O.sane){K.msg="invalid distance too far back",O.mode=we;break}We>O.wnext?(We-=O.wnext,St=O.wsize-We):St=O.wnext-We,We>O.length&&(We=O.length),Yr=O.window}else Yr=rt,St=de-O.offset,We=O.length;We>z&&(We=z),z-=We,O.length-=We;do rt[de++]=Yr[St++];while(--We);O.length===0&&(O.mode=ne);break;case Ce:if(z===0)break e;rt[de++]=O.length,z--,O.mode=ne;break;case Fe:if(O.wrap){for(;le<32;){if(pe===0)break e;pe--,X|=_e[N++]<<le,le+=8}if(qe-=z,K.total_out+=qe,O.total+=qe,qe&&(K.adler=O.check=O.flags?o(O.check,rt,qe,de-qe):a(O.check,rt,qe,de-qe)),qe=z,(O.flags?X:Nt(X))!==O.check){K.msg="incorrect data check",O.mode=we;break}X=0,le=0}O.mode=Ze;case Ze:if(O.wrap&&O.flags){for(;le<32;){if(pe===0)break e;pe--,X+=_e[N++]<<le,le+=8}if(X!==(O.total&4294967295)){K.msg="incorrect length check",O.mode=we;break}X=0,le=0}O.mode=ye;case ye:ls=m;break e;case we:ls=A;break e;case He:return S;case ke:default:return b}return K.next_out=de,K.avail_out=z,K.next_in=N,K.avail_in=pe,O.hold=X,O.bits=le,(O.wsize||qe!==K.avail_out&&O.mode<we&&(O.mode<Fe||ve!==g))&&Be(K,K.output,K.next_out,qe-K.avail_out),et-=K.avail_in,qe-=K.avail_out,K.total_in+=et,K.total_out+=qe,O.total+=qe,O.wrap&&qe&&(K.adler=O.check=O.flags?o(O.check,rt,qe,K.next_out-qe):a(O.check,rt,qe,K.next_out-qe)),K.data_type=O.bits+(O.last?64:0)+(O.mode===V?128:0)+(O.mode===re||O.mode===ee?256:0),(et===0&&qe===0||ve===g)&&ls===y&&(ls=C),ls}function be(K){if(!K||!K.state)return b;var ve=K.state;return ve.window&&(ve.window=null),K.state=null,y}function Te(K,ve){var O;return!K||!K.state||(O=K.state,!(O.wrap&2))?b:(O.head=ve,ve.done=!1,y)}function Ge(K,ve){var O=ve.length,_e,rt,N;return!K||!K.state||(_e=K.state,_e.wrap!==0&&_e.mode!==I)?b:_e.mode===I&&(rt=1,rt=a(rt,ve,O,0),rt!==_e.check)?A:(N=Be(K,ve,O,O),N?(_e.mode=He,S):(_e.havedict=1,y))}s.inflateReset=te,s.inflateReset2=ze,s.inflateResetKeep=ce,s.inflateInit=ht,s.inflateInit2=st,s.inflate=B,s.inflateEnd=be,s.inflateGetHeader=Te,s.inflateSetDictionary=Ge,s.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,i,s){var r=t("../utils/common"),a=15,o=852,l=592,u=0,d=1,f=2,p=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],g=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],x=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],w=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];i.exports=function(m,v,b,A,S,C,k,L){var D=L.bits,j=0,P=0,H=0,G=0,$=0,Y=0,F=0,M=0,I=0,V=0,ie,ge,ee,me,oe,ae=null,Z=0,re,ne=new r.Buf16(a+1),xe=new r.Buf16(a+1),Re=null,je=0,Oe,Ce,Fe;for(j=0;j<=a;j++)ne[j]=0;for(P=0;P<A;P++)ne[v[b+P]]++;for($=D,G=a;G>=1&&ne[G]===0;G--);if($>G&&($=G),G===0)return S[C++]=1<<24|64<<16|0,S[C++]=1<<24|64<<16|0,L.bits=1,0;for(H=1;H<G&&ne[H]===0;H++);for($<H&&($=H),M=1,j=1;j<=a;j++)if(M<<=1,M-=ne[j],M<0)return-1;if(M>0&&(m===u||G!==1))return-1;for(xe[1]=0,j=1;j<a;j++)xe[j+1]=xe[j]+ne[j];for(P=0;P<A;P++)v[b+P]!==0&&(k[xe[v[b+P]]++]=P);if(m===u?(ae=Re=k,re=19):m===d?(ae=p,Z-=257,Re=g,je-=257,re=256):(ae=x,Re=w,re=-1),V=0,P=0,j=H,oe=C,Y=$,F=0,ee=-1,I=1<<$,me=I-1,m===d&&I>o||m===f&&I>l)return 1;for(;;){Oe=j-F,k[P]<re?(Ce=0,Fe=k[P]):k[P]>re?(Ce=Re[je+k[P]],Fe=ae[Z+k[P]]):(Ce=96,Fe=0),ie=1<<j-F,ge=1<<Y,H=ge;do ge-=ie,S[oe+(V>>F)+ge]=Oe<<24|Ce<<16|Fe|0;while(ge!==0);for(ie=1<<j-1;V&ie;)ie>>=1;if(ie!==0?(V&=ie-1,V+=ie):V=0,P++,--ne[j]===0){if(j===G)break;j=v[b+k[P]]}if(j>$&&(V&me)!==ee){for(F===0&&(F=$),oe+=H,Y=j-F,M=1<<Y;Y+F<G&&(M-=ne[Y+F],!(M<=0));)Y++,M<<=1;if(I+=1<<Y,m===d&&I>o||m===f&&I>l)return 1;ee=V&me,S[ee]=$<<24|Y<<16|oe-C|0}}return V!==0&&(S[oe+V]=j-F<<24|64<<16|0),L.bits=$,0}},{"../utils/common":41}],51:[function(t,i,s){i.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,i,s){var r=t("../utils/common"),a=4,o=0,l=1,u=2;function d(B){for(var be=B.length;--be>=0;)B[be]=0}var f=0,p=1,g=2,x=3,w=258,y=29,m=256,v=m+1+y,b=30,A=19,S=2*v+1,C=15,k=16,L=7,D=256,j=16,P=17,H=18,G=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],$=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Y=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],M=512,I=new Array((v+2)*2);d(I);var V=new Array(b*2);d(V);var ie=new Array(M);d(ie);var ge=new Array(w-x+1);d(ge);var ee=new Array(y);d(ee);var me=new Array(b);d(me);function oe(B,be,Te,Ge,K){this.static_tree=B,this.extra_bits=be,this.extra_base=Te,this.elems=Ge,this.max_length=K,this.has_stree=B&&B.length}var ae,Z,re;function ne(B,be){this.dyn_tree=B,this.max_code=0,this.stat_desc=be}function xe(B){return B<256?ie[B]:ie[256+(B>>>7)]}function Re(B,be){B.pending_buf[B.pending++]=be&255,B.pending_buf[B.pending++]=be>>>8&255}function je(B,be,Te){B.bi_valid>k-Te?(B.bi_buf|=be<<B.bi_valid&65535,Re(B,B.bi_buf),B.bi_buf=be>>k-B.bi_valid,B.bi_valid+=Te-k):(B.bi_buf|=be<<B.bi_valid&65535,B.bi_valid+=Te)}function Oe(B,be,Te){je(B,Te[be*2],Te[be*2+1])}function Ce(B,be){var Te=0;do Te|=B&1,B>>>=1,Te<<=1;while(--be>0);return Te>>>1}function Fe(B){B.bi_valid===16?(Re(B,B.bi_buf),B.bi_buf=0,B.bi_valid=0):B.bi_valid>=8&&(B.pending_buf[B.pending++]=B.bi_buf&255,B.bi_buf>>=8,B.bi_valid-=8)}function Ze(B,be){var Te=be.dyn_tree,Ge=be.max_code,K=be.stat_desc.static_tree,ve=be.stat_desc.has_stree,O=be.stat_desc.extra_bits,_e=be.stat_desc.extra_base,rt=be.stat_desc.max_length,N,de,pe,z,X,le,et=0;for(z=0;z<=C;z++)B.bl_count[z]=0;for(Te[B.heap[B.heap_max]*2+1]=0,N=B.heap_max+1;N<S;N++)de=B.heap[N],z=Te[Te[de*2+1]*2+1]+1,z>rt&&(z=rt,et++),Te[de*2+1]=z,!(de>Ge)&&(B.bl_count[z]++,X=0,de>=_e&&(X=O[de-_e]),le=Te[de*2],B.opt_len+=le*(z+X),ve&&(B.static_len+=le*(K[de*2+1]+X)));if(et!==0){do{for(z=rt-1;B.bl_count[z]===0;)z--;B.bl_count[z]--,B.bl_count[z+1]+=2,B.bl_count[rt]--,et-=2}while(et>0);for(z=rt;z!==0;z--)for(de=B.bl_count[z];de!==0;)pe=B.heap[--N],!(pe>Ge)&&(Te[pe*2+1]!==z&&(B.opt_len+=(z-Te[pe*2+1])*Te[pe*2],Te[pe*2+1]=z),de--)}}function ye(B,be,Te){var Ge=new Array(C+1),K=0,ve,O;for(ve=1;ve<=C;ve++)Ge[ve]=K=K+Te[ve-1]<<1;for(O=0;O<=be;O++){var _e=B[O*2+1];_e!==0&&(B[O*2]=Ce(Ge[_e]++,_e))}}function we(){var B,be,Te,Ge,K,ve=new Array(C+1);for(Te=0,Ge=0;Ge<y-1;Ge++)for(ee[Ge]=Te,B=0;B<1<<G[Ge];B++)ge[Te++]=Ge;for(ge[Te-1]=Ge,K=0,Ge=0;Ge<16;Ge++)for(me[Ge]=K,B=0;B<1<<$[Ge];B++)ie[K++]=Ge;for(K>>=7;Ge<b;Ge++)for(me[Ge]=K<<7,B=0;B<1<<$[Ge]-7;B++)ie[256+K++]=Ge;for(be=0;be<=C;be++)ve[be]=0;for(B=0;B<=143;)I[B*2+1]=8,B++,ve[8]++;for(;B<=255;)I[B*2+1]=9,B++,ve[9]++;for(;B<=279;)I[B*2+1]=7,B++,ve[7]++;for(;B<=287;)I[B*2+1]=8,B++,ve[8]++;for(ye(I,v+1,ve),B=0;B<b;B++)V[B*2+1]=5,V[B*2]=Ce(B,5);ae=new oe(I,G,m+1,v,C),Z=new oe(V,$,0,b,C),re=new oe(new Array(0),Y,0,A,L)}function He(B){var be;for(be=0;be<v;be++)B.dyn_ltree[be*2]=0;for(be=0;be<b;be++)B.dyn_dtree[be*2]=0;for(be=0;be<A;be++)B.bl_tree[be*2]=0;B.dyn_ltree[D*2]=1,B.opt_len=B.static_len=0,B.last_lit=B.matches=0}function ke(B){B.bi_valid>8?Re(B,B.bi_buf):B.bi_valid>0&&(B.pending_buf[B.pending++]=B.bi_buf),B.bi_buf=0,B.bi_valid=0}function Ae(B,be,Te,Ge){ke(B),Re(B,Te),Re(B,~Te),r.arraySet(B.pending_buf,B.window,be,Te,B.pending),B.pending+=Te}function it(B,be,Te,Ge){var K=be*2,ve=Te*2;return B[K]<B[ve]||B[K]===B[ve]&&Ge[be]<=Ge[Te]}function nt(B,be,Te){for(var Ge=B.heap[Te],K=Te<<1;K<=B.heap_len&&(K<B.heap_len&&it(be,B.heap[K+1],B.heap[K],B.depth)&&K++,!it(be,Ge,B.heap[K],B.depth));)B.heap[Te]=B.heap[K],Te=K,K<<=1;B.heap[Te]=Ge}function Qe(B,be,Te){var Ge,K,ve=0,O,_e;if(B.last_lit!==0)do Ge=B.pending_buf[B.d_buf+ve*2]<<8|B.pending_buf[B.d_buf+ve*2+1],K=B.pending_buf[B.l_buf+ve],ve++,Ge===0?Oe(B,K,be):(O=ge[K],Oe(B,O+m+1,be),_e=G[O],_e!==0&&(K-=ee[O],je(B,K,_e)),Ge--,O=xe(Ge),Oe(B,O,Te),_e=$[O],_e!==0&&(Ge-=me[O],je(B,Ge,_e)));while(ve<B.last_lit);Oe(B,D,be)}function Nt(B,be){var Te=be.dyn_tree,Ge=be.stat_desc.static_tree,K=be.stat_desc.has_stree,ve=be.stat_desc.elems,O,_e,rt=-1,N;for(B.heap_len=0,B.heap_max=S,O=0;O<ve;O++)Te[O*2]!==0?(B.heap[++B.heap_len]=rt=O,B.depth[O]=0):Te[O*2+1]=0;for(;B.heap_len<2;)N=B.heap[++B.heap_len]=rt<2?++rt:0,Te[N*2]=1,B.depth[N]=0,B.opt_len--,K&&(B.static_len-=Ge[N*2+1]);for(be.max_code=rt,O=B.heap_len>>1;O>=1;O--)nt(B,Te,O);N=ve;do O=B.heap[1],B.heap[1]=B.heap[B.heap_len--],nt(B,Te,1),_e=B.heap[1],B.heap[--B.heap_max]=O,B.heap[--B.heap_max]=_e,Te[N*2]=Te[O*2]+Te[_e*2],B.depth[N]=(B.depth[O]>=B.depth[_e]?B.depth[O]:B.depth[_e])+1,Te[O*2+1]=Te[_e*2+1]=N,B.heap[1]=N++,nt(B,Te,1);while(B.heap_len>=2);B.heap[--B.heap_max]=B.heap[1],Ze(B,be),ye(Te,rt,B.bl_count)}function Ve(B,be,Te){var Ge,K=-1,ve,O=be[0*2+1],_e=0,rt=7,N=4;for(O===0&&(rt=138,N=3),be[(Te+1)*2+1]=65535,Ge=0;Ge<=Te;Ge++)ve=O,O=be[(Ge+1)*2+1],!(++_e<rt&&ve===O)&&(_e<N?B.bl_tree[ve*2]+=_e:ve!==0?(ve!==K&&B.bl_tree[ve*2]++,B.bl_tree[j*2]++):_e<=10?B.bl_tree[P*2]++:B.bl_tree[H*2]++,_e=0,K=ve,O===0?(rt=138,N=3):ve===O?(rt=6,N=3):(rt=7,N=4))}function ce(B,be,Te){var Ge,K=-1,ve,O=be[0*2+1],_e=0,rt=7,N=4;for(O===0&&(rt=138,N=3),Ge=0;Ge<=Te;Ge++)if(ve=O,O=be[(Ge+1)*2+1],!(++_e<rt&&ve===O)){if(_e<N)do Oe(B,ve,B.bl_tree);while(--_e!==0);else ve!==0?(ve!==K&&(Oe(B,ve,B.bl_tree),_e--),Oe(B,j,B.bl_tree),je(B,_e-3,2)):_e<=10?(Oe(B,P,B.bl_tree),je(B,_e-3,3)):(Oe(B,H,B.bl_tree),je(B,_e-11,7));_e=0,K=ve,O===0?(rt=138,N=3):ve===O?(rt=6,N=3):(rt=7,N=4)}}function te(B){var be;for(Ve(B,B.dyn_ltree,B.l_desc.max_code),Ve(B,B.dyn_dtree,B.d_desc.max_code),Nt(B,B.bl_desc),be=A-1;be>=3&&B.bl_tree[F[be]*2+1]===0;be--);return B.opt_len+=3*(be+1)+5+5+4,be}function ze(B,be,Te,Ge){var K;for(je(B,be-257,5),je(B,Te-1,5),je(B,Ge-4,4),K=0;K<Ge;K++)je(B,B.bl_tree[F[K]*2+1],3);ce(B,B.dyn_ltree,be-1),ce(B,B.dyn_dtree,Te-1)}function st(B){var be=4093624447,Te;for(Te=0;Te<=31;Te++,be>>>=1)if(be&1&&B.dyn_ltree[Te*2]!==0)return o;if(B.dyn_ltree[9*2]!==0||B.dyn_ltree[10*2]!==0||B.dyn_ltree[13*2]!==0)return l;for(Te=32;Te<m;Te++)if(B.dyn_ltree[Te*2]!==0)return l;return o}var ht=!1;function Lt(B){ht||(we(),ht=!0),B.l_desc=new ne(B.dyn_ltree,ae),B.d_desc=new ne(B.dyn_dtree,Z),B.bl_desc=new ne(B.bl_tree,re),B.bi_buf=0,B.bi_valid=0,He(B)}function ue(B,be,Te,Ge){je(B,(f<<1)+(Ge?1:0),3),Ae(B,be,Te)}function he(B){je(B,p<<1,3),Oe(B,D,I),Fe(B)}function Pe(B,be,Te,Ge){var K,ve,O=0;B.level>0?(B.strm.data_type===u&&(B.strm.data_type=st(B)),Nt(B,B.l_desc),Nt(B,B.d_desc),O=te(B),K=B.opt_len+3+7>>>3,ve=B.static_len+3+7>>>3,ve<=K&&(K=ve)):K=ve=Te+5,Te+4<=K&&be!==-1?ue(B,be,Te,Ge):B.strategy===a||ve===K?(je(B,(p<<1)+(Ge?1:0),3),Qe(B,I,V)):(je(B,(g<<1)+(Ge?1:0),3),ze(B,B.l_desc.max_code+1,B.d_desc.max_code+1,O+1),Qe(B,B.dyn_ltree,B.dyn_dtree)),He(B),Ge&&ke(B)}function Be(B,be,Te){return B.pending_buf[B.d_buf+B.last_lit*2]=be>>>8&255,B.pending_buf[B.d_buf+B.last_lit*2+1]=be&255,B.pending_buf[B.l_buf+B.last_lit]=Te&255,B.last_lit++,be===0?B.dyn_ltree[Te*2]++:(B.matches++,be--,B.dyn_ltree[(ge[Te]+m+1)*2]++,B.dyn_dtree[xe(be)*2]++),B.last_lit===B.lit_bufsize-1}s._tr_init=Lt,s._tr_stored_block=ue,s._tr_flush_block=Pe,s._tr_tally=Be,s._tr_align=he},{"../utils/common":41}],53:[function(t,i,s){function r(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}i.exports=r},{}],54:[function(t,i,s){(function(r){(function(a,o){if(a.setImmediate)return;var l=1,u={},d=!1,f=a.document,p;function g(L){typeof L!="function"&&(L=new Function(""+L));for(var D=new Array(arguments.length-1),j=0;j<D.length;j++)D[j]=arguments[j+1];var P={callback:L,args:D};return u[l]=P,p(l),l++}function x(L){delete u[L]}function w(L){var D=L.callback,j=L.args;switch(j.length){case 0:D();break;case 1:D(j[0]);break;case 2:D(j[0],j[1]);break;case 3:D(j[0],j[1],j[2]);break;default:D.apply(o,j);break}}function y(L){if(d)setTimeout(y,0,L);else{var D=u[L];if(D){d=!0;try{w(D)}finally{x(L),d=!1}}}}function m(){p=function(L){process.nextTick(function(){y(L)})}}function v(){if(a.postMessage&&!a.importScripts){var L=!0,D=a.onmessage;return a.onmessage=function(){L=!1},a.postMessage("","*"),a.onmessage=D,L}}function b(){var L="setImmediate$"+Math.random()+"$",D=function(j){j.source===a&&typeof j.data=="string"&&j.data.indexOf(L)===0&&y(+j.data.slice(L.length))};a.addEventListener?a.addEventListener("message",D,!1):a.attachEvent("onmessage",D),p=function(j){a.postMessage(L+j,"*")}}function A(){var L=new MessageChannel;L.port1.onmessage=function(D){var j=D.data;y(j)},p=function(D){L.port2.postMessage(D)}}function S(){var L=f.documentElement;p=function(D){var j=f.createElement("script");j.onreadystatechange=function(){y(D),j.onreadystatechange=null,L.removeChild(j),j=null},L.appendChild(j)}}function C(){p=function(L){setTimeout(y,0,L)}}var k=Object.getPrototypeOf&&Object.getPrototypeOf(a);k=k&&k.setTimeout?k:a,{}.toString.call(a.process)==="[object process]"?m():v()?b():a.MessageChannel?A():f&&"onreadystatechange"in f.createElement("script")?S():C(),k.setImmediate=g,k.clearImmediate=x})(typeof self>"u"?typeof r>"u"?this:r:self)}).call(this,typeof zr<"u"?zr:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(L4);var Lq=L4.exports;const Mq=Wh(Lq);class Oq{constructor(){this.zip=void 0,this.urlCache={},this.checkRequirements()}checkRequirements(){try{this.zip=new Mq}catch{throw new Error("JSZip lib not loaded")}}open(e,t){return this.zip.loadAsync(e,{base64:t})}openUrl(e,t){return qm(e,"binary").then((function(i){return this.zip.loadAsync(i,{base64:t})}).bind(this))}request(e,t){var i=new Dt,s,r=new El(e);return t||(t=r.extension),t=="blob"?s=this.getBlob(e):s=this.getText(e),s?s.then((function(a){let o=this.handleResponse(a,t);i.resolve(o)}).bind(this)):i.reject({message:"File not found in the epub: "+e,stack:new Error().stack}),i.promise}handleResponse(e,t){var i;return t=="json"?i=JSON.parse(e):$m(t)?i=Qa(e,"text/xml"):t=="xhtml"?i=Qa(e,"application/xhtml+xml"):t=="html"||t=="htm"?i=Qa(e,"text/html"):i=e,i}getBlob(e,t){var i=window.decodeURIComponent(e.substr(1)),s=this.zip.file(i);if(s)return t=t||cf.lookup(s.name),s.async("uint8array").then(function(r){return new Blob([r],{type:t})})}getText(e,t){var i=window.decodeURIComponent(e.substr(1)),s=this.zip.file(i);if(s)return s.async("string").then(function(r){return r})}getBase64(e,t){var i=window.decodeURIComponent(e.substr(1)),s=this.zip.file(i);if(s)return t=t||cf.lookup(s.name),s.async("base64").then(function(r){return"data:"+t+";base64,"+r})}createUrl(e,t){var i=new Dt,s=window.URL||window.webkitURL||window.mozURL,r,a,o=t&&t.base64;return e in this.urlCache?(i.resolve(this.urlCache[e]),i.promise):(o?(a=this.getBase64(e),a&&a.then((function(l){this.urlCache[e]=l,i.resolve(l)}).bind(this))):(a=this.getBlob(e),a&&a.then((function(l){r=s.createObjectURL(l),this.urlCache[e]=r,i.resolve(r)}).bind(this))),a||i.reject({message:"File not found in the epub: "+e,stack:new Error().stack}),i.promise)}revokeUrl(e){var t=window.URL||window.webkitURL||window.mozURL,i=this.urlCache[e];i&&t.revokeObjectURL(i)}destroy(){var e=window.URL||window.webkitURL||window.mozURL;for(let t in this.urlCache)e.revokeObjectURL(t);this.zip=void 0,this.urlCache={}}}var M4={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/(function(n,e){(function(t){n.exports=t()})(function(){return function t(i,s,r){function a(u,d){if(!s[u]){if(!i[u]){var f=typeof Fc=="function"&&Fc;if(!d&&f)return f(u,!0);if(o)return o(u,!0);var p=new Error("Cannot find module '"+u+"'");throw p.code="MODULE_NOT_FOUND",p}var g=s[u]={exports:{}};i[u][0].call(g.exports,function(x){var w=i[u][1][x];return a(w||x)},g,g.exports,t,i,s,r)}return s[u].exports}for(var o=typeof Fc=="function"&&Fc,l=0;l<r.length;l++)a(r[l]);return a}({1:[function(t,i,s){(function(r){var a=r.MutationObserver||r.WebKitMutationObserver,o;if(a){var l=0,u=new a(x),d=r.document.createTextNode("");u.observe(d,{characterData:!0}),o=function(){d.data=l=++l%2}}else if(!r.setImmediate&&typeof r.MessageChannel<"u"){var f=new r.MessageChannel;f.port1.onmessage=x,o=function(){f.port2.postMessage(0)}}else"document"in r&&"onreadystatechange"in r.document.createElement("script")?o=function(){var y=r.document.createElement("script");y.onreadystatechange=function(){x(),y.onreadystatechange=null,y.parentNode.removeChild(y),y=null},r.document.documentElement.appendChild(y)}:o=function(){setTimeout(x,0)};var p,g=[];function x(){p=!0;for(var y,m,v=g.length;v;){for(m=g,g=[],y=-1;++y<v;)m[y]();v=g.length}p=!1}i.exports=w;function w(y){g.push(y)===1&&!p&&o()}}).call(this,typeof zr<"u"?zr:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(t,i,s){var r=t(1);function a(){}var o={},l=["REJECTED"],u=["FULFILLED"],d=["PENDING"];i.exports=f;function f(S){if(typeof S!="function")throw new TypeError("resolver must be a function");this.state=d,this.queue=[],this.outcome=void 0,S!==a&&w(this,S)}f.prototype.catch=function(S){return this.then(null,S)},f.prototype.then=function(S,C){if(typeof S!="function"&&this.state===u||typeof C!="function"&&this.state===l)return this;var k=new this.constructor(a);if(this.state!==d){var L=this.state===u?S:C;g(k,L,this.outcome)}else this.queue.push(new p(k,S,C));return k};function p(S,C,k){this.promise=S,typeof C=="function"&&(this.onFulfilled=C,this.callFulfilled=this.otherCallFulfilled),typeof k=="function"&&(this.onRejected=k,this.callRejected=this.otherCallRejected)}p.prototype.callFulfilled=function(S){o.resolve(this.promise,S)},p.prototype.otherCallFulfilled=function(S){g(this.promise,this.onFulfilled,S)},p.prototype.callRejected=function(S){o.reject(this.promise,S)},p.prototype.otherCallRejected=function(S){g(this.promise,this.onRejected,S)};function g(S,C,k){r(function(){var L;try{L=C(k)}catch(D){return o.reject(S,D)}L===S?o.reject(S,new TypeError("Cannot resolve promise with itself")):o.resolve(S,L)})}o.resolve=function(S,C){var k=y(x,C);if(k.status==="error")return o.reject(S,k.value);var L=k.value;if(L)w(S,L);else{S.state=u,S.outcome=C;for(var D=-1,j=S.queue.length;++D<j;)S.queue[D].callFulfilled(C)}return S},o.reject=function(S,C){S.state=l,S.outcome=C;for(var k=-1,L=S.queue.length;++k<L;)S.queue[k].callRejected(C);return S};function x(S){var C=S&&S.then;if(S&&(typeof S=="object"||typeof S=="function")&&typeof C=="function")return function(){C.apply(S,arguments)}}function w(S,C){var k=!1;function L(H){k||(k=!0,o.reject(S,H))}function D(H){k||(k=!0,o.resolve(S,H))}function j(){C(D,L)}var P=y(j);P.status==="error"&&L(P.value)}function y(S,C){var k={};try{k.value=S(C),k.status="success"}catch(L){k.status="error",k.value=L}return k}f.resolve=m;function m(S){return S instanceof this?S:o.resolve(new this(a),S)}f.reject=v;function v(S){var C=new this(a);return o.reject(C,S)}f.all=b;function b(S){var C=this;if(Object.prototype.toString.call(S)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=S.length,L=!1;if(!k)return this.resolve([]);for(var D=new Array(k),j=0,P=-1,H=new this(a);++P<k;)G(S[P],P);return H;function G($,Y){C.resolve($).then(F,function(M){L||(L=!0,o.reject(H,M))});function F(M){D[Y]=M,++j===k&&!L&&(L=!0,o.resolve(H,D))}}}f.race=A;function A(S){var C=this;if(Object.prototype.toString.call(S)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=S.length,L=!1;if(!k)return this.resolve([]);for(var D=-1,j=new this(a);++D<k;)P(S[D]);return j;function P(H){C.resolve(H).then(function(G){L||(L=!0,o.resolve(j,G))},function(G){L||(L=!0,o.reject(j,G))})}}},{1:1}],3:[function(t,i,s){(function(r){typeof r.Promise!="function"&&(r.Promise=t(2))}).call(this,typeof zr<"u"?zr:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(t,i,s){var r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(U){return typeof U}:function(U){return U&&typeof Symbol=="function"&&U.constructor===Symbol&&U!==Symbol.prototype?"symbol":typeof U};function a(U,W){if(!(U instanceof W))throw new TypeError("Cannot call a class as a function")}function o(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var l=o();function u(){try{if(!l||!l.open)return!1;var U=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),W=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!U||W)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function d(U,W){U=U||[],W=W||{};try{return new Blob(U,W)}catch(Q){if(Q.name!=="TypeError")throw Q;for(var q=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,J=new q,se=0;se<U.length;se+=1)J.append(U[se]);return J.getBlob(W.type)}}typeof Promise>"u"&&t(3);var f=Promise;function p(U,W){W&&U.then(function(q){W(null,q)},function(q){W(q)})}function g(U,W,q){typeof W=="function"&&U.then(W),typeof q=="function"&&U.catch(q)}function x(U){return typeof U!="string"&&(console.warn(U+" used as a key, but it is not a string."),U=String(U)),U}function w(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var y="local-forage-detect-blob-support",m=void 0,v={},b=Object.prototype.toString,A="readonly",S="readwrite";function C(U){for(var W=U.length,q=new ArrayBuffer(W),J=new Uint8Array(q),se=0;se<W;se++)J[se]=U.charCodeAt(se);return q}function k(U){return new f(function(W){var q=U.transaction(y,S),J=d([""]);q.objectStore(y).put(J,"key"),q.onabort=function(se){se.preventDefault(),se.stopPropagation(),W(!1)},q.oncomplete=function(){var se=navigator.userAgent.match(/Chrome\/(\d+)/),Q=navigator.userAgent.match(/Edge\//);W(Q||!se||parseInt(se[1],10)>=43)}}).catch(function(){return!1})}function L(U){return typeof m=="boolean"?f.resolve(m):k(U).then(function(W){return m=W,m})}function D(U){var W=v[U.name],q={};q.promise=new f(function(J,se){q.resolve=J,q.reject=se}),W.deferredOperations.push(q),W.dbReady?W.dbReady=W.dbReady.then(function(){return q.promise}):W.dbReady=q.promise}function j(U){var W=v[U.name],q=W.deferredOperations.pop();if(q)return q.resolve(),q.promise}function P(U,W){var q=v[U.name],J=q.deferredOperations.pop();if(J)return J.reject(W),J.promise}function H(U,W){return new f(function(q,J){if(v[U.name]=v[U.name]||ee(),U.db)if(W)D(U),U.db.close();else return q(U.db);var se=[U.name];W&&se.push(U.version);var Q=l.open.apply(l,se);W&&(Q.onupgradeneeded=function(Se){var De=Q.result;try{De.createObjectStore(U.storeName),Se.oldVersion<=1&&De.createObjectStore(y)}catch(Le){if(Le.name==="ConstraintError")console.warn('The database "'+U.name+'" has been upgraded from version '+Se.oldVersion+" to version "+Se.newVersion+', but the storage "'+U.storeName+'" already exists.');else throw Le}}),Q.onerror=function(Se){Se.preventDefault(),J(Q.error)},Q.onsuccess=function(){var Se=Q.result;Se.onversionchange=function(De){De.target.close()},q(Se),j(U)}})}function G(U){return H(U,!1)}function $(U){return H(U,!0)}function Y(U,W){if(!U.db)return!0;var q=!U.db.objectStoreNames.contains(U.storeName),J=U.version<U.db.version,se=U.version>U.db.version;if(J&&(U.version!==W&&console.warn('The database "'+U.name+`" can't be downgraded from version `+U.db.version+" to version "+U.version+"."),U.version=U.db.version),se||q){if(q){var Q=U.db.version+1;Q>U.version&&(U.version=Q)}return!0}return!1}function F(U){return new f(function(W,q){var J=new FileReader;J.onerror=q,J.onloadend=function(se){var Q=btoa(se.target.result||"");W({__local_forage_encoded_blob:!0,data:Q,type:U.type})},J.readAsBinaryString(U)})}function M(U){var W=C(atob(U.data));return d([W],{type:U.type})}function I(U){return U&&U.__local_forage_encoded_blob}function V(U){var W=this,q=W._initReady().then(function(){var J=v[W._dbInfo.name];if(J&&J.dbReady)return J.dbReady});return g(q,U,U),q}function ie(U){D(U);for(var W=v[U.name],q=W.forages,J=0;J<q.length;J++){var se=q[J];se._dbInfo.db&&(se._dbInfo.db.close(),se._dbInfo.db=null)}return U.db=null,G(U).then(function(Q){return U.db=Q,Y(U)?$(U):Q}).then(function(Q){U.db=W.db=Q;for(var Se=0;Se<q.length;Se++)q[Se]._dbInfo.db=Q}).catch(function(Q){throw P(U,Q),Q})}function ge(U,W,q,J){J===void 0&&(J=1);try{var se=U.db.transaction(U.storeName,W);q(null,se)}catch(Q){if(J>0&&(!U.db||Q.name==="InvalidStateError"||Q.name==="NotFoundError"))return f.resolve().then(function(){if(!U.db||Q.name==="NotFoundError"&&!U.db.objectStoreNames.contains(U.storeName)&&U.version<=U.db.version)return U.db&&(U.version=U.db.version+1),$(U)}).then(function(){return ie(U).then(function(){ge(U,W,q,J-1)})}).catch(q);q(Q)}}function ee(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function me(U){var W=this,q={db:null};if(U)for(var J in U)q[J]=U[J];var se=v[q.name];se||(se=ee(),v[q.name]=se),se.forages.push(W),W._initReady||(W._initReady=W.ready,W.ready=V);var Q=[];function Se(){return f.resolve()}for(var De=0;De<se.forages.length;De++){var Le=se.forages[De];Le!==W&&Q.push(Le._initReady().catch(Se))}var Me=se.forages.slice(0);return f.all(Q).then(function(){return q.db=se.db,G(q)}).then(function(Ie){return q.db=Ie,Y(q,W._defaultConfig.version)?$(q):Ie}).then(function(Ie){q.db=se.db=Ie,W._dbInfo=q;for(var tt=0;tt<Me.length;tt++){var bt=Me[tt];bt!==W&&(bt._dbInfo.db=q.db,bt._dbInfo.version=q.version)}})}function oe(U,W){var q=this;U=x(U);var J=new f(function(se,Q){q.ready().then(function(){ge(q._dbInfo,A,function(Se,De){if(Se)return Q(Se);try{var Le=De.objectStore(q._dbInfo.storeName),Me=Le.get(U);Me.onsuccess=function(){var Ie=Me.result;Ie===void 0&&(Ie=null),I(Ie)&&(Ie=M(Ie)),se(Ie)},Me.onerror=function(){Q(Me.error)}}catch(Ie){Q(Ie)}})}).catch(Q)});return p(J,W),J}function ae(U,W){var q=this,J=new f(function(se,Q){q.ready().then(function(){ge(q._dbInfo,A,function(Se,De){if(Se)return Q(Se);try{var Le=De.objectStore(q._dbInfo.storeName),Me=Le.openCursor(),Ie=1;Me.onsuccess=function(){var tt=Me.result;if(tt){var bt=tt.value;I(bt)&&(bt=M(bt));var Ht=U(bt,tt.key,Ie++);Ht!==void 0?se(Ht):tt.continue()}else se()},Me.onerror=function(){Q(Me.error)}}catch(tt){Q(tt)}})}).catch(Q)});return p(J,W),J}function Z(U,W,q){var J=this;U=x(U);var se=new f(function(Q,Se){var De;J.ready().then(function(){return De=J._dbInfo,b.call(W)==="[object Blob]"?L(De.db).then(function(Le){return Le?W:F(W)}):W}).then(function(Le){ge(J._dbInfo,S,function(Me,Ie){if(Me)return Se(Me);try{var tt=Ie.objectStore(J._dbInfo.storeName);Le===null&&(Le=void 0);var bt=tt.put(Le,U);Ie.oncomplete=function(){Le===void 0&&(Le=null),Q(Le)},Ie.onabort=Ie.onerror=function(){var Ht=bt.error?bt.error:bt.transaction.error;Se(Ht)}}catch(Ht){Se(Ht)}})}).catch(Se)});return p(se,q),se}function re(U,W){var q=this;U=x(U);var J=new f(function(se,Q){q.ready().then(function(){ge(q._dbInfo,S,function(Se,De){if(Se)return Q(Se);try{var Le=De.objectStore(q._dbInfo.storeName),Me=Le.delete(U);De.oncomplete=function(){se()},De.onerror=function(){Q(Me.error)},De.onabort=function(){var Ie=Me.error?Me.error:Me.transaction.error;Q(Ie)}}catch(Ie){Q(Ie)}})}).catch(Q)});return p(J,W),J}function ne(U){var W=this,q=new f(function(J,se){W.ready().then(function(){ge(W._dbInfo,S,function(Q,Se){if(Q)return se(Q);try{var De=Se.objectStore(W._dbInfo.storeName),Le=De.clear();Se.oncomplete=function(){J()},Se.onabort=Se.onerror=function(){var Me=Le.error?Le.error:Le.transaction.error;se(Me)}}catch(Me){se(Me)}})}).catch(se)});return p(q,U),q}function xe(U){var W=this,q=new f(function(J,se){W.ready().then(function(){ge(W._dbInfo,A,function(Q,Se){if(Q)return se(Q);try{var De=Se.objectStore(W._dbInfo.storeName),Le=De.count();Le.onsuccess=function(){J(Le.result)},Le.onerror=function(){se(Le.error)}}catch(Me){se(Me)}})}).catch(se)});return p(q,U),q}function Re(U,W){var q=this,J=new f(function(se,Q){if(U<0){se(null);return}q.ready().then(function(){ge(q._dbInfo,A,function(Se,De){if(Se)return Q(Se);try{var Le=De.objectStore(q._dbInfo.storeName),Me=!1,Ie=Le.openKeyCursor();Ie.onsuccess=function(){var tt=Ie.result;if(!tt){se(null);return}U===0||Me?se(tt.key):(Me=!0,tt.advance(U))},Ie.onerror=function(){Q(Ie.error)}}catch(tt){Q(tt)}})}).catch(Q)});return p(J,W),J}function je(U){var W=this,q=new f(function(J,se){W.ready().then(function(){ge(W._dbInfo,A,function(Q,Se){if(Q)return se(Q);try{var De=Se.objectStore(W._dbInfo.storeName),Le=De.openKeyCursor(),Me=[];Le.onsuccess=function(){var Ie=Le.result;if(!Ie){J(Me);return}Me.push(Ie.key),Ie.continue()},Le.onerror=function(){se(Le.error)}}catch(Ie){se(Ie)}})}).catch(se)});return p(q,U),q}function Oe(U,W){W=w.apply(this,arguments);var q=this.config();U=typeof U!="function"&&U||{},U.name||(U.name=U.name||q.name,U.storeName=U.storeName||q.storeName);var J=this,se;if(!U.name)se=f.reject("Invalid arguments");else{var Q=U.name===q.name&&J._dbInfo.db,Se=Q?f.resolve(J._dbInfo.db):G(U).then(function(De){var Le=v[U.name],Me=Le.forages;Le.db=De;for(var Ie=0;Ie<Me.length;Ie++)Me[Ie]._dbInfo.db=De;return De});U.storeName?se=Se.then(function(De){if(De.objectStoreNames.contains(U.storeName)){var Le=De.version+1;D(U);var Me=v[U.name],Ie=Me.forages;De.close();for(var tt=0;tt<Ie.length;tt++){var bt=Ie[tt];bt._dbInfo.db=null,bt._dbInfo.version=Le}var Ht=new f(function(qt,qi){var Pi=l.open(U.name,Le);Pi.onerror=function(pr){var gg=Pi.result;gg.close(),qi(pr)},Pi.onupgradeneeded=function(){var pr=Pi.result;pr.deleteObjectStore(U.storeName)},Pi.onsuccess=function(){var pr=Pi.result;pr.close(),qt(pr)}});return Ht.then(function(qt){Me.db=qt;for(var qi=0;qi<Ie.length;qi++){var Pi=Ie[qi];Pi._dbInfo.db=qt,j(Pi._dbInfo)}}).catch(function(qt){throw(P(U,qt)||f.resolve()).catch(function(){}),qt})}}):se=Se.then(function(De){D(U);var Le=v[U.name],Me=Le.forages;De.close();for(var Ie=0;Ie<Me.length;Ie++){var tt=Me[Ie];tt._dbInfo.db=null}var bt=new f(function(Ht,qt){var qi=l.deleteDatabase(U.name);qi.onerror=function(){var Pi=qi.result;Pi&&Pi.close(),qt(qi.error)},qi.onblocked=function(){console.warn('dropInstance blocked for database "'+U.name+'" until all open connections are closed')},qi.onsuccess=function(){var Pi=qi.result;Pi&&Pi.close(),Ht(Pi)}});return bt.then(function(Ht){Le.db=Ht;for(var qt=0;qt<Me.length;qt++){var qi=Me[qt];j(qi._dbInfo)}}).catch(function(Ht){throw(P(U,Ht)||f.resolve()).catch(function(){}),Ht})})}return p(se,W),se}var Ce={_driver:"asyncStorage",_initStorage:me,_support:u(),iterate:ae,getItem:oe,setItem:Z,removeItem:re,clear:ne,length:xe,key:Re,keys:je,dropInstance:Oe};function Fe(){return typeof openDatabase=="function"}var Ze="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ye="~~local_forage_type~",we=/^~~local_forage_type~([^~]+)~/,He="__lfsc__:",ke=He.length,Ae="arbf",it="blob",nt="si08",Qe="ui08",Nt="uic8",Ve="si16",ce="si32",te="ur16",ze="ui32",st="fl32",ht="fl64",Lt=ke+Ae.length,ue=Object.prototype.toString;function he(U){var W=U.length*.75,q=U.length,J,se=0,Q,Se,De,Le;U[U.length-1]==="="&&(W--,U[U.length-2]==="="&&W--);var Me=new ArrayBuffer(W),Ie=new Uint8Array(Me);for(J=0;J<q;J+=4)Q=Ze.indexOf(U[J]),Se=Ze.indexOf(U[J+1]),De=Ze.indexOf(U[J+2]),Le=Ze.indexOf(U[J+3]),Ie[se++]=Q<<2|Se>>4,Ie[se++]=(Se&15)<<4|De>>2,Ie[se++]=(De&3)<<6|Le&63;return Me}function Pe(U){var W=new Uint8Array(U),q="",J;for(J=0;J<W.length;J+=3)q+=Ze[W[J]>>2],q+=Ze[(W[J]&3)<<4|W[J+1]>>4],q+=Ze[(W[J+1]&15)<<2|W[J+2]>>6],q+=Ze[W[J+2]&63];return W.length%3===2?q=q.substring(0,q.length-1)+"=":W.length%3===1&&(q=q.substring(0,q.length-2)+"=="),q}function Be(U,W){var q="";if(U&&(q=ue.call(U)),U&&(q==="[object ArrayBuffer]"||U.buffer&&ue.call(U.buffer)==="[object ArrayBuffer]")){var J,se=He;U instanceof ArrayBuffer?(J=U,se+=Ae):(J=U.buffer,q==="[object Int8Array]"?se+=nt:q==="[object Uint8Array]"?se+=Qe:q==="[object Uint8ClampedArray]"?se+=Nt:q==="[object Int16Array]"?se+=Ve:q==="[object Uint16Array]"?se+=te:q==="[object Int32Array]"?se+=ce:q==="[object Uint32Array]"?se+=ze:q==="[object Float32Array]"?se+=st:q==="[object Float64Array]"?se+=ht:W(new Error("Failed to get type for BinaryArray"))),W(se+Pe(J))}else if(q==="[object Blob]"){var Q=new FileReader;Q.onload=function(){var Se=ye+U.type+"~"+Pe(this.result);W(He+it+Se)},Q.readAsArrayBuffer(U)}else try{W(JSON.stringify(U))}catch(Se){console.error("Couldn't convert value into a JSON string: ",U),W(null,Se)}}function B(U){if(U.substring(0,ke)!==He)return JSON.parse(U);var W=U.substring(Lt),q=U.substring(ke,Lt),J;if(q===it&&we.test(W)){var se=W.match(we);J=se[1],W=W.substring(se[0].length)}var Q=he(W);switch(q){case Ae:return Q;case it:return d([Q],{type:J});case nt:return new Int8Array(Q);case Qe:return new Uint8Array(Q);case Nt:return new Uint8ClampedArray(Q);case Ve:return new Int16Array(Q);case te:return new Uint16Array(Q);case ce:return new Int32Array(Q);case ze:return new Uint32Array(Q);case st:return new Float32Array(Q);case ht:return new Float64Array(Q);default:throw new Error("Unkown type: "+q)}}var be={serialize:Be,deserialize:B,stringToBuffer:he,bufferToString:Pe};function Te(U,W,q,J){U.executeSql("CREATE TABLE IF NOT EXISTS "+W.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],q,J)}function Ge(U){var W=this,q={db:null};if(U)for(var J in U)q[J]=typeof U[J]!="string"?U[J].toString():U[J];var se=new f(function(Q,Se){try{q.db=openDatabase(q.name,String(q.version),q.description,q.size)}catch(De){return Se(De)}q.db.transaction(function(De){Te(De,q,function(){W._dbInfo=q,Q()},function(Le,Me){Se(Me)})},Se)});return q.serializer=be,se}function K(U,W,q,J,se,Q){U.executeSql(q,J,se,function(Se,De){De.code===De.SYNTAX_ERR?Se.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[W.storeName],function(Le,Me){Me.rows.length?Q(Le,De):Te(Le,W,function(){Le.executeSql(q,J,se,Q)},Q)},Q):Q(Se,De)},Q)}function ve(U,W){var q=this;U=x(U);var J=new f(function(se,Q){q.ready().then(function(){var Se=q._dbInfo;Se.db.transaction(function(De){K(De,Se,"SELECT * FROM "+Se.storeName+" WHERE key = ? LIMIT 1",[U],function(Le,Me){var Ie=Me.rows.length?Me.rows.item(0).value:null;Ie&&(Ie=Se.serializer.deserialize(Ie)),se(Ie)},function(Le,Me){Q(Me)})})}).catch(Q)});return p(J,W),J}function O(U,W){var q=this,J=new f(function(se,Q){q.ready().then(function(){var Se=q._dbInfo;Se.db.transaction(function(De){K(De,Se,"SELECT * FROM "+Se.storeName,[],function(Le,Me){for(var Ie=Me.rows,tt=Ie.length,bt=0;bt<tt;bt++){var Ht=Ie.item(bt),qt=Ht.value;if(qt&&(qt=Se.serializer.deserialize(qt)),qt=U(qt,Ht.key,bt+1),qt!==void 0){se(qt);return}}se()},function(Le,Me){Q(Me)})})}).catch(Q)});return p(J,W),J}function _e(U,W,q,J){var se=this;U=x(U);var Q=new f(function(Se,De){se.ready().then(function(){W===void 0&&(W=null);var Le=W,Me=se._dbInfo;Me.serializer.serialize(W,function(Ie,tt){tt?De(tt):Me.db.transaction(function(bt){K(bt,Me,"INSERT OR REPLACE INTO "+Me.storeName+" (key, value) VALUES (?, ?)",[U,Ie],function(){Se(Le)},function(Ht,qt){De(qt)})},function(bt){if(bt.code===bt.QUOTA_ERR){if(J>0){Se(_e.apply(se,[U,Le,q,J-1]));return}De(bt)}})})}).catch(De)});return p(Q,q),Q}function rt(U,W,q){return _e.apply(this,[U,W,q,1])}function N(U,W){var q=this;U=x(U);var J=new f(function(se,Q){q.ready().then(function(){var Se=q._dbInfo;Se.db.transaction(function(De){K(De,Se,"DELETE FROM "+Se.storeName+" WHERE key = ?",[U],function(){se()},function(Le,Me){Q(Me)})})}).catch(Q)});return p(J,W),J}function de(U){var W=this,q=new f(function(J,se){W.ready().then(function(){var Q=W._dbInfo;Q.db.transaction(function(Se){K(Se,Q,"DELETE FROM "+Q.storeName,[],function(){J()},function(De,Le){se(Le)})})}).catch(se)});return p(q,U),q}function pe(U){var W=this,q=new f(function(J,se){W.ready().then(function(){var Q=W._dbInfo;Q.db.transaction(function(Se){K(Se,Q,"SELECT COUNT(key) as c FROM "+Q.storeName,[],function(De,Le){var Me=Le.rows.item(0).c;J(Me)},function(De,Le){se(Le)})})}).catch(se)});return p(q,U),q}function z(U,W){var q=this,J=new f(function(se,Q){q.ready().then(function(){var Se=q._dbInfo;Se.db.transaction(function(De){K(De,Se,"SELECT key FROM "+Se.storeName+" WHERE id = ? LIMIT 1",[U+1],function(Le,Me){var Ie=Me.rows.length?Me.rows.item(0).key:null;se(Ie)},function(Le,Me){Q(Me)})})}).catch(Q)});return p(J,W),J}function X(U){var W=this,q=new f(function(J,se){W.ready().then(function(){var Q=W._dbInfo;Q.db.transaction(function(Se){K(Se,Q,"SELECT key FROM "+Q.storeName,[],function(De,Le){for(var Me=[],Ie=0;Ie<Le.rows.length;Ie++)Me.push(Le.rows.item(Ie).key);J(Me)},function(De,Le){se(Le)})})}).catch(se)});return p(q,U),q}function le(U){return new f(function(W,q){U.transaction(function(J){J.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(se,Q){for(var Se=[],De=0;De<Q.rows.length;De++)Se.push(Q.rows.item(De).name);W({db:U,storeNames:Se})},function(se,Q){q(Q)})},function(J){q(J)})})}function et(U,W){W=w.apply(this,arguments);var q=this.config();U=typeof U!="function"&&U||{},U.name||(U.name=U.name||q.name,U.storeName=U.storeName||q.storeName);var J=this,se;return U.name?se=new f(function(Q){var Se;U.name===q.name?Se=J._dbInfo.db:Se=openDatabase(U.name,"","",0),U.storeName?Q({db:Se,storeNames:[U.storeName]}):Q(le(Se))}).then(function(Q){return new f(function(Se,De){Q.db.transaction(function(Le){function Me(Ht){return new f(function(qt,qi){Le.executeSql("DROP TABLE IF EXISTS "+Ht,[],function(){qt()},function(Pi,pr){qi(pr)})})}for(var Ie=[],tt=0,bt=Q.storeNames.length;tt<bt;tt++)Ie.push(Me(Q.storeNames[tt]));f.all(Ie).then(function(){Se()}).catch(function(Ht){De(Ht)})},function(Le){De(Le)})})}):se=f.reject("Invalid arguments"),p(se,W),se}var qe={_driver:"webSQLStorage",_initStorage:Ge,_support:Fe(),iterate:O,getItem:ve,setItem:rt,removeItem:N,clear:de,length:pe,key:z,keys:X,dropInstance:et};function We(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function St(U,W){var q=U.name+"/";return U.storeName!==W.storeName&&(q+=U.storeName+"/"),q}function Yr(){var U="_localforage_support_test";try{return localStorage.setItem(U,!0),localStorage.removeItem(U),!1}catch{return!0}}function vi(){return!Yr()||localStorage.length>0}function kt(U){var W=this,q={};if(U)for(var J in U)q[J]=U[J];return q.keyPrefix=St(U,W._defaultConfig),vi()?(W._dbInfo=q,q.serializer=be,f.resolve()):f.reject()}function Ii(U){var W=this,q=W.ready().then(function(){for(var J=W._dbInfo.keyPrefix,se=localStorage.length-1;se>=0;se--){var Q=localStorage.key(se);Q.indexOf(J)===0&&localStorage.removeItem(Q)}});return p(q,U),q}function cn(U,W){var q=this;U=x(U);var J=q.ready().then(function(){var se=q._dbInfo,Q=localStorage.getItem(se.keyPrefix+U);return Q&&(Q=se.serializer.deserialize(Q)),Q});return p(J,W),J}function zn(U,W){var q=this,J=q.ready().then(function(){for(var se=q._dbInfo,Q=se.keyPrefix,Se=Q.length,De=localStorage.length,Le=1,Me=0;Me<De;Me++){var Ie=localStorage.key(Me);if(Ie.indexOf(Q)===0){var tt=localStorage.getItem(Ie);if(tt&&(tt=se.serializer.deserialize(tt)),tt=U(tt,Ie.substring(Se),Le++),tt!==void 0)return tt}}});return p(J,W),J}function sd(U,W){var q=this,J=q.ready().then(function(){var se=q._dbInfo,Q;try{Q=localStorage.key(U)}catch{Q=null}return Q&&(Q=Q.substring(se.keyPrefix.length)),Q});return p(J,W),J}function rd(U){var W=this,q=W.ready().then(function(){for(var J=W._dbInfo,se=localStorage.length,Q=[],Se=0;Se<se;Se++){var De=localStorage.key(Se);De.indexOf(J.keyPrefix)===0&&Q.push(De.substring(J.keyPrefix.length))}return Q});return p(q,U),q}function Ni(U){var W=this,q=W.keys().then(function(J){return J.length});return p(q,U),q}function ls(U,W){var q=this;U=x(U);var J=q.ready().then(function(){var se=q._dbInfo;localStorage.removeItem(se.keyPrefix+U)});return p(J,W),J}function Ji(U,W,q){var J=this;U=x(U);var se=J.ready().then(function(){W===void 0&&(W=null);var Q=W;return new f(function(Se,De){var Le=J._dbInfo;Le.serializer.serialize(W,function(Me,Ie){if(Ie)De(Ie);else try{localStorage.setItem(Le.keyPrefix+U,Me),Se(Q)}catch(tt){(tt.name==="QuotaExceededError"||tt.name==="NS_ERROR_DOM_QUOTA_REACHED")&&De(tt),De(tt)}})})});return p(se,q),se}function Wr(U,W){if(W=w.apply(this,arguments),U=typeof U!="function"&&U||{},!U.name){var q=this.config();U.name=U.name||q.name,U.storeName=U.storeName||q.storeName}var J=this,se;return U.name?se=new f(function(Q){U.storeName?Q(St(U,J._defaultConfig)):Q(U.name+"/")}).then(function(Q){for(var Se=localStorage.length-1;Se>=0;Se--){var De=localStorage.key(Se);De.indexOf(Q)===0&&localStorage.removeItem(De)}}):se=f.reject("Invalid arguments"),p(se,W),se}var fr={_driver:"localStorageWrapper",_initStorage:kt,_support:We(),iterate:zn,getItem:cn,setItem:Ji,removeItem:ls,clear:Ii,length:Ni,key:sd,keys:rd,dropInstance:Wr},xv=function(W,q){return W===q||typeof W=="number"&&typeof q=="number"&&isNaN(W)&&isNaN(q)},cO=function(W,q){for(var J=W.length,se=0;se<J;){if(xv(W[se],q))return!0;se++}return!1},N_=Array.isArray||function(U){return Object.prototype.toString.call(U)==="[object Array]"},pg={},k_={},ad={INDEXEDDB:Ce,WEBSQL:qe,LOCALSTORAGE:fr},uO=[ad.INDEXEDDB._driver,ad.WEBSQL._driver,ad.LOCALSTORAGE._driver],bv=["dropInstance"],xw=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(bv),hO={description:"",driver:uO.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function dO(U,W){U[W]=function(){var q=arguments;return U.ready().then(function(){return U[W].apply(U,q)})}}function bw(){for(var U=1;U<arguments.length;U++){var W=arguments[U];if(W)for(var q in W)W.hasOwnProperty(q)&&(N_(W[q])?arguments[0][q]=W[q].slice():arguments[0][q]=W[q])}return arguments[0]}var fO=function(){function U(W){a(this,U);for(var q in ad)if(ad.hasOwnProperty(q)){var J=ad[q],se=J._driver;this[q]=se,pg[se]||this.defineDriver(J)}this._defaultConfig=bw({},hO),this._config=bw({},this._defaultConfig,W),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return U.prototype.config=function(q){if((typeof q>"u"?"undefined":r(q))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var J in q){if(J==="storeName"&&(q[J]=q[J].replace(/\W/g,"_")),J==="version"&&typeof q[J]!="number")return new Error("Database version must be a number.");this._config[J]=q[J]}return"driver"in q&&q.driver?this.setDriver(this._config.driver):!0}else return typeof q=="string"?this._config[q]:this._config},U.prototype.defineDriver=function(q,J,se){var Q=new f(function(Se,De){try{var Le=q._driver,Me=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!q._driver){De(Me);return}for(var Ie=xw.concat("_initStorage"),tt=0,bt=Ie.length;tt<bt;tt++){var Ht=Ie[tt],qt=!cO(bv,Ht);if((qt||q[Ht])&&typeof q[Ht]!="function"){De(Me);return}}var qi=function(){for(var gg=function(mO){return function(){var yO=new Error("Method "+mO+" is not implemented by the current driver"),T_=f.reject(yO);return p(T_,arguments[arguments.length-1]),T_}},ww=0,gO=bv.length;ww<gO;ww++){var Sw=bv[ww];q[Sw]||(q[Sw]=gg(Sw))}};qi();var Pi=function(gg){pg[Le]&&console.info("Redefining LocalForage driver: "+Le),pg[Le]=q,k_[Le]=gg,Se()};"_support"in q?q._support&&typeof q._support=="function"?q._support().then(Pi,De):Pi(!!q._support):Pi(!0)}catch(pr){De(pr)}});return g(Q,J,se),Q},U.prototype.driver=function(){return this._driver||null},U.prototype.getDriver=function(q,J,se){var Q=pg[q]?f.resolve(pg[q]):f.reject(new Error("Driver not found."));return g(Q,J,se),Q},U.prototype.getSerializer=function(q){var J=f.resolve(be);return g(J,q),J},U.prototype.ready=function(q){var J=this,se=J._driverSet.then(function(){return J._ready===null&&(J._ready=J._initDriver()),J._ready});return g(se,q,q),se},U.prototype.setDriver=function(q,J,se){var Q=this;N_(q)||(q=[q]);var Se=this._getSupportedDrivers(q);function De(){Q._config.driver=Q.driver()}function Le(tt){return Q._extend(tt),De(),Q._ready=Q._initStorage(Q._config),Q._ready}function Me(tt){return function(){var bt=0;function Ht(){for(;bt<tt.length;){var qt=tt[bt];return bt++,Q._dbInfo=null,Q._ready=null,Q.getDriver(qt).then(Le).catch(Ht)}De();var qi=new Error("No available storage method found.");return Q._driverSet=f.reject(qi),Q._driverSet}return Ht()}}var Ie=this._driverSet!==null?this._driverSet.catch(function(){return f.resolve()}):f.resolve();return this._driverSet=Ie.then(function(){var tt=Se[0];return Q._dbInfo=null,Q._ready=null,Q.getDriver(tt).then(function(bt){Q._driver=bt._driver,De(),Q._wrapLibraryMethodsWithReady(),Q._initDriver=Me(Se)})}).catch(function(){De();var tt=new Error("No available storage method found.");return Q._driverSet=f.reject(tt),Q._driverSet}),g(this._driverSet,J,se),this._driverSet},U.prototype.supports=function(q){return!!k_[q]},U.prototype._extend=function(q){bw(this,q)},U.prototype._getSupportedDrivers=function(q){for(var J=[],se=0,Q=q.length;se<Q;se++){var Se=q[se];this.supports(Se)&&J.push(Se)}return J},U.prototype._wrapLibraryMethodsWithReady=function(){for(var q=0,J=xw.length;q<J;q++)dO(this,xw[q])},U.prototype.createInstance=function(q){return new U(q)},U}(),pO=new fO;i.exports=pO},{3:3}]},{},[4])(4)})})(M4);var Iq=M4.exports;const DT=Wh(Iq);class O4{constructor(e,t,i){this.urlCache={},this.storage=void 0,this.name=e,this.requester=t||qm,this.resolver=i,this.online=!0,this.checkRequirements(),this.addListeners()}checkRequirements(){try{let e;typeof DT>"u"&&(e=DT),this.storage=e.createInstance({name:this.name})}catch{throw new Error("localForage lib not loaded")}}addListeners(){this._status=this.status.bind(this),window.addEventListener("online",this._status),window.addEventListener("offline",this._status)}removeListeners(){window.removeEventListener("online",this._status),window.removeEventListener("offline",this._status),this._status=void 0}status(e){let t=navigator.onLine;this.online=t,t?this.emit("online",this):this.emit("offline",this)}add(e,t){let i=e.resources.map(s=>{let{href:r}=s,a=this.resolver(r),o=window.encodeURIComponent(a);return this.storage.getItem(o).then(l=>!l||t?this.requester(a,"binary").then(u=>this.storage.setItem(o,u)):l)});return Promise.all(i)}put(e,t,i){let s=window.encodeURIComponent(e);return this.storage.getItem(s).then(r=>r||this.requester(e,"binary",t,i).then(a=>this.storage.setItem(s,a)))}request(e,t,i,s){return this.online?this.requester(e,t,i,s).then(r=>(this.put(e),r)):this.retrieve(e,t)}retrieve(e,t){new Dt;var i,s=new El(e);return t||(t=s.extension),t=="blob"?i=this.getBlob(e):i=this.getText(e),i.then(r=>{var a=new Dt,o;return r?(o=this.handleResponse(r,t),a.resolve(o)):a.reject({message:"File not found in storage: "+e,stack:new Error().stack}),a.promise})}handleResponse(e,t){var i;return t=="json"?i=JSON.parse(e):$m(t)?i=Qa(e,"text/xml"):t=="xhtml"?i=Qa(e,"application/xhtml+xml"):t=="html"||t=="htm"?i=Qa(e,"text/html"):i=e,i}getBlob(e,t){let i=window.encodeURIComponent(e);return this.storage.getItem(i).then(function(s){if(s)return t=t||cf.lookup(e),new Blob([s],{type:t})})}getText(e,t){let i=window.encodeURIComponent(e);return t=t||cf.lookup(e),this.storage.getItem(i).then(function(s){var r=new Dt,a=new FileReader,o;if(s)return o=new Blob([s],{type:t}),a.addEventListener("loadend",()=>{r.resolve(a.result)}),a.readAsText(o,t),r.promise})}getBase64(e,t){let i=window.encodeURIComponent(e);return t=t||cf.lookup(e),this.storage.getItem(i).then(s=>{var r=new Dt,a=new FileReader,o;if(s)return o=new Blob([s],{type:t}),a.addEventListener("loadend",()=>{r.resolve(a.result)}),a.readAsDataURL(o,t),r.promise})}createUrl(e,t){var i=new Dt,s=window.URL||window.webkitURL||window.mozURL,r,a,o=t&&t.base64;return e in this.urlCache?(i.resolve(this.urlCache[e]),i.promise):(o?(a=this.getBase64(e),a&&a.then((function(l){this.urlCache[e]=l,i.resolve(l)}).bind(this))):(a=this.getBlob(e),a&&a.then((function(l){r=s.createObjectURL(l),this.urlCache[e]=r,i.resolve(r)}).bind(this))),a||i.reject({message:"File not found in storage: "+e,stack:new Error().stack}),i.promise)}revokeUrl(e){var t=window.URL||window.webkitURL||window.mozURL,i=this.urlCache[e];i&&t.revokeObjectURL(i)}destroy(){var e=window.URL||window.webkitURL||window.mozURL;for(let t in this.urlCache)e.revokeObjectURL(t);this.urlCache={},this.removeListeners()}}ro(O4.prototype);class _2{constructor(e){this.interactive="",this.fixedLayout="",this.openToSpread="",this.orientationLock="",e&&this.parse(e)}parse(e){if(!e)return this;const t=oi(e,"display_options");return t?(Al(t,"option").forEach(s=>{let r="";switch(s.childNodes.length&&(r=s.childNodes[0].nodeValue),s.attributes.name.value){case"interactive":this.interactive=r;break;case"fixed-layout":this.fixedLayout=r;break;case"open-to-spread":this.openToSpread=r;break;case"orientation-lock":this.orientationLock=r;break}}),this):this}destroy(){this.interactive=void 0,this.fixedLayout=void 0,this.openToSpread=void 0,this.orientationLock=void 0}}const jT="META-INF/container.xml",Pq="META-INF/com.apple.ibooks.display-options.xml",Kr={BINARY:"binary",BASE64:"base64",EPUB:"epub",OPF:"opf",MANIFEST:"json",DIRECTORY:"directory"};class h_{constructor(e,t){typeof t>"u"&&typeof e!="string"&&!(e instanceof Blob)&&!(e instanceof ArrayBuffer)&&(t=e,e=void 0),this.settings=Bn(this.settings||{},{requestMethod:void 0,requestCredentials:void 0,requestHeaders:void 0,encoding:void 0,replacements:void 0,canonical:void 0,openAs:void 0,store:void 0}),Bn(this.settings,t),this.opening=new Dt,this.opened=this.opening.promise,this.isOpen=!1,this.loading={manifest:new Dt,spine:new Dt,metadata:new Dt,cover:new Dt,navigation:new Dt,pageList:new Dt,resources:new Dt,displayOptions:new Dt},this.loaded={manifest:this.loading.manifest.promise,spine:this.loading.spine.promise,metadata:this.loading.metadata.promise,cover:this.loading.cover.promise,navigation:this.loading.navigation.promise,pageList:this.loading.pageList.promise,resources:this.loading.resources.promise,displayOptions:this.loading.displayOptions.promise},this.ready=Promise.all([this.loaded.manifest,this.loaded.spine,this.loaded.metadata,this.loaded.cover,this.loaded.navigation,this.loaded.resources,this.loaded.displayOptions]),this.isRendered=!1,this.request=this.settings.requestMethod||qm,this.spine=new i$,this.locations=new y4(this.spine,this.load.bind(this)),this.navigation=void 0,this.pageList=void 0,this.url=void 0,this.path=void 0,this.archived=!1,this.archive=void 0,this.storage=void 0,this.resources=void 0,this.rendition=void 0,this.container=void 0,this.packaging=void 0,this.displayOptions=void 0,this.settings.store&&this.store(this.settings.store),e&&this.open(e,this.settings.openAs).catch(i=>{var s=new Error("Cannot load book at "+e);this.emit($e.BOOK.OPEN_FAILED,s)})}open(e,t){var i,s=t||this.determineType(e);return s===Kr.BINARY?(this.archived=!0,this.url=new Jr("/",""),i=this.openEpub(e)):s===Kr.BASE64?(this.archived=!0,this.url=new Jr("/",""),i=this.openEpub(e,s)):s===Kr.EPUB?(this.archived=!0,this.url=new Jr("/",""),i=this.request(e,"binary",this.settings.requestCredentials,this.settings.requestHeaders).then(this.openEpub.bind(this))):s==Kr.OPF?(this.url=new Jr(e),i=this.openPackaging(this.url.Path.toString())):s==Kr.MANIFEST?(this.url=new Jr(e),i=this.openManifest(this.url.Path.toString())):(this.url=new Jr(e),i=this.openContainer(jT).then(this.openPackaging.bind(this))),i}openEpub(e,t){return this.unarchive(e,t||this.settings.encoding).then(()=>this.openContainer(jT)).then(i=>this.openPackaging(i))}openContainer(e){return this.load(e).then(t=>(this.container=new n$(t),this.resolve(this.container.packagePath)))}openPackaging(e){return this.path=new El(e),this.load(e).then(t=>(this.packaging=new ST(t),this.unpack(this.packaging)))}openManifest(e){return this.path=new El(e),this.load(e).then(t=>(this.packaging=new ST,this.packaging.load(t),this.unpack(this.packaging)))}load(e){var t=this.resolve(e);return this.archived?this.archive.request(t):this.request(t,null,this.settings.requestCredentials,this.settings.requestHeaders)}resolve(e,t){if(e){var i=e,s=e.indexOf("://")>-1;return s?e:(this.path&&(i=this.path.resolve(e)),t!=!1&&this.url&&(i=this.url.resolve(i)),i)}}canonical(e){var t=e;return e?(this.settings.canonical?t=this.settings.canonical(e):t=this.resolve(e,!0),t):""}determineType(e){var t,i,s;if(this.settings.encoding==="base64")return Kr.BASE64;if(typeof e!="string")return Kr.BINARY;if(t=new Jr(e),i=t.path(),s=i.extension,s&&(s=s.replace(/\?.*$/,"")),!s)return Kr.DIRECTORY;if(s==="epub")return Kr.EPUB;if(s==="opf")return Kr.OPF;if(s==="json")return Kr.MANIFEST}unpack(e){this.package=e,this.packaging.metadata.layout===""?this.load(this.url.resolve(Pq)).then(t=>{this.displayOptions=new _2(t),this.loading.displayOptions.resolve(this.displayOptions)}).catch(t=>{this.displayOptions=new _2,this.loading.displayOptions.resolve(this.displayOptions)}):(this.displayOptions=new _2,this.loading.displayOptions.resolve(this.displayOptions)),this.spine.unpack(this.packaging,this.resolve.bind(this),this.canonical.bind(this)),this.resources=new o$(this.packaging.manifest,{archive:this.archive,resolver:this.resolve.bind(this),request:this.request.bind(this),replacements:this.settings.replacements||(this.archived?"blobUrl":"base64")}),this.loadNavigation(this.packaging).then(()=>{this.loading.navigation.resolve(this.navigation)}),this.packaging.coverPath&&(this.cover=this.resolve(this.packaging.coverPath)),this.loading.manifest.resolve(this.packaging.manifest),this.loading.metadata.resolve(this.packaging.metadata),this.loading.spine.resolve(this.spine),this.loading.cover.resolve(this.cover),this.loading.resources.resolve(this.resources),this.loading.pageList.resolve(this.pageList),this.isOpen=!0,this.archived||this.settings.replacements&&this.settings.replacements!="none"?this.replacements().then(()=>{this.loaded.displayOptions.then(()=>{this.opening.resolve(this)})}).catch(t=>{console.error(t)}):this.loaded.displayOptions.then(()=>{this.opening.resolve(this)})}loadNavigation(e){let t=e.navPath||e.ncxPath,i=e.toc;return i?new Promise((s,r)=>{this.navigation=new A2(i),e.pageList&&(this.pageList=new E2(e.pageList)),s(this.navigation)}):t?this.load(t,"xml").then(s=>(this.navigation=new A2(s),this.pageList=new E2(s),this.navigation)):new Promise((s,r)=>{this.navigation=new A2,this.pageList=new E2,s(this.navigation)})}section(e){return this.spine.get(e)}renderTo(e,t){return this.rendition=new u_(this,t),this.rendition.attachTo(e),this.rendition}setRequestCredentials(e){this.settings.requestCredentials=e}setRequestHeaders(e){this.settings.requestHeaders=e}unarchive(e,t){return this.archive=new Oq,this.archive.open(e,t)}store(e){let t=this.settings.replacements&&this.settings.replacements!=="none",i=this.url,s=this.settings.requestMethod||qm.bind(this);return this.storage=new O4(e,s,this.resolve.bind(this)),this.request=this.storage.request.bind(this.storage),this.opened.then(()=>{this.archived&&(this.storage.requester=this.archive.request.bind(this.archive));let r=(a,o)=>{o.output=this.resources.substitute(a,o.url)};this.resources.settings.replacements=t||"blobUrl",this.resources.replacements().then(()=>this.resources.replaceCss()),this.storage.on("offline",()=>{this.url=new Jr("/",""),this.spine.hooks.serialize.register(r)}),this.storage.on("online",()=>{this.url=i,this.spine.hooks.serialize.deregister(r)})}),this.storage}coverUrl(){return this.loaded.cover.then(()=>this.cover?this.archived?this.archive.createUrl(this.cover):this.cover:null)}replacements(){return this.spine.hooks.serialize.register((e,t)=>{t.output=this.resources.substitute(e,t.url)}),this.resources.replacements().then(()=>this.resources.replaceCss())}getRange(e){var t=new jt(e),i=this.spine.get(t.spinePos),s=this.load.bind(this);return i?i.load(s).then(function(r){var a=t.toRange(i.document);return a}):new Promise((r,a)=>{a("CFI could not be found")})}key(e){var t=e||this.packaging.metadata.identifier||this.url.filename;return`epubjs:${nw}:${t}`}destroy(){this.opened=void 0,this.loading=void 0,this.loaded=void 0,this.ready=void 0,this.isOpen=!1,this.isRendered=!1,this.spine&&this.spine.destroy(),this.locations&&this.locations.destroy(),this.pageList&&this.pageList.destroy(),this.archive&&this.archive.destroy(),this.resources&&this.resources.destroy(),this.container&&this.container.destroy(),this.packaging&&this.packaging.destroy(),this.rendition&&this.rendition.destroy(),this.displayOptions&&this.displayOptions.destroy(),this.spine=void 0,this.locations=void 0,this.pageList=void 0,this.archive=void 0,this.resources=void 0,this.container=void 0,this.packaging=void 0,this.rendition=void 0,this.navigation=void 0,this.url=void 0,this.path=void 0,this.archived=!1}}ro(h_.prototype);function td(n,e){return new h_(n,e)}td.VERSION=nw;typeof global<"u"&&(global.EPUBJS_VERSION=nw);td.Book=h_;td.Rendition=u_;td.Contents=o_;td.CFI=jt;td.utils=W7;const N2=[{name:"yellow",value:"#fbbf24"},{name:"blue",value:"#3b82f6"},{name:"green",value:"#22c55e"},{name:"red",value:"#ef4444"}],Bq={dark:{color:"#e5e5e5",background:"#0f0f0f"},light:{color:"#1a1a1a",background:"#ffffff"},sepia:{color:"#5b4636",background:"#f4ecd8"}},RT="z-reader-book-typography-style";function LT(n,e){var r,a,o;const t=J1[e.font],i=String(e.lineHeight);let s=n.getElementById(RT);s||(s=n.createElement("style"),s.id=RT,(r=n.head)==null||r.appendChild(s)),s.textContent=`
    html, body {
      font-family: ${t} !important;
      line-height: ${i} !important;
    }
    body *:not(pre):not(code):not(kbd):not(samp) {
      font-family: ${t} !important;
    }
    body p, body li, body blockquote, body dd, body dt, body h1, body h2, body h3, body h4, body h5, body h6 {
      line-height: ${i} !important;
    }
  `,(a=n.body)==null||a.style.setProperty("font-family",t,"important"),(o=n.body)==null||o.style.setProperty("line-height",i,"important")}function I4(n,e=0){return n.map(t=>{var i;return{id:t.id,label:t.label.trim(),href:t.href,level:e,children:(i=t.subitems)!=null&&i.length?I4(t.subitems,e+1):void 0}})}const Fq=E.forwardRef(function({bookId:e,filePath:t,highlights:i,onHighlightsChange:s,onTocLoaded:r,onProgressChange:a,onLocationChange:o,settings:l,initialLocation:u},d){const f=E.useRef(null),p=E.useRef(null),g=E.useRef(null),x=E.useRef(l);x.current=l;const w=E.useRef(!1),y=E.useRef([]),m=E.useRef(i);m.current=i;const[v,b]=E.useState(null);E.useImperativeHandle(d,()=>({navigateTo(D){var j;(j=g.current)==null||j.display(D)},navigateToHighlight(D){var j;(j=g.current)==null||j.display(D)}}));const A=E.useCallback((D,j)=>{const P=Bq[j.theme];D.themes.override("color",P.color),D.themes.override("background",P.background),D.themes.fontSize(j.fontSize+"px"),D.themes.font(J1[j.font]),D.themes.override("line-height",String(j.lineHeight),!0);const H=D.getContents(),G=Array.isArray(H)?H:H?[H]:[];for(const $ of G){const Y=$==null?void 0:$.document;Y&&LT(Y,j)}},[]),S=E.useCallback(()=>{var D,j,P,H,G;try{const $=g.current,Y=((D=$==null?void 0:$.getContents)==null?void 0:D.call($))??[];for(const F of Y)(H=(P=(j=F.window)==null?void 0:j.getSelection)==null?void 0:P.call(j))==null||H.removeAllRanges();(G=window.getSelection())==null||G.removeAllRanges()}catch{}},[]),C=E.useCallback(D=>{for(const j of y.current)try{D.annotations.remove(j,"epub-highlight")}catch{}y.current=[]},[]),k=E.useCallback((D,j)=>{var H;const P=[];for(const G of j){if(!G.anchorPath)continue;const $=((H=N2.find(Y=>Y.name===G.color))==null?void 0:H.value)??N2[0].value;try{D.annotations.highlight(G.anchorPath,{},void 0,"epub-highlight",{fill:$,"fill-opacity":"0.3","mix-blend-mode":"multiply"}),P.push(G.anchorPath)}catch{}}y.current=P},[]);E.useEffect(()=>{if(!f.current)return;let D=!1,j=null,P=null;async function H(){const G=await window.electronAPI.bookReadFile(e);if(D||!G||!f.current)return;const $=td(G);j=$,p.current=$;const Y=$.renderTo(f.current,{flow:"scrolled",width:"100%",height:"100%"});P=Y,g.current=Y;const F=I=>{const V=I==null?void 0:I.document;V&&LT(V,x.current)};Y.hooks.content.register(F),A(Y,l);const M=u||void 0;Y.display(M),$.loaded.navigation.then(I=>{r(I4(I.toc))}).catch(()=>{r([])}),$.ready.then(()=>{w.current||(w.current=!0,$.locations.generate(1600))}),Y.on("relocated",I=>{I!=null&&I.start&&(a(I.start.percentage),o(I.start.cfi))}),Y.on("selected",I=>{var V,ie,ge;try{const ee=Y.getRange(I),me=(ee==null?void 0:ee.toString())??"";if(!me.trim())return;if(m.current.some(Oe=>Oe.anchorPath===I)){S(),b(null);return}const ae=ee.getBoundingClientRect(),Z=(V=f.current)==null?void 0:V.getBoundingClientRect();if(!ae||!Z)return;const re=((ie=ee.startContainer)==null?void 0:ie.ownerDocument)??null,ne=(ge=re==null?void 0:re.defaultView)==null?void 0:ge.frameElement,xe=ne==null?void 0:ne.getBoundingClientRect(),Re=xe?xe.left+ae.left+ae.width/2:ae.left+ae.width/2,je=xe?xe.top+ae.top:ae.top;b({x:Re-Z.left,y:je-Z.top-8,cfiRange:I,text:me})}catch{}}),Y.on("markClicked",(I,V)=>{var ee;const ie=typeof I=="string"&&I||(V==null?void 0:V.cfiRange)||((ee=V==null?void 0:V.annotation)==null?void 0:ee.cfiRange)||null;if(!ie)return;const ge=m.current.find(me=>me.anchorPath===ie);ge&&window.dispatchEvent(new CustomEvent("book-reader:highlight-click",{detail:{bookId:e,highlightId:ge.id}}))}),C(Y),k(Y,m.current)}return H().catch(()=>{r([])}),()=>{D=!0,P&&P.destroy(),j&&j.destroy(),p.current=null,g.current=null,y.current=[],w.current=!1}},[t,e,u,o,a,r,A,k,C,S]),E.useEffect(()=>{g.current&&A(g.current,l)},[l,A]),E.useEffect(()=>{const D=g.current;D&&(C(D),k(D,i))},[i,k,C]),E.useEffect(()=>{const D=j=>{var P,H;j.key==="ArrowLeft"&&((P=g.current)==null||P.prev()),j.key==="ArrowRight"&&((H=g.current)==null||H.next())};return document.addEventListener("keydown",D),()=>document.removeEventListener("keydown",D)},[]),E.useEffect(()=>{if(!v)return;const D=()=>b(null);return document.addEventListener("mousedown",D),()=>document.removeEventListener("mousedown",D)},[v]);const L=E.useCallback(async D=>{if(!v||!g.current)return;const{cfiRange:j,text:P}=v,H=m.current.find(G=>G.anchorPath===j);if(b(null),S(),H){if(H.color!==D)try{const G=await window.electronAPI.highlightUpdate({id:H.id,color:D});s(m.current.map($=>$.id===H.id?G:$))}catch{}return}try{const G=await window.electronAPI.bookHighlightCreate({bookId:e,text:P,anchorPath:j,color:D});s([...m.current,G])}catch{}},[v,e,s,S]);return h.jsxs("div",{className:"relative w-full h-full overflow-hidden",children:[h.jsx("div",{ref:f,className:"w-full h-full"}),v&&h.jsx("div",{className:"absolute z-50 flex items-center gap-1.5 px-2 py-1.5 bg-[#1a1a1a] border border-white/10 rounded-lg shadow-xl",style:{left:v.x,top:v.y,transform:"translate(-50%, -100%)"},onMouseDown:D=>D.stopPropagation(),children:N2.map(D=>h.jsx("button",{onClick:()=>L(D.name),className:"w-5 h-5 rounded-full border border-white/20 hover:scale-110 transition-transform cursor-pointer",style:{backgroundColor:D.value},title:D.name},D.name))})]})}),is=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),iA=[.001,0,0,.001,0,0],k2=1.35,Qs={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Bl={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},Gm="pdfjs_internal_editor_",ft={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},Tt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},zq={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},nA={TRIANGLES:1,LATTICE:2},tn={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},yx={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Gi={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},kd={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},ow={ERRORS:0,WARNINGS:1,INFOS:5},Ym={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Tg={moveTo:0,lineTo:1,curveTo:2,quadraticCurveTo:3,closePath:4},Uq={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let lw=ow.WARNINGS;function Hq(n){Number.isInteger(n)&&(lw=n)}function $q(){return lw}function cw(n){lw>=ow.INFOS&&console.info(`Info: ${n}`)}function ct(n){lw>=ow.WARNINGS&&console.warn(`Warning: ${n}`)}function zt(n){throw new Error(n)}function Bt(n,e){n||zt(e)}function qq(n){switch(n==null?void 0:n.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function P4(n,e=null,t=null){if(!n)return null;if(t&&typeof n=="string"){if(t.addDefaultProtocol&&n.startsWith("www.")){const s=n.match(/\./g);(s==null?void 0:s.length)>=2&&(n=`http://${n}`)}if(t.tryConvertEncoding)try{n=Kq(n)}catch{}}const i=e?URL.parse(n,e):URL.parse(n);return qq(i)?i:null}function B4(n,e,t=!1){const i=URL.parse(n);return i?(i.hash=e,i.href):t&&P4(n,"http://example.com")?n.split("#",1)[0]+`${e?`#${e}`:""}`:""}function ut(n,e,t,i=!1){return Object.defineProperty(n,e,{value:t,enumerable:!i,configurable:!0,writable:!1}),t}const id=function(){function e(t,i){this.message=t,this.name=i}return e.prototype=new Error,e.constructor=e,e}();class MT extends id{constructor(e,t){super(e,"PasswordException"),this.code=t}}class T2 extends id{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class sA extends id{constructor(e){super(e,"InvalidPDFException")}}class Yb extends id{constructor(e,t,i){super(e,"ResponseException"),this.status=t,this.missing=i}}class Vq extends id{constructor(e){super(e,"FormatError")}}class eu extends id{constructor(e){super(e,"AbortException")}}function Gq(n){(typeof n!="object"||(n==null?void 0:n.length)===void 0)&&zt("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const i=[];for(let s=0;s<e;s+=t){const r=Math.min(s+t,e),a=n.subarray(s,r);i.push(String.fromCharCode.apply(null,a))}return i.join("")}function uw(n){typeof n!="string"&&zt("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let i=0;i<e;++i)t[i]=n.charCodeAt(i)&255;return t}function Yq(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function Wq(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function Xq(){try{return new Function(""),!0}catch{return!1}}class on{static get isLittleEndian(){return ut(this,"isLittleEndian",Wq())}static get isEvalSupported(){return ut(this,"isEvalSupported",Xq())}static get isOffscreenCanvasSupported(){return ut(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return ut(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get isFloat16ArraySupported(){return ut(this,"isFloat16ArraySupported",typeof Float16Array<"u")}static get isSanitizerSupported(){return ut(this,"isSanitizerSupported",typeof Sanitizer<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return ut(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){var e,t;return ut(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const D2=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));var ul,vx,rA;class Ye{static makeHexColor(e,t,i){return`#${D2[e]}${D2[t]}${D2[i]}`}static domMatrixToTransform(e){return[e.a,e.b,e.c,e.d,e.e,e.f]}static scaleMinMax(e,t){let i;e[0]?(e[0]<0&&(i=t[0],t[0]=t[2],t[2]=i),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(i=t[1],t[1]=t[3],t[3]=i),t[1]*=e[3],t[3]*=e[3]):(i=t[0],t[0]=t[1],t[1]=i,i=t[2],t[2]=t[3],t[3]=i,e[1]<0&&(i=t[1],t[1]=t[3],t[3]=i),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(i=t[0],t[0]=t[2],t[2]=i),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static multiplyByDOMMatrix(e,t){return[e[0]*t.a+e[2]*t.b,e[1]*t.a+e[3]*t.b,e[0]*t.c+e[2]*t.d,e[1]*t.c+e[3]*t.d,e[0]*t.e+e[2]*t.f+e[4],e[1]*t.e+e[3]*t.f+e[5]]}static applyTransform(e,t,i=0){const s=e[i],r=e[i+1];e[i]=s*t[0]+r*t[2]+t[4],e[i+1]=s*t[1]+r*t[3]+t[5]}static applyTransformToBezier(e,t,i=0){const s=t[0],r=t[1],a=t[2],o=t[3],l=t[4],u=t[5];for(let d=0;d<6;d+=2){const f=e[i+d],p=e[i+d+1];e[i+d]=f*s+p*a+l,e[i+d+1]=f*r+p*o+u}}static applyInverseTransform(e,t){const i=e[0],s=e[1],r=t[0]*t[3]-t[1]*t[2];e[0]=(i*t[3]-s*t[2]+t[2]*t[5]-t[4]*t[3])/r,e[1]=(-i*t[1]+s*t[0]+t[4]*t[1]-t[5]*t[0])/r}static axialAlignedBoundingBox(e,t,i){const s=t[0],r=t[1],a=t[2],o=t[3],l=t[4],u=t[5],d=e[0],f=e[1],p=e[2],g=e[3];let x=s*d+l,w=x,y=s*p+l,m=y,v=o*f+u,b=v,A=o*g+u,S=A;if(r!==0||a!==0){const C=r*d,k=r*p,L=a*f,D=a*g;x+=L,m+=L,y+=D,w+=D,v+=C,S+=C,A+=k,b+=k}i[0]=Math.min(i[0],x,y,w,m),i[1]=Math.min(i[1],v,A,b,S),i[2]=Math.max(i[2],x,y,w,m),i[3]=Math.max(i[3],v,A,b,S)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const i=e[0],s=e[1],r=e[2],a=e[3],o=i**2+s**2,l=i*r+s*a,u=r**2+a**2,d=(o+u)/2,f=Math.sqrt(d**2-(o*u-l**2));t[0]=Math.sqrt(d+f||1),t[1]=Math.sqrt(d-f||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const i=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),s=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(i>s)return null;const r=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),a=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return r>a?null:[i,r,s,a]}static pointBoundingBox(e,t,i){i[0]=Math.min(i[0],e),i[1]=Math.min(i[1],t),i[2]=Math.max(i[2],e),i[3]=Math.max(i[3],t)}static rectBoundingBox(e,t,i,s,r){r[0]=Math.min(r[0],e,i),r[1]=Math.min(r[1],t,s),r[2]=Math.max(r[2],e,i),r[3]=Math.max(r[3],t,s)}static bezierBoundingBox(e,t,i,s,r,a,o,l,u){u[0]=Math.min(u[0],e,o),u[1]=Math.min(u[1],t,l),u[2]=Math.max(u[2],e,o),u[3]=Math.max(u[3],t,l),R(this,ul,rA).call(this,e,i,r,o,t,s,a,l,3*(-e+3*(i-r)+o),6*(e-2*i+r),3*(i-e),u),R(this,ul,rA).call(this,e,i,r,o,t,s,a,l,3*(-t+3*(s-a)+l),6*(t-2*s+a),3*(s-t),u)}}ul=new WeakSet,vx=function(e,t,i,s,r,a,o,l,u,d){if(u<=0||u>=1)return;const f=1-u,p=u*u,g=p*u,x=f*(f*(f*e+3*u*t)+3*p*i)+g*s,w=f*(f*(f*r+3*u*a)+3*p*o)+g*l;d[0]=Math.min(d[0],x),d[1]=Math.min(d[1],w),d[2]=Math.max(d[2],x),d[3]=Math.max(d[3],w)},rA=function(e,t,i,s,r,a,o,l,u,d,f,p){if(Math.abs(u)<1e-12){Math.abs(d)>=1e-12&&R(this,ul,vx).call(this,e,t,i,s,r,a,o,l,-f/d,p);return}const g=d**2-4*f*u;if(g<0)return;const x=Math.sqrt(g),w=2*u;R(this,ul,vx).call(this,e,t,i,s,r,a,o,l,(-d+x)/w,p),R(this,ul,vx).call(this,e,t,i,s,r,a,o,l,(-d-x)/w,p)},T(Ye,ul);function Kq(n){return decodeURIComponent(escape(n))}let j2=null,OT=null;function Zq(n){return j2||(j2=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,OT=new Map([["ï¬…","Å¿t"]])),n.replaceAll(j2,(e,t,i)=>t?t.normalize("NFKC"):OT.get(i))}function F4(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),Gq(n)}const Xd="pdfjs_internal_id_";function Qq(n,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[i,s,...r]=t;if(!n(i)&&!Number.isInteger(i)||!e(s))return!1;const a=r.length;let o=!0;switch(s.name){case"XYZ":if(a<2||a>3)return!1;break;case"Fit":case"FitB":return a===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(a>1)return!1;break;case"FitR":if(a!==4)return!1;o=!1;break;default:return!1}for(const l of r)if(!(typeof l=="number"||o&&l===null))return!1;return!0}function Dn(n,e,t){return Math.min(Math.max(n,e),t)}typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(n){return n.reduce((e,t)=>e+t,0)});class Wm{static textContent(e){const t=[],i={items:t,styles:Object.create(null)};function s(r){var l;if(!r)return;let a=null;const o=r.name;if(o==="#text")a=r.value;else if(Wm.shouldBuildText(o))(l=r==null?void 0:r.attributes)!=null&&l.textContent?a=r.attributes.textContent:r.value&&(a=r.value);else return;if(a!==null&&t.push({str:a}),!!r.children)for(const u of r.children)s(u)}return s(e),i}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}class z4{static setupStorage(e,t,i,s,r){const a=s.getValue(t,{value:null});switch(i.name){case"textarea":if(a.value!==null&&(e.textContent=a.value),r==="print")break;e.addEventListener("input",o=>{s.setValue(t,{value:o.target.value})});break;case"input":if(i.attributes.type==="radio"||i.attributes.type==="checkbox"){if(a.value===i.attributes.xfaOn?e.setAttribute("checked",!0):a.value===i.attributes.xfaOff&&e.removeAttribute("checked"),r==="print")break;e.addEventListener("change",o=>{s.setValue(t,{value:o.target.checked?o.target.getAttribute("xfaOn"):o.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&e.setAttribute("value",a.value),r==="print")break;e.addEventListener("input",o=>{s.setValue(t,{value:o.target.value})})}break;case"select":if(a.value!==null){e.setAttribute("value",a.value);for(const o of i.children)o.attributes.value===a.value?o.attributes.selected=!0:o.attributes.hasOwnProperty("selected")&&delete o.attributes.selected}e.addEventListener("input",o=>{const l=o.target.options,u=l.selectedIndex===-1?"":l[l.selectedIndex].value;s.setValue(t,{value:u})});break}}static setAttributes({html:e,element:t,storage:i=null,intent:s,linkService:r}){const{attributes:a}=t,o=e instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${s}`);for(const[l,u]of Object.entries(a))if(u!=null)switch(l){case"class":u.length&&e.setAttribute(l,u.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",u);break;case"style":Object.assign(e.style,u);break;case"textContent":e.textContent=u;break;default:(!o||l!=="href"&&l!=="newWindow")&&e.setAttribute(l,u)}o&&r.addLinkAttributes(e,a.href,a.newWindow),i&&a.dataId&&this.setupStorage(e,a.dataId,t,i)}static render(e){var f,p;const t=e.annotationStorage,i=e.linkService,s=e.xfaHtml,r=e.intent||"display",a=document.createElement(s.name);s.attributes&&this.setAttributes({html:a,element:s,intent:r,linkService:i});const o=r!=="richText",l=e.div;if(l.append(a),e.viewport){const g=`matrix(${e.viewport.transform.join(",")})`;l.style.transform=g}o&&l.setAttribute("class","xfaLayer xfaFont");const u=[];if(s.children.length===0){if(s.value){const g=document.createTextNode(s.value);a.append(g),o&&Wm.shouldBuildText(s.name)&&u.push(g)}return{textDivs:u}}const d=[[s,-1,a]];for(;d.length>0;){const[g,x,w]=d.at(-1);if(x+1===g.children.length){d.pop();continue}const y=g.children[++d.at(-1)[1]];if(y===null)continue;const{name:m}=y;if(m==="#text"){const b=document.createTextNode(y.value);u.push(b),w.append(b);continue}const v=(f=y==null?void 0:y.attributes)!=null&&f.xmlns?document.createElementNS(y.attributes.xmlns,m):document.createElement(m);if(w.append(v),y.attributes&&this.setAttributes({html:v,element:y,storage:t,intent:r,linkService:i}),((p=y.children)==null?void 0:p.length)>0)d.push([y,-1,v]);else if(y.value){const b=document.createTextNode(y.value);o&&Wm.shouldBuildText(m)&&u.push(b),v.append(b)}}for(const g of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))g.setAttribute("readOnly",!0);return{textDivs:u}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const ho="http://www.w3.org/2000/svg",vu=class vu{};fe(vu,"CSS",96),fe(vu,"PDF",72),fe(vu,"PDF_TO_CSS_UNITS",vu.CSS/vu.PDF);let tu=vu;async function pv(n,e="text"){if(Fg(n,document.baseURI)){const t=await fetch(n);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,i)=>{const s=new XMLHttpRequest;s.open("GET",n,!0),s.responseType=e,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){if(s.status===200||s.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(s.response);return}t(s.responseText);return}i(new Error(s.statusText))}},s.send(null)})}class gv{constructor({viewBox:e,userUnit:t,scale:i,rotation:s,offsetX:r=0,offsetY:a=0,dontFlip:o=!1}){this.viewBox=e,this.userUnit=t,this.scale=i,this.rotation=s,this.offsetX=r,this.offsetY=a,i*=t;const l=(e[2]+e[0])/2,u=(e[3]+e[1])/2;let d,f,p,g;switch(s%=360,s<0&&(s+=360),s){case 180:d=-1,f=0,p=0,g=1;break;case 90:d=0,f=1,p=1,g=0;break;case 270:d=0,f=-1,p=-1,g=0;break;case 0:d=1,f=0,p=0,g=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}o&&(p=-p,g=-g);let x,w,y,m;d===0?(x=Math.abs(u-e[1])*i+r,w=Math.abs(l-e[0])*i+a,y=(e[3]-e[1])*i,m=(e[2]-e[0])*i):(x=Math.abs(l-e[0])*i+r,w=Math.abs(u-e[1])*i+a,y=(e[2]-e[0])*i,m=(e[3]-e[1])*i),this.transform=[d*i,f*i,p*i,g*i,x-d*i*l-p*i*u,w-f*i*l-g*i*u],this.width=y,this.height=m}get rawDims(){const e=this.viewBox;return ut(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:i=this.offsetX,offsetY:s=this.offsetY,dontFlip:r=!1}={}){return new gv({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:i,offsetY:s,dontFlip:r})}convertToViewportPoint(e,t){const i=[e,t];return Ye.applyTransform(i,this.transform),i}convertToViewportRectangle(e){const t=[e[0],e[1]];Ye.applyTransform(t,this.transform);const i=[e[2],e[3]];return Ye.applyTransform(i,this.transform),[t[0],t[1],i[0],i[1]]}convertToPdfPoint(e,t){const i=[e,t];return Ye.applyInverseTransform(i,this.transform),i}}class hw extends id{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function dw(n){const e=n.length;let t=0;for(;t<e&&n[t].trim()==="";)t++;return n.substring(t,t+5).toLowerCase()==="data:"}function d_(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function Jq(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function eV(n,e="document.pdf"){if(typeof n!="string")return e;if(dw(n))return ct('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const i=(o=>{try{return new URL(o)}catch{try{return new URL(decodeURIComponent(o))}catch{try{return new URL(o,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(o),"https://foo.bar")}catch{return null}}}}})(n);if(!i)return e;const s=o=>{try{let l=decodeURIComponent(o);return l.includes("/")?(l=l.split("/").at(-1),l.test(/^\.pdf$/i)?l:o):l}catch{return o}},r=/\.pdf$/i,a=i.pathname.split("/").at(-1);if(r.test(a))return s(a);if(i.searchParams.size>0){const o=Array.from(i.searchParams.values()).reverse();for(const u of o)if(r.test(u))return s(u);const l=Array.from(i.searchParams.keys()).reverse();for(const u of l)if(r.test(u))return s(u)}if(i.hash){const l=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(i.hash);if(l)return s(l[0])}return e}class IT{constructor(){fe(this,"started",Object.create(null));fe(this,"times",[])}time(e){e in this.started&&ct(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||ct(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:i}of this.times)t=Math.max(i.length,t);for(const{name:i,start:s,end:r}of this.times)e.push(`${i.padEnd(t)} ${r-s}ms
`);return e.join("")}}function Fg(n,e){const t=e?URL.parse(n,e):URL.parse(n);return(t==null?void 0:t.protocol)==="http:"||(t==null?void 0:t.protocol)==="https:"}function Gr(n){n.preventDefault()}function Mi(n){n.preventDefault(),n.stopPropagation()}function tV(n){console.log("Deprecated API usage: "+n)}var Zm;class Wb{static toDateObject(e){if(e instanceof Date)return e;if(!e||typeof e!="string")return null;c(this,Zm)||_(this,Zm,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=c(this,Zm).exec(e);if(!t)return null;const i=parseInt(t[1],10);let s=parseInt(t[2],10);s=s>=1&&s<=12?s-1:0;let r=parseInt(t[3],10);r=r>=1&&r<=31?r:1;let a=parseInt(t[4],10);a=a>=0&&a<=23?a:0;let o=parseInt(t[5],10);o=o>=0&&o<=59?o:0;let l=parseInt(t[6],10);l=l>=0&&l<=59?l:0;const u=t[7]||"Z";let d=parseInt(t[8],10);d=d>=0&&d<=23?d:0;let f=parseInt(t[9],10)||0;return f=f>=0&&f<=59?f:0,u==="-"?(a+=d,o+=f):u==="+"&&(a-=d,o-=f),new Date(Date.UTC(i,s,r,a,o,l))}}Zm=new WeakMap,T(Wb,Zm);function iV(n,{scale:e=1,rotation:t=0}){const{width:i,height:s}=n.attributes.style,r=[0,0,parseInt(i),parseInt(s)];return new gv({viewBox:r,userUnit:1,scale:e,rotation:t})}function mv(n){if(n.startsWith("#")){const e=parseInt(n.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(e=>parseInt(e)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(ct(`Not a valid color format: "${n}"`),[0,0,0])}function nV(n){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of n.keys()){e.style.color=t;const i=window.getComputedStyle(e).color;n.set(t,mv(i))}e.remove()}function Ci(n){const{a:e,b:t,c:i,d:s,e:r,f:a}=n.getTransform();return[e,t,i,s,r,a]}function ba(n){const{a:e,b:t,c:i,d:s,e:r,f:a}=n.getTransform().invertSelf();return[e,t,i,s,r,a]}function Vh(n,e,t=!1,i=!0){if(e instanceof gv){const{pageWidth:s,pageHeight:r}=e.rawDims,{style:a}=n,o=on.isCSSRoundSupported,l=`var(--total-scale-factor) * ${s}px`,u=`var(--total-scale-factor) * ${r}px`,d=o?`round(down, ${l}, var(--scale-round-x))`:`calc(${l})`,f=o?`round(down, ${u}, var(--scale-round-y))`:`calc(${u})`;!t||e.rotation%180===0?(a.width=d,a.height=f):(a.width=f,a.height=d)}i&&n.setAttribute("data-main-rotation",e.rotation)}class eo{constructor(){const{pixelRatio:e}=eo;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,i,s,r=-1){let a=1/0,o=1/0,l=1/0;i=eo.capPixels(i,r),i>0&&(a=Math.sqrt(i/(e*t))),s!==-1&&(o=s/e,l=s/t);const u=Math.min(a,o,l);return this.sx>u||this.sy>u?(this.sx=u,this.sy=u,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const i=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,i):i}return e}}const aA=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class sV{static get isDarkMode(){var e;return ut(this,"isDarkMode",!!((e=window==null?void 0:window.matchMedia)!=null&&e.call(window,"(prefers-color-scheme: dark)").matches))}}class rV{static get commentForegroundColor(){const e=document.createElement("span");e.classList.add("comment","sidebar");const{style:t}=e;t.width=t.height="0",t.display="none",t.color="var(--comment-fg-color)",document.body.append(e);const{color:i}=window.getComputedStyle(e);return e.remove(),ut(this,"commentForegroundColor",mv(i))}}function aV(n,e,t,i){i=Math.min(Math.max(i??1,0),1);const s=255*(1-i);return n=Math.round(n*i+s),e=Math.round(e*i+s),t=Math.round(t*i+s),[n,e,t]}function PT(n,e){const t=n[0]/255,i=n[1]/255,s=n[2]/255,r=Math.max(t,i,s),a=Math.min(t,i,s),o=(r+a)/2;if(r===a)e[0]=e[1]=0;else{const l=r-a;switch(e[1]=o<.5?l/(r+a):l/(2-r-a),r){case t:e[0]=((i-s)/l+(i<s?6:0))*60;break;case i:e[0]=((s-t)/l+2)*60;break;case s:e[0]=((t-i)/l+4)*60;break}}e[2]=o}function oA(n,e){const t=n[0],i=n[1],s=n[2],r=(1-Math.abs(2*s-1))*i,a=r*(1-Math.abs(t/60%2-1)),o=s-r/2;switch(Math.floor(t/60)){case 0:e[0]=r+o,e[1]=a+o,e[2]=o;break;case 1:e[0]=a+o,e[1]=r+o,e[2]=o;break;case 2:e[0]=o,e[1]=r+o,e[2]=a+o;break;case 3:e[0]=o,e[1]=a+o,e[2]=r+o;break;case 4:e[0]=a+o,e[1]=o,e[2]=r+o;break;case 5:case 6:e[0]=r+o,e[1]=o,e[2]=a+o;break}}function BT(n){return n<=.03928?n/12.92:((n+.055)/1.055)**2.4}function FT(n,e,t){oA(n,t),t.map(BT);const i=.2126*t[0]+.7152*t[1]+.0722*t[2];oA(e,t),t.map(BT);const s=.2126*t[0]+.7152*t[1]+.0722*t[2];return i>s?(i+.05)/(s+.05):(s+.05)/(i+.05)}const zT=new Map;function oV(n,e){const t=n[0]+n[1]*256+n[2]*65536+e[0]*16777216+e[1]*4294967296+e[2]*1099511627776;let i=zT.get(t);if(i)return i;const s=new Float32Array(9),r=s.subarray(0,3),a=s.subarray(3,6);PT(n,a);const o=s.subarray(6,9);PT(e,o);const l=o[2]<.5,u=l?12:4.5;if(a[2]=l?Math.sqrt(a[2]):1-Math.sqrt(1-a[2]),FT(a,o,r)<u){let d,f;l?(d=a[2],f=1):(d=0,f=a[2]);const p=.005;for(;f-d>p;){const g=a[2]=(d+f)/2;l===FT(a,o,r)<u?d=g:f=g}a[2]=l?f:d}return oA(a,r),i=Ye.makeHexColor(Math.round(r[0]*255),Math.round(r[1]*255),Math.round(r[2]*255)),zT.set(t,i),i}function U4({html:n,dir:e,className:t},i){const s=document.createDocumentFragment();if(typeof n=="string"){const r=document.createElement("p");r.dir=e||"auto";const a=n.split(/(?:\r\n?|\n)/);for(let o=0,l=a.length;o<l;++o){const u=a[o];r.append(document.createTextNode(u)),o<l-1&&r.append(document.createElement("br"))}s.append(r)}else z4.render({xfaHtml:n,div:s,intent:"richText"});s.firstElementChild.classList.add("richText",t),i.append(s)}function H4(n){const e=new Path2D;if(!n)return e;for(let t=0,i=n.length;t<i;)switch(n[t++]){case Tg.moveTo:e.moveTo(n[t++],n[t++]);break;case Tg.lineTo:e.lineTo(n[t++],n[t++]);break;case Tg.curveTo:e.bezierCurveTo(n[t++],n[t++],n[t++],n[t++],n[t++],n[t++]);break;case Tg.quadraticCurveTo:e.quadraticCurveTo(n[t++],n[t++],n[t++],n[t++]);break;case Tg.closePath:e.closePath();break;default:ct(`Unrecognized drawing path operator: ${n[t-1]}`);break}return e}var vo,ea,hf,Fl,wu,ig,$4,q4;const Mt=class Mt{constructor(){T(this,ig)}get pagesNumber(){return c(Mt,Fl)}set pagesNumber(e){c(Mt,Fl)!==e&&(_(Mt,Fl,e),e===0&&(_(Mt,ea,null),_(Mt,vo,null)))}addListener(e){c(Mt,wu).push(e)}removeListener(e){const t=c(Mt,wu).indexOf(e);t>=0&&c(Mt,wu).splice(t,1)}movePages(e,t,i){R(this,ig,q4).call(this,!0);const s=c(Mt,ea),r=c(Mt,vo);c(Mt,hf).set(r);const a=t.length,o=new Uint32Array(a);let l=0;for(let g=0;g<a;g++){const x=t[g]-1;o[g]=s[x],x<i&&(l+=1)}const u=c(Mt,Fl);let d=i-l;const f=u-a;d=Dn(d,0,f);for(let g=0,x=0;g<u;g++)e.has(g+1)||(s[x++]=s[g]);s.copyWithin(d+a,d,f),s.set(o,d);let p=!1;for(let g=0,x=u;g<x;g++){const w=s[g];p||(p=w!==g+1),r[w-1]=g+1}R(this,ig,$4).call(this),p||(this.pagesNumber=0)}hasBeenAltered(){return c(Mt,ea)!==null}getPageMappingForSaving(){return{pageIndices:c(Mt,vo)?c(Mt,vo).map(e=>e-1):null}}getPrevPageNumber(e){return c(Mt,hf)[c(Mt,ea)[e-1]-1]}getPageNumber(e){var t;return((t=c(Mt,vo))==null?void 0:t[e-1])??e}getPageId(e){var t;return((t=c(Mt,ea))==null?void 0:t[e-1])??e}static get instance(){return ut(this,"instance",new Mt)}getMapping(){return c(Mt,ea).subarray(0,this.pagesNumber)}};vo=new WeakMap,ea=new WeakMap,hf=new WeakMap,Fl=new WeakMap,wu=new WeakMap,ig=new WeakSet,$4=function(){for(const e of c(Mt,wu))e()},q4=function(e){if(c(Mt,ea))return;const t=c(Mt,Fl),i=new Uint32Array(3*t),s=_(Mt,ea,i.subarray(0,t)),r=_(Mt,vo,i.subarray(t,2*t));if(e)for(let a=0;a<t;a++)s[a]=r[a]=a+1;_(Mt,hf,i.subarray(2*t))},T(Mt,vo,null),T(Mt,ea,null),T(Mt,hf,null),T(Mt,Fl,0),T(Mt,wu,[]);let Xm=Mt;var zl,Ul,vr,xr,Qm,Hl,df,ff,Jm,a1,V4,On,G4,Y4,Td,zg;const go=class go{constructor(e){T(this,On);T(this,zl,null);T(this,Ul,null);T(this,vr);T(this,xr,null);T(this,Qm,null);T(this,Hl,null);T(this,df,null);T(this,ff,null);_(this,vr,e),c(go,Jm)||_(go,Jm,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const e=_(this,zl,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=c(this,vr)._uiManager._signal;t instanceof AbortSignal&&!t.aborted&&(e.addEventListener("contextmenu",Gr,{signal:t}),e.addEventListener("pointerdown",R(go,a1,V4),{signal:t}));const i=_(this,xr,document.createElement("div"));i.className="buttons",e.append(i);const s=c(this,vr).toolbarPosition;if(s){const{style:r}=e,a=c(this,vr)._uiManager.direction==="ltr"?1-s[0]:s[0];r.insetInlineEnd=`${100*a}%`,r.top=`calc(${100*s[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return c(this,zl)}hide(){var e;c(this,zl).classList.add("hidden"),(e=c(this,Ul))==null||e.hideDropdown()}show(){var e,t;c(this,zl).classList.remove("hidden"),(e=c(this,Qm))==null||e.shown(),(t=c(this,Hl))==null||t.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=c(this,vr),i=document.createElement("button");i.classList.add("basic","deleteButton"),i.tabIndex=0,i.setAttribute("data-l10n-id",c(go,Jm)[e]),R(this,On,Td).call(this,i)&&i.addEventListener("click",s=>{t.delete()},{signal:t._signal}),c(this,xr).append(i)}async addAltText(e){const t=await e.render();R(this,On,Td).call(this,t),c(this,xr).append(t,c(this,On,zg)),_(this,Qm,e)}addComment(e,t=null){if(c(this,Hl))return;const i=e.renderForToolbar();if(!i)return;R(this,On,Td).call(this,i);const s=_(this,df,c(this,On,zg));t?(c(this,xr).insertBefore(i,t),c(this,xr).insertBefore(s,t)):c(this,xr).append(i,s),_(this,Hl,e),e.toolbar=this}addColorPicker(e){if(c(this,Ul))return;_(this,Ul,e);const t=e.renderButton();R(this,On,Td).call(this,t),c(this,xr).append(t,c(this,On,zg))}async addEditSignatureButton(e){const t=_(this,ff,await e.renderEditButton(c(this,vr)));R(this,On,Td).call(this,t),c(this,xr).append(t,c(this,On,zg))}removeButton(e){var t,i;switch(e){case"comment":(t=c(this,Hl))==null||t.removeToolbarCommentButton(),_(this,Hl,null),(i=c(this,df))==null||i.remove(),_(this,df,null);break}}async addButton(e,t){switch(e){case"colorPicker":t&&this.addColorPicker(t);break;case"altText":t&&await this.addAltText(t);break;case"editSignature":t&&await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break;case"comment":t&&this.addComment(t);break}}async addButtonBefore(e,t,i){if(!t&&e==="comment")return;const s=c(this,xr).querySelector(i);s&&e==="comment"&&this.addComment(t,s)}updateEditSignatureButton(e){c(this,ff)&&(c(this,ff).title=e)}remove(){var e;c(this,zl).remove(),(e=c(this,Ul))==null||e.destroy(),_(this,Ul,null)}};zl=new WeakMap,Ul=new WeakMap,vr=new WeakMap,xr=new WeakMap,Qm=new WeakMap,Hl=new WeakMap,df=new WeakMap,ff=new WeakMap,Jm=new WeakMap,a1=new WeakSet,V4=function(e){e.stopPropagation()},On=new WeakSet,G4=function(e){c(this,vr)._focusEventsAllowed=!1,Mi(e)},Y4=function(e){c(this,vr)._focusEventsAllowed=!0,Mi(e)},Td=function(e){const t=c(this,vr)._uiManager._signal;return!(t instanceof AbortSignal)||t.aborted?!1:(e.addEventListener("focusin",R(this,On,G4).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",R(this,On,Y4).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",Gr,{signal:t}),!0)},zg=function(){const e=document.createElement("div");return e.className="divider",e},T(go,a1),T(go,Jm,null);let lA=go;var e0,Su,xo,Cl,W4,X4,cA;class lV{constructor(e){T(this,Cl);T(this,e0,null);T(this,Su,null);T(this,xo);_(this,xo,e)}show(e,t,i){const[s,r]=R(this,Cl,X4).call(this,t,i),{style:a}=c(this,Su)||_(this,Su,R(this,Cl,W4).call(this));e.append(c(this,Su)),a.insetInlineEnd=`${100*s}%`,a.top=`calc(${100*r}% + var(--editor-toolbar-vert-offset))`}hide(){c(this,Su).remove()}}e0=new WeakMap,Su=new WeakMap,xo=new WeakMap,Cl=new WeakSet,W4=function(){const e=_(this,Su,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar");const t=c(this,xo)._signal;t instanceof AbortSignal&&!t.aborted&&e.addEventListener("contextmenu",Gr,{signal:t});const i=_(this,e0,document.createElement("div"));return i.className="buttons",e.append(i),c(this,xo).hasCommentManager()&&R(this,Cl,cA).call(this,"commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{c(this,xo).commentSelection("floating_button")}),R(this,Cl,cA).call(this,"highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{c(this,xo).highlightSelection("floating_button")}),e},X4=function(e,t){let i=0,s=0;for(const r of e){const a=r.y+r.height;if(a<i)continue;const o=r.x+(t?r.width:0);if(a>i){s=o,i=a;continue}t?o>s&&(s=o):o<s&&(s=o)}return[t?1-s:s,i]},cA=function(e,t,i,s){const r=document.createElement("button");r.classList.add("basic",e),r.tabIndex=0,r.setAttribute("data-l10n-id",t);const a=document.createElement("span");r.append(a),a.className="visuallyHidden",a.setAttribute("data-l10n-id",i);const o=c(this,xo)._signal;o instanceof AbortSignal&&!o.aborted&&(r.addEventListener("contextmenu",Gr,{signal:o}),r.addEventListener("click",s,{signal:o})),c(this,e0).append(r)};function K4(n,e,t){for(const i of t)e.addEventListener(i,n[i].bind(n))}var Au,Eu,pf,Cu;const Zt=class Zt{static initializeAndAddPointerId(e){(c(Zt,Eu)||_(Zt,Eu,new Set)).add(e)}static setPointer(e,t){c(Zt,Au)||_(Zt,Au,t),c(Zt,Cu)??_(Zt,Cu,e)}static setTimeStamp(e){_(Zt,pf,e)}static isSamePointerId(e){return c(Zt,Au)===e}static isSamePointerIdOrRemove(e){var t;return c(Zt,Au)===e?!0:((t=c(Zt,Eu))==null||t.delete(e),!1)}static isSamePointerType(e){return c(Zt,Cu)===e}static isInitializedAndDifferentPointerType(e){return c(Zt,Cu)!==null&&!Zt.isSamePointerType(e)}static isSameTimeStamp(e){return c(Zt,pf)===e}static isUsingMultiplePointers(){var e;return((e=c(Zt,Eu))==null?void 0:e.size)>=1}static clearPointerType(){_(Zt,Cu,null)}static clearPointerIds(){_(Zt,Au,NaN),_(Zt,Eu,null)}static clearTimeStamp(){_(Zt,pf,NaN)}};Au=new WeakMap,Eu=new WeakMap,pf=new WeakMap,Cu=new WeakMap,T(Zt,Au,NaN),T(Zt,Eu,null),T(Zt,pf,NaN),T(Zt,Cu,null);let Hn=Zt;var o1;class cV{constructor(){T(this,o1,0)}get id(){return`${Gm}${en(this,o1)._++}`}}o1=new WeakMap;var gf,t0,$n,mf,xx;const w_=class w_{constructor(){T(this,mf);T(this,gf,F4());T(this,t0,0);T(this,$n,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',i=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),s=new Image;s.src=e;const r=s.decode().then(()=>(i.drawImage(s,0,0,1,1,0,0,1,3),new Uint32Array(i.getImageData(0,0,1,1).data.buffer)[0]===0));return ut(this,"_isSVGFittingCanvas",r)}async getFromFile(e){const{lastModified:t,name:i,size:s,type:r}=e;return R(this,mf,xx).call(this,`${t}_${i}_${s}_${r}`,e)}async getFromUrl(e){return R(this,mf,xx).call(this,e,e)}async getFromBlob(e,t){const i=await t;return R(this,mf,xx).call(this,e,i)}async getFromId(e){c(this,$n)||_(this,$n,new Map);const t=c(this,$n).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:i}=t;return delete t.blobPromise,this.getFromBlob(t.id,i)}return this.getFromUrl(t.url)}getFromCanvas(e,t){c(this,$n)||_(this,$n,new Map);let i=c(this,$n).get(e);if(i!=null&&i.bitmap)return i.refCounter+=1,i;const s=new OffscreenCanvas(t.width,t.height);return s.getContext("2d").drawImage(t,0,0),i={bitmap:s.transferToImageBitmap(),id:`image_${c(this,gf)}_${en(this,t0)._++}`,refCounter:1,isSvg:!1},c(this,$n).set(e,i),c(this,$n).set(i.id,i),i}getSvgUrl(e){const t=c(this,$n).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var s;c(this,$n)||_(this,$n,new Map);const t=c(this,$n).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:i}=t;if(!t.url&&!t.file){const r=new OffscreenCanvas(i.width,i.height);r.getContext("bitmaprenderer").transferFromImageBitmap(i),t.blobPromise=r.convertToBlob()}(s=i.close)==null||s.call(i),t.bitmap=null}isValidId(e){return e.startsWith(`image_${c(this,gf)}_`)}};gf=new WeakMap,t0=new WeakMap,$n=new WeakMap,mf=new WeakSet,xx=async function(e,t){c(this,$n)||_(this,$n,new Map);let i=c(this,$n).get(e);if(i===null)return null;if(i!=null&&i.bitmap)return i.refCounter+=1,i;try{i||(i={bitmap:null,id:`image_${c(this,gf)}_${en(this,t0)._++}`,refCounter:0,isSvg:!1});let s;if(typeof t=="string"?(i.url=t,s=await pv(t,"blob")):t instanceof File?s=i.file=t:t instanceof Blob&&(s=t),s.type==="image/svg+xml"){const r=w_._isSVGFittingCanvas,a=new FileReader,o=new Image,l=new Promise((u,d)=>{o.onload=()=>{i.bitmap=o,i.isSvg=!0,u()},a.onload=async()=>{const f=i.svgUrl=a.result;o.src=await r?`${f}#svgView(preserveAspectRatio(none))`:f},o.onerror=a.onerror=d});a.readAsDataURL(s),await l}else i.bitmap=await createImageBitmap(s);i.refCounter=1}catch(s){ct(s),i=null}return c(this,$n).set(e,i),i&&c(this,$n).set(i.id,i),i};let uA=w_;var Bi,$l,i0,Ai;class uV{constructor(e=128){T(this,Bi,[]);T(this,$l,!1);T(this,i0);T(this,Ai,-1);_(this,i0,e)}add({cmd:e,undo:t,post:i,mustExec:s,type:r=NaN,overwriteIfSameType:a=!1,keepUndo:o=!1}){if(s&&e(),c(this,$l))return;const l={cmd:e,undo:t,post:i,type:r};if(c(this,Ai)===-1){c(this,Bi).length>0&&(c(this,Bi).length=0),_(this,Ai,0),c(this,Bi).push(l);return}if(a&&c(this,Bi)[c(this,Ai)].type===r){o&&(l.undo=c(this,Bi)[c(this,Ai)].undo),c(this,Bi)[c(this,Ai)]=l;return}const u=c(this,Ai)+1;u===c(this,i0)?c(this,Bi).splice(0,1):(_(this,Ai,u),u<c(this,Bi).length&&c(this,Bi).splice(u)),c(this,Bi).push(l)}undo(){if(c(this,Ai)===-1)return;_(this,$l,!0);const{undo:e,post:t}=c(this,Bi)[c(this,Ai)];e(),t==null||t(),_(this,$l,!1),_(this,Ai,c(this,Ai)-1)}redo(){if(c(this,Ai)<c(this,Bi).length-1){_(this,Ai,c(this,Ai)+1),_(this,$l,!0);const{cmd:e,post:t}=c(this,Bi)[c(this,Ai)];e(),t==null||t(),_(this,$l,!1)}}hasSomethingToUndo(){return c(this,Ai)!==-1}hasSomethingToRedo(){return c(this,Ai)<c(this,Bi).length-1}cleanType(e){if(c(this,Ai)!==-1){for(let t=c(this,Ai);t>=0;t--)if(c(this,Bi)[t].type!==e){c(this,Bi).splice(t+1,c(this,Ai)-t),_(this,Ai,t);return}c(this,Bi).length=0,_(this,Ai,-1)}}destroy(){_(this,Bi,null)}}Bi=new WeakMap,$l=new WeakMap,i0=new WeakMap,Ai=new WeakMap;var l1,Z4;class yv{constructor(e){T(this,l1);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=on.platform;for(const[i,s,r={}]of e)for(const a of i){const o=a.startsWith("mac+");t&&o?(this.callbacks.set(a.slice(4),{callback:s,options:r}),this.allKeys.add(a.split("+").at(-1))):!t&&!o&&(this.callbacks.set(a,{callback:s,options:r}),this.allKeys.add(a.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const i=this.callbacks.get(R(this,l1,Z4).call(this,t));if(!i)return;const{callback:s,options:{bubbles:r=!1,args:a=[],checker:o=null}}=i;o&&!o(e,t)||(s.bind(e,...a,t)(),r||Mi(t))}}l1=new WeakSet,Z4=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const c1=class c1{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return nV(e),ut(this,"_colors",e)}convert(e){const t=mv(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[i,s]of this._colors)if(s.every((r,a)=>r===t[a]))return c1._colorsMapping.get(i);return t}getHexCode(e){const t=this._colors.get(e);return t?Ye.makeHexColor(...t):e}};fe(c1,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let hA=c1;var yf,Ls,vf,Ei,Fi,xf,br,bf,wr,qn,ql,Vl,wf,Gl,Aa,Sr,_u,n0,s0,Sf,r0,Ea,Yl,Af,Wl,Ca,u1,Xl,Ef,a0,Kl,Nu,Cf,Zl,o0,Yi,Vt,bo,Ql,Jl,l0,_f,c0,ec,_a,wo,u0,h0,Ar,Ue,bx,dA,Q4,J4,Ug,eL,tL,iL,fA,nL,sL,rL,aL,Kn,fo,oL,lL,pA,cL,Hg,gA;const Zd=class Zd{constructor(e,t,i,s,r,a,o,l,u,d,f,p,g,x,w,y){T(this,Ue);T(this,yf,new AbortController);T(this,Ls,null);T(this,vf,null);T(this,Ei,new Map);T(this,Fi,new Map);T(this,xf,null);T(this,br,null);T(this,bf,null);T(this,wr,new uV);T(this,qn,null);T(this,ql,null);T(this,Vl,null);T(this,wf,0);T(this,Gl,new Set);T(this,Aa,null);T(this,Sr,null);T(this,_u,new Set);fe(this,"_editorUndoBar",null);T(this,n0,!1);T(this,s0,!1);T(this,Sf,!1);T(this,r0,null);T(this,Ea,null);T(this,Yl,null);T(this,Af,null);T(this,Wl,!1);T(this,Ca,null);T(this,u1,new cV);T(this,Xl,!1);T(this,Ef,!1);T(this,a0,!1);T(this,Kl,null);T(this,Nu,null);T(this,Cf,null);T(this,Zl,null);T(this,o0,null);T(this,Yi,ft.NONE);T(this,Vt,new Set);T(this,bo,null);T(this,Ql,null);T(this,Jl,null);T(this,l0,null);T(this,_f,null);T(this,c0,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});T(this,ec,[0,0]);T(this,_a,null);T(this,wo,null);T(this,u0,null);T(this,h0,null);T(this,Ar,null);const m=this._signal=c(this,yf).signal;_(this,wo,e),_(this,u0,t),_(this,h0,i),_(this,xf,s),_(this,qn,r),_(this,Ql,a),_(this,_f,l),this._eventBus=o,o._on("editingaction",this.onEditingAction.bind(this),{signal:m}),o._on("pagechanging",this.onPageChanging.bind(this),{signal:m}),o._on("scalechanging",this.onScaleChanging.bind(this),{signal:m}),o._on("rotationchanging",this.onRotationChanging.bind(this),{signal:m}),o._on("setpreference",this.onSetPreference.bind(this),{signal:m}),o._on("switchannotationeditorparams",v=>this.updateParams(v.type,v.value),{signal:m}),o._on("pagesedited",this.onPagesEdited.bind(this),{signal:m}),window.addEventListener("pointerdown",()=>{_(this,Ef,!0)},{capture:!0,signal:m}),window.addEventListener("pointerup",()=>{_(this,Ef,!1)},{capture:!0,signal:m}),R(this,Ue,eL).call(this),R(this,Ue,aL).call(this),R(this,Ue,fA).call(this),_(this,br,l.annotationStorage),_(this,r0,l.filterFactory),_(this,Jl,u),_(this,Af,d||null),_(this,n0,f),_(this,s0,p),_(this,Sf,g),_(this,o0,x||null),this.viewParameters={realScale:tu.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=w||null,this._supportsPinchToZoom=y!==!1,r==null||r.setSidebarUiManager(this)}static get _keyboardManager(){const e=Zd.prototype,t=a=>c(a,wo).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),i=(a,{target:o})=>{if(o instanceof HTMLInputElement){const{type:l}=o;return l!=="text"&&l!=="number"}return!0},s=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return ut(this,"_keyboardManager",new yv([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],e.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:i}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&c(a,wo).contains(o)&&!a.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&c(a,wo).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-s,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[s,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-s],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,s],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:t}]]))}destroy(){var e,t,i,s,r,a,o,l,u;(e=c(this,Ar))==null||e.resolve(),_(this,Ar,null),(t=c(this,yf))==null||t.abort(),_(this,yf,null),this._signal=null;for(const d of c(this,Fi).values())d.destroy();c(this,Fi).clear(),c(this,Ei).clear(),c(this,_u).clear(),(i=c(this,Zl))==null||i.clear(),_(this,Ls,null),c(this,Vt).clear(),c(this,wr).destroy(),(s=c(this,xf))==null||s.destroy(),(r=c(this,qn))==null||r.destroy(),(a=c(this,Ql))==null||a.destroy(),(o=c(this,Ca))==null||o.hide(),_(this,Ca,null),(l=c(this,Cf))==null||l.destroy(),_(this,Cf,null),_(this,vf,null),c(this,Ea)&&(clearTimeout(c(this,Ea)),_(this,Ea,null)),c(this,_a)&&(clearTimeout(c(this,_a)),_(this,_a,null)),(u=this._editorUndoBar)==null||u.destroy(),_(this,_f,null)}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return c(this,o0)}get useNewAltTextFlow(){return c(this,s0)}get useNewAltTextWhenAddingImage(){return c(this,Sf)}get hcmFilter(){return ut(this,"hcmFilter",c(this,Jl)?c(this,r0).addHCMFilter(c(this,Jl).foreground,c(this,Jl).background):"none")}get direction(){return ut(this,"direction",getComputedStyle(c(this,wo)).direction)}get _highlightColors(){return ut(this,"_highlightColors",c(this,Af)?new Map(c(this,Af).split(",").map(e=>(e=e.split("=").map(t=>t.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColors(){const{_highlightColors:e}=this;if(!e)return ut(this,"highlightColors",null);const t=new Map,i=!!c(this,Jl);for(const[s,r]of e){const a=s.endsWith("_HCM");if(i&&a){t.set(s.replace("_HCM",""),r);continue}!i&&!a&&t.set(s,r)}return ut(this,"highlightColors",t)}get highlightColorNames(){return ut(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}getNonHCMColor(e){if(!this._highlightColors)return e;const t=this.highlightColorNames.get(e);return this._highlightColors.get(t)||e}getNonHCMColorName(e){return this.highlightColorNames.get(e)||e}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),_(this,Vl,e)}setMainHighlightColorPicker(e){_(this,Cf,e)}editAltText(e,t=!1){var i;(i=c(this,xf))==null||i.editAltText(this,e,t)}hasCommentManager(){return!!c(this,qn)}editComment(e,t,i,s){var r;(r=c(this,qn))==null||r.showDialog(this,e,t,i,s)}selectComment(e,t){const i=c(this,Fi).get(e),s=i==null?void 0:i.getEditorByUID(t);s==null||s.toggleComment(!0,!0)}updateComment(e){var t;(t=c(this,qn))==null||t.updateComment(e.getData())}updatePopupColor(e){var t;(t=c(this,qn))==null||t.updatePopupColor(e)}removeComment(e){var t;(t=c(this,qn))==null||t.removeComments([e.uid])}deleteComment(e,t){const i=()=>{e.comment=t},s=()=>{var r;(r=this._editorUndoBar)==null||r.show(i,"comment"),this.toggleComment(null),e.comment=null};this.addCommands({cmd:s,undo:i,mustExec:!0})}toggleComment(e,t,i=void 0){var s;(s=c(this,qn))==null||s.toggleCommentPopup(e,t,i)}makeCommentColor(e,t){var i;return e&&((i=c(this,qn))==null?void 0:i.makeCommentColor(e,t))||null}getCommentDialogElement(){var e;return((e=c(this,qn))==null?void 0:e.dialogElement)||null}async waitForEditorsRendered(e){if(c(this,Fi).has(e-1))return;const{resolve:t,promise:i}=Promise.withResolvers(),s=r=>{r.pageNumber===e&&(this._eventBus._off("editorsrendered",s),t())};this._eventBus.on("editorsrendered",s),await i}getSignature(e){var t;(t=c(this,Ql))==null||t.getSignature({uiManager:this,editor:e})}get signatureManager(){return c(this,Ql)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":_(this,Sf,t);break}}onPagesEdited({pagesMapper:e}){for(const s of c(this,Ei).values())s.updatePageIndex(e.getPrevPageNumber(s.pageIndex+1)-1);const t=c(this,Fi),i=_(this,Fi,new Map);for(const[s,r]of t){const a=e.getPrevPageNumber(s+1)-1;if(a===-1){r.destroy();continue}i.set(a,r),r.updatePageIndex(a)}}onPageChanging({pageNumber:e}){_(this,wf,e-1)}focusMainContainer(){c(this,wo).focus()}findParent(e,t){for(const i of c(this,Fi).values()){const{x:s,y:r,width:a,height:o}=i.div.getBoundingClientRect();if(e>=s&&e<=s+a&&t>=r&&t<=r+o)return i}return null}disableUserSelect(e=!1){c(this,u0).classList.toggle("noUserSelect",e)}addShouldRescale(e){c(this,_u).add(e)}removeShouldRescale(e){c(this,_u).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*tu.PDF_TO_CSS_UNITS;for(const i of c(this,_u))i.onScaleChanging();(t=c(this,Vl))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e="",t=!1){const i=document.getSelection();if(!i||i.isCollapsed)return;const{anchorNode:s,anchorOffset:r,focusNode:a,focusOffset:o}=i,l=i.toString(),d=R(this,Ue,bx).call(this,i).closest(".textLayer"),f=this.getSelectionBoxes(d);if(!f)return;i.empty();const p=R(this,Ue,dA).call(this,d),g=c(this,Yi)===ft.NONE,x=()=>{const w=p==null?void 0:p.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:f,anchorNode:s,anchorOffset:r,focusNode:a,focusOffset:o,text:l});g&&this.showAllEditors("highlight",!0,!0),t&&(w==null||w.editComment())};if(g){this.switchToMode(ft.HIGHLIGHT,x);return}x()}commentSelection(e=""){this.highlightSelection(e,!0)}getAndRemoveDataFromAnnotationStorage(e){if(!c(this,br))return null;const t=`${Gm}${e}`,i=c(this,br).getRawValue(t);return i&&c(this,br).remove(t),i}addToAnnotationStorage(e){!e.isEmpty()&&c(this,br)&&!c(this,br).has(e.id)&&c(this,br).setValue(e.id,e)}a11yAlert(e,t=null){const i=c(this,h0);i&&(i.setAttribute("data-l10n-id",e),t?i.setAttribute("data-l10n-args",JSON.stringify(t)):i.removeAttribute("data-l10n-args"))}blur(){if(this.isShiftKeyDown=!1,c(this,Wl)&&(_(this,Wl,!1),R(this,Ue,Ug).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of c(this,Vt))if(t.div.contains(e)){_(this,Nu,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!c(this,Nu))return;const[e,t]=c(this,Nu);_(this,Nu,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){R(this,Ue,fA).call(this),this.setEditingState(!0)}removeEditListeners(){R(this,Ue,nL).call(this),this.setEditingState(!1)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const i of c(this,Sr))if(i.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const i of c(this,Sr))if(i.isHandlingMimeForPasting(t.type)){i.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var i;if(e.preventDefault(),(i=c(this,Ls))==null||i.commitOrRemove(),!this.hasSelection)return;const t=[];for(const s of c(this,Vt)){const r=s.serialize(!0);r&&t.push(r)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const r of t.items)for(const a of c(this,Sr))if(a.isHandlingMimeForPasting(r.type)){a.paste(r,this.currentLayer);return}let i=t.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(r){ct(`paste: "${r.message}".`);return}if(!Array.isArray(i))return;this.unselectAll();const s=this.currentLayer;try{const r=[];for(const l of i){const u=await s.deserialize(l);if(!u)return;r.push(u)}const a=()=>{for(const l of r)R(this,Ue,pA).call(this,l);R(this,Ue,gA).call(this,r)},o=()=>{for(const l of r)l.remove()};this.addCommands({cmd:a,undo:o,mustExec:!0})}catch(r){ct(`paste: "${r.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),c(this,Yi)!==ft.NONE&&!this.isEditorHandlingKeyboard&&Zd._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,c(this,Wl)&&(_(this,Wl,!1),R(this,Ue,Ug).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}setEditingState(e){e?(R(this,Ue,tL).call(this),R(this,Ue,sL).call(this),R(this,Ue,Kn).call(this,{isEditing:c(this,Yi)!==ft.NONE,isEmpty:R(this,Ue,Hg).call(this),hasSomethingToUndo:c(this,wr).hasSomethingToUndo(),hasSomethingToRedo:c(this,wr).hasSomethingToRedo(),hasSelectedEditor:!1})):(R(this,Ue,iL).call(this),R(this,Ue,rL).call(this),R(this,Ue,Kn).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!c(this,Sr)){_(this,Sr,e);for(const t of c(this,Sr))R(this,Ue,fo).call(this,t.defaultPropertiesToUpdate)}}getId(){return c(this,u1).id}get currentLayer(){return c(this,Fi).get(c(this,wf))}getLayer(e){return c(this,Fi).get(e)}get currentPageIndex(){return c(this,wf)}addLayer(e){c(this,Fi).set(e.pageIndex,e),c(this,Xl)?e.enable():e.disable()}removeLayer(e){c(this,Fi).delete(e.pageIndex)}async updateMode(e,t=null,i=!1,s=!1,r=!1,a=!1){var o,l,u,d,f,p;if(c(this,Yi)!==e&&!(c(this,Ar)&&(await c(this,Ar).promise,!c(this,Ar)))){if(_(this,Ar,Promise.withResolvers()),(o=c(this,Vl))==null||o.commitOrRemove(),c(this,Yi)===ft.POPUP&&((l=c(this,qn))==null||l.hideSidebar()),(u=c(this,qn))==null||u.destroyPopup(),_(this,Yi,e),e===ft.NONE){this.setEditingState(!1),R(this,Ue,lL).call(this);for(const g of c(this,Ei).values())g.hideStandaloneCommentButton();(d=this._editorUndoBar)==null||d.hide(),this.toggleComment(null),c(this,Ar).resolve();return}for(const g of c(this,Ei).values())g.addStandaloneCommentButton();e===ft.SIGNATURE&&await((f=c(this,Ql))==null?void 0:f.loadSignatures()),i&&Hn.clearPointerType(),this.setEditingState(!0),await R(this,Ue,oL).call(this),this.unselectAll();for(const g of c(this,Fi).values())g.updateMode(e);if(e===ft.POPUP){c(this,vf)||_(this,vf,await c(this,_f).getAnnotationsByType(new Set(c(this,Sr).map(w=>w._editorType))));const g=new Set,x=[];for(const w of c(this,Ei).values()){const{annotationElementId:y,hasComment:m,deleted:v}=w;y&&g.add(y),m&&!v&&x.push(w.getData())}for(const w of c(this,vf)){const{id:y,popupRef:m,contentsObj:v}=w;m&&(v!=null&&v.str)&&!g.has(y)&&!c(this,Gl).has(y)&&x.push(w)}(p=c(this,qn))==null||p.showSidebar(x)}if(!t){s&&this.addNewEditorFromKeyboard(),c(this,Ar).resolve();return}for(const g of c(this,Ei).values())g.uid===t?(this.setSelected(g),a?g.editComment():r?g.enterInEditMode():g.focus()):g.unselect();c(this,Ar).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==c(this,Yi)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){if(c(this,Sr)){switch(e){case Tt.CREATE:this.currentLayer.addNewEditor(t);return;case Tt.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(c(this,l0)||_(this,l0,new Map)).set(e,t),this.showAllEditors("highlight",t);break}if(this.hasSelection)for(const i of c(this,Vt))i.updateParams(e,t);else for(const i of c(this,Sr))i.updateDefaultParams(e,t)}}showAllEditors(e,t,i=!1){var r;for(const a of c(this,Ei).values())a.editorType===e&&a.show(t);(((r=c(this,l0))==null?void 0:r.get(Tt.HIGHLIGHT_SHOW_ALL))??!0)!==t&&R(this,Ue,fo).call(this,[[Tt.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(c(this,a0)!==e){_(this,a0,e);for(const t of c(this,Fi).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}*getEditors(e){for(const t of c(this,Ei).values())t.pageIndex===e&&(yield t)}getEditor(e){return c(this,Ei).get(e)}addEditor(e){c(this,Ei).set(e.id,e)}removeEditor(e){var t,i;e.div.contains(document.activeElement)&&(c(this,Ea)&&clearTimeout(c(this,Ea)),_(this,Ea,setTimeout(()=>{this.focusMainContainer(),_(this,Ea,null)},0))),c(this,Ei).delete(e.id),e.annotationElementId&&((t=c(this,Zl))==null||t.delete(e.annotationElementId)),this.unselect(e),(!e.annotationElementId||!c(this,Gl).has(e.annotationElementId))&&((i=c(this,br))==null||i.remove(e.id))}addDeletedAnnotationElement(e){c(this,Gl).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return c(this,Gl).has(e)}removeDeletedAnnotationElement(e){c(this,Gl).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){c(this,Ls)!==e&&(_(this,Ls,e),e&&R(this,Ue,fo).call(this,e.propertiesToUpdate))}updateUI(e){c(this,Ue,cL)===e&&R(this,Ue,fo).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){R(this,Ue,fo).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(c(this,Vt).has(e)){c(this,Vt).delete(e),e.unselect(),R(this,Ue,Kn).call(this,{hasSelectedEditor:this.hasSelection});return}c(this,Vt).add(e),e.select(),R(this,Ue,fo).call(this,e.propertiesToUpdate),R(this,Ue,Kn).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;this.updateToolbar({mode:e.mode,editId:e.uid}),(t=c(this,Vl))==null||t.commitOrRemove();for(const i of c(this,Vt))i!==e&&i.unselect();c(this,Vt).clear(),c(this,Vt).add(e),e.select(),R(this,Ue,fo).call(this,e.propertiesToUpdate),R(this,Ue,Kn).call(this,{hasSelectedEditor:!0})}isSelected(e){return c(this,Vt).has(e)}get firstSelectedEditor(){return c(this,Vt).values().next().value}unselect(e){e.unselect(),c(this,Vt).delete(e),R(this,Ue,Kn).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return c(this,Vt).size!==0}get isEnterHandled(){return c(this,Vt).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;c(this,wr).undo(),R(this,Ue,Kn).call(this,{hasSomethingToUndo:c(this,wr).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:R(this,Ue,Hg).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){c(this,wr).redo(),R(this,Ue,Kn).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:c(this,wr).hasSomethingToRedo(),isEmpty:R(this,Ue,Hg).call(this)})}addCommands(e){c(this,wr).add(e),R(this,Ue,Kn).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:R(this,Ue,Hg).call(this)})}cleanUndoStack(e){c(this,wr).cleanType(e)}delete(){var r;this.commitOrRemove();const e=(r=this.currentLayer)==null?void 0:r.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...c(this,Vt)],i=()=>{var a;(a=this._editorUndoBar)==null||a.show(s,t.length===1?t[0].editorType:t.length);for(const o of t)o.remove()},s=()=>{for(const a of t)R(this,Ue,pA).call(this,a)};this.addCommands({cmd:i,undo:s,mustExec:!0})}commitOrRemove(){var e;(e=c(this,Ls))==null||e.commitOrRemove()}hasSomethingToControl(){return c(this,Ls)||this.hasSelection}selectAll(){for(const e of c(this,Vt))e.commit();R(this,Ue,gA).call(this,c(this,Ei).values())}unselectAll(){var e;if(!(c(this,Ls)&&(c(this,Ls).commitOrRemove(),c(this,Yi)!==ft.NONE))&&!((e=c(this,Vl))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of c(this,Vt))t.unselect();c(this,Vt).clear(),R(this,Ue,Kn).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;c(this,ec)[0]+=e,c(this,ec)[1]+=t;const[s,r]=c(this,ec),a=[...c(this,Vt)],o=1e3;c(this,_a)&&clearTimeout(c(this,_a)),_(this,_a,setTimeout(()=>{_(this,_a,null),c(this,ec)[0]=c(this,ec)[1]=0,this.addCommands({cmd:()=>{for(const l of a)c(this,Ei).has(l.id)&&(l.translateInPage(s,r),l.translationDone())},undo:()=>{for(const l of a)c(this,Ei).has(l.id)&&(l.translateInPage(-s,-r),l.translationDone())},mustExec:!1})},o));for(const l of a)l.translateInPage(e,t),l.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),_(this,Aa,new Map);for(const e of c(this,Vt))c(this,Aa).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!c(this,Aa))return!1;this.disableUserSelect(!1);const e=c(this,Aa);_(this,Aa,null);let t=!1;for(const[{x:s,y:r,pageIndex:a},o]of e)o.newX=s,o.newY=r,o.newPageIndex=a,t||(t=s!==o.savedX||r!==o.savedY||a!==o.savedPageIndex);if(!t)return!1;const i=(s,r,a,o)=>{if(c(this,Ei).has(s.id)){const l=c(this,Fi).get(o);l?s._setParentAndPosition(l,r,a):(s.pageIndex=o,s.x=r,s.y=a)}};return this.addCommands({cmd:()=>{for(const[s,{newX:r,newY:a,newPageIndex:o}]of e)i(s,r,a,o)},undo:()=>{for(const[s,{savedX:r,savedY:a,savedPageIndex:o}]of e)i(s,r,a,o)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(c(this,Aa))for(const i of c(this,Aa).keys())i.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||c(this,Vt).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return c(this,Ls)===e}getActive(){return c(this,Ls)}getMode(){return c(this,Yi)}isEditingMode(){return c(this,Yi)!==ft.NONE}get imageManager(){return ut(this,"imageManager",new uA)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let u=0,d=t.rangeCount;u<d;u++)if(!e.contains(t.getRangeAt(u).commonAncestorContainer))return null;const{x:i,y:s,width:r,height:a}=e.getBoundingClientRect();let o;switch(e.getAttribute("data-main-rotation")){case"90":o=(u,d,f,p)=>({x:(d-s)/a,y:1-(u+f-i)/r,width:p/a,height:f/r});break;case"180":o=(u,d,f,p)=>({x:1-(u+f-i)/r,y:1-(d+p-s)/a,width:f/r,height:p/a});break;case"270":o=(u,d,f,p)=>({x:1-(d+p-s)/a,y:(u-i)/r,width:p/a,height:f/r});break;default:o=(u,d,f,p)=>({x:(u-i)/r,y:(d-s)/a,width:f/r,height:p/a});break}const l=[];for(let u=0,d=t.rangeCount;u<d;u++){const f=t.getRangeAt(u);if(!f.collapsed)for(const{x:p,y:g,width:x,height:w}of f.getClientRects())x===0||w===0||l.push(o(p,g,x,w))}return l.length===0?null:l}addChangedExistingAnnotation({annotationElementId:e,id:t}){(c(this,bf)||_(this,bf,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=c(this,bf))==null||t.delete(e)}renderAnnotationElement(e){var s;const t=(s=c(this,bf))==null?void 0:s.get(e.data.id);if(!t)return;const i=c(this,br).getRawValue(t);i&&(c(this,Yi)===ft.NONE&&!i.hasBeenModified||i.renderAnnotationElement(e))}setMissingCanvas(e,t,i){var r;const s=(r=c(this,Zl))==null?void 0:r.get(e);s&&(s.setCanvas(t,i),c(this,Zl).delete(e))}addMissingCanvas(e,t){(c(this,Zl)||_(this,Zl,new Map)).set(e,t)}};yf=new WeakMap,Ls=new WeakMap,vf=new WeakMap,Ei=new WeakMap,Fi=new WeakMap,xf=new WeakMap,br=new WeakMap,bf=new WeakMap,wr=new WeakMap,qn=new WeakMap,ql=new WeakMap,Vl=new WeakMap,wf=new WeakMap,Gl=new WeakMap,Aa=new WeakMap,Sr=new WeakMap,_u=new WeakMap,n0=new WeakMap,s0=new WeakMap,Sf=new WeakMap,r0=new WeakMap,Ea=new WeakMap,Yl=new WeakMap,Af=new WeakMap,Wl=new WeakMap,Ca=new WeakMap,u1=new WeakMap,Xl=new WeakMap,Ef=new WeakMap,a0=new WeakMap,Kl=new WeakMap,Nu=new WeakMap,Cf=new WeakMap,Zl=new WeakMap,o0=new WeakMap,Yi=new WeakMap,Vt=new WeakMap,bo=new WeakMap,Ql=new WeakMap,Jl=new WeakMap,l0=new WeakMap,_f=new WeakMap,c0=new WeakMap,ec=new WeakMap,_a=new WeakMap,wo=new WeakMap,u0=new WeakMap,h0=new WeakMap,Ar=new WeakMap,Ue=new WeakSet,bx=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},dA=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const i of c(this,Fi).values())if(i.hasTextLayer(e))return i;return null},Q4=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const i=R(this,Ue,bx).call(this,e).closest(".textLayer"),s=this.getSelectionBoxes(i);s&&(c(this,Ca)||_(this,Ca,new lV(this)),c(this,Ca).show(i,s,this.direction==="ltr"))},J4=function(){var r,a,o;const e=document.getSelection();if(!e||e.isCollapsed){c(this,bo)&&((r=c(this,Ca))==null||r.hide(),_(this,bo,null),R(this,Ue,Kn).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===c(this,bo))return;const s=R(this,Ue,bx).call(this,e).closest(".textLayer");if(!s){c(this,bo)&&((a=c(this,Ca))==null||a.hide(),_(this,bo,null),R(this,Ue,Kn).call(this,{hasSelectedText:!1}));return}if((o=c(this,Ca))==null||o.hide(),_(this,bo,t),R(this,Ue,Kn).call(this,{hasSelectedText:!0}),!(c(this,Yi)!==ft.HIGHLIGHT&&c(this,Yi)!==ft.NONE)&&(c(this,Yi)===ft.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),_(this,Wl,this.isShiftKeyDown),!this.isShiftKeyDown)){const l=c(this,Yi)===ft.HIGHLIGHT?R(this,Ue,dA).call(this,s):null;if(l==null||l.toggleDrawing(),c(this,Ef)){const u=new AbortController,d=this.combinedSignal(u),f=p=>{p.type==="pointerup"&&p.button!==0||(u.abort(),l==null||l.toggleDrawing(!0),p.type==="pointerup"&&R(this,Ue,Ug).call(this,"main_toolbar"))};window.addEventListener("pointerup",f,{signal:d}),window.addEventListener("blur",f,{signal:d})}else l==null||l.toggleDrawing(!0),R(this,Ue,Ug).call(this,"main_toolbar")}},Ug=function(e=""){c(this,Yi)===ft.HIGHLIGHT?this.highlightSelection(e):c(this,n0)&&R(this,Ue,Q4).call(this)},eL=function(){document.addEventListener("selectionchange",R(this,Ue,J4).bind(this),{signal:this._signal})},tL=function(){if(c(this,Yl))return;_(this,Yl,new AbortController);const e=this.combinedSignal(c(this,Yl));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},iL=function(){var e;(e=c(this,Yl))==null||e.abort(),_(this,Yl,null)},fA=function(){if(c(this,Kl))return;_(this,Kl,new AbortController);const e=this.combinedSignal(c(this,Kl));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},nL=function(){var e;(e=c(this,Kl))==null||e.abort(),_(this,Kl,null)},sL=function(){if(c(this,ql))return;_(this,ql,new AbortController);const e=this.combinedSignal(c(this,ql));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},rL=function(){var e;(e=c(this,ql))==null||e.abort(),_(this,ql,null)},aL=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},Kn=function(e){Object.entries(e).some(([i,s])=>c(this,c0)[i]!==s)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(c(this,c0),e)}),c(this,Yi)===ft.HIGHLIGHT&&e.hasSelectedEditor===!1&&R(this,Ue,fo).call(this,[[Tt.HIGHLIGHT_FREE,!0]]))},fo=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},oL=async function(){if(!c(this,Xl)){_(this,Xl,!0);const e=[];for(const t of c(this,Fi).values())e.push(t.enable());await Promise.all(e);for(const t of c(this,Ei).values())t.enable()}},lL=function(){if(this.unselectAll(),c(this,Xl)){_(this,Xl,!1);for(const e of c(this,Fi).values())e.disable();for(const e of c(this,Ei).values())e.disable()}},pA=function(e){const t=c(this,Fi).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},cL=function(){let e=null;for(e of c(this,Vt));return e},Hg=function(){if(c(this,Ei).size===0)return!0;if(c(this,Ei).size===1)for(const e of c(this,Ei).values())return e.isEmpty();return!1},gA=function(e){for(const t of c(this,Vt))t.unselect();c(this,Vt).clear();for(const t of e)t.isEmpty()||(c(this,Vt).add(t),t.select());R(this,Ue,Kn).call(this,{hasSelectedEditor:this.hasSelection})},fe(Zd,"TRANSLATE_SMALL",1),fe(Zd,"TRANSLATE_BIG",10);let Gh=Zd;var hn,Na,ta,Nf,ka,Ms,kf,Ta,fs,So,ku,Da,tc,ga,$g,wx;const Zn=class Zn{constructor(e){T(this,ga);T(this,hn,null);T(this,Na,!1);T(this,ta,null);T(this,Nf,null);T(this,ka,null);T(this,Ms,null);T(this,kf,!1);T(this,Ta,null);T(this,fs,null);T(this,So,null);T(this,ku,null);T(this,Da,!1);_(this,fs,e),_(this,Da,e._uiManager.useNewAltTextFlow),c(Zn,tc)||_(Zn,tc,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){Zn._l10n??(Zn._l10n=e)}async render(){const e=_(this,ta,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=_(this,Nf,document.createElement("span"));e.append(t),c(this,Da)?(e.classList.add("new"),e.setAttribute("data-l10n-id",c(Zn,tc).missing),t.setAttribute("data-l10n-id",c(Zn,tc)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const i=c(this,fs)._uiManager._signal;e.addEventListener("contextmenu",Gr,{signal:i}),e.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:i});const s=r=>{r.preventDefault(),c(this,fs)._uiManager.editAltText(c(this,fs)),c(this,Da)&&c(this,fs)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:c(this,ga,$g)}})};return e.addEventListener("click",s,{capture:!0,signal:i}),e.addEventListener("keydown",r=>{r.target===e&&r.key==="Enter"&&(_(this,kf,!0),s(r))},{signal:i}),await R(this,ga,wx).call(this),e}finish(){c(this,ta)&&(c(this,ta).focus({focusVisible:c(this,kf)}),_(this,kf,!1))}isEmpty(){return c(this,Da)?c(this,hn)===null:!c(this,hn)&&!c(this,Na)}hasData(){return c(this,Da)?c(this,hn)!==null||!!c(this,So):this.isEmpty()}get guessedText(){return c(this,So)}async setGuessedText(e){c(this,hn)===null&&(_(this,So,e),_(this,ku,await Zn._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),R(this,ga,wx).call(this))}toggleAltTextBadge(e=!1){var t;if(!c(this,Da)||c(this,hn)){(t=c(this,Ta))==null||t.remove(),_(this,Ta,null);return}if(!c(this,Ta)){const i=_(this,Ta,document.createElement("div"));i.className="noAltTextBadge",c(this,fs).div.append(i)}c(this,Ta).classList.toggle("hidden",!e)}serialize(e){let t=c(this,hn);return!e&&c(this,So)===t&&(t=c(this,ku)),{altText:t,decorative:c(this,Na),guessedText:c(this,So),textWithDisclaimer:c(this,ku)}}get data(){return{altText:c(this,hn),decorative:c(this,Na)}}set data({altText:e,decorative:t,guessedText:i,textWithDisclaimer:s,cancel:r=!1}){i&&(_(this,So,i),_(this,ku,s)),!(c(this,hn)===e&&c(this,Na)===t)&&(r||(_(this,hn,e),_(this,Na,t)),R(this,ga,wx).call(this))}toggle(e=!1){c(this,ta)&&(!e&&c(this,Ms)&&(clearTimeout(c(this,Ms)),_(this,Ms,null)),c(this,ta).disabled=!e)}shown(){c(this,fs)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:c(this,ga,$g)}})}destroy(){var e,t;(e=c(this,ta))==null||e.remove(),_(this,ta,null),_(this,Nf,null),_(this,ka,null),(t=c(this,Ta))==null||t.remove(),_(this,Ta,null)}};hn=new WeakMap,Na=new WeakMap,ta=new WeakMap,Nf=new WeakMap,ka=new WeakMap,Ms=new WeakMap,kf=new WeakMap,Ta=new WeakMap,fs=new WeakMap,So=new WeakMap,ku=new WeakMap,Da=new WeakMap,tc=new WeakMap,ga=new WeakSet,$g=function(){return c(this,hn)&&"added"||c(this,hn)===null&&this.guessedText&&"review"||"missing"},wx=async function(){var s,r,a;const e=c(this,ta);if(!e)return;if(c(this,Da)){if(e.classList.toggle("done",!!c(this,hn)),e.setAttribute("data-l10n-id",c(Zn,tc)[c(this,ga,$g)]),(s=c(this,Nf))==null||s.setAttribute("data-l10n-id",c(Zn,tc)[`${c(this,ga,$g)}-label`]),!c(this,hn)){(r=c(this,ka))==null||r.remove();return}}else{if(!c(this,hn)&&!c(this,Na)){e.classList.remove("done"),(a=c(this,ka))==null||a.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=c(this,ka);if(!t){_(this,ka,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${c(this,fs).id}`;const o=100,l=c(this,fs)._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(c(this,Ms)),_(this,Ms,null)},{once:!0}),e.addEventListener("mouseenter",()=>{_(this,Ms,setTimeout(()=>{_(this,Ms,null),c(this,ka).classList.add("show"),c(this,fs)._reportTelemetry({action:"alt_text_tooltip"})},o))},{signal:l}),e.addEventListener("mouseleave",()=>{var u;c(this,Ms)&&(clearTimeout(c(this,Ms)),_(this,Ms,null)),(u=c(this,ka))==null||u.classList.remove("show")},{signal:l})}c(this,Na)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=c(this,hn)),t.parentNode||e.append(t);const i=c(this,fs).getElementForAltText();i==null||i.setAttribute("aria-describedby",t.id)},T(Zn,tc,null),fe(Zn,"_l10n",null);let Xb=Zn;var En,Er,Tu,ui,d0,ic,Cr,nc,sc,Du,f0,mA;class Hv{constructor(e){T(this,f0);T(this,En,null);T(this,Er,null);T(this,Tu,!1);T(this,ui,null);T(this,d0,null);T(this,ic,null);T(this,Cr,null);T(this,nc,null);T(this,sc,!1);T(this,Du,null);_(this,ui,e)}renderForToolbar(){const e=_(this,Er,document.createElement("button"));return e.className="comment",R(this,f0,mA).call(this,e,!1)}renderForStandalone(){const e=_(this,En,document.createElement("button"));e.className="annotationCommentButton";const t=c(this,ui).commentButtonPosition;if(t){const{style:i}=e;i.insetInlineEnd=`calc(${100*(c(this,ui)._uiManager.direction==="ltr"?1-t[0]:t[0])}% - var(--comment-button-dim))`,i.top=`calc(${100*t[1]}% - var(--comment-button-dim))`;const s=c(this,ui).commentButtonColor;s&&(i.backgroundColor=s)}return R(this,f0,mA).call(this,e,!0)}focusButton(){setTimeout(()=>{var e;(e=c(this,En)??c(this,Er))==null||e.focus()},0)}onUpdatedColor(){if(!c(this,En))return;const e=c(this,ui).commentButtonColor;e&&(c(this,En).style.backgroundColor=e),c(this,ui)._uiManager.updatePopupColor(c(this,ui))}get commentButtonWidth(){var e;return(((e=c(this,En))==null?void 0:e.getBoundingClientRect().width)??0)/c(this,ui).parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(c(this,Du))return c(this,Du);if(!c(this,En))return null;const{x:e,y:t,height:i}=c(this,En).getBoundingClientRect(),{x:s,y:r,width:a,height:o}=c(this,ui).parent.boundingClientRect;return[(e-s)/a,(t+i-r)/o]}set commentPopupPositionInLayer(e){_(this,Du,e)}hasDefaultPopupPosition(){return c(this,Du)===null}removeStandaloneCommentButton(){var e;(e=c(this,En))==null||e.remove(),_(this,En,null)}removeToolbarCommentButton(){var e;(e=c(this,Er))==null||e.remove(),_(this,Er,null)}setCommentButtonStates({selected:e,hasPopup:t}){c(this,En)&&(c(this,En).classList.toggle("selected",e),c(this,En).ariaExpanded=t)}edit(e){const t=this.commentPopupPositionInLayer;let i,s;if(t)[i,s]=t;else{[i,s]=c(this,ui).commentButtonPosition;const{width:d,height:f,x:p,y:g}=c(this,ui);i=p+i*d,s=g+s*f}const r=c(this,ui).parent.boundingClientRect,{x:a,y:o,width:l,height:u}=r;c(this,ui)._uiManager.editComment(c(this,ui),a+i*l,o+s*u,{...e,parentDimensions:r})}finish(){c(this,Er)&&(c(this,Er).focus({focusVisible:c(this,Tu)}),_(this,Tu,!1))}isDeleted(){return c(this,sc)||c(this,Cr)===""}isEmpty(){return c(this,Cr)===null}hasBeenEdited(){return this.isDeleted()||c(this,Cr)!==c(this,d0)}serialize(){return this.data}get data(){return{text:c(this,Cr),richText:c(this,ic),date:c(this,nc),deleted:this.isDeleted()}}set data(e){if(e!==c(this,Cr)&&_(this,ic,null),e===null){_(this,Cr,""),_(this,sc,!0);return}_(this,Cr,e),_(this,nc,new Date),_(this,sc,!1)}restoreData({text:e,richText:t,date:i}){_(this,Cr,e),_(this,ic,t),_(this,nc,i),_(this,sc,!1)}setInitialText(e,t=null){_(this,d0,e),this.data=e,_(this,nc,null),_(this,ic,t)}shown(){}destroy(){var e,t;(e=c(this,Er))==null||e.remove(),_(this,Er,null),(t=c(this,En))==null||t.remove(),_(this,En,null),_(this,Cr,""),_(this,ic,null),_(this,nc,null),_(this,ui,null),_(this,Tu,!1),_(this,sc,!1)}}En=new WeakMap,Er=new WeakMap,Tu=new WeakMap,ui=new WeakMap,d0=new WeakMap,ic=new WeakMap,Cr=new WeakMap,nc=new WeakMap,sc=new WeakMap,Du=new WeakMap,f0=new WeakSet,mA=function(e,t){if(!c(this,ui)._uiManager.hasCommentManager())return null;e.tabIndex="0",e.ariaHasPopup="dialog",t?(e.ariaControls="commentPopup",e.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(e.ariaControlsElements=[c(this,ui)._uiManager.getCommentDialogElement()],e.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const i=c(this,ui)._uiManager._signal;if(!(i instanceof AbortSignal)||i.aborted)return e;e.addEventListener("contextmenu",Gr,{signal:i}),t&&(e.addEventListener("focusin",r=>{c(this,ui)._focusEventsAllowed=!1,Mi(r)},{capture:!0,signal:i}),e.addEventListener("focusout",r=>{c(this,ui)._focusEventsAllowed=!0,Mi(r)},{capture:!0,signal:i})),e.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:i});const s=r=>{r.preventDefault(),e===c(this,Er)?this.edit():c(this,ui).toggleComment(!0)};return e.addEventListener("click",s,{capture:!0,signal:i}),e.addEventListener("keydown",r=>{r.target===e&&r.key==="Enter"&&(_(this,Tu,!0),s(r))},{signal:i}),e.addEventListener("pointerenter",()=>{c(this,ui).toggleComment(!1,!0)},{signal:i}),e.addEventListener("pointerleave",()=>{c(this,ui).toggleComment(!1,!1)},{signal:i}),e};var Tf,ju,p0,g0,m0,y0,v0,Ao,Ru,Eo,Lu,Co,iu,uL,hL,dL;const S_=class S_{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:i=null,onPinchStart:s=null,onPinching:r=null,onPinchEnd:a=null,signal:o}){T(this,iu);T(this,Tf);T(this,ju,!1);T(this,p0,null);T(this,g0);T(this,m0);T(this,y0);T(this,v0);T(this,Ao,null);T(this,Ru);T(this,Eo,null);T(this,Lu);T(this,Co,null);_(this,Tf,e),_(this,p0,i),_(this,g0,t),_(this,m0,s),_(this,y0,r),_(this,v0,a),_(this,Lu,new AbortController),_(this,Ru,AbortSignal.any([o,c(this,Lu).signal])),e.addEventListener("touchstart",R(this,iu,uL).bind(this),{passive:!1,signal:c(this,Ru)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/eo.pixelRatio}destroy(){var e,t;(e=c(this,Lu))==null||e.abort(),_(this,Lu,null),(t=c(this,Ao))==null||t.abort(),_(this,Ao,null)}};Tf=new WeakMap,ju=new WeakMap,p0=new WeakMap,g0=new WeakMap,m0=new WeakMap,y0=new WeakMap,v0=new WeakMap,Ao=new WeakMap,Ru=new WeakMap,Eo=new WeakMap,Lu=new WeakMap,Co=new WeakMap,iu=new WeakSet,uL=function(e){var s,r,a;if((s=c(this,g0))!=null&&s.call(this))return;if(e.touches.length===1){if(c(this,Ao))return;const o=_(this,Ao,new AbortController),l=AbortSignal.any([c(this,Ru),o.signal]),u=c(this,Tf),d={capture:!0,signal:l,passive:!1},f=p=>{var g;p.pointerType==="touch"&&((g=c(this,Ao))==null||g.abort(),_(this,Ao,null))};u.addEventListener("pointerdown",p=>{p.pointerType==="touch"&&(Mi(p),f(p))},d),u.addEventListener("pointerup",f,d),u.addEventListener("pointercancel",f,d);return}if(!c(this,Co)){_(this,Co,new AbortController);const o=AbortSignal.any([c(this,Ru),c(this,Co).signal]),l=c(this,Tf),u={signal:o,capture:!1,passive:!1};l.addEventListener("touchmove",R(this,iu,hL).bind(this),u);const d=R(this,iu,dL).bind(this);l.addEventListener("touchend",d,u),l.addEventListener("touchcancel",d,u),u.capture=!0,l.addEventListener("pointerdown",Mi,u),l.addEventListener("pointermove",Mi,u),l.addEventListener("pointercancel",Mi,u),l.addEventListener("pointerup",Mi,u),(r=c(this,m0))==null||r.call(this)}if(Mi(e),e.touches.length!==2||(a=c(this,p0))!=null&&a.call(this)){_(this,Eo,null);return}let[t,i]=e.touches;t.identifier>i.identifier&&([t,i]=[i,t]),_(this,Eo,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:i.screenX,touch1Y:i.screenY})},hL=function(e){var A;if(!c(this,Eo)||e.touches.length!==2)return;Mi(e);let[t,i]=e.touches;t.identifier>i.identifier&&([t,i]=[i,t]);const{screenX:s,screenY:r}=t,{screenX:a,screenY:o}=i,l=c(this,Eo),{touch0X:u,touch0Y:d,touch1X:f,touch1Y:p}=l,g=f-u,x=p-d,w=a-s,y=o-r,m=Math.hypot(w,y)||1,v=Math.hypot(g,x)||1;if(!c(this,ju)&&Math.abs(v-m)<=S_.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(l.touch0X=s,l.touch0Y=r,l.touch1X=a,l.touch1Y=o,!c(this,ju)){_(this,ju,!0);return}const b=[(s+a)/2,(r+o)/2];(A=c(this,y0))==null||A.call(this,b,v,m)},dL=function(e){var t;e.touches.length>=2||(c(this,Co)&&(c(this,Co).abort(),_(this,Co,null),(t=c(this,v0))==null||t.call(this)),c(this,Eo)&&(Mi(e),_(this,Eo,null),_(this,ju,!1)))};let Kb=S_;var Mu,ia,bi,Gt,_o,Df,rc,x0,Cn,Ou,No,_r,ac,b0,Iu,Os,w0,Pu,ko,ja,jf,Rf,Nr,Bu,S0,h1,at,yA,A0,vA,Sx,fL,pL,xA,Ax,bA,gL,mL,yL,wA,vL,SA,xL,bL,wL,AA,qg;const dt=class dt{constructor(e){T(this,at);T(this,Mu,null);T(this,ia,null);T(this,bi,null);T(this,Gt,null);T(this,_o,null);T(this,Df,!1);T(this,rc,null);T(this,x0,"");T(this,Cn,null);T(this,Ou,null);T(this,No,null);T(this,_r,null);T(this,ac,null);T(this,b0,"");T(this,Iu,!1);T(this,Os,null);T(this,w0,!1);T(this,Pu,!1);T(this,ko,!1);T(this,ja,null);T(this,jf,0);T(this,Rf,0);T(this,Nr,null);T(this,Bu,null);fe(this,"isSelected",!1);fe(this,"_isCopy",!1);fe(this,"_editToolbar",null);fe(this,"_initialOptions",Object.create(null));fe(this,"_initialData",null);fe(this,"_isVisible",!0);fe(this,"_uiManager",null);fe(this,"_focusEventsAllowed",!0);T(this,S0,!1);T(this,h1,dt._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null,this.creationDate=e.creationDate||new Date,this.modificationDate=e.modificationDate||null,this.canAddComment=!0;const{rotation:t,rawDims:{pageWidth:i,pageHeight:s,pageX:r,pageY:a}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,s],this.pageTranslation=[r,a];const[o,l]=this.parentDimensions;this.x=e.x/o,this.y=e.y/l,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=dt.prototype._resizeWithKeyboard,t=Gh.TRANSLATE_SMALL,i=Gh.TRANSLATE_BIG;return ut(this,"_resizerKeyboardManager",new yv([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,i]}],[["Escape","mac+Escape"],dt.prototype._stopResizingWithKeyboard]]))}updatePageIndex(e){this.pageIndex=e}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return ut(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new hV({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(dt._l10n??(dt._l10n=e),dt._l10nResizer||(dt._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),dt._borderLineWidth!==-1)return;const i=getComputedStyle(document.documentElement);dt._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){zt("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return c(this,S0)}set _isDraggable(e){var t;_(this,S0,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=c(this,h1)}setParent(e){var t;e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):(R(this,at,qg).call(this),(t=c(this,_r))==null||t.remove(),_(this,_r,null)),this.parent=e}focusin(e){this._focusEventsAllowed&&(c(this,Iu)?_(this,Iu,!1):this.parent.setSelected(this))}focusout(e){var i;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(i=this.parent)!=null&&i.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,i,s){const[r,a]=this.parentDimensions;[i,s]=this.screenToPageTranslation(i,s),this.x=(e+i)/r,this.y=(t+s)/a,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[i,s]=this.parentDimensions;this.setAt(e*i,t*s,this.width*i,this.height*s),this._onTranslated()}translate(e,t){R(this,at,yA).call(this,this.parentDimensions,e,t)}translateInPage(e,t){c(this,Os)||_(this,Os,[this.x,this.y,this.width,this.height]),R(this,at,yA).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){c(this,Os)||_(this,Os,[this.x,this.y,this.width,this.height]);const{div:i,parentDimensions:[s,r]}=this;if(this.x+=e/s,this.y+=t/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:f,y:p}=this.div.getBoundingClientRect();this.parent.findNewParent(this,f,p)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:o}=this;const[l,u]=this.getBaseTranslation();a+=l,o+=u;const{style:d}=i;d.left=`${(100*a).toFixed(2)}%`,d.top=`${(100*o).toFixed(2)}%`,this._onTranslating(a,o),i.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!c(this,Os)&&(c(this,Os)[0]!==this.x||c(this,Os)[1]!==this.y)}get _hasBeenResized(){return!!c(this,Os)&&(c(this,Os)[2]!==this.width||c(this,Os)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:i}=dt,s=i/e,r=i/t;switch(this.rotation){case 90:return[-s,r];case 180:return[s,r];case 270:return[s,-r];default:return[-s,-r]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[i,s]}=this;let{x:r,y:a,width:o,height:l}=this;if(o*=i,l*=s,r*=i,a*=s,this._mustFixPosition)switch(e){case 0:r=Dn(r,0,i-o),a=Dn(a,0,s-l);break;case 90:r=Dn(r,0,i-l),a=Dn(a,o,s);break;case 180:r=Dn(r,o,i),a=Dn(a,l,s);break;case 270:r=Dn(r,l,i),a=Dn(a,0,s-o);break}this.x=r/=i,this.y=a/=s;const[u,d]=this.getBaseTranslation();r+=u,a+=d,t.left=`${(100*r).toFixed(2)}%`,t.top=`${(100*a).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var i;return R(i=dt,A0,vA).call(i,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var i;return R(i=dt,A0,vA).call(i,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,i]}=this;return[t*e,i*e]}setDims(){const{div:{style:e},width:t,height:i}=this;e.width=`${(100*t).toFixed(2)}%`,e.height=`${(100*i).toFixed(2)}%`}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=c(this,bi))==null||e.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||c(this,Pu))return this._editToolbar;this._editToolbar=new lA(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[t,i]of e)await this._editToolbar.addButton(t,i);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){var e;(e=this._editToolbar)==null||e.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){var e;(e=this._editToolbar)==null||e.removeButton("comment")}removeEditToolbar(){var e,t;(e=this._editToolbar)==null||e.remove(),this._editToolbar=null,(t=c(this,bi))==null||t.destroy()}addContainer(e){var i;const t=(i=this._editToolbar)==null?void 0:i.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return c(this,bi)||(Xb.initialize(dt._l10n),_(this,bi,new Xb(this)),c(this,Mu)&&(c(this,bi).data=c(this,Mu),_(this,Mu,null))),c(this,bi)}get altTextData(){var e;return(e=c(this,bi))==null?void 0:e.data}set altTextData(e){c(this,bi)&&(c(this,bi).data=e)}get guessedAltText(){var e;return(e=c(this,bi))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=c(this,bi))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=c(this,bi))==null?void 0:t.serialize(e)}hasAltText(){return!!c(this,bi)&&!c(this,bi).isEmpty()}hasAltTextData(){var e;return((e=c(this,bi))==null?void 0:e.hasData())??!1}focusCommentButton(){var e;(e=c(this,Gt))==null||e.focusButton()}addCommentButton(){return this.canAddComment?c(this,Gt)||_(this,Gt,new Hv(this)):null}addStandaloneCommentButton(){if(this._uiManager.hasCommentManager()){if(c(this,_o)){this._uiManager.isEditingMode()&&c(this,_o).classList.remove("hidden");return}this.hasComment&&(_(this,_o,c(this,Gt).renderForStandalone()),this.div.append(c(this,_o)))}}removeStandaloneCommentButton(){c(this,Gt).removeStandaloneCommentButton(),_(this,_o,null)}hideStandaloneCommentButton(){var e;(e=c(this,_o))==null||e.classList.add("hidden")}get comment(){if(!c(this,Gt))return null;const{data:{richText:e,text:t,date:i,deleted:s}}=c(this,Gt);return{text:t,richText:e,date:i,deleted:s,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(e){c(this,Gt)||_(this,Gt,new Hv(this)),typeof e=="object"&&e!==null?c(this,Gt).restoreData(e):c(this,Gt).data=e,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:e,popupRef:t,richText:i}){if(!t||(c(this,Gt)||_(this,Gt,new Hv(this)),c(this,Gt).setInitialText(e,i),!this.annotationElementId))return;const s=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);s&&this.updateFromAnnotationLayer(s)}get hasEditedComment(){var e;return(e=c(this,Gt))==null?void 0:e.hasBeenEdited()}get hasDeletedComment(){var e;return(e=c(this,Gt))==null?void 0:e.isDeleted()}get hasComment(){return!!c(this,Gt)&&!c(this,Gt).isEmpty()&&!c(this,Gt).isDeleted()}async editComment(e){c(this,Gt)||_(this,Gt,new Hv(this)),c(this,Gt).edit(e)}toggleComment(e,t=void 0){this.hasComment&&this._uiManager.toggleComment(this,e,t)}setSelectedCommentButton(e){c(this,Gt).setSelectedButton(e)}addComment(e){if(this.hasEditedComment){const[,,,s]=e.rect,[r]=this.pageDimensions,[a]=this.pageTranslation,o=a+r+1,l=s-100,u=o+180;e.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[o,l,u,s]}}}updateFromAnnotationLayer({popup:{contents:e,deleted:t}}){c(this,Gt).data=t?null:e}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){var a;const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=c(this,Df)?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),R(this,at,SA).call(this);const[t,i]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*i/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/i).toFixed(2)}%`);const[s,r]=this.getInitialTranslation();return this.translate(s,r),K4(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(c(this,Bu)||_(this,Bu,new Kb({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:R(this,at,gL).bind(this),onPinching:R(this,at,mL).bind(this),onPinchEnd:R(this,at,yL).bind(this),signal:this._uiManager._signal}))),this.addStandaloneCommentButton(),(a=this._uiManager._editorUndoBar)==null||a.hide(),e}pointerdown(e){const{isMac:t}=on.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(_(this,Iu,!0),this._isDraggable){R(this,at,vL).call(this,e);return}R(this,at,wA).call(this,e)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){c(this,ja)&&clearTimeout(c(this,ja)),_(this,ja,setTimeout(()=>{var e;_(this,ja,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,i){e.changeParent(this),this.x=t,this.y=i,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,i=this.rotation){const s=this.parentScale,[r,a]=this.pageDimensions,[o,l]=this.pageTranslation,u=e/s,d=t/s,f=this.x*r,p=this.y*a,g=this.width*r,x=this.height*a;switch(i){case 0:return[f+u+o,a-p-d-x+l,f+u+g+o,a-p-d+l];case 90:return[f+d+o,a-p+u+l,f+d+x+o,a-p+u+g+l];case 180:return[f-u-g+o,a-p+d+l,f-u+o,a-p+d+x+l];case 270:return[f-d-x+o,a-p-u-g+l,f-d+o,a-p-u+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[i,s,r,a]=e,o=r-i,l=a-s;switch(this.rotation){case 0:return[i,t-a,o,l];case 90:return[i,t-s,l,o];case 180:return[r,t-s,o,l];case 270:return[r,t-a,l,o];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&dt._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){var e;(e=c(this,Gt))==null||e.onUpdatedColor()}getData(){const{comment:{text:e,color:t,date:i,opacity:s,deleted:r,richText:a},uid:o,pageIndex:l,creationDate:u,modificationDate:d}=this;return{id:o,pageIndex:l,rect:this.getPDFRect(),richText:a,contentsObj:{str:e},creationDate:u,modificationDate:i||d,popupRef:!r,color:t,opacity:s}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),_(this,Pu,!0),!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),_(this,Pu,!1),!0):!1}isInEditMode(){return c(this,Pu)}shouldGetKeyboardEvents(){return c(this,ko)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:i,right:s}=this.getClientDimensions(),{innerHeight:r,innerWidth:a}=window;return t<a&&s>0&&e<r&&i>0}rebuild(){R(this,at,SA).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){var i;return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:((i=this._initialData)==null?void 0:i.popupRef)||""}}static async deserialize(e,t,i){const s=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:i,annotationElementId:e.annotationElementId,creationDate:e.creationDate,modificationDate:e.modificationDate});s.rotation=e.rotation,_(s,Mu,e.accessibilityData),s._isCopy=e.isCopy||!1;const[r,a]=s.pageDimensions,[o,l,u,d]=s.getRectInCurrentCoords(e.rect,a);return s.x=o/r,s.y=l/a,s.width=u/r,s.height=d/a,s}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t,i;if((e=c(this,ac))==null||e.abort(),_(this,ac,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),c(this,ja)&&(clearTimeout(c(this,ja)),_(this,ja,null)),R(this,at,qg).call(this),this.removeEditToolbar(),c(this,Nr)){for(const s of c(this,Nr).values())clearTimeout(s);_(this,Nr,null)}this.parent=null,(t=c(this,Bu))==null||t.destroy(),_(this,Bu,null),(i=c(this,_r))==null||i.remove(),_(this,_r,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(R(this,at,fL).call(this),c(this,Cn).classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[e,t]}=this,[i,s,r,a]=this.getPDFRect();return[dt._round(i+(r-i)*e),dt._round(s+(a-s)*(1-t))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return c(this,Gt).commentPopupPositionInLayer}set commentPopupPosition(e){c(this,Gt).commentPopupPositionInLayer=e}hasDefaultPopupPosition(){return c(this,Gt).hasDefaultPopupPosition()}get commentButtonWidth(){return c(this,Gt).commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(e){var t;(t=c(this,Gt))==null||t.setCommentButtonStates(e)}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),_(this,No,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=c(this,Cn).children;if(!c(this,ia)){_(this,ia,Array.from(t));const a=R(this,at,xL).bind(this),o=R(this,at,bL).bind(this),l=this._uiManager._signal;for(const u of c(this,ia)){const d=u.getAttribute("data-resizer-name");u.setAttribute("role","spinbutton"),u.addEventListener("keydown",a,{signal:l}),u.addEventListener("blur",o,{signal:l}),u.addEventListener("focus",R(this,at,wL).bind(this,d),{signal:l}),u.setAttribute("data-l10n-id",dt._l10nResizer[d])}}const i=c(this,ia)[0];let s=0;for(const a of t){if(a===i)break;s++}const r=(360-this.rotation+this.parentRotation)%360/90*(c(this,ia).length/4);if(r!==s){if(r<s)for(let o=0;o<s-r;o++)c(this,Cn).append(c(this,Cn).firstElementChild);else if(r>s)for(let o=0;o<r-s;o++)c(this,Cn).firstElementChild.before(c(this,Cn).lastElementChild);let a=0;for(const o of t){const u=c(this,ia)[a++].getAttribute("data-resizer-name");o.setAttribute("data-l10n-id",dt._l10nResizer[u])}}R(this,at,AA).call(this,0),_(this,ko,!0),c(this,Cn).firstElementChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){c(this,ko)&&R(this,at,bA).call(this,c(this,b0),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){R(this,at,qg).call(this),this.div.focus()}select(){var e,t,i;if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var s,r;(s=this.div)!=null&&s.classList.contains("selectedEditor")&&((r=this._editToolbar)==null||r.show())});return}(t=this._editToolbar)==null||t.show(),(i=c(this,bi))==null||i.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>{var e;return(e=this.div)==null?void 0:e.focus({preventScroll:!0})},0)}unselect(){var e,t,i,s,r;this.isSelected&&(this.isSelected=!1,(e=c(this,Cn))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(i=this.div)!=null&&i.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(s=this._editToolbar)==null||s.hide(),(r=c(this,bi))==null||r.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){e.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return c(this,w0)}set isEditing(e){_(this,w0,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){c(this,Nr)||_(this,Nr,new Map);const{action:i}=e;let s=c(this,Nr).get(i);s&&clearTimeout(s),s=setTimeout(()=>{this._reportTelemetry(e),c(this,Nr).delete(i),c(this,Nr).size===0&&_(this,Nr,null)},dt._telemetryTimeout),c(this,Nr).set(i,s);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),_(this,Df,!1)}disable(){this.div&&(this.div.tabIndex=-1),_(this,Df,!0)}updateFakeAnnotationElement(e){if(!c(this,_r)&&!this.deleted){_(this,_r,e.addFakeAnnotation(this));return}if(this.deleted){c(this,_r).remove(),_(this,_r,null);return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&c(this,_r).updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const i=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),i.before(t)}return t}resetAnnotationElement(e){const{firstElementChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};Mu=new WeakMap,ia=new WeakMap,bi=new WeakMap,Gt=new WeakMap,_o=new WeakMap,Df=new WeakMap,rc=new WeakMap,x0=new WeakMap,Cn=new WeakMap,Ou=new WeakMap,No=new WeakMap,_r=new WeakMap,ac=new WeakMap,b0=new WeakMap,Iu=new WeakMap,Os=new WeakMap,w0=new WeakMap,Pu=new WeakMap,ko=new WeakMap,ja=new WeakMap,jf=new WeakMap,Rf=new WeakMap,Nr=new WeakMap,Bu=new WeakMap,S0=new WeakMap,h1=new WeakMap,at=new WeakSet,yA=function([e,t],i,s){[i,s]=this.screenToPageTranslation(i,s),this.x+=i/e,this.y+=s/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},A0=new WeakSet,vA=function(e,t,i){switch(i){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},Sx=function(e){switch(e){case 90:{const[t,i]=this.pageDimensions;return[0,-t/i,i/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,i]=this.pageDimensions;return[0,t/i,-i/t,0]}default:return[1,0,0,1]}},fL=function(){if(c(this,Cn))return;_(this,Cn,document.createElement("div")),c(this,Cn).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const i of e){const s=document.createElement("div");c(this,Cn).append(s),s.classList.add("resizer",i),s.setAttribute("data-resizer-name",i),s.addEventListener("pointerdown",R(this,at,pL).bind(this,i),{signal:t}),s.addEventListener("contextmenu",Gr,{signal:t}),s.tabIndex=-1}this.div.prepend(c(this,Cn))},pL=function(e,t){var d;t.preventDefault();const{isMac:i}=on.platform;if(t.button!==0||t.ctrlKey&&i)return;(d=c(this,bi))==null||d.toggle(!1);const s=this._isDraggable;this._isDraggable=!1,_(this,Ou,[t.screenX,t.screenY]);const r=new AbortController,a=this._uiManager.combinedSignal(r);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",R(this,at,bA).bind(this,e),{passive:!0,capture:!0,signal:a}),window.addEventListener("touchmove",Mi,{passive:!1,signal:a}),window.addEventListener("contextmenu",Gr,{signal:a}),_(this,No,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const o=this.parent.div.style.cursor,l=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const u=()=>{var f;r.abort(),this.parent.togglePointerEvents(!0),(f=c(this,bi))==null||f.toggle(!0),this._isDraggable=s,this.parent.div.style.cursor=o,this.div.style.cursor=l,R(this,at,Ax).call(this)};window.addEventListener("pointerup",u,{signal:a}),window.addEventListener("blur",u,{signal:a})},xA=function(e,t,i,s){this.width=i,this.height=s,this.x=e,this.y=t,this.setDims(),this.fixAndSetPosition(),this._onResized()},Ax=function(){if(!c(this,No))return;const{savedX:e,savedY:t,savedWidth:i,savedHeight:s}=c(this,No);_(this,No,null);const r=this.x,a=this.y,o=this.width,l=this.height;r===e&&a===t&&o===i&&l===s||this.addCommands({cmd:R(this,at,xA).bind(this,r,a,o,l),undo:R(this,at,xA).bind(this,e,t,i,s),mustExec:!0})},bA=function(e,t){const[i,s]=this.parentDimensions,r=this.x,a=this.y,o=this.width,l=this.height,u=dt.MIN_SIZE/i,d=dt.MIN_SIZE/s,f=R(this,at,Sx).call(this,this.rotation),p=(F,M)=>[f[0]*F+f[2]*M,f[1]*F+f[3]*M],g=R(this,at,Sx).call(this,360-this.rotation),x=(F,M)=>[g[0]*F+g[2]*M,g[1]*F+g[3]*M];let w,y,m=!1,v=!1;switch(e){case"topLeft":m=!0,w=(F,M)=>[0,0],y=(F,M)=>[F,M];break;case"topMiddle":w=(F,M)=>[F/2,0],y=(F,M)=>[F/2,M];break;case"topRight":m=!0,w=(F,M)=>[F,0],y=(F,M)=>[0,M];break;case"middleRight":v=!0,w=(F,M)=>[F,M/2],y=(F,M)=>[0,M/2];break;case"bottomRight":m=!0,w=(F,M)=>[F,M],y=(F,M)=>[0,0];break;case"bottomMiddle":w=(F,M)=>[F/2,M],y=(F,M)=>[F/2,0];break;case"bottomLeft":m=!0,w=(F,M)=>[0,M],y=(F,M)=>[F,0];break;case"middleLeft":v=!0,w=(F,M)=>[0,M/2],y=(F,M)=>[F,M/2];break}const b=w(o,l),A=y(o,l);let S=p(...A);const C=dt._round(r+S[0]),k=dt._round(a+S[1]);let L=1,D=1,j,P;if(t.fromKeyboard)({deltaX:j,deltaY:P}=t);else{const{screenX:F,screenY:M}=t,[I,V]=c(this,Ou);[j,P]=this.screenToPageTranslation(F-I,M-V),c(this,Ou)[0]=F,c(this,Ou)[1]=M}if([j,P]=x(j/i,P/s),m){const F=Math.hypot(o,l);L=D=Math.max(Math.min(Math.hypot(A[0]-b[0]-j,A[1]-b[1]-P)/F,1/o,1/l),u/o,d/l)}else v?L=Dn(Math.abs(A[0]-b[0]-j),u,1)/o:D=Dn(Math.abs(A[1]-b[1]-P),d,1)/l;const H=dt._round(o*L),G=dt._round(l*D);S=p(...y(H,G));const $=C-S[0],Y=k-S[1];c(this,Os)||_(this,Os,[this.x,this.y,this.width,this.height]),this.width=H,this.height=G,this.x=$,this.y=Y,this.setDims(),this.fixAndSetPosition(),this._onResizing()},gL=function(){var e;_(this,No,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=c(this,bi))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},mL=function(e,t,i){let r=.7*(i/t)+1-.7;if(r===1)return;const a=R(this,at,Sx).call(this,this.rotation),o=(C,k)=>[a[0]*C+a[2]*k,a[1]*C+a[3]*k],[l,u]=this.parentDimensions,d=this.x,f=this.y,p=this.width,g=this.height,x=dt.MIN_SIZE/l,w=dt.MIN_SIZE/u;r=Math.max(Math.min(r,1/p,1/g),x/p,w/g);const y=dt._round(p*r),m=dt._round(g*r);if(y===p&&m===g)return;c(this,Os)||_(this,Os,[d,f,p,g]);const v=o(p/2,g/2),b=dt._round(d+v[0]),A=dt._round(f+v[1]),S=o(y/2,m/2);this.x=b-S[0],this.y=A-S[1],this.width=y,this.height=m,this.setDims(),this.fixAndSetPosition(),this._onResizing()},yL=function(){var e;(e=c(this,bi))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),R(this,at,Ax).call(this)},wA=function(e){const{isMac:t}=on.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},vL=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let i=!1;const s=new AbortController,r=this._uiManager.combinedSignal(s),a={capture:!0,passive:!1,signal:r},o=u=>{s.abort(),_(this,rc,null),_(this,Iu,!1),this._uiManager.endDragSession()||R(this,at,wA).call(this,u),i&&this._onStopDragging()};t&&(_(this,jf,e.clientX),_(this,Rf,e.clientY),_(this,rc,e.pointerId),_(this,x0,e.pointerType),window.addEventListener("pointermove",u=>{i||(i=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:d,clientY:f,pointerId:p}=u;if(p!==c(this,rc)){Mi(u);return}const[g,x]=this.screenToPageTranslation(d-c(this,jf),f-c(this,Rf));_(this,jf,d),_(this,Rf,f),this._uiManager.dragSelectedEditors(g,x)},a),window.addEventListener("touchmove",Mi,a),window.addEventListener("pointerdown",u=>{u.pointerType===c(this,x0)&&(c(this,Bu)||u.isPrimary)&&o(u),Mi(u)},a));const l=u=>{if(!c(this,rc)||c(this,rc)===u.pointerId){o(u);return}Mi(u)};window.addEventListener("pointerup",l,{signal:r}),window.addEventListener("blur",l,{signal:r})},SA=function(){if(c(this,ac)||!this.div)return;_(this,ac,new AbortController);const e=this._uiManager.combinedSignal(c(this,ac));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},xL=function(e){dt._resizerKeyboardManager.exec(this,e)},bL=function(e){var t;c(this,ko)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==c(this,Cn)&&R(this,at,qg).call(this)},wL=function(e){_(this,b0,c(this,ko)?e:"")},AA=function(e){if(c(this,ia))for(const t of c(this,ia))t.tabIndex=e},qg=function(){_(this,ko,!1),R(this,at,AA).call(this,-1),R(this,at,Ax).call(this)},T(dt,A0),fe(dt,"_l10n",null),fe(dt,"_l10nResizer",null),fe(dt,"_borderLineWidth",-1),fe(dt,"_colorManager",new hA),fe(dt,"_zIndex",1),fe(dt,"_telemetryTimeout",1e3);let hi=dt;class hV extends hi{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const UT=3285377520,mr=4294901760,wa=65535;class SL{constructor(e){this.h1=e?e&4294967295:UT,this.h2=e?e&4294967295:UT}update(e){let t,i;if(typeof e=="string"){t=new Uint8Array(e.length*2),i=0;for(let w=0,y=e.length;w<y;w++){const m=e.charCodeAt(w);m<=255?t[i++]=m:(t[i++]=m>>>8,t[i++]=m&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),i=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const s=i>>2,r=i-s*4,a=new Uint32Array(t.buffer,0,s);let o=0,l=0,u=this.h1,d=this.h2;const f=3432918353,p=461845907,g=f&wa,x=p&wa;for(let w=0;w<s;w++)w&1?(o=a[w],o=o*f&mr|o*g&wa,o=o<<15|o>>>17,o=o*p&mr|o*x&wa,u^=o,u=u<<13|u>>>19,u=u*5+3864292196):(l=a[w],l=l*f&mr|l*g&wa,l=l<<15|l>>>17,l=l*p&mr|l*x&wa,d^=l,d=d<<13|d>>>19,d=d*5+3864292196);switch(o=0,r){case 3:o^=t[s*4+2]<<16;case 2:o^=t[s*4+1]<<8;case 1:o^=t[s*4],o=o*f&mr|o*g&wa,o=o<<15|o>>>17,o=o*p&mr|o*x&wa,s&1?u^=o:d^=o}this.h1=u,this.h2=d}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&mr|e*36045&wa,t=t*4283543511&mr|((t<<16|e>>>16)*2950163797&mr)>>>16,e^=t>>>1,e=e*444984403&mr|e*60499&wa,t=t*3301882366&mr|((t<<16|e>>>16)*3120437893&mr)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const EA=Object.freeze({map:null,hash:"",transfer:void 0});var Fu,zu,To,_n,d1,AL;class f_{constructor(){T(this,d1);T(this,Fu,!1);T(this,zu,null);T(this,To,null);T(this,_n,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const i=c(this,_n).get(e);return i===void 0?t:Object.assign(t,i)}getRawValue(e){return c(this,_n).get(e)}remove(e){const t=c(this,_n).get(e);if(t!==void 0&&(t instanceof hi&&c(this,To).delete(t.annotationElementId),c(this,_n).delete(e),c(this,_n).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const i of c(this,_n).values())if(i instanceof hi)return;this.onAnnotationEditor(null)}}setValue(e,t){const i=c(this,_n).get(e);let s=!1;if(i!==void 0)for(const[r,a]of Object.entries(t))i[r]!==a&&(s=!0,i[r]=a);else s=!0,c(this,_n).set(e,t);s&&R(this,d1,AL).call(this),t instanceof hi&&((c(this,To)||_(this,To,new Map)).set(t.annotationElementId,t),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type))}has(e){return c(this,_n).has(e)}get size(){return c(this,_n).size}resetModified(){c(this,Fu)&&(_(this,Fu,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new EL(this)}get serializable(){if(c(this,_n).size===0)return EA;const e=new Map,t=new SL,i=[],s=Object.create(null);let r=!1;for(const[a,o]of c(this,_n)){const l=o instanceof hi?o.serialize(!1,s):o;o.page&&(o.pageIndex=o.page._pageIndex,delete o.page),l&&(e.set(a,l),t.update(`${a}:${JSON.stringify(l)}`),r||(r=!!l.bitmap))}if(r)for(const a of e.values())a.bitmap&&i.push(a.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:i}:EA}get editorStats(){let e=null;const t=new Map;let i=0,s=0;for(const r of c(this,_n).values()){if(!(r instanceof hi)){r.popup&&(r.popup.deleted?s+=1:i+=1);continue}r.isCommentDeleted?s+=1:r.hasEditedComment&&(i+=1);const a=r.telemetryFinalData;if(!a)continue;const{type:o}=a;t.has(o)||t.set(o,Object.getPrototypeOf(r).constructor),e||(e=Object.create(null));const l=e[o]||(e[o]=new Map);for(const[u,d]of Object.entries(a)){if(u==="type")continue;let f=l.get(u);f||(f=new Map,l.set(u,f));const p=f.get(d)??0;f.set(d,p+1)}}if((s>0||i>0)&&(e||(e=Object.create(null)),e.comments={deleted:s,edited:i}),!e)return null;for(const[r,a]of t)e[r]=a.computeTelemetryFinalData(e[r]);return e}resetModifiedIds(){_(this,zu,null)}updateEditor(e,t){var s;const i=(s=c(this,To))==null?void 0:s.get(e);return i?(i.updateFromAnnotationLayer(t),!0):!1}getEditor(e){var t;return((t=c(this,To))==null?void 0:t.get(e))||null}get modifiedIds(){if(c(this,zu))return c(this,zu);const e=[];if(c(this,To))for(const t of c(this,To).values())t.serialize()&&e.push(t.annotationElementId);return _(this,zu,{ids:new Set(e),hash:e.join(",")})}[Symbol.iterator](){return c(this,_n).entries()}}Fu=new WeakMap,zu=new WeakMap,To=new WeakMap,_n=new WeakMap,d1=new WeakSet,AL=function(){c(this,Fu)||(_(this,Fu,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var E0;class EL extends f_{constructor(t){super();T(this,E0);const{map:i,hash:s,transfer:r}=t.serializable,a=structuredClone(i,r?{transfer:r}:null);_(this,E0,{map:a,hash:s,transfer:r})}get print(){zt("Should not call PrintAnnotationStorage.print")}get serializable(){return c(this,E0)}get modifiedIds(){return ut(this,"modifiedIds",{ids:new Set,hash:""})}}E0=new WeakMap;var Lf;class dV{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){T(this,Lf,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),c(this,Lf).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:i}){if(!(!e||c(this,Lf).has(e.loadedName))){if(Bt(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:s,src:r,style:a}=e,o=new FontFace(s,r,a);this.addNativeFontFace(o);try{await o.load(),c(this,Lf).add(s),i==null||i(e)}catch{ct(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(o)}return}zt("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const i=e.createNativeFontFace();if(i){this.addNativeFontFace(i);try{await i.loaded}catch(s){throw ct(`Failed to load font '${i.family}': '${s}'.`),e.disableFontFace=!0,s}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(i=>{const s=this._queueLoadingCallback(i);this._prepareFontLoadEvent(e,s)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return ut(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return ut(this,"isSyncFontLoadingSupported",is||on.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(Bt(!s.done,"completeRequest() cannot be called twice."),s.done=!0;i.length>0&&i[0].done;){const r=i.shift();setTimeout(r.callback,0)}}const{loadingRequests:i}=this,s={done:!1,complete:t,callback:e};return i.push(s),s}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return ut(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function i(A,S){return A.charCodeAt(S)<<24|A.charCodeAt(S+1)<<16|A.charCodeAt(S+2)<<8|A.charCodeAt(S+3)&255}function s(A,S,C,k){const L=A.substring(0,S),D=A.substring(S+C);return L+k+D}let r,a;const o=this._document.createElement("canvas");o.width=1,o.height=1;const l=o.getContext("2d");let u=0;function d(A,S){if(++u>30){ct("Load test font never loaded."),S();return}if(l.font="30px "+A,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){S();return}setTimeout(d.bind(null,A,S))}const f=`lt${Date.now()}${this.loadTestFontId++}`;let p=this._loadTestFont;p=s(p,976,f.length,f);const x=16,w=1482184792;let y=i(p,x);for(r=0,a=f.length-3;r<a;r+=4)y=y-w+i(f,r)|0;r<f.length&&(y=y-w+i(f+"XXX",r)|0),p=s(p,x,4,Yq(y));const m=`url(data:font/opentype;base64,${btoa(p)});`,v=`@font-face {font-family:"${f}";src:${m}}`;this.insertRule(v);const b=this._document.createElement("div");b.style.visibility="hidden",b.style.width=b.style.height="10px",b.style.position="absolute",b.style.top=b.style.left="0px";for(const A of[e.loadedName,f]){const S=this._document.createElement("span");S.textContent="Hi",S.style.fontFamily=A,b.append(S)}this._document.body.append(b),d(f,()=>{b.remove(),t.complete()})}}Lf=new WeakMap;var Qt;class fV{constructor(e,t=null,i,s){T(this,Qt);this.compiledGlyphs=Object.create(null),_(this,Qt,e),this._inspectFont=t,i&&Object.assign(this,i),s&&(this.charProcOperatorList=s)}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const i={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(i.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,i)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var i;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${this.data.toBase64()});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let s=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(s+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${s}src:${e}}`}return(i=this._inspectFont)==null||i.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const i=this.loadedName+"_path_"+t;let s;try{s=e.get(i)}catch(a){ct(`getPathGenerator - ignoring character: "${a}".`)}const r=H4(s==null?void 0:s.path);return this.fontExtraProperties||e.delete(i),this.compiledGlyphs[t]=r}get black(){return c(this,Qt).black}get bold(){return c(this,Qt).bold}get disableFontFace(){return c(this,Qt).disableFontFace??!1}set disableFontFace(e){ut(this,"disableFontFace",!!e)}get fontExtraProperties(){return c(this,Qt).fontExtraProperties??!1}get isInvalidPDFjsFont(){return c(this,Qt).isInvalidPDFjsFont}get isType3Font(){return c(this,Qt).isType3Font}get italic(){return c(this,Qt).italic}get missingFile(){return c(this,Qt).missingFile}get remeasure(){return c(this,Qt).remeasure}get vertical(){return c(this,Qt).vertical}get ascent(){return c(this,Qt).ascent}get defaultWidth(){return c(this,Qt).defaultWidth}get descent(){return c(this,Qt).descent}get bbox(){return c(this,Qt).bbox}set bbox(e){ut(this,"bbox",e)}get fontMatrix(){return c(this,Qt).fontMatrix}get fallbackName(){return c(this,Qt).fallbackName}get loadedName(){return c(this,Qt).loadedName}get mimetype(){return c(this,Qt).mimetype}get name(){return c(this,Qt).name}get data(){return c(this,Qt).data}clearData(){c(this,Qt).clearData()}get cssFontInfo(){return c(this,Qt).cssFontInfo}get systemFontInfo(){return c(this,Qt).systemFontInfo}get defaultVMetrics(){return c(this,Qt).defaultVMetrics}}Qt=new WeakMap;var Mf,Of,C0,If,Ex;const Qd=class Qd{constructor(e){T(this,If);T(this,Mf);T(this,Of);T(this,C0);_(this,Mf,e),_(this,Of,new DataView(c(this,Mf))),_(this,C0,new TextDecoder)}static write(e){const t=new TextEncoder,i={};let s=0;for(const u of Qd.strings){const d=t.encode(e[u]);i[u]=d,s+=4+d.length}const r=new ArrayBuffer(s),a=new Uint8Array(r),o=new DataView(r);let l=0;for(const u of Qd.strings){const d=i[u],f=d.length;o.setUint32(l,f),a.set(d,l+4),l+=4+f}return Bt(l===r.byteLength,"CssFontInfo.write: Buffer overflow"),r}get fontFamily(){return R(this,If,Ex).call(this,0)}get fontWeight(){return R(this,If,Ex).call(this,1)}get italicAngle(){return R(this,If,Ex).call(this,2)}};Mf=new WeakMap,Of=new WeakMap,C0=new WeakMap,If=new WeakSet,Ex=function(e){Bt(e<Qd.strings.length,"Invalid string index");let t=0;for(let s=0;s<e;s++)t+=c(this,Of).getUint32(t)+4;const i=c(this,Of).getUint32(t);return c(this,C0).decode(new Uint8Array(c(this,Mf),t+4,i))},fe(Qd,"strings",["fontFamily","fontWeight","italicAngle"]);let Zb=Qd;var oc,Ra,Uu,Hu,Vg;const Jd=class Jd{constructor(e){T(this,Hu);T(this,oc);T(this,Ra);T(this,Uu);_(this,oc,e),_(this,Ra,new DataView(c(this,oc))),_(this,Uu,new TextDecoder)}static write(e){const t=new TextEncoder,i={};let s=0;for(const p of Jd.strings){const g=t.encode(e[p]);i[p]=g,s+=4+g.length}s+=4;let r,a,o=1+s;e.style&&(r=t.encode(e.style.style),a=t.encode(e.style.weight),o+=4+r.length+4+a.length);const l=new ArrayBuffer(o),u=new Uint8Array(l),d=new DataView(l);let f=0;d.setUint8(f++,e.guessFallback?1:0),d.setUint32(f,0),f+=4,s=0;for(const p of Jd.strings){const g=i[p],x=g.length;s+=4+x,d.setUint32(f,x),u.set(g,f+4),f+=4+x}return d.setUint32(f-s-4,s),e.style&&(d.setUint32(f,r.length),u.set(r,f+4),f+=4+r.length,d.setUint32(f,a.length),u.set(a,f+4),f+=4+a.length),Bt(f<=l.byteLength,"SubstitionInfo.write: Buffer overflow"),l.transferToFixedLength(f)}get guessFallback(){return c(this,Ra).getUint8(0)!==0}get css(){return R(this,Hu,Vg).call(this,0)}get loadedName(){return R(this,Hu,Vg).call(this,1)}get baseFontName(){return R(this,Hu,Vg).call(this,2)}get src(){return R(this,Hu,Vg).call(this,3)}get style(){let e=1;e+=4+c(this,Ra).getUint32(e);const t=c(this,Ra).getUint32(e),i=c(this,Uu).decode(new Uint8Array(c(this,oc),e+4,t));e+=4+t;const s=c(this,Ra).getUint32(e),r=c(this,Uu).decode(new Uint8Array(c(this,oc),e+4,s));return{style:i,weight:r}}};oc=new WeakMap,Ra=new WeakMap,Uu=new WeakMap,Hu=new WeakSet,Vg=function(e){Bt(e<Jd.strings.length,"Invalid string index");let t=5;for(let s=0;s<e;s++)t+=c(this,Ra).getUint32(t)+4;const i=c(this,Ra).getUint32(t);return c(this,Uu).decode(new Uint8Array(c(this,oc),t+4,i))},fe(Jd,"strings",["css","loadedName","baseFontName","src"]);let Qb=Jd;var Pf,Bf,Ff,zf,Is,La,_0,Jt,Ri,Zr,Cx,Gg;const gt=class gt{constructor({data:e,extra:t}){T(this,Ri);T(this,La);T(this,_0);T(this,Jt);_(this,La,e),_(this,_0,new TextDecoder),_(this,Jt,new DataView(c(this,La))),t&&Object.assign(this,t)}get black(){return R(this,Ri,Zr).call(this,0)}get bold(){return R(this,Ri,Zr).call(this,1)}get disableFontFace(){return R(this,Ri,Zr).call(this,2)}get fontExtraProperties(){return R(this,Ri,Zr).call(this,3)}get isInvalidPDFjsFont(){return R(this,Ri,Zr).call(this,4)}get isType3Font(){return R(this,Ri,Zr).call(this,5)}get italic(){return R(this,Ri,Zr).call(this,6)}get missingFile(){return R(this,Ri,Zr).call(this,7)}get remeasure(){return R(this,Ri,Zr).call(this,8)}get vertical(){return R(this,Ri,Zr).call(this,9)}get ascent(){return R(this,Ri,Cx).call(this,0)}get defaultWidth(){return R(this,Ri,Cx).call(this,1)}get descent(){return R(this,Ri,Cx).call(this,2)}get bbox(){let e=c(gt,Bf);if(c(this,Jt).getUint8(e)===0)return;e+=1;const i=[];for(let s=0;s<4;s++)i.push(c(this,Jt).getInt16(e,!0)),e+=2;return i}get fontMatrix(){let e=c(gt,Ff);if(c(this,Jt).getUint8(e)===0)return;e+=1;const i=[];for(let s=0;s<6;s++)i.push(c(this,Jt).getFloat64(e,!0)),e+=8;return i}get defaultVMetrics(){let e=c(gt,zf);if(c(this,Jt).getUint8(e)===0)return;e+=1;const i=[];for(let s=0;s<3;s++)i.push(c(this,Jt).getInt16(e,!0)),e+=2;return i}get fallbackName(){return R(this,Ri,Gg).call(this,0)}get loadedName(){return R(this,Ri,Gg).call(this,1)}get mimetype(){return R(this,Ri,Gg).call(this,2)}get name(){return R(this,Ri,Gg).call(this,3)}get data(){let e=c(gt,Is);const t=c(this,Jt).getUint32(e);e+=4+t;const i=c(this,Jt).getUint32(e);e+=4+i;const s=c(this,Jt).getUint32(e);e+=4+s;const r=c(this,Jt).getUint32(e);if(r!==0)return new Uint8Array(c(this,La),e+4,r)}clearData(){let e=c(gt,Is);const t=c(this,Jt).getUint32(e);e+=4+t;const i=c(this,Jt).getUint32(e);e+=4+i;const s=c(this,Jt).getUint32(e);e+=4+s;const r=c(this,Jt).getUint32(e);new Uint8Array(c(this,La),e+4,r).fill(0),c(this,Jt).setUint32(e,0)}get cssFontInfo(){let e=c(gt,Is);const t=c(this,Jt).getUint32(e);e+=4+t;const i=c(this,Jt).getUint32(e);e+=4+i;const s=c(this,Jt).getUint32(e);if(s===0)return null;const r=new Uint8Array(s);return r.set(new Uint8Array(c(this,La),e+4,s)),new Zb(r.buffer)}get systemFontInfo(){let e=c(gt,Is);const t=c(this,Jt).getUint32(e);e+=4+t;const i=c(this,Jt).getUint32(e);if(i===0)return null;const s=new Uint8Array(i);return s.set(new Uint8Array(c(this,La),e+4,i)),new Qb(s.buffer)}static write(e){const t=e.systemFontInfo?Qb.write(e.systemFontInfo):null,i=e.cssFontInfo?Zb.write(e.cssFontInfo):null,s=new TextEncoder,r={};let a=0;for(const w of gt.strings)r[w]=s.encode(e[w]),a+=4+r[w].length;const o=c(gt,Is)+4+a+4+(t?t.byteLength:0)+4+(i?i.byteLength:0)+4+(e.data?e.data.length:0),l=new ArrayBuffer(o),u=new Uint8Array(l),d=new DataView(l);let f=0;const p=gt.bools.length;let g=0,x=0;for(let w=0;w<p;w++){const y=e[gt.bools[w]];g|=(y===void 0?0:y?2:1)<<x,x+=2,(x===8||w===p-1)&&(d.setUint8(f++,g),g=0,x=0)}Bt(f===c(gt,Pf),"FontInfo.write: Boolean properties offset mismatch");for(const w of gt.numbers)d.setFloat64(f,e[w]),f+=8;if(Bt(f===c(gt,Bf),"FontInfo.write: Number properties offset mismatch"),e.bbox){d.setUint8(f++,4);for(const w of e.bbox)d.setInt16(f,w,!0),f+=2}else d.setUint8(f++,0),f+=2*4;if(Bt(f===c(gt,Ff),"FontInfo.write: BBox properties offset mismatch"),e.fontMatrix){d.setUint8(f++,6);for(const w of e.fontMatrix)d.setFloat64(f,w,!0),f+=8}else d.setUint8(f++,0),f+=8*6;if(Bt(f===c(gt,zf),"FontInfo.write: FontMatrix properties offset mismatch"),e.defaultVMetrics){d.setUint8(f++,1);for(const w of e.defaultVMetrics)d.setInt16(f,w,!0),f+=2}else d.setUint8(f++,0),f+=3*2;Bt(f===c(gt,Is),"FontInfo.write: DefaultVMetrics properties offset mismatch"),d.setUint32(c(gt,Is),0),f+=4;for(const w of gt.strings){const y=r[w],m=y.length;d.setUint32(f,m),u.set(y,f+4),f+=4+m}if(d.setUint32(c(gt,Is),f-c(gt,Is)-4),!t)d.setUint32(f,0),f+=4;else{const w=t.byteLength;d.setUint32(f,w),Bt(f+4+w<=l.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),u.set(new Uint8Array(t),f+4),f+=4+w}if(!i)d.setUint32(f,0),f+=4;else{const w=i.byteLength;d.setUint32(f,w),Bt(f+4+w<=l.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),u.set(new Uint8Array(i),f+4),f+=4+w}return e.data===void 0?(d.setUint32(f,0),f+=4):(d.setUint32(f,e.data.length),u.set(e.data,f+4),f+=4+e.data.length),Bt(f<=l.byteLength,"FontInfo.write: Buffer overflow"),l.transferToFixedLength(f)}};Pf=new WeakMap,Bf=new WeakMap,Ff=new WeakMap,zf=new WeakMap,Is=new WeakMap,La=new WeakMap,_0=new WeakMap,Jt=new WeakMap,Ri=new WeakSet,Zr=function(e){Bt(e<gt.bools.length,"Invalid boolean index");const t=Math.floor(e/4),i=e*2%8,s=c(this,Jt).getUint8(t)>>i&3;return s===0?void 0:s===2},Cx=function(e){return Bt(e<gt.numbers.length,"Invalid number index"),c(this,Jt).getFloat64(c(gt,Pf)+e*8)},Gg=function(e){Bt(e<gt.strings.length,"Invalid string index");let t=c(gt,Is)+4;for(let r=0;r<e;r++)t+=c(this,Jt).getUint32(t)+4;const i=c(this,Jt).getUint32(t),s=new Uint8Array(i);return s.set(new Uint8Array(c(this,La),t+4,i)),c(this,_0).decode(s)},fe(gt,"bools",["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"]),fe(gt,"numbers",["ascent","defaultWidth","descent"]),fe(gt,"strings",["fallbackName","loadedName","mimetype","name"]),T(gt,Pf,Math.ceil(gt.bools.length*2/8)),T(gt,Bf,c(gt,Pf)+gt.numbers.length*8),T(gt,Ff,c(gt,Bf)+1+2*4),T(gt,zf,c(gt,Ff)+1+8*6),T(gt,Is,c(gt,zf)+1+2*3);let CA=gt;var N0,k0,T0,D0,j0,R0,L0,M0;const ci=class ci{constructor(e){this.buffer=e,this.view=new DataView(e),this.data=new Uint8Array(e)}static write(e){let t,i=null,s=[],r=[],a=[],o=[],l=null,u=null;switch(e[0]){case"RadialAxial":t=e[1]==="axial"?1:2,i=e[2],a=e[3],t===1?s.push(...e[4],...e[5]):s.push(e[4][0],e[4][1],e[6],e[5][0],e[5][1],e[7]);break;case"Mesh":t=3,l=e[1],s=e[2],r=e[3],o=e[4]||[],i=e[6],u=e[7];break;default:throw new Error(`Unsupported pattern type: ${e[0]}`)}const d=Math.floor(s.length/2),f=Math.floor(r.length/3),p=a.length,g=o.length;let x=0;for(const S of o)x+=1,x=Math.ceil(x/4)*4,x+=4+S.coords.length*4,x+=4+S.colors.length*4,S.verticesPerRow!==void 0&&(x+=4);const w=20+d*8+f*3+p*8+(i?16:0)+(u?3:0)+x,y=new ArrayBuffer(w),m=new DataView(y),v=new Uint8Array(y);m.setUint8(c(ci,N0),t),m.setUint8(c(ci,k0),i?1:0),m.setUint8(c(ci,T0),u?1:0),m.setUint8(c(ci,D0),l),m.setUint32(c(ci,j0),d,!0),m.setUint32(c(ci,R0),f,!0),m.setUint32(c(ci,L0),p,!0),m.setUint32(c(ci,M0),g,!0);let b=20;new Float32Array(y,b,d*2).set(s),b+=d*8,v.set(r,b),b+=f*3;for(const[S,C]of a)m.setFloat32(b,S,!0),b+=4,m.setUint32(b,parseInt(C.slice(1),16),!0),b+=4;if(i)for(const S of i)m.setFloat32(b,S,!0),b+=4;u&&(v.set(u,b),b+=3);for(let S=0;S<o.length;S++){const C=o[S];m.setUint8(b,C.type),b+=1,b=Math.ceil(b/4)*4,m.setUint32(b,C.coords.length,!0),b+=4,new Int32Array(y,b,C.coords.length).set(C.coords),b+=C.coords.length*4,m.setUint32(b,C.colors.length,!0),b+=4,new Int32Array(y,b,C.colors.length).set(C.colors),b+=C.colors.length*4,C.verticesPerRow!==void 0&&(m.setUint32(b,C.verticesPerRow,!0),b+=4)}return y}getIR(){const e=this.view,t=this.data[c(ci,N0)],i=!!this.data[c(ci,k0)],s=!!this.data[c(ci,T0)],r=e.getUint32(c(ci,j0),!0),a=e.getUint32(c(ci,R0),!0),o=e.getUint32(c(ci,L0),!0),l=e.getUint32(c(ci,M0),!0);let u=20;const d=new Float32Array(this.buffer,u,r*2);u+=r*8;const f=new Uint8Array(this.buffer,u,a*3);u+=a*3;const p=[];for(let y=0;y<o;++y){const m=e.getFloat32(u,!0);u+=4;const v=e.getUint32(u,!0);u+=4,p.push([m,`#${v.toString(16).padStart(6,"0")}`])}let g=null;if(i){g=[];for(let y=0;y<4;++y)g.push(e.getFloat32(u,!0)),u+=4}let x=null;s&&(x=new Uint8Array(this.buffer,u,3),u+=3);const w=[];for(let y=0;y<l;++y){const m=e.getUint8(u);u+=1,u=Math.ceil(u/4)*4;const v=e.getUint32(u,!0);u+=4;const b=new Int32Array(this.buffer,u,v);u+=v*4;const A=e.getUint32(u,!0);u+=4;const S=new Int32Array(this.buffer,u,A);u+=A*4;const C={type:m,coords:b,colors:S};m===nA.LATTICE&&(C.verticesPerRow=e.getUint32(u,!0),u+=4),w.push(C)}if(t===1)return["RadialAxial","axial",g,p,Array.from(d.slice(0,2)),Array.from(d.slice(2,4)),null,null];if(t===2)return["RadialAxial","radial",g,p,[d[0],d[1]],[d[3],d[4]],d[2],d[5]];if(t===3){const y=this.data[c(ci,D0)];let m=null;if(d.length>0){let v=d[0],b=d[0],A=d[1],S=d[1];for(let C=0;C<d.length;C+=2){const k=d[C],L=d[C+1];v=v>k?k:v,A=A>L?L:A,b=b<k?k:b,S=S<L?L:S}m=[v,A,b,S]}return["Mesh",y,d,f,w,m,g,x]}throw new Error(`Unsupported pattern kind: ${t}`)}};N0=new WeakMap,k0=new WeakMap,T0=new WeakMap,D0=new WeakMap,j0=new WeakMap,R0=new WeakMap,L0=new WeakMap,M0=new WeakMap,T(ci,N0,0),T(ci,k0,1),T(ci,T0,2),T(ci,D0,3),T(ci,j0,4),T(ci,R0,8),T(ci,L0,12),T(ci,M0,16);let _A=ci;var Uf;class pV{constructor(e){T(this,Uf);_(this,Uf,e)}static write(e){let t,i;return on.isFloat16ArraySupported?(i=new ArrayBuffer(e.length*2),t=new Float16Array(i)):(i=new ArrayBuffer(e.length*4),t=new Float32Array(i)),t.set(e),i}get path(){return on.isFloat16ArraySupported?new Float16Array(c(this,Uf)):new Float32Array(c(this,Uf))}}Uf=new WeakMap;function gV(n){if(n instanceof URL)return n.href;if(typeof n=="string"){if(is)return n;const e=URL.parse(n,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function mV(n){if(is&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return uw(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n==null?void 0:n.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function $v(n){if(typeof n!="string")return null;if(n.endsWith("/"))return n;throw new Error(`Invalid factory url: "${n}" must include trailing slash.`)}const NA=n=>typeof n=="object"&&Number.isInteger(n==null?void 0:n.num)&&n.num>=0&&Number.isInteger(n==null?void 0:n.gen)&&n.gen>=0,yV=n=>typeof n=="object"&&typeof(n==null?void 0:n.name)=="string",vV=Qq.bind(null,NA,yV);var Do,f1;class xV{constructor(){T(this,Do,new Map);T(this,f1,Promise.resolve())}postMessage(e,t){const i={data:structuredClone(e,t?{transfer:t}:null)};c(this,f1).then(()=>{for(const[s]of c(this,Do))s.call(this,i)})}addEventListener(e,t,i=null){let s=null;if((i==null?void 0:i.signal)instanceof AbortSignal){const{signal:r}=i;if(r.aborted){ct("LoopbackPort - cannot use an `aborted` signal.");return}const a=()=>this.removeEventListener(e,t);s=()=>r.removeEventListener("abort",a),r.addEventListener("abort",a)}c(this,Do).set(t,s)}removeEventListener(e,t){const i=c(this,Do).get(t);i==null||i(),c(this,Do).delete(t)}terminate(){for(const[,e]of c(this,Do))e==null||e();c(this,Do).clear()}}Do=new WeakMap,f1=new WeakMap;const qv={DATA:1,ERROR:2},Vi={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function HT(){}function hs(n){if(n instanceof eu||n instanceof sA||n instanceof MT||n instanceof Yb||n instanceof T2)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||zt('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new eu(n.message);case"InvalidPDFException":return new sA(n.message);case"PasswordException":return new MT(n.message,n.code);case"ResponseException":return new Yb(n.message,n.status,n.missing);case"UnknownErrorException":return new T2(n.message,n.details)}return new T2(n.message,n.toString())}var Hf,$r,CL,_L,NL,_x;class Yg{constructor(e,t,i){T(this,$r);T(this,Hf,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),i.addEventListener("message",R(this,$r,CL).bind(this),{signal:c(this,Hf).signal})}on(e,t){const i=this.actionHandler;if(i[e])throw new Error(`There is already an actionName called "${e}"`);i[e]=t}send(e,t,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},i)}sendWithPromise(e,t,i){const s=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[s]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:s,data:t},i)}catch(a){r.reject(a)}return r.promise}sendWithStream(e,t,i,s){const r=this.streamId++,a=this.sourceName,o=this.targetName,l=this.comObj;return new ReadableStream({start:u=>{const d=Promise.withResolvers();return this.streamControllers[r]={controller:u,startCall:d,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:a,targetName:o,action:e,streamId:r,data:t,desiredSize:u.desiredSize},s),d.promise},pull:u=>{const d=Promise.withResolvers();return this.streamControllers[r].pullCall=d,l.postMessage({sourceName:a,targetName:o,stream:Vi.PULL,streamId:r,desiredSize:u.desiredSize}),d.promise},cancel:u=>{Bt(u instanceof Error,"cancel must have a valid reason");const d=Promise.withResolvers();return this.streamControllers[r].cancelCall=d,this.streamControllers[r].isClosed=!0,l.postMessage({sourceName:a,targetName:o,stream:Vi.CANCEL,streamId:r,reason:hs(u)}),d.promise}},i)}destroy(){var e;(e=c(this,Hf))==null||e.abort(),_(this,Hf,null)}}Hf=new WeakMap,$r=new WeakSet,CL=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){R(this,$r,NL).call(this,e);return}if(e.callback){const i=e.callbackId,s=this.callbackCapabilities[i];if(!s)throw new Error(`Cannot resolve callback ${i}`);if(delete this.callbackCapabilities[i],e.callback===qv.DATA)s.resolve(e.data);else if(e.callback===qv.ERROR)s.reject(hs(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const i=this.sourceName,s=e.sourceName,r=this.comObj;Promise.try(t,e.data).then(function(a){r.postMessage({sourceName:i,targetName:s,callback:qv.DATA,callbackId:e.callbackId,data:a})},function(a){r.postMessage({sourceName:i,targetName:s,callback:qv.ERROR,callbackId:e.callbackId,reason:hs(a)})});return}if(e.streamId){R(this,$r,_L).call(this,e);return}t(e.data)},_L=function(e){const t=e.streamId,i=this.sourceName,s=e.sourceName,r=this.comObj,a=this,o=this.actionHandler[e.action],l={enqueue(u,d=1,f){if(this.isCancelled)return;const p=this.desiredSize;this.desiredSize-=d,p>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:i,targetName:s,stream:Vi.ENQUEUE,streamId:t,chunk:u},f)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:i,targetName:s,stream:Vi.CLOSE,streamId:t}),delete a.streamSinks[t])},error(u){Bt(u instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,r.postMessage({sourceName:i,targetName:s,stream:Vi.ERROR,streamId:t,reason:hs(u)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[t]=l,Promise.try(o,e.data,l).then(function(){r.postMessage({sourceName:i,targetName:s,stream:Vi.START_COMPLETE,streamId:t,success:!0})},function(u){r.postMessage({sourceName:i,targetName:s,stream:Vi.START_COMPLETE,streamId:t,reason:hs(u)})})},NL=function(e){const t=e.streamId,i=this.sourceName,s=e.sourceName,r=this.comObj,a=this.streamControllers[t],o=this.streamSinks[t];switch(e.stream){case Vi.START_COMPLETE:e.success?a.startCall.resolve():a.startCall.reject(hs(e.reason));break;case Vi.PULL_COMPLETE:e.success?a.pullCall.resolve():a.pullCall.reject(hs(e.reason));break;case Vi.PULL:if(!o){r.postMessage({sourceName:i,targetName:s,stream:Vi.PULL_COMPLETE,streamId:t,success:!0});break}o.desiredSize<=0&&e.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=e.desiredSize,Promise.try(o.onPull||HT).then(function(){r.postMessage({sourceName:i,targetName:s,stream:Vi.PULL_COMPLETE,streamId:t,success:!0})},function(u){r.postMessage({sourceName:i,targetName:s,stream:Vi.PULL_COMPLETE,streamId:t,reason:hs(u)})});break;case Vi.ENQUEUE:if(Bt(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(e.chunk);break;case Vi.CLOSE:if(Bt(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),R(this,$r,_x).call(this,a,t);break;case Vi.ERROR:Bt(a,"error should have stream controller"),a.controller.error(hs(e.reason)),R(this,$r,_x).call(this,a,t);break;case Vi.CANCEL_COMPLETE:e.success?a.cancelCall.resolve():a.cancelCall.reject(hs(e.reason)),R(this,$r,_x).call(this,a,t);break;case Vi.CANCEL:if(!o)break;const l=hs(e.reason);Promise.try(o.onCancel||HT,l).then(function(){r.postMessage({sourceName:i,targetName:s,stream:Vi.CANCEL_COMPLETE,streamId:t,success:!0})},function(u){r.postMessage({sourceName:i,targetName:s,stream:Vi.CANCEL_COMPLETE,streamId:t,reason:hs(u)})}),o.sinkCapability.reject(l),o.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},_x=async function(e,t){var i,s,r;await Promise.allSettled([(i=e.startCall)==null?void 0:i.promise,(s=e.pullCall)==null?void 0:s.promise,(r=e.cancelCall)==null?void 0:r.promise]),delete this.streamControllers[t]};var O0;class kL{constructor({enableHWA:e=!1}){T(this,O0,!1);_(this,O0,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(e,t);return{canvas:i,context:i.getContext("2d",{willReadFrequently:!c(this,O0)})}}reset(e,t,i){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||i<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=i}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){zt("Abstract method `_createCanvas` called.")}}O0=new WeakMap;class bV extends kL{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const i=this._document.createElement("canvas");return i.width=e,i.height=t,i}}class TL{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(i=>({cMapData:i,isCompressed:this.isCompressed})).catch(i=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){zt("Abstract method `_fetch` called.")}}class $T extends TL{async _fetch(e){const t=await pv(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):uw(t)}}class DL{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,i,s,r){return"none"}destroy(e=!1){}}var $u,$f,jo,Ro,Vn,qu,Vu,Xe,Un,Wg,Dd,Nx,jd,jL,kA,Rd,Xg,Kg,TA,Zg;class wV extends DL{constructor({docId:t,ownerDocument:i=globalThis.document}){super();T(this,Xe);T(this,$u);T(this,$f);T(this,jo);T(this,Ro);T(this,Vn);T(this,qu);T(this,Vu,0);_(this,Ro,t),_(this,Vn,i)}addFilter(t){if(!t)return"none";let i=c(this,Xe,Un).get(t);if(i)return i;const[s,r,a]=R(this,Xe,Nx).call(this,t),o=t.length===1?s:`${s}${r}${a}`;if(i=c(this,Xe,Un).get(o),i)return c(this,Xe,Un).set(t,i),i;const l=`g_${c(this,Ro)}_transfer_map_${en(this,Vu)._++}`,u=R(this,Xe,jd).call(this,l);c(this,Xe,Un).set(t,u),c(this,Xe,Un).set(o,u);const d=R(this,Xe,Rd).call(this,l);return R(this,Xe,Kg).call(this,s,r,a,d),u}addHCMFilter(t,i){var x;const s=`${t}-${i}`,r="base";let a=c(this,Xe,Wg).get(r);if((a==null?void 0:a.key)===s||(a?((x=a.filter)==null||x.remove(),a.key=s,a.url="none",a.filter=null):(a={key:s,url:"none",filter:null},c(this,Xe,Wg).set(r,a)),!t||!i))return a.url;const o=R(this,Xe,Zg).call(this,t);t=Ye.makeHexColor(...o);const l=R(this,Xe,Zg).call(this,i);if(i=Ye.makeHexColor(...l),c(this,Xe,Dd).style.color="",t==="#000000"&&i==="#ffffff"||t===i)return a.url;const u=new Array(256);for(let w=0;w<=255;w++){const y=w/255;u[w]=y<=.03928?y/12.92:((y+.055)/1.055)**2.4}const d=u.join(","),f=`g_${c(this,Ro)}_hcm_filter`,p=a.filter=R(this,Xe,Rd).call(this,f);R(this,Xe,Kg).call(this,d,d,d,p),R(this,Xe,kA).call(this,p);const g=(w,y)=>{const m=o[w]/255,v=l[w]/255,b=new Array(y+1);for(let A=0;A<=y;A++)b[A]=m+A/y*(v-m);return b.join(",")};return R(this,Xe,Kg).call(this,g(0,5),g(1,5),g(2,5),p),a.url=R(this,Xe,jd).call(this,f),a.url}addAlphaFilter(t){let i=c(this,Xe,Un).get(t);if(i)return i;const[s]=R(this,Xe,Nx).call(this,[t]),r=`alpha_${s}`;if(i=c(this,Xe,Un).get(r),i)return c(this,Xe,Un).set(t,i),i;const a=`g_${c(this,Ro)}_alpha_map_${en(this,Vu)._++}`,o=R(this,Xe,jd).call(this,a);c(this,Xe,Un).set(t,o),c(this,Xe,Un).set(r,o);const l=R(this,Xe,Rd).call(this,a);return R(this,Xe,TA).call(this,s,l),o}addLuminosityFilter(t){let i=c(this,Xe,Un).get(t||"luminosity");if(i)return i;let s,r;if(t?([s]=R(this,Xe,Nx).call(this,[t]),r=`luminosity_${s}`):r="luminosity",i=c(this,Xe,Un).get(r),i)return c(this,Xe,Un).set(t,i),i;const a=`g_${c(this,Ro)}_luminosity_map_${en(this,Vu)._++}`,o=R(this,Xe,jd).call(this,a);c(this,Xe,Un).set(t,o),c(this,Xe,Un).set(r,o);const l=R(this,Xe,Rd).call(this,a);return R(this,Xe,jL).call(this,l),t&&R(this,Xe,TA).call(this,s,l),o}addHighlightHCMFilter(t,i,s,r,a){var v;const o=`${i}-${s}-${r}-${a}`;let l=c(this,Xe,Wg).get(t);if((l==null?void 0:l.key)===o||(l?((v=l.filter)==null||v.remove(),l.key=o,l.url="none",l.filter=null):(l={key:o,url:"none",filter:null},c(this,Xe,Wg).set(t,l)),!i||!s))return l.url;const[u,d]=[i,s].map(R(this,Xe,Zg).bind(this));let f=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),p=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),[g,x]=[r,a].map(R(this,Xe,Zg).bind(this));p<f&&([f,p,g,x]=[p,f,x,g]),c(this,Xe,Dd).style.color="";const w=(b,A,S)=>{const C=new Array(256),k=(p-f)/S,L=b/255,D=(A-b)/(255*S);let j=0;for(let P=0;P<=S;P++){const H=Math.round(f+P*k),G=L+P*D;for(let $=j;$<=H;$++)C[$]=G;j=H+1}for(let P=j;P<256;P++)C[P]=C[j-1];return C.join(",")},y=`g_${c(this,Ro)}_hcm_${t}_filter`,m=l.filter=R(this,Xe,Rd).call(this,y);return R(this,Xe,kA).call(this,m),R(this,Xe,Kg).call(this,w(g[0],x[0],5),w(g[1],x[1],5),w(g[2],x[2],5),m),l.url=R(this,Xe,jd).call(this,y),l.url}destroy(t=!1){var i,s,r,a;t&&((i=c(this,qu))!=null&&i.size)||((s=c(this,jo))==null||s.parentNode.parentNode.remove(),_(this,jo,null),(r=c(this,$f))==null||r.clear(),_(this,$f,null),(a=c(this,qu))==null||a.clear(),_(this,qu,null),_(this,Vu,0))}}$u=new WeakMap,$f=new WeakMap,jo=new WeakMap,Ro=new WeakMap,Vn=new WeakMap,qu=new WeakMap,Vu=new WeakMap,Xe=new WeakSet,Un=function(){return c(this,$f)||_(this,$f,new Map)},Wg=function(){return c(this,qu)||_(this,qu,new Map)},Dd=function(){if(!c(this,jo)){const t=c(this,Vn).createElement("div"),{style:i}=t;i.visibility="hidden",i.contain="strict",i.width=i.height=0,i.position="absolute",i.top=i.left=0,i.zIndex=-1;const s=c(this,Vn).createElementNS(ho,"svg");s.setAttribute("width",0),s.setAttribute("height",0),_(this,jo,c(this,Vn).createElementNS(ho,"defs")),t.append(s),s.append(c(this,jo)),c(this,Vn).body.append(t)}return c(this,jo)},Nx=function(t){if(t.length===1){const u=t[0],d=new Array(256);for(let p=0;p<256;p++)d[p]=u[p]/255;const f=d.join(",");return[f,f,f]}const[i,s,r]=t,a=new Array(256),o=new Array(256),l=new Array(256);for(let u=0;u<256;u++)a[u]=i[u]/255,o[u]=s[u]/255,l[u]=r[u]/255;return[a.join(","),o.join(","),l.join(",")]},jd=function(t){if(c(this,$u)===void 0){_(this,$u,"");const i=c(this,Vn).URL;i!==c(this,Vn).baseURI&&(dw(i)?ct('#createUrl: ignore "data:"-URL for performance reasons.'):_(this,$u,B4(i,"")))}return`url(${c(this,$u)}#${t})`},jL=function(t){const i=c(this,Vn).createElementNS(ho,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(i)},kA=function(t){const i=c(this,Vn).createElementNS(ho,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(i)},Rd=function(t){const i=c(this,Vn).createElementNS(ho,"filter");return i.setAttribute("color-interpolation-filters","sRGB"),i.setAttribute("id",t),c(this,Xe,Dd).append(i),i},Xg=function(t,i,s){const r=c(this,Vn).createElementNS(ho,i);r.setAttribute("type","discrete"),r.setAttribute("tableValues",s),t.append(r)},Kg=function(t,i,s,r){const a=c(this,Vn).createElementNS(ho,"feComponentTransfer");r.append(a),R(this,Xe,Xg).call(this,a,"feFuncR",t),R(this,Xe,Xg).call(this,a,"feFuncG",i),R(this,Xe,Xg).call(this,a,"feFuncB",s)},TA=function(t,i){const s=c(this,Vn).createElementNS(ho,"feComponentTransfer");i.append(s),R(this,Xe,Xg).call(this,s,"feFuncA",t)},Zg=function(t){return c(this,Xe,Dd).style.color=t,mv(getComputedStyle(c(this,Xe,Dd)).getPropertyValue("color"))};class RL{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(i=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){zt("Abstract method `_fetch` called.")}}class qT extends RL{async _fetch(e){const t=await pv(e,"arraybuffer");return new Uint8Array(t)}}class LL{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(i=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){zt("Abstract method `_fetch` called.")}}class VT extends LL{async _fetch(e){const t=await pv(e,"arraybuffer");return new Uint8Array(t)}}is&&ct("Please use the `legacy` build in Node.js environments.");async function p_(n){const t=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(t)}class SV extends DL{}class AV extends kL{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class EV extends TL{async _fetch(e){return p_(e)}}class CV extends RL{async _fetch(e){return p_(e)}}class _V extends LL{async _fetch(e){return p_(e)}}const xd="__forcedDependency",{floor:GT,ceil:YT}=Math;function Vv(n,e,t,i,s,r){n[e*4+0]=Math.min(n[e*4+0],t),n[e*4+1]=Math.min(n[e*4+1],i),n[e*4+2]=Math.max(n[e*4+2],s),n[e*4+3]=Math.max(n[e*4+3],r)}const DA=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];var qf,lc;class NV{constructor(e,t){T(this,qf);T(this,lc);_(this,qf,e),_(this,lc,t)}get length(){return c(this,qf).length}isEmpty(e){return c(this,qf)[e]===DA}minX(e){return c(this,lc)[e*4+0]/256}minY(e){return c(this,lc)[e*4+1]/256}maxX(e){return(c(this,lc)[e*4+2]+1)/256}maxY(e){return(c(this,lc)[e*4+3]+1)/256}}qf=new WeakMap,lc=new WeakMap;const Gv=(n,e)=>{if(!n)return;let t=n.get(e);return t||(t={dependencies:new Set,isRenderingOperation:!1},n.set(e,t)),t};var ps,gs,Gu,na,Yu,Lo,Yt,ei,Mo,ms,I0,Vf,Wu,Xu,Oo,Gn,Ma,P0,jA;class kV{constructor(e,t,i=!1){T(this,P0);T(this,ps,{__proto__:null});T(this,gs,{__proto__:null,transform:[],moveText:[],sameLineText:[],[xd]:[]});T(this,Gu,new Map);T(this,na,[]);T(this,Yu,[]);T(this,Lo,[[1,0,0,1,0,0]]);T(this,Yt,[-1/0,-1/0,1/0,1/0]);T(this,ei,new Float64Array([1/0,1/0,-1/0,-1/0]));T(this,Mo,-1);T(this,ms,new Set);T(this,I0,new Map);T(this,Vf,new Map);T(this,Wu);T(this,Xu);T(this,Oo);T(this,Gn);T(this,Ma);_(this,Wu,e.width),_(this,Xu,e.height),R(this,P0,jA).call(this,t),i&&_(this,Ma,new Map)}growOperationsCount(e){e>=c(this,Gn).length&&R(this,P0,jA).call(this,e,c(this,Gn))}save(e){return _(this,ps,{__proto__:c(this,ps)}),_(this,gs,{__proto__:c(this,gs),transform:{__proto__:c(this,gs).transform},moveText:{__proto__:c(this,gs).moveText},sameLineText:{__proto__:c(this,gs).sameLineText},[xd]:{__proto__:c(this,gs)[xd]}}),_(this,Yt,{__proto__:c(this,Yt)}),c(this,na).push(e),this}restore(e){var s;const t=Object.getPrototypeOf(c(this,ps));if(t===null)return this;_(this,ps,t),_(this,gs,Object.getPrototypeOf(c(this,gs))),_(this,Yt,Object.getPrototypeOf(c(this,Yt)));const i=c(this,na).pop();return i!==void 0&&((s=Gv(c(this,Ma),e))==null||s.dependencies.add(i),c(this,Gn)[e]=c(this,Gn)[i]),this}recordOpenMarker(e){return c(this,na).push(e),this}getOpenMarker(){return c(this,na).length===0?null:c(this,na).at(-1)}recordCloseMarker(e){var i;const t=c(this,na).pop();return t!==void 0&&((i=Gv(c(this,Ma),e))==null||i.dependencies.add(t),c(this,Gn)[e]=c(this,Gn)[t]),this}beginMarkedContent(e){return c(this,Yu).push(e),this}endMarkedContent(e){var i;const t=c(this,Yu).pop();return t!==void 0&&((i=Gv(c(this,Ma),e))==null||i.dependencies.add(t),c(this,Gn)[e]=c(this,Gn)[t]),this}pushBaseTransform(e){return c(this,Lo).push(Ye.multiplyByDOMMatrix(c(this,Lo).at(-1),e.getTransform())),this}popBaseTransform(){return c(this,Lo).length>1&&c(this,Lo).pop(),this}recordSimpleData(e,t){return c(this,ps)[e]=t,this}recordIncrementalData(e,t){return c(this,gs)[e].push(t),this}resetIncrementalData(e,t){return c(this,gs)[e].length=0,this}recordNamedData(e,t){return c(this,Gu).set(e,t),this}recordSimpleDataFromNamed(e,t,i){c(this,ps)[e]=c(this,Gu).get(t)??i}recordFutureForcedDependency(e,t){return this.recordIncrementalData(xd,t),this}inheritSimpleDataAsFutureForcedDependencies(e){for(const t of e)t in c(this,ps)&&this.recordFutureForcedDependency(t,c(this,ps)[t]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const e of c(this,ms))this.recordFutureForcedDependency(xd,e);return this}resetBBox(e){return c(this,Mo)!==e&&(_(this,Mo,e),c(this,ei)[0]=1/0,c(this,ei)[1]=1/0,c(this,ei)[2]=-1/0,c(this,ei)[3]=-1/0),this}recordClipBox(e,t,i,s,r,a){const o=Ye.multiplyByDOMMatrix(c(this,Lo).at(-1),t.getTransform()),l=[1/0,1/0,-1/0,-1/0];Ye.axialAlignedBoundingBox([i,r,s,a],o,l);const u=Ye.intersect(c(this,Yt),l);return u?(c(this,Yt)[0]=u[0],c(this,Yt)[1]=u[1],c(this,Yt)[2]=u[2],c(this,Yt)[3]=u[3]):(c(this,Yt)[0]=c(this,Yt)[1]=1/0,c(this,Yt)[2]=c(this,Yt)[3]=-1/0),this}recordBBox(e,t,i,s,r,a){const o=c(this,Yt);if(o[0]===1/0)return this;const l=Ye.multiplyByDOMMatrix(c(this,Lo).at(-1),t.getTransform());if(o[0]===-1/0)return Ye.axialAlignedBoundingBox([i,r,s,a],l,c(this,ei)),this;const u=[1/0,1/0,-1/0,-1/0];return Ye.axialAlignedBoundingBox([i,r,s,a],l,u),c(this,ei)[0]=Math.min(c(this,ei)[0],Math.max(u[0],o[0])),c(this,ei)[1]=Math.min(c(this,ei)[1],Math.max(u[1],o[1])),c(this,ei)[2]=Math.max(c(this,ei)[2],Math.min(u[2],o[2])),c(this,ei)[3]=Math.max(c(this,ei)[3],Math.min(u[3],o[3])),this}recordCharacterBBox(e,t,i,s=1,r=0,a=0,o){const l=i.bbox;let u,d;if(l&&(u=l[2]!==l[0]&&l[3]!==l[1]&&c(this,Vf).get(i),u!==!1&&(d=[0,0,0,0],Ye.axialAlignedBoundingBox(l,i.fontMatrix,d),(s!==1||r!==0||a!==0)&&Ye.scaleMinMax([s,0,0,-s,r,a],d),u)))return this.recordBBox(e,t,d[0],d[2],d[1],d[3]);if(!o)return this.recordFullPageBBox(e);const f=o();return l&&d&&u===void 0&&(u=d[0]<=r-f.actualBoundingBoxLeft&&d[2]>=r+f.actualBoundingBoxRight&&d[1]<=a-f.actualBoundingBoxAscent&&d[3]>=a+f.actualBoundingBoxDescent,c(this,Vf).set(i,u),u)?this.recordBBox(e,t,d[0],d[2],d[1],d[3]):this.recordBBox(e,t,r-f.actualBoundingBoxLeft,r+f.actualBoundingBoxRight,a-f.actualBoundingBoxAscent,a+f.actualBoundingBoxDescent)}recordFullPageBBox(e){return c(this,ei)[0]=Math.max(0,c(this,Yt)[0]),c(this,ei)[1]=Math.max(0,c(this,Yt)[1]),c(this,ei)[2]=Math.min(c(this,Wu),c(this,Yt)[2]),c(this,ei)[3]=Math.min(c(this,Xu),c(this,Yt)[3]),this}getSimpleIndex(e){return c(this,ps)[e]}recordDependencies(e,t){const i=c(this,ms),s=c(this,ps),r=c(this,gs);for(const a of t)a in c(this,ps)?i.add(s[a]):a in r&&r[a].forEach(i.add,i);return this}recordNamedDependency(e,t){return c(this,Gu).has(t)&&c(this,ms).add(c(this,Gu).get(t)),this}recordOperation(e,t=!1){if(this.recordDependencies(e,[xd]),c(this,Ma)){const i=Gv(c(this,Ma),e),{dependencies:s}=i;c(this,ms).forEach(s.add,s),c(this,na).forEach(s.add,s),c(this,Yu).forEach(s.add,s),s.delete(e),i.isRenderingOperation=!0}if(c(this,Mo)===e){const i=GT(c(this,ei)[0]*256/c(this,Wu)),s=GT(c(this,ei)[1]*256/c(this,Xu)),r=YT(c(this,ei)[2]*256/c(this,Wu)),a=YT(c(this,ei)[3]*256/c(this,Xu));Vv(c(this,Oo),e,i,s,r,a);for(const o of c(this,ms))o!==e&&Vv(c(this,Oo),o,i,s,r,a);for(const o of c(this,na))o!==e&&Vv(c(this,Oo),o,i,s,r,a);for(const o of c(this,Yu))o!==e&&Vv(c(this,Oo),o,i,s,r,a);t||(c(this,ms).clear(),_(this,Mo,-1))}return this}recordShowTextOperation(e,t=!1){const i=Array.from(c(this,ms));this.recordOperation(e,t),this.recordIncrementalData("sameLineText",e);for(const s of i)this.recordIncrementalData("sameLineText",s);return this}bboxToClipBoxDropOperation(e,t=!1){return c(this,Mo)===e&&(_(this,Mo,-1),c(this,Yt)[0]=Math.max(c(this,Yt)[0],c(this,ei)[0]),c(this,Yt)[1]=Math.max(c(this,Yt)[1],c(this,ei)[1]),c(this,Yt)[2]=Math.min(c(this,Yt)[2],c(this,ei)[2]),c(this,Yt)[3]=Math.min(c(this,Yt)[3],c(this,ei)[3]),t||c(this,ms).clear()),this}_takePendingDependencies(){const e=c(this,ms);return _(this,ms,new Set),e}_extractOperation(e){const t=c(this,I0).get(e);return c(this,I0).delete(e),t}_pushPendingDependencies(e){for(const t of e)c(this,ms).add(t)}take(){return c(this,Vf).clear(),new NV(c(this,Gn),c(this,Oo))}takeDebugMetadata(){return c(this,Ma)}}ps=new WeakMap,gs=new WeakMap,Gu=new WeakMap,na=new WeakMap,Yu=new WeakMap,Lo=new WeakMap,Yt=new WeakMap,ei=new WeakMap,Mo=new WeakMap,ms=new WeakMap,I0=new WeakMap,Vf=new WeakMap,Wu=new WeakMap,Xu=new WeakMap,Oo=new WeakMap,Gn=new WeakMap,Ma=new WeakMap,P0=new WeakSet,jA=function(e,t){const i=new ArrayBuffer(e*4);_(this,Oo,new Uint8ClampedArray(i)),_(this,Gn,new Uint32Array(i)),t&&t.length>0?(c(this,Gn).set(t),c(this,Gn).fill(DA,t.length)):c(this,Gn).fill(DA)};var ri,Ti,sa,Gf,Yf;const A_=class A_{constructor(e,t,i){T(this,ri);T(this,Ti);T(this,sa);T(this,Gf,0);T(this,Yf,0);if(e instanceof A_&&c(e,sa)===!!i)return e;_(this,ri,e),_(this,Ti,t),_(this,sa,!!i)}growOperationsCount(){throw new Error("Unreachable")}save(e){return en(this,Yf)._++,c(this,ri).save(c(this,Ti)),this}restore(e){return c(this,Yf)>0&&(c(this,ri).restore(c(this,Ti)),en(this,Yf)._--),this}recordOpenMarker(e){return en(this,Gf)._++,this}getOpenMarker(){return c(this,Gf)>0?c(this,Ti):c(this,ri).getOpenMarker()}recordCloseMarker(e){return en(this,Gf)._--,this}beginMarkedContent(e){return this}endMarkedContent(e){return this}pushBaseTransform(e){return c(this,ri).pushBaseTransform(e),this}popBaseTransform(){return c(this,ri).popBaseTransform(),this}recordSimpleData(e,t){return c(this,ri).recordSimpleData(e,c(this,Ti)),this}recordIncrementalData(e,t){return c(this,ri).recordIncrementalData(e,c(this,Ti)),this}resetIncrementalData(e,t){return c(this,ri).resetIncrementalData(e,c(this,Ti)),this}recordNamedData(e,t){return this}recordSimpleDataFromNamed(e,t,i){return c(this,ri).recordSimpleDataFromNamed(e,t,c(this,Ti)),this}recordFutureForcedDependency(e,t){return c(this,ri).recordFutureForcedDependency(e,c(this,Ti)),this}inheritSimpleDataAsFutureForcedDependencies(e){return c(this,ri).inheritSimpleDataAsFutureForcedDependencies(e),this}inheritPendingDependenciesAsFutureForcedDependencies(){return c(this,ri).inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(e){return c(this,sa)||c(this,ri).resetBBox(c(this,Ti)),this}recordClipBox(e,t,i,s,r,a){return c(this,sa)||c(this,ri).recordClipBox(c(this,Ti),t,i,s,r,a),this}recordBBox(e,t,i,s,r,a){return c(this,sa)||c(this,ri).recordBBox(c(this,Ti),t,i,s,r,a),this}recordCharacterBBox(e,t,i,s,r,a,o){return c(this,sa)||c(this,ri).recordCharacterBBox(c(this,Ti),t,i,s,r,a,o),this}recordFullPageBBox(e){return c(this,sa)||c(this,ri).recordFullPageBBox(c(this,Ti)),this}getSimpleIndex(e){return c(this,ri).getSimpleIndex(e)}recordDependencies(e,t){return c(this,ri).recordDependencies(c(this,Ti),t),this}recordNamedDependency(e,t){return c(this,ri).recordNamedDependency(c(this,Ti),t),this}recordOperation(e){return c(this,ri).recordOperation(c(this,Ti),!0),this}recordShowTextOperation(e){return c(this,ri).recordShowTextOperation(c(this,Ti),!0),this}bboxToClipBoxDropOperation(e){return c(this,sa)||c(this,ri).bboxToClipBoxDropOperation(c(this,Ti),!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}};ri=new WeakMap,Ti=new WeakMap,sa=new WeakMap,Gf=new WeakMap,Yf=new WeakMap;let Jb=A_;const yr={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},jn={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function RA(n,e){if(!e)return;const t=e[2]-e[0],i=e[3]-e[1],s=new Path2D;s.rect(e[0],e[1],t,i),n.clip(s)}class g_{isModifyingCurrentTransform(){return!1}getPattern(){zt("Abstract method `getPattern` called.")}}class TV extends g_{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}isOriginBased(){return this._p0[0]===0&&this._p0[1]===0&&(!this.isRadial()||this._p1[0]===0&&this._p1[1]===0)}isRadial(){return this._type==="radial"}_createGradient(e,t=null){let i,s=this._p0,r=this._p1;if(t&&(s=s.slice(),r=r.slice(),Ye.applyTransform(s,t),Ye.applyTransform(r,t)),this._type==="axial")i=e.createLinearGradient(s[0],s[1],r[0],r[1]);else if(this._type==="radial"){let a=this._r0,o=this._r1;if(t){const l=new Float32Array(2);Ye.singularValueDecompose2dScale(t,l),a*=l[0],o*=l[0]}i=e.createRadialGradient(s[0],s[1],a,r[0],r[1],o)}for(const a of this._colorStops)i.addColorStop(a[0],a[1]);return i}getPattern(e,t,i,s){let r;if(s===jn.STROKE||s===jn.FILL){if(this.isOriginBased()){let p=Ye.transform(i,t.baseTransform);this.matrix&&(p=Ye.transform(p,this.matrix));const g=.001,x=Math.hypot(p[0],p[1]),w=Math.hypot(p[2],p[3]),y=(p[0]*p[2]+p[1]*p[3])/(x*w);if(Math.abs(y)<g)if(this.isRadial()){if(Math.abs(x-w)<g)return this._createGradient(e,p)}else return this._createGradient(e,p)}const a=t.current.getClippedPathBoundingBox(s,Ci(e))||[0,0,0,0],o=Math.ceil(a[2]-a[0])||1,l=Math.ceil(a[3]-a[1])||1,u=t.cachedCanvases.getCanvas("pattern",o,l),d=u.context;d.clearRect(0,0,d.canvas.width,d.canvas.height),d.beginPath(),d.rect(0,0,d.canvas.width,d.canvas.height),d.translate(-a[0],-a[1]),i=Ye.transform(i,[1,0,0,1,a[0],a[1]]),d.transform(...t.baseTransform),this.matrix&&d.transform(...this.matrix),RA(d,this._bbox),d.fillStyle=this._createGradient(d),d.fill(),r=e.createPattern(u.canvas,"no-repeat");const f=new DOMMatrix(i);r.setTransform(f)}else RA(e,this._bbox),r=this._createGradient(e);return r}}function R2(n,e,t,i,s,r,a,o){const l=e.coords,u=e.colors,d=n.data,f=n.width*4;let p;l[t+1]>l[i+1]&&(p=t,t=i,i=p,p=r,r=a,a=p),l[i+1]>l[s+1]&&(p=i,i=s,s=p,p=a,a=o,o=p),l[t+1]>l[i+1]&&(p=t,t=i,i=p,p=r,r=a,a=p);const g=(l[t]+e.offsetX)*e.scaleX,x=(l[t+1]+e.offsetY)*e.scaleY,w=(l[i]+e.offsetX)*e.scaleX,y=(l[i+1]+e.offsetY)*e.scaleY,m=(l[s]+e.offsetX)*e.scaleX,v=(l[s+1]+e.offsetY)*e.scaleY;if(x>=v)return;const b=u[r],A=u[r+1],S=u[r+2],C=u[a],k=u[a+1],L=u[a+2],D=u[o],j=u[o+1],P=u[o+2],H=Math.round(x),G=Math.round(v);let $,Y,F,M,I,V,ie,ge;for(let ee=H;ee<=G;ee++){if(ee<y){const re=ee<x?0:(x-ee)/(x-y);$=g-(g-w)*re,Y=b-(b-C)*re,F=A-(A-k)*re,M=S-(S-L)*re}else{let re;ee>v?re=1:y===v?re=0:re=(y-ee)/(y-v),$=w-(w-m)*re,Y=C-(C-D)*re,F=k-(k-j)*re,M=L-(L-P)*re}let me;ee<x?me=0:ee>v?me=1:me=(x-ee)/(x-v),I=g-(g-m)*me,V=b-(b-D)*me,ie=A-(A-j)*me,ge=S-(S-P)*me;const oe=Math.round(Math.min($,I)),ae=Math.round(Math.max($,I));let Z=f*ee+oe*4;for(let re=oe;re<=ae;re++)me=($-re)/($-I),me<0?me=0:me>1&&(me=1),d[Z++]=Y-(Y-V)*me|0,d[Z++]=F-(F-ie)*me|0,d[Z++]=M-(M-ge)*me|0,d[Z++]=255}}function DV(n,e,t){const i=e.coords,s=e.colors;let r,a;switch(e.type){case nA.LATTICE:const o=e.verticesPerRow,l=Math.floor(i.length/o)-1,u=o-1;for(r=0;r<l;r++){let d=r*o;for(let f=0;f<u;f++,d++)R2(n,t,i[d],i[d+1],i[d+o],s[d],s[d+1],s[d+o]),R2(n,t,i[d+o+1],i[d+1],i[d+o],s[d+o+1],s[d+1],s[d+o])}break;case nA.TRIANGLES:for(r=0,a=i.length;r<a;r+=3)R2(n,t,i[r],i[r+1],i[r+2],s[r],s[r+1],s[r+2]);break;default:throw new Error("illegal figure")}}class jV extends g_{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,i){const o=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),u=Math.ceil(this._bounds[2])-o,d=Math.ceil(this._bounds[3])-l,f=Math.min(Math.ceil(Math.abs(u*e[0]*1.1)),3e3),p=Math.min(Math.ceil(Math.abs(d*e[1]*1.1)),3e3),g=u/f,x=d/p,w={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-l,scaleX:1/g,scaleY:1/x},y=f+2*2,m=p+2*2,v=i.getCanvas("mesh",y,m),b=v.context,A=b.createImageData(f,p);if(t){const C=A.data;for(let k=0,L=C.length;k<L;k+=4)C[k]=t[0],C[k+1]=t[1],C[k+2]=t[2],C[k+3]=255}for(const C of this._figures)DV(A,C,w);return b.putImageData(A,2,2),{canvas:v.canvas,offsetX:o-2*g,offsetY:l-2*x,scaleX:g,scaleY:x}}isModifyingCurrentTransform(){return!0}getPattern(e,t,i,s){RA(e,this._bbox);const r=new Float32Array(2);if(s===jn.SHADING)Ye.singularValueDecompose2dScale(Ci(e),r);else if(this.matrix){Ye.singularValueDecompose2dScale(this.matrix,r);const[o,l]=r;Ye.singularValueDecompose2dScale(t.baseTransform,r),r[0]*=o,r[1]*=l}else Ye.singularValueDecompose2dScale(t.baseTransform,r);const a=this._createMeshCanvas(r,s===jn.SHADING?null:this._background,t.cachedCanvases);return s!==jn.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(a.offsetX,a.offsetY),e.scale(a.scaleX,a.scaleY),e.createPattern(a.canvas,"no-repeat")}}class RV extends g_{getPattern(){return"hotpink"}}function LV(n){switch(n[0]){case"RadialAxial":return new TV(n);case"Mesh":return new jV(n);case"Dummy":return new RV}throw new Error(`Unknown IR type: ${n[0]}`)}const WT={COLORED:1,UNCOLORED:2},p1=class p1{constructor(e,t,i,s){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=i,this.baseTransform=s}createPatternCanvas(e,t){var V,ie;const{bbox:i,operatorList:s,paintType:r,tilingType:a,color:o,canvasGraphicsFactory:l}=this;let{xstep:u,ystep:d}=this;u=Math.abs(u),d=Math.abs(d),cw("TilingType: "+a);const f=i[0],p=i[1],g=i[2],x=i[3],w=g-f,y=x-p,m=new Float32Array(2);Ye.singularValueDecompose2dScale(this.matrix,m);const[v,b]=m;Ye.singularValueDecompose2dScale(this.baseTransform,m);const A=v*m[0],S=b*m[1];let C=w,k=y,L=!1,D=!1;const j=Math.ceil(u*A),P=Math.ceil(d*S),H=Math.ceil(w*A),G=Math.ceil(y*S);j>=H?C=u:L=!0,P>=G?k=d:D=!0;const $=this.getSizeAndScale(C,this.ctx.canvas.width,A),Y=this.getSizeAndScale(k,this.ctx.canvas.height,S),F=e.cachedCanvases.getCanvas("pattern",$.size,Y.size),M=F.context,I=l.createCanvasGraphics(M,t);if(I.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(I,r,o),M.translate(-$.scale*f,-Y.scale*p),I.transform(0,$.scale,0,0,Y.scale,0,0),M.save(),(V=I.dependencyTracker)==null||V.save(),this.clipBbox(I,f,p,g,x),I.baseTransform=Ci(I.ctx),I.executeOperatorList(s),I.endDrawing(),(ie=I.dependencyTracker)==null||ie.restore(),M.restore(),L||D){const ge=F.canvas;L&&(C=u),D&&(k=d);const ee=this.getSizeAndScale(C,this.ctx.canvas.width,A),me=this.getSizeAndScale(k,this.ctx.canvas.height,S),oe=ee.size,ae=me.size,Z=e.cachedCanvases.getCanvas("pattern-workaround",oe,ae),re=Z.context,ne=L?Math.floor(w/u):0,xe=D?Math.floor(y/d):0;for(let Re=0;Re<=ne;Re++)for(let je=0;je<=xe;je++)re.drawImage(ge,oe*Re,ae*je,oe,ae,0,0,oe,ae);return{canvas:Z.canvas,scaleX:ee.scale,scaleY:me.scale,offsetX:f,offsetY:p}}return{canvas:F.canvas,scaleX:$.scale,scaleY:Y.scale,offsetX:f,offsetY:p}}getSizeAndScale(e,t,i){const s=Math.max(p1.MAX_PATTERN_SIZE,t);let r=Math.ceil(e*i);return r>=s?r=s:i=r/e,{scale:i,size:r}}clipBbox(e,t,i,s,r){const a=s-t,o=r-i;e.ctx.rect(t,i,a,o),Ye.axialAlignedBoundingBox([t,i,s,r],Ci(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,i){const s=e.ctx,r=e.current;switch(t){case WT.COLORED:const{fillStyle:a,strokeStyle:o}=this.ctx;s.fillStyle=r.fillColor=a,s.strokeStyle=r.strokeColor=o;break;case WT.UNCOLORED:s.fillStyle=s.strokeStyle=i,r.fillColor=r.strokeColor=i;break;default:throw new Vq(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,i,s,r){let a=i;s!==jn.SHADING&&(a=Ye.transform(a,t.baseTransform),this.matrix&&(a=Ye.transform(a,this.matrix)));const o=this.createPatternCanvas(t,r);let l=new DOMMatrix(a);l=l.translate(o.offsetX,o.offsetY),l=l.scale(1/o.scaleX,1/o.scaleY);const u=e.createPattern(o.canvas,"repeat");return u.setTransform(l),u}};fe(p1,"MAX_PATTERN_SIZE",3e3);let LA=p1;function MV({src:n,srcPos:e=0,dest:t,width:i,height:s,nonBlackColor:r=4294967295,inverseDecode:a=!1}){const o=on.isLittleEndian?4278190080:255,[l,u]=a?[r,o]:[o,r],d=i>>3,f=i&7,p=n.length;t=new Uint32Array(t.buffer);let g=0;for(let x=0;x<s;x++){for(const y=e+d;e<y;e++){const m=e<p?n[e]:255;t[g++]=m&128?u:l,t[g++]=m&64?u:l,t[g++]=m&32?u:l,t[g++]=m&16?u:l,t[g++]=m&8?u:l,t[g++]=m&4?u:l,t[g++]=m&2?u:l,t[g++]=m&1?u:l}if(f===0)continue;const w=e<p?n[e++]:255;for(let y=0;y<f;y++)t[g++]=w&1<<7-y?u:l}return{srcPos:e,destPos:g}}const XT=16,KT=100,OV=15,ZT=10,As=16,L2=new DOMMatrix,er=new Float32Array(2),Kd=new Float32Array([1/0,1/0,-1/0,-1/0]);function IV(n,e){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){e.save(),this.__originalSave()},n.restore=function(){e.restore(),this.__originalRestore()},n.translate=function(t,i){e.translate(t,i),this.__originalTranslate(t,i)},n.scale=function(t,i){e.scale(t,i),this.__originalScale(t,i)},n.transform=function(t,i,s,r,a,o){e.transform(t,i,s,r,a,o),this.__originalTransform(t,i,s,r,a,o)},n.setTransform=function(t,i,s,r,a,o){e.setTransform(t,i,s,r,a,o),this.__originalSetTransform(t,i,s,r,a,o)},n.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},n.rotate=function(t){e.rotate(t),this.__originalRotate(t)},n.clip=function(t){e.clip(t),this.__originalClip(t)},n.moveTo=function(t,i){e.moveTo(t,i),this.__originalMoveTo(t,i)},n.lineTo=function(t,i){e.lineTo(t,i),this.__originalLineTo(t,i)},n.bezierCurveTo=function(t,i,s,r,a,o){e.bezierCurveTo(t,i,s,r,a,o),this.__originalBezierCurveTo(t,i,s,r,a,o)},n.rect=function(t,i,s,r){e.rect(t,i,s,r),this.__originalRect(t,i,s,r)},n.closePath=function(){e.closePath(),this.__originalClosePath()},n.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class PV{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,i){let s;return this.cache[e]!==void 0?(s=this.cache[e],this.canvasFactory.reset(s,t,i)):(s=this.canvasFactory.create(t,i),this.cache[e]=s),s}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function Yv(n,e,t,i,s,r,a,o,l,u){const[d,f,p,g,x,w]=Ci(n);if(f===0&&p===0){const v=a*d+x,b=Math.round(v),A=o*g+w,S=Math.round(A),C=(a+l)*d+x,k=Math.abs(Math.round(C)-b)||1,L=(o+u)*g+w,D=Math.abs(Math.round(L)-S)||1;return n.setTransform(Math.sign(d),0,0,Math.sign(g),b,S),n.drawImage(e,t,i,s,r,0,0,k,D),n.setTransform(d,f,p,g,x,w),[k,D]}if(d===0&&g===0){const v=o*p+x,b=Math.round(v),A=a*f+w,S=Math.round(A),C=(o+u)*p+x,k=Math.abs(Math.round(C)-b)||1,L=(a+l)*f+w,D=Math.abs(Math.round(L)-S)||1;return n.setTransform(0,Math.sign(f),Math.sign(p),0,b,S),n.drawImage(e,t,i,s,r,0,0,D,k),n.setTransform(d,f,p,g,x,w),[D,k]}n.drawImage(e,t,i,s,r,a,o,l,u);const y=Math.hypot(d,f),m=Math.hypot(p,g);return[y*l,m*u]}class QT{constructor(e,t,i){fe(this,"alphaIsShape",!1);fe(this,"fontSize",0);fe(this,"fontSizeScale",1);fe(this,"textMatrix",null);fe(this,"textMatrixScale",1);fe(this,"fontMatrix",iA);fe(this,"leading",0);fe(this,"x",0);fe(this,"y",0);fe(this,"lineX",0);fe(this,"lineY",0);fe(this,"charSpacing",0);fe(this,"wordSpacing",0);fe(this,"textHScale",1);fe(this,"textRenderingMode",tn.FILL);fe(this,"textRise",0);fe(this,"fillColor","#000000");fe(this,"strokeColor","#000000");fe(this,"patternFill",!1);fe(this,"patternStroke",!1);fe(this,"fillAlpha",1);fe(this,"strokeAlpha",1);fe(this,"lineWidth",1);fe(this,"activeSMask",null);fe(this,"transferMaps","none");i==null||i(this),this.clipBox=new Float32Array([0,0,e,t]),this.minMax=Kd.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=jn.FILL,t=null){const i=this.minMax.slice();if(e===jn.STROKE){t||zt("Stroke bounding box must include transform."),Ye.singularValueDecompose2dScale(t,er);const s=er[0]*this.lineWidth/2,r=er[1]*this.lineWidth/2;i[0]-=s,i[1]-=r,i[2]+=s,i[3]+=r}return i}updateClipFromPath(){const e=Ye.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(Kd,0)}getClippedPathBoundingBox(e=jn.FILL,t=null){return Ye.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function JT(n,e){if(e instanceof ImageData){n.putImageData(e,0,0);return}const t=e.height,i=e.width,s=t%As,r=(t-s)/As,a=s===0?r:r+1,o=n.createImageData(i,As);let l=0,u;const d=e.data,f=o.data;let p,g,x,w;if(e.kind===yx.GRAYSCALE_1BPP){const y=d.byteLength,m=new Uint32Array(f.buffer,0,f.byteLength>>2),v=m.length,b=i+7>>3,A=4294967295,S=on.isLittleEndian?4278190080:255;for(p=0;p<a;p++){for(x=p<r?As:s,u=0,g=0;g<x;g++){const C=y-l;let k=0;const L=C>b?i:C*8-7,D=L&-8;let j=0,P=0;for(;k<D;k+=8)P=d[l++],m[u++]=P&128?A:S,m[u++]=P&64?A:S,m[u++]=P&32?A:S,m[u++]=P&16?A:S,m[u++]=P&8?A:S,m[u++]=P&4?A:S,m[u++]=P&2?A:S,m[u++]=P&1?A:S;for(;k<L;k++)j===0&&(P=d[l++],j=128),m[u++]=P&j?A:S,j>>=1}for(;u<v;)m[u++]=0;n.putImageData(o,0,p*As)}}else if(e.kind===yx.RGBA_32BPP){for(g=0,w=i*As*4,p=0;p<r;p++)f.set(d.subarray(l,l+w)),l+=w,n.putImageData(o,0,g),g+=As;p<a&&(w=i*s*4,f.set(d.subarray(l,l+w)),n.putImageData(o,0,g))}else if(e.kind===yx.RGB_24BPP)for(x=As,w=i*x,p=0;p<a;p++){for(p>=r&&(x=s,w=i*x),u=0,g=w;g--;)f[u++]=d[l++],f[u++]=d[l++],f[u++]=d[l++],f[u++]=255;n.putImageData(o,0,p*As)}else throw new Error(`bad image kind: ${e.kind}`)}function eD(n,e){if(e.bitmap){n.drawImage(e.bitmap,0,0);return}const t=e.height,i=e.width,s=t%As,r=(t-s)/As,a=s===0?r:r+1,o=n.createImageData(i,As);let l=0;const u=e.data,d=o.data;for(let f=0;f<a;f++){const p=f<r?As:s;({srcPos:l}=MV({src:u,srcPos:l,dest:d,width:i,height:p,nonBlackColor:0})),n.putImageData(o,0,f*As)}}function Dg(n,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of t)n[i]!==void 0&&(e[i]=n[i]);n.setLineDash!==void 0&&(e.setLineDash(n.getLineDash()),e.lineDashOffset=n.lineDashOffset)}function Wv(n){n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0);const{filter:e}=n;e!=="none"&&e!==""&&(n.filter="none")}function tD(n,e){if(e)return!0;Ye.singularValueDecompose2dScale(n,er);const t=Math.fround(eo.pixelRatio*tu.PDF_TO_CSS_UNITS);return er[0]<=t&&er[1]<=t}const BV=["butt","round","square"],FV=["miter","round","bevel"],zV={},iD={};var ya,MA,OA,IA;const E_=class E_{constructor(e,t,i,s,r,{optionalContentConfig:a,markedContentStack:o=null},l,u,d){T(this,ya);this.ctx=e,this.current=new QT(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=i,this.canvasFactory=s,this.filterFactory=r,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=a,this.cachedCanvases=new PV(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=u,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=d??null}getObject(e,t,i=null){var s;return typeof t=="string"?((s=this.dependencyTracker)==null||s.recordNamedDependency(e,t),t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t)):i}beginDrawing({transform:e,viewport:t,transparency:i=!1,background:s=null}){const r=this.ctx.canvas.width,a=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=s||"#ffffff",this.ctx.fillRect(0,0,r,a),this.ctx.fillStyle=o,i){const l=this.cachedCanvases.getCanvas("transparent",r,a);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...Ci(this.compositeCtx))}this.ctx.save(),Wv(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=Ci(this.ctx)}executeOperatorList(e,t,i,s,r){var m;const a=e.argsArray,o=e.fnArray;let l=t||0;const u=a.length;if(u===l)return l;const d=u-l>ZT&&typeof i=="function",f=d?Date.now()+OV:0;let p=0;const g=this.commonObjs,x=this.objs;let w,y;for(;;){if(s!==void 0&&l===s.nextBreakPoint)return s.breakIt(l,i),l;if(!r||r(l))if(w=o[l],y=a[l]??null,w!==Ym.dependency)y===null?this[w](l):this[w](l,...y);else for(const v of y){(m=this.dependencyTracker)==null||m.recordNamedData(v,l);const b=v.startsWith("g_")?g:x;if(!b.has(v))return b.get(v,i),l}if(l++,l===u)return l;if(d&&++p>ZT){if(Date.now()>f)return i(),l;p=0}}}endDrawing(){R(this,ya,MA).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),R(this,ya,OA).call(this)}_scaleImage(e,t){const i=e.width??e.displayWidth,s=e.height??e.displayHeight;let r=Math.max(Math.hypot(t[0],t[1]),1),a=Math.max(Math.hypot(t[2],t[3]),1),o=i,l=s,u="prescale1",d,f;for(;r>2&&o>1||a>2&&l>1;){let p=o,g=l;r>2&&o>1&&(p=o>=16384?Math.floor(o/2)-1||1:Math.ceil(o/2),r/=o/p),a>2&&l>1&&(g=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,a/=l/g),d=this.cachedCanvases.getCanvas(u,p,g),f=d.context,f.clearRect(0,0,p,g),f.drawImage(e,0,0,o,l,0,0,p,g),e=d.canvas,o=p,l=g,u=u==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:o,paintHeight:l}}_createMaskCanvas(e,t){var j,P;const i=this.ctx,{width:s,height:r}=t,a=this.current.fillColor,o=this.current.patternFill,l=Ci(i);let u,d,f,p;if((t.bitmap||t.data)&&t.count>1){const H=t.bitmap||t.data.buffer;d=JSON.stringify(o?l:[l.slice(0,4),a]),u=this._cachedBitmapsMap.get(H),u||(u=new Map,this._cachedBitmapsMap.set(H,u));const G=u.get(d);if(G&&!o){const $=Math.round(Math.min(l[0],l[2])+l[4]),Y=Math.round(Math.min(l[1],l[3])+l[5]);return(j=this.dependencyTracker)==null||j.recordDependencies(e,yr.transformAndFill),{canvas:G,offsetX:$,offsetY:Y}}f=G}f||(p=this.cachedCanvases.getCanvas("maskCanvas",s,r),eD(p.context,t));let g=Ye.transform(l,[1/s,0,0,-1/r,0,0]);g=Ye.transform(g,[1,0,0,1,0,-r]);const x=Kd.slice();Ye.axialAlignedBoundingBox([0,0,s,r],g,x);const[w,y,m,v]=x,b=Math.round(m-w)||1,A=Math.round(v-y)||1,S=this.cachedCanvases.getCanvas("fillCanvas",b,A),C=S.context,k=w,L=y;C.translate(-k,-L),C.transform(...g),f||(f=this._scaleImage(p.canvas,ba(C)),f=f.img,u&&o&&u.set(d,f)),C.imageSmoothingEnabled=tD(Ci(C),t.interpolate),Yv(C,f,0,0,f.width,f.height,0,0,s,r),C.globalCompositeOperation="source-in";const D=Ye.transform(ba(C),[1,0,0,1,-k,-L]);return C.fillStyle=o?a.getPattern(i,this,D,jn.FILL,e):a,C.fillRect(0,0,s,r),u&&!o&&(this.cachedCanvases.delete("fillCanvas"),u.set(d,S.canvas)),(P=this.dependencyTracker)==null||P.recordDependencies(e,yr.transformAndFill),{canvas:S.canvas,offsetX:Math.round(k),offsetY:Math.round(L)}}setLineWidth(e,t){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("lineWidth",e),t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(e,t){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("lineCap",e),this.ctx.lineCap=BV[t]}setLineJoin(e,t){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("lineJoin",e),this.ctx.lineJoin=FV[t]}setMiterLimit(e,t){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("miterLimit",e),this.ctx.miterLimit=t}setDash(e,t,i){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("dash",e);const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(t),s.lineDashOffset=i)}setRenderingIntent(e,t){}setFlatness(e,t){}setGState(e,t){var i,s,r,a,o;for(const[l,u]of t)switch(l){case"LW":this.setLineWidth(e,u);break;case"LC":this.setLineCap(e,u);break;case"LJ":this.setLineJoin(e,u);break;case"ML":this.setMiterLimit(e,u);break;case"D":this.setDash(e,u[0],u[1]);break;case"RI":this.setRenderingIntent(e,u);break;case"FL":this.setFlatness(e,u);break;case"Font":this.setFont(e,u[0],u[1]);break;case"CA":(i=this.dependencyTracker)==null||i.recordSimpleData("strokeAlpha",e),this.current.strokeAlpha=u;break;case"ca":(s=this.dependencyTracker)==null||s.recordSimpleData("fillAlpha",e),this.ctx.globalAlpha=this.current.fillAlpha=u;break;case"BM":(r=this.dependencyTracker)==null||r.recordSimpleData("globalCompositeOperation",e),this.ctx.globalCompositeOperation=u;break;case"SMask":(a=this.dependencyTracker)==null||a.recordSimpleData("SMask",e),this.current.activeSMask=u?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":(o=this.dependencyTracker)==null||o.recordSimpleData("filter",e),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(u);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(e){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,i=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,r=this.cachedCanvases.getCanvas(s,t,i);this.suspendedCtx=this.ctx;const a=this.ctx=r.context;a.setTransform(this.suspendedCtx.getTransform()),Dg(this.suspendedCtx,a),IV(a,this.suspendedCtx),this.setGState(e,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Dg(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,i=this.suspendedCtx;this.composeSMask(i,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,i,s){const r=s[0],a=s[1],o=s[2]-r,l=s[3]-a;o===0||l===0||(this.genericComposeSMask(t.context,i,o,l,t.subtype,t.backdrop,t.transferMap,r,a,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(i.canvas,0,0),e.restore())}genericComposeSMask(e,t,i,s,r,a,o,l,u,d,f){let p=e.canvas,g=l-d,x=u-f;if(a)if(g<0||x<0||g+i>p.width||x+s>p.height){const y=this.cachedCanvases.getCanvas("maskExtension",i,s),m=y.context;m.drawImage(p,-g,-x),m.globalCompositeOperation="destination-atop",m.fillStyle=a,m.fillRect(0,0,i,s),m.globalCompositeOperation="source-over",p=y.canvas,g=x=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const y=new Path2D;y.rect(g,x,i,s),e.clip(y),e.globalCompositeOperation="destination-atop",e.fillStyle=a,e.fillRect(g,x,i,s),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),r==="Alpha"&&o?t.filter=this.filterFactory.addAlphaFilter(o):r==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(o));const w=new Path2D;w.rect(l,u,i,s),t.clip(w),t.globalCompositeOperation="destination-in",t.drawImage(p,g,x,i,s,l,u,i,s),t.restore()}save(e){var i;this.inSMaskMode&&Dg(this.ctx,this.suspendedCtx),this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone(),(i=this.dependencyTracker)==null||i.save(e)}restore(e){var t;if((t=this.dependencyTracker)==null||t.restore(e),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&Dg(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,i,s,r,a,o){var l;(l=this.dependencyTracker)==null||l.recordIncrementalData("transform",e),this.ctx.transform(t,i,s,r,a,o),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,i,s){let[r]=i;if(!s){r||(r=i[0]=new Path2D),this[t](e,r);return}if(this.dependencyTracker!==null){const a=t===Ym.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(e).recordBBox(e,this.ctx,s[0]-a,s[2]+a,s[1]-a,s[3]+a).recordDependencies(e,["transform"])}r instanceof Path2D||(r=i[0]=H4(r)),Ye.axialAlignedBoundingBox(s,Ci(this.ctx),this.current.minMax),this[t](e,r),this._pathStartIdx=e}closePath(e){this.ctx.closePath()}stroke(e,t,i=!0){var a;const s=this.ctx,r=this.current.strokeColor;if(s.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof r=="object"&&(r!=null&&r.getPattern)){const o=r.isModifyingCurrentTransform()?s.getTransform():null;if(s.save(),s.strokeStyle=r.getPattern(s,this,ba(s),jn.STROKE,e),o){const l=new Path2D;l.addPath(t,s.getTransform().invertSelf().multiplySelf(o)),t=l}this.rescaleAndStroke(t,!1),s.restore()}else this.rescaleAndStroke(t,!0);(a=this.dependencyTracker)==null||a.recordDependencies(e,yr.stroke),i&&this.consumePath(e,t,this.current.getClippedPathBoundingBox(jn.STROKE,Ci(this.ctx))),s.globalAlpha=this.current.fillAlpha}closeStroke(e,t){this.stroke(e,t)}fill(e,t,i=!0){var u,d,f;const s=this.ctx,r=this.current.fillColor,a=this.current.patternFill;let o=!1;if(a){const p=r.isModifyingCurrentTransform()?s.getTransform():null;if((u=this.dependencyTracker)==null||u.save(e),s.save(),s.fillStyle=r.getPattern(s,this,ba(s),jn.FILL,e),p){const g=new Path2D;g.addPath(t,s.getTransform().invertSelf().multiplySelf(p)),t=g}o=!0}const l=this.current.getClippedPathBoundingBox();this.contentVisible&&l!==null&&(this.pendingEOFill?(s.fill(t,"evenodd"),this.pendingEOFill=!1):s.fill(t)),(d=this.dependencyTracker)==null||d.recordDependencies(e,yr.fill),o&&(s.restore(),(f=this.dependencyTracker)==null||f.restore(e)),i&&this.consumePath(e,t,l)}eoFill(e,t){this.pendingEOFill=!0,this.fill(e,t)}fillStroke(e,t){this.fill(e,t,!1),this.stroke(e,t,!1),this.consumePath(e,t)}eoFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}closeFillStroke(e,t){this.fillStroke(e,t)}closeEOFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}endPath(e,t){this.consumePath(e,t)}rawFillPath(e,t){var i;this.ctx.fill(t),(i=this.dependencyTracker)==null||i.recordDependencies(e,yr.rawFillPath).recordOperation(e)}clip(e){var t;(t=this.dependencyTracker)==null||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=zV}eoClip(e){var t;(t=this.dependencyTracker)==null||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=iD}beginText(e){var t;this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,(t=this.dependencyTracker)==null||t.recordOpenMarker(e).resetIncrementalData("sameLineText").resetIncrementalData("moveText",e)}endText(e){const t=this.pendingTextPaths,i=this.ctx;if(this.dependencyTracker){const{dependencyTracker:s}=this;t!==void 0&&s.recordFutureForcedDependency("textClip",s.getOpenMarker()).recordFutureForcedDependency("textClip",e),s.recordCloseMarker(e)}if(t!==void 0){const s=new Path2D,r=i.getTransform().invertSelf();for(const{transform:a,x:o,y:l,fontSize:u,path:d}of t)d&&s.addPath(d,new DOMMatrix(a).preMultiplySelf(r).translate(o,l).scale(u,-u));i.clip(s)}delete this.pendingTextPaths}setCharSpacing(e,t){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("charSpacing",e),this.current.charSpacing=t}setWordSpacing(e,t){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("wordSpacing",e),this.current.wordSpacing=t}setHScale(e,t){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("hScale",e),this.current.textHScale=t/100}setLeading(e,t){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("leading",e),this.current.leading=-t}setFont(e,t,i){var f,p;(f=this.dependencyTracker)==null||f.recordSimpleData("font",e).recordSimpleDataFromNamed("fontObj",t,e);const s=this.commonObjs.get(t),r=this.current;if(!s)throw new Error(`Can't find font for ${t}`);if(r.fontMatrix=s.fontMatrix||iA,(r.fontMatrix[0]===0||r.fontMatrix[3]===0)&&ct("Invalid font matrix for font "+t),i<0?(i=-i,r.fontDirection=-1):r.fontDirection=1,this.current.font=s,this.current.fontSize=i,s.isType3Font)return;const a=s.loadedName||"sans-serif",o=((p=s.systemFontInfo)==null?void 0:p.css)||`"${a}", ${s.fallbackName}`;let l="normal";s.black?l="900":s.bold&&(l="bold");const u=s.italic?"italic":"normal";let d=i;i<XT?d=XT:i>KT&&(d=KT),this.current.fontSizeScale=i/d,this.ctx.font=`${u} ${l} ${d}px ${o}`}setTextRenderingMode(e,t){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("textRenderingMode",e),this.current.textRenderingMode=t}setTextRise(e,t){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("textRise",e),this.current.textRise=t}moveText(e,t,i){var s;(s=this.dependencyTracker)==null||s.resetIncrementalData("sameLineText").recordIncrementalData("moveText",e),this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=i}setLeadingMoveText(e,t,i){this.setLeading(e,-i),this.moveText(e,t,i)}setTextMatrix(e,t){var s;(s=this.dependencyTracker)==null||s.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",e);const{current:i}=this;i.textMatrix=t,i.textMatrixScale=Math.hypot(t[0],t[1]),i.x=i.lineX=0,i.y=i.lineY=0}nextLine(e){var t;this.moveText(e,0,this.current.leading),(t=this.dependencyTracker)==null||t.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??e)}paintChar(e,t,i,s,r,a){var m,v,b,A;const o=this.ctx,l=this.current,u=l.font,d=l.textRenderingMode,f=l.fontSize/l.fontSizeScale,p=d&tn.FILL_STROKE_MASK,g=!!(d&tn.ADD_TO_PATH_FLAG),x=l.patternFill&&!u.missingFile,w=l.patternStroke&&!u.missingFile;let y;if((u.disableFontFace||g||x||w)&&!u.missingFile&&(y=u.getPathGenerator(this.commonObjs,t)),y&&(u.disableFontFace||x||w)){o.save(),o.translate(i,s),o.scale(f,-f),(m=this.dependencyTracker)==null||m.recordCharacterBBox(e,o,u);let S;if(p===tn.FILL||p===tn.FILL_STROKE)if(r){S=o.getTransform(),o.setTransform(...r);const C=R(this,ya,IA).call(this,y,S,r);o.fill(C)}else o.fill(y);if(p===tn.STROKE||p===tn.FILL_STROKE)if(a){S||(S=o.getTransform()),o.setTransform(...a);const{a:C,b:k,c:L,d:D}=S,j=Ye.inverseTransform(a),P=Ye.transform([C,k,L,D,0,0],j);Ye.singularValueDecompose2dScale(P,er),o.lineWidth*=Math.max(er[0],er[1])/f,o.stroke(R(this,ya,IA).call(this,y,S,a))}else o.lineWidth/=f,o.stroke(y);o.restore()}else(p===tn.FILL||p===tn.FILL_STROKE)&&(o.fillText(t,i,s),(v=this.dependencyTracker)==null||v.recordCharacterBBox(e,o,u,f,i,s,()=>o.measureText(t))),(p===tn.STROKE||p===tn.FILL_STROKE)&&(this.dependencyTracker&&((b=this.dependencyTracker)==null||b.recordCharacterBBox(e,o,u,f,i,s,()=>o.measureText(t)).recordDependencies(e,yr.stroke)),o.strokeText(t,i,s));g&&((this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:Ci(o),x:i,y:s,fontSize:f,path:y}),(A=this.dependencyTracker)==null||A.recordCharacterBBox(e,o,u,f,i,s))}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let i=!1;for(let s=3;s<t.length;s+=4)if(t[s]>0&&t[s]<255){i=!0;break}return ut(this,"isFontSubpixelAAEnabled",i)}showText(e,t){var P,H,G,$;this.dependencyTracker&&(this.dependencyTracker.recordDependencies(e,yr.showText).resetBBox(e),this.current.textRenderingMode&tn.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",e).inheritPendingDependenciesAsFutureForcedDependencies());const i=this.current,s=i.font;if(s.isType3Font){this.showType3Text(e,t),(P=this.dependencyTracker)==null||P.recordShowTextOperation(e);return}const r=i.fontSize;if(r===0){(H=this.dependencyTracker)==null||H.recordOperation(e);return}const a=this.ctx,o=i.fontSizeScale,l=i.charSpacing,u=i.wordSpacing,d=i.fontDirection,f=i.textHScale*d,p=t.length,g=s.vertical,x=g?1:-1,w=s.defaultVMetrics,y=r*i.fontMatrix[0],m=i.textRenderingMode===tn.FILL&&!s.disableFontFace&&!i.patternFill;a.save(),i.textMatrix&&a.transform(...i.textMatrix),a.translate(i.x,i.y+i.textRise),d>0?a.scale(f,-1):a.scale(f,1);let v,b;const A=i.textRenderingMode&tn.FILL_STROKE_MASK,S=A===tn.FILL||A===tn.FILL_STROKE,C=A===tn.STROKE||A===tn.FILL_STROKE;if(S&&i.patternFill){a.save();const Y=i.fillColor.getPattern(a,this,ba(a),jn.FILL,e);v=Ci(a),a.restore(),a.fillStyle=Y}if(C&&i.patternStroke){a.save();const Y=i.strokeColor.getPattern(a,this,ba(a),jn.STROKE,e);b=Ci(a),a.restore(),a.strokeStyle=Y}let k=i.lineWidth;const L=i.textMatrixScale;if(L===0||k===0?C&&(k=this.getSinglePixelWidth()):k/=L,o!==1&&(a.scale(o,o),k/=o),a.lineWidth=k,s.isInvalidPDFjsFont){const Y=[];let F=0;for(const I of t)Y.push(I.unicode),F+=I.width;const M=Y.join("");if(a.fillText(M,0,0),this.dependencyTracker!==null){const I=a.measureText(M);this.dependencyTracker.recordBBox(e,this.ctx,-I.actualBoundingBoxLeft,I.actualBoundingBoxRight,-I.actualBoundingBoxAscent,I.actualBoundingBoxDescent).recordShowTextOperation(e)}i.x+=F*y*f,a.restore(),this.compose();return}let D=0,j;for(j=0;j<p;++j){const Y=t[j];if(typeof Y=="number"){D+=x*Y*r/1e3;continue}let F=!1;const M=(Y.isSpace?u:0)+l,I=Y.fontChar,V=Y.accent;let ie,ge,ee=Y.width;if(g){const ae=Y.vmetric||w,Z=-(Y.vmetric?ae[1]:ee*.5)*y,re=ae[2]*y;ee=ae?-ae[0]:ee,ie=Z/o,ge=(D+re)/o}else ie=D/o,ge=0;let me;if(s.remeasure&&ee>0){me=a.measureText(I);const ae=me.width*1e3/r*o;if(ee<ae&&this.isFontSubpixelAAEnabled){const Z=ee/ae;F=!0,a.save(),a.scale(Z,1),ie/=Z}else ee!==ae&&(ie+=(ee-ae)/2e3*r/o)}if(this.contentVisible&&(Y.isInFont||s.missingFile)){if(m&&!V)a.fillText(I,ie,ge),(G=this.dependencyTracker)==null||G.recordCharacterBBox(e,a,me?{bbox:null}:s,r/o,ie,ge,()=>me??a.measureText(I));else if(this.paintChar(e,I,ie,ge,v,b),V){const ae=ie+r*V.offset.x/o,Z=ge-r*V.offset.y/o;this.paintChar(e,V.fontChar,ae,Z,v,b)}}const oe=g?ee*y-M*d:ee*y+M*d;D+=oe,F&&a.restore()}g?i.y-=D:i.x+=D*f,a.restore(),this.compose(),($=this.dependencyTracker)==null||$.recordShowTextOperation(e)}showType3Text(e,t){const i=this.ctx,s=this.current,r=s.font,a=s.fontSize,o=s.fontDirection,l=r.vertical?1:-1,u=s.charSpacing,d=s.wordSpacing,f=s.textHScale*o,p=s.fontMatrix||iA,g=t.length,x=s.textRenderingMode===tn.INVISIBLE;let w,y,m,v;if(x||a===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,i.save(),s.textMatrix&&i.transform(...s.textMatrix),i.translate(s.x,s.y+s.textRise),i.scale(f,o);const b=this.dependencyTracker;for(this.dependencyTracker=b?new Jb(b,e):null,w=0;w<g;++w){if(y=t[w],typeof y=="number"){v=l*y*a/1e3,this.ctx.translate(v,0),s.x+=v*f;continue}const A=(y.isSpace?d:0)+u,S=r.charProcOperatorList[y.operatorListId];S?this.contentVisible&&(this.save(),i.scale(a,a),i.transform(...p),this.executeOperatorList(S),this.restore()):ct(`Type3 character "${y.operatorListId}" is not available.`);const C=[y.width,0];Ye.applyTransform(C,p),m=C[0]*a+A,i.translate(m,0),s.x+=m*f}i.restore(),b&&(this.dependencyTracker=b)}setCharWidth(e,t,i){}setCharWidthAndBounds(e,t,i,s,r,a,o){var u;const l=new Path2D;l.rect(s,r,a-s,o-r),this.ctx.clip(l),(u=this.dependencyTracker)==null||u.recordBBox(e,this.ctx,s,a,r,o).recordClipBox(e,this.ctx,s,a,r,o),this.endPath(e)}getColorN_Pattern(e,t){let i;if(t[0]==="TilingPattern"){const s=this.baseTransform||Ci(this.ctx),r={createCanvasGraphics:(a,o)=>new E_(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new Jb(this.dependencyTracker,o,!0):null)};i=new LA(t,this.ctx,r,s)}else i=this._getPattern(e,t[1],t[2]);return i}setStrokeColorN(e,...t){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("strokeColor",e),this.current.strokeColor=this.getColorN_Pattern(e,t),this.current.patternStroke=!0}setFillColorN(e,...t){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("fillColor",e),this.current.fillColor=this.getColorN_Pattern(e,t),this.current.patternFill=!0}setStrokeRGBColor(e,t){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(e){var t;(t=this.dependencyTracker)==null||t.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(e){var t;(t=this.dependencyTracker)==null||t.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t,i=null){let s;return this.cachedPatterns.has(t)?s=this.cachedPatterns.get(t):(s=LV(this.getObject(e,t)),this.cachedPatterns.set(t,s)),i&&(s.matrix=i),s}shadingFill(e,t){var a;if(!this.contentVisible)return;const i=this.ctx;this.save(e);const s=this._getPattern(e,t);i.fillStyle=s.getPattern(i,this,ba(i),jn.SHADING,e);const r=ba(i);if(r){const{width:o,height:l}=i.canvas,u=Kd.slice();Ye.axialAlignedBoundingBox([0,0,o,l],r,u);const[d,f,p,g]=u;this.ctx.fillRect(d,f,p-d,g-f)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);(a=this.dependencyTracker)==null||a.resetBBox(e).recordFullPageBBox(e).recordDependencies(e,yr.transform).recordDependencies(e,yr.fill).recordOperation(e),this.compose(this.current.getClippedPathBoundingBox()),this.restore(e)}beginInlineImage(){zt("Should not call beginInlineImage")}beginImageData(){zt("Should not call beginImageData")}paintFormXObjectBegin(e,t,i){var s;if(this.contentVisible&&(this.save(e),this.baseTransformStack.push(this.baseTransform),t&&this.transform(e,...t),this.baseTransform=Ci(this.ctx),i)){Ye.axialAlignedBoundingBox(i,this.baseTransform,this.current.minMax);const[r,a,o,l]=i,u=new Path2D;u.rect(r,a,o-r,l-a),this.ctx.clip(u),(s=this.dependencyTracker)==null||s.recordClipBox(e,this.ctx,r,o,a,l),this.endPath(e)}}paintFormXObjectEnd(e){this.contentVisible&&(this.restore(e),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e,t){var b;if(!this.contentVisible)return;this.save(e),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const i=this.ctx;t.isolated||cw("TODO: Support non-isolated groups."),t.knockout&&ct("Knockout groups not supported.");const s=Ci(i);if(t.matrix&&i.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let r=Kd.slice();Ye.axialAlignedBoundingBox(t.bbox,Ci(i),r);const a=[0,0,i.canvas.width,i.canvas.height];r=Ye.intersect(r,a)||[0,0,0,0];const o=Math.floor(r[0]),l=Math.floor(r[1]),u=Math.max(Math.ceil(r[2])-o,1),d=Math.max(Math.ceil(r[3])-l,1);this.current.startNewPathAndClipBox([0,0,u,d]);let f="groupAt"+this.groupLevel;t.smask&&(f+="_smask_"+this.smaskCounter++%2);const p=this.cachedCanvases.getCanvas(f,u,d),g=p.context;g.translate(-o,-l),g.transform(...s);let x=new Path2D;const[w,y,m,v]=t.bbox;if(x.rect(w,y,m-w,v-y),t.matrix){const A=new Path2D;A.addPath(x,new DOMMatrix(t.matrix)),x=A}g.clip(x),t.smask&&this.smaskStack.push({canvas:p.canvas,context:g,offsetX:o,offsetY:l,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}),(!t.smask||this.dependencyTracker)&&(i.setTransform(1,0,0,1,0,0),i.translate(o,l),i.save()),Dg(i,g),this.ctx=g,(b=this.dependencyTracker)==null||b.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(i),this.setGState(e,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(i),this.groupLevel++}endGroup(e,t){var r;if(!this.contentVisible)return;this.groupLevel--;const i=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,(r=this.dependencyTracker)==null||r.popBaseTransform(),t.smask)this.tempSMask=this.smaskStack.pop(),this.restore(e),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const a=Ci(this.ctx);this.restore(e),this.ctx.save(),this.ctx.setTransform(...a);const o=Kd.slice();Ye.axialAlignedBoundingBox([0,0,i.canvas.width,i.canvas.height],a,o),this.ctx.drawImage(i.canvas,0,0),this.ctx.restore(),this.compose(o)}}beginAnnotation(e,t,i,s,r,a){if(R(this,ya,MA).call(this),Wv(this.ctx),this.ctx.save(),this.save(e),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),i){const o=i[2]-i[0],l=i[3]-i[1];if(a&&this.annotationCanvasMap){s=s.slice(),s[4]-=i[0],s[5]-=i[1],i=i.slice(),i[0]=i[1]=0,i[2]=o,i[3]=l,Ye.singularValueDecompose2dScale(Ci(this.ctx),er);const{viewportScale:u}=this,d=Math.ceil(o*this.outputScaleX*u),f=Math.ceil(l*this.outputScaleY*u);this.annotationCanvas=this.canvasFactory.create(d,f);const{canvas:p,context:g}=this.annotationCanvas;this.annotationCanvasMap.set(t,p),this.annotationCanvas.savedCtx=this.ctx,this.ctx=g,this.ctx.save(),this.ctx.setTransform(er[0],0,0,-er[1],0,l*er[1]),Wv(this.ctx)}else{Wv(this.ctx),this.endPath(e);const u=new Path2D;u.rect(i[0],i[1],o,l),this.ctx.clip(u)}}this.current=new QT(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(e,...s),this.transform(e,...r)}endAnnotation(e){this.annotationCanvas&&(this.ctx.restore(),R(this,ya,OA).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e,t){var o;if(!this.contentVisible)return;const i=t.count;t=this.getObject(e,t.data,t),t.count=i;const s=this.ctx,r=this._createMaskCanvas(e,t),a=r.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(a,r.offsetX,r.offsetY),(o=this.dependencyTracker)==null||o.resetBBox(e).recordBBox(e,this.ctx,r.offsetX,r.offsetX+a.width,r.offsetY,r.offsetY+a.height).recordOperation(e),s.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,i,s=0,r=0,a,o){var f,p,g;if(!this.contentVisible)return;t=this.getObject(e,t.data,t);const l=this.ctx;l.save();const u=Ci(l);l.transform(i,s,r,a,0,0);const d=this._createMaskCanvas(e,t);l.setTransform(1,0,0,1,d.offsetX-u[4],d.offsetY-u[5]),(f=this.dependencyTracker)==null||f.resetBBox(e);for(let x=0,w=o.length;x<w;x+=2){const y=Ye.transform(u,[i,s,r,a,o[x],o[x+1]]);l.drawImage(d.canvas,y[4],y[5]),(p=this.dependencyTracker)==null||p.recordBBox(e,this.ctx,y[4],y[4]+d.canvas.width,y[5],y[5]+d.canvas.height)}l.restore(),this.compose(),(g=this.dependencyTracker)==null||g.recordOperation(e)}paintImageMaskXObjectGroup(e,t){var a,o,l;if(!this.contentVisible)return;const i=this.ctx,s=this.current.fillColor,r=this.current.patternFill;(a=this.dependencyTracker)==null||a.resetBBox(e).recordDependencies(e,yr.transformAndFill);for(const u of t){const{data:d,width:f,height:p,transform:g}=u,x=this.cachedCanvases.getCanvas("maskCanvas",f,p),w=x.context;w.save();const y=this.getObject(e,d,u);eD(w,y),w.globalCompositeOperation="source-in",w.fillStyle=r?s.getPattern(w,this,ba(i),jn.FILL,e):s,w.fillRect(0,0,f,p),w.restore(),i.save(),i.transform(...g),i.scale(1,-1),Yv(i,x.canvas,0,0,f,p,0,-1,1,1),(o=this.dependencyTracker)==null||o.recordBBox(e,i,0,f,0,p),i.restore()}this.compose(),(l=this.dependencyTracker)==null||l.recordOperation(e)}paintImageXObject(e,t){if(!this.contentVisible)return;const i=this.getObject(e,t);if(!i){ct("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e,i)}paintImageXObjectRepeat(e,t,i,s,r){if(!this.contentVisible)return;const a=this.getObject(e,t);if(!a){ct("Dependent image isn't ready yet");return}const o=a.width,l=a.height,u=[];for(let d=0,f=r.length;d<f;d+=2)u.push({transform:[i,0,0,s,r[d],r[d+1]],x:0,y:0,w:o,h:l});this.paintInlineImageXObjectGroup(e,a,u)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:i,height:s}=e,r=this.cachedCanvases.getCanvas("inlineImage",i,s),a=r.context;return a.filter=this.current.transferMaps,a.drawImage(t,0,0),a.filter="none",r.canvas}paintInlineImageXObject(e,t){var u;if(!this.contentVisible)return;const i=t.width,s=t.height,r=this.ctx;this.save(e);const{filter:a}=r;a!=="none"&&a!==""&&(r.filter="none"),r.scale(1/i,-1/s);let o;if(t.bitmap)o=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)o=t;else{const f=this.cachedCanvases.getCanvas("inlineImage",i,s).context;JT(f,t),o=this.applyTransferMapsToCanvas(f)}const l=this._scaleImage(o,ba(r));r.imageSmoothingEnabled=tD(Ci(r),t.interpolate),(u=this.dependencyTracker)==null||u.resetBBox(e).recordBBox(e,r,0,i,-s,0).recordDependencies(e,yr.imageXObject).recordOperation(e),Yv(r,l.img,0,0,l.paintWidth,l.paintHeight,0,-s,i,s),this.compose(),this.restore(e)}paintInlineImageXObjectGroup(e,t,i){var a,o,l;if(!this.contentVisible)return;const s=this.ctx;let r;if(t.bitmap)r=t.bitmap;else{const u=t.width,d=t.height,p=this.cachedCanvases.getCanvas("inlineImage",u,d).context;JT(p,t),r=this.applyTransferMapsToCanvas(p)}(a=this.dependencyTracker)==null||a.resetBBox(e);for(const u of i)s.save(),s.transform(...u.transform),s.scale(1,-1),Yv(s,r,u.x,u.y,u.w,u.h,0,-1,1,1),(o=this.dependencyTracker)==null||o.recordBBox(e,s,0,1,-1,0),s.restore();(l=this.dependencyTracker)==null||l.recordOperation(e),this.compose()}paintSolidColorImageMask(e){var t;this.contentVisible&&((t=this.dependencyTracker)==null||t.resetBBox(e).recordBBox(e,this.ctx,0,1,0,1).recordDependencies(e,yr.fill).recordOperation(e),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e,t){}markPointProps(e,t,i){}beginMarkedContent(e,t){var i;(i=this.dependencyTracker)==null||i.beginMarkedContent(e),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t,i){var s;(s=this.dependencyTracker)==null||s.beginMarkedContent(e),t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(i)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(e){var t;(t=this.dependencyTracker)==null||t.endMarkedContent(e),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(e){}endCompat(e){}consumePath(e,t,i){var a,o;const s=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(i);const r=this.ctx;this.pendingClip?(s||(this.pendingClip===iD?r.clip(t,"evenodd"):r.clip(t)),this.pendingClip=null,(a=this.dependencyTracker)==null||a.bboxToClipBoxDropOperation(e).recordFutureForcedDependency("clipPath",e)):(o=this.dependencyTracker)==null||o.recordOperation(e),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=Ci(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),i=Math.hypot(e[0],e[2]),s=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(i,s)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:i,c:s,d:r}=this.ctx.getTransform();let a,o;if(i===0&&s===0){const l=Math.abs(t),u=Math.abs(r);if(l===u)if(e===0)a=o=1/l;else{const d=l*e;a=o=d<1?1/d:1}else if(e===0)a=1/l,o=1/u;else{const d=l*e,f=u*e;a=d<1?1/d:1,o=f<1?1/f:1}}else{const l=Math.abs(t*r-i*s),u=Math.hypot(t,i),d=Math.hypot(s,r);if(e===0)a=d/l,o=u/l;else{const f=e*l;a=d>f?d/f:1,o=u>f?u/f:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:i,current:{lineWidth:s}}=this,[r,a]=this.getScaleForStroking();if(r===a){i.lineWidth=(s||1)*r,i.stroke(e);return}const o=i.getLineDash();t&&i.save(),i.scale(r,a),L2.a=1/r,L2.d=1/a;const l=new Path2D;if(l.addPath(e,L2),o.length>0){const u=Math.max(r,a);i.setLineDash(o.map(d=>d/u)),i.lineDashOffset/=u}i.lineWidth=s||1,i.stroke(l),t&&i.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};ya=new WeakSet,MA=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},OA=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},IA=function(e,t,i){const s=new Path2D;return s.addPath(e,new DOMMatrix(i).invertSelf().multiplySelf(t)),s};let uf=E_;for(const n in Ym)uf.prototype[n]!==void 0&&(uf.prototype[Ym[n]]=uf.prototype[n]);var B0,F0;class pa{static get workerPort(){return c(this,B0)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");_(this,B0,e)}static get workerSrc(){return c(this,F0)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");_(this,F0,e)}}B0=new WeakMap,F0=new WeakMap,T(pa,B0,null),T(pa,F0,"");var Wf,z0;class UV{constructor({parsedData:e,rawData:t}){T(this,Wf);T(this,z0);_(this,Wf,e),_(this,z0,t)}getRaw(){return c(this,z0)}get(e){return c(this,Wf).get(e)??null}[Symbol.iterator](){return c(this,Wf).entries()}}Wf=new WeakMap,z0=new WeakMap;const Ld=Symbol("INTERNAL");var U0,H0,$0,Xf;class HV{constructor(e,{name:t,intent:i,usage:s,rbGroups:r}){T(this,U0,!1);T(this,H0,!1);T(this,$0,!1);T(this,Xf,!0);_(this,U0,!!(e&Qs.DISPLAY)),_(this,H0,!!(e&Qs.PRINT)),this.name=t,this.intent=i,this.usage=s,this.rbGroups=r}get visible(){if(c(this,$0))return c(this,Xf);if(!c(this,Xf))return!1;const{print:e,view:t}=this.usage;return c(this,U0)?(t==null?void 0:t.viewState)!=="OFF":c(this,H0)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,i=!1){e!==Ld&&zt("Internal method `_setVisible` called."),_(this,$0,i),_(this,Xf,t)}}U0=new WeakMap,H0=new WeakMap,$0=new WeakMap,Xf=new WeakMap;var cc,ti,Kf,Zf,q0,PA;class $V{constructor(e,t=Qs.DISPLAY){T(this,q0);T(this,cc,null);T(this,ti,new Map);T(this,Kf,null);T(this,Zf,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,_(this,Zf,e.order);for(const i of e.groups)c(this,ti).set(i.id,new HV(t,i));if(e.baseState==="OFF")for(const i of c(this,ti).values())i._setVisible(Ld,!1);for(const i of e.on)c(this,ti).get(i)._setVisible(Ld,!0);for(const i of e.off)c(this,ti).get(i)._setVisible(Ld,!1);_(this,Kf,this.getHash())}}isVisible(e){if(c(this,ti).size===0)return!0;if(!e)return cw("Optional content group not defined."),!0;if(e.type==="OCG")return c(this,ti).has(e.id)?c(this,ti).get(e.id).visible:(ct(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return R(this,q0,PA).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!c(this,ti).has(t))return ct(`Optional content group not found: ${t}`),!0;if(c(this,ti).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!c(this,ti).has(t))return ct(`Optional content group not found: ${t}`),!0;if(!c(this,ti).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!c(this,ti).has(t))return ct(`Optional content group not found: ${t}`),!0;if(!c(this,ti).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!c(this,ti).has(t))return ct(`Optional content group not found: ${t}`),!0;if(c(this,ti).get(t).visible)return!1}return!0}return ct(`Unknown optional content policy ${e.policy}.`),!0}return ct(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,i=!0){var r;const s=c(this,ti).get(e);if(!s){ct(`Optional content group not found: ${e}`);return}if(i&&t&&s.rbGroups.length)for(const a of s.rbGroups)for(const o of a)o!==e&&((r=c(this,ti).get(o))==null||r._setVisible(Ld,!1,!0));s._setVisible(Ld,!!t,!0),_(this,cc,null)}setOCGState({state:e,preserveRB:t}){let i;for(const s of e){switch(s){case"ON":case"OFF":case"Toggle":i=s;continue}const r=c(this,ti).get(s);if(r)switch(i){case"ON":this.setVisibility(s,!0,t);break;case"OFF":this.setVisibility(s,!1,t);break;case"Toggle":this.setVisibility(s,!r.visible,t);break}}_(this,cc,null)}get hasInitialVisibility(){return c(this,Kf)===null||this.getHash()===c(this,Kf)}getOrder(){return c(this,ti).size?c(this,Zf)?c(this,Zf).slice():[...c(this,ti).keys()]:null}getGroup(e){return c(this,ti).get(e)||null}getHash(){if(c(this,cc)!==null)return c(this,cc);const e=new SL;for(const[t,i]of c(this,ti))e.update(`${t}:${i.visible}`);return _(this,cc,e.hexdigest())}[Symbol.iterator](){return c(this,ti).entries()}}cc=new WeakMap,ti=new WeakMap,Kf=new WeakMap,Zf=new WeakMap,q0=new WeakSet,PA=function(e){const t=e.length;if(t<2)return!0;const i=e[0];for(let s=1;s<t;s++){const r=e[s];let a;if(Array.isArray(r))a=R(this,q0,PA).call(this,r);else if(c(this,ti).has(r))a=c(this,ti).get(r).visible;else return ct(`Optional content group not found: ${r}`),!0;switch(i){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return i==="And"};var V0,G0;class fw{constructor(e,t,i){T(this,V0,null);T(this,G0,null);fe(this,"_fullReader",null);fe(this,"_rangeReaders",new Set);fe(this,"_source",null);this._source=e,_(this,V0,t),_(this,G0,i)}get _progressiveDataLength(){var e;return((e=this._fullReader)==null?void 0:e._loaded)??0}getFullReader(){return Bt(!this._fullReader,"BasePDFStream.getFullReader can only be called once."),this._fullReader=new(c(this,V0))(this)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new(c(this,G0))(this,e,t);return this._rangeReaders.add(i),i}cancelAllRequests(e){var t;(t=this._fullReader)==null||t.cancel(e);for(const i of new Set(this._rangeReaders))i.cancel(e)}}V0=new WeakMap,G0=new WeakMap;class pw{constructor(e){fe(this,"onProgress",null);fe(this,"_contentLength",0);fe(this,"_filename",null);fe(this,"_headersCapability",Promise.withResolvers());fe(this,"_isRangeSupported",!1);fe(this,"_isStreamingSupported",!1);fe(this,"_loaded",0);fe(this,"_stream",null);this._stream=e}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){zt("Abstract method `read` called")}cancel(e){zt("Abstract method `cancel` called")}}class gw{constructor(e,t,i){fe(this,"_stream",null);this._stream=e}async read(){zt("Abstract method `read` called")}cancel(e){zt("Abstract method `cancel` called")}}function nD(n){return n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength?n.buffer:new Uint8Array(n).buffer}var Y0,BA;class qV extends fw{constructor(t){super(t,VV,GV);T(this,Y0);fe(this,"_progressiveDone",!1);fe(this,"_queuedChunks",[]);const{pdfDataRangeTransport:i}=t,{initialData:s,progressiveDone:r}=i;if((s==null?void 0:s.length)>0){const a=nD(s);this._queuedChunks.push(a)}this._progressiveDone=r,i.addRangeListener((a,o)=>{R(this,Y0,BA).call(this,a,o)}),i.addProgressListener((a,o)=>{var l,u;o!==void 0&&((u=(l=this._fullReader)==null?void 0:l.onProgress)==null||u.call(l,{loaded:a,total:o}))}),i.addProgressiveReadListener(a=>{R(this,Y0,BA).call(this,void 0,a)}),i.addProgressiveDoneListener(()=>{var a;(a=this._fullReader)==null||a.progressiveDone(),this._progressiveDone=!0}),i.transportReady()}getFullReader(){const t=super.getFullReader();return this._queuedChunks=null,t}getRangeReader(t,i){const s=super.getRangeReader(t,i);return s&&(s.onDone=()=>this._rangeReaders.delete(s),this._source.pdfDataRangeTransport.requestDataRange(t,i)),s}cancelAllRequests(t){super.cancelAllRequests(t),this._source.pdfDataRangeTransport.abort()}}Y0=new WeakSet,BA=function(t,i){const s=nD(i);if(t===void 0)this._fullReader?this._fullReader._enqueue(s):this._queuedChunks.push(s);else{const r=this._rangeReaders.keys().find(a=>a._begin===t);Bt(r,"#onReceiveData - no `PDFDataTransportStreamRangeReader` instance found."),r._enqueue(s)}};class VV extends pw{constructor(t){super(t);fe(this,"_done",!1);fe(this,"_queuedChunks",null);fe(this,"_requests",[]);const{pdfDataRangeTransport:i,disableRange:s,disableStream:r}=t._source,{length:a,contentDispositionFilename:o}=i;this._queuedChunks=t._queuedChunks||[];for(const l of this._queuedChunks)this._loaded+=l.byteLength;this._done=t._progressiveDone,this._contentLength=a,this._isStreamingSupported=!r,this._isRangeSupported=!s,d_(o)&&(this._filename=o),this._headersCapability.resolve()}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class GV extends gw{constructor(t,i,s){super(t,i,s);fe(this,"onDone",null);fe(this,"_begin",-1);fe(this,"_done",!1);fe(this,"_queuedChunk",null);fe(this,"_requests",[]);this._begin=i}_enqueue(t){var i;if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,(i=this.onDone)==null||i.call(this)}}async read(){if(this._queuedChunk){const i=this._queuedChunk;return this._queuedChunk=null,{value:i,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){var i;this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,(i=this.onDone)==null||i.call(this)}}function YV(n){let e=!0,t=i("filename\\*","i").exec(n);if(t){t=t[1];let d=o(t);return d=unescape(d),d=l(d),d=u(d),r(d)}if(t=a(n),t){const d=u(t);return r(d)}if(t=i("filename","i").exec(n),t){t=t[1];let d=o(t);return d=u(d),r(d)}function i(d,f){return new RegExp("(?:^|;)\\s*"+d+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',f)}function s(d,f){if(d){if(!/^[\x00-\xFF]+$/.test(f))return f;try{const p=new TextDecoder(d,{fatal:!0}),g=uw(f);f=p.decode(g),e=!1}catch{}}return f}function r(d){return e&&/[\x80-\xff]/.test(d)&&(d=s("utf-8",d),e&&(d=s("iso-8859-1",d))),d}function a(d){const f=[];let p;const g=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(p=g.exec(d))!==null;){let[,w,y,m]=p;if(w=parseInt(w,10),w in f){if(w===0)break;continue}f[w]=[y,m]}const x=[];for(let w=0;w<f.length&&w in f;++w){let[y,m]=f[w];m=o(m),y&&(m=unescape(m),w===0&&(m=l(m))),x.push(m)}return x.join("")}function o(d){if(d.startsWith('"')){const f=d.slice(1).split('\\"');for(let p=0;p<f.length;++p){const g=f[p].indexOf('"');g!==-1&&(f[p]=f[p].slice(0,g),f.length=p+1),f[p]=f[p].replaceAll(/\\(.)/g,"$1")}d=f.join('"')}return d}function l(d){const f=d.indexOf("'");if(f===-1)return d;const p=d.slice(0,f),x=d.slice(f+1).replace(/^[^']*'/,"");return s(p,x)}function u(d){return!d.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(d)?d:d.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(f,p,g,x){if(g==="q"||g==="Q")return x=x.replaceAll("_"," "),x=x.replaceAll(/=([0-9a-fA-F]{2})/g,function(w,y){return String.fromCharCode(parseInt(y,16))}),s(p,x);try{x=atob(x)}catch{}return s(p,x)})}return""}function ML(n,e){const t=new Headers;if(!n||!e||typeof e!="object")return t;for(const i in e){const s=e[i];s!==void 0&&t.append(i,s)}return t}function mw(n){var e;return((e=URL.parse(n))==null?void 0:e.origin)??null}function OL({responseHeaders:n,isHttp:e,rangeChunkSize:t,disableRange:i}){const s={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(n.get("Content-Length"),10);return!Number.isInteger(r)||(s.suggestedLength=r,r<=2*t)||i||!e||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(s.allowRangeRequests=!0),s}function IL(n){const e=n.get("Content-Disposition");if(e){let t=YV(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(d_(t))return t}return null}function yw(n,e){return new Yb(`Unexpected server response (${n}) while retrieving PDF "${e}".`,n,n===404||n===0&&e.startsWith("file:"))}function PL(n,e){if(n!==e)throw new Error(`Expected range response-origin "${n}" to match "${e}".`)}function BL(n,e,t,i){return fetch(n,{method:"GET",headers:e,signal:i.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"})}function FL(n,e){if(n!==200&&n!==206)throw yw(n,e)}function zL(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(ct(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class WV extends fw{constructor(t){super(t,XV,KV);fe(this,"_responseOrigin",null);this.isHttp=/^https?:/i.test(t.url),this.headers=ML(this.isHttp,t.httpHeaders)}}class XV extends pw{constructor(t){super(t);fe(this,"_abortController",new AbortController);fe(this,"_reader",null);const{disableRange:i,disableStream:s,length:r,rangeChunkSize:a,url:o,withCredentials:l}=t._source;this._contentLength=r,this._isStreamingSupported=!s,this._isRangeSupported=!i;const u=new Headers(t.headers);BL(o,u,l,this._abortController).then(d=>{t._responseOrigin=mw(d.url),FL(d.status,o),this._reader=d.body.getReader();const f=d.headers,{allowRangeRequests:p,suggestedLength:g}=OL({responseHeaders:f,isHttp:t.isHttp,rangeChunkSize:a,disableRange:i});this._isRangeSupported=p,this._contentLength=g||this._contentLength,this._filename=IL(f),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new eu("Streaming is disabled.")),this._headersCapability.resolve()}).catch(this._headersCapability.reject)}async read(){var s;await this._headersCapability.promise;const{value:t,done:i}=await this._reader.read();return i?{value:t,done:i}:(this._loaded+=t.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:zL(t),done:!1})}cancel(t){var i;(i=this._reader)==null||i.cancel(t),this._abortController.abort()}}class KV extends gw{constructor(t,i,s){super(t,i,s);fe(this,"_abortController",new AbortController);fe(this,"_readCapability",Promise.withResolvers());fe(this,"_reader",null);const{url:r,withCredentials:a}=t._source,o=new Headers(t.headers);o.append("Range",`bytes=${i}-${s-1}`),BL(r,o,a,this._abortController).then(l=>{const u=mw(l.url);PL(u,t._responseOrigin),FL(l.status,r),this._reader=l.body.getReader(),this._readCapability.resolve()}).catch(this._readCapability.reject)}async read(){await this._readCapability.promise;const{value:t,done:i}=await this._reader.read();return i?{value:t,done:i}:{value:zL(t),done:!1}}cancel(t){var i;(i=this._reader)==null||i.cancel(t),this._abortController.abort()}}const M2=200,sD=206;function ZV(n){return typeof n!="string"?n:uw(n).buffer}var Oa,ng,UL,HL;class QV extends fw{constructor(t){super(t,JV,eG);T(this,ng);T(this,Oa,new WeakMap);fe(this,"_responseOrigin",null);this.url=t.url,this.isHttp=/^https?:/i.test(this.url),this.headers=ML(this.isHttp,t.httpHeaders)}_request(t){const i=new XMLHttpRequest,s={validateStatus:null,onHeadersReceived:t.onHeadersReceived,onDone:t.onDone,onError:t.onError,onProgress:t.onProgress};c(this,Oa).set(i,s),i.open("GET",this.url),i.withCredentials=this._source.withCredentials;for(const[r,a]of this.headers)i.setRequestHeader(r,a);return this.isHttp&&"begin"in t&&"end"in t?(i.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),s.validateStatus=r=>r===sD||r===M2):s.validateStatus=r=>r===M2,i.responseType="arraybuffer",Bt(t.onError,"Expected `onError` callback to be provided."),i.onerror=()=>t.onError(i.status),i.onreadystatechange=R(this,ng,HL).bind(this,i),i.onprogress=R(this,ng,UL).bind(this,i),i.send(null),i}_abortRequest(t){c(this,Oa).has(t)&&(c(this,Oa).delete(t),t.abort())}getRangeReader(t,i){const s=super.getRangeReader(t,i);return s&&(s.onClosed=()=>this._rangeReaders.delete(s)),s}}Oa=new WeakMap,ng=new WeakSet,UL=function(t,i){var r;const s=c(this,Oa).get(t);(r=s==null?void 0:s.onProgress)==null||r.call(s,i)},HL=function(t,i){const s=c(this,Oa).get(t);if(!s||(t.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),t.readyState!==4)||!c(this,Oa).has(t))return;if(c(this,Oa).delete(t),t.status===0&&this.isHttp){s.onError(t.status);return}const r=t.status||M2;if(!s.validateStatus(r)){s.onError(t.status);return}const a=ZV(t.response);if(r===sD){const o=t.getResponseHeader("Content-Range");/bytes (\d+)-(\d+)\/(\d+)/.test(o)?s.onDone(a):(ct('Missing or invalid "Content-Range" header.'),s.onError(0))}else a?s.onDone(a):s.onError(t.status)};var to,$L,qL,VL,GL;class JV extends pw{constructor(t){super(t);T(this,to);fe(this,"_cachedChunks",[]);fe(this,"_done",!1);fe(this,"_requests",[]);fe(this,"_storedError",null);const{length:i}=t._source;this._contentLength=i,this._fullRequestXhr=t._request({onHeadersReceived:R(this,to,$L).bind(this),onDone:R(this,to,qL).bind(this),onError:R(this,to,VL).bind(this),onProgress:R(this,to,GL).bind(this)})}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._abortRequest(this._fullRequestXhr),this._fullRequestXhr=null}}to=new WeakSet,$L=function(){const t=this._stream,{disableRange:i,rangeChunkSize:s}=t._source,r=this._fullRequestXhr;t._responseOrigin=mw(r.responseURL);const a=r.getAllResponseHeaders(),o=new Headers(a?a.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(d=>{const[f,...p]=d.split(": ");return[f,p.join(": ")]}):[]),{allowRangeRequests:l,suggestedLength:u}=OL({responseHeaders:o,isHttp:t.isHttp,rangeChunkSize:s,disableRange:i});l&&(this._isRangeSupported=!0),this._contentLength=u||this._contentLength,this._filename=IL(o),this._isRangeSupported&&t._abortRequest(r),this._headersCapability.resolve()},qL=function(t){if(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._cachedChunks.push(t),this._done=!0,!(this._cachedChunks.length>0)){for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}},VL=function(t){this._storedError=yw(t,this._stream.url),this._headersCapability.reject(this._storedError);for(const i of this._requests)i.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0},GL=function(t){var i;(i=this.onProgress)==null||i.call(this,{loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})};var _l,YL,WL,FA;class eG extends gw{constructor(t,i,s){super(t,i,s);T(this,_l);fe(this,"onClosed",null);fe(this,"_done",!1);fe(this,"_queuedChunk",null);fe(this,"_requests",[]);fe(this,"_storedError",null);this._requestXhr=t._request({begin:i,end:s,onHeadersReceived:R(this,_l,YL).bind(this),onDone:R(this,_l,WL).bind(this),onError:R(this,_l,FA).bind(this),onProgress:null})}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const i=this._queuedChunk;return this._queuedChunk=null,{value:i,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){var i;this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._abortRequest(this._requestXhr),(i=this.onClosed)==null||i.call(this)}}_l=new WeakSet,YL=function(){var i;const t=mw((i=this._requestXhr)==null?void 0:i.responseURL);try{PL(t,this._stream._responseOrigin)}catch(s){this._storedError=s,R(this,_l,FA).call(this,0)}},WL=function(t){var i;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,(i=this.onClosed)==null||i.call(this)},FA=function(t){this._storedError??(this._storedError=yw(t,this._stream.url));for(const i of this._requests)i.reject(this._storedError);this._requests.length=0,this._queuedChunk=null};const tG=/^[a-z][a-z0-9\-+.]+:/i;function iG(n){if(tG.test(n))return new URL(n);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(n))}function XL(n){const{Readable:e}=process.getBuiltinModule("stream");return typeof e.toWeb=="function"?e.toWeb(n):process.getBuiltinModule("module").createRequire(import.meta.url)("node-readable-to-web-readable-stream").makeDefaultReadableStreamFromNodeReadable(n)}function KL(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(ct(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class nG extends fw{constructor(e){super(e,sG,rG),this.url=iG(e.url),Bt(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs.")}}class sG extends pw{constructor(t){super(t);fe(this,"_reader",null);const{disableRange:i,disableStream:s,length:r,rangeChunkSize:a}=t._source;this._contentLength=r,this._isStreamingSupported=!s,this._isRangeSupported=!i;const o=t.url,l=process.getBuiltinModule("fs");l.promises.lstat(o).then(u=>{const d=l.createReadStream(o),f=XL(d);this._reader=f.getReader();const{size:p}=u;p<=2*a&&(this._isRangeSupported=!1),this._contentLength=p,!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new eu("Streaming is disabled.")),this._headersCapability.resolve()}).catch(u=>{u.code==="ENOENT"&&(u=yw(0,o.href)),this._headersCapability.reject(u)})}async read(){var s;await this._headersCapability.promise;const{value:t,done:i}=await this._reader.read();return i?{value:t,done:i}:(this._loaded+=t.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:KL(t),done:!1})}cancel(t){var i;(i=this._reader)==null||i.cancel(t)}}class rG extends gw{constructor(t,i,s){super(t,i,s);fe(this,"_readCapability",Promise.withResolvers());fe(this,"_reader",null);const r=t.url,a=process.getBuiltinModule("fs");try{const o=a.createReadStream(r,{start:i,end:s-1}),l=XL(o);this._reader=l.getReader(),this._readCapability.resolve()}catch(o){this._readCapability.reject(o)}}async read(){await this._readCapability.promise;const{value:t,done:i}=await this._reader.read();return i?{value:t,done:i}:{value:KL(t),done:!1}}cancel(t){var i;(i=this._reader)==null||i.cancel(t)}}const jg=Symbol("INITIAL_DATA");var Ps,W0,zA;class ZL{constructor(){T(this,W0);T(this,Ps,Object.create(null))}get(e,t=null){if(t){const s=R(this,W0,zA).call(this,e);return s.promise.then(()=>t(s.data)),null}const i=c(this,Ps)[e];if(!i||i.data===jg)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return i.data}has(e){const t=c(this,Ps)[e];return!!t&&t.data!==jg}delete(e){const t=c(this,Ps)[e];return!t||t.data===jg?!1:(delete c(this,Ps)[e],!0)}resolve(e,t=null){const i=R(this,W0,zA).call(this,e);i.data=t,i.resolve()}clear(){var e;for(const t in c(this,Ps)){const{data:i}=c(this,Ps)[t];(e=i==null?void 0:i.bitmap)==null||e.close()}_(this,Ps,Object.create(null))}*[Symbol.iterator](){for(const e in c(this,Ps)){const{data:t}=c(this,Ps)[e];t!==jg&&(yield[e,t])}}}Ps=new WeakMap,W0=new WeakSet,zA=function(e){var t;return(t=c(this,Ps))[e]||(t[e]={...Promise.withResolvers(),data:jg})};const aG=1e5,rD=30;var _D,uc,ys,X0,K0,Ku,Io,Z0,Q0,Zu,J0,Qf,hc,Jf,ey,ep,Qu,ty,iy,tp,Ju,ny,ip,np,Nl,QL,JL,UA,ur,kx,HA,eM,tM;const An=class An{constructor({textContentSource:e,container:t,viewport:i}){T(this,Nl);T(this,uc,Promise.withResolvers());T(this,ys,null);T(this,X0,!1);T(this,K0,!!((_D=globalThis.FontInspector)!=null&&_D.enabled));T(this,Ku,null);T(this,Io,null);T(this,Z0,0);T(this,Q0,0);T(this,Zu,null);T(this,J0,null);T(this,Qf,0);T(this,hc,0);T(this,Jf,Object.create(null));T(this,ey,[]);T(this,ep,null);T(this,Qu,[]);T(this,ty,new WeakMap);T(this,iy,null);var l;if(e instanceof ReadableStream)_(this,ep,e);else if(typeof e=="object")_(this,ep,new ReadableStream({start(u){u.enqueue(e),u.close()}}));else throw new Error('No "textContentSource" parameter specified.');_(this,ys,_(this,J0,t)),_(this,hc,i.scale*eo.pixelRatio),_(this,Qf,i.rotation),_(this,Io,{div:null,properties:null,ctx:null});const{pageWidth:s,pageHeight:r,pageX:a,pageY:o}=i.rawDims;_(this,iy,[1,0,0,-1,-a,o+r]),_(this,Q0,s),_(this,Z0,r),R(l=An,ur,eM).call(l),t.style.setProperty("--min-font-size",c(An,ip)),Vh(t,i),c(this,uc).promise.finally(()=>{c(An,np).delete(this),_(this,Io,null),_(this,Jf,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=on.platform;return ut(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{c(this,Zu).read().then(({value:t,done:i})=>{if(i){c(this,uc).resolve();return}c(this,Ku)??_(this,Ku,t.lang),Object.assign(c(this,Jf),t.styles),R(this,Nl,QL).call(this,t.items),e()},c(this,uc).reject)};return _(this,Zu,c(this,ep).getReader()),c(An,np).add(this),e(),c(this,uc).promise}update({viewport:e,onBefore:t=null}){var r;const i=e.scale*eo.pixelRatio,s=e.rotation;if(s!==c(this,Qf)&&(t==null||t(),_(this,Qf,s),Vh(c(this,J0),{rotation:s})),i!==c(this,hc)){t==null||t(),_(this,hc,i);const a={div:null,properties:null,ctx:R(r=An,ur,kx).call(r,c(this,Ku))};for(const o of c(this,Qu))a.properties=c(this,ty).get(o),a.div=o,R(this,Nl,UA).call(this,a)}}cancel(){var t;const e=new eu("TextLayer task cancelled.");(t=c(this,Zu))==null||t.cancel(e).catch(()=>{}),_(this,Zu,null),c(this,uc).reject(e)}get textDivs(){return c(this,Qu)}get textContentItemsStr(){return c(this,ey)}static cleanup(){if(!(c(this,np).size>0)){c(this,tp).clear();for(const{canvas:e}of c(this,Ju).values())e.remove();c(this,Ju).clear()}}};uc=new WeakMap,ys=new WeakMap,X0=new WeakMap,K0=new WeakMap,Ku=new WeakMap,Io=new WeakMap,Z0=new WeakMap,Q0=new WeakMap,Zu=new WeakMap,J0=new WeakMap,Qf=new WeakMap,hc=new WeakMap,Jf=new WeakMap,ey=new WeakMap,ep=new WeakMap,Qu=new WeakMap,ty=new WeakMap,iy=new WeakMap,tp=new WeakMap,Ju=new WeakMap,ny=new WeakMap,ip=new WeakMap,np=new WeakMap,Nl=new WeakSet,QL=function(e){var s,r;if(c(this,X0))return;(r=c(this,Io)).ctx??(r.ctx=R(s=An,ur,kx).call(s,c(this,Ku)));const t=c(this,Qu),i=c(this,ey);for(const a of e){if(t.length>aG){ct("Ignoring additional textDivs for performance reasons."),_(this,X0,!0);return}if(a.str===void 0){if(a.type==="beginMarkedContentProps"||a.type==="beginMarkedContent"){const o=c(this,ys);_(this,ys,document.createElement("span")),c(this,ys).classList.add("markedContent"),a.id&&c(this,ys).setAttribute("id",`${a.id}`),a.tag==="Artifact"&&(c(this,ys).ariaHidden=!0),o.append(c(this,ys))}else a.type==="endMarkedContent"&&_(this,ys,c(this,ys).parentNode);continue}i.push(a.str),R(this,Nl,JL).call(this,a)}},JL=function(e){var x;const t=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};c(this,Qu).push(t);const s=Ye.transform(c(this,iy),e.transform);let r=Math.atan2(s[1],s[0]);const a=c(this,Jf)[e.fontName];a.vertical&&(r+=Math.PI/2);let o=c(this,K0)&&a.fontSubstitution||a.fontFamily;o=An.fontFamilyMap.get(o)||o;const l=Math.hypot(s[2],s[3]),u=l*R(x=An,ur,tM).call(x,o,a,c(this,Ku));let d,f;r===0?(d=s[4],f=s[5]-u):(d=s[4]+u*Math.sin(r),f=s[5]-u*Math.cos(r));const p=t.style;p.left=`${(100*d/c(this,Q0)).toFixed(2)}%`,p.top=`${(100*f/c(this,Z0)).toFixed(2)}%`,p.setProperty("--font-height",`${l.toFixed(2)}px`),p.fontFamily=o,i.fontSize=l,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,c(this,K0)&&(t.dataset.fontName=a.fontSubstitutionLoadedName||e.fontName),r!==0&&(i.angle=r*(180/Math.PI));let g=!1;if(e.str.length>1)g=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const w=Math.abs(e.transform[0]),y=Math.abs(e.transform[3]);w!==y&&Math.max(w,y)/Math.min(w,y)>1.5&&(g=!0)}if(g&&(i.canvasWidth=a.vertical?e.height:e.width),c(this,ty).set(t,i),c(this,Io).div=t,c(this,Io).properties=i,R(this,Nl,UA).call(this,c(this,Io)),i.hasText&&c(this,ys).append(t),i.hasEOL){const w=document.createElement("br");w.setAttribute("role","presentation"),c(this,ys).append(w)}},UA=function(e){var a;const{div:t,properties:i,ctx:s}=e,{style:r}=t;if(i.canvasWidth!==0&&i.hasText){const{fontFamily:o}=r,{canvasWidth:l,fontSize:u}=i;R(a=An,ur,HA).call(a,s,u*c(this,hc),o);const{width:d}=s.measureText(t.textContent);d>0&&r.setProperty("--scale-x",l*c(this,hc)/d)}i.angle!==0&&r.setProperty("--rotate",`${i.angle}deg`)},ur=new WeakSet,kx=function(e=null){let t=c(this,Ju).get(e||(e=""));if(!t){const i=document.createElement("canvas");i.className="hiddenCanvasElement",i.lang=e,document.body.append(i),t=i.getContext("2d",{alpha:!1,willReadFrequently:!0}),c(this,Ju).set(e,t),c(this,ny).set(t,{size:0,family:""})}return t},HA=function(e,t,i){const s=c(this,ny).get(e);t===s.size&&i===s.family||(e.font=`${t}px ${i}`,s.size=t,s.family=i)},eM=function(){if(c(this,ip)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),_(this,ip,e.getBoundingClientRect().height),e.remove()},tM=function(e,t,i){const s=c(this,tp).get(e);if(s)return s;const r=R(this,ur,kx).call(this,i);r.canvas.width=r.canvas.height=rD,R(this,ur,HA).call(this,r,rD,e);const a=r.measureText(""),o=a.fontBoundingBoxAscent,l=Math.abs(a.fontBoundingBoxDescent);r.canvas.width=r.canvas.height=0;let u=.8;return o?u=o/(o+l):(on.platform.isFirefox&&ct("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?u=t.ascent:t.descent&&(u=1+t.descent)),c(this,tp).set(e,u),u},T(An,ur),T(An,tp,new Map),T(An,Ju,new Map),T(An,ny,new WeakMap),T(An,ip,null),T(An,np,new Set);let tg=An;const oG=100;function m_(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const e=new $A,{docId:t}=e,i=n.url?gV(n.url):null,s=n.data?mV(n.data):null,r=n.httpHeaders||null,a=n.withCredentials===!0,o=n.password??null,l=n.range instanceof iM?n.range:null,u=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:2**16;let d=n.worker instanceof Km?n.worker:null;const f=n.verbosity,p=typeof n.docBaseUrl=="string"&&!dw(n.docBaseUrl)?n.docBaseUrl:null,g=$v(n.cMapUrl),x=n.cMapPacked!==!1,w=n.CMapReaderFactory||(is?EV:$T),y=$v(n.iccUrl),m=$v(n.standardFontDataUrl),v=n.StandardFontDataFactory||(is?CV:qT),b=$v(n.wasmUrl),A=n.WasmFactory||(is?_V:VT),S=n.stopAtErrors!==!0,C=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,k=n.isEvalSupported!==!1,L=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!is,D=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!is&&(on.platform.isFirefox||!globalThis.chrome),j=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,P=typeof n.disableFontFace=="boolean"?n.disableFontFace:is,H=n.fontExtraProperties===!0,G=n.enableXfa===!0,$=n.ownerDocument||globalThis.document,Y=n.disableRange===!0,F=n.disableStream===!0,M=n.disableAutoFetch===!0,I=n.pdfBug===!0,V=n.CanvasFactory||(is?AV:bV),ie=n.FilterFactory||(is?SV:wV),ge=n.enableHWA===!0,ee=n.useWasm!==!1,me=l?l.length:n.length??NaN,oe=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!is&&!P,ae=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:!!(w===$T&&v===qT&&A===VT&&g&&m&&b&&Fg(g,document.baseURI)&&Fg(m,document.baseURI)&&Fg(b,document.baseURI)),Z=null;Hq(f);const re={canvasFactory:new V({ownerDocument:$,enableHWA:ge}),filterFactory:new ie({docId:t,ownerDocument:$}),cMapReaderFactory:ae?null:new w({baseUrl:g,isCompressed:x}),standardFontDataFactory:ae?null:new v({baseUrl:m}),wasmFactory:ae?null:new A({baseUrl:b})};d||(d=Km.create({verbosity:f,port:pa.workerPort}),e._worker=d);const ne={docId:t,apiVersion:"5.4.624",data:s,password:o,disableAutoFetch:M,rangeChunkSize:u,length:me,docBaseUrl:p,enableXfa:G,evaluatorOptions:{maxImageSize:C,disableFontFace:P,ignoreErrors:S,isEvalSupported:k,isOffscreenCanvasSupported:L,isImageDecoderSupported:D,canvasMaxAreaInBytes:j,fontExtraProperties:H,useSystemFonts:oe,useWasm:ee,useWorkerFetch:ae,cMapUrl:g,iccUrl:y,standardFontDataUrl:m,wasmUrl:b}},xe={ownerDocument:$,pdfBug:I,styleElement:Z,enableHWA:ge,loadingParams:{disableAutoFetch:M,enableXfa:G}};return d.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const Re=d.messageHandler.sendWithPromise("GetDocRequest",ne,s?[s.buffer]:null);let je;if(l)je=new qV({pdfDataRangeTransport:l,disableRange:Y,disableStream:F});else if(!s){if(!i)throw new Error("getDocument - no `url` parameter provided.");const Oe=Fg(i)?WV:is?nG:QV;je=new Oe({url:i,length:me,httpHeaders:r,withCredentials:a,rangeChunkSize:u,disableRange:Y,disableStream:F})}return Re.then(Oe=>{if(e.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const Ce=new Yg(t,Oe,d.port),Fe=new uG(Ce,e,je,xe,re);e._transport=Fe,Ce.send("Ready",null)})}).catch(e._capability.reject),e}var g1;const m1=class m1{constructor(){fe(this,"_capability",Promise.withResolvers());fe(this,"_transport",null);fe(this,"_worker",null);fe(this,"docId",`d${en(m1,g1)._++}`);fe(this,"destroyed",!1);fe(this,"onPassword",null);fe(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var e,t,i,s;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(r){throw(i=this._worker)!=null&&i.port&&delete this._worker._pendingDestroy,r}this._transport=null,(s=this._worker)==null||s.destroy(),this._worker=null}async getData(){return this._transport.getData()}};g1=new WeakMap,T(m1,g1,0);let $A=m1;var eh,sy,ry,ay,oy;class iM{constructor(e,t,i=!1,s=null){T(this,eh,Promise.withResolvers());T(this,sy,[]);T(this,ry,[]);T(this,ay,[]);T(this,oy,[]);this.length=e,this.initialData=t,this.progressiveDone=i,this.contentDispositionFilename=s}addRangeListener(e){c(this,oy).push(e)}addProgressListener(e){c(this,ay).push(e)}addProgressiveReadListener(e){c(this,ry).push(e)}addProgressiveDoneListener(e){c(this,sy).push(e)}onDataRange(e,t){for(const i of c(this,oy))i(e,t)}onDataProgress(e,t){c(this,eh).promise.then(()=>{for(const i of c(this,ay))i(e,t)})}onDataProgressiveRead(e){c(this,eh).promise.then(()=>{for(const t of c(this,ry))t(e)})}onDataProgressiveDone(){c(this,eh).promise.then(()=>{for(const e of c(this,sy))e()})}transportReady(){c(this,eh).resolve()}requestDataRange(e,t){zt("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}eh=new WeakMap,sy=new WeakMap,ry=new WeakMap,ay=new WeakMap,oy=new WeakMap;class lG{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return ut(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(e,t){return this._transport.getAnnotationsByType(e,t)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}extractPages(e){return this._transport.extractPages(e)}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var Po,ly,th,Qg;class cG{constructor(e,t,i,s=!1){T(this,th);T(this,Po,!1);T(this,ly,Xm.instance);this._pageIndex=e,this._pageInfo=t,this._transport=i,this._stats=s?new IT:null,this._pdfBug=s,this.commonObjs=i.commonObjs,this.objs=new ZL,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}set pageNumber(e){this._pageIndex=e-1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:i=0,offsetY:s=0,dontFlip:r=!1}={}){return new gv({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:i,offsetY:s,dontFlip:r})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return ut(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,canvas:t=e.canvas,viewport:i,intent:s="display",annotationMode:r=Bl.ENABLE,transform:a=null,background:o=null,optionalContentConfigPromise:l=null,annotationCanvasMap:u=null,pageColors:d=null,printAnnotationStorage:f=null,isEditing:p=!1,recordOperations:g=!1,operationsFilter:x=null}){var D,j,P;(D=this._stats)==null||D.time("Overall");const w=this._transport.getRenderingIntent(s,r,f,p),{renderingIntent:y,cacheKey:m}=w;_(this,Po,!1),l||(l=this._transport.getOptionalContentConfig(y));let v=this._intentStates.get(m);v||(v=Object.create(null),this._intentStates.set(m,v)),v.streamReaderCancelTimeout&&(clearTimeout(v.streamReaderCancelTimeout),v.streamReaderCancelTimeout=null);const b=!!(y&Qs.PRINT);v.displayReadyCapability||(v.displayReadyCapability=Promise.withResolvers(),v.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(j=this._stats)==null||j.time("Page Request"),this._pumpOperatorList(w));const A=!!(this._pdfBug&&((P=globalThis.StepperManager)!=null&&P.enabled)),S=!this.recordedBBoxes&&(g||A),C=H=>{var G,$;if(v.renderTasks.delete(k),S){const Y=(G=k.gfx)==null?void 0:G.dependencyTracker.take();Y&&(k.stepper&&k.stepper.setOperatorBBoxes(Y,k.gfx.dependencyTracker.takeDebugMetadata()),g&&(this.recordedBBoxes=Y))}b&&_(this,Po,!0),R(this,th,Qg).call(this),H?(k.capability.reject(H),this._abortOperatorList({intentState:v,reason:H instanceof Error?H:new Error(H)})):k.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),($=globalThis.Stats)!=null&&$.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},k=new qA({callback:C,params:{canvas:t,canvasContext:e,dependencyTracker:S?new kV(t,v.operatorList.length,A):null,viewport:i,transform:a,background:o},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:u,operatorList:v.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!b,pdfBug:this._pdfBug,pageColors:d,enableHWA:this._transport.enableHWA,operationsFilter:x});(v.renderTasks||(v.renderTasks=new Set)).add(k);const L=k.task;return Promise.all([v.displayReadyCapability.promise,l]).then(([H,G])=>{var $;if(this.destroyed){C();return}if(($=this._stats)==null||$.time("Rendering"),!(G.renderingIntent&y))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");k.initializeGraphics({transparency:H,optionalContentConfig:G}),k.operatorListChanged()}).catch(C),L}getOperatorList({intent:e="display",annotationMode:t=Bl.ENABLE,printAnnotationStorage:i=null,isEditing:s=!1}={}){var u;function r(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(l))}const a=this._transport.getRenderingIntent(e,t,i,s,!0);let o=this._intentStates.get(a.cacheKey);o||(o=Object.create(null),this._intentStates.set(a.cacheKey,o));let l;return o.opListReadCapability||(l=Object.create(null),l.operatorListChanged=r,o.opListReadCapability=Promise.withResolvers(),(o.renderTasks||(o.renderTasks=new Set)).add(l),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(u=this._stats)==null||u.time("Page Request"),this._pumpOperatorList(a)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageId:c(this,ly).getPageId(this._pageIndex+1)-1,pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(s){return s.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>Wm.textContent(i));const t=this.streamTextContent(e);return new Promise(function(i,s){function r(){a.read().then(function({value:l,done:u}){if(u){i(o);return}o.lang??(o.lang=l.lang),Object.assign(o.styles,l.styles),o.items.push(...l.items),r()},s)}const a=t.getReader(),o={items:[],styles:Object.create(null),lang:null};r()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const i of t.renderTasks)e.push(i.completed),i.cancel();return this.objs.clear(),_(this,Po,!1),Promise.all(e)}cleanup(e=!1){_(this,Po,!0);const t=R(this,th,Qg).call(this);return e&&t&&this._stats&&(this._stats=new IT),t}_startRenderPage(e,t){var s,r;const i=this._intentStates.get(t);i&&((s=this._stats)==null||s.timeEnd("Page Request"),(r=i.displayReadyCapability)==null||r.resolve(e))}_renderPageChunk(e,t){for(let i=0,s=e.length;i<s;i++)t.operatorList.fnArray.push(e.fnArray[i]),t.operatorList.argsArray.push(e.argsArray[i]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const i of t.renderTasks)i.operatorListChanged();e.lastChunk&&R(this,th,Qg).call(this)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:i,modifiedIds:s}){const{map:r,transfer:a}=i,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageId:c(this,ly).getPageId(this._pageIndex+1)-1,pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:r,modifiedIds:s},a).getReader(),u=this._intentStates.get(t);u.streamReader=l;const d=()=>{l.read().then(({value:f,done:p})=>{if(p){u.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(f,u),d())},f=>{if(u.streamReader=null,!this._transport.destroyed){if(u.operatorList){u.operatorList.lastChunk=!0;for(const p of u.renderTasks)p.operatorListChanged();R(this,th,Qg).call(this)}if(u.displayReadyCapability)u.displayReadyCapability.reject(f);else if(u.opListReadCapability)u.opListReadCapability.reject(f);else throw f}})};d()}_abortOperatorList({intentState:e,reason:t,force:i=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!i){if(e.renderTasks.size>0)return;if(t instanceof hw){let s=oG;t.extraDelay>0&&t.extraDelay<1e3&&(s+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},s);return}}if(e.streamReader.cancel(new eu(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[s,r]of this._intentStates)if(r===e){this._intentStates.delete(s);break}this.cleanup()}}}get stats(){return this._stats}}Po=new WeakMap,ly=new WeakMap,th=new WeakSet,Qg=function(){if(!c(this,Po)||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),_(this,Po,!1),!0};var dc,ra,Bo,ih,y1,nh,sh,ss,Tx,nM,sM,Jg,sp,Dx;const xi=class xi{constructor({name:e=null,port:t=null,verbosity:i=$q()}={}){T(this,ss);T(this,dc,Promise.withResolvers());T(this,ra,null);T(this,Bo,null);T(this,ih,null);if(this.name=e,this.destroyed=!1,this.verbosity=i,t){if(c(xi,sh).has(t))throw new Error("Cannot use more than one PDFWorker per port.");c(xi,sh).set(t,this),R(this,ss,nM).call(this,t)}else R(this,ss,sM).call(this)}get promise(){return c(this,dc).promise}get port(){return c(this,Bo)}get messageHandler(){return c(this,ra)}destroy(){var e,t;this.destroyed=!0,(e=c(this,ih))==null||e.terminate(),_(this,ih,null),c(xi,sh).delete(c(this,Bo)),_(this,Bo,null),(t=c(this,ra))==null||t.destroy(),_(this,ra,null)}static create(e){const t=c(this,sh).get(e==null?void 0:e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new xi(e)}static get workerSrc(){if(pa.workerSrc)return pa.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return ut(this,"_setupFakeWorkerGlobal",(async()=>c(this,sp,Dx)?c(this,sp,Dx):(await import(this.workerSrc)).WorkerMessageHandler)())}};dc=new WeakMap,ra=new WeakMap,Bo=new WeakMap,ih=new WeakMap,y1=new WeakMap,nh=new WeakMap,sh=new WeakMap,ss=new WeakSet,Tx=function(){c(this,dc).resolve(),c(this,ra).send("configure",{verbosity:this.verbosity})},nM=function(e){_(this,Bo,e),_(this,ra,new Yg("main","worker",e)),c(this,ra).on("ready",()=>{}),R(this,ss,Tx).call(this)},sM=function(){if(c(xi,nh)||c(xi,sp,Dx)){R(this,ss,Jg).call(this);return}let{workerSrc:e}=xi;try{xi._isSameOrigin(window.location,e)||(e=xi._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),i=new Yg("main","worker",t),s=()=>{r.abort(),i.destroy(),t.terminate(),this.destroyed?c(this,dc).reject(new Error("Worker was destroyed")):R(this,ss,Jg).call(this)},r=new AbortController;t.addEventListener("error",()=>{c(this,ih)||s()},{signal:r.signal}),i.on("test",o=>{if(r.abort(),this.destroyed||!o){s();return}_(this,ra,i),_(this,Bo,t),_(this,ih,t),R(this,ss,Tx).call(this)}),i.on("ready",o=>{if(r.abort(),this.destroyed){s();return}try{a()}catch{R(this,ss,Jg).call(this)}});const a=()=>{const o=new Uint8Array;i.send("test",o,[o.buffer])};a();return}catch{cw("The worker has been disabled.")}R(this,ss,Jg).call(this)},Jg=function(){c(xi,nh)||(ct("Setting up fake worker."),_(xi,nh,!0)),xi._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){c(this,dc).reject(new Error("Worker was destroyed"));return}const t=new xV;_(this,Bo,t);const i=`fake${en(xi,y1)._++}`,s=new Yg(i+"_worker",i,t);e.setup(s,t),_(this,ra,new Yg(i,i+"_worker",t)),R(this,ss,Tx).call(this)}).catch(e=>{c(this,dc).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},sp=new WeakSet,Dx=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},T(xi,sp),T(xi,y1,0),T(xi,nh,!1),T(xi,sh,new WeakMap),is&&(_(xi,nh,!0),pa.workerSrc||(pa.workerSrc="./pdf.worker.mjs")),xi._isSameOrigin=(e,t)=>{const i=URL.parse(e);if(!(i!=null&&i.origin)||i.origin==="null")return!1;const s=new URL(t,i);return i.origin===s.origin},xi._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},xi.fromPort=e=>{if(tV("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return xi.create(e)};let Km=xi;var Bs,Fo,zo,kr,fc,rp,Uo,vs,rr,rM,em,jx;class uG{constructor(e,t,i,s,r){T(this,rr);fe(this,"downloadInfoCapability",Promise.withResolvers());T(this,Bs,null);T(this,Fo,new Map);T(this,zo,null);T(this,kr,new Map);T(this,fc,new Map);T(this,rp,new Map);T(this,Uo,null);T(this,vs,Xm.instance);this.messageHandler=e,this.loadingTask=t,_(this,zo,i),this.commonObjs=new ZL,this.fontLoader=new dV({ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this.enableHWA=s.enableHWA,this.loadingParams=s.loadingParams,this._params=s,this.canvasFactory=r.canvasFactory,this.filterFactory=r.filterFactory,this.cMapReaderFactory=r.cMapReaderFactory,this.standardFontDataFactory=r.standardFontDataFactory,this.wasmFactory=r.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this.setupMessageHandler(),c(this,vs).addListener(R(this,rr,rM).bind(this))}get annotationStorage(){return ut(this,"annotationStorage",new f_)}getRenderingIntent(e,t=Bl.ENABLE,i=null,s=!1,r=!1){let a=Qs.DISPLAY,o=EA;switch(e){case"any":a=Qs.ANY;break;case"display":break;case"print":a=Qs.PRINT;break;default:ct(`getRenderingIntent - invalid intent: ${e}`)}const l=a&Qs.PRINT&&i instanceof EL?i:this.annotationStorage;switch(t){case Bl.DISABLE:a+=Qs.ANNOTATIONS_DISABLE;break;case Bl.ENABLE:break;case Bl.ENABLE_FORMS:a+=Qs.ANNOTATIONS_FORMS;break;case Bl.ENABLE_STORAGE:a+=Qs.ANNOTATIONS_STORAGE,o=l.serializable;break;default:ct(`getRenderingIntent - invalid annotationMode: ${t}`)}s&&(a+=Qs.IS_EDITING),r&&(a+=Qs.OPLIST);const{ids:u,hash:d}=l.modifiedIds,f=[a,o.hash,d];return{renderingIntent:a,cacheKey:f.join("_"),annotationStorageSerializable:o,modifiedIds:u}}destroy(){var i;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(i=c(this,Uo))==null||i.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const s of c(this,kr).values())e.push(s._destroy());c(this,kr).clear(),c(this,fc).clear(),c(this,rp).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var s,r;this.commonObjs.clear(),this.fontLoader.clear(),c(this,Fo).clear(),this.filterFactory.destroy(),tg.cleanup(),(s=c(this,zo))==null||s.cancelAllRequests(new eu("Worker was terminated.")),(r=this.messageHandler)==null||r.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(i,s)=>{Bt(c(this,zo),"GetReader - no `BasePDFStream` instance available."),_(this,Bs,c(this,zo).getFullReader()),c(this,Bs).onProgress=r=>R(this,rr,jx).call(this,r),s.onPull=()=>{c(this,Bs).read().then(function({value:r,done:a}){if(a){s.close();return}Bt(r instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(r),1,[r])}).catch(r=>{s.error(r)})},s.onCancel=r=>{c(this,Bs).cancel(r),s.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("ReaderHeadersReady",async i=>{await c(this,Bs).headersReady;const{isStreamingSupported:s,isRangeSupported:r,contentLength:a}=c(this,Bs);return s&&r&&(c(this,Bs).onProgress=null),{isStreamingSupported:s,isRangeSupported:r,contentLength:a}}),e.on("GetRangeReader",(i,s)=>{Bt(c(this,zo),"GetRangeReader - no `BasePDFStream` instance available.");const r=c(this,zo).getRangeReader(i.begin,i.end);if(!r){s.close();return}s.onPull=()=>{r.read().then(function({value:a,done:o}){if(o){s.close();return}Bt(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{s.error(a)})},s.onCancel=a=>{r.cancel(a),s.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("GetDoc",({pdfInfo:i})=>{c(this,vs).pagesNumber=i.numPages,this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,t._capability.resolve(new lG(i,this))}),e.on("DocException",i=>{t._capability.reject(hs(i))}),e.on("PasswordRequest",i=>{_(this,Uo,Promise.withResolvers());try{if(!t.onPassword)throw hs(i);const s=r=>{r instanceof Error?c(this,Uo).reject(r):c(this,Uo).resolve({password:r})};t.onPassword(s,i.code)}catch(s){c(this,Uo).reject(s)}return c(this,Uo).promise}),e.on("DataLoaded",i=>{R(this,rr,jx).call(this,{loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),e.on("StartRenderPage",i=>{if(this.destroyed)return;c(this,kr).get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),e.on("commonobj",([i,s,r])=>{var a;if(this.destroyed||this.commonObjs.has(i))return null;switch(s){case"Font":if("error"in r){const p=r.error;ct(`Error during font loading: ${p}`),this.commonObjs.resolve(i,p);break}const o=new CA(r),l=this._params.pdfBug&&((a=globalThis.FontInspector)!=null&&a.enabled)?(p,g)=>globalThis.FontInspector.fontAdded(p,g):null,u=new fV(o,l,r.extra,r.charProcOperatorList);this.fontLoader.bind(u).catch(()=>e.sendWithPromise("FontFallback",{id:i})).finally(()=>{!u.fontExtraProperties&&u.data&&u.clearData(),this.commonObjs.resolve(i,u)});break;case"CopyLocalImage":const{imageRef:d}=r;Bt(d,"The imageRef must be defined.");for(const p of c(this,kr).values())for(const[,g]of p.objs)if((g==null?void 0:g.ref)===d)return g.dataLen?(this.commonObjs.resolve(i,structuredClone(g)),g.dataLen):null;break;case"FontPath":this.commonObjs.resolve(i,new pV(r));break;case"Image":this.commonObjs.resolve(i,r);break;case"Pattern":const f=new _A(r);this.commonObjs.resolve(i,f.getIR());break;default:throw new Error(`Got unknown common object type ${s}`)}return null}),e.on("obj",([i,s,r,a])=>{var l;if(this.destroyed)return;const o=c(this,kr).get(s);if(!o.objs.has(i)){if(o._intentStates.size===0){(l=a==null?void 0:a.bitmap)==null||l.close();return}switch(r){case"Image":case"Pattern":o.objs.resolve(i,a);break;default:throw new Error(`Got unknown object type ${r}`)}}}),e.on("DocProgress",i=>{this.destroyed||R(this,rr,jx).call(this,i)}),e.on("FetchBinaryData",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");const s=this[i.type];if(!s)throw new Error(`${i.type} not initialized, see the \`useWorkerFetch\` parameter.`);return s.fetch(i)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var i;this.annotationStorage.size<=0&&ct("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((i=c(this,Bs))==null?void 0:i.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}extractPages(e){return this.messageHandler.sendWithPromise("ExtractPages",{pageInfos:e})}getPage(e){if(!Number.isInteger(e)||e<=0||e>c(this,vs).pagesNumber)return Promise.reject(new Error("Invalid page request."));const t=e-1,i=c(this,vs).getPageId(e)-1,s=c(this,fc).get(t);if(s)return s;const r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:i}).then(a=>{if(this.destroyed)throw new Error("Transport destroyed");a.refStr&&c(this,rp).set(a.refStr,i);const o=new cG(t,a,this,this._params.pdfBug);return c(this,kr).set(t,o),o});return c(this,fc).set(t,r),r}async getPageIndex(e){if(!NA(e))throw new Error("Invalid pageIndex request.");const t=await this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen});return c(this,vs).getPageNumber(t+1)-1}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:c(this,vs).getPageId(e+1)-1,intent:t})}getFieldObjects(){return R(this,rr,em).call(this,"GetFieldObjects")}hasJSActions(){return R(this,rr,em).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(e,t){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:e,pageIndexesToSkip:t})}getDocJSActions(){return R(this,rr,em).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:c(this,vs).getPageId(e+1)-1})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:c(this,vs).getPageId(e+1)-1})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return R(this,rr,em).call(this,"GetOptionalContentConfig").then(t=>new $V(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=c(this,Fo).get(e);if(t)return t;const i=this.messageHandler.sendWithPromise(e,null).then(s=>{var r,a;return{info:s[0],metadata:s[1]?new UV(s[1]):null,contentDispositionFilename:((r=c(this,Bs))==null?void 0:r.filename)??null,contentLength:((a=c(this,Bs))==null?void 0:a.contentLength)??null,hasStructTree:s[2]}});return c(this,Fo).set(e,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of c(this,kr).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),c(this,Fo).clear(),this.filterFactory.destroy(!0),tg.cleanup()}}cachedPageNumber(e){if(!NA(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`,i=c(this,rp).get(t);return i>=0?c(this,vs).getPageNumber(i+1):null}}Bs=new WeakMap,Fo=new WeakMap,zo=new WeakMap,kr=new WeakMap,fc=new WeakMap,rp=new WeakMap,Uo=new WeakMap,vs=new WeakMap,rr=new WeakSet,rM=function(){const e=new Map,t=new Map;for(let i=0,s=c(this,vs).pagesNumber;i<s;i++){const r=c(this,vs).getPrevPageNumber(i+1)-1,a=c(this,kr).get(r);a&&e.set(i,a);const o=c(this,fc).get(r);o&&t.set(i,o)}_(this,kr,e),_(this,fc,t)},em=function(e,t=null){const i=c(this,Fo).get(e);if(i)return i;const s=this.messageHandler.sendWithPromise(e,t);return c(this,Fo).set(e,s),s},jx=function({loaded:e,total:t}){var i,s;(s=(i=this.loadingTask).onProgress)==null||s.call(i,{loaded:e,total:t,percent:Dn(Math.round(e/t*100),0,100)})};class hG{constructor(e){fe(this,"_internalRenderTask",null);fe(this,"onContinue",null);fe(this,"onError",null);this._internalRenderTask=e}get promise(){return this._internalRenderTask.capability.promise}cancel(e=0){this._internalRenderTask.cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=this._internalRenderTask.operatorList;if(!e)return!1;const{annotationCanvasMap:t}=this._internalRenderTask;return e.form||e.canvas&&(t==null?void 0:t.size)>0}}var pc,rh;const xu=class xu{constructor({callback:e,params:t,objs:i,commonObjs:s,annotationCanvasMap:r,operatorList:a,pageIndex:o,canvasFactory:l,filterFactory:u,useRequestAnimationFrame:d=!1,pdfBug:f=!1,pageColors:p=null,enableHWA:g=!1,operationsFilter:x=null}){T(this,pc,null);this.callback=e,this.params=t,this.objs=i,this.commonObjs=s,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=o,this.canvasFactory=l,this.filterFactory=u,this._pdfBug=f,this.pageColors=p,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=d===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new hG(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvas,this._canvasContext=t.canvas?null:t.canvasContext,this._enableHWA=g,this._dependencyTracker=t.dependencyTracker,this._operationsFilter=x}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var l,u;if(this.cancelled)return;if(this._canvas){if(c(xu,rh).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");c(xu,rh).add(this._canvas)}this._pdfBug&&((l=globalThis.StepperManager)!=null&&l.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:i,transform:s,background:r,dependencyTracker:a}=this.params,o=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new uf(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors,a),this.gfx.beginDrawing({transform:s,viewport:i,transparency:e,background:r}),this.operatorListIdx=0,this.graphicsReady=!0,(u=this.graphicsReadyCallback)==null||u.call(this)}cancel(e=null,t=0){var i,s,r;this.running=!1,this.cancelled=!0,(i=this.gfx)==null||i.endDrawing(),c(this,pc)&&(window.cancelAnimationFrame(c(this,pc)),_(this,pc,null)),c(xu,rh).delete(this._canvas),e||(e=new hw(`Rendering cancelled, page ${this._pageIndex+1}`,t)),this.callback(e),(r=(s=this.task).onError)==null||r.call(s,e)}operatorListChanged(){var e,t;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.gfx.dependencyTracker)==null||e.growOperationsCount(this.operatorList.fnArray.length),(t=this.stepper)==null||t.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?_(this,pc,window.requestAnimationFrame(()=>{_(this,pc,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),c(xu,rh).delete(this._canvas),this.callback())))}};pc=new WeakMap,rh=new WeakMap,T(xu,rh,new WeakSet);let qA=xu;const dG="5.4.624",fG="384c6208b";var Fs,ah,ap,sn,cy,op,Ho,uy,gc,aa,hy,si,VA,GA,YA,gu,aM,jl;const ds=class ds{constructor({editor:e=null,uiManager:t=null}){T(this,si);T(this,Fs,null);T(this,ah,null);T(this,ap);T(this,sn,null);T(this,cy,!1);T(this,op,!1);T(this,Ho,null);T(this,uy);T(this,gc,null);T(this,aa,null);var i,s;e?(_(this,op,!1),_(this,Ho,e)):_(this,op,!0),_(this,aa,(e==null?void 0:e._uiManager)||t),_(this,uy,c(this,aa)._eventBus),_(this,ap,((i=e==null?void 0:e.color)==null?void 0:i.toUpperCase())||((s=c(this,aa))==null?void 0:s.highlightColors.values().next().value)||"#FFFF98"),c(ds,hy)||_(ds,hy,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return ut(this,"_keyboardManager",new yv([[["Escape","mac+Escape"],ds.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],ds.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],ds.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],ds.prototype._moveToPrevious],[["Home","mac+Home"],ds.prototype._moveToBeginning],[["End","mac+End"],ds.prototype._moveToEnd]]))}renderButton(){const e=_(this,Fs,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",c(this,Ho)&&(e.ariaControls=`${c(this,Ho).id}_colorpicker_dropdown`);const t=c(this,aa)._signal;e.addEventListener("click",R(this,si,gu).bind(this),{signal:t}),e.addEventListener("keydown",R(this,si,YA).bind(this),{signal:t});const i=_(this,ah,document.createElement("span"));return i.className="swatch",i.ariaHidden="true",i.style.backgroundColor=c(this,ap),e.append(i),e}renderMainDropdown(){const e=_(this,sn,R(this,si,VA).call(this));return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}_colorSelectFromKeyboard(e){if(e.target===c(this,Fs)){R(this,si,gu).call(this,e);return}const t=e.target.getAttribute("data-color");t&&R(this,si,GA).call(this,t,e)}_moveToNext(e){var t,i;if(!c(this,si,jl)){R(this,si,gu).call(this,e);return}if(e.target===c(this,Fs)){(t=c(this,sn).firstElementChild)==null||t.focus();return}(i=e.target.nextSibling)==null||i.focus()}_moveToPrevious(e){var t,i;if(e.target===((t=c(this,sn))==null?void 0:t.firstElementChild)||e.target===c(this,Fs)){c(this,si,jl)&&this._hideDropdownFromKeyboard();return}c(this,si,jl)||R(this,si,gu).call(this,e),(i=e.target.previousSibling)==null||i.focus()}_moveToBeginning(e){var t;if(!c(this,si,jl)){R(this,si,gu).call(this,e);return}(t=c(this,sn).firstElementChild)==null||t.focus()}_moveToEnd(e){var t;if(!c(this,si,jl)){R(this,si,gu).call(this,e);return}(t=c(this,sn).lastElementChild)==null||t.focus()}hideDropdown(){var e,t;(e=c(this,sn))==null||e.classList.add("hidden"),c(this,Fs).ariaExpanded="false",(t=c(this,gc))==null||t.abort(),_(this,gc,null)}_hideDropdownFromKeyboard(){var e;if(!c(this,op)){if(!c(this,si,jl)){(e=c(this,Ho))==null||e.unselect();return}this.hideDropdown(),c(this,Fs).focus({preventScroll:!0,focusVisible:c(this,cy)})}}updateColor(e){if(c(this,ah)&&(c(this,ah).style.backgroundColor=e),!c(this,sn))return;const t=c(this,aa).highlightColors.values();for(const i of c(this,sn).children)i.ariaSelected=t.next().value===e.toUpperCase()}destroy(){var e,t;(e=c(this,Fs))==null||e.remove(),_(this,Fs,null),_(this,ah,null),(t=c(this,sn))==null||t.remove(),_(this,sn,null)}};Fs=new WeakMap,ah=new WeakMap,ap=new WeakMap,sn=new WeakMap,cy=new WeakMap,op=new WeakMap,Ho=new WeakMap,uy=new WeakMap,gc=new WeakMap,aa=new WeakMap,hy=new WeakMap,si=new WeakSet,VA=function(){const e=document.createElement("div"),t=c(this,aa)._signal;e.addEventListener("contextmenu",Gr,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),c(this,Ho)&&(e.id=`${c(this,Ho).id}_colorpicker_dropdown`);for(const[i,s]of c(this,aa).highlightColors){const r=document.createElement("button");r.tabIndex="0",r.role="option",r.setAttribute("data-color",s),r.title=i,r.setAttribute("data-l10n-id",c(ds,hy)[i]);const a=document.createElement("span");r.append(a),a.className="swatch",a.style.backgroundColor=s,r.ariaSelected=s===c(this,ap),r.addEventListener("click",R(this,si,GA).bind(this,s),{signal:t}),e.append(r)}return e.addEventListener("keydown",R(this,si,YA).bind(this),{signal:t}),e},GA=function(e,t){t.stopPropagation(),c(this,uy).dispatch("switchannotationeditorparams",{source:this,type:Tt.HIGHLIGHT_COLOR,value:e}),this.updateColor(e)},YA=function(e){ds._keyboardManager.exec(this,e)},gu=function(e){if(c(this,si,jl)){this.hideDropdown();return}if(_(this,cy,e.detail===0),c(this,gc)||(_(this,gc,new AbortController),window.addEventListener("pointerdown",R(this,si,aM).bind(this),{signal:c(this,aa).combinedSignal(c(this,gc))})),c(this,Fs).ariaExpanded="true",c(this,sn)){c(this,sn).classList.remove("hidden");return}const t=_(this,sn,R(this,si,VA).call(this));c(this,Fs).append(t)},aM=function(e){var t;(t=c(this,sn))!=null&&t.contains(e.target)||this.hideDropdown()},jl=function(){return c(this,sn)&&!c(this,sn).classList.contains("hidden")},T(ds,hy,null);let e1=ds;var Ia,dy,lp,fy;const bu=class bu{constructor(e){T(this,Ia,null);T(this,dy,null);T(this,lp,null);_(this,dy,e),_(this,lp,e._uiManager),c(bu,fy)||_(bu,fy,Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"}))}renderButton(){if(c(this,Ia))return c(this,Ia);const{editorType:e,colorType:t,color:i}=c(this,dy),s=_(this,Ia,document.createElement("input"));return s.type="color",s.value=i||"#000000",s.className="basicColorPicker",s.tabIndex=0,s.setAttribute("data-l10n-id",c(bu,fy)[e]),s.addEventListener("input",()=>{c(this,lp).updateParams(t,s.value)},{signal:c(this,lp)._signal}),s}update(e){c(this,Ia)&&(c(this,Ia).value=e)}destroy(){var e;(e=c(this,Ia))==null||e.remove(),_(this,Ia,null)}hideDropdown(){}};Ia=new WeakMap,dy=new WeakMap,lp=new WeakMap,fy=new WeakMap,T(bu,fy,null);let t1=bu;function aD(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function Rg(n){return Math.max(0,Math.min(255,255*n))}class oD{static CMYK_G([e,t,i,s]){return["G",1-Math.min(1,.3*e+.59*i+.11*t+s)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=Rg(e),[e,e,e]}static G_HTML([e]){const t=aD(e);return`#${t}${t}${t}`}static RGB_G([e,t,i]){return["G",.3*e+.59*t+.11*i]}static RGB_rgb(e){return e.map(Rg)}static RGB_HTML(e){return`#${e.map(aD).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,i,s]){return["RGB",1-Math.min(1,e+s),1-Math.min(1,i+s),1-Math.min(1,t+s)]}static CMYK_rgb([e,t,i,s]){return[Rg(1-Math.min(1,e+s)),Rg(1-Math.min(1,i+s)),Rg(1-Math.min(1,t+s))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,i]){const s=1-e,r=1-t,a=1-i,o=Math.min(s,r,a);return["CMYK",s,r,a,o]}}class pG{create(e,t,i=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const s=this._createSVG("svg:svg");return s.setAttribute("version","1.1"),i||(s.setAttribute("width",`${e}px`),s.setAttribute("height",`${t}px`)),s.setAttribute("preserveAspectRatio","none"),s.setAttribute("viewBox",`0 0 ${e} ${t}`),s}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){zt("Abstract method `_createSVG` called.")}}class i1 extends pG{_createSVG(e){return document.createElementNS(ho,e)}}const gG=9,Yh=new WeakSet,mG=new Date().getTimezoneOffset()*60*1e3;class O2{static create(e){switch(e.data.annotationType){case Gi.LINK:return new y_(e);case Gi.TEXT:return new vG(e);case Gi.WIDGET:switch(e.data.fieldType){case"Tx":return new xG(e);case"Btn":return e.data.radioButton?new cM(e):e.data.checkBox?new wG(e):new SG(e);case"Ch":return new AG(e);case"Sig":return new bG(e)}return new nd(e);case Gi.POPUP:return new XA(e);case Gi.FREETEXT:return new pM(e);case Gi.LINE:return new CG(e);case Gi.SQUARE:return new _G(e);case Gi.CIRCLE:return new NG(e);case Gi.POLYLINE:return new gM(e);case Gi.CARET:return new TG(e);case Gi.INK:return new v_(e);case Gi.POLYGON:return new kG(e);case Gi.HIGHLIGHT:return new mM(e);case Gi.UNDERLINE:return new DG(e);case Gi.SQUIGGLY:return new jG(e);case Gi.STRIKEOUT:return new RG(e);case Gi.STAMP:return new yM(e);case Gi.FILEATTACHMENT:return new LG(e);default:return new _i(e)}}}var oh,cp,Tr,py,WA;const C_=class C_{constructor(e,{isRenderable:t=!1,ignoreBorder:i=!1,createQuadrilaterals:s=!1}={}){T(this,py);T(this,oh,null);T(this,cp,!1);T(this,Tr,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableComment=e.enableComment,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,this.hasOwnCommentButton=!1,t&&(this.contentElement=this.container=this._createContainer(i)),s&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!!(e!=null&&e.str||t!=null&&t.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return C_._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){var i;const{data:e}=this,t=(i=this.annotationStorage)==null?void 0:i.getEditor(e.id);return t?t.getData():e}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){var o;const e=(o=this.annotationStorage)==null?void 0:o.getEditor(this.data.id);if(e)return e.commentButtonPositionInPage;const{quadPoints:t,inkLists:i,rect:s}=this.data;let r=-1/0,a=-1/0;if((t==null?void 0:t.length)>=8){for(let l=0;l<t.length;l+=8)t[l+1]>a?(a=t[l+1],r=t[l+2]):t[l+1]===a&&(r=Math.max(r,t[l+2]));return[r,a]}if((i==null?void 0:i.length)>=1){for(const l of i)for(let u=0,d=l.length;u<d;u+=2)l[u+1]>a?(a=l[u+1],r=l[u]):l[u+1]===a&&(r=Math.max(r,l[u]));if(r!==1/0)return[r,a]}return s?[s[2],s[3]]:null}_normalizePoint(e){const{page:{view:t},viewport:{rawDims:{pageWidth:i,pageHeight:s,pageX:r,pageY:a}}}=this.parent;return e[1]=t[3]-e[1]+t[1],e[0]=100*(e[0]-r)/i,e[1]=100*(e[1]-a)/s,e}get commentText(){var t,i,s;const{data:e}=this;return((i=(t=this.annotationStorage.getRawValue(`${Gm}${e.id}`))==null?void 0:t.popup)==null?void 0:i.contents)||((s=e.contentsObj)==null?void 0:s.str)||""}set commentText(e){const{data:t}=this,i={deleted:!e,contents:e||""};this.annotationStorage.updateEditor(t.id,{popup:i})||this.annotationStorage.setValue(`${Gm}${t.id}`,{id:t.id,annotationType:t.annotationType,page:this.parent.page,popup:i,popupRef:t.popupRef,modificationDate:new Date}),e||this.removePopup()}removePopup(){var e,t;(t=((e=c(this,Tr))==null?void 0:e.popup)||this.popup)==null||t.remove(),_(this,Tr,this.popup=null)}updateEdited(e){var r;if(!this.container)return;e.rect&&(c(this,oh)||_(this,oh,{rect:this.data.rect.slice(0)}));const{rect:t,popup:i}=e;t&&R(this,py,WA).call(this,t);let s=((r=c(this,Tr))==null?void 0:r.popup)||this.popup;!s&&(i!=null&&i.text)&&(this._createPopup(i),s=c(this,Tr).popup),s&&(s.updateEdited(e),i!=null&&i.deleted&&(s.remove(),_(this,Tr,null),this.popup=null))}resetEdited(){var e;c(this,oh)&&(R(this,py,WA).call(this,c(this,oh).rect),(e=c(this,Tr))==null||e.popup.resetEdited(),_(this,oh,null))}_createContainer(e){const{data:t,parent:{page:i,viewport:s}}=this,r=document.createElement("section");r.setAttribute("data-annotation-id",t.id),!(this instanceof nd)&&!(this instanceof y_)&&(r.tabIndex=0);const{style:a}=r;if(a.zIndex=this.parent.zIndex,this.parent.zIndex+=2,t.alternativeText&&(r.title=t.alternativeText),t.noRotate&&r.classList.add("norotate"),!t.rect||this instanceof XA){const{rotation:w}=t;return!t.hasOwnCanvas&&w!==0&&this.setRotation(w,r),r}const{width:o,height:l}=this;if(!e&&t.borderStyle.width>0){a.borderWidth=`${t.borderStyle.width}px`;const w=t.borderStyle.horizontalCornerRadius,y=t.borderStyle.verticalCornerRadius;if(w>0||y>0){const v=`calc(${w}px * var(--total-scale-factor)) / calc(${y}px * var(--total-scale-factor))`;a.borderRadius=v}else if(this instanceof cM){const v=`calc(${o}px * var(--total-scale-factor)) / calc(${l}px * var(--total-scale-factor))`;a.borderRadius=v}switch(t.borderStyle.style){case kd.SOLID:a.borderStyle="solid";break;case kd.DASHED:a.borderStyle="dashed";break;case kd.BEVELED:ct("Unimplemented border style: beveled");break;case kd.INSET:ct("Unimplemented border style: inset");break;case kd.UNDERLINE:a.borderBottomStyle="solid";break}const m=t.borderColor||null;m?(_(this,cp,!0),a.borderColor=Ye.makeHexColor(m[0]|0,m[1]|0,m[2]|0)):a.borderWidth=0}const u=Ye.normalizeRect([t.rect[0],i.view[3]-t.rect[1]+i.view[1],t.rect[2],i.view[3]-t.rect[3]+i.view[1]]),{pageWidth:d,pageHeight:f,pageX:p,pageY:g}=s.rawDims;a.left=`${100*(u[0]-p)/d}%`,a.top=`${100*(u[1]-g)/f}%`;const{rotation:x}=t;return t.hasOwnCanvas||x===0?(a.width=`${100*o/d}%`,a.height=`${100*l/f}%`):this.setRotation(x,r),r}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:i,pageHeight:s}=this.parent.viewport.rawDims;let{width:r,height:a}=this;e%180!==0&&([r,a]=[a,r]),t.style.width=`${100*r/i}%`,t.style.height=`${100*a/s}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,i,s)=>{const r=s.detail[t],a=r[0],o=r.slice(1);s.target.style[i]=oD[`${a}_HTML`](o),this.annotationStorage.setValue(this.data.id,{[i]:oD[`${a}_rgb`](o)})};return ut(this,"_commonActions",{display:t=>{const{display:i}=t.detail,s=i%2===1;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:s,noPrint:i===1||i===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:i}=t.detail;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:i,noView:i})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const i=t.detail.rotation;this.setRotation(i),this.annotationStorage.setValue(this.data.id,{rotation:i})}})}_dispatchEventFromSandbox(e,t){const i=this._commonActions;for(const s of Object.keys(t.detail)){const r=e[s]||i[s];r==null||r(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const i=this._commonActions;for(const[s,r]of Object.entries(t)){const a=i[s];if(a){const o={detail:{[s]:r},target:e};a(o),delete t[s]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,i,s,r]=this.data.rect.map(w=>Math.fround(w));if(e.length===8){const[w,y,m,v]=e.subarray(2,6);if(s===w&&r===y&&t===m&&i===v)return}const{style:a}=this.container;let o;if(c(this,cp)){const{borderColor:w,borderWidth:y}=a;a.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${w}" stroke-width="${y}">`],this.container.classList.add("hasBorder")}const l=s-t,u=r-i,{svgFactory:d}=this,f=d.createElement("svg");f.classList.add("quadrilateralsContainer"),f.setAttribute("width",0),f.setAttribute("height",0),f.role="none";const p=d.createElement("defs");f.append(p);const g=d.createElement("clipPath"),x=`clippath_${this.data.id}`;g.setAttribute("id",x),g.setAttribute("clipPathUnits","objectBoundingBox"),p.append(g);for(let w=2,y=e.length;w<y;w+=8){const m=e[w],v=e[w+1],b=e[w+2],A=e[w+3],S=d.createElement("rect"),C=(b-t)/l,k=(r-v)/u,L=(m-b)/l,D=(v-A)/u;S.setAttribute("x",C),S.setAttribute("y",k),S.setAttribute("width",L),S.setAttribute("height",D),g.append(S),o==null||o.push(`<rect vector-effect="non-scaling-stroke" x="${C}" y="${k}" width="${L}" height="${D}"/>`)}c(this,cp)&&(o.push("</g></svg>')"),a.backgroundImage=o.join("")),this.container.append(f),this.container.style.clipPath=`url(#${x})`}_createPopup(e=null){const{data:t}=this;let i,s;e?(i={str:e.text},s=e.date):(i=t.contentsObj,s=t.modificationDate),_(this,Tr,new XA({data:{color:t.color,titleObj:t.titleObj,modificationDate:s,contentsObj:i,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]}))}get hasPopupElement(){return!!(c(this,Tr)||this.popup||this.data.popupRef)}get extraPopupElement(){return c(this,Tr)}render(){zt("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const i=[];if(this._fieldObjects){const s=this._fieldObjects[e];if(s)for(const{page:r,id:a,exportValues:o}of s){if(r===-1||a===t)continue;const l=typeof o=="string"?o:null,u=document.querySelector(`[data-element-id="${a}"]`);if(u&&!Yh.has(u)){ct(`_getElementsByName - element not allowed: ${a}`);continue}i.push({id:a,exportValue:l,domElement:u})}return i}for(const s of document.getElementsByName(e)){const{exportValue:r}=s,a=s.getAttribute("data-element-id");a!==t&&Yh.has(s)&&i.push({id:a,exportValue:r,domElement:s})}return i}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var i;(i=this.linkService.eventBus)==null||i.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}};oh=new WeakMap,cp=new WeakMap,Tr=new WeakMap,py=new WeakSet,WA=function(e){const{container:{style:t},data:{rect:i,rotation:s},parent:{viewport:{rawDims:{pageWidth:r,pageHeight:a,pageX:o,pageY:l}}}}=this;i==null||i.splice(0,4,...e),t.left=`${100*(e[0]-o)/r}%`,t.top=`${100*(a-e[3]+l)/a}%`,s===0?(t.width=`${100*(e[2]-e[0])/r}%`,t.height=`${100*(e[3]-e[1])/a}%`):this.setRotation(s)};let _i=C_;class yG extends _i{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.editor=e.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:e}=this;e.hasComment&&this._createPopup(e.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(e){this.editor.comment=e,e||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}var ir,mu,oM,lM;class y_ extends _i{constructor(t,i=null){super(t,{isRenderable:!0,ignoreBorder:!!(i!=null&&i.ignoreBorder),createQuadrilaterals:!0});T(this,ir);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:i}=this,s=document.createElement("a");s.setAttribute("data-element-id",t.id);let r=!1;return t.url?(i.addLinkAttributes(s,t.url,t.newWindow),r=!0):t.action?(this._bindNamedAction(s,t.action,t.overlaidText),r=!0):t.attachment?(R(this,ir,oM).call(this,s,t.attachment,t.overlaidText,t.attachmentDest),r=!0):t.setOCGState?(R(this,ir,lM).call(this,s,t.setOCGState,t.overlaidText),r=!0):t.dest?(this._bindLink(s,t.dest,t.overlaidText),r=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,t),r=!0),t.resetForm?(this._bindResetFormAction(s,t.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(s,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&(this.contentElement=s,this.container.append(s)),this.container}_bindLink(t,i,s=""){t.href=this.linkService.getDestinationHash(i),t.onclick=()=>(i&&this.linkService.goToDestination(i),!1),(i||i==="")&&R(this,ir,mu).call(this),s&&(t.title=s)}_bindNamedAction(t,i,s=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(i),!1),s&&(t.title=s),R(this,ir,mu).call(this)}_bindJSAction(t,i){t.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(i.actions)){const a=s.get(r);a&&(t[a]=()=>{var o;return(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i.id,name:r}}),!1})}i.overlaidText&&(t.title=i.overlaidText),t.onclick||(t.onclick=()=>!1),R(this,ir,mu).call(this)}_bindResetFormAction(t,i){const s=t.onclick;if(s||(t.href=this.linkService.getAnchorUrl("")),R(this,ir,mu).call(this),!this._fieldObjects){ct('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),s||(t.onclick=()=>!1);return}t.onclick=()=>{var f;s==null||s();const{fields:r,refs:a,include:o}=i,l=[];if(r.length!==0||a.length!==0){const p=new Set(a);for(const g of r){const x=this._fieldObjects[g]||[];for(const{id:w}of x)p.add(w)}for(const g of Object.values(this._fieldObjects))for(const x of g)p.has(x.id)===o&&l.push(x)}else for(const p of Object.values(this._fieldObjects))l.push(...p);const u=this.annotationStorage,d=[];for(const p of l){const{id:g}=p;switch(d.push(g),p.type){case"text":{const w=p.defaultValue||"";u.setValue(g,{value:w});break}case"checkbox":case"radiobutton":{const w=p.defaultValue===p.exportValues;u.setValue(g,{value:w});break}case"combobox":case"listbox":{const w=p.defaultValue||"";u.setValue(g,{value:w});break}default:continue}const x=document.querySelector(`[data-element-id="${g}"]`);if(x){if(!Yh.has(x)){ct(`_bindResetFormAction - element not allowed: ${g}`);continue}}else continue;x.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((f=this.linkService.eventBus)==null||f.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:d,name:"ResetForm"}})),!1}}}ir=new WeakSet,mu=function(){this.container.setAttribute("data-internal-link","")},oM=function(t,i,s="",r=null){t.href=this.linkService.getAnchorUrl(""),i.description?t.title=i.description:s&&(t.title=s),t.onclick=()=>{var a;return(a=this.downloadManager)==null||a.openOrDownloadData(i.content,i.filename,r),!1},R(this,ir,mu).call(this)},lM=function(t,i,s=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(i),!1),s&&(t.title=s),R(this,ir,mu).call(this)};class vG extends _i{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(e),this.container}}class nd extends _i{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return on.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,i,s,r){i.includes("mouse")?e.addEventListener(i,a=>{var o;(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:r(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):e.addEventListener(i,a=>{var o;if(i==="blur"){if(!t.focused||!a.relatedTarget)return;t.focused=!1}else if(i==="focus"){if(t.focused)return;t.focused=!0}r&&((o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:r(a)}}))})}_setEventListeners(e,t,i,s){var r,a,o;for(const[l,u]of i)(u==="Action"||(r=this.data.actions)!=null&&r[u])&&((u==="Focus"||u==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,l,u,s),u==="Focus"&&!((a=this.data.actions)!=null&&a.Blur)?this._setEventListener(e,t,"blur","Blur",null):u==="Blur"&&!((o=this.data.actions)!=null&&o.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":Ye.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:i}=this.data.defaultAppearanceData,s=this.data.defaultAppearanceData.fontSize||gG,r=e.style;let a;const o=2,l=u=>Math.round(10*u)/10;if(this.data.multiLine){const u=Math.abs(this.data.rect[3]-this.data.rect[1]-o),d=Math.round(u/(k2*s))||1,f=u/d;a=Math.min(s,l(f/k2))}else{const u=Math.abs(this.data.rect[3]-this.data.rect[1]-o);a=Math.min(s,l(u/k2))}r.fontSize=`calc(${a}px * var(--total-scale-factor))`,r.color=Ye.makeHexColor(i[0],i[1],i[2]),this.data.textAlignment!==null&&(r.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class xG extends nd{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,i,s){const r=this.annotationStorage;for(const a of this._getElementsByName(e.name,e.id))a.domElement&&(a.domElement[t]=i),r.setValue(a.id,{[s]:i})}render(){var s,r;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const a=e.getValue(t,{value:this.data.fieldValue});let o=a.value||"";const l=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;l&&o.length>l&&(o=o.slice(0,l));let u=a.formattedValue||((s=this.data.textContent)==null?void 0:s.join(`
`))||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const d={userValue:o,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=u??o,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type=this.data.password?"password":"text",i.setAttribute("value",u??o),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),Yh.add(i),this.contentElement=i,i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=0;const{datetimeFormat:f,datetimeType:p,timeStep:g}=this.data,x=!!p&&this.enableScripting;f&&(i.title=f),this._setRequired(i,this.data.required),l&&(i.maxLength=l),i.addEventListener("input",y=>{e.setValue(t,{value:y.target.value}),this.setPropertyOnSiblings(i,"value",y.target.value,"value"),d.formattedValue=null}),i.addEventListener("resetform",y=>{const m=this.data.defaultFieldValue??"";i.value=d.userValue=m,d.formattedValue=null});let w=y=>{const{formattedValue:m}=d;m!=null&&(y.target.value=m),y.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",m=>{var b;if(d.focused)return;const{target:v}=m;if(x&&(v.type=p,g&&(v.step=g)),d.userValue){const A=d.userValue;if(x)if(p==="time"){const S=new Date(A),C=[S.getHours(),S.getMinutes(),S.getSeconds()];v.value=C.map(k=>k.toString().padStart(2,"0")).join(":")}else v.value=new Date(A-mG).toISOString().split(p==="date"?"T":".",1)[0];else v.value=A}d.lastCommittedValue=v.value,d.commitKey=1,(b=this.data.actions)!=null&&b.Focus||(d.focused=!0)}),i.addEventListener("updatefromsandbox",m=>{this.showElementAndHideCanvas(m.target);const v={value(b){d.userValue=b.detail.value??"",x||e.setValue(t,{value:d.userValue.toString()}),b.target.value=d.userValue},formattedValue(b){const{formattedValue:A}=b.detail;d.formattedValue=A,A!=null&&b.target!==document.activeElement&&(b.target.value=A);const S={formattedValue:A};x&&(S.value=A),e.setValue(t,S)},selRange(b){b.target.setSelectionRange(...b.detail.selRange)},charLimit:b=>{var k;const{charLimit:A}=b.detail,{target:S}=b;if(A===0){S.removeAttribute("maxLength");return}S.setAttribute("maxLength",A);let C=d.userValue;!C||C.length<=A||(C=C.slice(0,A),S.value=d.userValue=C,e.setValue(t,{value:C}),(k=this.linkService.eventBus)==null||k.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:C,willCommit:!0,commitKey:1,selStart:S.selectionStart,selEnd:S.selectionEnd}}))}};this._dispatchEventFromSandbox(v,m)}),i.addEventListener("keydown",m=>{var A;d.commitKey=1;let v=-1;if(m.key==="Escape"?v=0:m.key==="Enter"&&!this.data.multiLine?v=2:m.key==="Tab"&&(d.commitKey=3),v===-1)return;const{value:b}=m.target;d.lastCommittedValue!==b&&(d.lastCommittedValue=b,d.userValue=b,(A=this.linkService.eventBus)==null||A.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:b,willCommit:!0,commitKey:v,selStart:m.target.selectionStart,selEnd:m.target.selectionEnd}}))});const y=w;w=null,i.addEventListener("blur",m=>{var A,S;if(!d.focused||!m.relatedTarget)return;(A=this.data.actions)!=null&&A.Blur||(d.focused=!1);const{target:v}=m;let{value:b}=v;if(x){if(b&&p==="time"){const C=b.split(":").map(k=>parseInt(k,10));b=new Date(2e3,0,1,C[0],C[1],C[2]||0).valueOf(),v.step=""}else b.includes("T")||(b=`${b}T00:00`),b=new Date(b).valueOf();v.type="text"}d.userValue=b,d.lastCommittedValue!==b&&((S=this.linkService.eventBus)==null||S.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:b,willCommit:!0,commitKey:d.commitKey,selStart:m.target.selectionStart,selEnd:m.target.selectionEnd}})),y(m)}),(r=this.data.actions)!=null&&r.Keystroke&&i.addEventListener("beforeinput",m=>{var D;d.lastCommittedValue=null;const{data:v,target:b}=m,{value:A,selectionStart:S,selectionEnd:C}=b;let k=S,L=C;switch(m.inputType){case"deleteWordBackward":{const j=A.substring(0,S).match(/\w*[^\w]*$/);j&&(k-=j[0].length);break}case"deleteWordForward":{const j=A.substring(S).match(/^[^\w]*\w*/);j&&(L+=j[0].length);break}case"deleteContentBackward":S===C&&(k-=1);break;case"deleteContentForward":S===C&&(L+=1);break}m.preventDefault(),(D=this.linkService.eventBus)==null||D.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:A,change:v||"",willCommit:!1,selStart:k,selEnd:L}})}),this._setEventListeners(i,d,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],m=>m.target.value)}if(w&&i.addEventListener("blur",w),this.data.comb){const m=(this.data.rect[2]-this.data.rect[0])/l;i.classList.add("comb"),i.style.letterSpacing=`calc(${m}px * var(--total-scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class bG extends nd{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class wG extends nd{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,i=t.id;let s=e.getValue(i,{value:t.exportValue===t.fieldValue}).value;typeof s=="string"&&(s=s!=="Off",e.setValue(i,{value:s})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const r=document.createElement("input");return Yh.add(r),r.setAttribute("data-element-id",i),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="checkbox",r.name=t.fieldName,s&&r.setAttribute("checked",!0),r.setAttribute("exportValue",t.exportValue),r.tabIndex=0,r.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const u of this._getElementsByName(o,i)){const d=l&&u.exportValue===t.exportValue;u.domElement&&(u.domElement.checked=d),e.setValue(u.id,{value:d})}e.setValue(i,{value:l})}),r.addEventListener("resetform",a=>{const o=t.defaultFieldValue||"Off";a.target.checked=o===t.exportValue}),this.enableScripting&&this.hasJSActions&&(r.addEventListener("updatefromsandbox",a=>{const o={value(l){l.target.checked=l.detail.value!=="Off",e.setValue(i,{value:l.target.checked})}};this._dispatchEventFromSandbox(o,a)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class cM extends nd{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,i=t.id;let s=e.getValue(i,{value:t.fieldValue===t.buttonValue}).value;if(typeof s=="string"&&(s=s!==t.buttonValue,e.setValue(i,{value:s})),s)for(const a of this._getElementsByName(t.fieldName,i))e.setValue(a.id,{value:!1});const r=document.createElement("input");if(Yh.add(r),r.setAttribute("data-element-id",i),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="radio",r.name=t.fieldName,s&&r.setAttribute("checked",!0),r.tabIndex=0,r.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const u of this._getElementsByName(o,i))e.setValue(u.id,{value:!1});e.setValue(i,{value:l})}),r.addEventListener("resetform",a=>{const o=t.defaultFieldValue;a.target.checked=o!=null&&o===t.buttonValue}),this.enableScripting&&this.hasJSActions){const a=t.buttonValue;r.addEventListener("updatefromsandbox",o=>{const l={value:u=>{const d=a===u.detail.value;for(const f of this._getElementsByName(u.target.name)){const p=d&&f.id===i;f.domElement&&(f.domElement.checked=p),e.setValue(f.id,{value:p})}}};this._dispatchEventFromSandbox(l,o)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)}return this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class SG extends y_{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",i=>{this._dispatchEventFromSandbox({},i)})),e}}class AG extends nd{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,i=e.getValue(t,{value:this.data.fieldValue}),s=document.createElement("select");Yh.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,this._setRequired(s,this.data.required),s.name=this.data.fieldName,s.tabIndex=0;let r=this.data.combo&&this.data.options.length>0;this.data.combo||(s.size=this.data.options.length,this.data.multiSelect&&(s.multiple=!0)),s.addEventListener("resetform",d=>{const f=this.data.defaultFieldValue;for(const p of s.options)p.selected=p.value===f});for(const d of this.data.options){const f=document.createElement("option");f.textContent=d.displayValue,f.value=d.exportValue,i.value.includes(d.exportValue)&&(f.setAttribute("selected",!0),r=!1),s.append(f)}let a=null;if(r){const d=document.createElement("option");d.value=" ",d.setAttribute("hidden",!0),d.setAttribute("selected",!0),s.prepend(d),a=()=>{d.remove(),s.removeEventListener("input",a),a=null},s.addEventListener("input",a)}const o=d=>{const f=d?"value":"textContent",{options:p,multiple:g}=s;return g?Array.prototype.filter.call(p,x=>x.selected).map(x=>x[f]):p.selectedIndex===-1?null:p[p.selectedIndex][f]};let l=o(!1);const u=d=>{const f=d.target.options;return Array.prototype.map.call(f,p=>({displayValue:p.textContent,exportValue:p.value}))};return this.enableScripting&&this.hasJSActions?(s.addEventListener("updatefromsandbox",d=>{const f={value(p){a==null||a();const g=p.detail.value,x=new Set(Array.isArray(g)?g:[g]);for(const w of s.options)w.selected=x.has(w.value);e.setValue(t,{value:o(!0)}),l=o(!1)},multipleSelection(p){s.multiple=!0},remove(p){const g=s.options,x=p.detail.remove;g[x].selected=!1,s.remove(x),g.length>0&&Array.prototype.findIndex.call(g,y=>y.selected)===-1&&(g[0].selected=!0),e.setValue(t,{value:o(!0),items:u(p)}),l=o(!1)},clear(p){for(;s.length!==0;)s.remove(0);e.setValue(t,{value:null,items:[]}),l=o(!1)},insert(p){const{index:g,displayValue:x,exportValue:w}=p.detail.insert,y=s.children[g],m=document.createElement("option");m.textContent=x,m.value=w,y?y.before(m):s.append(m),e.setValue(t,{value:o(!0),items:u(p)}),l=o(!1)},items(p){const{items:g}=p.detail;for(;s.length!==0;)s.remove(0);for(const x of g){const{displayValue:w,exportValue:y}=x,m=document.createElement("option");m.textContent=w,m.value=y,s.append(m)}s.options.length>0&&(s.options[0].selected=!0),e.setValue(t,{value:o(!0),items:u(p)}),l=o(!1)},indices(p){const g=new Set(p.detail.indices);for(const x of p.target.options)x.selected=g.has(x.index);e.setValue(t,{value:o(!0)}),l=o(!1)},editable(p){p.target.disabled=!p.detail.editable}};this._dispatchEventFromSandbox(f,d)}),s.addEventListener("input",d=>{var g;const f=o(!0),p=o(!1);e.setValue(t,{value:f}),d.preventDefault(),(g=this.linkService.eventBus)==null||g.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:l,change:p,changeEx:f,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(s,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],d=>d.target.value)):s.addEventListener("input",function(d){e.setValue(t,{value:o(!0)})}),this.data.combo&&this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}var gy,KA;class XA extends _i{constructor(t){const{data:i,elements:s,parent:r}=t,a=!!r._commentManager;super(t,{isRenderable:!a&&_i._hasPopupData(i)});T(this,gy);if(this.elements=s,a&&_i._hasPopupData(i)){const o=this.popup=R(this,gy,KA).call(this);for(const l of s)l.popup=o}else this.popup=null}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const i=this.popup=R(this,gy,KA).call(this),s=[];for(const r of this.elements)r.popup=i,r.container.ariaHasPopup="dialog",s.push(r.data.id),r.addHighlightArea();return this.container.setAttribute("aria-controls",s.map(r=>`${Xd}${r}`).join(",")),this.container}}gy=new WeakSet,KA=function(){return new EG({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})};var zs,mc,v1,x1,up,hp,Di,Pa,yc,lh,dp,fp,Ba,Us,$o,qo,ji,Vo,vc,my,Go,pp,ch,xc,dn,bc,vt,Rx,ZA,QA,JA,Lx,eE,uM,hM,dM,fM,Mx,Ox,tE;class EG{constructor({container:e,color:t,elements:i,titleObj:s,modificationDate:r,contentsObj:a,richText:o,parent:l,rect:u,parentRect:d,open:f,commentManager:p=null}){T(this,vt);T(this,zs,null);T(this,mc,R(this,vt,dM).bind(this));T(this,v1,R(this,vt,tE).bind(this));T(this,x1,R(this,vt,Ox).bind(this));T(this,up,R(this,vt,Mx).bind(this));T(this,hp,null);T(this,Di,null);T(this,Pa,null);T(this,yc,null);T(this,lh,null);T(this,dp,null);T(this,fp,null);T(this,Ba,!1);T(this,Us,null);T(this,$o,null);T(this,qo,null);T(this,ji,null);T(this,Vo,null);T(this,vc,null);T(this,my,null);T(this,Go,null);T(this,pp,null);T(this,ch,null);T(this,xc,!1);T(this,dn,null);T(this,bc,null);_(this,Di,e),_(this,pp,s),_(this,Pa,a),_(this,Go,o),_(this,dp,l),_(this,hp,t),_(this,my,u),_(this,fp,d),_(this,lh,i),_(this,zs,p),_(this,dn,i[0]),_(this,yc,Wb.toDateObject(r)),this.trigger=i.flatMap(g=>g.getElementsToTriggerPopup()),p||(R(this,vt,Rx).call(this),c(this,Di).hidden=!0,f&&R(this,vt,Mx).call(this))}renderCommentButton(){if(c(this,ji)){c(this,ji).parentNode||c(this,dn).container.after(c(this,ji));return}if(c(this,Vo)||R(this,vt,ZA).call(this),!c(this,Vo))return;const{signal:e}=_(this,$o,new AbortController),t=c(this,dn).hasOwnCommentButton,i=()=>{c(this,zs).toggleCommentPopup(this,!0,void 0,!t)},s=()=>{c(this,zs).toggleCommentPopup(this,!1,!0,!t)},r=()=>{c(this,zs).toggleCommentPopup(this,!1,!1)};if(t){_(this,ji,c(this,dn).container);for(const a of this.trigger)a.ariaHasPopup="dialog",a.ariaControls="commentPopup",a.addEventListener("keydown",c(this,mc),{signal:e}),a.addEventListener("click",i,{signal:e}),a.addEventListener("pointerenter",s,{signal:e}),a.addEventListener("pointerleave",r,{signal:e}),a.classList.add("popupTriggerArea")}else{const a=_(this,ji,document.createElement("button"));a.className="annotationCommentButton";const o=c(this,dn).container;a.style.zIndex=o.style.zIndex+1,a.tabIndex=0,a.ariaHasPopup="dialog",a.ariaControls="commentPopup",a.setAttribute("data-l10n-id","pdfjs-show-comment-button"),R(this,vt,JA).call(this),R(this,vt,QA).call(this),a.addEventListener("keydown",c(this,mc),{signal:e}),a.addEventListener("click",i,{signal:e}),a.addEventListener("pointerenter",s,{signal:e}),a.addEventListener("pointerleave",r,{signal:e}),o.after(a)}}get commentButtonColor(){const{color:e,opacity:t}=c(this,dn).commentData;return e?c(this,dp)._commentManager.makeCommentColor(e,t):null}focusCommentButton(){setTimeout(()=>{var e;(e=c(this,ji))==null||e.focus()},0)}getData(){const{richText:e,color:t,opacity:i,creationDate:s,modificationDate:r}=c(this,dn).commentData;return{contentsObj:{str:this.comment},richText:e,color:t,opacity:i,creationDate:s,modificationDate:r}}get elementBeforePopup(){return c(this,ji)}get comment(){return c(this,bc)||_(this,bc,c(this,dn).commentText),c(this,bc)}set comment(e){e!==this.comment&&(c(this,dn).commentText=_(this,bc,e))}focus(){var e;(e=c(this,dn).container)==null||e.focus()}get parentBoundingClientRect(){return c(this,dn).layer.getBoundingClientRect()}setCommentButtonStates({selected:e,hasPopup:t}){c(this,ji)&&(c(this,ji).classList.toggle("selected",e),c(this,ji).ariaExpanded=t)}setSelectedCommentButton(e){c(this,ji).classList.toggle("selected",e)}get commentPopupPosition(){if(c(this,vc))return c(this,vc);const{x:e,y:t,height:i}=c(this,ji).getBoundingClientRect(),{x:s,y:r,width:a,height:o}=c(this,dn).layer.getBoundingClientRect();return[(e-s)/a,(t+i-r)/o]}set commentPopupPosition(e){_(this,vc,e)}hasDefaultPopupPosition(){return c(this,vc)===null}get commentButtonPosition(){return c(this,Vo)}get commentButtonWidth(){return c(this,ji).getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(e){const[t,i]=c(this,vc)||this.commentButtonPosition.map(u=>u/100),s=this.parentBoundingClientRect,{x:r,y:a,width:o,height:l}=s;c(this,zs).showDialog(null,this,r+t*o,a+i*l,{...e,parentDimensions:s})}render(){var i,s;if(c(this,Us))return;const e=_(this,Us,document.createElement("div"));if(e.className="popup",c(this,hp)){const r=e.style.outlineColor=Ye.makeHexColor(...c(this,hp));e.style.backgroundColor=`color-mix(in srgb, ${r} 30%, white)`}const t=document.createElement("span");if(t.className="header",(i=c(this,pp))!=null&&i.str){const r=document.createElement("span");r.className="title",t.append(r),{dir:r.dir,str:r.textContent}=c(this,pp)}if(e.append(t),c(this,yc)){const r=document.createElement("time");r.className="popupDate",r.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),r.setAttribute("data-l10n-args",JSON.stringify({dateObj:c(this,yc).valueOf()})),r.dateTime=c(this,yc).toISOString(),t.append(r)}U4({html:c(this,vt,Lx)||c(this,Pa).str,dir:(s=c(this,Pa))==null?void 0:s.dir,className:"popupContent"},e),c(this,Di).append(e)}updateEdited({rect:e,popup:t,deleted:i}){var s;if(c(this,zs)){i?(this.remove(),_(this,bc,null)):t&&(t.deleted?this.remove():(R(this,vt,JA).call(this),_(this,bc,t.text))),e&&(_(this,Vo,null),R(this,vt,ZA).call(this),R(this,vt,QA).call(this));return}if(i||t!=null&&t.deleted){this.remove();return}R(this,vt,Rx).call(this),c(this,ch)||_(this,ch,{contentsObj:c(this,Pa),richText:c(this,Go)}),e&&_(this,qo,null),t&&t.text&&(_(this,Go,R(this,vt,hM).call(this,t.text)),_(this,yc,Wb.toDateObject(t.date)),_(this,Pa,null)),(s=c(this,Us))==null||s.remove(),_(this,Us,null)}resetEdited(){var e;c(this,ch)&&({contentsObj:en(this,Pa)._,richText:en(this,Go)._}=c(this,ch),_(this,ch,null),(e=c(this,Us))==null||e.remove(),_(this,Us,null),_(this,qo,null))}remove(){var e,t,i;if((e=c(this,$o))==null||e.abort(),_(this,$o,null),(t=c(this,Us))==null||t.remove(),_(this,Us,null),_(this,xc,!1),_(this,Ba,!1),(i=c(this,ji))==null||i.remove(),_(this,ji,null),this.trigger)for(const s of this.trigger)s.classList.remove("popupTriggerArea")}forceHide(){_(this,xc,this.isVisible),c(this,xc)&&(c(this,Di).hidden=!0)}maybeShow(){c(this,zs)||(R(this,vt,Rx).call(this),c(this,xc)&&(c(this,Us)||R(this,vt,Ox).call(this),_(this,xc,!1),c(this,Di).hidden=!1))}get isVisible(){return c(this,zs)?!1:c(this,Di).hidden===!1}}zs=new WeakMap,mc=new WeakMap,v1=new WeakMap,x1=new WeakMap,up=new WeakMap,hp=new WeakMap,Di=new WeakMap,Pa=new WeakMap,yc=new WeakMap,lh=new WeakMap,dp=new WeakMap,fp=new WeakMap,Ba=new WeakMap,Us=new WeakMap,$o=new WeakMap,qo=new WeakMap,ji=new WeakMap,Vo=new WeakMap,vc=new WeakMap,my=new WeakMap,Go=new WeakMap,pp=new WeakMap,ch=new WeakMap,xc=new WeakMap,dn=new WeakMap,bc=new WeakMap,vt=new WeakSet,Rx=function(){var t;if(c(this,$o))return;_(this,$o,new AbortController);const{signal:e}=c(this,$o);for(const i of this.trigger)i.addEventListener("click",c(this,up),{signal:e}),i.addEventListener("pointerenter",c(this,x1),{signal:e}),i.addEventListener("pointerleave",c(this,v1),{signal:e}),i.classList.add("popupTriggerArea");for(const i of c(this,lh))(t=i.container)==null||t.addEventListener("keydown",c(this,mc),{signal:e})},ZA=function(){const e=c(this,lh).find(t=>t.hasCommentButton);e&&_(this,Vo,e._normalizePoint(e.commentButtonPosition))},QA=function(){if(c(this,dn).extraPopupElement&&!c(this,dn).editor)return;c(this,ji)||this.renderCommentButton();const[e,t]=c(this,Vo),{style:i}=c(this,ji);i.left=`calc(${e}%)`,i.top=`calc(${t}% - var(--comment-button-dim))`},JA=function(){c(this,dn).extraPopupElement||(c(this,ji)||this.renderCommentButton(),c(this,ji).style.backgroundColor=this.commentButtonColor||"")},Lx=function(){const e=c(this,Go),t=c(this,Pa);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&c(this,Go).html||null},eE=function(){var e,t,i;return((i=(t=(e=c(this,vt,Lx))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:i.fontSize)||0},uM=function(){var e,t,i;return((i=(t=(e=c(this,vt,Lx))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:i.color)||null},hM=function(e){const t=[],i={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},s={style:{color:c(this,vt,uM),fontSize:c(this,vt,eE)?`calc(${c(this,vt,eE)}px * var(--total-scale-factor))`:""}};for(const r of e.split(`
`))t.push({name:"span",value:r,attributes:s});return i},dM=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&c(this,Ba))&&R(this,vt,Mx).call(this)},fM=function(){if(c(this,qo)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:i,pageX:s,pageY:r}}}=c(this,dp);let a=!!c(this,fp),o=a?c(this,fp):c(this,my);for(const x of c(this,lh))if(!o||Ye.intersect(x.data.rect,o)!==null){o=x.data.rect,a=!0;break}const l=Ye.normalizeRect([o[0],e[3]-o[1]+e[1],o[2],e[3]-o[3]+e[1]]),d=a?o[2]-o[0]+5:0,f=l[0]+d,p=l[1];_(this,qo,[100*(f-s)/t,100*(p-r)/i]);const{style:g}=c(this,Di);g.left=`${c(this,qo)[0]}%`,g.top=`${c(this,qo)[1]}%`},Mx=function(){if(c(this,zs)){c(this,zs).toggleCommentPopup(this,!1);return}_(this,Ba,!c(this,Ba)),c(this,Ba)?(R(this,vt,Ox).call(this),c(this,Di).addEventListener("click",c(this,up)),c(this,Di).addEventListener("keydown",c(this,mc))):(R(this,vt,tE).call(this),c(this,Di).removeEventListener("click",c(this,up)),c(this,Di).removeEventListener("keydown",c(this,mc)))},Ox=function(){c(this,Us)||this.render(),this.isVisible?c(this,Ba)&&c(this,Di).classList.add("focused"):(R(this,vt,fM).call(this),c(this,Di).hidden=!1,c(this,Di).style.zIndex=parseInt(c(this,Di).style.zIndex)+1e3)},tE=function(){c(this,Di).classList.remove("focused"),!(c(this,Ba)||!this.isVisible)&&(c(this,Di).hidden=!0,c(this,Di).style.zIndex=parseInt(c(this,Di).style.zIndex)-1e3)};class pM extends _i{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=ft.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=this.contentElement=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const i=document.createElement("span");i.textContent=t,e.append(i)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}var yy;class CG extends _i{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});T(this,yy,null)}render(){this.container.classList.add("lineAnnotation");const{data:t,width:i,height:s}=this,r=this.svgFactory.create(i,s,!0),a=_(this,yy,this.svgFactory.createElement("svg:line"));return a.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),a.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),a.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),a.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),a.setAttribute("stroke-width",t.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return c(this,yy)}addHighlightArea(){this.container.classList.add("highlightArea")}}yy=new WeakMap;var vy;class _G extends _i{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});T(this,vy,null)}render(){this.container.classList.add("squareAnnotation");const{data:t,width:i,height:s}=this,r=this.svgFactory.create(i,s,!0),a=t.borderStyle.width,o=_(this,vy,this.svgFactory.createElement("svg:rect"));return o.setAttribute("x",a/2),o.setAttribute("y",a/2),o.setAttribute("width",i-a),o.setAttribute("height",s-a),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return c(this,vy)}addHighlightArea(){this.container.classList.add("highlightArea")}}vy=new WeakMap;var xy;class NG extends _i{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});T(this,xy,null)}render(){this.container.classList.add("circleAnnotation");const{data:t,width:i,height:s}=this,r=this.svgFactory.create(i,s,!0),a=t.borderStyle.width,o=_(this,xy,this.svgFactory.createElement("svg:ellipse"));return o.setAttribute("cx",i/2),o.setAttribute("cy",s/2),o.setAttribute("rx",i/2-a/2),o.setAttribute("ry",s/2-a/2),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return c(this,xy)}addHighlightArea(){this.container.classList.add("highlightArea")}}xy=new WeakMap;var by;class gM extends _i{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});T(this,by,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:i,borderStyle:s,popupRef:r},width:a,height:o}=this;if(!i)return this.container;const l=this.svgFactory.create(a,o,!0);let u=[];for(let f=0,p=i.length;f<p;f+=2){const g=i[f]-t[0],x=t[3]-i[f+1];u.push(`${g},${x}`)}u=u.join(" ");const d=_(this,by,this.svgFactory.createElement(this.svgElementName));return d.setAttribute("points",u),d.setAttribute("stroke-width",s.width||1),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),l.append(d),this.container.append(l),!r&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return c(this,by)}addHighlightArea(){this.container.classList.add("highlightArea")}}by=new WeakMap;class kG extends gM{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class TG extends _i{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}var wy,uh,Sy,iE;class v_ extends _i{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});T(this,Sy);T(this,wy,null);T(this,uh,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?ft.HIGHLIGHT:ft.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:i,inkLists:s,borderStyle:r,popupRef:a}}=this,{transform:o,width:l,height:u}=R(this,Sy,iE).call(this,i,t),d=this.svgFactory.create(l,u,!0),f=_(this,wy,this.svgFactory.createElement("svg:g"));d.append(f),f.setAttribute("stroke-width",r.width||1),f.setAttribute("stroke-linecap","round"),f.setAttribute("stroke-linejoin","round"),f.setAttribute("stroke-miterlimit",10),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),f.setAttribute("transform",o);for(let p=0,g=s.length;p<g;p++){const x=this.svgFactory.createElement(this.svgElementName);c(this,uh).push(x),x.setAttribute("points",s[p].join(",")),f.append(x)}return!a&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(d),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:i,points:s,rect:r}=t,a=c(this,wy);if(i>=0&&a.setAttribute("stroke-width",i||1),s)for(let o=0,l=c(this,uh).length;o<l;o++)c(this,uh)[o].setAttribute("points",s[o].join(","));if(r){const{transform:o,width:l,height:u}=R(this,Sy,iE).call(this,this.data.rotation,r);a.parentElement.setAttribute("viewBox",`0 0 ${l} ${u}`),a.setAttribute("transform",o)}}getElementsToTriggerPopup(){return c(this,uh)}addHighlightArea(){this.container.classList.add("highlightArea")}}wy=new WeakMap,uh=new WeakMap,Sy=new WeakSet,iE=function(t,i){switch(t){case 90:return{transform:`rotate(90) translate(${-i[0]},${i[1]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};case 180:return{transform:`rotate(180) translate(${-i[2]},${i[1]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]};case 270:return{transform:`rotate(270) translate(${-i[2]},${i[3]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};default:return{transform:`translate(${-i[0]},${i[3]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]}}};class mM extends _i{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=ft.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const i=document.createElement("mark");i.classList.add("overlaidText"),i.textContent=e,this.container.append(i)}return this.container}}class DG extends _i{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),e){const i=document.createElement("u");i.classList.add("overlaidText"),i.textContent=e,this.container.append(i)}return this.container}}class jG extends _i{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),e){const i=document.createElement("u");i.classList.add("overlaidText"),i.textContent=e,this.container.append(i)}return this.container}}class RG extends _i{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),e){const i=document.createElement("s");i.classList.add("overlaidText"),i.textContent=e,this.container.append(i)}return this.container}}class yM extends _i{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=ft.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}var Ay,Ey,nE;class LG extends _i{constructor(t){var s;super(t,{isRenderable:!0});T(this,Ey);T(this,Ay,null);const{file:i}=this.data;this.filename=i.filename,this.content=i.content,(s=this.linkService.eventBus)==null||s.dispatch("fileattachmentannotation",{source:this,...i})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:i}=this;let s;i.hasAppearance||i.fillAlpha===0?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(i.name)?"paperclip":"pushpin"}.svg`,i.fillAlpha&&i.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(i.fillAlpha*100)}%);`)),s.addEventListener("dblclick",R(this,Ey,nE).bind(this)),_(this,Ay,s);const{isMac:r}=on.platform;return t.addEventListener("keydown",a=>{a.key==="Enter"&&(r?a.metaKey:a.ctrlKey)&&R(this,Ey,nE).call(this)}),!i.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):s.classList.add("popupTriggerArea"),t.append(s),t}getElementsToTriggerPopup(){return c(this,Ay)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ay=new WeakMap,Ey=new WeakSet,nE=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var hh,dh,gp,wc,Cy,fh,Hs,_y,hl,Ix,rE;const __=class __{constructor({div:e,accessibilityManager:t,annotationCanvasMap:i,annotationEditorUIManager:s,page:r,viewport:a,structTreeLayer:o,commentManager:l,linkService:u,annotationStorage:d}){T(this,hl);T(this,hh,null);T(this,dh,null);T(this,gp,null);T(this,wc,new Map);T(this,Cy,null);T(this,fh,null);T(this,Hs,[]);T(this,_y,!1);this.div=e,_(this,hh,t),_(this,dh,i),_(this,Cy,o||null),_(this,fh,u||null),_(this,gp,d||new f_),this.page=r,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=s,this._commentManager=l||null}hasEditableAnnotations(){return c(this,wc).size>0}async render(e){var o;const{annotations:t}=e,i=this.div;Vh(i,this.viewport);const s=new Map,r=[],a={data:null,layer:i,linkService:c(this,fh),downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new i1,annotationStorage:c(this,gp),enableComment:e.enableComment===!0,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const l of t){if(l.noHTML)continue;const u=l.annotationType===Gi.POPUP;if(u){const p=s.get(l.id);if(!p)continue;if(!this._commentManager){r.push(l);continue}a.elements=p}else if(l.rect[2]===l.rect[0]||l.rect[3]===l.rect[1])continue;a.data=l;const d=O2.create(a);if(!d.isRenderable)continue;if(!u&&(c(this,Hs).push(d),l.popupRef)){const p=s.get(l.popupRef);p?p.push(d):s.set(l.popupRef,[d])}const f=d.render();l.hidden&&(f.style.visibility="hidden"),d._isEditable&&(c(this,wc).set(d.data.id,d),(o=this._annotationEditorUIManager)==null||o.renderAnnotationElement(d))}await R(this,hl,Ix).call(this);for(const l of r){const u=a.elements=s.get(l.id);a.data=l;const d=O2.create(a);if(!d.isRenderable)continue;const f=d.render();d.contentElement.id=`${Xd}${l.id}`,l.hidden&&(f.style.visibility="hidden"),u.at(-1).container.after(f)}R(this,hl,rE).call(this)}async addLinkAnnotations(e){const t={data:null,layer:this.div,linkService:c(this,fh),svgFactory:new i1,parent:this};for(const i of e){i.borderStyle||(i.borderStyle=__._defaultBorderStyle),t.data=i;const s=O2.create(t);s.isRenderable&&(s.render(),s.contentElement.id=`${Xd}${i.id}`,c(this,Hs).push(s))}await R(this,hl,Ix).call(this)}update({viewport:e}){const t=this.div;this.viewport=e,Vh(t,{rotation:e.rotation}),R(this,hl,rE).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(c(this,wc).values())}getEditableAnnotation(e){return c(this,wc).get(e)}addFakeAnnotation(e){const{div:t}=this,{id:i,rotation:s}=e,r=new yG({data:{id:i,rect:e.getPDFRect(),rotation:s},editor:e,layer:t,parent:this,enableComment:!!this._commentManager,linkService:c(this,fh),annotationStorage:c(this,gp)});return r.render(),r.contentElement.id=`${Xd}${i}`,r.createOrUpdatePopup(),c(this,Hs).push(r),r}removeAnnotation(e){var s;const t=c(this,Hs).findIndex(r=>r.data.id===e);if(t<0)return;const[i]=c(this,Hs).splice(t,1);(s=c(this,hh))==null||s.removePointerInTextLayer(i.contentElement)}updateFakeAnnotations(e){if(e.length!==0){for(const t of e)t.updateFakeAnnotationElement(this);R(this,hl,Ix).call(this)}}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}static get _defaultBorderStyle(){return ut(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:kd.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}};hh=new WeakMap,dh=new WeakMap,gp=new WeakMap,wc=new WeakMap,Cy=new WeakMap,fh=new WeakMap,Hs=new WeakMap,_y=new WeakMap,hl=new WeakSet,Ix=async function(){var i,s,r;if(c(this,Hs).length===0)return;this.div.replaceChildren();const e=[];if(!c(this,_y)){_(this,_y,!0);for(const{contentElement:a,data:{id:o}}of c(this,Hs)){const l=a.id=`${Xd}${o}`;e.push((i=c(this,Cy))==null?void 0:i.getAriaAttributes(l).then(u=>{if(u)for(const[d,f]of u)a.setAttribute(d,f)}))}}c(this,Hs).sort(({data:{rect:[a,o,l,u]}},{data:{rect:[d,f,p,g]}})=>{if(a===l&&o===u)return 1;if(d===p&&f===g)return-1;const x=u,w=o,y=(o+u)/2,m=g,v=f,b=(f+g)/2;if(y>=m&&b<=w)return-1;if(b>=x&&y<=v)return 1;const A=(a+l)/2,S=(d+p)/2;return A-S});const t=document.createDocumentFragment();for(const a of c(this,Hs))t.append(a.container),this._commentManager?(r=((s=a.extraPopupElement)==null?void 0:s.popup)||a.popup)==null||r.renderCommentButton():a.extraPopupElement&&t.append(a.extraPopupElement.render());if(this.div.append(t),await Promise.all(e),c(this,hh))for(const a of c(this,Hs))c(this,hh).addPointerInTextLayer(a.contentElement,!1)},rE=function(){var t;if(!c(this,dh))return;const e=this.div;for(const[i,s]of c(this,dh)){const r=e.querySelector(`[data-annotation-id="${i}"]`);if(!r)continue;s.className="annotationContent";const{firstChild:a}=r;a?a.nodeName==="CANVAS"?a.replaceWith(s):a.classList.contains("annotationContent")?a.after(s):a.before(s):r.append(s);const o=c(this,wc).get(i);o&&(o._hasNoCanvas?((t=this._annotationEditorUIManager)==null||t.setMissingCanvas(i,r.id,s),o._hasNoCanvas=!1):o.canvas=s)}c(this,dh).clear()};let sE=__;const Xv=/\r\n?|\n/g;var $s,Ny,ph,qs,Qi,vM,xM,bM,Px,dl,Bx,Fx,wM,oE,SM;const pi=class pi extends hi{constructor(t){super({...t,name:"freeTextEditor"});T(this,Qi);T(this,$s,"");T(this,Ny,`${this.id}-editor`);T(this,ph,null);T(this,qs);fe(this,"_colorPicker",null);this.color=t.color||pi._defaultColor||hi._defaultLineColor,_(this,qs,t.fontSize||pi._defaultFontSize),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static get _keyboardManager(){const t=pi.prototype,i=a=>a.isEmpty(),s=Gh.TRANSLATE_SMALL,r=Gh.TRANSLATE_BIG;return ut(this,"_keyboardManager",new yv([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:i}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[s,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[r,0],checker:i}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:i}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,s],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,r],checker:i}]]))}static initialize(t,i){hi.initialize(t,i);const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,i){switch(t){case Tt.FREETEXT_SIZE:pi._defaultFontSize=i;break;case Tt.FREETEXT_COLOR:pi._defaultColor=i;break}}updateParams(t,i){switch(t){case Tt.FREETEXT_SIZE:R(this,Qi,vM).call(this,i);break;case Tt.FREETEXT_COLOR:R(this,Qi,xM).call(this,i);break}}static get defaultPropertiesToUpdate(){return[[Tt.FREETEXT_SIZE,pi._defaultFontSize],[Tt.FREETEXT_COLOR,pi._defaultColor||hi._defaultLineColor]]}get propertiesToUpdate(){return[[Tt.FREETEXT_SIZE,c(this,qs)],[Tt.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new t1(this)),[["colorPicker",this._colorPicker]]}get colorType(){return Tt.FREETEXT_COLOR}onUpdatedColor(){var t;this.editorDiv.style.color=this.color,(t=this._colorPicker)==null||t.update(this.color),super.onUpdatedColor()}_translateEmpty(t,i){this._uiManager.translateSelectedEditors(t,i,!0)}getInitialTranslation(){const t=this.parentScale;return[-pi._internalPadding*t,-(pi._internalPadding+c(this,qs))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),_(this,ph,new AbortController);const t=this._uiManager.combinedSignal(c(this,ph));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){var t;return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",c(this,Ny)),this._isDraggable=!0,(t=c(this,ph))==null||t.abort(),_(this,ph,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var i;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(i=this._initialOptions)!=null&&i.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=c(this,$s),i=_(this,$s,R(this,Qi,bM).call(this).trimEnd());if(t===i)return;const s=r=>{if(_(this,$s,r),!r){this.remove();return}R(this,Qi,Fx).call(this),this._uiManager.rebuild(this),R(this,Qi,Px).call(this)};this.addCommands({cmd:()=>{s(i)},undo:()=>{s(t)},mustExec:!1}),R(this,Qi,Px).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){pi._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,i;(this._isCopy||this.annotationElementId)&&(t=this.x,i=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",c(this,Ny)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${c(this,qs)}px * var(--total-scale-factor))`,s.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[r,a]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[l,u]=this.getInitialTranslation();[l,u]=this.pageTranslationToScreen(l,u);const[d,f]=this.pageDimensions,[p,g]=this.pageTranslation;let x,w;switch(this.rotation){case 0:x=t+(o[0]-p)/d,w=i+this.height-(o[1]-g)/f;break;case 90:x=t+(o[0]-p)/d,w=i-(o[1]-g)/f,[l,u]=[u,-l];break;case 180:x=t-this.width+(o[0]-p)/d,w=i-(o[1]-g)/f,[l,u]=[-l,-u];break;case 270:x=t+(o[0]-p-this.height*f)/d,w=i+(o[1]-g-this.width*d)/f,[l,u]=[-u,l];break}this.setAt(x*r,w*a,l,u)}else this._moveAfterPaste(t,i);R(this,Qi,Fx).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var x,w,y;const i=t.clipboardData||window.clipboardData,{types:s}=i;if(s.length===1&&s[0]==="text/plain")return;t.preventDefault();const r=R(x=pi,dl,oE).call(x,i.getData("text")||"").replaceAll(Xv,`
`);if(!r)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const o=a.getRangeAt(0);if(!r.includes(`
`)){o.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:l,startOffset:u}=o,d=[],f=[];if(l.nodeType===Node.TEXT_NODE){const m=l.parentElement;if(f.push(l.nodeValue.slice(u).replaceAll(Xv,"")),m!==this.editorDiv){let v=d;for(const b of this.editorDiv.childNodes){if(b===m){v=f;continue}v.push(R(w=pi,dl,Bx).call(w,b))}}d.push(l.nodeValue.slice(0,u).replaceAll(Xv,""))}else if(l===this.editorDiv){let m=d,v=0;for(const b of this.editorDiv.childNodes)v++===u&&(m=f),m.push(R(y=pi,dl,Bx).call(y,b))}_(this,$s,`${d.join(`
`)}${r}${f.join(`
`)}`),R(this,Qi,Fx).call(this);const p=new Range;let g=Math.sumPrecise(d.map(m=>m.length));for(const{firstChild:m}of this.editorDiv.childNodes)if(m.nodeType===Node.TEXT_NODE){const v=m.nodeValue.length;if(g<=v){p.setStart(m,g),p.setEnd(m,g);break}g-=v}a.removeAllRanges(),a.addRange(p)}get contentDiv(){return this.editorDiv}getPDFRect(){const t=pi._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,i,s){var o;let r=null;if(t instanceof pM){const{data:{defaultAppearanceData:{fontSize:l,fontColor:u},rect:d,rotation:f,id:p,popupRef:g,richText:x,contentsObj:w,creationDate:y,modificationDate:m},textContent:v,textPosition:b,parent:{page:{pageNumber:A}}}=t;if(!v||v.length===0)return null;r=t={annotationType:ft.FREETEXT,color:Array.from(u),fontSize:l,value:v.join(`
`),position:b,pageIndex:A-1,rect:d.slice(0),rotation:f,annotationElementId:p,id:p,deleted:!1,popupRef:g,comment:(w==null?void 0:w.str)||null,richText:x,creationDate:y,modificationDate:m}}const a=await super.deserialize(t,i,s);return _(a,qs,t.fontSize),a.color=Ye.makeHexColor(...t.color),_(a,$s,R(o=pi,dl,oE).call(o,t.value)),a._initialData=r,t.comment&&a.setCommentData(t),a}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=hi._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),s=Object.assign(super.serialize(t),{color:i,fontSize:c(this,qs),value:R(this,Qi,wM).call(this)});return this.addComment(s),t?(s.isCopy=!0,s):this.annotationElementId&&!R(this,Qi,SM).call(this,s)?null:(s.id=this.annotationElementId,s)}renderAnnotationElement(t){const i=super.renderAnnotationElement(t);if(!i)return null;const{style:s}=i;s.fontSize=`calc(${c(this,qs)}px * var(--total-scale-factor))`,s.color=this.color,i.replaceChildren();for(const r of c(this,$s).split(`
`)){const a=document.createElement("div");a.append(r?document.createTextNode(r):document.createElement("br")),i.append(a)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:c(this,$s)}}),i}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};$s=new WeakMap,Ny=new WeakMap,ph=new WeakMap,qs=new WeakMap,Qi=new WeakSet,vM=function(t){const i=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--total-scale-factor))`,this.translate(0,-(r-c(this,qs))*this.parentScale),_(this,qs,r),R(this,Qi,Px).call(this)},s=c(this,qs);this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Tt.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},xM=function(t){const i=r=>{this.color=r,this.onUpdatedColor()},s=this.color;this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Tt.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},bM=function(){var s;const t=[];this.editorDiv.normalize();let i=null;for(const r of this.editorDiv.childNodes)(i==null?void 0:i.nodeType)===Node.TEXT_NODE&&r.nodeName==="BR"||(t.push(R(s=pi,dl,Bx).call(s,r)),i=r);return t.join(`
`)},Px=function(){const[t,i]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:r,div:a}=this,o=a.style.display,l=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",r.div.append(this.div),s=a.getBoundingClientRect(),a.remove(),a.style.display=o,a.classList.toggle("hidden",l)}this.rotation%180===this.parentRotation%180?(this.width=s.width/t,this.height=s.height/i):(this.width=s.height/t,this.height=s.width/i),this.fixAndSetPosition()},dl=new WeakSet,Bx=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(Xv,"")},Fx=function(){if(this.editorDiv.replaceChildren(),!!c(this,$s))for(const t of c(this,$s).split(`
`)){const i=document.createElement("div");i.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(i)}},wM=function(){return c(this,$s).replaceAll("Â "," ")},oE=function(t){return t.replaceAll(" ","Â ")},SM=function(t){const{value:i,fontSize:s,color:r,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==i||t.fontSize!==s||t.color.some((o,l)=>o!==r[l])||t.pageIndex!==a},T(pi,dl),fe(pi,"_freeTextDefaultContent",""),fe(pi,"_internalPadding",0),fe(pi,"_defaultColor",null),fe(pi,"_defaultFontSize",10),fe(pi,"_type","freetext"),fe(pi,"_editorType",ft.FREETEXT);let aE=pi;class Ke{toSVGPath(){zt("Abstract method `toSVGPath` must be implemented.")}get box(){zt("Abstract getter `box` must be implemented.")}serialize(e,t){zt("Abstract method `serialize` must be implemented.")}static _rescale(e,t,i,s,r,a){a||(a=new Float32Array(e.length));for(let o=0,l=e.length;o<l;o+=2)a[o]=t+e[o]*s,a[o+1]=i+e[o+1]*r;return a}static _rescaleAndSwap(e,t,i,s,r,a){a||(a=new Float32Array(e.length));for(let o=0,l=e.length;o<l;o+=2)a[o]=t+e[o+1]*s,a[o+1]=i+e[o]*r;return a}static _translate(e,t,i,s){s||(s=new Float32Array(e.length));for(let r=0,a=e.length;r<a;r+=2)s[r]=t+e[r],s[r+1]=i+e[r+1];return s}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,i,s,r){switch(r){case 90:return[1-t/i,e/s];case 180:return[1-e/i,1-t/s];case 270:return[t/i,1-e/s];default:return[e/i,t/s]}}static _normalizePagePoint(e,t,i){switch(i){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,i,s,r,a){return[(e+5*i)/6,(t+5*s)/6,(5*i+r)/6,(5*s+a)/6,(i+r)/2,(s+a)/2]}}fe(Ke,"PRECISION",1e-4);var Vs,oa,mp,yp,Fa,wt,gh,mh,ky,Ty,vp,xp,Sc,Dy,b1,w1,an,tm,AM,EM,CM,_M,NM,kM;const mo=class mo{constructor({x:e,y:t},i,s,r,a,o=0){T(this,an);T(this,Vs);T(this,oa,[]);T(this,mp);T(this,yp);T(this,Fa,[]);T(this,wt,new Float32Array(18));T(this,gh);T(this,mh);T(this,ky);T(this,Ty);T(this,vp);T(this,xp);T(this,Sc,[]);_(this,Vs,i),_(this,xp,r*s),_(this,yp,a),c(this,wt).set([NaN,NaN,NaN,NaN,e,t],6),_(this,mp,o),_(this,Ty,c(mo,Dy)*s),_(this,ky,c(mo,w1)*s),_(this,vp,s),c(this,Sc).push(e,t)}isEmpty(){return isNaN(c(this,wt)[8])}add({x:e,y:t}){var D;_(this,gh,e),_(this,mh,t);const[i,s,r,a]=c(this,Vs);let[o,l,u,d]=c(this,wt).subarray(8,12);const f=e-u,p=t-d,g=Math.hypot(f,p);if(g<c(this,ky))return!1;const x=g-c(this,Ty),w=x/g,y=w*f,m=w*p;let v=o,b=l;o=u,l=d,u+=y,d+=m,(D=c(this,Sc))==null||D.push(e,t);const A=-m/x,S=y/x,C=A*c(this,xp),k=S*c(this,xp);return c(this,wt).set(c(this,wt).subarray(2,8),0),c(this,wt).set([u+C,d+k],4),c(this,wt).set(c(this,wt).subarray(14,18),12),c(this,wt).set([u-C,d-k],16),isNaN(c(this,wt)[6])?(c(this,Fa).length===0&&(c(this,wt).set([o+C,l+k],2),c(this,Fa).push(NaN,NaN,NaN,NaN,(o+C-i)/r,(l+k-s)/a),c(this,wt).set([o-C,l-k],14),c(this,oa).push(NaN,NaN,NaN,NaN,(o-C-i)/r,(l-k-s)/a)),c(this,wt).set([v,b,o,l,u,d],6),!this.isEmpty()):(c(this,wt).set([v,b,o,l,u,d],6),Math.abs(Math.atan2(b-l,v-o)-Math.atan2(m,y))<Math.PI/2?([o,l,u,d]=c(this,wt).subarray(2,6),c(this,Fa).push(NaN,NaN,NaN,NaN,((o+u)/2-i)/r,((l+d)/2-s)/a),[o,l,v,b]=c(this,wt).subarray(14,18),c(this,oa).push(NaN,NaN,NaN,NaN,((v+o)/2-i)/r,((b+l)/2-s)/a),!0):([v,b,o,l,u,d]=c(this,wt).subarray(0,6),c(this,Fa).push(((v+5*o)/6-i)/r,((b+5*l)/6-s)/a,((5*o+u)/6-i)/r,((5*l+d)/6-s)/a,((o+u)/2-i)/r,((l+d)/2-s)/a),[u,d,o,l,v,b]=c(this,wt).subarray(12,18),c(this,oa).push(((v+5*o)/6-i)/r,((b+5*l)/6-s)/a,((5*o+u)/6-i)/r,((5*l+d)/6-s)/a,((o+u)/2-i)/r,((l+d)/2-s)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const e=c(this,Fa),t=c(this,oa);if(isNaN(c(this,wt)[6])&&!this.isEmpty())return R(this,an,AM).call(this);const i=[];i.push(`M${e[4]} ${e[5]}`);for(let s=6;s<e.length;s+=6)isNaN(e[s])?i.push(`L${e[s+4]} ${e[s+5]}`):i.push(`C${e[s]} ${e[s+1]} ${e[s+2]} ${e[s+3]} ${e[s+4]} ${e[s+5]}`);R(this,an,CM).call(this,i);for(let s=t.length-6;s>=6;s-=6)isNaN(t[s])?i.push(`L${t[s+4]} ${t[s+5]}`):i.push(`C${t[s]} ${t[s+1]} ${t[s+2]} ${t[s+3]} ${t[s+4]} ${t[s+5]}`);return R(this,an,EM).call(this,i),i.join(" ")}newFreeDrawOutline(e,t,i,s,r,a){return new TM(e,t,i,s,r,a)}getOutlines(){var f;const e=c(this,Fa),t=c(this,oa),i=c(this,wt),[s,r,a,o]=c(this,Vs),l=new Float32Array((((f=c(this,Sc))==null?void 0:f.length)??0)+2);for(let p=0,g=l.length-2;p<g;p+=2)l[p]=(c(this,Sc)[p]-s)/a,l[p+1]=(c(this,Sc)[p+1]-r)/o;if(l[l.length-2]=(c(this,gh)-s)/a,l[l.length-1]=(c(this,mh)-r)/o,isNaN(i[6])&&!this.isEmpty())return R(this,an,_M).call(this,l);const u=new Float32Array(c(this,Fa).length+24+c(this,oa).length);let d=e.length;for(let p=0;p<d;p+=2){if(isNaN(e[p])){u[p]=u[p+1]=NaN;continue}u[p]=e[p],u[p+1]=e[p+1]}d=R(this,an,kM).call(this,u,d);for(let p=t.length-6;p>=6;p-=6)for(let g=0;g<6;g+=2){if(isNaN(t[p+g])){u[d]=u[d+1]=NaN,d+=2;continue}u[d]=t[p+g],u[d+1]=t[p+g+1],d+=2}return R(this,an,NM).call(this,u,d),this.newFreeDrawOutline(u,l,c(this,Vs),c(this,vp),c(this,mp),c(this,yp))}};Vs=new WeakMap,oa=new WeakMap,mp=new WeakMap,yp=new WeakMap,Fa=new WeakMap,wt=new WeakMap,gh=new WeakMap,mh=new WeakMap,ky=new WeakMap,Ty=new WeakMap,vp=new WeakMap,xp=new WeakMap,Sc=new WeakMap,Dy=new WeakMap,b1=new WeakMap,w1=new WeakMap,an=new WeakSet,tm=function(){const e=c(this,wt).subarray(4,6),t=c(this,wt).subarray(16,18),[i,s,r,a]=c(this,Vs);return[(c(this,gh)+(e[0]-t[0])/2-i)/r,(c(this,mh)+(e[1]-t[1])/2-s)/a,(c(this,gh)+(t[0]-e[0])/2-i)/r,(c(this,mh)+(t[1]-e[1])/2-s)/a]},AM=function(){const[e,t,i,s]=c(this,Vs),[r,a,o,l]=R(this,an,tm).call(this);return`M${(c(this,wt)[2]-e)/i} ${(c(this,wt)[3]-t)/s} L${(c(this,wt)[4]-e)/i} ${(c(this,wt)[5]-t)/s} L${r} ${a} L${o} ${l} L${(c(this,wt)[16]-e)/i} ${(c(this,wt)[17]-t)/s} L${(c(this,wt)[14]-e)/i} ${(c(this,wt)[15]-t)/s} Z`},EM=function(e){const t=c(this,oa);e.push(`L${t[4]} ${t[5]} Z`)},CM=function(e){const[t,i,s,r]=c(this,Vs),a=c(this,wt).subarray(4,6),o=c(this,wt).subarray(16,18),[l,u,d,f]=R(this,an,tm).call(this);e.push(`L${(a[0]-t)/s} ${(a[1]-i)/r} L${l} ${u} L${d} ${f} L${(o[0]-t)/s} ${(o[1]-i)/r}`)},_M=function(e){const t=c(this,wt),[i,s,r,a]=c(this,Vs),[o,l,u,d]=R(this,an,tm).call(this),f=new Float32Array(36);return f.set([NaN,NaN,NaN,NaN,(t[2]-i)/r,(t[3]-s)/a,NaN,NaN,NaN,NaN,(t[4]-i)/r,(t[5]-s)/a,NaN,NaN,NaN,NaN,o,l,NaN,NaN,NaN,NaN,u,d,NaN,NaN,NaN,NaN,(t[16]-i)/r,(t[17]-s)/a,NaN,NaN,NaN,NaN,(t[14]-i)/r,(t[15]-s)/a],0),this.newFreeDrawOutline(f,e,c(this,Vs),c(this,vp),c(this,mp),c(this,yp))},NM=function(e,t){const i=c(this,oa);return e.set([NaN,NaN,NaN,NaN,i[4],i[5]],t),t+=6},kM=function(e,t){const i=c(this,wt).subarray(4,6),s=c(this,wt).subarray(16,18),[r,a,o,l]=c(this,Vs),[u,d,f,p]=R(this,an,tm).call(this);return e.set([NaN,NaN,NaN,NaN,(i[0]-r)/o,(i[1]-a)/l,NaN,NaN,NaN,NaN,u,d,NaN,NaN,NaN,NaN,f,p,NaN,NaN,NaN,NaN,(s[0]-r)/o,(s[1]-a)/l],t),t+=24},T(mo,Dy,8),T(mo,b1,2),T(mo,w1,c(mo,Dy)+c(mo,b1));let n1=mo;var bp,yh,Yo,jy,Gs,Ry,zi,S1,DM;class TM extends Ke{constructor(t,i,s,r,a,o){super();T(this,S1);T(this,bp);T(this,yh,new Float32Array(4));T(this,Yo);T(this,jy);T(this,Gs);T(this,Ry);T(this,zi);_(this,zi,t),_(this,Gs,i),_(this,bp,s),_(this,Ry,r),_(this,Yo,a),_(this,jy,o),this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],R(this,S1,DM).call(this,o);const[l,u,d,f]=c(this,yh);for(let p=0,g=t.length;p<g;p+=2)t[p]=(t[p]-l)/d,t[p+1]=(t[p+1]-u)/f;for(let p=0,g=i.length;p<g;p+=2)i[p]=(i[p]-l)/d,i[p+1]=(i[p+1]-u)/f}toSVGPath(){const t=[`M${c(this,zi)[4]} ${c(this,zi)[5]}`];for(let i=6,s=c(this,zi).length;i<s;i+=6){if(isNaN(c(this,zi)[i])){t.push(`L${c(this,zi)[i+4]} ${c(this,zi)[i+5]}`);continue}t.push(`C${c(this,zi)[i]} ${c(this,zi)[i+1]} ${c(this,zi)[i+2]} ${c(this,zi)[i+3]} ${c(this,zi)[i+4]} ${c(this,zi)[i+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,i,s,r],a){const o=s-t,l=r-i;let u,d;switch(a){case 0:u=Ke._rescale(c(this,zi),t,r,o,-l),d=Ke._rescale(c(this,Gs),t,r,o,-l);break;case 90:u=Ke._rescaleAndSwap(c(this,zi),t,i,o,l),d=Ke._rescaleAndSwap(c(this,Gs),t,i,o,l);break;case 180:u=Ke._rescale(c(this,zi),s,i,-o,l),d=Ke._rescale(c(this,Gs),s,i,-o,l);break;case 270:u=Ke._rescaleAndSwap(c(this,zi),s,r,-o,-l),d=Ke._rescaleAndSwap(c(this,Gs),s,r,-o,-l);break}return{outline:Array.from(u),points:[Array.from(d)]}}get box(){return c(this,yh)}newOutliner(t,i,s,r,a,o=0){return new n1(t,i,s,r,a,o)}getNewOutline(t,i){const[s,r,a,o]=c(this,yh),[l,u,d,f]=c(this,bp),p=a*d,g=o*f,x=s*d+l,w=r*f+u,y=this.newOutliner({x:c(this,Gs)[0]*p+x,y:c(this,Gs)[1]*g+w},c(this,bp),c(this,Ry),t,c(this,jy),i??c(this,Yo));for(let m=2;m<c(this,Gs).length;m+=2)y.add({x:c(this,Gs)[m]*p+x,y:c(this,Gs)[m+1]*g+w});return y.getOutlines()}}bp=new WeakMap,yh=new WeakMap,Yo=new WeakMap,jy=new WeakMap,Gs=new WeakMap,Ry=new WeakMap,zi=new WeakMap,S1=new WeakSet,DM=function(t){const i=c(this,zi);let s=i[4],r=i[5];const a=[s,r,s,r];let o=s,l=r,u=s,d=r;const f=t?Math.max:Math.min,p=new Float32Array(4);for(let x=6,w=i.length;x<w;x+=6){const y=i[x+4],m=i[x+5];isNaN(i[x])?(Ye.pointBoundingBox(y,m,a),l>m?(o=y,l=m):l===m&&(o=f(o,y)),d<m?(u=y,d=m):d===m&&(u=f(u,y))):(p[0]=p[1]=1/0,p[2]=p[3]=-1/0,Ye.bezierBoundingBox(s,r,...i.slice(x,x+6),p),Ye.rectBoundingBox(p[0],p[1],p[2],p[3],a),l>p[1]?(o=p[0],l=p[1]):l===p[1]&&(o=f(o,p[0])),d<p[3]?(u=p[2],d=p[3]):d===p[3]&&(u=f(u,p[2]))),s=y,r=m}const g=c(this,yh);g[0]=a[0]-c(this,Yo),g[1]=a[1]-c(this,Yo),g[2]=a[2]-a[0]+2*c(this,Yo),g[3]=a[3]-a[1]+2*c(this,Yo),this.firstPoint=[o,l],this.lastPoint=[u,d]};var Ly,My,Oy,Ac,la,as,jM,zx,RM,LM,cE;class lE{constructor(e,t=0,i=0,s=!0){T(this,as);T(this,Ly);T(this,My);T(this,Oy);T(this,Ac,[]);T(this,la,[]);const r=[1/0,1/0,-1/0,-1/0],a=10**-4;for(const{x:w,y,width:m,height:v}of e){const b=Math.floor((w-t)/a)*a,A=Math.ceil((w+m+t)/a)*a,S=Math.floor((y-t)/a)*a,C=Math.ceil((y+v+t)/a)*a,k=[b,S,C,!0],L=[A,S,C,!1];c(this,Ac).push(k,L),Ye.rectBoundingBox(b,S,A,C,r)}const o=r[2]-r[0]+2*i,l=r[3]-r[1]+2*i,u=r[0]-i,d=r[1]-i;let f=s?-1/0:1/0,p=1/0;const g=c(this,Ac).at(s?-1:-2),x=[g[0],g[2]];for(const w of c(this,Ac)){const[y,m,v,b]=w;!b&&s?m<p?(p=m,f=y):m===p&&(f=Math.max(f,y)):b&&!s&&(m<p?(p=m,f=y):m===p&&(f=Math.min(f,y))),w[0]=(y-u)/o,w[1]=(m-d)/l,w[2]=(v-d)/l}_(this,Ly,new Float32Array([u,d,o,l])),_(this,My,[f,p]),_(this,Oy,x)}getOutlines(){c(this,Ac).sort((t,i)=>t[0]-i[0]||t[1]-i[1]||t[2]-i[2]);const e=[];for(const t of c(this,Ac))t[3]?(e.push(...R(this,as,cE).call(this,t)),R(this,as,RM).call(this,t)):(R(this,as,LM).call(this,t),e.push(...R(this,as,cE).call(this,t)));return R(this,as,jM).call(this,e)}}Ly=new WeakMap,My=new WeakMap,Oy=new WeakMap,Ac=new WeakMap,la=new WeakMap,as=new WeakSet,jM=function(e){const t=[],i=new Set;for(const a of e){const[o,l,u]=a;t.push([o,l,a],[o,u,a])}t.sort((a,o)=>a[1]-o[1]||a[0]-o[0]);for(let a=0,o=t.length;a<o;a+=2){const l=t[a][2],u=t[a+1][2];l.push(u),u.push(l),i.add(l),i.add(u)}const s=[];let r;for(;i.size>0;){const a=i.values().next().value;let[o,l,u,d,f]=a;i.delete(a);let p=o,g=l;for(r=[o,u],s.push(r);;){let x;if(i.has(d))x=d;else if(i.has(f))x=f;else break;i.delete(x),[o,l,u,d,f]=x,p!==o&&(r.push(p,g,o,g===l?l:u),p=o),g=g===l?u:l}r.push(p,g)}return new MG(s,c(this,Ly),c(this,My),c(this,Oy))},zx=function(e){const t=c(this,la);let i=0,s=t.length-1;for(;i<=s;){const r=i+s>>1,a=t[r][0];if(a===e)return r;a<e?i=r+1:s=r-1}return s+1},RM=function([,e,t]){const i=R(this,as,zx).call(this,e);c(this,la).splice(i,0,[e,t])},LM=function([,e,t]){const i=R(this,as,zx).call(this,e);for(let s=i;s<c(this,la).length;s++){const[r,a]=c(this,la)[s];if(r!==e)break;if(r===e&&a===t){c(this,la).splice(s,1);return}}for(let s=i-1;s>=0;s--){const[r,a]=c(this,la)[s];if(r!==e)break;if(r===e&&a===t){c(this,la).splice(s,1);return}}},cE=function(e){const[t,i,s]=e,r=[[t,i,s]],a=R(this,as,zx).call(this,s);for(let o=0;o<a;o++){const[l,u]=c(this,la)[o];for(let d=0,f=r.length;d<f;d++){const[,p,g]=r[d];if(!(u<=p||g<=l)){if(p>=l){if(g>u)r[d][1]=u;else{if(f===1)return[];r.splice(d,1),d--,f--}continue}r[d][2]=l,g>u&&r.push([t,u,g])}}}return r};var Iy,wp;class MG extends Ke{constructor(t,i,s,r){super();T(this,Iy);T(this,wp);_(this,wp,t),_(this,Iy,i),this.firstPoint=s,this.lastPoint=r}toSVGPath(){const t=[];for(const i of c(this,wp)){let[s,r]=i;t.push(`M${s} ${r}`);for(let a=2;a<i.length;a+=2){const o=i[a],l=i[a+1];o===s?(t.push(`V${l}`),r=l):l===r&&(t.push(`H${o}`),s=o)}t.push("Z")}return t.join(" ")}serialize([t,i,s,r],a){const o=[],l=s-t,u=r-i;for(const d of c(this,wp)){const f=new Array(d.length);for(let p=0;p<d.length;p+=2)f[p]=t+d[p]*l,f[p+1]=r-d[p+1]*u;o.push(f)}return o}get box(){return c(this,Iy)}get classNamesForOutlining(){return["highlightOutline"]}}Iy=new WeakMap,wp=new WeakMap;class uE extends n1{newFreeDrawOutline(e,t,i,s,r,a){return new OG(e,t,i,s,r,a)}}class OG extends TM{newOutliner(e,t,i,s,r,a=0){return new uE(e,t,i,s,r,a)}}var Sp,Py,Wo,vh,By,xs,Fy,zy,xh,Ys,Ws,Nn,Ap,Ep,Yn,Cp,Dr,Uy,yt,hE,Ux,MM,OM,IM,dE,yu,Fr,Md,PM,Hx,$x,BM,FM,zM,UM,HM;const Pt=class Pt extends hi{constructor(t){super({...t,name:"highlightEditor"});T(this,yt);T(this,Sp,null);T(this,Py,0);T(this,Wo);T(this,vh,null);T(this,By,null);T(this,xs,null);T(this,Fy,null);T(this,zy,0);T(this,xh,null);T(this,Ys,null);T(this,Ws,null);T(this,Nn,!1);T(this,Ap,null);T(this,Ep,null);T(this,Yn,null);T(this,Cp,"");T(this,Dr);T(this,Uy,"");this.color=t.color||Pt._defaultColor,_(this,Dr,t.thickness||Pt._defaultThickness),this.opacity=t.opacity||Pt._defaultOpacity,_(this,Wo,t.boxes||null),_(this,Uy,t.methodOfCreation||""),_(this,Cp,t.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(_(this,Nn,!0),R(this,yt,Ux).call(this,t),R(this,yt,yu).call(this)):c(this,Wo)&&(_(this,Sp,t.anchorNode),_(this,Py,t.anchorOffset),_(this,Fy,t.focusNode),_(this,zy,t.focusOffset),R(this,yt,hE).call(this),R(this,yt,yu).call(this),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}static get _keyboardManager(){const t=Pt.prototype;return ut(this,"_keyboardManager",new yv([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:c(this,Nn)?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:c(this,Dr),methodOfCreation:c(this,Uy)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,i){var s;hi.initialize(t,i),Pt._defaultColor||(Pt._defaultColor=((s=i.highlightColors)==null?void 0:s.values().next().value)||"#fff066")}static updateDefaultParams(t,i){switch(t){case Tt.HIGHLIGHT_COLOR:Pt._defaultColor=i;break;case Tt.HIGHLIGHT_THICKNESS:Pt._defaultThickness=i;break}}translateInPage(t,i){}get toolbarPosition(){return c(this,Ep)}get commentButtonPosition(){return c(this,Ap)}updateParams(t,i){switch(t){case Tt.HIGHLIGHT_COLOR:R(this,yt,MM).call(this,i);break;case Tt.HIGHLIGHT_THICKNESS:R(this,yt,OM).call(this,i);break}}static get defaultPropertiesToUpdate(){return[[Tt.HIGHLIGHT_COLOR,Pt._defaultColor],[Tt.HIGHLIGHT_THICKNESS,Pt._defaultThickness]]}get propertiesToUpdate(){return[[Tt.HIGHLIGHT_COLOR,this.color||Pt._defaultColor],[Tt.HIGHLIGHT_THICKNESS,c(this,Dr)||Pt._defaultThickness],[Tt.HIGHLIGHT_FREE,c(this,Nn)]]}onUpdatedColor(){var t,i;(t=this.parent)==null||t.drawLayer.updateProperties(c(this,Ws),{root:{fill:this.color,"fill-opacity":this.opacity}}),(i=c(this,By))==null||i.updateColor(this.color),super.onUpdatedColor()}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",_(this,By,new e1({editor:this}))]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(R(this,yt,$x).call(this))}getBaseTranslation(){return[0,0]}getRect(t,i){return super.getRect(t,i,R(this,yt,$x).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){R(this,yt,dE).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(R(this,yt,yu).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var s;let i=!1;this.parent&&!t?R(this,yt,dE).call(this):t&&(R(this,yt,yu).call(this,t),i=!this.parent&&((s=this.div)==null?void 0:s.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),i&&this.select()}rotate(t){var r,a,o;const{drawLayer:i}=this.parent;let s;c(this,Nn)?(t=(t-this.rotation+360)%360,s=R(r=Pt,Fr,Md).call(r,c(this,Ys).box,t)):s=R(a=Pt,Fr,Md).call(a,[this.x,this.y,this.width,this.height],t),i.updateProperties(c(this,Ws),{bbox:s,root:{"data-main-rotation":t}}),i.updateProperties(c(this,Yn),{bbox:R(o=Pt,Fr,Md).call(o,c(this,xs).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();c(this,Cp)&&(t.setAttribute("aria-label",c(this,Cp)),t.setAttribute("role","mark")),c(this,Nn)?t.classList.add("free"):this.div.addEventListener("keydown",R(this,yt,PM).bind(this),{signal:this._uiManager._signal});const i=_(this,xh,document.createElement("div"));return t.append(i),i.setAttribute("aria-hidden","true"),i.className="internal",i.style.clipPath=c(this,vh),this.setDims(),K4(this,c(this,xh),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(c(this,Yn),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(c(this,Yn),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:R(this,yt,Hx).call(this,!0);break;case 1:case 3:R(this,yt,Hx).call(this,!1);break}}select(){var t;super.select(),c(this,Yn)&&((t=this.parent)==null||t.drawLayer.updateProperties(c(this,Yn),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),c(this,Yn)&&((t=this.parent)==null||t.drawLayer.updateProperties(c(this,Yn),{rootClass:{selected:!1}}),c(this,Nn)||R(this,yt,Hx).call(this,!1))}get _mustFixPosition(){return!c(this,Nn)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(c(this,Ws),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(c(this,Yn),{rootClass:{hidden:!t}}))}static startHighlighting(t,i,{target:s,x:r,y:a}){const{x:o,y:l,width:u,height:d}=s.getBoundingClientRect(),f=new AbortController,p=t.combinedSignal(f),g=x=>{f.abort(),R(this,Fr,UM).call(this,t,x)};window.addEventListener("blur",g,{signal:p}),window.addEventListener("pointerup",g,{signal:p}),window.addEventListener("pointerdown",Mi,{capture:!0,passive:!1,signal:p}),window.addEventListener("contextmenu",Gr,{signal:p}),s.addEventListener("pointermove",R(this,Fr,zM).bind(this,t),{signal:p}),this._freeHighlight=new uE({x:r,y:a},[o,l,u,d],t.scale,this._defaultThickness/2,i,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,i,s){var w,y,m,v;let r=null;if(t instanceof mM){const{data:{quadPoints:b,rect:A,rotation:S,id:C,color:k,opacity:L,popupRef:D,richText:j,contentsObj:P,creationDate:H,modificationDate:G},parent:{page:{pageNumber:$}}}=t;r=t={annotationType:ft.HIGHLIGHT,color:Array.from(k),opacity:L,quadPoints:b,boxes:null,pageIndex:$-1,rect:A.slice(0),rotation:S,annotationElementId:C,id:C,deleted:!1,popupRef:D,richText:j,comment:(P==null?void 0:P.str)||null,creationDate:H,modificationDate:G}}else if(t instanceof v_){const{data:{inkLists:b,rect:A,rotation:S,id:C,color:k,borderStyle:{rawWidth:L},popupRef:D,richText:j,contentsObj:P,creationDate:H,modificationDate:G},parent:{page:{pageNumber:$}}}=t;r=t={annotationType:ft.HIGHLIGHT,color:Array.from(k),thickness:L,inkLists:b,boxes:null,pageIndex:$-1,rect:A.slice(0),rotation:S,annotationElementId:C,id:C,deleted:!1,popupRef:D,richText:j,comment:(P==null?void 0:P.str)||null,creationDate:H,modificationDate:G}}const{color:a,quadPoints:o,inkLists:l,opacity:u}=t,d=await super.deserialize(t,i,s);d.color=Ye.makeHexColor(...a),d.opacity=u||1,l&&_(d,Dr,t.thickness),d._initialData=r,t.comment&&d.setCommentData(t);const[f,p]=d.pageDimensions,[g,x]=d.pageTranslation;if(o){const b=_(d,Wo,[]);for(let A=0;A<o.length;A+=8)b.push({x:(o[A]-g)/f,y:1-(o[A+1]-x)/p,width:(o[A+2]-o[A])/f,height:(o[A+1]-o[A+5])/p});R(w=d,yt,hE).call(w),R(y=d,yt,yu).call(y),d.rotate(d.rotation)}else if(l){_(d,Nn,!0);const b=l[0],A={x:b[0]-g,y:p-(b[1]-x)},S=new uE(A,[0,0,f,p],1,c(d,Dr)/2,!0,.001);for(let L=0,D=b.length;L<D;L+=2)A.x=b[L]-g,A.y=p-(b[L+1]-x),S.add(A);const{id:C,clipPathId:k}=i.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:d.color,"fill-opacity":d._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:S.toSVGPath()}},!0,!0);R(m=d,yt,Ux).call(m,{highlightOutlines:S.getOutlines(),highlightId:C,clipPathId:k}),R(v=d,yt,yu).call(v),d.rotate(d.parentRotation)}return d}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const i=hi._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),s=super.serialize(t);return Object.assign(s,{color:i,opacity:this.opacity,thickness:c(this,Dr),quadPoints:R(this,yt,BM).call(this),outlines:R(this,yt,FM).call(this,s.rect)}),this.addComment(s),this.annotationElementId&&!R(this,yt,HM).call(this,s)?null:(s.id=this.annotationElementId,s)}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}};Sp=new WeakMap,Py=new WeakMap,Wo=new WeakMap,vh=new WeakMap,By=new WeakMap,xs=new WeakMap,Fy=new WeakMap,zy=new WeakMap,xh=new WeakMap,Ys=new WeakMap,Ws=new WeakMap,Nn=new WeakMap,Ap=new WeakMap,Ep=new WeakMap,Yn=new WeakMap,Cp=new WeakMap,Dr=new WeakMap,Uy=new WeakMap,yt=new WeakSet,hE=function(){const t=new lE(c(this,Wo),.001);_(this,Ys,t.getOutlines()),[this.x,this.y,this.width,this.height]=c(this,Ys).box;const i=new lE(c(this,Wo),.0025,.001,this._uiManager.direction==="ltr");_(this,xs,i.getOutlines());const{firstPoint:s}=c(this,Ys);_(this,Ap,[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height]);const{lastPoint:r}=c(this,xs);_(this,Ep,[(r[0]-this.x)/this.width,(r[1]-this.y)/this.height])},Ux=function({highlightOutlines:t,highlightId:i,clipPathId:s}){var p,g;if(_(this,Ys,t),_(this,xs,t.getNewOutline(c(this,Dr)/2+1.5,.0025)),i>=0)_(this,Ws,i),_(this,vh,s),this.parent.drawLayer.finalizeDraw(i,{bbox:t.box,path:{d:t.toSVGPath()}}),_(this,Yn,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:c(this,xs).box,path:{d:c(this,xs).toSVGPath()}},!0));else if(this.parent){const x=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(c(this,Ws),{bbox:R(p=Pt,Fr,Md).call(p,c(this,Ys).box,(x-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(c(this,Yn),{bbox:R(g=Pt,Fr,Md).call(g,c(this,xs).box,x),path:{d:c(this,xs).toSVGPath()}})}const[a,o,l,u]=t.box;switch(this.rotation){case 0:this.x=a,this.y=o,this.width=l,this.height=u;break;case 90:{const[x,w]=this.parentDimensions;this.x=o,this.y=1-a,this.width=l*w/x,this.height=u*x/w;break}case 180:this.x=1-a,this.y=1-o,this.width=l,this.height=u;break;case 270:{const[x,w]=this.parentDimensions;this.x=1-o,this.y=a,this.width=l*w/x,this.height=u*x/w;break}}const{firstPoint:d}=t;_(this,Ap,[(d[0]-a)/l,(d[1]-o)/u]);const{lastPoint:f}=c(this,xs);_(this,Ep,[(f[0]-a)/l,(f[1]-o)/u])},MM=function(t){const i=(a,o)=>{this.color=a,this.opacity=o,this.onUpdatedColor()},s=this.color,r=this.opacity;this.addCommands({cmd:i.bind(this,t,Pt._defaultOpacity),undo:i.bind(this,s,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Tt.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)},OM=function(t){const i=c(this,Dr),s=r=>{_(this,Dr,r),R(this,yt,IM).call(this,r)};this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Tt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},IM=function(t){c(this,Nn)&&(R(this,yt,Ux).call(this,{highlightOutlines:c(this,Ys).getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims())},dE=function(){c(this,Ws)===null||!this.parent||(this.parent.drawLayer.remove(c(this,Ws)),_(this,Ws,null),this.parent.drawLayer.remove(c(this,Yn)),_(this,Yn,null))},yu=function(t=this.parent){c(this,Ws)===null&&({id:en(this,Ws)._,clipPathId:en(this,vh)._}=t.drawLayer.draw({bbox:c(this,Ys).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:c(this,Nn)},path:{d:c(this,Ys).toSVGPath()}},!1,!0),_(this,Yn,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:c(this,Nn)},bbox:c(this,xs).box,path:{d:c(this,xs).toSVGPath()}},c(this,Nn))),c(this,xh)&&(c(this,xh).style.clipPath=c(this,vh)))},Fr=new WeakSet,Md=function([t,i,s,r],a){switch(a){case 90:return[1-i-r,t,r,s];case 180:return[1-t-s,1-i-r,s,r];case 270:return[i,1-t-s,r,s]}return[t,i,s,r]},PM=function(t){Pt._keyboardManager.exec(this,t)},Hx=function(t){if(!c(this,Sp))return;const i=window.getSelection();t?i.setPosition(c(this,Sp),c(this,Py)):i.setPosition(c(this,Fy),c(this,zy))},$x=function(){return c(this,Nn)?this.rotation:0},BM=function(){if(c(this,Nn))return null;const[t,i]=this.pageDimensions,[s,r]=this.pageTranslation,a=c(this,Wo),o=new Float32Array(a.length*8);let l=0;for(const{x:u,y:d,width:f,height:p}of a){const g=u*t+s,x=(1-d)*i+r;o[l]=o[l+4]=g,o[l+1]=o[l+3]=x,o[l+2]=o[l+6]=g+f*t,o[l+5]=o[l+7]=x-p*i,l+=8}return o},FM=function(t){return c(this,Ys).serialize(t,R(this,yt,$x).call(this))},zM=function(t,i){this._freeHighlight.add(i)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},UM=function(t,i){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(i,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},HM=function(t){const{color:i}=this._initialData;return this.hasEditedComment||t.color.some((s,r)=>s!==i[r])},T(Pt,Fr),fe(Pt,"_defaultColor",null),fe(Pt,"_defaultOpacity",1),fe(Pt,"_defaultThickness",12),fe(Pt,"_type","highlight"),fe(Pt,"_editorType",ft.HIGHLIGHT),fe(Pt,"_freeHighlightId",-1),fe(Pt,"_freeHighlight",null),fe(Pt,"_freeHighlightClipId","");let s1=Pt;var bh;class $M{constructor(){T(this,bh,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,i]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,i)}updateSVGProperty(e,t){c(this,bh)[e]=t}toSVGProperties(){const e=c(this,bh);return _(this,bh,Object.create(null)),{root:e}}reset(){_(this,bh,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){zt("Not implemented")}}bh=new WeakMap;var Xs,_p,fn,wh,Sh,Ot,fE,pE,gE,im,qM,qx,nm,Od;const Ct=class Ct extends hi{constructor(t){super(t);T(this,Ot);T(this,Xs,null);T(this,_p);fe(this,"_colorPicker",null);fe(this,"_drawId",null);_(this,_p,t.mustBeCommitted||!1),this._addOutlines(t)}onUpdatedColor(){var t;(t=this._colorPicker)==null||t.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(R(this,Ot,fE).call(this,t),R(this,Ot,im).call(this))}static _mergeSVGProperties(t,i){const s=new Set(Object.keys(t));for(const[r,a]of Object.entries(i))s.has(r)?Object.assign(t[r],a):t[r]=a;return t}static getDefaultDrawingOptions(t){zt("Not implemented")}static get typesMap(){zt("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,i){const s=this.typesMap.get(t);s&&this._defaultDrawingOptions.updateProperty(s,i),this._currentParent&&(c(Ct,fn).updateProperty(s,i),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,i){const s=this.constructor.typesMap.get(t);s&&this._updateProperty(t,s,i)}static get defaultPropertiesToUpdate(){const t=[],i=this._defaultDrawingOptions;for(const[s,r]of this.typesMap)t.push([s,i[r]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:i}=this;for(const[s,r]of this.constructor.typesMap)t.push([s,i[r]]);return t}_updateProperty(t,i,s){const r=this._drawingOptions,a=r[i],o=l=>{var d;r.updateProperty(i,l);const u=c(this,Xs).updateProperty(i,l);u&&R(this,Ot,nm).call(this,u),(d=this.parent)==null||d.drawLayer.updateProperties(this._drawId,r.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:o.bind(this,s),undo:o.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Ct._mergeSVGProperties(c(this,Xs).getPathResizingSVGProperties(R(this,Ot,qx).call(this)),{bbox:R(this,Ot,Od).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Ct._mergeSVGProperties(c(this,Xs).getPathResizedSVGProperties(R(this,Ot,qx).call(this)),{bbox:R(this,Ot,Od).call(this)}))}_onTranslating(t,i){var s;(s=this.parent)==null||s.drawLayer.updateProperties(this._drawId,{bbox:R(this,Ot,Od).call(this)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Ct._mergeSVGProperties(c(this,Xs).getPathTranslatedSVGProperties(R(this,Ot,qx).call(this),this.parentDimensions),{bbox:R(this,Ot,Od).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,c(this,_p)&&(_(this,_p,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){R(this,Ot,gE).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(R(this,Ot,im).call(this),R(this,Ot,nm).call(this,c(this,Xs).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var s;let i=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),R(this,Ot,gE).call(this)):t&&(this._uiManager.addShouldRescale(this),R(this,Ot,im).call(this,t),i=!this.parent&&((s=this.div)==null?void 0:s.classList.contains("selectedEditor"))),super.setParent(t),i&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Ct._mergeSVGProperties({bbox:R(this,Ot,Od).call(this)},c(this,Xs).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&R(this,Ot,nm).call(this,c(this,Xs).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,i;this._isCopy&&(t=this.x,i=this.y);const s=super.render();s.classList.add("draw");const r=document.createElement("div");return s.append(r),r.setAttribute("aria-hidden","true"),r.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,i),s}static createDrawerInstance(t,i,s,r,a){zt("Not implemented")}static startDrawing(t,i,s,r){var y;const{target:a,offsetX:o,offsetY:l,pointerId:u,pointerType:d}=r;if(Hn.isInitializedAndDifferentPointerType(d))return;const{viewport:{rotation:f}}=t,{width:p,height:g}=a.getBoundingClientRect(),x=_(Ct,wh,new AbortController),w=t.combinedSignal(x);if(Hn.setPointer(d,u),window.addEventListener("pointerup",m=>{Hn.isSamePointerIdOrRemove(m.pointerId)&&this._endDraw(m)},{signal:w}),window.addEventListener("pointercancel",m=>{Hn.isSamePointerIdOrRemove(m.pointerId)&&this._currentParent.endDrawingSession()},{signal:w}),window.addEventListener("pointerdown",m=>{Hn.isSamePointerType(m.pointerType)&&(Hn.initializeAndAddPointerId(m.pointerId),c(Ct,fn).isCancellable()&&(c(Ct,fn).removeLastElement(),c(Ct,fn).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:w}),window.addEventListener("contextmenu",Gr,{signal:w}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:w}),a.addEventListener("touchmove",m=>{Hn.isSameTimeStamp(m.timeStamp)&&Mi(m)},{signal:w}),t.toggleDrawing(),(y=i._editorUndoBar)==null||y.hide(),c(Ct,fn)){t.drawLayer.updateProperties(this._currentDrawId,c(Ct,fn).startNew(o,l,p,g,f));return}i.updateUIForDefaultProperties(this),_(Ct,fn,this.createDrawerInstance(o,l,p,g,f)),_(Ct,Sh,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(c(Ct,Sh).toSVGProperties(),c(Ct,fn).defaultSVGProperties),!0,!1)}static _drawMove(t){if(Hn.isSameTimeStamp(t.timeStamp),!c(Ct,fn))return;const{offsetX:i,offsetY:s,pointerId:r}=t;if(Hn.isSamePointerId(r)){if(Hn.isUsingMultiplePointers()){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,c(Ct,fn).add(i,s)),Hn.setTimeStamp(t.timeStamp),Mi(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,_(Ct,fn,null),_(Ct,Sh,null),Hn.clearTimeStamp()),c(Ct,wh)&&(c(Ct,wh).abort(),_(Ct,wh,null),Hn.clearPointerIds())}static _endDraw(t){const i=this._currentParent;if(i){if(i.toggleDrawing(!0),this._cleanup(!1),(t==null?void 0:t.target)===i.div&&i.drawLayer.updateProperties(this._currentDrawId,c(Ct,fn).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const s=c(Ct,fn),r=this._currentDrawId,a=s.getLastElement();i.addCommands({cmd:()=>{i.drawLayer.updateProperties(r,s.setLastElement(a))},undo:()=>{i.drawLayer.updateProperties(r,s.removeLastElement())},mustExec:!1,type:Tt.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const i=this._currentParent;if(!i)return null;if(i.toggleDrawing(!0),i.cleanUndoStack(Tt.DRAW_STEP),!c(Ct,fn).isEmpty()){const{pageDimensions:[s,r],scale:a}=i,o=i.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:c(Ct,fn).getOutlines(s*a,r*a,a,this._INNER_MARGIN),drawingOptions:c(Ct,Sh),mustBeCommitted:!t});return this._cleanup(!0),o}return i.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,i,s,r,a,o){zt("Not implemented")}static async deserialize(t,i,s){var f,p;const{rawDims:{pageWidth:r,pageHeight:a,pageX:o,pageY:l}}=i.viewport,u=this.deserializeDraw(o,l,r,a,this._INNER_MARGIN,t),d=await super.deserialize(t,i,s);return d.createDrawingOptions(t),R(f=d,Ot,fE).call(f,{drawOutlines:u}),R(p=d,Ot,im).call(p),d.onScaleChanging(),d.rotate(),d}serializeDraw(t){const[i,s]=this.pageTranslation,[r,a]=this.pageDimensions;return c(this,Xs).serialize([i,s,r,a],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}};Xs=new WeakMap,_p=new WeakMap,fn=new WeakMap,wh=new WeakMap,Sh=new WeakMap,Ot=new WeakSet,fE=function({drawOutlines:t,drawId:i,drawingOptions:s}){_(this,Xs,t),this._drawingOptions||(this._drawingOptions=s),this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),i>=0?(this._drawId=i,this.parent.drawLayer.finalizeDraw(i,t.defaultProperties)):this._drawId=R(this,Ot,pE).call(this,t,this.parent),R(this,Ot,nm).call(this,t.box)},pE=function(t,i){const{id:s}=i.drawLayer.draw(Ct._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return s},gE=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},im=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=R(this,Ot,pE).call(this,c(this,Xs),t)}},qM=function([t,i,s,r]){const{parentDimensions:[a,o],rotation:l}=this;switch(l){case 90:return[i,1-t,s*(o/a),r*(a/o)];case 180:return[1-t,1-i,s,r];case 270:return[1-i,t,s*(o/a),r*(a/o)];default:return[t,i,s,r]}},qx=function(){const{x:t,y:i,width:s,height:r,parentDimensions:[a,o],rotation:l}=this;switch(l){case 90:return[1-i,t,s*(a/o),r*(o/a)];case 180:return[1-t,1-i,s,r];case 270:return[i,1-t,s*(a/o),r*(o/a)];default:return[t,i,s,r]}},nm=function(t){[this.x,this.y,this.width,this.height]=R(this,Ot,qM).call(this,t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()},Od=function(){const{x:t,y:i,width:s,height:r,rotation:a,parentRotation:o,parentDimensions:[l,u]}=this;switch((a*4+o)/90){case 1:return[1-i-r,t,r,s];case 2:return[1-t-s,1-i-r,s,r];case 3:return[i,1-t-s,r,s];case 4:return[t,i-s*(l/u),r*(u/l),s*(l/u)];case 5:return[1-i,t,s*(l/u),r*(u/l)];case 6:return[1-t-r*(u/l),1-i,r*(u/l),s*(l/u)];case 7:return[i-s*(l/u),1-t-r*(u/l),s*(l/u),r*(u/l)];case 8:return[t-s,i-r,s,r];case 9:return[1-i,t-s,r,s];case 10:return[1-t,1-i,s,r];case 11:return[i-r,1-t,r,s];case 12:return[t-r*(u/l),i,r*(u/l),s*(l/u)];case 13:return[1-i-s*(l/u),t-r*(u/l),s*(l/u),r*(u/l)];case 14:return[1-t,1-i-s*(l/u),r*(u/l),s*(l/u)];case 15:return[i,1-t,s*(l/u),r*(u/l)];default:return[t,i,s,r]}},fe(Ct,"_currentDrawId",-1),fe(Ct,"_currentParent",null),T(Ct,fn,null),T(Ct,wh,null),T(Ct,Sh,null),fe(Ct,"_INNER_MARGIN",3);let r1=Ct;var za,pn,gn,Ah,Np,Qn,kn,jr,Eh,Ch,_h,kp,Vx;class IG{constructor(e,t,i,s,r,a){T(this,kp);T(this,za,new Float64Array(6));T(this,pn);T(this,gn);T(this,Ah);T(this,Np);T(this,Qn);T(this,kn,"");T(this,jr,0);T(this,Eh,new vv);T(this,Ch);T(this,_h);_(this,Ch,i),_(this,_h,s),_(this,Ah,r),_(this,Np,a),[e,t]=R(this,kp,Vx).call(this,e,t);const o=_(this,pn,[NaN,NaN,NaN,NaN,e,t]);_(this,Qn,[e,t]),_(this,gn,[{line:o,points:c(this,Qn)}]),c(this,za).set(o,0)}updateProperty(e,t){e==="stroke-width"&&_(this,Np,t)}isEmpty(){return!c(this,gn)||c(this,gn).length===0}isCancellable(){return c(this,Qn).length<=10}add(e,t){[e,t]=R(this,kp,Vx).call(this,e,t);const[i,s,r,a]=c(this,za).subarray(2,6),o=e-r,l=t-a;return Math.hypot(c(this,Ch)*o,c(this,_h)*l)<=2?null:(c(this,Qn).push(e,t),isNaN(i)?(c(this,za).set([r,a,e,t],2),c(this,pn).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(c(this,za)[0])&&c(this,pn).splice(6,6),c(this,za).set([i,s,r,a,e,t],0),c(this,pn).push(...Ke.createBezierPoints(i,s,r,a,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const i=this.add(e,t);return i||(c(this,Qn).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,i,s,r){_(this,Ch,i),_(this,_h,s),_(this,Ah,r),[e,t]=R(this,kp,Vx).call(this,e,t);const a=_(this,pn,[NaN,NaN,NaN,NaN,e,t]);_(this,Qn,[e,t]);const o=c(this,gn).at(-1);return o&&(o.line=new Float32Array(o.line),o.points=new Float32Array(o.points)),c(this,gn).push({line:a,points:c(this,Qn)}),c(this,za).set(a,0),_(this,jr,0),this.toSVGPath(),null}getLastElement(){return c(this,gn).at(-1)}setLastElement(e){return c(this,gn)?(c(this,gn).push(e),_(this,pn,e.line),_(this,Qn,e.points),_(this,jr,0),{path:{d:this.toSVGPath()}}):c(this,Eh).setLastElement(e)}removeLastElement(){if(!c(this,gn))return c(this,Eh).removeLastElement();c(this,gn).pop(),_(this,kn,"");for(let e=0,t=c(this,gn).length;e<t;e++){const{line:i,points:s}=c(this,gn)[e];_(this,pn,i),_(this,Qn,s),_(this,jr,0),this.toSVGPath()}return{path:{d:c(this,kn)}}}toSVGPath(){const e=Ke.svgRound(c(this,pn)[4]),t=Ke.svgRound(c(this,pn)[5]);if(c(this,Qn).length===2)return _(this,kn,`${c(this,kn)} M ${e} ${t} Z`),c(this,kn);if(c(this,Qn).length<=6){const s=c(this,kn).lastIndexOf("M");_(this,kn,`${c(this,kn).slice(0,s)} M ${e} ${t}`),_(this,jr,6)}if(c(this,Qn).length===4){const s=Ke.svgRound(c(this,pn)[10]),r=Ke.svgRound(c(this,pn)[11]);return _(this,kn,`${c(this,kn)} L ${s} ${r}`),_(this,jr,12),c(this,kn)}const i=[];c(this,jr)===0&&(i.push(`M ${e} ${t}`),_(this,jr,6));for(let s=c(this,jr),r=c(this,pn).length;s<r;s+=6){const[a,o,l,u,d,f]=c(this,pn).slice(s,s+6).map(Ke.svgRound);i.push(`C${a} ${o} ${l} ${u} ${d} ${f}`)}return _(this,kn,c(this,kn)+i.join(" ")),_(this,jr,c(this,pn).length),c(this,kn)}getOutlines(e,t,i,s){const r=c(this,gn).at(-1);return r.line=new Float32Array(r.line),r.points=new Float32Array(r.points),c(this,Eh).build(c(this,gn),e,t,i,c(this,Ah),c(this,Np),s),_(this,za,null),_(this,pn,null),_(this,gn,null),_(this,kn,null),c(this,Eh)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}za=new WeakMap,pn=new WeakMap,gn=new WeakMap,Ah=new WeakMap,Np=new WeakMap,Qn=new WeakMap,kn=new WeakMap,jr=new WeakMap,Eh=new WeakMap,Ch=new WeakMap,_h=new WeakMap,kp=new WeakSet,Vx=function(e,t){return Ke._normalizePoint(e,t,c(this,Ch),c(this,_h),c(this,Ah))};var Jn,Hy,$y,Ks,Ua,Ha,Tp,Dp,Nh,Rn,po,VM,GM,YM;class vv extends Ke{constructor(){super(...arguments);T(this,Rn);T(this,Jn);T(this,Hy,0);T(this,$y);T(this,Ks);T(this,Ua);T(this,Ha);T(this,Tp);T(this,Dp);T(this,Nh)}build(t,i,s,r,a,o,l){_(this,Ua,i),_(this,Ha,s),_(this,Tp,r),_(this,Dp,a),_(this,Nh,o),_(this,$y,l??0),_(this,Ks,t),R(this,Rn,GM).call(this)}get thickness(){return c(this,Nh)}setLastElement(t){return c(this,Ks).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return c(this,Ks).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:i}of c(this,Ks)){if(t.push(`M${Ke.svgRound(i[4])} ${Ke.svgRound(i[5])}`),i.length===6){t.push("Z");continue}if(i.length===12&&isNaN(i[6])){t.push(`L${Ke.svgRound(i[10])} ${Ke.svgRound(i[11])}`);continue}for(let s=6,r=i.length;s<r;s+=6){const[a,o,l,u,d,f]=i.subarray(s,s+6).map(Ke.svgRound);t.push(`C${a} ${o} ${l} ${u} ${d} ${f}`)}}return t.join("")}serialize([t,i,s,r],a){const o=[],l=[],[u,d,f,p]=R(this,Rn,VM).call(this);let g,x,w,y,m,v,b,A,S;switch(c(this,Dp)){case 0:S=Ke._rescale,g=t,x=i+r,w=s,y=-r,m=t+u*s,v=i+(1-d-p)*r,b=t+(u+f)*s,A=i+(1-d)*r;break;case 90:S=Ke._rescaleAndSwap,g=t,x=i,w=s,y=r,m=t+d*s,v=i+u*r,b=t+(d+p)*s,A=i+(u+f)*r;break;case 180:S=Ke._rescale,g=t+s,x=i,w=-s,y=r,m=t+(1-u-f)*s,v=i+d*r,b=t+(1-u)*s,A=i+(d+p)*r;break;case 270:S=Ke._rescaleAndSwap,g=t+s,x=i+r,w=-s,y=-r,m=t+(1-d-p)*s,v=i+(1-u-f)*r,b=t+(1-d)*s,A=i+(1-u)*r;break}for(const{line:C,points:k}of c(this,Ks))o.push(S(C,g,x,w,y,a?new Array(C.length):null)),l.push(S(k,g,x,w,y,a?new Array(k.length):null));return{lines:o,points:l,rect:[m,v,b,A]}}static deserialize(t,i,s,r,a,{paths:{lines:o,points:l},rotation:u,thickness:d}){const f=[];let p,g,x,w,y;switch(u){case 0:y=Ke._rescale,p=-t/s,g=i/r+1,x=1/s,w=-1/r;break;case 90:y=Ke._rescaleAndSwap,p=-i/r,g=-t/s,x=1/r,w=1/s;break;case 180:y=Ke._rescale,p=t/s+1,g=-i/r,x=-1/s,w=1/r;break;case 270:y=Ke._rescaleAndSwap,p=i/r+1,g=t/s+1,x=-1/r,w=-1/s;break}if(!o){o=[];for(const v of l){const b=v.length;if(b===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,v[0],v[1]]));continue}if(b===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,v[0],v[1],NaN,NaN,NaN,NaN,v[2],v[3]]));continue}const A=new Float32Array(3*(b-2));o.push(A);let[S,C,k,L]=v.subarray(0,4);A.set([NaN,NaN,NaN,NaN,S,C],0);for(let D=4;D<b;D+=2){const j=v[D],P=v[D+1];A.set(Ke.createBezierPoints(S,C,k,L,j,P),(D-2)*3),[S,C,k,L]=[k,L,j,P]}}}for(let v=0,b=o.length;v<b;v++)f.push({line:y(o[v].map(A=>A??NaN),p,g,x,w),points:y(l[v].map(A=>A??NaN),p,g,x,w)});const m=new this.prototype.constructor;return m.build(f,s,r,1,u,d,a),m}get box(){return c(this,Jn)}updateProperty(t,i){return t==="stroke-width"?R(this,Rn,YM).call(this,i):null}updateParentDimensions([t,i],s){const[r,a]=R(this,Rn,po).call(this);_(this,Ua,t),_(this,Ha,i),_(this,Tp,s);const[o,l]=R(this,Rn,po).call(this),u=o-r,d=l-a,f=c(this,Jn);return f[0]-=u,f[1]-=d,f[2]+=2*u,f[3]+=2*d,f}updateRotation(t){return _(this,Hy,t),{path:{transform:this.rotationTransform}}}get viewBox(){return c(this,Jn).map(Ke.svgRound).join(" ")}get defaultProperties(){const[t,i]=c(this,Jn);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Ke.svgRound(t)} ${Ke.svgRound(i)}`}}}get rotationTransform(){const[,,t,i]=c(this,Jn);let s=0,r=0,a=0,o=0,l=0,u=0;switch(c(this,Hy)){case 90:r=i/t,a=-t/i,l=t;break;case 180:s=-1,o=-1,l=t,u=i;break;case 270:r=-i/t,a=t/i,u=i;break;default:return""}return`matrix(${s} ${r} ${a} ${o} ${Ke.svgRound(l)} ${Ke.svgRound(u)})`}getPathResizingSVGProperties([t,i,s,r]){const[a,o]=R(this,Rn,po).call(this),[l,u,d,f]=c(this,Jn);if(Math.abs(d-a)<=Ke.PRECISION||Math.abs(f-o)<=Ke.PRECISION){const y=t+s/2-(l+d/2),m=i+r/2-(u+f/2);return{path:{"transform-origin":`${Ke.svgRound(t)} ${Ke.svgRound(i)}`,transform:`${this.rotationTransform} translate(${y} ${m})`}}}const p=(s-2*a)/(d-2*a),g=(r-2*o)/(f-2*o),x=d/s,w=f/r;return{path:{"transform-origin":`${Ke.svgRound(l)} ${Ke.svgRound(u)}`,transform:`${this.rotationTransform} scale(${x} ${w}) translate(${Ke.svgRound(a)} ${Ke.svgRound(o)}) scale(${p} ${g}) translate(${Ke.svgRound(-a)} ${Ke.svgRound(-o)})`}}}getPathResizedSVGProperties([t,i,s,r]){const[a,o]=R(this,Rn,po).call(this),l=c(this,Jn),[u,d,f,p]=l;if(l[0]=t,l[1]=i,l[2]=s,l[3]=r,Math.abs(f-a)<=Ke.PRECISION||Math.abs(p-o)<=Ke.PRECISION){const m=t+s/2-(u+f/2),v=i+r/2-(d+p/2);for(const{line:b,points:A}of c(this,Ks))Ke._translate(b,m,v,b),Ke._translate(A,m,v,A);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Ke.svgRound(t)} ${Ke.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const g=(s-2*a)/(f-2*a),x=(r-2*o)/(p-2*o),w=-g*(u+a)+t+a,y=-x*(d+o)+i+o;if(g!==1||x!==1||w!==0||y!==0)for(const{line:m,points:v}of c(this,Ks))Ke._rescale(m,w,y,g,x,m),Ke._rescale(v,w,y,g,x,v);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Ke.svgRound(t)} ${Ke.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,i],s){const[r,a]=s,o=c(this,Jn),l=t-o[0],u=i-o[1];if(c(this,Ua)===r&&c(this,Ha)===a)for(const{line:d,points:f}of c(this,Ks))Ke._translate(d,l,u,d),Ke._translate(f,l,u,f);else{const d=c(this,Ua)/r,f=c(this,Ha)/a;_(this,Ua,r),_(this,Ha,a);for(const{line:p,points:g}of c(this,Ks))Ke._rescale(p,l,u,d,f,p),Ke._rescale(g,l,u,d,f,g);o[2]*=d,o[3]*=f}return o[0]=t,o[1]=i,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${Ke.svgRound(t)} ${Ke.svgRound(i)}`}}}get defaultSVGProperties(){const t=c(this,Jn);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${Ke.svgRound(t[0])} ${Ke.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}Jn=new WeakMap,Hy=new WeakMap,$y=new WeakMap,Ks=new WeakMap,Ua=new WeakMap,Ha=new WeakMap,Tp=new WeakMap,Dp=new WeakMap,Nh=new WeakMap,Rn=new WeakSet,po=function(t=c(this,Nh)){const i=c(this,$y)+t/2*c(this,Tp);return c(this,Dp)%180===0?[i/c(this,Ua),i/c(this,Ha)]:[i/c(this,Ha),i/c(this,Ua)]},VM=function(){const[t,i,s,r]=c(this,Jn),[a,o]=R(this,Rn,po).call(this,0);return[t+a,i+o,s-2*a,r-2*o]},GM=function(){const t=_(this,Jn,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:r}of c(this,Ks)){if(r.length<=12){for(let l=4,u=r.length;l<u;l+=6)Ye.pointBoundingBox(r[l],r[l+1],t);continue}let a=r[4],o=r[5];for(let l=6,u=r.length;l<u;l+=6){const[d,f,p,g,x,w]=r.subarray(l,l+6);Ye.bezierBoundingBox(a,o,d,f,p,g,x,w,t),a=x,o=w}}const[i,s]=R(this,Rn,po).call(this);t[0]=Dn(t[0]-i,0,1),t[1]=Dn(t[1]-s,0,1),t[2]=Dn(t[2]+i,0,1),t[3]=Dn(t[3]+s,0,1),t[2]-=t[0],t[3]-=t[1]},YM=function(t){const[i,s]=R(this,Rn,po).call(this);_(this,Nh,t);const[r,a]=R(this,Rn,po).call(this),[o,l]=[r-i,a-s],u=c(this,Jn);return u[0]-=o,u[1]-=l,u[2]+=2*o,u[3]+=2*l,u};class vw extends $M{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:hi._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??(t=this["stroke-width"]),t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new vw(this._viewParameters);return e.updateAll(this),e}}var A1,WM;const ef=class ef extends r1{constructor(t){super({...t,name:"inkEditor"});T(this,A1);this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,i){hi.initialize(t,i),this._defaultDrawingOptions=new vw(i.viewParameters)}static getDefaultDrawingOptions(t){const i=this._defaultDrawingOptions.clone();return i.updateProperties(t),i}static get supportMultipleDrawings(){return!0}static get typesMap(){return ut(this,"typesMap",new Map([[Tt.INK_THICKNESS,"stroke-width"],[Tt.INK_COLOR,"stroke"],[Tt.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,i,s,r,a){return new IG(t,i,s,r,a,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,i,s,r,a,o){return vv.deserialize(t,i,s,r,a,o)}static async deserialize(t,i,s){let r=null;if(t instanceof v_){const{data:{inkLists:o,rect:l,rotation:u,id:d,color:f,opacity:p,borderStyle:{rawWidth:g},popupRef:x,richText:w,contentsObj:y,creationDate:m,modificationDate:v},parent:{page:{pageNumber:b}}}=t;r=t={annotationType:ft.INK,color:Array.from(f),thickness:g,opacity:p,paths:{points:o},boxes:null,pageIndex:b-1,rect:l.slice(0),rotation:u,annotationElementId:d,id:d,deleted:!1,popupRef:x,richText:w,comment:(y==null?void 0:y.str)||null,creationDate:m,modificationDate:v}}const a=await super.deserialize(t,i,s);return a._initialData=r,t.comment&&a.setCommentData(t),a}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new t1(this)),[["colorPicker",this._colorPicker]]}get colorType(){return Tt.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:i,parent:s}=this;i.updateSVGProperty("stroke-width"),s.drawLayer.updateProperties(t,i.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:i,opacity:s}){this._drawingOptions=ef.getDefaultDrawingOptions({stroke:Ye.makeHexColor(...t),"stroke-width":i,"stroke-opacity":s})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:i,points:s}=this.serializeDraw(t),{_drawingOptions:{stroke:r,"stroke-opacity":a,"stroke-width":o}}=this,l=Object.assign(super.serialize(t),{color:hi._colorManager.convert(r),opacity:a,thickness:o,paths:{lines:i,points:s}});return this.addComment(l),t?(l.isCopy=!0,l):this.annotationElementId&&!R(this,A1,WM).call(this,l)?null:(l.id=this.annotationElementId,l)}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:i,rect:s}=this.serializeDraw(!1);return t.updateEdited({rect:s,thickness:this._drawingOptions["stroke-width"],points:i,popup:this.comment}),null}};A1=new WeakSet,WM=function(t){const{color:i,thickness:s,opacity:r,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((o,l)=>o!==i[l])||t.thickness!==s||t.opacity!==r||t.pageIndex!==a},fe(ef,"_type","ink"),fe(ef,"_editorType",ft.INK),fe(ef,"_defaultDrawingOptions",null);let mE=ef;class yE extends vv{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const Kv=8,Lg=3;var kh,$t,vE,ca,XM,KM,xE,Gx,ZM,QM,JM,bE,wE,eO;class tl{static extractContoursFromText(e,{fontFamily:t,fontStyle:i,fontWeight:s},r,a,o,l){let u=new OffscreenCanvas(1,1),d=u.getContext("2d",{alpha:!1});const f=200,p=d.font=`${i} ${s} ${f}px ${t}`,{actualBoundingBoxLeft:g,actualBoundingBoxRight:x,actualBoundingBoxAscent:w,actualBoundingBoxDescent:y,fontBoundingBoxAscent:m,fontBoundingBoxDescent:v,width:b}=d.measureText(e),A=1.5,S=Math.ceil(Math.max(Math.abs(g)+Math.abs(x)||0,b)*A),C=Math.ceil(Math.max(Math.abs(w)+Math.abs(y)||f,Math.abs(m)+Math.abs(v)||f)*A);u=new OffscreenCanvas(S,C),d=u.getContext("2d",{alpha:!0,willReadFrequently:!0}),d.font=p,d.filter="grayscale(1)",d.fillStyle="white",d.fillRect(0,0,S,C),d.fillStyle="black",d.fillText(e,S*(A-1)/2,C*(3-A)/2);const k=R(this,$t,bE).call(this,d.getImageData(0,0,S,C).data),L=R(this,$t,JM).call(this,k),D=R(this,$t,wE).call(this,L),j=R(this,$t,xE).call(this,k,S,C,D);return this.processDrawnLines({lines:{curves:j,width:S,height:C},pageWidth:r,pageHeight:a,rotation:o,innerMargin:l,mustSmooth:!0,areContours:!0})}static process(e,t,i,s,r){const[a,o,l]=R(this,$t,eO).call(this,e),[u,d]=R(this,$t,QM).call(this,a,o,l,Math.hypot(o,l)*c(this,kh).sigmaSFactor,c(this,kh).sigmaR,c(this,kh).kernelSize),f=R(this,$t,wE).call(this,d),p=R(this,$t,xE).call(this,u,o,l,f);return this.processDrawnLines({lines:{curves:p,width:o,height:l},pageWidth:t,pageHeight:i,rotation:s,innerMargin:r,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:i,rotation:s,innerMargin:r,mustSmooth:a,areContours:o}){s%180!==0&&([t,i]=[i,t]);const{curves:l,width:u,height:d}=e,f=e.thickness??0,p=[],g=Math.min(t/u,i/d),x=g/t,w=g/i,y=[];for(const{points:v}of l){const b=a?R(this,$t,ZM).call(this,v):v;if(!b)continue;y.push(b);const A=b.length,S=new Float32Array(A),C=new Float32Array(3*(A===2?2:A-2));if(p.push({line:C,points:S}),A===2){S[0]=b[0]*x,S[1]=b[1]*w,C.set([NaN,NaN,NaN,NaN,S[0],S[1]],0);continue}let[k,L,D,j]=b;k*=x,L*=w,D*=x,j*=w,S.set([k,L,D,j],0),C.set([NaN,NaN,NaN,NaN,k,L],0);for(let P=4;P<A;P+=2){const H=S[P]=b[P]*x,G=S[P+1]=b[P+1]*w;C.set(Ke.createBezierPoints(k,L,D,j,H,G),(P-2)*3),[k,L,D,j]=[D,j,H,G]}}if(p.length===0)return null;const m=o?new yE:new vv;return m.build(p,t,i,1,s,o?0:f,r),{outline:m,newCurves:y,areContours:o,thickness:f,width:u,height:d}}static async compressSignature({outlines:e,areContours:t,thickness:i,width:s,height:r}){let a=1/0,o=-1/0,l=0;for(const b of e){l+=b.length;for(let A=2,S=b.length;A<S;A++){const C=b[A]-b[A-2];a=Math.min(a,C),o=Math.max(o,C)}}let u;a>=-128&&o<=127?u=Int8Array:a>=-32768&&o<=32767?u=Int16Array:u=Int32Array;const d=e.length,f=Kv+Lg*d,p=new Uint32Array(f);let g=0;p[g++]=f*Uint32Array.BYTES_PER_ELEMENT+(l-2*d)*u.BYTES_PER_ELEMENT,p[g++]=0,p[g++]=s,p[g++]=r,p[g++]=t?0:1,p[g++]=Math.max(0,Math.floor(i??0)),p[g++]=d,p[g++]=u.BYTES_PER_ELEMENT;for(const b of e)p[g++]=b.length-2,p[g++]=b[0],p[g++]=b[1];const x=new CompressionStream("deflate-raw"),w=x.writable.getWriter();await w.ready,w.write(p);const y=u.prototype.constructor;for(const b of e){const A=new y(b.length-2);for(let S=2,C=b.length;S<C;S++)A[S-2]=b[S]-b[S-2];w.write(A)}w.close();const m=await new Response(x.readable).arrayBuffer();return new Uint8Array(m).toBase64()}static async decompressSignature(e){try{const t=Uint8Array.fromBase64(e),{readable:i,writable:s}=new DecompressionStream("deflate-raw"),r=s.getWriter();await r.ready,r.write(t).then(async()=>{await r.ready,await r.close()}).catch(()=>{});let a=null,o=0;for await(const b of i)a||(a=new Uint8Array(new Uint32Array(b.buffer,0,4)[0])),a.set(b,o),o+=b.length;const l=new Uint32Array(a.buffer,0,a.length>>2),u=l[1];if(u!==0)throw new Error(`Invalid version: ${u}`);const d=l[2],f=l[3],p=l[4]===0,g=l[5],x=l[6],w=l[7],y=[],m=(Kv+Lg*x)*Uint32Array.BYTES_PER_ELEMENT;let v;switch(w){case Int8Array.BYTES_PER_ELEMENT:v=new Int8Array(a.buffer,m);break;case Int16Array.BYTES_PER_ELEMENT:v=new Int16Array(a.buffer,m);break;case Int32Array.BYTES_PER_ELEMENT:v=new Int32Array(a.buffer,m);break}o=0;for(let b=0;b<x;b++){const A=l[Lg*b+Kv],S=new Float32Array(A+2);y.push(S);for(let C=0;C<Lg-1;C++)S[C]=l[Lg*b+Kv+C+1];for(let C=0;C<A;C++)S[C+2]=S[C]+v[o++]}return{areContours:p,thickness:g,outlines:y,width:d,height:f}}catch(t){return ct(`decompressSignature: ${t}`),null}}}kh=new WeakMap,$t=new WeakSet,vE=function(e,t,i,s){return i-=e,s-=t,i===0?s>0?0:4:i===1?s+6:2-s},ca=new WeakMap,XM=function(e,t,i,s,r,a,o){const l=R(this,$t,vE).call(this,i,s,r,a);for(let u=0;u<8;u++){const d=(-u+l-o+16)%8,f=c(this,ca)[2*d],p=c(this,ca)[2*d+1];if(e[(i+f)*t+(s+p)]!==0)return d}return-1},KM=function(e,t,i,s,r,a,o){const l=R(this,$t,vE).call(this,i,s,r,a);for(let u=0;u<8;u++){const d=(u+l+o+16)%8,f=c(this,ca)[2*d],p=c(this,ca)[2*d+1];if(e[(i+f)*t+(s+p)]!==0)return d}return-1},xE=function(e,t,i,s){const r=e.length,a=new Int32Array(r);for(let d=0;d<r;d++)a[d]=e[d]<=s?1:0;for(let d=1;d<i-1;d++)a[d*t]=a[d*t+t-1]=0;for(let d=0;d<t;d++)a[d]=a[t*i-1-d]=0;let o=1,l;const u=[];for(let d=1;d<i-1;d++){l=1;for(let f=1;f<t-1;f++){const p=d*t+f,g=a[p];if(g===0)continue;let x=d,w=f;if(g===1&&a[p-1]===0)o+=1,w-=1;else if(g>=1&&a[p+1]===0)o+=1,w+=1,g>1&&(l=g);else{g!==1&&(l=Math.abs(g));continue}const y=[f,d],m=w===f+1,v={isHole:m,points:y,id:o,parent:0};u.push(v);let b;for(const P of u)if(P.id===l){b=P;break}b?b.isHole?v.parent=m?b.parent:l:v.parent=m?l:b.parent:v.parent=m?l:0;const A=R(this,$t,XM).call(this,a,t,d,f,x,w,0);if(A===-1){a[p]=-o,a[p]!==1&&(l=Math.abs(a[p]));continue}let S=c(this,ca)[2*A],C=c(this,ca)[2*A+1];const k=d+S,L=f+C;x=k,w=L;let D=d,j=f;for(;;){const P=R(this,$t,KM).call(this,a,t,D,j,x,w,1);S=c(this,ca)[2*P],C=c(this,ca)[2*P+1];const H=D+S,G=j+C;y.push(G,H);const $=D*t+j;if(a[$+1]===0?a[$]=-o:a[$]===1&&(a[$]=o),H===d&&G===f&&D===k&&j===L){a[p]!==1&&(l=Math.abs(a[p]));break}else x=D,w=j,D=H,j=G}}}return u},Gx=function(e,t,i,s){if(i-t<=4){for(let k=t;k<i-2;k+=2)s.push(e[k],e[k+1]);return}const r=e[t],a=e[t+1],o=e[i-4]-r,l=e[i-3]-a,u=Math.hypot(o,l),d=o/u,f=l/u,p=d*a-f*r,g=l/o,x=1/u,w=Math.atan(g),y=Math.cos(w),m=Math.sin(w),v=x*(Math.abs(y)+Math.abs(m)),b=x*(1-v+v**2),A=Math.max(Math.atan(Math.abs(m+y)*b),Math.atan(Math.abs(m-y)*b));let S=0,C=t;for(let k=t+2;k<i-2;k+=2){const L=Math.abs(p-d*e[k+1]+f*e[k]);L>S&&(C=k,S=L)}S>(u*A)**2?(R(this,$t,Gx).call(this,e,t,C+2,s),R(this,$t,Gx).call(this,e,C,i,s)):s.push(r,a)},ZM=function(e){const t=[],i=e.length;return R(this,$t,Gx).call(this,e,0,i,t),t.push(e[i-2],e[i-1]),t.length<=4?null:t},QM=function(e,t,i,s,r,a){const o=new Float32Array(a**2),l=-2*s**2,u=a>>1;for(let w=0;w<a;w++){const y=(w-u)**2;for(let m=0;m<a;m++)o[w*a+m]=Math.exp((y+(m-u)**2)/l)}const d=new Float32Array(256),f=-2*r**2;for(let w=0;w<256;w++)d[w]=Math.exp(w**2/f);const p=e.length,g=new Uint8Array(p),x=new Uint32Array(256);for(let w=0;w<i;w++)for(let y=0;y<t;y++){const m=w*t+y,v=e[m];let b=0,A=0;for(let C=0;C<a;C++){const k=w+C-u;if(!(k<0||k>=i))for(let L=0;L<a;L++){const D=y+L-u;if(D<0||D>=t)continue;const j=e[k*t+D],P=o[C*a+L]*d[Math.abs(j-v)];b+=j*P,A+=P}}const S=g[m]=Math.round(b/A);x[S]++}return[g,x]},JM=function(e){const t=new Uint32Array(256);for(const i of e)t[i]++;return t},bE=function(e){const t=e.length,i=new Uint8ClampedArray(t>>2);let s=-1/0,r=1/0;for(let o=0,l=i.length;o<l;o++){const u=i[o]=e[o<<2];s=Math.max(s,u),r=Math.min(r,u)}const a=255/(s-r);for(let o=0,l=i.length;o<l;o++)i[o]=(i[o]-r)*a;return i},wE=function(e){let t,i=-1/0,s=-1/0;const r=e.findIndex(l=>l!==0);let a=r,o=r;for(t=r;t<256;t++){const l=e[t];l>i&&(t-a>s&&(s=t-a,o=t-1),i=l,a=t)}for(t=o-1;t>=0&&!(e[t]>e[t+1]);t--);return t},eO=function(e){const t=e,{width:i,height:s}=e,{maxDim:r}=c(this,kh);let a=i,o=s;if(i>r||s>r){let p=i,g=s,x=Math.log2(Math.max(i,s)/r);const w=Math.floor(x);x=x===w?w-1:w;for(let m=0;m<x;m++){a=Math.ceil(p/2),o=Math.ceil(g/2);const v=new OffscreenCanvas(a,o);v.getContext("2d").drawImage(e,0,0,p,g,0,0,a,o),p=a,g=o,e!==t&&e.close(),e=v.transferToImageBitmap()}const y=Math.min(r/a,r/o);a=Math.round(a*y),o=Math.round(o*y)}const u=new OffscreenCanvas(a,o).getContext("2d",{willReadFrequently:!0});u.fillStyle="white",u.fillRect(0,0,a,o),u.filter="grayscale(1)",u.drawImage(e,0,0,e.width,e.height,0,0,a,o);const d=u.getImageData(0,0,a,o).data;return[R(this,$t,bE).call(this,d),a,o]},T(tl,$t),T(tl,kh,{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}),T(tl,ca,new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]));class x_ extends $M{constructor(){super(),super.updateProperties({fill:hi._defaultLineColor,"stroke-width":0})}clone(){const e=new x_;return e.updateAll(this),e}}class b_ extends vw{constructor(e){super(e),super.updateProperties({stroke:hi._defaultLineColor,"stroke-width":1})}clone(){const e=new b_(this._viewParameters);return e.updateAll(this),e}}var Ec,$a,Cc,Th;const Rs=class Rs extends r1{constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"});T(this,Ec,!1);T(this,$a,null);T(this,Cc,null);T(this,Th,null);this._willKeepAspectRatio=!0,_(this,Cc,t.signatureData||null),_(this,$a,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,i){hi.initialize(t,i),this._defaultDrawingOptions=new x_,this._defaultDrawnSignatureOptions=new b_(i.viewParameters)}static getDefaultDrawingOptions(t){const i=this._defaultDrawingOptions.clone();return i.updateProperties(t),i}static get supportMultipleDrawings(){return!1}static get typesMap(){return ut(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!c(this,$a)}}static computeTelemetryFinalData(t){const i=t.get("hasDescription");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,i;const{_isCopy:s}=this;if(s&&(this._isCopy=!1,t=this.x,i=this.y),super.render(),this._drawId===null)if(c(this,Cc)){const{lines:r,mustSmooth:a,areContours:o,description:l,uuid:u,heightInPage:d}=c(this,Cc),{rawDims:{pageWidth:f,pageHeight:p},rotation:g}=this.parent.viewport,x=tl.processDrawnLines({lines:r,pageWidth:f,pageHeight:p,rotation:g,innerMargin:Rs._INNER_MARGIN,mustSmooth:a,areContours:o});this.addSignature(x,d,l,u)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:c(this,$a)||""}));return s&&(this._isCopy=!0,this._moveAfterPaste(t,i)),this.div}setUuid(t){_(this,Th,t),this.addEditToolbar()}getUuid(){return c(this,Th)}get description(){return c(this,$a)}set description(t){_(this,$a,t),this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(i=>{i==null||i.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:i,thickness:s,width:r,height:a}=c(this,Cc),o=Math.max(r,a),l=tl.processDrawnLines({lines:{curves:t.map(u=>({points:u})),thickness:s,width:r,height:a},pageWidth:o,pageHeight:o,rotation:0,innerMargin:0,mustSmooth:!1,areContours:i});return{areContours:i,outline:l.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,i,s,r){const{x:a,y:o}=this,{outline:l}=_(this,Cc,t);_(this,Ec,l instanceof yE),this.description=s;let u;c(this,Ec)?u=Rs.getDefaultDrawingOptions():(u=Rs._defaultDrawnSignatureOptions.clone(),u.updateProperties({"stroke-width":l.thickness})),this._addOutlines({drawOutlines:l,drawingOptions:u});const[,d]=this.pageDimensions;let f=i/d;f=f>=1?.5:f,this.width*=f/this.height,this.width>=1&&(f*=.9/this.width,this.width=.9),this.height=f,this.setDims(),this.x=a,this.y=o,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(r),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!r,hasDescription:!!s}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:i,pageHeight:s},rotation:r}=this.parent.viewport;return tl.process(t,i,s,r,Rs._INNER_MARGIN)}getFromText(t,i){const{rawDims:{pageWidth:s,pageHeight:r},rotation:a}=this.parent.viewport;return tl.extractContoursFromText(t,i,s,r,a,Rs._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:i,pageHeight:s},rotation:r}=this.parent.viewport;return tl.processDrawnLines({lines:t,pageWidth:i,pageHeight:s,rotation:r,innerMargin:Rs._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:i}){t?this._drawingOptions=Rs.getDefaultDrawingOptions():(this._drawingOptions=Rs._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":i}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:i,points:s}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":r}}=this,a=Object.assign(super.serialize(t),{isSignature:!0,areContours:c(this,Ec),color:[0,0,0],thickness:c(this,Ec)?0:r});return this.addComment(a),t?(a.paths={lines:i,points:s},a.uuid=c(this,Th),a.isCopy=!0):a.lines=i,c(this,$a)&&(a.accessibilityData={type:"Figure",alt:c(this,$a)}),a}static deserializeDraw(t,i,s,r,a,o){return o.areContours?yE.deserialize(t,i,s,r,a,o):vv.deserialize(t,i,s,r,a,o)}static async deserialize(t,i,s){var a;const r=await super.deserialize(t,i,s);return _(r,Ec,t.areContours),r.description=((a=t.accessibilityData)==null?void 0:a.alt)||"",_(r,Th,t.uuid),r}};Ec=new WeakMap,$a=new WeakMap,Cc=new WeakMap,Th=new WeakMap,fe(Rs,"_type","signature"),fe(Rs,"_editorType",ft.SIGNATURE),fe(Rs,"_defaultDrawingOptions",null);let SE=Rs;var wi,mn,_c,Xo,Nc,jp,Ko,Dh,qa,Zs,Rp,It,sm,rm,Yx,Wx,Xx,EE,Kx,tO;class AE extends hi{constructor(t){super({...t,name:"stampEditor"});T(this,It);T(this,wi,null);T(this,mn,null);T(this,_c,null);T(this,Xo,null);T(this,Nc,null);T(this,jp,"");T(this,Ko,null);T(this,Dh,!1);T(this,qa,null);T(this,Zs,!1);T(this,Rp,!1);_(this,Xo,t.bitmapUrl),_(this,Nc,t.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,i){hi.initialize(t,i)}static isHandlingMimeForPasting(t){return aA.includes(t)}static paste(t,i){i.pasteEditor({mode:ft.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const i=t.get("hasAltText");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}async mlGuessAltText(t=null,i=!0){if(this.hasAltTextData())return null;const{mlManager:s}=this._uiManager;if(!s)throw new Error("No ML.");if(!await s.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:a,height:o}=t||this.copyCanvas(null,null,!0).imageData,l=await s.guess({name:"altText",request:{data:r,width:a,height:o,channels:r.length/(a*o)}});if(!l)throw new Error("No response from the AI service.");if(l.error)throw new Error("Error from the AI service.");if(l.cancel)return null;if(!l.output)throw new Error("No valid response from the AI service.");const u=l.output;return await this.setGuessedAltText(u),i&&!this.hasAltTextData()&&(this.altTextData={alt:u,decorative:!1}),u}remove(){var t;c(this,mn)&&(_(this,wi,null),this._uiManager.imageManager.deleteId(c(this,mn)),(t=c(this,Ko))==null||t.remove(),_(this,Ko,null),c(this,qa)&&(clearTimeout(c(this,qa)),_(this,qa,null))),super.remove()}rebuild(){if(!this.parent){c(this,mn)&&R(this,It,Yx).call(this);return}super.rebuild(),this.div!==null&&(c(this,mn)&&c(this,Ko)===null&&R(this,It,Yx).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(c(this,_c)||c(this,wi)||c(this,Xo)||c(this,Nc)||c(this,mn)||c(this,Dh))}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,i;return this._isCopy&&(t=this.x,i=this.y),super.render(),this.div.hidden=!0,this.createAltText(),c(this,Dh)||(c(this,wi)?R(this,It,Wx).call(this):R(this,It,Yx).call(this)),this._isCopy&&this._moveAfterPaste(t,i),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,i){const{id:s,bitmap:r}=this._uiManager.imageManager.getFromCanvas(t,i);i.remove(),s&&this._uiManager.imageManager.isValidId(s)&&(_(this,mn,s),r&&_(this,wi,r),_(this,Dh,!1),R(this,It,Wx).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;c(this,qa)!==null&&clearTimeout(c(this,qa)),_(this,qa,setTimeout(()=>{_(this,qa,null),R(this,It,EE).call(this)},200))}copyCanvas(t,i,s=!1){t||(t=224);const{width:r,height:a}=c(this,wi),o=new eo;let l=c(this,wi),u=r,d=a,f=null;if(i){if(r>i||a>i){const k=Math.min(i/r,i/a);u=Math.floor(r*k),d=Math.floor(a*k)}f=document.createElement("canvas");const g=f.width=Math.ceil(u*o.sx),x=f.height=Math.ceil(d*o.sy);c(this,Zs)||(l=R(this,It,Xx).call(this,g,x));const w=f.getContext("2d");w.filter=this._uiManager.hcmFilter;let y="white",m="#cfcfd8";this._uiManager.hcmFilter!=="none"?m="black":sV.isDarkMode&&(y="#8f8f9d",m="#42414d");const v=15,b=v*o.sx,A=v*o.sy,S=new OffscreenCanvas(b*2,A*2),C=S.getContext("2d");C.fillStyle=y,C.fillRect(0,0,b*2,A*2),C.fillStyle=m,C.fillRect(0,0,b,A),C.fillRect(b,A,b,A),w.fillStyle=w.createPattern(S,"repeat"),w.fillRect(0,0,g,x),w.drawImage(l,0,0,l.width,l.height,0,0,g,x)}let p=null;if(s){let g,x;if(o.symmetric&&l.width<t&&l.height<t)g=l.width,x=l.height;else if(l=c(this,wi),r>t||a>t){const m=Math.min(t/r,t/a);g=Math.floor(r*m),x=Math.floor(a*m),c(this,Zs)||(l=R(this,It,Xx).call(this,g,x))}const y=new OffscreenCanvas(g,x).getContext("2d",{willReadFrequently:!0});y.drawImage(l,0,0,l.width,l.height,0,0,g,x),p={width:g,height:x,data:y.getImageData(0,0,g,x).data}}return{canvas:f,width:u,height:d,imageData:p}}static async deserialize(t,i,s){var y;let r=null,a=!1;if(t instanceof yM){const{data:{rect:m,rotation:v,id:b,structParent:A,popupRef:S,richText:C,contentsObj:k,creationDate:L,modificationDate:D},container:j,parent:{page:{pageNumber:P}},canvas:H}=t;let G,$;H?(delete t.canvas,{id:G,bitmap:$}=s.imageManager.getFromCanvas(j.id,H),H.remove()):(a=!0,t._hasNoCanvas=!0);const Y=((y=await i._structTree.getAriaAttributes(`${Xd}${b}`))==null?void 0:y.get("aria-label"))||"";r=t={annotationType:ft.STAMP,bitmapId:G,bitmap:$,pageIndex:P-1,rect:m.slice(0),rotation:v,annotationElementId:b,id:b,deleted:!1,accessibilityData:{decorative:!1,altText:Y},isSvg:!1,structParent:A,popupRef:S,richText:C,comment:(k==null?void 0:k.str)||null,creationDate:L,modificationDate:D}}const o=await super.deserialize(t,i,s),{rect:l,bitmap:u,bitmapUrl:d,bitmapId:f,isSvg:p,accessibilityData:g}=t;a?(s.addMissingCanvas(t.id,o),_(o,Dh,!0)):f&&s.imageManager.isValidId(f)?(_(o,mn,f),u&&_(o,wi,u)):_(o,Xo,d),_(o,Zs,p);const[x,w]=o.pageDimensions;return o.width=(l[2]-l[0])/x,o.height=(l[3]-l[1])/w,g&&(o.altTextData=g),o._initialData=r,t.comment&&o.setCommentData(t),_(o,Rp,!!r),o}serialize(t=!1,i=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=Object.assign(super.serialize(t),{bitmapId:c(this,mn),isSvg:c(this,Zs)});if(this.addComment(s),t)return s.bitmapUrl=R(this,It,Kx).call(this,!0),s.accessibilityData=this.serializeAltText(!0),s.isCopy=!0,s;const{decorative:r,altText:a}=this.serializeAltText(!1);if(!r&&a&&(s.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const l=R(this,It,tO).call(this,s);return l.isSame?null:(l.isSameAltText?delete s.accessibilityData:s.accessibilityData.structParent=this._initialData.structParent??-1,s.id=this.annotationElementId,delete s.bitmapId,s)}if(i===null)return s;i.stamps||(i.stamps=new Map);const o=c(this,Zs)?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(!i.stamps.has(c(this,mn)))i.stamps.set(c(this,mn),{area:o,serialized:s}),s.bitmap=R(this,It,Kx).call(this,!1);else if(c(this,Zs)){const l=i.stamps.get(c(this,mn));o>l.area&&(l.area=o,l.serialized.bitmap.close(),l.serialized.bitmap=R(this,It,Kx).call(this,!1))}return s}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}wi=new WeakMap,mn=new WeakMap,_c=new WeakMap,Xo=new WeakMap,Nc=new WeakMap,jp=new WeakMap,Ko=new WeakMap,Dh=new WeakMap,qa=new WeakMap,Zs=new WeakMap,Rp=new WeakMap,It=new WeakSet,sm=function(t,i=!1){if(!t){this.remove();return}_(this,wi,t.bitmap),i||(_(this,mn,t.id),_(this,Zs,t.isSvg)),t.file&&_(this,jp,t.file.name),R(this,It,Wx).call(this)},rm=function(){if(_(this,_c,null),this._uiManager.enableWaiting(!1),!!c(this,Ko)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&c(this,wi)){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&c(this,wi)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},Yx=function(){if(c(this,mn)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(c(this,mn)).then(s=>R(this,It,sm).call(this,s,!0)).finally(()=>R(this,It,rm).call(this));return}if(c(this,Xo)){const s=c(this,Xo);_(this,Xo,null),this._uiManager.enableWaiting(!0),_(this,_c,this._uiManager.imageManager.getFromUrl(s).then(r=>R(this,It,sm).call(this,r)).finally(()=>R(this,It,rm).call(this)));return}if(c(this,Nc)){const s=c(this,Nc);_(this,Nc,null),this._uiManager.enableWaiting(!0),_(this,_c,this._uiManager.imageManager.getFromFile(s).then(r=>R(this,It,sm).call(this,r)).finally(()=>R(this,It,rm).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=aA.join(",");const i=this._uiManager._signal;_(this,_c,new Promise(s=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),R(this,It,sm).call(this,r)}s()},{signal:i}),t.addEventListener("cancel",()=>{this.remove(),s()},{signal:i})}).finally(()=>R(this,It,rm).call(this))),t.click()},Wx=function(){var u;const{div:t}=this;let{width:i,height:s}=c(this,wi);const[r,a]=this.pageDimensions,o=.75;if(this.width)i=this.width*r,s=this.height*a;else if(i>o*r||s>o*a){const d=Math.min(o*r/i,o*a/s);i*=d,s*=d}this._uiManager.enableWaiting(!1);const l=_(this,Ko,document.createElement("canvas"));l.setAttribute("role","img"),this.addContainer(l),this.width=i/r,this.height=s/a,this.setDims(),(u=this._initialOptions)!=null&&u.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),R(this,It,EE).call(this),c(this,Rp)||(this.parent.addUndoableEditor(this),_(this,Rp,!0)),this._reportTelemetry({action:"inserted_image"}),c(this,jp)&&this.div.setAttribute("aria-description",c(this,jp)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")},Xx=function(t,i){const{width:s,height:r}=c(this,wi);let a=s,o=r,l=c(this,wi);for(;a>2*t||o>2*i;){const u=a,d=o;a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),o>2*i&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const f=new OffscreenCanvas(a,o);f.getContext("2d").drawImage(l,0,0,u,d,0,0,a,o),l=f.transferToImageBitmap()}return l},EE=function(){const[t,i]=this.parentDimensions,{width:s,height:r}=this,a=new eo,o=Math.ceil(s*t*a.sx),l=Math.ceil(r*i*a.sy),u=c(this,Ko);if(!u||u.width===o&&u.height===l)return;u.width=o,u.height=l;const d=c(this,Zs)?c(this,wi):R(this,It,Xx).call(this,o,l),f=u.getContext("2d");f.filter=this._uiManager.hcmFilter,f.drawImage(d,0,0,d.width,d.height,0,0,o,l)},Kx=function(t){if(t){if(c(this,Zs)){const r=this._uiManager.imageManager.getSvgUrl(c(this,mn));if(r)return r}const i=document.createElement("canvas");return{width:i.width,height:i.height}=c(this,wi),i.getContext("2d").drawImage(c(this,wi),0,0),i.toDataURL()}if(c(this,Zs)){const[i,s]=this.pageDimensions,r=Math.round(this.width*i*tu.PDF_TO_CSS_UNITS),a=Math.round(this.height*s*tu.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(r,a);return o.getContext("2d").drawImage(c(this,wi),0,0,c(this,wi).width,c(this,wi).height,0,0,r,a),o.transferToImageBitmap()}return structuredClone(c(this,wi))},tO=function(t){var o;const{pageIndex:i,accessibilityData:{altText:s}}=this._initialData,r=t.pageIndex===i,a=(((o=t.accessibilityData)==null?void 0:o.alt)||"")===s;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&r&&a,isSameAltText:a}},fe(AE,"_type","stamp"),fe(AE,"_editorType",ft.STAMP);var jh,Lp,kc,Tc,Zo,bs,Dc,Mp,Op,ua,Qo,yn,Jo,jc,Ip,Je,Rc,ai,_E,iO,Sa,NE,kE,Zx;const Qr=class Qr{constructor({uiManager:e,pageIndex:t,div:i,structTreeLayer:s,accessibilityManager:r,annotationLayer:a,drawLayer:o,textLayer:l,viewport:u,l10n:d}){T(this,ai);T(this,jh);T(this,Lp,!1);T(this,kc,null);T(this,Tc,null);T(this,Zo,null);T(this,bs,new Map);T(this,Dc,!1);T(this,Mp,!1);T(this,Op,!1);T(this,ua,null);T(this,Qo,null);T(this,yn,null);T(this,Jo,null);T(this,jc,null);T(this,Ip,-1);T(this,Je);const f=[...c(Qr,Rc).values()];if(!Qr._initialized){Qr._initialized=!0;for(const p of f)p.initialize(d,e)}e.registerEditorTypes(f),_(this,Je,e),this.pageIndex=t,this.div=i,_(this,jh,r),_(this,kc,a),this.viewport=u,_(this,yn,l),this.drawLayer=o,this._structTree=s,c(this,Je).addLayer(this)}updatePageIndex(e){this.pageIndex=e}get isEmpty(){return c(this,bs).size===0}get isInvisible(){return this.isEmpty&&c(this,Je).getMode()===ft.NONE}updateToolbar(e){c(this,Je).updateToolbar(e)}updateMode(e=c(this,Je).getMode()){switch(R(this,ai,Zx).call(this),e){case ft.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case ft.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case ft.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;if(t.toggle("nonEditing",!1),e===ft.POPUP)t.toggle("commentEditing",!0);else{t.toggle("commentEditing",!1);for(const i of c(Qr,Rc).values())t.toggle(`${i._type}Editing`,e===i._editorType)}this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=c(this,yn))==null?void 0:t.div)}setEditingState(e){c(this,Je).setEditingState(e)}addCommands(e){c(this,Je).addCommands(e)}cleanUndoStack(e){c(this,Je).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=c(this,kc))==null||t.togglePointerEvents(e)}async enable(){var i;_(this,Op,!0),this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),(i=c(this,jc))==null||i.abort(),_(this,jc,null);const e=new Set;for(const s of c(this,ai,_E))s.enableEditing(),s.show(!0),s.annotationElementId&&(c(this,Je).removeChangedExistingAnnotation(s),e.add(s.annotationElementId));const t=c(this,kc);if(t)for(const s of t.getEditableAnnotations()){if(s.hide(),c(this,Je).isDeletedAnnotationElement(s.data.id)||e.has(s.data.id))continue;const r=await this.deserialize(s);r&&(this.addOrRebuild(r),r.enableEditing())}_(this,Op,!1),c(this,Je)._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){var s;if(_(this,Mp,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),c(this,yn)&&!c(this,jc)){_(this,jc,new AbortController);const r=c(this,Je).combinedSignal(c(this,jc));c(this,yn).div.addEventListener("pointerdown",a=>{const{clientX:l,clientY:u,timeStamp:d}=a,f=c(this,Ip);if(d-f>500){_(this,Ip,d);return}_(this,Ip,-1);const{classList:p}=this.div;p.toggle("getElements",!0);const g=document.elementsFromPoint(l,u);if(p.toggle("getElements",!1),!this.div.contains(g[0]))return;let x;const w=new RegExp(`^${Gm}[0-9]+$`);for(const m of g)if(w.test(m.id)){x=m.id;break}if(!x)return;const y=c(this,bs).get(x);(y==null?void 0:y.annotationElementId)===null&&(a.stopPropagation(),a.preventDefault(),y.dblclick(a))},{signal:r,capture:!0})}const e=c(this,kc),t=[];if(e){const r=new Map,a=new Map;for(const l of c(this,ai,_E)){if(l.disableEditing(),!l.annotationElementId){t.push(l);continue}if(l.serialize()!==null){r.set(l.annotationElementId,l);continue}else a.set(l.annotationElementId,l);(s=this.getEditableAnnotation(l.annotationElementId))==null||s.show(),l.remove()}const o=e.getEditableAnnotations();for(const l of o){const{id:u}=l.data;if(c(this,Je).isDeletedAnnotationElement(u)){l.updateEdited({deleted:!0});continue}let d=a.get(u);if(d){d.resetAnnotationElement(l),d.show(!1),l.show();continue}d=r.get(u),d&&(c(this,Je).addChangedExistingAnnotation(d),d.renderAnnotationElement(l)&&d.show(!1)),l.show()}}R(this,ai,Zx).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:i}=this.div;for(const r of c(Qr,Rc).values())i.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),e==null||e.updateFakeAnnotations(t),_(this,Mp,!1)}getEditableAnnotation(e){var t;return((t=c(this,kc))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){c(this,Je).getActive()!==e&&c(this,Je).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=c(this,yn))!=null&&e.div&&!c(this,Jo)){_(this,Jo,new AbortController);const t=c(this,Je).combinedSignal(c(this,Jo));c(this,yn).div.addEventListener("pointerdown",R(this,ai,iO).bind(this),{signal:t}),c(this,yn).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=c(this,yn))!=null&&e.div&&c(this,Jo)&&(c(this,Jo).abort(),_(this,Jo,null),c(this,yn).div.classList.remove("highlighting"))}enableClick(){if(c(this,Tc))return;_(this,Tc,new AbortController);const e=c(this,Je).combinedSignal(c(this,Tc));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=c(this,Tc))==null||e.abort(),_(this,Tc,null)}attach(e){c(this,bs).set(e.id,e);const{annotationElementId:t}=e;t&&c(this,Je).isDeletedAnnotationElement(t)&&c(this,Je).removeDeletedAnnotationElement(e)}detach(e){var t;c(this,bs).delete(e.id),(t=c(this,jh))==null||t.removePointerInTextLayer(e.contentDiv),!c(this,Mp)&&e.annotationElementId&&c(this,Je).addDeletedAnnotationElement(e)}remove(e){this.detach(e),c(this,Je).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(c(this,Je).addDeletedAnnotationElement(e),hi.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),c(this,Je).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!c(this,Op)),c(this,Je).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var i;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!c(this,Zo)&&(e._focusEventsAllowed=!1,_(this,Zo,setTimeout(()=>{_(this,Zo,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:c(this,Je)._signal}),t.focus())},0))),e._structTreeParentId=(i=c(this,jh))==null?void 0:i.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),i=()=>{e.remove()};this.addCommands({cmd:t,undo:i,mustExec:!1})}getEditorByUID(e){for(const t of c(this,bs).values())if(t.uid===e)return t;return null}getNextId(){return c(this,Je).getId()}combinedSignal(e){return c(this,Je).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=c(this,ai,Sa))==null?void 0:e.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await c(this,Je).updateMode(e.mode);const{offsetX:i,offsetY:s}=R(this,ai,kE).call(this),r=this.getNextId(),a=R(this,ai,NE).call(this,{parent:this,id:r,x:i,y:s,uiManager:c(this,Je),isCentered:!0,...t});a&&this.add(a)}async deserialize(e){var t;return await((t=c(Qr,Rc).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,c(this,Je)))||null}createAndAddNewEditor(e,t,i={}){const s=this.getNextId(),r=R(this,ai,NE).call(this,{parent:this,id:s,x:e.offsetX,y:e.offsetY,uiManager:c(this,Je),isCentered:t,...i});return r&&this.add(r),r}get boundingClientRect(){return this.div.getBoundingClientRect()}addNewEditor(e={}){this.createAndAddNewEditor(R(this,ai,kE).call(this),!0,e)}setSelected(e){c(this,Je).setSelected(e)}toggleSelected(e){c(this,Je).toggleSelected(e)}unselect(e){c(this,Je).unselect(e)}pointerup(e){var s;const{isMac:t}=on.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!c(this,Dc)||(_(this,Dc,!1),(s=c(this,ai,Sa))!=null&&s.isDrawer&&c(this,ai,Sa).supportMultipleDrawings))return;if(!c(this,Lp)){_(this,Lp,!0);return}const i=c(this,Je).getMode();if(i===ft.STAMP||i===ft.SIGNATURE){c(this,Je).unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){var s;if(c(this,Je).getMode()===ft.HIGHLIGHT&&this.enableTextSelection(),c(this,Dc)){_(this,Dc,!1);return}const{isMac:t}=on.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(_(this,Dc,!0),(s=c(this,ai,Sa))!=null&&s.isDrawer){this.startDrawingSession(e);return}const i=c(this,Je).getActive();_(this,Lp,!i||i.isEmpty())}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),c(this,ua)){c(this,ai,Sa).startDrawing(this,c(this,Je),!1,e);return}c(this,Je).setCurrentDrawingSession(this),_(this,ua,new AbortController);const t=c(this,Je).combinedSignal(c(this,ua));this.div.addEventListener("blur",({relatedTarget:i})=>{i&&!this.div.contains(i)&&(_(this,Qo,null),this.commitOrRemove())},{signal:t}),c(this,ai,Sa).startDrawing(this,c(this,Je),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&_(this,Qo,t);return}c(this,Qo)&&setTimeout(()=>{var t;(t=c(this,Qo))==null||t.focus(),_(this,Qo,null)},0)}endDrawingSession(e=!1){return c(this,ua)?(c(this,Je).setCurrentDrawingSession(null),c(this,ua).abort(),_(this,ua,null),_(this,Qo,null),c(this,ai,Sa).endDrawing(e)):null}findNewParent(e,t,i){const s=c(this,Je).findParent(t,i);return s===null||s===this?!1:(s.changeParent(e),!0)}commitOrRemove(){return c(this,ua)?(this.endDrawingSession(),!0):!1}onScaleChanging(){c(this,ua)&&c(this,ai,Sa).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=c(this,Je).getActive())==null?void 0:e.parent)===this&&(c(this,Je).commitOrRemove(),c(this,Je).setActiveEditor(null)),c(this,Zo)&&(clearTimeout(c(this,Zo)),_(this,Zo,null));for(const i of c(this,bs).values())(t=c(this,jh))==null||t.removePointerInTextLayer(i.contentDiv),i.setParent(null),i.isAttachedToDOM=!1,i.div.remove();this.div=null,c(this,bs).clear(),c(this,Je).removeLayer(this)}render({viewport:e}){this.viewport=e,Vh(this.div,e);for(const t of c(this,Je).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){c(this,Je).commitOrRemove(),R(this,ai,Zx).call(this);const t=this.viewport.rotation,i=e.rotation;if(this.viewport=e,Vh(this.div,{rotation:i}),t!==i)for(const s of c(this,bs).values())s.rotate(i)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return c(this,Je).viewParameters.realScale}};jh=new WeakMap,Lp=new WeakMap,kc=new WeakMap,Tc=new WeakMap,Zo=new WeakMap,bs=new WeakMap,Dc=new WeakMap,Mp=new WeakMap,Op=new WeakMap,ua=new WeakMap,Qo=new WeakMap,yn=new WeakMap,Jo=new WeakMap,jc=new WeakMap,Ip=new WeakMap,Je=new WeakMap,Rc=new WeakMap,ai=new WeakSet,_E=function(){return c(this,bs).size!==0?c(this,bs).values():c(this,Je).getEditors(this.pageIndex)},iO=function(e){c(this,Je).unselectAll();const{target:t}=e;if(t===c(this,yn).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&c(this,yn).div.contains(t)){const{isMac:i}=on.platform;if(e.button!==0||e.ctrlKey&&i)return;c(this,Je).showAllEditors("highlight",!0,!0),c(this,yn).div.classList.add("free"),this.toggleDrawing(),s1.startHighlighting(this,c(this,Je).direction==="ltr",{target:c(this,yn).div,x:e.x,y:e.y}),c(this,yn).div.addEventListener("pointerup",()=>{c(this,yn).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:c(this,Je)._signal}),e.preventDefault()}},Sa=function(){return c(Qr,Rc).get(c(this,Je).getMode())},NE=function(e){const t=c(this,ai,Sa);return t?new t.prototype.constructor(e):null},kE=function(){const{x:e,y:t,width:i,height:s}=this.boundingClientRect,r=Math.max(0,e),a=Math.max(0,t),o=Math.min(window.innerWidth,e+i),l=Math.min(window.innerHeight,t+s),u=(r+o)/2-e,d=(a+l)/2-t,[f,p]=this.viewport.rotation%180===0?[u,d]:[d,u];return{offsetX:f,offsetY:p}},Zx=function(){for(const e of c(this,bs).values())e.isEmpty()&&e.remove()},fe(Qr,"_initialized",!1),T(Qr,Rc,new Map([aE,mE,AE,s1,SE].map(e=>[e._editorType,e])));let CE=Qr;var ha,es,Rh,qy,E1,nO,io,DE,sO,jE;const nn=class nn{constructor(){T(this,io);T(this,ha,null);T(this,es,new Map);T(this,Rh,new Map)}setParent(e){if(!c(this,ha)){_(this,ha,e);return}if(c(this,ha)!==e){if(c(this,es).size>0)for(const t of c(this,es).values())t.remove(),e.append(t);_(this,ha,e)}}static get _svgFactory(){return ut(this,"_svgFactory",new i1)}draw(e,t=!1,i=!1){const s=en(nn,qy)._++,r=R(this,io,DE).call(this),a=nn._svgFactory.createElement("defs");r.append(a);const o=nn._svgFactory.createElement("path");a.append(o);const l=`path_${s}`;o.setAttribute("id",l),o.setAttribute("vector-effect","non-scaling-stroke"),t&&c(this,Rh).set(s,o);const u=i?R(this,io,sO).call(this,a,l):null,d=nn._svgFactory.createElement("use");return r.append(d),d.setAttribute("href",`#${l}`),this.updateProperties(r,e),c(this,es).set(s,r),{id:s,clipPathId:`url(#${u})`}}drawOutline(e,t){const i=en(nn,qy)._++,s=R(this,io,DE).call(this),r=nn._svgFactory.createElement("defs");s.append(r);const a=nn._svgFactory.createElement("path");r.append(a);const o=`path_${i}`;a.setAttribute("id",o),a.setAttribute("vector-effect","non-scaling-stroke");let l;if(t){const f=nn._svgFactory.createElement("mask");r.append(f),l=`mask_${i}`,f.setAttribute("id",l),f.setAttribute("maskUnits","objectBoundingBox");const p=nn._svgFactory.createElement("rect");f.append(p),p.setAttribute("width","1"),p.setAttribute("height","1"),p.setAttribute("fill","white");const g=nn._svgFactory.createElement("use");f.append(g),g.setAttribute("href",`#${o}`),g.setAttribute("stroke","none"),g.setAttribute("fill","black"),g.setAttribute("fill-rule","nonzero"),g.classList.add("mask")}const u=nn._svgFactory.createElement("use");s.append(u),u.setAttribute("href",`#${o}`),l&&u.setAttribute("mask",`url(#${l})`);const d=u.cloneNode();return s.append(d),u.classList.add("mainOutline"),d.classList.add("secondaryOutline"),this.updateProperties(s,e),c(this,es).set(i,s),i}finalizeDraw(e,t){c(this,Rh).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var l;if(!t)return;const{root:i,bbox:s,rootClass:r,path:a}=t,o=typeof e=="number"?c(this,es).get(e):e;if(o){if(i&&R(this,io,jE).call(this,o,i),s&&R(l=nn,E1,nO).call(l,o,s),r){const{classList:u}=o;for(const[d,f]of Object.entries(r))u.toggle(d,f)}if(a){const d=o.firstElementChild.firstElementChild;R(this,io,jE).call(this,d,a)}}}updateParent(e,t){if(t===this)return;const i=c(this,es).get(e);i&&(c(t,ha).append(i),c(this,es).delete(e),c(t,es).set(e,i))}remove(e){c(this,Rh).delete(e),c(this,ha)!==null&&(c(this,es).get(e).remove(),c(this,es).delete(e))}destroy(){_(this,ha,null);for(const e of c(this,es).values())e.remove();c(this,es).clear(),c(this,Rh).clear()}};ha=new WeakMap,es=new WeakMap,Rh=new WeakMap,qy=new WeakMap,E1=new WeakSet,nO=function(e,[t,i,s,r]){const{style:a}=e;a.top=`${100*i}%`,a.left=`${100*t}%`,a.width=`${100*s}%`,a.height=`${100*r}%`},io=new WeakSet,DE=function(){const e=nn._svgFactory.create(1,1,!0);return c(this,ha).append(e),e.setAttribute("aria-hidden",!0),e},sO=function(e,t){const i=nn._svgFactory.createElement("clipPath");e.append(i);const s=`clip_${t}`;i.setAttribute("id",s),i.setAttribute("clipPathUnits","objectBoundingBox");const r=nn._svgFactory.createElement("use");return i.append(r),r.setAttribute("href",`#${t}`),r.classList.add("clip"),s},jE=function(e,t){for(const[i,s]of Object.entries(t))s===null?e.removeAttribute(i):e.setAttribute(i,s)},T(nn,E1),T(nn,qy,0);let TE=nn;globalThis._pdfjsTestingUtils={HighlightOutliner:lE};globalThis.pdfjsLib={AbortException:eu,AnnotationEditorLayer:CE,AnnotationEditorParamsType:Tt,AnnotationEditorType:ft,AnnotationEditorUIManager:Gh,AnnotationLayer:sE,AnnotationMode:Bl,AnnotationType:Gi,applyOpacity:aV,build:fG,ColorPicker:e1,createValidAbsoluteUrl:P4,CSSConstants:rV,DOMSVGFactory:i1,DrawLayer:TE,FeatureTest:on,fetchData:pv,findContrastColor:oV,getDocument:m_,getFilenameFromUrl:Jq,getPdfFilenameFromUrl:eV,getRGB:mv,getUuid:F4,getXfaPageViewport:iV,GlobalWorkerOptions:pa,ImageKind:yx,InvalidPDFException:sA,isDataScheme:dw,isPdfFile:d_,isValidExplicitDest:vV,MathClamp:Dn,noContextMenu:Gr,normalizeUnicode:Zq,OPS:Ym,OutputScale:eo,PagesMapper:Xm,PasswordResponses:Uq,PDFDataRangeTransport:iM,PDFDateString:Wb,PDFWorker:Km,PermissionFlag:zq,PixelsPerInch:tu,RenderingCancelledException:hw,renderRichText:U4,ResponseException:Yb,setLayerDimensions:Vh,shadow:ut,SignatureExtractor:tl,stopEvent:Mi,SupportedImageMimeTypes:aA,TextLayer:tg,TouchManager:Kb,updateUrlHash:B4,Util:Ye,VerbosityLevel:ow,version:dG,XfaLayer:z4};const rO="/assets/pdf.worker-BA9kU3Pw.mjs";pa.workerSrc=rO;const RE=[{name:"yellow",bg:"rgba(250, 204, 21, 0.4)",css:"#facc15"},{name:"green",bg:"rgba(74, 222, 128, 0.4)",css:"#4ade80"},{name:"blue",bg:"rgba(96, 165, 250, 0.4)",css:"#60a5fa"},{name:"pink",bg:"rgba(244, 114, 182, 0.4)",css:"#f472b6"},{name:"purple",bg:"rgba(192, 132, 252, 0.4)",css:"#c084fc"}],lD={dark:"#1a1a1a",light:"#ffffff",sepia:"#f4ecd8"},cD=2,PG=.6,BG=2.5,FG=.002;function uD(n){const e=n.match(/^page:(\d+)/);return e?parseInt(e[1],10):null}function I2(n){const e=n.match(/^page:(\d+):(\d+)-(\d+)$/);return e?{page:parseInt(e[1],10),start:parseInt(e[2],10),end:parseInt(e[3],10)}:null}async function aO(n,e,t,i){if(!e)return[];const s=[];for(const r of e){let a=1;try{if(typeof r.dest=="string"){const l=await n.getDestination(r.dest);l&&l[0]&&(a=await n.getPageIndex(l[0])+1)}else Array.isArray(r.dest)&&r.dest[0]&&(a=await n.getPageIndex(r.dest[0])+1)}catch{}const o=r.items?await aO(n,r.items,t+1,i):void 0;s.push({id:`toc-${i.id++}`,label:r.title,href:`page:${a}`,level:t,children:o&&o.length>0?o:void 0})}return s}function zG(n){const e=RE.find(t=>t.name===n||t.css===n);return e?e.bg:RE[0].bg}function UG(n,e,t){return Math.min(t,Math.max(e,n))}function P2(n,e){n.style.fontFamily=J1[e.font],n.style.lineHeight=String(e.lineHeight)}const HG=E.forwardRef(function({bookId:e,filePath:t,highlights:i,onHighlightClick:s,onHighlightsChange:r,onTocLoaded:a,onProgressChange:o,onLocationChange:l,settings:u,initialLocation:d},f){const p=E.useRef(null),g=E.useRef(null),x=E.useRef(new Map),w=E.useRef(new Map),y=E.useRef(new Map),m=E.useRef(new Map),v=E.useRef(new Map),b=E.useRef(0),A=E.useRef(1),S=E.useRef(!1),C=E.useRef(null),k=E.useRef(i);k.current=i;const[L,D]=E.useState({visible:!1,x:0,y:0,text:"",pageNumber:0,startOffset:0,endOffset:0}),[j,P]=E.useState(1),H=E.useCallback(Z=>{const re=u.fontSize/16;return Z*re*j},[u.fontSize,j]),G=E.useCallback((Z,re)=>{const ne=Z.getViewport({scale:1}),Re=(re-80)/ne.width;return H(Re)},[H]),$=E.useCallback(Z=>{const re=y.current.get(Z);if(!re)return;re.querySelectorAll("mark[data-highlight-id]").forEach(Oe=>Oe.replaceWith(...Oe.childNodes));const ne=k.current.filter(Oe=>{const Ce=Oe.anchorPath?I2(Oe.anchorPath):null;return Ce&&Ce.page===Z});if(ne.length===0)return;const xe=re.querySelectorAll("span");let Re=0;const je=[];xe.forEach(Oe=>{const Ce=Oe.textContent??"";je.push({span:Oe,start:Re,end:Re+Ce.length}),Re+=Ce.length});for(const Oe of ne){const Ce=I2(Oe.anchorPath);if(!Ce)continue;const{start:Fe,end:Ze}=Ce,ye=zG(Oe.color);for(const{span:we,start:He,end:ke}of je){if(Ze<=He||Fe>=ke)continue;const Ae=Math.max(0,Fe-He),it=Math.min(ke-He,Ze-He),nt=we.textContent??"";if(Ae===0&&it===nt.length){const Qe=document.createElement("mark");Qe.dataset.highlightId=Oe.id,Qe.style.backgroundColor=ye,Qe.style.borderRadius="2px",Qe.style.color="transparent",we.replaceChildren(Qe),Qe.textContent=nt}else{const Qe=document.createDocumentFragment();Ae>0&&Qe.appendChild(document.createTextNode(nt.slice(0,Ae)));const Nt=document.createElement("mark");Nt.dataset.highlightId=Oe.id,Nt.style.backgroundColor=ye,Nt.style.borderRadius="2px",Nt.style.color="transparent",Nt.textContent=nt.slice(Ae,it),Qe.appendChild(Nt),it<nt.length&&Qe.appendChild(document.createTextNode(nt.slice(it))),we.replaceChildren(Qe)}}}},[]),Y=E.useCallback(async Z=>{const re=g.current,ne=p.current;if(!re||!ne)return;const xe=m.current.get(Z);if(!(xe!=null&&xe.rendered||xe!=null&&xe.rendering)){m.current.set(Z,{rendered:!1,rendering:!0});try{const Re=await re.getPage(Z),je=ne.clientWidth,Oe=G(Re,je),Ce=window.devicePixelRatio||1,Fe=Re.getViewport({scale:Oe}),Ze=x.current.get(Z),ye=w.current.get(Z),we=y.current.get(Z);if(!Ze||!ye||!we)return;Ze.style.width=`${Fe.width}px`,Ze.style.height=`${Fe.height}px`,ye.width=Fe.width*Ce,ye.height=Fe.height*Ce,ye.style.width=`${Fe.width}px`,ye.style.height=`${Fe.height}px`;const He=ye.getContext("2d");He.setTransform(Ce,0,0,Ce,0,0);const ke=v.current.get(Z);ke&&ke.cancel();const Ae=Re.render({canvas:ye,canvasContext:He,viewport:Fe});v.current.set(Z,Ae),await Ae.promise,we.innerHTML="",we.style.width=`${Fe.width}px`,we.style.height=`${Fe.height}px`,P2(we,u);const it=await Re.getTextContent();await new tg({textContentSource:it,container:we,viewport:Fe}).render(),m.current.set(Z,{rendered:!0,rendering:!1}),v.current.delete(Z),$(Z)}catch(Re){if(Re instanceof hw)return;console.error(`æ¸²æŸ“é¡µé¢ ${Z} å¤±è´¥:`,Re),m.current.set(Z,{rendered:!1,rendering:!1})}}},[G,$,u]),F=E.useCallback(Z=>{const re=v.current.get(Z);re&&(re.cancel(),v.current.delete(Z));const ne=w.current.get(Z);if(ne){const Re=ne.getContext("2d");Re==null||Re.clearRect(0,0,ne.width,ne.height)}const xe=y.current.get(Z);xe&&(xe.innerHTML=""),m.current.set(Z,{rendered:!1,rendering:!1})},[]),M=E.useCallback(()=>{const Z=p.current;if(!Z||b.current===0)return;const{scrollTop:re,scrollHeight:ne,clientHeight:xe}=Z,Re=ne>xe?re/(ne-xe):0;o(Math.min(1,Math.max(0,Re)));let je=1;const Oe=Z.getBoundingClientRect(),Ce=Oe.top+Oe.height/2;for(const[Fe,Ze]of x.current){const ye=Ze.getBoundingClientRect();if(ye.top<=Ce&&ye.bottom>=Ce){je=Fe;break}}A.current!==je&&(A.current=je,l(`page:${je}`))},[o,l]),I=E.useCallback(async Z=>{try{const re=await Z.getOutline();if(!re||re.length===0){a([]);return}const xe=await aO(Z,re,0,{id:0});a(xe)}catch{a([])}},[a]),V=E.useCallback(Z=>{const re=p.current,ne=x.current.get(Z);!re||!ne||ne.scrollIntoView({behavior:"smooth",block:"start"})},[]);E.useImperativeHandle(f,()=>({navigateTo:Z=>{const re=uD(Z);re&&V(re)},navigateToHighlight:Z=>{const re=I2(Z);re&&V(re.page)}}),[V]),E.useEffect(()=>{let Z=!1,re=null;async function ne(){const xe=await window.electronAPI.bookReadFile(e);if(!xe)return;if(re=await m_({data:new Uint8Array(xe)}).promise,Z){re.destroy();return}g.current=re,b.current=re.numPages;const je=p.current;if(!je)return;je.innerHTML="",x.current.clear(),w.current.clear(),y.current.clear(),m.current.clear();for(let Ce=1;Ce<=re.numPages;Ce++){const Fe=document.createElement("div");Fe.className="pdf-page-wrapper",Fe.style.position="relative",Fe.style.margin="0 auto 16px auto",Fe.style.overflow="hidden",Fe.dataset.pageNumber=String(Ce);const Ze=await re.getPage(Ce),ye=je.clientWidth,we=G(Ze,ye),He=Ze.getViewport({scale:we});Fe.style.width=`${He.width}px`,Fe.style.height=`${He.height}px`;const ke=document.createElement("canvas");ke.style.display="block",Fe.appendChild(ke);const Ae=document.createElement("div");Ae.className="pdf-text-layer",P2(Ae,u),Fe.appendChild(Ae);const it=document.createElement("div");it.className="pdf-page-label",it.textContent=String(Ce),Fe.appendChild(it),je.appendChild(Fe),x.current.set(Ce,Fe),w.current.set(Ce,ke),y.current.set(Ce,Ae),m.current.set(Ce,{rendered:!1,rendering:!1})}C.current&&C.current.disconnect();const Oe=new IntersectionObserver(Ce=>{for(const Fe of Ce){const Ze=parseInt(Fe.target.dataset.pageNumber??"0",10);if(Ze!==0)if(Fe.isIntersecting)for(let ye=Math.max(1,Ze-cD);ye<=Math.min(b.current,Ze+cD);ye++)Y(ye);else{const ye=m.current.get(Ze);if(ye!=null&&ye.rendered){const we=x.current.get(Ze);if(we){const He=we.getBoundingClientRect(),ke=je.getBoundingClientRect();Math.abs(He.top-ke.top)>ke.height*3&&F(Ze)}}}}},{root:je,rootMargin:"200% 0px"});C.current=Oe;for(const[,Ce]of x.current)Oe.observe(Ce);if(I(re),d&&!S.current){S.current=!0;const Ce=uD(d);Ce&&requestAnimationFrame(()=>V(Ce))}}return ne(),()=>{Z=!0,C.current&&(C.current.disconnect(),C.current=null);for(const[,xe]of v.current)xe.cancel();v.current.clear(),re&&re.destroy(),g.current=null}},[e,t]),E.useEffect(()=>{if(g.current)for(const[Z]of m.current){const re=m.current.get(Z);re!=null&&re.rendered&&(F(Z),Y(Z))}},[u.fontSize,u.theme,F,Y]),E.useEffect(()=>{for(const[,Z]of y.current)P2(Z,u)},[u.font,u.lineHeight]),E.useEffect(()=>{for(const[Z]of m.current){const re=m.current.get(Z);re!=null&&re.rendered&&$(Z)}},[i,$]),E.useEffect(()=>{const Z=p.current;if(Z)return Z.addEventListener("scroll",M,{passive:!0}),()=>Z.removeEventListener("scroll",M)},[M]);const ie=E.useCallback(Z=>{Z.ctrlKey&&(Z.preventDefault(),P(re=>{const ne=re*Math.exp(-Z.deltaY*FG);return UG(ne,PG,BG)}))},[]);E.useEffect(()=>{const Z=p.current;if(Z)return Z.addEventListener("wheel",ie,{passive:!1}),()=>Z.removeEventListener("wheel",ie)},[ie]);const ge=E.useCallback(()=>{var Ae;const Z=window.getSelection();if(!Z||Z.isCollapsed||!Z.rangeCount)return;const re=Z.getRangeAt(0),ne=Z.toString().trim();if(!ne)return;let xe=null,Re=0,je=re.startContainer;for(;je;){if(je instanceof HTMLElement&&je.classList.contains("pdf-text-layer")){xe=je;const it=je.parentElement;Re=parseInt((it==null?void 0:it.dataset.pageNumber)??"0",10);break}je=je.parentNode}if(!xe||Re===0)return;const Oe=xe.querySelectorAll("span");let Ce=0,Fe=0,Ze=0,ye=!1,we=!1;for(const it of Oe){const nt=it.textContent??"",Qe=document.createTreeWalker(it,NodeFilter.SHOW_TEXT);let Nt,Ve=0;for(;Nt=Qe.nextNode();){const ce=Nt.length;if(!ye&&re.startContainer===Nt&&(Fe=Ce+Ve+re.startOffset,ye=!0),!we&&re.endContainer===Nt&&(Ze=Ce+Ve+re.endOffset,we=!0),Ve+=ce,ye&&we)break}if((!ye||!we)&&(!ye&&re.startContainer===it&&(Fe=Ce,ye=!0),!we&&re.endContainer===it&&(Ze=Ce+nt.length,we=!0)),Ce+=nt.length,ye&&we)break}if(!ye||!we||Fe>=Ze)return;const He=re.getBoundingClientRect(),ke=(Ae=p.current)==null?void 0:Ae.getBoundingClientRect();ke&&D({visible:!0,x:He.left+He.width/2-ke.left,y:He.top-ke.top-8,text:ne,pageNumber:Re,startOffset:Fe,endOffset:Ze})},[]),ee=E.useCallback(async Z=>{var xe;if(!L.text||L.pageNumber===0)return;const re=`page:${L.pageNumber}:${L.startOffset}-${L.endOffset}`,ne=await window.electronAPI.bookHighlightCreate({bookId:e,text:L.text,color:Z,anchorPath:re,startOffset:L.startOffset,endOffset:L.endOffset,paragraphIndex:L.pageNumber});r([...k.current,ne]),D(Re=>({...Re,visible:!1})),(xe=window.getSelection())==null||xe.removeAllRanges()},[L,e,r]),me=E.useCallback(()=>{D(Z=>({...Z,visible:!1}))},[]),oe=E.useCallback(Z=>{const re=Z.target,ne=re==null?void 0:re.closest("mark[data-highlight-id]");if(!ne)return;const xe=ne.dataset.highlightId;xe&&(Z.preventDefault(),Z.stopPropagation(),s==null||s(xe))},[s]);E.useEffect(()=>{if(!L.visible)return;const Z=re=>{re.target.closest(".pdf-highlight-toolbar")||me()};return document.addEventListener("mousedown",Z),()=>document.removeEventListener("mousedown",Z)},[L.visible,me]),E.useEffect(()=>{const Z=p.current;if(!Z)return;const re=ne=>{switch(ne.key){case"PageDown":ne.preventDefault(),Z.scrollBy({top:Z.clientHeight*.9,behavior:"smooth"});break;case"PageUp":ne.preventDefault(),Z.scrollBy({top:-Z.clientHeight*.9,behavior:"smooth"});break;case"ArrowDown":ne.preventDefault(),Z.scrollBy({top:80,behavior:"smooth"});break;case"ArrowUp":ne.preventDefault(),Z.scrollBy({top:-80,behavior:"smooth"});break}};return Z.addEventListener("keydown",re),()=>Z.removeEventListener("keydown",re)},[]);const ae=lD[u.theme]||lD.dark;return h.jsxs("div",{className:"relative w-full h-full",style:{backgroundColor:ae},children:[h.jsx("div",{ref:p,className:"w-full h-full overflow-y-auto outline-none py-4",tabIndex:0,onMouseUp:ge,onClick:oe,style:{backgroundColor:ae}}),L.visible&&h.jsx($G,{x:L.x,y:L.y,containerRef:p,onSelectColor:ee})]})});function $G({x:n,y:e,containerRef:t,onSelectColor:i}){const s=E.useRef(null),[r,a]=E.useState({left:n,top:e});return E.useEffect(()=>{const o=s.current,l=t.current;if(!o||!l)return;const u=o.offsetWidth,d=l.clientWidth;let f=n-u/2;f=Math.max(8,Math.min(f,d-u-8));const p=Math.max(8,e-o.offsetHeight);a({left:f,top:p})},[n,e,t]),h.jsx("div",{ref:s,className:"pdf-highlight-toolbar absolute z-50 flex items-center gap-1 px-2 py-1.5 rounded-lg shadow-xl border border-white/10",style:{left:`${r.left}px`,top:`${r.top}px`,backgroundColor:"rgba(30, 30, 30, 0.95)",backdropFilter:"blur(8px)"},children:RE.map(o=>h.jsx("button",{onClick:()=>i(o.name),className:"w-6 h-6 rounded-full border-2 border-transparent hover:border-white/40 transition-colors cursor-pointer",style:{backgroundColor:o.css},title:o.name},o.name))})}pa.workerSrc=rO;const LE=[{name:"yellow",bg:"rgba(250, 204, 21, 0.4)",css:"#facc15"},{name:"green",bg:"rgba(74, 222, 128, 0.4)",css:"#4ade80"},{name:"blue",bg:"rgba(96, 165, 250, 0.4)",css:"#60a5fa"},{name:"pink",bg:"rgba(244, 114, 182, 0.4)",css:"#f472b6"},{name:"purple",bg:"rgba(192, 132, 252, 0.4)",css:"#c084fc"}],hD={dark:"#1a1a1a",light:"#ffffff",sepia:"#f4ecd8"};function dD(n){const e=n.match(/^page:(\d+)/);return e?parseInt(e[1],10):null}function fD(n){const e=n.match(/^page:(\d+):(\d+)-(\d+)$/);return e?{page:parseInt(e[1],10),start:parseInt(e[2],10),end:parseInt(e[3],10)}:null}function qG(n){const e=LE.find(t=>t.name===n||t.css===n);return e?e.bg:LE[0].bg}function pD(n){const e=n.toUpperCase();return e.includes("BOLD")||e.includes("HEAVY")||e.includes("BLACK")}function gD(n){const e=n.toUpperCase();return e.includes("ITALIC")||e.includes("OBLIQUE")}function VG(n){const e=new Map;for(const s of n){if(!s.str.trim())continue;const r=Math.round(s.height*10)/10;e.set(r,(e.get(r)??0)+s.str.length)}let t=12,i=0;for(const[s,r]of e)r>i&&(i=r,t=s);return t}function GG(n,e,t){if(e<=0)return 0;const i=n/e;return i>=1.8?1:i>=1.4?2:i>=1.15?3:t&&i>=1.05?4:0}async function YG(n){const e=[];try{const t=await n.getOperatorList(),s=n.getViewport({scale:1}).height;for(let r=0;r<t.fnArray.length;r++){if(t.fnArray[r]!==85&&t.fnArray[r]!==82)continue;const a=t.argsArray[r][0];if(a)try{const o=await new Promise((u,d)=>{const f=(p,g)=>{try{p.get(a,x=>{x?u(x):g?f(g):d(new Error("no data"))})}catch{g?f(g):d(new Error("not found"))}};f(n.objs,n.commonObjs)});if(o.width<50||o.height<50)continue;let l=s/2;for(let u=r-1;u>=Math.max(0,r-5);u--)if(t.fnArray[u]===12){const d=t.argsArray[u];d&&d.length>=6&&(l=s-d[5]-Math.abs(d[3]));break}if(o.data){const u=document.createElement("canvas");u.width=o.width,u.height=o.height;const d=u.getContext("2d"),f=new ImageData(new Uint8ClampedArray(o.data),o.width,o.height);d.putImageData(f,0,0);const p=u.toDataURL("image/png");e.push({y:l,dataUrl:p,width:o.width,height:o.height})}}catch{}}}catch{}return e}async function WG(n,e){const t=await n.getPage(e),i=await t.getTextContent(),r=t.getViewport({scale:1}).height,a=[];for(const m of i.items){if(!("str"in m))continue;const v=m,b=r-v.transform[5],A=v.height||Math.abs(v.transform[3]);a.push({str:v.str,height:A,y:b,fontName:v.fontName||""})}if(a.length===0)return{pageNum:e,blocks:[]};const o=VG(a),l=[];for(const m of a){const v=Math.round(m.y),b=l[l.length-1];b&&Math.abs(b.y-v)<3?(b.text+=m.str,m.height>b.fontSize&&(b.fontSize=m.height,b.bold=pD(m.fontName),b.italic=gD(m.fontName))):l.push({y:v,text:m.str,fontSize:m.height,bold:pD(m.fontName),italic:gD(m.fontName)})}const u=await YG(t),d=[];let f="",p=0,g=!1,x=0;const w=()=>{f&&(d.push({type:"paragraph",text:f,offset:p-f.length,bold:g}),f="",g=!1)},y=m=>{for(;x<u.length&&u[x].y<=m;)w(),d.push({type:"image",dataUrl:u[x].dataUrl,width:u[x].width,height:u[x].height}),x++};for(const m of l){const v=m.text.trim();if(v===""){w();continue}y(m.y);const b=GG(m.fontSize,o,m.bold);if(b>0){w(),d.push({type:"heading",level:b,text:v,offset:p}),p+=v.length;continue}f?f+=" "+v:(f=v,g=m.bold),p+=v.length+(f.length>v.length?1:0)}for(w();x<u.length;)d.push({type:"image",dataUrl:u[x].dataUrl,width:u[x].width,height:u[x].height}),x++;return{pageNum:e,blocks:d}}function mD(n){const e=[];let t=0;for(const i of n)for(let s=0;s<i.blocks.length;s++){const r=i.blocks[s];r.type==="heading"&&e.push({id:`heading-${t++}`,label:r.text,href:`page:${i.pageNum}:heading:${s}`,level:r.level-1})}return e}async function oO(n,e,t,i){if(!e)return[];const s=[];for(const r of e){let a=1;try{if(typeof r.dest=="string"){const l=await n.getDestination(r.dest);l&&l[0]&&(a=await n.getPageIndex(l[0])+1)}else Array.isArray(r.dest)&&r.dest[0]&&(a=await n.getPageIndex(r.dest[0])+1)}catch{}const o=r.items?await oO(n,r.items,t+1,i):void 0;s.push({id:`toc-${i.id++}`,label:r.title,href:`page:${a}`,level:t,children:o&&o.length>0?o:void 0})}return s}const XG=E.forwardRef(function({bookId:e,highlights:t,onHighlightClick:i,onHighlightsChange:s,onTocLoaded:r,onProgressChange:a,onLocationChange:o,settings:l,initialLocation:u},d){const f=E.useRef(null),p=E.useRef(null),g=E.useRef(0),x=E.useRef(1),w=E.useRef(!1),y=E.useRef(t);y.current=t;const[m,v]=E.useState([]),[b,A]=E.useState(!0),[S,C]=E.useState({visible:!1,x:0,y:0,text:"",pageNumber:0,startOffset:0,endOffset:0}),k=E.useCallback(M=>{var V;const I=(V=f.current)==null?void 0:V.querySelector(`[data-page="${M}"]`);I&&I.scrollIntoView({behavior:"smooth",block:"start"})},[]),L=E.useCallback(M=>{var V;const I=(V=f.current)==null?void 0:V.querySelector(`[data-heading-id="${M}"]`);I&&I.scrollIntoView({behavior:"smooth",block:"start"})},[]);E.useImperativeHandle(d,()=>({navigateTo:M=>{const I=M.match(/^page:(\d+):heading:(\d+)$/);if(I){const ie=`p${I[1]}-h${I[2]}`;L(ie);return}const V=dD(M);V&&k(V)},navigateToHighlight:M=>{const I=fD(M);I&&k(I.page)}}),[k,L]),E.useEffect(()=>{let M=!1,I=null;async function V(){A(!0);const ie=await window.electronAPI.bookReadFile(e);if(!ie||M)return;if(I=await m_({data:new Uint8Array(ie)}).promise,M){I.destroy();return}p.current=I,g.current=I.numPages;const ee=[];for(let me=1;me<=I.numPages;me++){const oe=await WG(I,me);if(M)return;ee.push(oe)}v(ee),A(!1);try{const me=await I.getOutline();if(me&&me.length>0){const ae=await oO(I,me,0,{id:0});M||r(ae)}else{const oe=mD(ee);M||r(oe)}}catch{const me=mD(ee);M||r(me)}if(u&&!w.current){w.current=!0;const me=dD(u);me&&requestAnimationFrame(()=>k(me))}}return V(),()=>{M=!0,I&&I.destroy(),p.current=null}},[e]);const D=E.useCallback(()=>{const M=f.current;if(!M||g.current===0)return;const{scrollTop:I,scrollHeight:V,clientHeight:ie}=M,ge=V>ie?I/(V-ie):0;a(Math.min(1,Math.max(0,ge)));const ee=M.getBoundingClientRect(),me=ee.top+ee.height/2,oe=M.querySelectorAll("[data-page]");let ae=1;for(const Z of oe){const re=Z.getBoundingClientRect();if(re.top<=me&&re.bottom>=me){ae=parseInt(Z.dataset.page??"1",10);break}}x.current!==ae&&(x.current=ae,o(`page:${ae}`))},[a,o]);E.useEffect(()=>{const M=f.current;if(M)return M.addEventListener("scroll",D,{passive:!0}),()=>M.removeEventListener("scroll",D)},[D]);const j=E.useCallback(()=>{const M=f.current;if(M){M.querySelectorAll("mark[data-highlight-id]").forEach(I=>{const V=I.parentNode;if(V){for(;I.firstChild;)V.insertBefore(I.firstChild,I);V.removeChild(I),V.normalize()}});for(const I of y.current){if(!I.anchorPath)continue;const V=fD(I.anchorPath);if(!V)continue;const ie=M.querySelector(`[data-page="${V.page}"]`);if(!ie)continue;const ge=ie.querySelectorAll("[data-offset]"),ee=qG(I.color);for(const me of ge){const oe=parseInt(me.dataset.offset??"0",10),ae=me.textContent??"",Z=oe+ae.length;if(V.end<=oe||V.start>=Z)continue;const re=Math.max(0,V.start-oe),ne=Math.min(ae.length,V.end-oe);if(re===0&&ne===ae.length){const xe=document.createElement("mark");xe.dataset.highlightId=I.id,xe.style.backgroundColor=ee,xe.style.borderRadius="2px",xe.style.cursor="pointer",xe.textContent=ae,me.replaceChildren(xe)}else{const xe=document.createDocumentFragment();re>0&&xe.appendChild(document.createTextNode(ae.slice(0,re)));const Re=document.createElement("mark");Re.dataset.highlightId=I.id,Re.style.backgroundColor=ee,Re.style.borderRadius="2px",Re.style.cursor="pointer",Re.textContent=ae.slice(re,ne),xe.appendChild(Re),ne<ae.length&&xe.appendChild(document.createTextNode(ae.slice(ne))),me.replaceChildren(xe)}}}}},[]);E.useEffect(()=>{!b&&m.length>0&&requestAnimationFrame(()=>j())},[b,m,t,j]);const P=E.useCallback(()=>{const M=window.getSelection();if(!M||M.isCollapsed||!M.rangeCount)return;const I=M.getRangeAt(0),V=M.toString().trim();if(!V)return;const ie=f.current;if(!ie)return;let ge=null,ee=I.startContainer;for(;ee&&ee!==ie;){if(ee instanceof HTMLElement&&ee.dataset.page){ge=ee;break}ee=ee.parentNode}if(!ge)return;const me=parseInt(ge.dataset.page??"0",10);if(me===0)return;const oe=ge.querySelectorAll("[data-offset]");let ae=0,Z=0,re=!1,ne=!1;for(const je of oe){const Oe=parseInt(je.dataset.offset??"0",10),Ce=document.createTreeWalker(je,NodeFilter.SHOW_TEXT);let Fe,Ze=0;for(;(Fe=Ce.nextNode())&&(!re&&I.startContainer===Fe&&(ae=Oe+Ze+I.startOffset,re=!0),!ne&&I.endContainer===Fe&&(Z=Oe+Ze+I.endOffset,ne=!0),Ze+=Fe.length,!(re&&ne)););if(re&&ne)break}if(!re||!ne||ae>=Z)return;const xe=I.getBoundingClientRect(),Re=ie.getBoundingClientRect();C({visible:!0,x:xe.left+xe.width/2-Re.left,y:xe.top-Re.top-8,text:V,pageNumber:me,startOffset:ae,endOffset:Z})},[]),H=E.useCallback(async M=>{var ie;if(!S.text||S.pageNumber===0)return;const I=`page:${S.pageNumber}:${S.startOffset}-${S.endOffset}`,V=await window.electronAPI.bookHighlightCreate({bookId:e,text:S.text,color:M,anchorPath:I,startOffset:S.startOffset,endOffset:S.endOffset,paragraphIndex:S.pageNumber});s([...y.current,V]),C(ge=>({...ge,visible:!1})),(ie=window.getSelection())==null||ie.removeAllRanges()},[S,e,s]),G=E.useCallback(()=>{C(M=>({...M,visible:!1}))},[]);E.useEffect(()=>{if(!S.visible)return;const M=I=>{I.target.closest(".pdf-highlight-toolbar")||G()};return document.addEventListener("mousedown",M),()=>document.removeEventListener("mousedown",M)},[S.visible,G]);const $=E.useCallback(M=>{const V=M.target.closest("mark[data-highlight-id]");V!=null&&V.dataset.highlightId&&(M.preventDefault(),M.stopPropagation(),i==null||i(V.dataset.highlightId))},[i]),Y=E.useCallback((M,I,V)=>{if(M.type==="image")return h.jsx("figure",{className:"my-4",children:h.jsx("img",{src:M.dataUrl,alt:"",style:{maxWidth:"100%",height:"auto",borderRadius:"8px"}})},`img-${I}-${V}`);if(M.type==="heading"){const ge=`p${I}-h${V}`,ee=`h${M.level}`;return h.jsx(ee,{"data-heading-id":ge,children:h.jsx("span",{"data-offset":M.offset,children:M.text})},`h-${I}-${V}`)}const ie=M.bold?h.jsx("strong",{children:h.jsx("span",{"data-offset":M.offset,children:M.text})}):h.jsx("span",{"data-offset":M.offset,children:M.text});return h.jsx("p",{children:ie},`p-${I}-${V}`)},[]),F=hD[l.theme]||hD.dark;return h.jsxs("div",{className:"relative w-full h-full",style:{backgroundColor:F},children:[h.jsx("div",{ref:f,className:"w-full h-full overflow-y-auto outline-none",style:{backgroundColor:F},onMouseUp:P,onClick:$,tabIndex:0,children:b?h.jsx("div",{className:"flex items-center justify-center h-full",children:h.jsx("span",{className:"text-sm text-gray-500",children:"æ­£åœ¨æå–æ–‡æœ¬â€¦"})}):h.jsx("div",{className:"mx-auto max-w-[680px] px-8 py-10 article-content",style:{fontFamily:J1[l.font],fontSize:`${l.fontSize}px`,lineHeight:l.lineHeight},children:m.map(M=>h.jsxs("div",{"data-page":M.pageNum,children:[M.pageNum>1&&h.jsxs("div",{className:"flex items-center gap-3 my-8 select-none",children:[h.jsx("div",{className:"flex-1 border-t border-current opacity-10"}),h.jsxs("span",{className:"text-[11px] opacity-30",children:["Page ",M.pageNum]}),h.jsx("div",{className:"flex-1 border-t border-current opacity-10"})]}),M.blocks.map((I,V)=>Y(I,M.pageNum,V))]},M.pageNum))})}),S.visible&&h.jsx("div",{className:"pdf-highlight-toolbar absolute z-50 flex items-center gap-1 px-2 py-1.5 rounded-lg shadow-xl border border-white/10",style:{left:`${S.x}px`,top:`${S.y}px`,transform:"translate(-50%, -100%)",backgroundColor:"rgba(30, 30, 30, 0.95)",backdropFilter:"blur(8px)"},children:LE.map(M=>h.jsx("button",{onClick:()=>H(M.name),className:"w-6 h-6 rounded-full border-2 border-transparent hover:border-white/40 transition-colors cursor-pointer",style:{backgroundColor:M.css},title:M.name},M.name))})]})});function KG({bookId:n,onClose:e}){const[t,i]=E.useState(null),[s,r]=E.useState(!0),[a,o]=E.useState([]),[l,u]=E.useState([]),[d,f]=E.useState(()=>localStorage.getItem("book-reader-toc-collapsed")==="true"),[p,g]=E.useState(()=>localStorage.getItem("book-reader-detail-collapsed")==="true"),[x,w]=E.useState(!1),[y,m]=E.useState(()=>localStorage.getItem("z-reader-pdf-view-mode")||"pdf"),[v,b]=E.useState(OH),[A,S]=E.useState(0),[C,k]=E.useState("info"),[L,D]=E.useState(null),[j,P]=E.useState(0),H=E.useRef(null);E.useEffect(()=>{let V=!1;async function ie(){r(!0);try{const ge=await window.electronAPI.bookGet(n);if(V)return;i(ge),ge&&S(ge.readProgress??0)}catch{}finally{V||r(!1)}}return ie(),()=>{V=!0}},[n]);const G=E.useCallback(V=>{var ie;(ie=H.current)==null||ie.navigateTo(V.href)},[]),$=E.useCallback(V=>{var ge;const ie=a.find(ee=>ee.id===V);ie!=null&&ie.anchorPath&&((ge=H.current)==null||ge.navigateToHighlight(ie.anchorPath)),p&&(g(!1),localStorage.setItem("book-reader-detail-collapsed","false")),k("notebook"),D(V),P(ee=>ee+1)},[a,p]);E.useEffect(()=>{let V=!1;return window.electronAPI.bookHighlightList(n).then(ie=>{V||o(ie)}),()=>{V=!0}},[n]),E.useEffect(()=>{const V=ie=>{const ee=ie.detail;!ee||ee.bookId!==n||$(ee.highlightId)};return window.addEventListener("book-reader:highlight-click",V),()=>window.removeEventListener("book-reader:highlight-click",V)},[n,$]);const Y=E.useCallback(async V=>{await window.electronAPI.highlightDelete(V),o(ie=>ie.filter(ge=>ge.id!==V))},[]),F=E.useCallback(V=>{S(V),window.electronAPI.bookUpdate({id:n,readProgress:V})},[n]),M=E.useCallback(V=>{window.electronAPI.bookUpdate({id:n,currentLocation:V})},[n]),I=v.theme==="light"?"reader-theme-light":v.theme==="sepia"?"reader-theme-sepia":"reader-theme-dark";return h.jsxs("div",{className:`flex flex-1 h-full overflow-hidden ${I}`,children:[h.jsxs("div",{className:`shrink-0 flex flex-col border-r border-[#262626] bg-[#141414] transition-all duration-200 overflow-hidden ${d?"w-0 border-r-0":"w-[220px]"}`,children:[h.jsxs("div",{className:"shrink-0 flex items-center justify-between px-4 h-12 border-b border-[#262626]",children:[h.jsx("button",{onClick:e,className:"p-1.5 rounded hover:bg-white/10 transition-colors cursor-pointer text-gray-400 hover:text-white",title:"è¿”å›žåˆ—è¡¨",children:h.jsx(V1,{className:"w-4 h-4"})}),h.jsx("h2",{className:"text-[13px] font-semibold text-white tracking-wide",children:"Contents"}),h.jsx("div",{className:"w-6"})]}),h.jsx(TH,{items:l,onNavigate:G,loading:s})]}),h.jsxs("div",{className:"relative flex-1 flex flex-col overflow-hidden",children:[h.jsxs("div",{className:"shrink-0 flex items-center justify-between px-6 h-12 border-b border-[#262626]",children:[h.jsxs("div",{className:"flex items-center gap-1.5 text-[12px] min-w-0 truncate",children:[h.jsx("button",{onClick:()=>f(V=>{const ie=!V;return localStorage.setItem("book-reader-toc-collapsed",String(ie)),ie}),className:"p-1 rounded hover:bg-white/10 transition-colors cursor-pointer text-gray-400 hover:text-white shrink-0",title:d?"å±•å¼€ç›®å½•":"æ”¶èµ·ç›®å½•",children:d?h.jsx(Qj,{className:"w-4 h-4"}):h.jsx(BC,{className:"w-4 h-4"})}),h.jsx("span",{className:"text-gray-400 truncate",children:(t==null?void 0:t.title)??"åŠ è½½ä¸­â€¦"})]}),h.jsxs("div",{className:"flex items-center gap-1",children:[(t==null?void 0:t.fileType)==="pdf"&&h.jsx("button",{onClick:()=>{const V=y==="pdf"?"text":"pdf";m(V),localStorage.setItem("z-reader-pdf-view-mode",V)},className:"p-1.5 rounded hover:bg-white/10 transition-colors cursor-pointer text-gray-400 hover:text-white",title:y==="pdf"?"åˆ‡æ¢åˆ°æ–‡æœ¬è§†å›¾":"åˆ‡æ¢åˆ° PDF è§†å›¾",children:y==="pdf"?h.jsx(xl,{className:"w-4 h-4"}):h.jsx(Ja,{className:"w-4 h-4"})}),h.jsx("button",{onClick:()=>w(!x),className:"p-1.5 rounded hover:bg-white/10 transition-colors cursor-pointer text-gray-400 hover:text-white",title:"æŽ’ç‰ˆè®¾ç½®",children:h.jsx(Db,{className:"w-4 h-4"})}),h.jsx("button",{onClick:()=>g(V=>{const ie=!V;return localStorage.setItem("book-reader-detail-collapsed",String(ie)),ie}),className:"p-1.5 rounded hover:bg-white/10 transition-colors cursor-pointer text-gray-400 hover:text-white",title:p?"å±•å¼€è¯¦æƒ…":"æ”¶èµ·è¯¦æƒ…",children:p?h.jsx(K1,{className:"w-4 h-4"}):h.jsx(X1,{className:"w-4 h-4"})})]})]}),h.jsx(PH,{open:x,onClose:()=>w(!1),settings:v,onSettingsChange:b}),h.jsx("div",{className:"shrink-0 h-[2px] bg-white/5",children:h.jsx("div",{className:"h-full bg-blue-500 transition-[width] duration-300",style:{width:`${Math.round(A*100)}%`}})}),h.jsx("div",{className:"flex-1 overflow-hidden",children:s?h.jsxs("div",{className:"flex flex-col items-center justify-center h-full gap-3",children:[h.jsx(xt,{className:"w-6 h-6 text-gray-500 animate-spin"}),h.jsx("span",{className:"text-sm text-gray-500",children:"åŠ è½½ä¸­â€¦"})]}):t?t.fileType==="pdf"&&y==="text"?h.jsx(XG,{ref:H,bookId:n,filePath:t.filePath,highlights:a,onHighlightClick:$,onHighlightsChange:o,onTocLoaded:u,onProgressChange:F,onLocationChange:M,settings:v,initialLocation:t.currentLocation}):t.fileType==="pdf"?h.jsx(HG,{ref:H,bookId:n,filePath:t.filePath,highlights:a,onHighlightClick:$,onHighlightsChange:o,onTocLoaded:u,onProgressChange:F,onLocationChange:M,settings:v,initialLocation:t.currentLocation}):h.jsx(Fq,{ref:H,bookId:n,filePath:t.filePath,highlights:a,onHighlightsChange:o,onTocLoaded:u,onProgressChange:F,onLocationChange:M,settings:v,initialLocation:t.currentLocation}):h.jsx("div",{className:"flex items-center justify-center h-full text-sm text-gray-500",children:"ä¹¦ç±ä¸å­˜åœ¨"})})]}),h.jsx("div",{className:`shrink-0 h-full overflow-hidden ${p?"w-0":""}`,children:h.jsx(jH,{book:t,readProgress:A,highlights:a,activeTab:C,onTabChange:k,focusedHighlightId:L,focusSignal:j,onHighlightsChange:o,onDeleteHighlight:Y,onHighlightClick:$})})]})}const ZG=E.forwardRef(function({videoId:e,onTimeUpdate:t,onReady:i,onDuration:s},r){const a=E.useRef(null),o=E.useRef(null),l=E.useRef(null),[u,d]=E.useState([]),[f,p]=E.useState(null),[g,x]=E.useState(null),[w,y]=E.useState(!1),[m,v]=E.useState(!0),[b,A]=E.useState(null),[S,C]=E.useState(!1),[k,L]=E.useState(!1),D=g!=null&&!g.hasAudio;E.useImperativeHandle(r,()=>({seekTo:F=>{a.current&&(a.current.currentTime=F),D&&o.current&&(o.current.currentTime=F)}}),[D]);const j=E.useCallback(async()=>{v(!0),A(null),d([]),p(null),x(null),C(!1);try{const F=await window.electronAPI.youtubeGetStreamUrl(e);if(F&&F.formats.length>0){d(F.formats),p(F.bestAudio);const M=F.formats.find(I=>I.hasAudio)??F.formats[0];x(M)}else await window.electronAPI.youtubeAuthStatus()?A("æ— æ³•èŽ·å–è§†é¢‘æµï¼Œè¯·ç¨åŽé‡è¯•"):C(!0)}catch{A("èŽ·å–è§†é¢‘æµå¤±è´¥")}v(!1)},[e]);E.useEffect(()=>{let F=!1;return(async()=>await j())(),()=>{F=!0}},[j]);const P=E.useCallback(async()=>{L(!0);try{await window.electronAPI.youtubeLogin()&&await j()}catch{A("ç™»å½•å¤±è´¥")}L(!1)},[j]);E.useEffect(()=>{const F=a.current,M=o.current;if(!F||!M||!D)return;const I=()=>{M.play().catch(()=>{})},V=()=>{M.pause()},ie=()=>{M.currentTime=F.currentTime};return F.addEventListener("play",I),F.addEventListener("pause",V),F.addEventListener("seeked",ie),()=>{F.removeEventListener("play",I),F.removeEventListener("pause",V),F.removeEventListener("seeked",ie)}},[D,g]),E.useEffect(()=>{if(!D){l.current&&(clearInterval(l.current),l.current=null);return}return l.current=setInterval(()=>{const F=a.current,M=o.current;if(!F||!M)return;Math.abs(F.currentTime-M.currentTime)>.3&&(M.currentTime=F.currentTime)},3e3),()=>{l.current&&(clearInterval(l.current),l.current=null)}},[D]);const H=E.useCallback(F=>{const M=a.current,I=(M==null?void 0:M.currentTime)??0,V=M?!M.paused:!1;x(F),y(!1),requestAnimationFrame(()=>{const ie=a.current;if(ie){const ee=()=>{ie.currentTime=I,V&&ie.play().catch(()=>{}),ie.removeEventListener("canplay",ee)};ie.addEventListener("canplay",ee)}const ge=o.current;if(ge&&!F.hasAudio){const ee=()=>{ge.currentTime=I,ge.removeEventListener("canplay",ee)};ge.addEventListener("canplay",ee)}})},[]),G=E.useCallback(()=>{const F=a.current;F&&(i==null||i(),F.duration&&F.duration>0&&(s==null||s(F.duration)))},[i,s]),$=E.useCallback(()=>{const F=a.current;F&&(t==null||t(F.currentTime))},[t]),Y=E.useCallback(()=>{const F=a.current;F&&F.duration&&F.duration>0&&(s==null||s(F.duration))},[s]);return E.useEffect(()=>{if(!w)return;const F=()=>y(!1),M=requestAnimationFrame(()=>{document.addEventListener("click",F)});return()=>{cancelAnimationFrame(M),document.removeEventListener("click",F)}},[w]),m?h.jsx("div",{className:"relative w-full bg-black rounded-lg flex items-center justify-center",style:{paddingBottom:"56.25%"},children:h.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:h.jsx("div",{className:"text-zinc-400 text-sm",children:"åŠ è½½è§†é¢‘ä¸­..."})})}):S?h.jsx("div",{className:"relative w-full bg-black rounded-lg flex items-center justify-center",style:{paddingBottom:"56.25%"},children:h.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center gap-3",children:[h.jsx("div",{className:"text-zinc-400 text-sm",children:"éœ€è¦ç™»å½• YouTube æ‰èƒ½æ’­æ”¾è§†é¢‘"}),h.jsx("button",{onClick:P,disabled:k,className:"px-4 py-2 bg-red-600 hover:bg-red-700 disabled:bg-zinc-600 text-white text-sm rounded-md transition-colors",children:k?"ç™»å½•ä¸­...":"ç™»å½• YouTube"})]})}):b||!g?h.jsx("div",{className:"relative w-full bg-black rounded-lg flex items-center justify-center",style:{paddingBottom:"56.25%"},children:h.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center gap-3",children:[h.jsx("div",{className:"text-zinc-400 text-sm",children:b??"è§†é¢‘ä¸å¯ç”¨"}),h.jsx("button",{onClick:P,disabled:k,className:"px-3 py-1.5 bg-zinc-700 hover:bg-zinc-600 disabled:bg-zinc-800 text-zinc-300 text-xs rounded transition-colors",children:k?"ç™»å½•ä¸­...":"é‡æ–°ç™»å½• YouTube"})]})}):h.jsxs("div",{className:"relative w-full group",style:{paddingBottom:"56.25%"},children:[h.jsx("video",{ref:a,src:g.url,className:"absolute inset-0 w-full h-full rounded-lg bg-black",controls:!0,onLoadedMetadata:G,onTimeUpdate:$,onDurationChange:Y}),D&&f&&h.jsx("audio",{ref:o,src:f.url,preload:"auto"}),u.length>1&&h.jsxs("div",{className:"absolute bottom-12 right-3 z-10",children:[w&&h.jsx("div",{className:"mb-1 bg-black/90 rounded-md py-1 min-w-[100px] shadow-lg",onClick:F=>F.stopPropagation(),children:u.map(F=>h.jsx("button",{onClick:()=>H(F),className:`w-full px-3 py-1.5 text-left text-xs transition-colors ${F.itag===g.itag?"text-blue-400 bg-white/10":"text-white hover:bg-white/10"}`,children:F.qualityLabel},F.itag))}),h.jsx("button",{onClick:F=>{F.stopPropagation(),y(M=>!M)},className:"px-2 py-1 bg-black/70 hover:bg-black/90 text-white text-xs rounded transition-colors opacity-0 group-hover:opacity-100",children:g.qualityLabel})]})]})});function QG(n){if(!(n!=null&&n.startsWith("transcript:")))return null;const t=n.slice(11).split("-");if(t.length!==2)return null;const i=parseInt(t[0],10),s=parseInt(t[1],10);return isNaN(i)||isNaN(s)?null:{startSegIdx:i,endSegIdx:s}}function JG(n,e,t){const i=[];for(const a of t){const o=QG(a.anchorPath);if(!o)continue;const{startSegIdx:l,endSegIdx:u}=o;if(n<l||n>u)continue;let d=0,f=e.length;n===l&&(d=a.startOffset??0),n===u&&(f=a.endOffset??e.length),d=Math.max(0,Math.min(d,e.length)),f=Math.max(d,Math.min(f,e.length)),d<f&&i.push({start:d,end:f,highlightId:a.id,color:a.color})}if(i.length===0)return[{text:e,highlightId:null,color:""}];i.sort((a,o)=>a.start-o.start||a.end-o.end);const s=[];let r=0;for(const a of i){r<a.start&&s.push({text:e.slice(r,a.start),highlightId:null,color:""});const o=Math.max(r,a.start);o<a.end&&s.push({text:e.slice(o,a.end),highlightId:a.highlightId,color:a.color}),r=Math.max(r,a.end)}return r<e.length&&s.push({text:e.slice(r),highlightId:null,color:""}),s}function eY(n){const e=Math.floor(n/60),t=Math.floor(n%60);return`${e}:${String(t).padStart(2,"0")}`}const yD="rgba(251,191,36,0.25)",tY="rgba(251,191,36,0.40)";function lO({segments:n,currentTime:e,onSegmentClick:t,loading:i,highlights:s=[],onCreateHighlight:r,onDeleteHighlight:a,onUpdateHighlight:o,highlightTagsMap:l={},scrollToSegment:u}){const[d,f]=E.useState(!0),p=E.useRef(null),g=E.useRef(new Map),x=E.useRef(!1),w=E.useRef(null),y=E.useRef(null),m=E.useRef(null),[v,b]=E.useState(null),[A,S]=E.useState(null),[C,k]=E.useState(null),L=E.useMemo(()=>s.filter(M=>{var I;return(I=M.anchorPath)==null?void 0:I.startsWith("transcript:")}),[s]),D=E.useMemo(()=>{for(let M=n.length-1;M>=0;M--)if(e>=n[M].start)return M;return-1},[n,e]);E.useEffect(()=>{if(!d||D<0)return;const M=g.current.get(D);M&&M.scrollIntoView({behavior:"smooth",block:"center"})},[d,D]),E.useEffect(()=>{if(u==null||u<0)return;const M=g.current.get(u);M&&(f(!1),M.scrollIntoView({behavior:"smooth",block:"center"}),M.classList.add("highlight-flash"),setTimeout(()=>M.classList.remove("highlight-flash"),1500))},[u]);const j=E.useCallback(()=>{d&&(f(!1),x.current=!0),w.current&&clearTimeout(w.current),w.current=setTimeout(()=>{x.current=!1},150)},[d]),P=E.useCallback(()=>{f(!0)},[]),H=E.useCallback(M=>{t(M)},[t]),G=E.useCallback((M,I)=>{I?g.current.set(M,I):g.current.delete(M)},[]),$=E.useCallback(M=>{setTimeout(()=>{const I=window.getSelection();if(!m.current)return;if(I&&!I.isCollapsed){if(!I.toString().trim()||!m.current.contains(I.anchorNode)||!m.current.contains(I.focusNode))return;const me=I.getRangeAt(0).getBoundingClientRect();b({mode:"selection",x:me.left+me.width/2,y:me.top-10});return}const ie=M.target.closest("mark[data-highlight-id]");if(ie){const ge=ie.dataset.highlightId;if(ge){const ee=ie.getBoundingClientRect();b({mode:"highlight",highlightId:ge,x:ee.left+ee.width/2,y:ee.top-10})}return}b(null)},10)},[]),Y=E.useCallback(()=>{const M=window.getSelection();if(!M||M.isCollapsed||!m.current||!r)return;const I=M.toString().trim();if(!I)return;const V=Oe=>{var Fe;let Ce=Oe.nodeType===Node.TEXT_NODE?Oe.parentElement:Oe;for(;Ce&&Ce!==m.current;){if(((Fe=Ce.dataset)==null?void 0:Fe.segIdx)!=null)return parseInt(Ce.dataset.segIdx,10);Ce=Ce.parentElement}return-1},ie=V(M.anchorNode),ge=V(M.focusNode);if(ie<0||ge<0)return;let ee=Math.min(ie,ge),me=Math.max(ie,ge);const oe=M.getRangeAt(0),ae=m.current.querySelector(`[data-seg-idx="${ee}"]`),Z=m.current.querySelector(`[data-seg-idx="${me}"]`);if(!ae||!Z)return;const re=(Oe,Ce,Fe)=>{const Ze=document.createRange();return Ze.setStart(Oe,0),Ze.setEnd(Ce,Fe),Ze.toString().length};let ne,xe;ne=re(ae,oe.startContainer,oe.startOffset),xe=re(Z,oe.endContainer,oe.endOffset);const Re=`transcript:${ee}-${me}`;L.some(Oe=>Oe.anchorPath===Re&&Oe.startOffset===ne&&Oe.endOffset===xe)||(r({text:I,paragraphIndex:ee,startOffset:ne,endOffset:xe,anchorPath:Re}),M.removeAllRanges(),b(null))},[r,L]),F=E.useCallback(M=>{a==null||a(M),b(null)},[a]);return E.useEffect(()=>{const M=I=>{var ie;if((ie=y.current)!=null&&ie.contains(I.target))return;const V=I.target;V.closest("mark[data-highlight-id]")||V.closest(".transcript-note-editor, .transcript-tag-picker")||(b(null),S(null),k(null))};return document.addEventListener("mousedown",M),()=>document.removeEventListener("mousedown",M)},[]),i?h.jsxs("div",{className:"flex items-center justify-center py-12",children:[h.jsx(xt,{size:20,className:"animate-spin text-gray-500"}),h.jsx("span",{className:"ml-2 text-sm text-gray-500",children:"åŠ è½½å­—å¹•ä¸­..."})]}):n.length===0?h.jsx("div",{className:"flex items-center justify-center py-12",children:h.jsx("span",{className:"text-sm text-gray-500",children:"æš‚æ— å­—å¹•"})}):h.jsxs("div",{className:"relative flex flex-col h-full",ref:m,children:[h.jsx("div",{ref:p,className:"flex-1 overflow-y-auto px-6 py-4",onWheel:j,onMouseUp:$,children:n.map((M,I)=>{const V=I===D,ie=I<D,ge=JG(I,M.text,L);return h.jsxs("div",{ref:ee=>G(I,ee),className:`
                flex gap-3 py-2 px-3 rounded-md cursor-pointer transition-colors duration-200
                hover:bg-white/5
                ${V?"bg-blue-500/10":""}
              `,children:[h.jsx("div",{className:"flex flex-col items-center shrink-0 w-1 mt-1",children:h.jsx("div",{className:`
                    w-[2px] h-full rounded-full transition-colors duration-200
                    ${V?"bg-blue-500 animate-pulse":ie?"bg-blue-500":"bg-gray-700"}
                  `})}),h.jsx("span",{className:`
                  text-[11px] font-mono shrink-0 w-10 pt-0.5
                  ${V?"text-blue-400":"text-gray-600"}
                `,onClick:ee=>{ee.stopPropagation(),H(M.start)},children:eY(M.start)}),h.jsx("span",{"data-seg-idx":I,className:`
                  text-[14px] leading-relaxed flex-1 select-text
                  ${V?"text-white font-medium":ie?"text-gray-400":"text-gray-300"}
                `,onClick:ee=>{const me=window.getSelection();me&&!me.isCollapsed||ee.target.closest("mark[data-highlight-id]")||H(M.start)},children:ge.map((ee,me)=>ee.highlightId?h.jsx("mark",{"data-highlight-id":ee.highlightId,className:"rounded-sm cursor-pointer transition-colors",style:{backgroundColor:yD,color:"inherit",padding:"1px 0"},onMouseEnter:oe=>{oe.currentTarget.style.backgroundColor=tY},onMouseLeave:oe=>{oe.currentTarget.style.backgroundColor=yD},children:ee.text},me):h.jsx("span",{children:ee.text},me))})]},I)})}),!d&&h.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 z-10",children:h.jsxs("button",{onClick:P,className:"flex items-center gap-2 px-4 py-2 bg-[#1a1a1a] border border-white/10 rounded-full shadow-lg text-sm text-gray-300 hover:text-white hover:border-white/20 transition-colors cursor-pointer",children:[h.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500 animate-pulse"}),"è‡ªç”±æµè§ˆæ¨¡å¼ Â· ç‚¹å‡»å›žåˆ°å­—å¹•åŒæ­¥"]})}),v&&h.jsx("div",{ref:y,className:"fixed z-[9999] flex items-center gap-0.5 px-1.5 py-1 bg-[#2a2a2a] rounded-full shadow-xl border border-white/10",style:{left:v.x,top:v.y,transform:"translate(-50%, -100%)"},children:v.mode==="selection"?h.jsx("button",{onClick:Y,className:"w-7 h-7 flex items-center justify-center rounded-full bg-amber-500/20 hover:bg-amber-500/30 transition-colors cursor-pointer",title:"é«˜äº®",children:h.jsx(av,{className:"w-3.5 h-3.5 text-amber-400"})}):h.jsxs(h.Fragment,{children:[h.jsx("button",{onClick:()=>v.highlightId&&F(v.highlightId),className:"w-7 h-7 flex items-center justify-center rounded-full bg-[#4a3a1a] hover:bg-[#5a4520] transition-colors cursor-pointer",title:"åˆ é™¤é«˜äº®",children:h.jsx(Fn,{className:"w-3.5 h-3.5 text-amber-400"})}),h.jsx("button",{onClick:()=>{if(v.highlightId){const M=L.find(I=>I.id===v.highlightId);S({highlightId:v.highlightId,text:(M==null?void 0:M.note)||""}),b(null)}},className:"w-7 h-7 flex items-center justify-center rounded-full hover:bg-white/10 transition-colors cursor-pointer text-gray-400 hover:text-white",title:"æ·»åŠ ç¬”è®°",children:h.jsx(Zj,{className:"w-3.5 h-3.5"})}),h.jsx("button",{onClick:()=>{v.highlightId&&(k(v.highlightId),b(null))},className:"w-7 h-7 flex items-center justify-center rounded-full hover:bg-white/10 transition-colors cursor-pointer text-gray-400 hover:text-white",title:"æ·»åŠ æ ‡ç­¾",children:h.jsx(Z1,{className:"w-3.5 h-3.5"})})]})}),A&&h.jsxs("div",{className:"transcript-note-editor absolute z-[9999] bg-[#2a2a2a] rounded-lg shadow-xl border border-white/10 p-3 w-[280px]",style:{left:"50%",top:"50%",transform:"translate(-50%, -50%)"},children:[h.jsx("textarea",{autoFocus:!0,value:A.text,onChange:M=>S({...A,text:M.target.value}),onKeyDown:M=>{M.key==="Enter"&&!M.shiftKey&&(M.preventDefault(),o==null||o(A.highlightId,A.text),S(null)),M.key==="Escape"&&S(null)},className:"w-full text-[13px] text-gray-300 bg-white/5 border border-white/10 rounded px-2 py-1.5 resize-none outline-none focus:border-blue-500/50",rows:3,placeholder:"æ·»åŠ ç¬”è®°â€¦"}),h.jsxs("div",{className:"flex justify-end gap-2 mt-2",children:[h.jsx("button",{onClick:()=>S(null),className:"px-2 py-1 text-xs text-gray-400 hover:text-white transition-colors cursor-pointer",children:"å–æ¶ˆ"}),h.jsx("button",{onClick:()=>{o==null||o(A.highlightId,A.text),S(null)},className:"px-2 py-1 text-xs text-blue-400 hover:text-blue-300 transition-colors cursor-pointer",children:"ä¿å­˜"})]})]}),C&&h.jsxs("div",{className:"transcript-tag-picker absolute z-[9999] bg-[#2a2a2a] rounded-lg shadow-xl border border-white/10 p-3 w-[280px]",style:{left:"50%",top:"50%",transform:"translate(-50%, -50%)"},children:[h.jsxs("div",{className:"flex items-center justify-between mb-2",children:[h.jsx("span",{className:"text-xs font-medium text-gray-400",children:"é«˜äº®æ ‡ç­¾"}),h.jsx("button",{onClick:()=>k(null),className:"p-0.5 rounded hover:bg-white/10 text-gray-500 hover:text-white transition-colors cursor-pointer",children:h.jsx(Fn,{className:"w-3 h-3"})})]}),h.jsx(iY,{highlightId:C,currentTags:l[C]||[],onClose:()=>k(null)})]}),h.jsx("style",{children:`
        .highlight-flash {
          animation: transcript-flash 1.5s ease;
        }
        @keyframes transcript-flash {
          0%, 100% { background-color: transparent; }
          25% { background-color: rgba(59,130,246,0.2); }
          50% { background-color: transparent; }
          75% { background-color: rgba(59,130,246,0.15); }
        }
      `})]})}function iY({highlightId:n,currentTags:e,onClose:t}){const[i,s]=E.useState([]),[r,a]=E.useState(()=>new Set(e.map(l=>l.id)));E.useEffect(()=>{window.electronAPI.tagList().then(s)},[]);const o=async l=>{r.has(l)?(await window.electronAPI.highlightTagRemove(n,l),a(u=>{const d=new Set(u);return d.delete(l),d})):(await window.electronAPI.highlightTagAdd(n,l),a(u=>new Set(u).add(l)))};return h.jsxs("div",{className:"flex flex-col gap-1 max-h-[200px] overflow-y-auto",children:[i.map(l=>h.jsx("button",{onClick:()=>o(l.id),className:`
            text-left px-2 py-1 rounded text-xs transition-colors cursor-pointer
            ${r.has(l.id)?"bg-blue-500/20 text-blue-400":"text-gray-400 hover:bg-white/5 hover:text-gray-300"}
          `,children:l.name},l.id)),i.length===0&&h.jsx("span",{className:"text-[11px] text-gray-600 px-2 py-1",children:"æš‚æ— æ ‡ç­¾"})]})}function nY(n){if(!(n!=null&&n.startsWith("transcript:")))return null;const e=n.slice(11).split("-"),t=parseInt(e[0],10);return isNaN(t)?null:t}function sY({articleId:n,onClose:e}){const[t,i]=E.useState(null),[s,r]=E.useState(!0),[a,o]=E.useState([]),[l,u]=E.useState(!1),[d,f]=E.useState(0),[p,g]=E.useState(()=>localStorage.getItem("video-reader-detail-collapsed")==="true"),[x,w]=E.useState([]),[y,m]=E.useState({}),[v,b]=E.useState(null),A=E.useRef(0),S=E.useRef(null),C=E.useRef(null),k=E.useRef(0);E.useEffect(()=>{let I=!1;return r(!0),window.electronAPI.articleGet(n).then(V=>{!I&&V&&(i(V),V.duration&&(k.current=V.duration),r(!1))}).catch(()=>{I||r(!1)}),()=>{I=!0}},[n]),E.useEffect(()=>{if(!(t!=null&&t.videoId))return;let I=!1;return u(!0),window.electronAPI.transcriptFetch(n).then(V=>{!I&&V&&o(V.segments)}).catch(V=>{console.error("åŠ è½½å­—å¹•å¤±è´¥:",V)}).finally(()=>{I||u(!1)}),()=>{I=!0}},[n,t==null?void 0:t.videoId]),E.useEffect(()=>{let I=!1;return window.electronAPI.highlightList(n).then(V=>{if(!I&&(w(V),V.length>0)){const ie=V.map(ge=>ge.id);window.electronAPI.highlightTagsBatch(ie).then(ge=>{I||m(ge)})}}),()=>{I=!0}},[n]);const L=E.useCallback(async I=>{const V=await window.electronAPI.highlightCreate({articleId:n,text:I.text,color:"yellow",paragraphIndex:I.paragraphIndex,startOffset:I.startOffset,endOffset:I.endOffset,anchorPath:I.anchorPath});w(ie=>[...ie,V])},[n]),D=E.useCallback(async I=>{await window.electronAPI.highlightDelete(I),w(V=>V.filter(ie=>ie.id!==I)),m(V=>{const ie={...V};return delete ie[I],ie})},[]),j=E.useCallback(async(I,V)=>{const ie=await window.electronAPI.highlightUpdate({id:I,note:V});w(ge=>ge.map(ee=>ee.id===I?ie:ee))},[]),P=E.useCallback(I=>{const V=x.find(ge=>ge.id===I);if(!V)return;const ie=nY(V.anchorPath);ie!=null&&(A.current+=1,b(ie+A.current*.001))},[x]),H=E.useCallback(I=>{f(I),!C.current&&(C.current=setTimeout(()=>{C.current=null;const V=k.current;if(V>0){const ie=Math.min(I/V,1);window.electronAPI.articleUpdate({id:n,readProgress:ie}).catch(console.error)}},1e4))},[n]),G=E.useCallback(I=>{k.current=I,t&&!t.duration&&i(V=>V&&{...V,duration:I})},[t]),$=E.useCallback(I=>{var V;(V=S.current)==null||V.seekTo(I)},[]),Y=E.useCallback(()=>{const I=k.current;if(I>0&&d>0){const V=Math.min(d/I,1);window.electronAPI.articleUpdate({id:n,readProgress:V}).catch(console.error)}C.current&&clearTimeout(C.current),e()},[n,d,e]),F=E.useCallback(()=>{g(I=>{const V=!I;return localStorage.setItem("video-reader-detail-collapsed",String(V)),V})},[]);if(E.useEffect(()=>{const I=V=>{V.key==="Escape"&&(V.preventDefault(),Y())};return document.addEventListener("keydown",I),()=>document.removeEventListener("keydown",I)},[Y]),s||!t)return h.jsx("div",{className:"flex items-center justify-center h-full bg-[#0f0f0f]",children:h.jsx(xt,{size:24,className:"animate-spin text-gray-500"})});const M=v!=null?Math.floor(v):null;return h.jsxs("div",{className:"flex flex-col h-full bg-[#0f0f0f]",children:[h.jsxs("div",{className:"flex items-center gap-3 px-4 py-2 border-b border-[#262626] shrink-0",children:[h.jsx("button",{onClick:Y,className:"p-1.5 rounded-md hover:bg-white/10 text-gray-400 hover:text-white transition-colors cursor-pointer",title:"è¿”å›ž",children:h.jsx(V1,{size:18})}),h.jsx("h1",{className:"text-sm font-medium text-gray-200 truncate flex-1",children:t.title}),h.jsx("button",{onClick:F,className:"p-1.5 rounded-md hover:bg-white/10 text-gray-400 hover:text-white transition-colors cursor-pointer",title:p?"æ˜¾ç¤ºè¯¦æƒ…é¢æ¿":"éšè—è¯¦æƒ…é¢æ¿",children:p?h.jsx(K1,{size:18}):h.jsx(X1,{size:18})})]}),h.jsxs("div",{className:"flex flex-1 min-h-0",children:[h.jsxs("div",{className:"flex-1 flex flex-col min-w-0 overflow-hidden",children:[h.jsx("div",{className:"shrink-0 px-6 pt-4",children:h.jsx(ZG,{ref:S,videoId:t.videoId,onTimeUpdate:H,onDuration:G})}),h.jsx("div",{className:"flex-1 min-h-0 mt-2",children:h.jsx(lO,{segments:a,currentTime:d,onSegmentClick:$,loading:l,highlights:x,onCreateHighlight:L,onDeleteHighlight:D,onUpdateHighlight:j,highlightTagsMap:y,scrollToSegment:M})})]}),h.jsx(HC,{articleId:n,collapsed:p,externalHighlights:x,onExternalDeleteHighlight:D,onHighlightClick:P})]})]})}const B2=[.5,.75,1,1.25,1.5,1.75,2,2.5,3],F2=15,z2=30;function vD(n){if(!isFinite(n)||n<0)return"0:00";const e=Math.floor(n/3600),t=Math.floor(n%3600/60),i=Math.floor(n%60);return e>0?`${e}:${String(t).padStart(2,"0")}:${String(i).padStart(2,"0")}`:`${t}:${String(i).padStart(2,"0")}`}const rY=E.forwardRef(function({audioUrl:e,title:t,showName:i,artworkUrl:s,initialTime:r,onTimeUpdate:a,onDuration:o,onEnded:l,onDownload:u,downloaded:d},f){const p=E.useRef(null),g=E.useRef(null),x=E.useRef(!1),[w,y]=E.useState(!1),[m,v]=E.useState(!0),[b,A]=E.useState(0),[S,C]=E.useState(0),[k,L]=E.useState(1),[D,j]=E.useState(1),[P,H]=E.useState(!1);E.useImperativeHandle(f,()=>({seekTo:ae=>{const Z=p.current;Z&&(Z.currentTime=ae)},play:()=>{var ae;(ae=p.current)==null||ae.play().catch(()=>{})},pause:()=>{var ae;(ae=p.current)==null||ae.pause()}}),[]);const G=E.useCallback(()=>{const ae=p.current;ae&&(v(!1),C(ae.duration),o==null||o(ae.duration),!x.current&&r&&r>0&&(ae.currentTime=r,x.current=!0))},[r,o]),$=E.useCallback(()=>{const ae=p.current;ae&&(A(ae.currentTime),a==null||a(ae.currentTime))},[a]),Y=E.useCallback(()=>{y(!1),l==null||l()},[l]),F=E.useCallback(()=>{const ae=p.current;!ae||!ae.duration||(C(ae.duration),o==null||o(ae.duration))},[o]),M=E.useCallback(()=>{const ae=p.current;ae&&(ae.paused?ae.play().catch(()=>{}):ae.pause())},[]),I=E.useCallback(()=>{const ae=p.current;ae&&(ae.currentTime=Math.max(0,ae.currentTime-F2))},[]),V=E.useCallback(()=>{const ae=p.current;ae&&(ae.currentTime=Math.min(ae.duration,ae.currentTime+z2))},[]),ie=E.useCallback(()=>{L(ae=>{const Z=B2.indexOf(ae),re=B2[(Z+1)%B2.length];return p.current&&(p.current.playbackRate=re),re})},[]),ge=E.useCallback(()=>{const ae=p.current;ae&&(ae.muted=!ae.muted,H(ae.muted))},[]),ee=E.useCallback(ae=>{const Z=parseFloat(ae.target.value);j(Z),p.current&&(p.current.volume=Z,p.current.muted=Z===0,H(Z===0))},[]),me=E.useCallback(ae=>{const Z=g.current,re=p.current;if(!Z||!re||!S)return;const ne=Z.getBoundingClientRect(),xe=Math.max(0,Math.min(1,(ae.clientX-ne.left)/ne.width));re.currentTime=xe*S},[S]);E.useEffect(()=>{const ae=p.current;if(!ae)return;const Z=()=>y(!0),re=()=>y(!1);return ae.addEventListener("play",Z),ae.addEventListener("pause",re),()=>{ae.removeEventListener("play",Z),ae.removeEventListener("pause",re)}},[]),E.useEffect(()=>{const ae=Z=>{const re=Z.target.tagName;re==="INPUT"||re==="TEXTAREA"||(Z.key===" "&&!Z.metaKey&&!Z.ctrlKey&&(Z.preventDefault(),M()),Z.key==="ArrowLeft"&&(Z.preventDefault(),I()),Z.key==="ArrowRight"&&(Z.preventDefault(),V()))};return document.addEventListener("keydown",ae),()=>document.removeEventListener("keydown",ae)},[M,I,V]);const oe=S>0?b/S*100:0;return h.jsxs("div",{className:"flex flex-col gap-3 bg-[#1a1a1a] rounded-lg p-4 border border-white/5",children:[h.jsx("audio",{ref:p,src:e,preload:"auto",onLoadedMetadata:G,onTimeUpdate:$,onEnded:Y,onDurationChange:F,onCanPlay:()=>v(!1),onWaiting:()=>v(!0)}),(t||i)&&h.jsxs("div",{className:"flex items-center gap-3",children:[s&&h.jsx("img",{src:s,alt:"",className:"w-12 h-12 rounded-md object-cover shrink-0"}),h.jsxs("div",{className:"flex-1 min-w-0",children:[t&&h.jsx("div",{className:"text-sm font-medium text-gray-200 truncate",children:t}),i&&h.jsx("div",{className:"text-xs text-gray-500 truncate",children:i})]})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"text-xs text-gray-500 w-12 text-right tabular-nums shrink-0",children:vD(b)}),h.jsx("div",{ref:g,className:"flex-1 h-1.5 bg-white/10 rounded-full cursor-pointer group relative",onClick:me,children:h.jsx("div",{className:"h-full bg-blue-500 rounded-full transition-[width] duration-100 relative",style:{width:`${oe}%`},children:h.jsx("div",{className:"absolute right-0 top-1/2 -translate-y-1/2 w-3 h-3 bg-blue-400 rounded-full opacity-0 group-hover:opacity-100 transition-opacity"})})}),h.jsx("span",{className:"text-xs text-gray-500 w-12 tabular-nums shrink-0",children:vD(S)})]}),h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsxs("button",{onClick:ie,className:"px-2 py-1 text-xs font-medium text-gray-400 hover:text-white bg-white/5 hover:bg-white/10 rounded transition-colors cursor-pointer min-w-[40px]",title:"æ’­æ”¾é€Ÿåº¦",children:[k,"x"]}),u&&h.jsx("button",{onClick:u,className:`p-1.5 rounded transition-colors cursor-pointer ${d?"text-green-400 hover:text-green-300":"text-gray-400 hover:text-white hover:bg-white/10"}`,title:d?"å·²ä¸‹è½½":"ä¸‹è½½",children:h.jsx(vl,{size:16})})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs("button",{onClick:I,className:"p-1.5 text-gray-400 hover:text-white transition-colors cursor-pointer relative",title:`åŽé€€ ${F2} ç§’`,children:[h.jsx(tR,{size:20}),h.jsx("span",{className:"absolute inset-0 flex items-center justify-center text-[8px] font-bold mt-[1px]",children:F2})]}),h.jsx("button",{onClick:M,disabled:m&&!w,className:"w-10 h-10 flex items-center justify-center rounded-full bg-white text-black hover:bg-gray-200 disabled:bg-gray-600 disabled:text-gray-400 transition-colors cursor-pointer",title:w?"æš‚åœ":"æ’­æ”¾",children:m&&!w?h.jsx(xt,{size:20,className:"animate-spin"}):w?h.jsx(pz,{size:20}):h.jsx(bz,{size:20,className:"ml-0.5"})}),h.jsxs("button",{onClick:V,className:"p-1.5 text-gray-400 hover:text-white transition-colors cursor-pointer relative",title:`å‰è¿› ${z2} ç§’`,children:[h.jsx(kz,{size:20}),h.jsx("span",{className:"absolute bottom-0 right-0 text-[8px] font-bold",children:z2})]})]}),h.jsxs("div",{className:"flex items-center justify-end gap-2 w-28 shrink-0",children:[h.jsx("button",{onClick:ge,className:"p-1.5 text-gray-400 hover:text-white transition-colors cursor-pointer",title:P?"å–æ¶ˆé™éŸ³":"é™éŸ³",children:P||D===0?h.jsx(lU,{size:16}):h.jsx(aU,{size:16})}),h.jsx("div",{className:"flex items-center",children:h.jsx("input",{type:"range",min:"0",max:"1",step:"0.05",value:P?0:D,onChange:ee,className:"w-16 h-1 accent-blue-500 cursor-pointer"})})]})]})]})});function aY(n){if(!(n!=null&&n.startsWith("transcript:")))return null;const e=n.slice(11).split("-"),t=parseInt(e[0],10);return isNaN(t)?null:t}function oY({articleId:n,onClose:e}){const[t,i]=E.useState(null),[s,r]=E.useState(!0),[a,o]=E.useState(null),[l,u]=E.useState(0),[d,f]=E.useState(()=>localStorage.getItem("podcast-reader-detail-collapsed")==="true"),[p,g]=E.useState(!1),[x,w]=E.useState("about"),[y,m]=E.useState([]),[v,b]=E.useState({}),[A,S]=E.useState("loading"),[C,k]=E.useState([]),[L,D]=E.useState({chunkIndex:0,totalChunks:1,overallProgress:0}),[j,P]=E.useState(null),[H,G]=E.useState(null),$=E.useRef(0),Y=E.useRef(null),F=E.useRef(null),M=E.useRef(0),I=E.useRef(0);I.current=C.length,E.useEffect(()=>{let ye=!1;return r(!0),window.electronAPI.articleGet(n).then(async we=>{if(ye||!we){ye||r(!1);return}if(i(we),we.audioDuration?M.current=we.audioDuration:we.duration&&(M.current=we.duration),r(!1),we.feedId)try{const ke=(await window.electronAPI.feedList()).find(Ae=>Ae.id===we.feedId);ke!=null&&ke.title&&!ye&&o(ke.title)}catch{}try{(await window.electronAPI.downloadList()).find(Ae=>Ae.articleId===n&&Ae.status==="ready")&&!ye&&g(!0)}catch{}}).catch(()=>{ye||r(!1)}),()=>{ye=!0}},[n]),E.useEffect(()=>{let ye=!1;return window.electronAPI.highlightList(n).then(we=>{if(!ye&&(m(we),we.length>0)){const He=we.map(ke=>ke.id);window.electronAPI.highlightTagsBatch(He).then(ke=>{ye||b(ke)})}}),()=>{ye=!0}},[n]),E.useEffect(()=>{let ye=!1;async function we(){try{const ke=await window.electronAPI.transcriptGet(n);if(ke&&ke.segments.length>0&&!ye){k(ke.segments),S("complete");return}}catch{}if(ye)return;let He;try{He=await window.electronAPI.settingsGet()}catch{ye||S("not-configured");return}if(!He.volcAsrAppKey||!He.volcAsrAccessKey){ye||S("not-configured");return}try{if(!(await window.electronAPI.downloadList()).find(it=>it.articleId===n&&it.status==="ready")){ye||S("not-downloaded");return}}catch{ye||S("not-downloaded");return}ye||S("ready")}return we(),()=>{ye=!0}},[n]),E.useEffect(()=>{const ye=window.electronAPI.asrOnProgress(Ae=>{Ae.articleId===n&&D({chunkIndex:Ae.chunkIndex,totalChunks:Ae.totalChunks,overallProgress:Ae.overallProgress})}),we=window.electronAPI.asrOnSegment(Ae=>{Ae.articleId===n&&k(Ae.segments)}),He=window.electronAPI.asrOnComplete(Ae=>{Ae.articleId===n&&(k(Ae.segments),S("complete"))}),ke=window.electronAPI.asrOnError(Ae=>{Ae.articleId===n&&(P(Ae.error),I.current>0?S("complete"):S("ready"))});return()=>{ye(),we(),He(),ke()}},[n]);const V=E.useCallback(async()=>{P(null),k([]),S("transcribing"),D({chunkIndex:0,totalChunks:1,overallProgress:0});try{await window.electronAPI.asrStart(n)}catch(ye){console.error("ASR start failed:",ye),P(ye instanceof Error?ye.message:String(ye)),S("ready")}},[n]),ie=E.useCallback(async()=>{try{await window.electronAPI.asrCancel(n)}catch{}C.length>0?S("complete"):S("ready")},[n,C.length]),ge=E.useCallback(()=>{confirm("é‡æ–°è½¬å†™å°†è¦†ç›–å½“å‰çš„è½¬å†™ç»“æžœï¼Œæ˜¯å¦ç»§ç»­ï¼Ÿ")&&V()},[V]),ee=E.useCallback(ye=>{u(ye),!F.current&&(F.current=setTimeout(()=>{F.current=null;const we=M.current;if(we>0){const He=Math.min(ye/we,1),ke={id:n,readProgress:He};He>=.9&&(ke.readStatus="seen"),window.electronAPI.articleUpdate(ke).catch(console.error)}},1e4))},[n]),me=E.useCallback(ye=>{M.current=ye,t&&!t.audioDuration&&!t.duration&&i(we=>we&&{...we,audioDuration:ye,duration:ye})},[t]),oe=E.useCallback(()=>{window.electronAPI.articleUpdate({id:n,readProgress:1,readStatus:"seen"}).catch(console.error)},[n]),ae=E.useCallback(async()=>{try{await window.electronAPI.downloadStart(n),g(!0),A==="not-downloaded"&&S("ready")}catch(ye){console.error("Download failed:",ye)}},[n,A]),Z=E.useCallback(ye=>{var we;(we=Y.current)==null||we.seekTo(ye)},[]),re=E.useCallback(async ye=>{const we=await window.electronAPI.highlightCreate({articleId:n,text:ye.text,color:"yellow",paragraphIndex:ye.paragraphIndex,startOffset:ye.startOffset,endOffset:ye.endOffset,anchorPath:ye.anchorPath});m(He=>[...He,we])},[n]),ne=E.useCallback(async ye=>{await window.electronAPI.highlightDelete(ye),m(we=>we.filter(He=>He.id!==ye)),b(we=>{const He={...we};return delete He[ye],He})},[]),xe=E.useCallback(async(ye,we)=>{const He=await window.electronAPI.highlightUpdate({id:ye,note:we});m(ke=>ke.map(Ae=>Ae.id===ye?He:Ae))},[]),Re=E.useCallback(ye=>{var ke;const we=y.find(Ae=>Ae.id===ye);if(!we)return;const He=aY(we.anchorPath);He!=null&&($.current+=1,G(He+$.current*.001),C[He]&&((ke=Y.current)==null||ke.seekTo(C[He].start)))},[y,C]),je=E.useCallback(()=>{const ye=M.current;if(ye>0&&l>0){const we=Math.min(l/ye,1),He={id:n,readProgress:we};we>=.9&&(He.readStatus="seen"),window.electronAPI.articleUpdate(He).catch(console.error)}F.current&&clearTimeout(F.current),e()},[n,l,e]),Oe=E.useCallback(()=>{f(ye=>{const we=!ye;return localStorage.setItem("podcast-reader-detail-collapsed",String(we)),we})},[]);if(E.useEffect(()=>{const ye=we=>{we.key==="Escape"&&(we.preventDefault(),je())};return document.addEventListener("keydown",ye),()=>document.removeEventListener("keydown",ye)},[je]),s||!t)return h.jsx("div",{className:"flex items-center justify-center h-full bg-[#0f0f0f]",children:h.jsx(xt,{size:24,className:"animate-spin text-gray-500"})});const Ce=t.audioUrl;if(!Ce)return h.jsxs("div",{className:"flex flex-col items-center justify-center h-full bg-[#0f0f0f] gap-3",children:[h.jsx("div",{className:"text-gray-500 text-sm",children:"è¯¥é›†æ— å¯ç”¨éŸ³é¢‘"}),h.jsx("button",{onClick:je,className:"px-4 py-2 text-sm text-gray-300 bg-white/10 hover:bg-white/15 rounded-md transition-colors cursor-pointer",children:"è¿”å›ž"})]});const Fe=t.readProgress>0&&M.current>0?t.readProgress*M.current:t.readProgress>0&&t.audioDuration?t.readProgress*t.audioDuration:0,Ze=H!=null?Math.floor(H):null;return h.jsxs("div",{className:"flex flex-col h-full bg-[#0f0f0f]",children:[h.jsxs("div",{className:"flex items-center gap-3 px-4 py-2 border-b border-[#262626] shrink-0",children:[h.jsx("button",{onClick:je,className:"p-1.5 rounded-md hover:bg-white/10 text-gray-400 hover:text-white transition-colors cursor-pointer",title:"è¿”å›ž",children:h.jsx(V1,{size:18})}),h.jsx("h1",{className:"text-sm font-medium text-gray-200 truncate flex-1",children:t.title}),h.jsx("button",{onClick:Oe,className:"p-1.5 rounded-md hover:bg-white/10 text-gray-400 hover:text-white transition-colors cursor-pointer",title:d?"æ˜¾ç¤ºè¯¦æƒ…é¢æ¿":"éšè—è¯¦æƒ…é¢æ¿",children:d?h.jsx(K1,{size:18}):h.jsx(X1,{size:18})})]}),h.jsxs("div",{className:"flex flex-1 min-h-0",children:[h.jsxs("div",{className:"flex-1 flex flex-col min-w-0 overflow-hidden",children:[h.jsx("div",{className:"shrink-0 px-6 pt-4",children:h.jsx(rY,{ref:Y,audioUrl:Ce,title:t.title??void 0,showName:a??void 0,artworkUrl:t.thumbnail??void 0,initialTime:Fe,onTimeUpdate:ee,onDuration:me,onEnded:oe,onDownload:ae,downloaded:p})}),h.jsx("div",{className:"shrink-0 flex border-b border-white/5 px-6 mt-3",children:[{key:"about",label:"ç®€ä»‹",icon:h.jsx(xl,{size:14})},{key:"summary",label:"æ‘˜è¦",icon:h.jsx(jb,{size:14})},{key:"transcript",label:"è½¬å†™",icon:h.jsx(dx,{size:14})}].map(ye=>h.jsxs("button",{onClick:()=>w(ye.key),className:`flex items-center gap-1.5 px-4 py-2 text-xs font-medium border-b-2 transition-colors cursor-pointer ${x===ye.key?"border-blue-500 text-white":"border-transparent text-gray-500 hover:text-gray-300"}`,children:[ye.icon,ye.label]},ye.key))}),x==="about"&&h.jsxs("div",{className:"flex-1 min-h-0 overflow-y-auto px-6 pb-8 pt-4",children:[h.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a&&h.jsx("span",{className:"text-xs text-gray-500",children:a}),t.publishedAt&&h.jsxs(h.Fragment,{children:[a&&h.jsx("span",{className:"text-xs text-gray-600",children:"Â·"}),h.jsx("span",{className:"text-xs text-gray-500",children:new Date(t.publishedAt).toLocaleDateString()})]}),t.episodeNumber!=null&&h.jsxs(h.Fragment,{children:[h.jsx("span",{className:"text-xs text-gray-600",children:"Â·"}),h.jsxs("span",{className:"text-xs text-gray-500",children:[t.seasonNumber!=null?`S${t.seasonNumber} `:"","E",t.episodeNumber]})]}),t.audioDuration!=null&&h.jsxs(h.Fragment,{children:[h.jsx("span",{className:"text-xs text-gray-600",children:"Â·"}),h.jsx("span",{className:"text-xs text-gray-500",children:xD(t.audioDuration)})]})]}),t.summary&&h.jsx("p",{className:"text-sm text-gray-400 mb-4 leading-relaxed",children:t.summary}),t.content&&h.jsx("div",{className:`prose prose-invert prose-sm max-w-none text-gray-300
                    prose-headings:text-gray-200 prose-a:text-blue-400 prose-a:no-underline hover:prose-a:underline
                    prose-strong:text-gray-200 prose-code:text-gray-300 prose-code:bg-white/5 prose-code:rounded prose-code:px-1`,dangerouslySetInnerHTML:{__html:t.content}}),!t.content&&t.contentText&&h.jsx("div",{className:"text-sm text-gray-400 whitespace-pre-wrap leading-relaxed",children:t.contentText})]}),x==="summary"&&h.jsx("div",{className:"flex-1 min-h-0 overflow-y-auto px-6 pb-8 pt-4",children:h.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-gray-500",children:[h.jsx(jb,{size:32,className:"mb-3 opacity-40"}),h.jsx("p",{className:"text-sm",children:"æ‘˜è¦åŠŸèƒ½å³å°†ä¸Šçº¿"}),h.jsx("p",{className:"text-xs mt-1 text-gray-600",children:"å°†è‡ªåŠ¨ç”Ÿæˆæ’­å®¢å†…å®¹æ‘˜è¦"})]})}),x==="transcript"&&h.jsxs("div",{className:"flex-1 min-h-0 flex flex-col",children:[A==="transcribing"&&h.jsxs("div",{className:"shrink-0 px-6 pt-3 pb-2",children:[h.jsxs("div",{className:"flex items-center justify-between mb-2",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(xt,{size:14,className:"animate-spin text-teal-400"}),h.jsxs("span",{className:"text-xs text-gray-400",children:[L.totalChunks>1?`åˆ†å— ${L.chunkIndex+1}/${L.totalChunks} Â· `:"",Math.round(L.overallProgress*100),"% å®Œæˆ"]})]}),h.jsxs("button",{onClick:ie,className:"flex items-center gap-1 px-2 py-1 text-xs text-gray-400 hover:text-red-400 transition-colors cursor-pointer",children:[h.jsx(IC,{size:12}),"å–æ¶ˆ"]})]}),h.jsx("div",{className:"w-full h-1 bg-white/5 rounded-full overflow-hidden",children:h.jsx("div",{className:"h-full bg-teal-500 rounded-full transition-all duration-300",style:{width:`${L.overallProgress*100}%`}})})]}),A==="complete"&&h.jsx("div",{className:"shrink-0 px-6 pt-3 pb-1 flex justify-end",children:h.jsxs("button",{onClick:ge,className:"flex items-center gap-1 px-2 py-1 text-[11px] text-gray-500 hover:text-gray-300 transition-colors cursor-pointer",children:[h.jsx(Kp,{size:11}),"é‡æ–°è½¬å†™"]})}),j&&h.jsx("div",{className:"shrink-0 mx-6 mt-2 px-3 py-2 bg-red-500/10 border border-red-500/20 rounded-md",children:h.jsx("p",{className:"text-xs text-red-400",children:j})}),A==="complete"||A==="transcribing"&&C.length>0?h.jsx("div",{className:"flex-1 min-h-0",children:h.jsx(lO,{segments:C,currentTime:l,onSegmentClick:Z,highlights:y,onCreateHighlight:re,onDeleteHighlight:ne,onUpdateHighlight:xe,highlightTagsMap:v,scrollToSegment:Ze})}):h.jsxs("div",{className:"flex-1 min-h-0 flex items-center justify-center",children:[A==="loading"&&h.jsxs("div",{className:"flex flex-col items-center gap-3 text-gray-500",children:[h.jsx(xt,{size:24,className:"animate-spin"}),h.jsx("p",{className:"text-sm",children:"åŠ è½½ä¸­..."})]}),A==="not-configured"&&h.jsxs("div",{className:"flex flex-col items-center gap-3 text-gray-500 max-w-xs text-center",children:[h.jsx(zC,{size:32,className:"opacity-40"}),h.jsx("p",{className:"text-sm",children:"éœ€è¦é…ç½®è¯­éŸ³è¯†åˆ«æœåŠ¡"}),h.jsx("p",{className:"text-xs text-gray-600",children:"è¯·åœ¨è®¾ç½®ä¸­é…ç½®ç«å±±å¼•æ“Ž App Key å’Œ Access Token"})]}),A==="not-downloaded"&&h.jsxs("div",{className:"flex flex-col items-center gap-3 text-gray-500 max-w-xs text-center",children:[h.jsx(vl,{size:32,className:"opacity-40"}),h.jsx("p",{className:"text-sm",children:"è¯·å…ˆä¸‹è½½éŸ³é¢‘"}),h.jsx("p",{className:"text-xs text-gray-600 mb-2",children:"è½¬å†™åŠŸèƒ½éœ€è¦ä½¿ç”¨å·²ä¸‹è½½çš„éŸ³é¢‘æ–‡ä»¶"}),h.jsxs("button",{onClick:ae,className:"flex items-center gap-1.5 px-4 py-2 bg-teal-600 hover:bg-teal-700 text-white text-sm rounded-md transition-colors cursor-pointer",children:[h.jsx(vl,{size:14}),"ä¸‹è½½éŸ³é¢‘"]})]}),A==="ready"&&h.jsxs("div",{className:"flex flex-col items-center gap-3 text-gray-500 max-w-xs text-center",children:[h.jsx(dx,{size:32,className:"opacity-40"}),h.jsx("p",{className:"text-sm",children:"éŸ³é¢‘è½¬å†™ä¸ºæ–‡å­—"}),t.audioDuration!=null&&h.jsxs("p",{className:"text-xs text-gray-600",children:["éŸ³é¢‘æ—¶é•¿ ",xD(t.audioDuration),t.audioDuration>1800&&"ï¼Œå°†åˆ†å—å¤„ç†"]}),h.jsxs("button",{onClick:V,className:"flex items-center gap-1.5 px-4 py-2 bg-teal-600 hover:bg-teal-700 text-white text-sm rounded-md transition-colors cursor-pointer",children:[h.jsx(dx,{size:14}),"å¼€å§‹è½¬å†™"]})]}),A==="transcribing"&&C.length===0&&h.jsxs("div",{className:"flex flex-col items-center gap-3 text-gray-500",children:[h.jsx(xt,{size:24,className:"animate-spin text-teal-400"}),h.jsx("p",{className:"text-sm",children:"æ­£åœ¨å¤„ç†éŸ³é¢‘..."}),h.jsx("p",{className:"text-xs text-gray-600",children:"è½¬å†™ç»“æžœå°†å®žæ—¶æ˜¾ç¤º"})]})]})]})]}),h.jsx(HC,{articleId:n,collapsed:d,externalHighlights:y,onExternalDeleteHighlight:ne,onHighlightClick:Re})]})]})}function xD(n){const e=Math.floor(n/3600),t=Math.floor(n%3600/60);return e>0?`${e}h ${t}m`:`${t}m`}function bD(n){if(n===null||n===0)return"0 B";const e=["B","KB","MB","GB"],t=Math.floor(Math.log(n)/Math.log(1024));return`${(n/Math.pow(1024,t)).toFixed(1)} ${e[t]}`}function lY(n){const e=new Date(n),i=new Date().getTime()-e.getTime(),s=Math.floor(i/(1e3*60*60*24));return s===0?"Today":s===1?"Yesterday":s<7?`${s} days ago`:e.toLocaleDateString("en-US",{month:"short",day:"numeric"})}const wD={queued:{icon:h.jsx(vl,{size:14}),label:"Queued",color:"text-gray-400"},downloading:{icon:h.jsx(xt,{size:14,className:"animate-spin"}),label:"Downloading",color:"text-blue-400"},ready:{icon:h.jsx(qj,{size:14}),label:"Ready",color:"text-green-400"},failed:{icon:h.jsx(IC,{size:14}),label:"Failed",color:"text-red-400"}};function cY({open:n,onClose:e}){const{t}=Sn(),[i,s]=E.useState([]),[r,a]=E.useState(!1),o=E.useCallback(async()=>{a(!0);try{const f=await window.electronAPI.downloadList();s(f)}catch(f){console.error("Failed to load downloads:",f)}finally{a(!1)}},[]);E.useEffect(()=>{n&&o()},[n,o]),E.useEffect(()=>{if(!n||!i.some(g=>g.status==="queued"||g.status==="downloading"))return;const p=setInterval(o,3e3);return()=>clearInterval(p)},[n,i,o]),E.useEffect(()=>{if(!n)return;const f=p=>{p.key==="Escape"&&(p.stopImmediatePropagation(),e())};return document.addEventListener("keydown",f),()=>document.removeEventListener("keydown",f)},[n,e]);const l=async f=>{try{await window.electronAPI.downloadCancel(f),o()}catch(p){console.error("Failed to cancel download:",p)}},u=async f=>{try{await window.electronAPI.downloadStart(f.articleId),o()}catch(p){console.error("Failed to retry download:",p)}};if(!n)return null;const d=i.filter(f=>f.status==="ready").reduce((f,p)=>f+(p.bytes||0),0);return h.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[h.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:e}),h.jsxs("div",{className:"relative w-full max-w-lg bg-[#1a1a1a] border border-white/10 rounded-lg shadow-2xl",children:[h.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-white/10",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("h2",{className:"text-lg font-semibold text-white",children:t("downloads.title")}),h.jsxs("span",{className:"flex items-center gap-1.5 text-xs text-gray-500",children:[h.jsx(Yj,{size:12}),bD(d)]})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("button",{onClick:o,className:"p-1 rounded hover:bg-white/10 text-gray-400 hover:text-white transition-colors",title:"åˆ·æ–°",children:h.jsx(Kp,{size:16,className:r?"animate-spin":""})}),h.jsx("button",{onClick:e,className:"p-1 rounded hover:bg-white/10 text-gray-400 hover:text-white transition-colors",children:h.jsx(Fn,{size:20})})]})]}),h.jsx("div",{className:"max-h-[400px] overflow-y-auto",children:i.length===0?h.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-gray-500",children:[h.jsx(vl,{size:32,className:"mb-3 opacity-50"}),h.jsx("p",{className:"text-sm",children:t("downloads.noDownloads")}),h.jsx("p",{className:"text-xs mt-1",children:"Click download in podcast player to start offline caching"})]}):h.jsx("div",{className:"divide-y divide-white/5",children:i.map(f=>{const p=wD[f.status]||wD.queued;return h.jsxs("div",{className:"flex items-center gap-3 px-6 py-3 hover:bg-white/[0.03] transition-colors",children:[h.jsx("span",{className:`shrink-0 ${p.color}`,children:p.icon}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("p",{className:"text-sm text-gray-200 truncate",children:f.articleId}),h.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mt-0.5",children:[h.jsx("span",{className:p.color,children:p.label}),f.bytes&&h.jsx("span",{children:bD(f.bytes)}),h.jsx("span",{children:lY(f.addedAt)})]})]}),h.jsxs("div",{className:"shrink-0 flex items-center gap-1",children:[(f.status==="queued"||f.status==="downloading")&&h.jsx("button",{onClick:()=>l(f.id),className:"p-1.5 rounded hover:bg-white/10 text-gray-400 hover:text-red-400 transition-colors",title:"å–æ¶ˆä¸‹è½½",children:h.jsx(IC,{size:14})}),f.status==="failed"&&h.jsx("button",{onClick:()=>u(f),className:"p-1.5 rounded hover:bg-white/10 text-gray-400 hover:text-blue-400 transition-colors",title:"é‡è¯•",children:h.jsx(Kp,{size:14})}),f.status==="ready"&&h.jsx("button",{onClick:()=>l(f.id),className:"p-1.5 rounded hover:bg-white/10 text-gray-400 hover:text-red-400 transition-colors",title:"åˆ é™¤ä¸‹è½½",children:h.jsx(rs,{size:14})})]})]},f.id)})})})]})]})}function SD(n){return n<1e3?`${n}ms`:`${(n/1e3).toFixed(1)}s`}function ME(n){if(!n)return null;try{return JSON.parse(n)}catch{return null}}const AD={summarize:"text-blue-400 bg-blue-900/30",translate:"text-green-400 bg-green-900/30",auto_tag:"text-yellow-400 bg-yellow-900/30",extract_topics:"text-purple-400 bg-purple-900/30",chat:"text-cyan-400 bg-cyan-900/30"},uY={llm_call:"text-blue-400 bg-blue-900/30",tool_call:"text-purple-400 bg-purple-900/30",error:"text-red-400 bg-red-900/30"},hY=["summarize","translate","auto_tag","extract_topics","chat"];function ED({data:n,label:e,maxLines:t=8}){const{t:i}=Sn(),[s,r]=E.useState(!1),[a,o]=E.useState(!1);if(n==null)return null;const l=typeof n=="string"?n:JSON.stringify(n,null,2),u=l.split(`
`),d=u.length>t,f=s||!d?l:u.slice(0,t).join(`
`)+`
...`,p=async()=>{await navigator.clipboard.writeText(l),o(!0),setTimeout(()=>o(!1),1500)};return h.jsxs("div",{className:"mt-2",children:[h.jsxs("div",{className:"flex items-center justify-between mb-1",children:[h.jsx("span",{className:"text-[11px] text-gray-500 font-medium",children:e}),h.jsx("button",{onClick:p,className:"flex items-center gap-1 text-[10px] text-gray-500 hover:text-gray-300 transition-colors cursor-pointer",children:a?h.jsxs(h.Fragment,{children:[h.jsx(nv,{className:"w-3 h-3 text-green-400"}),h.jsx("span",{className:"text-green-400",children:i("ai.copied")})]}):h.jsxs(h.Fragment,{children:[h.jsx(rv,{className:"w-3 h-3"}),h.jsx("span",{children:i("ai.copyJson")})]})})]}),h.jsx("pre",{className:"text-[11px] leading-[1.5] bg-black/30 border border-white/5 rounded-md p-2 overflow-x-auto text-gray-400 max-h-64 overflow-y-auto",children:f}),d&&h.jsx("button",{onClick:()=>r(!s),className:"mt-1 text-[10px] text-blue-400 hover:text-blue-300 cursor-pointer",children:s?i("ai.collapse"):`${i("ai.viewDetails")} (${u.length} lines)`})]})}function dY({tracesJson:n}){const{t:e}=Sn(),t=ME(n);return!t||!t.steps||t.steps.length===0?h.jsx("p",{className:"text-[11px] text-gray-600 italic mt-2",children:e("ai.noTraces")}):h.jsxs("div",{className:"mt-2 space-y-1.5",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[h.jsxs("span",{className:"text-[11px] text-gray-500 font-medium",children:[e("ai.traceDetails")," (",t.steps.length," ",e("ai.steps"),")"]}),t.totalDurationMs!=null&&h.jsx("span",{className:"text-[10px] text-gray-600",children:SD(t.totalDurationMs)})]}),t.steps.map((i,s)=>h.jsxs("div",{className:"bg-black/20 border border-white/5 rounded-md p-2",children:[h.jsxs("div",{className:"flex items-center gap-2 text-[11px]",children:[h.jsx("span",{className:"shrink-0 text-gray-500 w-4",children:s+1}),h.jsx("span",{className:`shrink-0 px-1.5 py-0.5 rounded text-[10px] font-medium ${uY[i.type]||"text-gray-400 bg-gray-800"}`,children:i.type}),h.jsx("span",{className:"text-gray-500",children:SD(i.durationMs)}),h.jsxs("span",{className:"text-gray-500",children:[i.tokenCount," tokens"]})]}),i.error&&h.jsxs("div",{className:"mt-1 flex items-center gap-1 text-[11px] text-red-400",children:[h.jsx(Y1,{className:"w-3 h-3"}),h.jsx("span",{children:i.error})]}),i.input&&h.jsx("div",{className:"mt-1",children:h.jsx("pre",{className:"text-[10px] leading-[1.4] text-gray-500 overflow-x-auto max-h-20 overflow-y-auto",children:i.input.length>300?i.input.slice(0,300)+"...":i.input})}),i.output&&h.jsx("div",{className:"mt-1 border-t border-white/5 pt-1",children:h.jsx("pre",{className:"text-[10px] leading-[1.4] text-gray-400 overflow-x-auto max-h-20 overflow-y-auto",children:i.output.length>300?i.output.slice(0,300)+"...":i.output})})]},s))]})}function fY({logId:n}){const{t:e}=Sn(),[t,i]=E.useState(null),[s,r]=E.useState(!0);if(E.useEffect(()=>{r(!0),window.electronAPI.aiTaskLogDetail(n).then(l=>i(l)).catch(()=>i(null)).finally(()=>r(!1))},[n]),s)return h.jsxs("div",{className:"flex items-center gap-2 py-3 text-gray-500",children:[h.jsx(xt,{className:"w-3.5 h-3.5 animate-spin"}),h.jsx("span",{className:"text-[11px]",children:e("ai.generating")})]});if(!t)return h.jsx("p",{className:"text-[11px] text-gray-600 py-2",children:e("ai.noTraces")});const a=ME(t.inputJson),o=ME(t.outputJson);return h.jsxs("div",{className:"pt-2 pb-1 border-t border-white/5",children:[t.errorText&&h.jsxs("div",{className:"flex items-center gap-1.5 mb-2 px-2 py-1.5 bg-red-900/20 border border-red-500/20 rounded-md",children:[h.jsx(Y1,{className:"w-3.5 h-3.5 text-red-400 shrink-0"}),h.jsx("span",{className:"text-[11px] text-red-400",children:t.errorText})]}),a!=null?h.jsx(ED,{data:a,label:e("ai.input")}):null,o!=null?h.jsx(ED,{data:o,label:e("ai.output")}):null,h.jsx(dY,{tracesJson:t.tracesJson})]})}function pY(){const{t:n}=Sn(),[e,t]=E.useState([]),[i,s]=E.useState(!0),[r,a]=E.useState(null),[o,l]=E.useState("all");E.useEffect(()=>{s(!0),window.electronAPI.aiTaskLogs(50).then(x=>t(x)).catch(()=>t([])).finally(()=>s(!1))},[]);const u=E.useMemo(()=>{const x=e.length,w=e.reduce((m,v)=>m+v.tokenCount,0),y=e.reduce((m,v)=>m+v.costUsd,0);return{totalCalls:x,totalTokens:w,totalCost:y}},[e]),d=E.useMemo(()=>{const x={};for(const w of e)x[w.taskType]||(x[w.taskType]={count:0,tokens:0}),x[w.taskType].count++,x[w.taskType].tokens+=w.tokenCount;return x},[e]),f=E.useMemo(()=>{const x=new Set(e.map(w=>w.taskType));return hY.filter(w=>x.has(w))},[e]),p=E.useMemo(()=>o==="all"?e:e.filter(x=>x.taskType===o),[e,o]),g=E.useCallback(x=>{a(w=>w===x?null:x)},[]);return i?h.jsx("div",{className:"flex items-center justify-center py-8",children:h.jsx(xt,{className:"w-5 h-5 animate-spin text-gray-500"})}):h.jsxs("section",{className:"space-y-4",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(Mz,{size:16,className:"text-purple-400"}),h.jsx("h3",{className:"text-sm font-medium text-white",children:n("ai.debugPanel")})]}),h.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[h.jsxs("div",{className:"bg-[#111] border border-white/5 rounded-lg px-3 py-2.5",children:[h.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[h.jsx(Wj,{className:"w-3 h-3 text-blue-400"}),h.jsx("span",{className:"text-[10px] text-gray-500",children:n("ai.totalCalls")})]}),h.jsx("p",{className:"text-lg font-semibold text-white",children:u.totalCalls})]}),h.jsxs("div",{className:"bg-[#111] border border-white/5 rounded-lg px-3 py-2.5",children:[h.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[h.jsx(hU,{className:"w-3 h-3 text-yellow-400"}),h.jsx("span",{className:"text-[10px] text-gray-500",children:n("ai.totalTokens")})]}),h.jsx("p",{className:"text-lg font-semibold text-white",children:u.totalTokens.toLocaleString()})]}),h.jsxs("div",{className:"bg-[#111] border border-white/5 rounded-lg px-3 py-2.5",children:[h.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[h.jsx(mF,{className:"w-3 h-3 text-green-400"}),h.jsx("span",{className:"text-[10px] text-gray-500",children:n("ai.totalCost")})]}),h.jsxs("p",{className:"text-lg font-semibold text-white",children:["$",u.totalCost.toFixed(4)]})]})]}),Object.keys(d).length>0&&h.jsx("div",{className:"flex flex-wrap gap-1.5",children:Object.entries(d).map(([x,w])=>h.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded text-[10px] font-medium ${AD[x]||"text-gray-400 bg-gray-800"}`,children:[x,h.jsxs("span",{className:"opacity-60",children:["x",w.count]}),h.jsxs("span",{className:"opacity-60",children:[w.tokens.toLocaleString(),"t"]})]},x))}),f.length>1&&h.jsxs("div",{className:"flex gap-1 overflow-x-auto pb-1",children:[h.jsx("button",{onClick:()=>l("all"),className:`shrink-0 px-2.5 py-1 rounded text-[11px] font-medium transition-colors cursor-pointer ${o==="all"?"bg-white/10 text-white":"text-gray-500 hover:text-gray-300 hover:bg-white/5"}`,children:n("ai.filterAll")}),f.map(x=>h.jsx("button",{onClick:()=>l(x),className:`shrink-0 px-2.5 py-1 rounded text-[11px] font-medium transition-colors cursor-pointer ${o===x?"bg-white/10 text-white":"text-gray-500 hover:text-gray-300 hover:bg-white/5"}`,children:x},x))]}),p.length===0?h.jsx("p",{className:"text-xs text-gray-500 py-4 text-center",children:n("ai.noLogs")}):h.jsx("div",{className:"space-y-1 max-h-80 overflow-y-auto",children:p.map(x=>{const w=r===x.id;return h.jsxs("div",{className:"bg-[#111] border border-white/5 rounded-md overflow-hidden",children:[h.jsxs("button",{onClick:()=>g(x.id),className:"w-full flex items-center justify-between px-3 py-2 text-xs hover:bg-white/[0.03] transition-colors cursor-pointer",children:[h.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[w?h.jsx(sv,{className:"w-3 h-3 text-gray-500 shrink-0"}):h.jsx(G1,{className:"w-3 h-3 text-gray-500 shrink-0"}),h.jsx("span",{className:`shrink-0 px-1.5 py-0.5 rounded text-[10px] font-medium ${AD[x.taskType]||"text-gray-400 bg-gray-800"}`,children:x.taskType}),h.jsx("span",{className:`shrink-0 px-1.5 py-0.5 rounded text-[10px] font-medium ${x.status==="completed"?"bg-green-900/40 text-green-400":x.status==="failed"?"bg-red-900/40 text-red-400":"bg-yellow-900/40 text-yellow-400"}`,children:x.status})]}),h.jsxs("div",{className:"flex items-center gap-3 shrink-0 text-gray-500",children:[h.jsxs("span",{children:[x.tokenCount," tokens"]}),h.jsxs("span",{children:["$",x.costUsd.toFixed(4)]}),h.jsx("span",{children:new Date(x.createdAt).toLocaleString(void 0,{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]}),w&&h.jsx("div",{className:"px-3 pb-3",children:h.jsx(fY,{logId:x.id})})]},x.id)})})]})}function gY({open:n,onClose:e}){const{t}=Sn(),[i,s]=E.useState({}),[r,a]=E.useState(!1),[o,l]=E.useState(!1),[u,d]=E.useState(!1),[f,p]=E.useState({provider:"openrouter",apiKey:"",models:{fast:"",smart:"",cheap:""}}),[g,x]=E.useState(!1),[w,y]=E.useState(!1),[m,v]=E.useState(!1),{showToast:b}=au();E.useEffect(()=>{n&&(a(!0),d(!1),x(!1),v(!1),Promise.all([window.electronAPI.settingsGet(),window.electronAPI.aiSettingsGet().catch(()=>null)]).then(([D,j])=>{s(D),j&&p(j)}).catch(D=>console.error("Failed to load settings:",D)).finally(()=>a(!1)))},[n]),E.useEffect(()=>{if(!n)return;const D=j=>{j.key==="Escape"&&(j.stopImmediatePropagation(),e())};return document.addEventListener("keydown",D),()=>document.removeEventListener("keydown",D)},[n,e]);const A=(D,j)=>{s(P=>({...P,[D]:j})),d(!0)},S=async()=>{l(!0);try{const D=await window.electronAPI.settingsSet(i);s(D),d(!1),b(t("preferences.settingsSaved"))}catch(D){console.error("Failed to save settings:",D),b(t("preferences.saveFailed"))}finally{l(!1)}},C=E.useCallback((D,j)=>{p(P=>({...P,[D]:j})),x(!0)},[]),k=E.useCallback((D,j)=>{p(P=>({...P,models:{...P.models,[D]:j}})),x(!0)},[]),L=async()=>{y(!0);try{await window.electronAPI.aiSettingsSet(f),x(!1),b(t("ai.saved"))}catch(D){console.error("Failed to save AI settings:",D),b(t("preferences.saveFailed"))}finally{y(!1)}};return n?h.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[h.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:e}),h.jsxs("div",{className:"relative w-full max-w-3xl bg-[#1a1a1a] border border-white/10 rounded-lg shadow-2xl max-h-[85vh] overflow-hidden",children:[h.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-white/10",children:[h.jsx("h2",{className:"text-lg font-semibold text-white",children:t("preferences.title")}),h.jsx("button",{onClick:e,className:"p-1 rounded hover:bg-white/10 text-gray-400 hover:text-white transition-colors",children:h.jsx(Fn,{size:20})})]}),r?h.jsx("div",{className:"flex items-center justify-center py-12",children:h.jsx(xt,{size:24,className:"animate-spin text-gray-500"})}):h.jsxs("div",{className:"p-6 space-y-6 overflow-y-auto max-h-[calc(85vh-80px)]",children:[h.jsxs("section",{children:[h.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[h.jsx(ed,{size:16,className:"text-cyan-400"}),h.jsx("h3",{className:"text-sm font-medium text-white",children:"è¯­è¨€"})]}),h.jsx("div",{className:"space-y-4",children:h.jsxs("div",{children:[h.jsx("label",{htmlFor:"language-select",className:"block text-xs font-medium text-gray-400 mb-1.5",children:"é€‰æ‹©è¯­è¨€"}),h.jsx("select",{id:"language-select",value:i.language||"zh",onChange:D=>{const j=D.target.value;A("language",j),VD(j)},className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent",children:qI.map(D=>h.jsxs("option",{value:D.code,children:[D.nativeName," (",D.name,")"]},D.code))}),h.jsx("p",{className:"text-[11px] text-gray-600 mt-1",children:"æ›´æ”¹è¯­è¨€åŽï¼Œéƒ¨åˆ†ç•Œé¢å°†ç«‹å³æ›´æ–°ã€‚"})]})})]}),h.jsxs("section",{children:[h.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[h.jsx(FC,{size:16,className:"text-blue-400"}),h.jsx("h3",{className:"text-sm font-medium text-white",children:"æ’­å®¢è®¾ç½®"})]}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{htmlFor:"pi-key",className:"block text-xs font-medium text-gray-400 mb-1.5",children:"Podcast Index API Key"}),h.jsx("input",{id:"pi-key",type:"text",value:i.podcastIndexApiKey||"",onChange:D=>A("podcastIndexApiKey",D.target.value||void 0),placeholder:"å¯é€‰ - å¯ç”¨ Podcast Index æœç´¢",className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),h.jsxs("div",{children:[h.jsx("label",{htmlFor:"pi-secret",className:"block text-xs font-medium text-gray-400 mb-1.5",children:"Podcast Index API Secret"}),h.jsx("input",{id:"pi-secret",type:"password",value:i.podcastIndexApiSecret||"",onChange:D=>A("podcastIndexApiSecret",D.target.value||void 0),placeholder:"å¯é€‰ - é…åˆ API Key ä½¿ç”¨",className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),h.jsxs("p",{className:"text-[11px] text-gray-600 leading-relaxed",children:["åœ¨"," ",h.jsx("span",{className:"text-gray-400",children:"podcastindex.org"})," ","å…è´¹æ³¨å†Œå³å¯èŽ·å– API å¯†é’¥ï¼Œå¯ç”¨ Podcast Index ä½œä¸ºè¡¥å……æœç´¢æºã€‚"]})]})]}),h.jsxs("section",{children:[h.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[h.jsx(PC,{size:16,className:"text-orange-400"}),h.jsx("h3",{className:"text-sm font-medium text-white",children:"RSSHub è®¾ç½®"})]}),h.jsx("div",{className:"space-y-4",children:h.jsxs("div",{children:[h.jsx("label",{htmlFor:"rsshub-url",className:"block text-xs font-medium text-gray-400 mb-1.5",children:"RSSHub å®žä¾‹åœ°å€"}),h.jsx("input",{id:"rsshub-url",type:"text",value:i.rsshubBaseUrl||"",onChange:D=>A("rsshubBaseUrl",D.target.value||void 0),placeholder:"https://rsshub.example.com",className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),h.jsx("p",{className:"text-[11px] text-gray-600 mt-1",children:"é…ç½®è‡ªå»º RSSHub å®žä¾‹åœ°å€ï¼Œå¯ç”¨å‘çŽ°é¡µé¢çš„åˆ†ç±»æµè§ˆå’Œè·¯ç”±æœç´¢åŠŸèƒ½ã€‚"})]})})]}),h.jsxs("section",{children:[h.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[h.jsx(Yj,{size:16,className:"text-green-400"}),h.jsx("h3",{className:"text-sm font-medium text-white",children:"ä¸‹è½½è®¾ç½®"})]}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{htmlFor:"dl-dir",className:"block text-xs font-medium text-gray-400 mb-1.5",children:"ä¸‹è½½ç›®å½•"}),h.jsx("input",{id:"dl-dir",type:"text",value:i.downloadDirectory||"",onChange:D=>A("downloadDirectory",D.target.value||void 0),placeholder:"é»˜è®¤: åº”ç”¨æ•°æ®ç›®å½•/podcasts",className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),h.jsxs("div",{children:[h.jsx("label",{htmlFor:"dl-cap",className:"block text-xs font-medium text-gray-400 mb-1.5",children:"å­˜å‚¨å®¹é‡é™åˆ¶ (MB)"}),h.jsx("input",{id:"dl-cap",type:"number",min:100,step:100,value:i.downloadCapacityMb??5120,onChange:D=>A("downloadCapacityMb",parseInt(D.target.value,10)||5120),className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),h.jsx("p",{className:"text-[11px] text-gray-600 mt-1",children:"è¶…è¿‡é™åˆ¶æ—¶è‡ªåŠ¨æ¸…ç†æœ€æ—©çš„å·²ä¸‹è½½æ–‡ä»¶ã€‚é»˜è®¤ 5120 MB (5 GB)ã€‚"})]})]})]}),h.jsxs("section",{children:[h.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[h.jsx(dx,{size:16,className:"text-teal-400"}),h.jsx("h3",{className:"text-sm font-medium text-white",children:"è¯­éŸ³è¯†åˆ« (ASR)"})]}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{htmlFor:"volc-asr-app-key",className:"block text-xs font-medium text-gray-400 mb-1.5",children:"ç«å±±å¼•æ“Ž App Key"}),h.jsx("input",{id:"volc-asr-app-key",type:"text",value:i.volcAsrAppKey||"",onChange:D=>A("volcAsrAppKey",D.target.value||void 0),placeholder:"æŽ§åˆ¶å°èŽ·å–çš„ APP ID",className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent"})]}),h.jsxs("div",{children:[h.jsx("label",{htmlFor:"volc-asr-access-key",className:"block text-xs font-medium text-gray-400 mb-1.5",children:"ç«å±±å¼•æ“Ž Access Token"}),h.jsx("input",{id:"volc-asr-access-key",type:"password",value:i.volcAsrAccessKey||"",onChange:D=>A("volcAsrAccessKey",D.target.value||void 0),placeholder:"æŽ§åˆ¶å°èŽ·å–çš„ Access Token",className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent"})]}),h.jsxs("p",{className:"text-[11px] text-gray-600 leading-relaxed",children:["åœ¨"," ",h.jsx("span",{className:"text-gray-400",children:"console.volcengine.com"})," ","å¼€é€šè±†åŒ…è¯­éŸ³è¯†åˆ«æœåŠ¡ï¼ŒèŽ·å– App Key å’Œ Access Tokenã€‚ç”¨äºŽæ’­å®¢éŸ³é¢‘è½¬å†™ä¸ºæ–‡å­—ã€‚"]})]})]}),h.jsxs("section",{children:[h.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[h.jsx(Y8,{size:16,className:"text-purple-400"}),h.jsx("h3",{className:"text-sm font-medium text-white",children:t("ai.settings")})]}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{htmlFor:"ai-provider",className:"block text-xs font-medium text-gray-400 mb-1.5",children:t("ai.provider")}),h.jsxs("select",{id:"ai-provider",value:f.provider,onChange:D=>C("provider",D.target.value),className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[h.jsx("option",{value:"openrouter",children:"OpenRouter"}),h.jsx("option",{value:"minimax",children:"MiniMax"})]})]}),h.jsxs("div",{children:[h.jsx("label",{htmlFor:"ai-api-key",className:"block text-xs font-medium text-gray-400 mb-1.5",children:t("ai.apiKey")}),h.jsxs("div",{className:"relative",children:[h.jsx("input",{id:"ai-api-key",type:m?"text":"password",value:f.apiKey,onChange:D=>C("apiKey",D.target.value),placeholder:t("ai.apiKeyPlaceholder"),className:"w-full px-3 py-2 pr-10 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),h.jsx("button",{type:"button",onClick:()=>v(D=>!D),className:"absolute right-2 top-1/2 -translate-y-1/2 p-1 rounded hover:bg-white/10 text-gray-400 hover:text-white transition-colors",tabIndex:-1,children:m?h.jsx(wF,{size:14}):h.jsx(AF,{size:14})})]})]}),h.jsxs("div",{children:[h.jsx("label",{htmlFor:"ai-model-fast",className:"block text-xs font-medium text-gray-400 mb-1.5",children:t("ai.modelFast")}),h.jsx("input",{id:"ai-model-fast",type:"text",value:f.models.fast,onChange:D=>k("fast",D.target.value),placeholder:f.provider==="openrouter"?"google/gemini-flash-1.5":"abab6.5s-chat",className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),h.jsxs("div",{children:[h.jsx("label",{htmlFor:"ai-model-smart",className:"block text-xs font-medium text-gray-400 mb-1.5",children:t("ai.modelSmart")}),h.jsx("input",{id:"ai-model-smart",type:"text",value:f.models.smart,onChange:D=>k("smart",D.target.value),placeholder:f.provider==="openrouter"?"anthropic/claude-3.5-sonnet":"abab6.5-chat",className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),h.jsxs("div",{children:[h.jsx("label",{htmlFor:"ai-model-cheap",className:"block text-xs font-medium text-gray-400 mb-1.5",children:t("ai.modelCheap")}),h.jsx("input",{id:"ai-model-cheap",type:"text",value:f.models.cheap,onChange:D=>k("cheap",D.target.value),placeholder:f.provider==="openrouter"?"google/gemini-flash-1.5-8b":"abab5.5-chat",className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),h.jsx("button",{onClick:L,disabled:w||!g,className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 disabled:bg-gray-700 disabled:cursor-not-allowed text-white text-sm font-medium rounded-md transition-colors",children:w?h.jsxs(h.Fragment,{children:[h.jsx(xt,{size:16,className:"animate-spin"}),h.jsx("span",{children:t("preferences.saving")})]}):h.jsxs(h.Fragment,{children:[h.jsx(Tk,{size:16}),h.jsx("span",{children:t(g?"ai.save":"ai.saved")})]})})]})]}),h.jsx(pY,{}),h.jsx("div",{className:"pt-2",children:h.jsx("button",{onClick:S,disabled:o||!u,className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-700 disabled:cursor-not-allowed text-white text-sm font-medium rounded-md transition-colors",children:o?h.jsxs(h.Fragment,{children:[h.jsx(xt,{size:16,className:"animate-spin"}),h.jsx("span",{children:"ä¿å­˜ä¸­..."})]}):h.jsxs(h.Fragment,{children:[h.jsx(Tk,{size:16}),h.jsx("span",{children:"ä¿å­˜è®¾ç½®"})]})})})]})]})]}):null}const mY={social:h.jsx(jk,{size:20}),"social-media":h.jsx(jk,{size:20}),traditional:h.jsx(kk,{size:20}),"traditional-media":h.jsx(kk,{size:20}),new:h.jsx(d2,{size:20}),"new-media":h.jsx(d2,{size:20}),multimedia:h.jsx(Dk,{size:20}),blog:h.jsx(Ja,{size:20}),programming:h.jsx(dF,{size:20}),university:h.jsx(Gj,{size:20}),shopping:h.jsx($z,{size:20}),gaming:h.jsx(Nk,{size:20}),game:h.jsx(Nk,{size:20}),music:h.jsx(rz,{size:20}),picture:h.jsx(Z8,{size:20}),forum:h.jsx(Fm,{size:20}),bbs:h.jsx(Fm,{size:20}),finance:h.jsx(d2,{size:20}),travel:h.jsx(ed,{size:20}),design:h.jsx(VF,{size:20}),live:h.jsx(Dk,{size:20})};function yY(n){const e=n.toLowerCase();for(const[t,i]of Object.entries(mY))if(e.includes(t))return i;return h.jsx(ed,{size:20})}function vY({categories:n,onSelect:e}){return n.length===0?h.jsxs("div",{className:"text-center py-16",children:[h.jsx("p",{className:"text-sm text-gray-500",children:"æš‚æ— åˆ†ç±»æ•°æ®"}),h.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"è¯·æ£€æŸ¥ RSSHub å®žä¾‹æ˜¯å¦å¯è®¿é—®"})]}):h.jsxs("div",{children:[h.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-4",children:"æµè§ˆåˆ†ç±»"}),h.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:n.map(t=>h.jsxs("button",{onClick:()=>e(t.name),className:"flex flex-col items-center gap-2 p-4 rounded-lg bg-[#111] border border-white/5 hover:border-white/15 hover:bg-[#161616] transition-all cursor-pointer group",children:[h.jsx("div",{className:"text-gray-500 group-hover:text-gray-300 transition-colors",children:yY(t.name)}),h.jsx("div",{className:"text-sm text-gray-300 group-hover:text-white transition-colors text-center",children:t.name}),h.jsxs("div",{className:"text-[10px] text-gray-600",children:[t.count," ä¸ªè·¯ç”±"]})]},t.name))})]})}function xY({routes:n,loading:e,onSelectRoute:t}){if(e)return h.jsxs("div",{className:"flex items-center justify-center py-16",children:[h.jsx(xt,{size:20,className:"animate-spin text-gray-500"}),h.jsx("span",{className:"ml-2 text-sm text-gray-500",children:"åŠ è½½è·¯ç”±ä¸­..."})]});const i=Object.entries(n);return i.length===0?h.jsx("div",{className:"text-center py-16",children:h.jsx("p",{className:"text-sm text-gray-500",children:"è¯¥åˆ†ç±»ä¸‹æš‚æ— è·¯ç”±"})}):h.jsx("div",{className:"flex flex-col gap-6",children:i.map(([s,r])=>h.jsxs("div",{className:"border border-white/5 rounded-lg overflow-hidden",children:[h.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 bg-[#111]",children:[h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("div",{className:"text-sm font-medium text-gray-200",children:r.name||s}),r.url&&h.jsxs("a",{href:r.url,target:"_blank",rel:"noreferrer",className:"text-[10px] text-gray-600 hover:text-gray-400 flex items-center gap-1 mt-0.5",onClick:a=>a.stopPropagation(),children:[r.url,h.jsx(W1,{size:10})]})]}),h.jsxs("span",{className:"text-[10px] text-gray-600 shrink-0",children:[Object.keys(r.routes||{}).length," ä¸ªè·¯ç”±"]})]}),h.jsx("div",{className:"divide-y divide-white/5",children:Object.entries(r.routes||{}).map(([a,o])=>h.jsxs("button",{onClick:()=>t(r.name||s,{path:a,name:o.name,example:o.example,parameters:o.parameters}),className:"w-full text-left px-4 py-3 hover:bg-white/5 transition-colors cursor-pointer",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("div",{className:"text-sm text-gray-300",children:o.name}),h.jsx("span",{className:"text-xs text-blue-500 shrink-0 ml-2",children:bY(a)?"é…ç½®å‚æ•°":"ç›´æŽ¥è®¢é˜…"})]}),o.description&&h.jsx("div",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:o.description}),o.example&&h.jsx("div",{className:"text-[10px] text-gray-700 mt-1 font-mono",children:o.example})]},a))})]},s))})}function bY(n){return/:(\w+)/.test(n)}const wY={podcast:{label:"æ’­å®¢",icon:h.jsx(Ez,{size:14}),color:"text-purple-400"},rss:{label:"RSS",icon:h.jsx(ru,{size:14}),color:"text-orange-400"},rsshub:{label:"RSSHub",icon:h.jsx(Dz,{size:14}),color:"text-green-400"}};function SY({results:n,loading:e,onSubscribe:t,onClear:i}){if(e)return h.jsxs("div",{className:"flex items-center justify-center py-16",children:[h.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-gray-600 border-t-blue-500"}),h.jsx("span",{className:"ml-2 text-sm text-gray-500",children:"æœç´¢ä¸­..."})]});if(n.length===0)return h.jsxs("div",{className:"text-center py-16",children:[h.jsx("p",{className:"text-sm text-gray-500 mb-2",children:"æœªæ‰¾åˆ°ç»“æžœ"}),h.jsx("p",{className:"text-xs text-gray-600",children:"è¯•è¯•å…¶ä»–å…³é”®è¯æˆ–ç›´æŽ¥è¾“å…¥ç½‘ç«™ URL"}),h.jsx("button",{onClick:i,className:"mt-4 text-xs text-blue-500 hover:text-blue-400 cursor-pointer",children:"æ¸…é™¤æœç´¢"})]});const s=n.reduce((r,a)=>((r[a.type]=r[a.type]||[]).push(a),r),{});return h.jsxs("div",{children:[h.jsxs("div",{className:"flex items-center justify-between mb-4",children:[h.jsxs("span",{className:"text-sm text-gray-400",children:["æ‰¾åˆ° ",n.length," ä¸ªç»“æžœ"]}),h.jsxs("button",{onClick:i,className:"flex items-center gap-1 text-xs text-gray-500 hover:text-gray-300 cursor-pointer",children:[h.jsx(Fn,{size:14}),"æ¸…é™¤"]})]}),Object.entries(s).map(([r,a])=>{const o=wY[r]||{label:r,icon:h.jsx(ru,{size:14}),color:"text-gray-400"};return h.jsxs("div",{className:"mb-6",children:[h.jsxs("div",{className:`flex items-center gap-1.5 mb-3 text-xs font-medium ${o.color}`,children:[o.icon,h.jsx("span",{children:o.label}),h.jsxs("span",{className:"text-gray-600 ml-1",children:["(",a.length,")"]})]}),h.jsx("div",{className:"flex flex-col gap-1",children:a.map((l,u)=>h.jsxs("button",{onClick:()=>t(l),className:"flex items-center gap-3 p-3 rounded-md hover:bg-white/5 transition-colors text-left cursor-pointer w-full",children:[l.image?h.jsx("img",{src:l.image,alt:"",className:"w-10 h-10 rounded-md object-cover shrink-0"}):h.jsx("div",{className:"w-10 h-10 rounded-md bg-gray-800 flex items-center justify-center shrink-0",children:o.icon}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("div",{className:"text-sm text-gray-200 truncate",children:l.title}),l.description&&h.jsx("div",{className:"text-xs text-gray-500 truncate",children:l.description})]}),h.jsx("span",{className:"text-xs text-blue-500 shrink-0",children:l.feedUrl?"é¢„è§ˆ":"é…ç½®"})]},`${r}-${u}`))})]},r)})]})}function AY({feedUrl:n,suggestedTitle:e,onClose:t,onSubscribed:i}){const[s,r]=E.useState(null),[a,o]=E.useState(!0),[l,u]=E.useState(null),[d,f]=E.useState(!1),[p,g]=E.useState(""),[x,w]=E.useState(""),{showToast:y}=au();E.useEffect(()=>{o(!0),u(null),window.electronAPI.discoverPreview(n).then(v=>{r(v),g(v.title||e||"")}).catch(v=>{u(v instanceof Error?v.message:"é¢„è§ˆå¤±è´¥")}).finally(()=>{o(!1)})},[n,e]);const m=E.useCallback(async()=>{if(s){f(!0);try{await window.electronAPI.feedAdd({url:s.feedUrl,title:p.trim()||void 0,category:x.trim()||void 0}),y(`å·²è®¢é˜…ã€Œ${p||s.title||"Feed"}ã€`),i()}catch(v){const b=v instanceof Error?v.message:"è®¢é˜…å¤±è´¥";y(b)}finally{f(!1)}}},[s,p,x,y,i]);return E.useEffect(()=>{const v=b=>{b.key==="Escape"&&t()};return window.addEventListener("keydown",v),()=>window.removeEventListener("keydown",v)},[t]),h.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60",onClick:t,children:h.jsxs("div",{className:"relative w-full max-w-md mx-4 bg-[#111] border border-white/10 rounded-lg shadow-2xl max-h-[80vh] overflow-y-auto",onClick:v=>v.stopPropagation(),children:[h.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b border-white/5",children:[h.jsx("h3",{className:"text-sm font-medium text-white",children:"è®¢é˜…é¢„è§ˆ"}),h.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-300 cursor-pointer",children:h.jsx(Fn,{size:18})})]}),h.jsxs("div",{className:"px-5 py-4",children:[a&&h.jsxs("div",{className:"flex items-center justify-center py-8",children:[h.jsx(xt,{size:20,className:"animate-spin text-gray-500"}),h.jsx("span",{className:"ml-2 text-sm text-gray-500",children:"åŠ è½½é¢„è§ˆ..."})]}),l&&h.jsxs("div",{className:"py-8 text-center",children:[h.jsx("p",{className:"text-sm text-red-400 mb-2",children:"é¢„è§ˆå¤±è´¥"}),h.jsx("p",{className:"text-xs text-gray-600",children:l})]}),s&&!a&&h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[s.favicon?h.jsx("img",{src:s.favicon,alt:"",className:"w-10 h-10 rounded-md object-cover shrink-0"}):h.jsx("div",{className:"w-10 h-10 rounded-md bg-gray-800 flex items-center justify-center shrink-0",children:h.jsx(ru,{size:18,className:"text-gray-600"})}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("div",{className:"text-sm font-medium text-gray-200",children:s.title||"æœªçŸ¥åç§°"}),s.description&&h.jsx("div",{className:"text-xs text-gray-500 mt-0.5 line-clamp-2",children:s.description}),h.jsx("div",{className:"text-[10px] text-gray-700 mt-1 font-mono truncate",children:s.feedUrl})]})]}),s.alreadySubscribed&&h.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-green-900/20 border border-green-800/30 rounded-md mb-4",children:[h.jsx(nv,{size:14,className:"text-green-400"}),h.jsx("span",{className:"text-xs text-green-400",children:"å·²è®¢é˜…æ­¤æº"})]}),s.articles.length>0&&h.jsxs("div",{className:"mb-4",children:[h.jsx("div",{className:"text-xs text-gray-500 mb-2",children:"æœ€è¿‘æ–‡ç« "}),h.jsx("div",{className:"flex flex-col gap-1",children:s.articles.map((v,b)=>h.jsxs("div",{className:"flex items-center gap-2 py-1.5 px-2 rounded hover:bg-white/5",children:[h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("div",{className:"text-xs text-gray-300 truncate",children:v.title||"æ— æ ‡é¢˜"}),v.publishedAt&&h.jsx("div",{className:"text-[10px] text-gray-600",children:new Date(v.publishedAt).toLocaleDateString("zh-CN")})]}),v.url&&h.jsx("a",{href:v.url,target:"_blank",rel:"noreferrer",className:"text-gray-700 hover:text-gray-400 shrink-0",onClick:A=>A.stopPropagation(),children:h.jsx(W1,{size:12})})]},b))})]}),!s.alreadySubscribed&&h.jsxs("div",{className:"flex flex-col gap-3 pt-2 border-t border-white/5",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"è®¢é˜…åç§°"}),h.jsx("input",{type:"text",value:p,onChange:v=>g(v.target.value),placeholder:"ä½¿ç”¨é»˜è®¤åç§°",className:"w-full px-3 py-1.5 bg-[#0a0a0a] border border-white/10 rounded-md text-sm text-white placeholder-gray-600 focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"åˆ†ç±»"}),h.jsx("input",{type:"text",value:x,onChange:v=>w(v.target.value),placeholder:"å¯é€‰",className:"w-full px-3 py-1.5 bg-[#0a0a0a] border border-white/10 rounded-md text-sm text-white placeholder-gray-600 focus:outline-none focus:ring-1 focus:ring-blue-500"})]})]})]})]}),s&&!a&&!s.alreadySubscribed&&h.jsxs("div",{className:"flex justify-end gap-2 px-5 py-4 border-t border-white/5",children:[h.jsx("button",{onClick:t,className:"px-4 py-2 text-sm text-gray-400 hover:text-white transition-colors cursor-pointer",children:"å–æ¶ˆ"}),h.jsx("button",{onClick:m,disabled:d,className:"flex items-center gap-1.5 px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-700 text-white text-sm rounded-md transition-colors cursor-pointer",children:d?h.jsx(xt,{size:14,className:"animate-spin"}):"ç¡®è®¤è®¢é˜…"})]})]})})}function EY(n){return n?typeof n=="string"?n:n.description||"":""}function CY(n){if(!(!n||typeof n=="string"))return n.options}function _Y(n){if(!(!n||typeof n=="string"))return n.default}function NY(n,e){const t=[],i=/:(\w+)(?:\{[^}]*\})?\??/g;let s;for(;(s=i.exec(n))!==null;){const r=s[0],a=s[1],o=r.endsWith("?"),l=e==null?void 0:e[a];t.push({name:a,description:EY(l),optional:o,options:CY(l),defaultValue:_Y(l)})}return t}function kY(n,e){let t=n;for(const[i,s]of Object.entries(e))t=t.replace(new RegExp(`:${i}(?:\\{[^}]*\\})?\\??`,"g"),s);return t=t.replace(/\/:[\w]+(?:\{[^}]*\})?\?/g,""),t=t.replace(/\/+/g,"/").replace(/\/$/,""),t}function TY({namespace:n,route:e,onSubmit:t,onCancel:i}){const s=NY(e.path,e.parameters),[r,a]=E.useState(()=>{const p={};for(const g of s)g.defaultValue&&(p[g.name]=g.defaultValue);return p}),[o,l]=E.useState(!1),u=E.useCallback((p,g)=>{a(x=>({...x,[p]:g}))},[]),d=E.useCallback(p=>{var x;p.preventDefault();for(const w of s)if(!w.optional&&!((x=r[w.name])!=null&&x.trim()))return;l(!0);const g=kY(e.path,r);t(g),l(!1)},[s,r,e.path,t]),f=s.filter(p=>!p.optional).every(p=>{var g;return(g=r[p.name])==null?void 0:g.trim()});return h.jsxs("div",{className:"max-w-lg",children:[h.jsxs("div",{className:"mb-6",children:[h.jsx("h3",{className:"text-lg font-medium text-white",children:e.name}),h.jsx("p",{className:"text-sm text-gray-500 mt-1",children:n}),e.example&&h.jsxs("p",{className:"text-xs text-gray-600 mt-2 font-mono",children:["ç¤ºä¾‹è·¯å¾„: ",e.example]})]}),h.jsxs("form",{onSubmit:d,className:"flex flex-col gap-4",children:[s.map(p=>h.jsxs("div",{children:[h.jsxs("label",{className:"block text-sm text-gray-300 mb-1.5",children:[p.name,p.optional&&h.jsx("span",{className:"text-gray-600 ml-1",children:"(é€‰å¡«)"})]}),p.description&&h.jsx("p",{className:"text-xs text-gray-600 mb-1.5",children:p.description}),p.options&&p.options.length>0?h.jsxs("select",{value:r[p.name]||"",onChange:g=>u(p.name,g.target.value),className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white focus:outline-none focus:ring-1 focus:ring-blue-500",children:[p.optional&&h.jsx("option",{value:"",children:"-- ä¸é€‰æ‹© --"}),p.options.map(g=>h.jsx("option",{value:g.value,children:g.label},g.value))]}):h.jsx("input",{type:"text",value:r[p.name]||"",onChange:g=>u(p.name,g.target.value),placeholder:p.defaultValue||p.name,className:"w-full px-3 py-2 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-600 focus:outline-none focus:ring-1 focus:ring-blue-500"})]},p.name)),h.jsxs("div",{className:"flex gap-2 pt-2",children:[h.jsx("button",{type:"submit",disabled:!f||o,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-700 disabled:cursor-not-allowed text-white text-sm rounded-md transition-colors cursor-pointer",children:o?h.jsx(xt,{size:16,className:"animate-spin"}):"é¢„è§ˆè®¢é˜…"}),h.jsx("button",{type:"button",onClick:i,className:"px-4 py-2 bg-transparent hover:bg-white/5 text-gray-400 text-sm rounded-md transition-colors cursor-pointer",children:"å–æ¶ˆ"})]})]})]})}const DY=["xiaohongshu","twitter","instagram","telegram","youtube","bilibili","weibo","xiaoyuzhou","pixiv","pornhub","github","sspai","jike","zhihu","v2ex"],jY={xiaohongshu:"å°çº¢ä¹¦",twitter:"X (Twitter)",instagram:"Instagram",telegram:"Telegram",youtube:"YouTube",bilibili:"å“”å“©å“”å“© bilibili",weibo:"å¾®åš",xiaoyuzhou:"å°å®‡å®™",pixiv:"pixiv",pornhub:"PornHub",github:"GitHub",sspai:"å°‘æ•°æ´¾ sspai",jike:"å³åˆ»",zhihu:"çŸ¥ä¹Ž",v2ex:"V2EX"};function RY({onSelectSite:n}){const[e,t]=E.useState(null),[i,s]=E.useState(!0);E.useEffect(()=>{window.electronAPI.discoverRsshubRoutes().then(o=>{t(o)}).catch(o=>{console.error("åŠ è½½è·¯ç”±æ•°æ®å¤±è´¥:",o)}).finally(()=>{s(!1)})},[]);const r=E.useCallback(o=>{e!=null&&e[o]&&n(o,e[o])},[e,n]);if(i)return h.jsxs("div",{className:"mb-8",children:[h.jsxs("h3",{className:"text-sm font-medium text-gray-400 mb-4 flex items-center gap-1.5",children:[h.jsx(_k,{size:14,className:"text-orange-400"}),"çƒ­é—¨ç«™ç‚¹"]}),h.jsx("div",{className:"flex items-center justify-center py-8",children:h.jsx(xt,{size:16,className:"animate-spin text-gray-600"})})]});if(!e)return null;const a=DY.filter(o=>e[o]);return a.length===0?null:h.jsxs("div",{className:"mb-8",children:[h.jsxs("h3",{className:"text-sm font-medium text-gray-400 mb-4 flex items-center gap-1.5",children:[h.jsx(_k,{size:14,className:"text-orange-400"}),"çƒ­é—¨ç«™ç‚¹"]}),h.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-2.5",children:a.map(o=>{const l=e[o],u=Object.keys(l.routes||{}).length,d=jY[o]||l.name||o;return h.jsx("button",{onClick:()=>r(o),className:"flex items-center gap-3 px-3.5 py-3 rounded-lg bg-[#111] border border-white/5 hover:border-white/15 hover:bg-[#161616] transition-all cursor-pointer group text-left",children:h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("div",{className:"text-sm text-gray-300 group-hover:text-white transition-colors truncate",children:d}),h.jsxs("div",{className:"text-[10px] text-gray-600 mt-0.5",children:[u," routes"]})]})},o)})})]})}function LY({onFeedAdded:n}){const[e,t]=E.useState(""),[i,s]=E.useState(!1),[r,a]=E.useState(null),[o,l]=E.useState([]),[u,d]=E.useState(null),[f,p]=E.useState(null),[g,x]=E.useState(!1),[w,y]=E.useState(!1),[m,v]=E.useState(null),[b,A]=E.useState(""),[S,C]=E.useState(!1),[k,L]=E.useState(!1),[D,j]=E.useState(null),[P,H]=E.useState(),[G,$]=E.useState(null),[Y,F]=E.useState([{label:"å‘çŽ°",type:"home"}]),M=E.useRef(null),{showToast:I}=au();E.useEffect(()=>{window.electronAPI.discoverRsshubConfig().then(ne=>{v(ne.baseUrl),A(ne.baseUrl||"")}).catch(ne=>console.error("åŠ è½½ RSSHub é…ç½®å¤±è´¥:",ne))},[]),E.useEffect(()=>{m&&(x(!0),window.electronAPI.discoverRsshubCategories().then(ne=>{l(ne)}).catch(()=>{I("åŠ è½½ RSSHub åˆ†ç±»å¤±è´¥")}).finally(()=>{x(!1)}))},[m,I]);const V=E.useCallback(async()=>{const ne=e.trim();if(ne){s(!0),a(null),d(null),p(null),F([{label:"å‘çŽ°",type:"home"}]),$(null);try{const xe=await window.electronAPI.discoverSearch({query:ne});a(xe)}catch{I("æœç´¢å¤±è´¥"),a([])}finally{s(!1)}}},[e,I]),ie=E.useCallback(ne=>{ne.key==="Enter"&&(ne.preventDefault(),V())},[V]),ge=E.useCallback(async ne=>{d(ne),y(!0),p(null),F([{label:"å‘çŽ°",type:"home"},{label:ne,type:"category"}]),a(null);try{const xe=await window.electronAPI.discoverRsshubRoutes(ne);p(xe)}catch{I("åŠ è½½è·¯ç”±å¤±è´¥")}finally{y(!1)}},[I]),ee=E.useCallback((ne,xe)=>{const Re=xe.name||ne;d(ne),p({[ne]:xe}),y(!1),F([{label:"å‘çŽ°",type:"home"},{label:Re,type:"category"}]),a(null)},[]),me=E.useCallback(ne=>{ne.type==="home"?(d(null),p(null),a(null),$(null),F([{label:"å‘çŽ°",type:"home"}]),t("")):ne.type==="category"&&u&&($(null),F(xe=>xe.slice(0,2)))},[u]),oe=E.useCallback((ne,xe)=>{const Re=xe.path.match(/:(\w+)/g);if(!Re||Re.length===0){const je=xe.example||xe.path;j(je),H(`${ne} - ${xe.name}`);return}$({namespace:ne,route:xe}),F(je=>[...je.filter(Oe=>Oe.type!=="namespace"),{label:xe.name,type:"namespace"}])},[]),ae=E.useCallback(async()=>{const ne=b.trim();if(ne){L(!0);try{const xe=await window.electronAPI.discoverRsshubConfig(ne);v(xe.baseUrl),C(!1),I("RSSHub é…ç½®å·²ä¿å­˜")}catch{I("ä¿å­˜é…ç½®å¤±è´¥")}finally{L(!1)}}},[b,I]),Z=E.useCallback(ne=>{ne.feedUrl?(j(ne.feedUrl),H(ne.title)):ne.rsshubPath&&$({namespace:ne.title.split(" - ")[0],route:{path:ne.rsshubPath,name:ne.title,example:ne.rsshubPath,parameters:ne.rsshubParams}})},[]),re=E.useCallback(ne=>{j(ne),H(G==null?void 0:G.route.name)},[G]);return h.jsxs("div",{className:"flex flex-col h-full bg-[#0a0a0a]",children:[h.jsxs("div",{className:"shrink-0 px-6 pt-6 pb-4 border-b border-white/5",children:[h.jsxs("div",{className:"flex items-center justify-between mb-4",children:[h.jsx("div",{className:"flex items-center gap-1 text-sm",children:Y.map((ne,xe)=>h.jsxs("span",{className:"flex items-center gap-1",children:[xe>0&&h.jsx("span",{className:"text-gray-600",children:"/"}),h.jsx("button",{onClick:()=>me(ne),className:`transition-colors cursor-pointer ${xe===Y.length-1?"text-white font-medium":"text-gray-500 hover:text-gray-300"}`,children:ne.label})]},xe))}),h.jsxs("button",{onClick:()=>C(!S),className:"flex items-center gap-1.5 px-2.5 py-1.5 text-xs text-gray-500 hover:text-gray-300 rounded-md hover:bg-white/5 transition-colors cursor-pointer",children:[h.jsx(Db,{size:14}),h.jsx("span",{children:"RSSHub"})]})]}),S&&h.jsxs("div",{className:"mb-4 p-3 bg-[#111] border border-white/10 rounded-md",children:[h.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"RSSHub å®žä¾‹åœ°å€"}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("input",{type:"text",value:b,onChange:ne=>A(ne.target.value),placeholder:"https://rsshub.example.com",className:"flex-1 px-3 py-1.5 bg-[#0a0a0a] border border-white/10 rounded-md text-sm text-white placeholder-gray-600 focus:outline-none focus:ring-1 focus:ring-blue-500"}),h.jsx("button",{onClick:ae,disabled:k||!b.trim(),className:"px-3 py-1.5 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-700 disabled:cursor-not-allowed text-white text-xs rounded-md transition-colors cursor-pointer",children:k?h.jsx(xt,{size:14,className:"animate-spin"}):"ä¿å­˜"})]})]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsxs("div",{className:"relative flex-1",children:[h.jsx(dg,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500"}),h.jsx("input",{ref:M,type:"text",value:e,onChange:ne=>t(ne.target.value),onKeyDown:ie,placeholder:"æœç´¢æ’­å®¢ã€ç½‘ç«™åç§°ï¼Œæˆ–è¾“å…¥ URL å‘çŽ° RSS...",className:"w-full pl-9 pr-3 py-2.5 bg-[#111] border border-white/10 rounded-md text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),h.jsx("button",{onClick:V,disabled:!e.trim()||i,className:"px-5 py-2.5 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-700 disabled:cursor-not-allowed text-white text-sm font-medium rounded-md transition-colors cursor-pointer shrink-0",children:i?h.jsx(xt,{size:16,className:"animate-spin"}):"æœç´¢"})]})]}),h.jsxs("div",{className:"flex-1 overflow-y-auto px-6 py-4",children:[r!==null&&h.jsx(SY,{results:r,loading:i,onSubscribe:Z,onClear:()=>{a(null),t("")}}),G&&!D&&r===null&&h.jsxs("div",{children:[h.jsxs("button",{onClick:()=>{$(null),F(ne=>ne.filter(xe=>xe.type!=="namespace"))},className:"flex items-center gap-1 text-sm text-gray-500 hover:text-gray-300 mb-4 cursor-pointer",children:[h.jsx(tF,{size:16}),"è¿”å›ž"]}),h.jsx(TY,{namespace:G.namespace,route:G.route,onSubmit:re,onCancel:()=>{$(null),F(ne=>ne.filter(xe=>xe.type!=="namespace"))}})]}),r===null&&!G&&!D&&h.jsx(h.Fragment,{children:m?g?h.jsxs("div",{className:"flex items-center justify-center py-16",children:[h.jsx(xt,{size:20,className:"animate-spin text-gray-500"}),h.jsx("span",{className:"ml-2 text-sm text-gray-500",children:"åŠ è½½åˆ†ç±»ä¸­..."})]}):u&&f?h.jsx(xY,{routes:f,loading:w,onSelectRoute:oe}):h.jsxs(h.Fragment,{children:[h.jsx(RY,{onSelectSite:ee}),h.jsx(vY,{categories:o,onSelect:ge})]}):h.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[h.jsx(Db,{size:40,className:"text-gray-600 mb-4"}),h.jsx("p",{className:"text-gray-400 text-sm mb-2",children:"å°šæœªé…ç½® RSSHub å®žä¾‹"}),h.jsx("p",{className:"text-gray-600 text-xs mb-4",children:"é…ç½® RSSHub åœ°å€åŽå³å¯æµè§ˆå’Œæœç´¢ä¸°å¯Œçš„å†…å®¹æº"}),h.jsx("button",{onClick:()=>C(!0),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm rounded-md transition-colors cursor-pointer",children:"é…ç½® RSSHub"})]})})]}),D&&h.jsx(AY,{feedUrl:D,suggestedTitle:P,onClose:()=>{j(null),H(void 0)},onSubscribed:()=>{j(null),H(void 0),n==null||n()}})]})}function MY(){const[n,e]=E.useState(!1),[t,i]=E.useState(null),[s,r]=E.useState("library-articles"),[a,o]=E.useState(null),[l,u]=E.useState(!1),[d,f]=E.useState(!1),[p,g]=E.useState(!1),[x,w]=E.useState(!1),[y,m]=E.useState(!1),[v,b]=E.useState(!1),[A,S]=E.useState(!1),[C,k]=E.useState(!1),[L,D]=E.useState(0),[j,P]=E.useState(null),[H,G]=E.useState(null),[$,Y]=E.useState(null),[F,M]=E.useState(null),[I,V]=E.useState(()=>localStorage.getItem("detail-panel-collapsed")==="true"),[ie,ge]=E.useState(null),[ee,me]=E.useState(!1),[oe,ae]=E.useState(null),[Z,re]=E.useState("article"),ne=s.startsWith("library-")?"library":s.startsWith("feed-")||s==="feeds"?"feed":void 0,xe=s==="feed-unseen"?"unseen":s==="feed-seen"?"seen":void 0,Re=s==="library-videos"?"video":s==="library-podcasts"?"podcast":s==="library-articles"?"article":void 0;E.useEffect(()=>{(async()=>{try{const Ae=await window.electronAPI.settingsGet();Ae.language&&VD(Ae.language)}catch(Ae){console.error("Failed to load language setting:",Ae)}})()},[]),E.useEffect(()=>{const ke=Ae=>{const it=Ae.target.tagName;if(!(it==="INPUT"||it==="TEXTAREA")){if((Ae.metaKey||Ae.ctrlKey)&&Ae.key==="k"&&(Ae.preventDefault(),f(nt=>!nt)),(Ae.metaKey||Ae.ctrlKey)&&Ae.shiftKey&&Ae.key==="s"){Ae.preventDefault(),w(!0);return}if(Ae.shiftKey&&(Ae.key==="a"||Ae.key==="A")){Ae.preventDefault(),g(!0);return}if(Ae.shiftKey&&(Ae.key==="f"||Ae.key==="F")&&!Ae.metaKey&&!Ae.ctrlKey){Ae.preventDefault(),m(!0);return}Ae.key==="/"&&(Ae.preventDefault(),m(!0)),Ae.key==="?"&&(Ae.preventDefault(),b(nt=>!nt)),Ae.key==="]"&&!l&&(Ae.preventDefault(),V(nt=>{const Qe=!nt;return localStorage.setItem("detail-panel-collapsed",String(Qe)),Qe})),Ae.key==="["&&!l&&(Ae.preventDefault(),e(nt=>!nt))}};return document.addEventListener("keydown",ke),()=>document.removeEventListener("keydown",ke)},[l]);const je=E.useCallback(ke=>{const it={inbox:"1",later:"2",archive:"3","archive-article":"e","later-article":"l","delete-article":"d","open-reader":"Enter",search:"/"}[ke];it&&document.dispatchEvent(new KeyboardEvent("keydown",{key:it,bubbles:!0}))},[]),Oe=E.useCallback(()=>{D(ke=>ke+1)},[]),Ce=E.useCallback(async ke=>{const Ae=await window.electronAPI.articleGet(ke);re((Ae==null?void 0:Ae.mediaType)??"article"),o(ke),u(!0)},[]),Fe=E.useCallback(()=>{u(!1),o(null)},[]),Ze=E.useCallback(ke=>{i(ke),r("library-articles"),Ce(ke)},[Ce]),ye=E.useCallback(async ke=>{try{await window.electronAPI.feedUpdate({id:ke.id,title:ke.title??void 0,category:ke.category??void 0,fetchInterval:ke.fetchInterval}),D(Ae=>Ae+1)}catch(Ae){console.error("Failed to update feed:",Ae)}},[]),we=E.useCallback(async ke=>{try{await window.electronAPI.feedDelete(ke),D(Ae=>Ae+1),j===ke&&(P(null),r("feeds"))}catch(Ae){console.error("Failed to delete feed:",Ae)}},[j]),He=E.useCallback(async ke=>{try{await window.electronAPI.feedFetch(ke),D(Ae=>Ae+1)}catch(Ae){console.error("Failed to fetch feed:",Ae)}},[]);return h.jsx(xU,{children:h.jsxs("div",{className:"flex flex-col h-screen bg-[#0f0f0f] text-gray-200 overflow-hidden",children:[h.jsx("div",{className:"h-[38px] shrink-0 drag-region flex items-center"}),!l&&!ee?h.jsxs("div",{className:"flex flex-1 min-h-0",children:[h.jsx(dU,{collapsed:n,onToggleCollapse:()=>e(!n),activeView:s,onViewChange:ke=>{r(ke),ke==="manage-feeds"&&P(null)},onAddFeed:()=>g(!0),onAddUrl:()=>w(!0),onSearch:()=>m(!0),onShortcutsHelp:()=>b(!0),onDownloads:()=>S(!0),onPreferences:()=>k(!0),selectedFeedId:j,onFeedSelect:ke=>{P(ke),r("feeds")},refreshTrigger:L,selectedTagId:H,onTagSelect:ke=>{G(ke),ke&&r("tags")}}),s==="discover"?h.jsx(LY,{onFeedAdded:Oe}):s==="manage-feeds"?h.jsxs(h.Fragment,{children:[h.jsx(wH,{onSelectFeed:M,selectedFeedId:F,onEditFeed:Y,onAddFeed:()=>g(!0),refreshTrigger:L,onDeleteFeed:we}),h.jsx(SH,{feedId:F,onEditFeed:Y,onDeleteFeed:we,onFetchFeed:He,onOpenArticle:ke=>{i(ke),P(F),r("feeds")},refreshTrigger:L,collapsed:I})]}):s==="books"?h.jsxs(h.Fragment,{children:[h.jsx(CH,{selectedBookId:ie,onSelectBook:ge,onOpenReader:ke=>{ae(ke),me(!0)},refreshTrigger:L,expanded:I}),ie?h.jsx(NH,{bookId:ie,collapsed:I,onOpenReader:ke=>{ae(ke),me(!0)},onRefresh:Oe}):h.jsx(kH,{onImported:Oe,collapsed:I})]}):h.jsxs(h.Fragment,{children:[h.jsx(SU,{selectedArticleId:t,onSelectArticle:i,onOpenReader:Ce,refreshTrigger:L,feedId:s==="feeds"?j:void 0,isShortlisted:s==="shortlist",activeView:s,tagId:s==="tags"?H:void 0,expanded:I,source:ne,initialTab:xe,mediaType:Re}),h.jsx(HC,{articleId:t,collapsed:I})]})]}):ee&&oe?h.jsx("div",{className:"flex-1 min-h-0",children:h.jsx(KG,{bookId:oe,onClose:()=>{me(!1),ae(null)}})}):Z==="podcast"?h.jsx("div",{className:"flex-1 min-h-0",children:h.jsx(oY,{articleId:a,onClose:Fe})}):Z==="video"?h.jsx("div",{className:"flex-1 min-h-0",children:h.jsx(sY,{articleId:a,onClose:Fe})}):h.jsx("div",{className:"flex-1 min-h-0",children:h.jsx(uH,{articleId:a,onClose:Fe})}),h.jsx(dH,{open:d,onClose:()=>f(!1),onExecute:je}),h.jsx(pH,{open:p,onClose:()=>g(!1),onFeedAdded:Oe}),h.jsx(gH,{open:x,onClose:()=>w(!1),onArticleSaved:Oe}),h.jsx(mH,{open:y,onClose:()=>m(!1),onSelectArticle:Ze}),h.jsx(vH,{open:v,onClose:()=>b(!1)}),h.jsx(cY,{open:A,onClose:()=>S(!1)}),h.jsx(gY,{open:C,onClose:()=>k(!1)}),$&&h.jsx(bH,{feed:$,onClose:()=>Y(null),onSave:ye,onDelete:we,onFetch:He})]})})}const CD=document.getElementById("root");CD&&A8.createRoot(CD).render(E.createElement(MY));
